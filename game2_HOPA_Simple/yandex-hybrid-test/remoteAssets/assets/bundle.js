!function(){"use strict";window.localeAssets=[]}();!function(){"use strict";var e={d:(t,r)=>{for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{A:()=>H});class r{constructor(e){this.adapter=e}init(){return Promise.resolve(!1)}showPreroll(){return this.showInterstitial()}showRewarded(){return Promise.reject()}isRewardedAvailableNow(){return!1}showInterstitial(){return Promise.reject()}showBanner(){return Promise.reject()}hideBanner(){return Promise.resolve()}}class i{constructor(e){this.adapter=e}init(){return Promise.resolve(null)}isAuthAvailable(){return!1}isAuth(){return!1}auth(){return Promise.reject()}getId(){return""}getName(){return""}getAvatar(){return""}}const a=1e3;function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),/Android/i.test(navigator.userAgent);class o{constructor(e){this.initFunction=e,s(this,"waiters",[]),s(this,"isStarted",!1),s(this,"object",void 0)}get(){return this.init(...arguments),this.object?Promise.resolve(this.object):this.newWaiter()}init(){return this.isStarted?Promise.resolve():(this.isStarted=!0,this.initFunction(...arguments).then(e=>{this.object=e,this.callWaiters(!0)}).catch(e=>{this.isStarted=!1,console.error("AsyncObject.init error",e),this.callWaiters(!1,e)}))}newWaiter(){return new Promise((e,t)=>{this.waiters.push({resolve:e,reject:t})})}callWaiters(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.waiters.forEach(r=>{e?r.resolve(this.object):r.reject(t)})}}function n(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l{constructor(e){this.adapter=e,n(this,"purchaseUrl",""),n(this,"available",!1),n(this,"catalog",new o(()=>this.loadCatalog()))}init(){return Promise.resolve()}isAvailable(){return this.available}getCurrency(){return""}getCatalog(){return this.catalog.get()}buy(e){return this.isAvailable()?this.buyOnPlatform(e).then(()=>this.tryGetPurchases()).then(t=>t.find(t=>t.productID===e)||null||Promise.reject()):Promise.reject("Purchase is not available")}getPurchases(){return this.isAvailable()?this.adapter.server.request({url:this.purchaseUrl+"/get-transactions",data:{app_id:this.getAppId(),user_id:this.adapter.player.getId()}}).then(e=>e.error||!e.data?Promise.reject(e.error):e.data.filter(e=>"closed"!==e.status).map(e=>this.formatPurchase(e))||[]):Promise.reject("Purchase is not available")}consumePurchase(e){return this.isAvailable()?(console.log("consumePurchase",{transaction_id:e,app_id:this.getAppId(),user_id:this.adapter.player.getId(),sign:this.getSign()}),this.adapter.server.request({url:this.purchaseUrl+"/close-transaction",data:{transaction_id:e,app_id:this.getAppId(),user_id:this.adapter.player.getId(),sign:this.getSign()},retries:3}).then(e=>!e.error||Promise.reject(e.error))):Promise.reject("Purchase is not available")}formatPurchase(e){return{purchaseToken:e.transaction_id,productID:e.data.product_code}}getAppId(){return this.adapter.options.app_id||""}getSign(){return""}buyOnPlatform(e){return Promise.reject()}tryGetPurchases(){let e=5;return new Promise((t,r)=>{const i=()=>{if(e<=0)return r("no purchases");e-=1,this.timeoutGetPurchases((1+.3*Math.pow(5-e,2))*a).then(e=>{e.length?t(e):i()}).catch(e=>{console.error(e),i()})};i()})}timeoutGetPurchases(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return new Promise((t,r)=>{setTimeout(()=>{this.getPurchases().then(t).catch(r)},e)})}loadCatalog(){const e=this.adapter.options.catalog_url;return e?fetch(e+"?t="+Date.now()).then(e=>e.json()).catch(e=>(console.error("loadCatalog",e),null)):(console.warn("catalog_url is not set"),Promise.resolve(null))}}function c(e){try{return JSON.parse(e)}catch(e){return console.warn("parseJSON()",e),null}}function h(e){try{return JSON.stringify(e)}catch(e){return console.error("stringifyJSON()",e),""}}function u(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const d="https://bbb.dra.games/api",v=d+"/get-data",m=d+"/save-data",p=d+"/players/get-leaderboard",g="CommonServer error: game code or player id is not set";class f{constructor(e){this.adapter=e,u(this,"lastSnapshot",""),u(this,"lastSaveTime",0),u(this,"timer",null),u(this,"saveStep",a),u(this,"score",void 0),u(this,"extra_data",void 0),u(this,"game_data",void 0),u(this,"saveCallbacks",[])}init(){return Promise.resolve()}setExtraData(e){this.extra_data=h(e)}getExtraData(){return c(this.extra_data||"{}")}setScore(e){this.score=e}setGameData(e){this.game_data=h(e)}load(){return this.isReady()?this.request({url:v,data:{game_code:this.getGameCode(),player_id:this.getPlayerId()},retries:2}).then(e=>e?.data?(this.actualizeData(e.data),Promise.resolve(c(this.game_data||""))):Promise.reject()):Promise.reject(g)}save(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isReady())return Promise.reject(g);const t=this.createSaveResolve();return e?this.imidiateSave():this.timeoutSave(),t}api(){return this.request({url:d,data:{}})}time(){return this.api().then(e=>e.timestamp)}actualizeData(e){e&&(console.log("actualizeData",e),e.game_data&&(this.game_data=e.game_data),e.score&&(this.score=e.score),e.extra_data&&(this.extra_data=e.extra_data),this.lastSnapshot=this.captureDataSnapshot())}createSaveResolve(){return new Promise((e,t)=>{this.saveCallbacks.push({resolve:e,reject:t})})}imidiateSave(){console.log("imidiateSave"),this.timer&&clearTimeout(this.timer),this.timer=null,this.saveAllData()}timeoutSave(){console.log("timeoutSave");const e=Date.now(),t=this.lastSaveTime,r=this.saveStep,i=e-t;i>=r?this.imidiateSave():this.timer||(this.timer=setTimeout(()=>{this.imidiateSave()},Math.max(0,r-i)))}saveAllData(){console.log("saveAllData");const e=this.lastSnapshot,t=this.captureDataSnapshot();if(e===t)return void this.callSaveResolves({success:!0,data:null});console.log("saveAllData snapshot changed");const r=this.getChangedData();console.log("saveAllData changedData",r),r&&0!==Object.keys(r).length?(this.lastSnapshot=t,this.lastSaveTime=Date.now(),this.request({url:m,data:{game_code:this.getGameCode(),player_id:this.getPlayerId(),...r},retries:2}).then(e=>{this.lastSnapshot=t,this.callSaveResolves({success:!0,data:e})}).catch(t=>{this.lastSnapshot=e,this.callSaveRejects(t)})):this.callSaveResolves({success:!0})}captureDataSnapshot(){return h({game_code:this.getGameCode(),player_id:this.getPlayerId(),game_data:this.game_data,score:this.score,extra_data:this.extra_data})}snapshotToSave(e){return c(e)}getChangedData(){const e={game_data:this.game_data,score:this.score,extra_data:this.extra_data};if(!this.lastSnapshot)return e;const t=this.snapshotToSave(this.lastSnapshot),r={};return console.log("changedData",{lastSave:t,currentSave:e}),Object.keys(e).forEach(i=>{t[i]!=e[i]&&(r[i]=e[i])}),r}callSaveResolves(e){this.saveCallbacks.forEach(t=>{t.resolve(e)}),this.saveCallbacks=[]}callSaveRejects(e){this.saveCallbacks.forEach(t=>{t.reject(e)}),this.saveCallbacks=[]}getLb(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return this.isReady()?this.request({url:p,data:{game_code:this.getGameCode(),player_id:this.getPlayerId(),top_limit:e,nearby_limit:t},retries:1}).then(e=>Promise.resolve(e?.data||{})).catch(e=>Promise.resolve(null)):Promise.reject(g)}request(e){let t=(e={url:"",contentType:"application/json",retries:0,data:null,method:"POST",...e}).retries||0;return new Promise((r,i)=>{const a=()=>{this.requestAttempt(e).then(e=>{r(e)}).catch(e=>{t>0?(t--,a()):i(e)})};a()})}requestAttempt(e){return console.log("requestAttempt",e),fetch(e.url,{method:e.method,headers:{"Content-Type":e.contentType||"application/json"},body:JSON.stringify(e.data)}).then(e=>e.json()).then(t=>(console.log("SERVER request success",{...e,response:t}),t)).catch(t=>(console.error("SERVER request error",{...e,response:t}),Promise.reject(t)))}isReady(){return!(!this.getGameCode()||!this.getPlayerId())}getGameCode(){return this.adapter.getGameCode()}getPlayerId(){return this.adapter.player.getId()}}function y(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class b{constructor(e){this.adapter=e,y(this,"status",!1),y(this,"available",!1)}init(){return Promise.resolve()}isAvailable(){return this.available}act(e){return console.log("base act",e),Promise.reject()}getStatus(){return this.status}shouldAct(){return console.log("shouldAct"),this.isAvailable()&&!this.getStatus()}}class P{constructor(e){this.adapter=e}init(){return Promise.resolve(null)}getLocalStorage(){return window.localStorage||window.sessionStorage}set(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.adapter.server.setGameData(e),this.setToPlatform(e,t),this.adapter.server.save(t)}get(e){return Promise.all([this.getFromServer(),this.getFromPlatform(e)]).then(e=>(console.log("saves",e),e.filter(e=>!!e)))}setToPlatform(e,t){return Promise.resolve(null)}getFromPlatform(e){return Promise.resolve(null)}getFromServer(){return this.adapter.server.load().catch(()=>null)}}function S(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class w{constructor(e){this.adapter=e,S(this,"available",!0),S(this,"extra_data",void 0),S(this,"extra_data_init",!1)}init(){return Promise.resolve(null)}isAvailable(){return this.available}getScore(){return this.getEntry().then(e=>e?.score||0).catch(()=>0)}setScore(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.adapter.server.setScore(e),this.tryInitExtraData().then(()=>this.adapter.server.save(t))}addScore(e){return this.getScore().then(t=>this.setScore(t+e))}setExtraData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.setSelfExtraData(e),this.adapter.server.setExtraData(this.extra_data),this.adapter.server.save(t)}getEntries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return this.adapter.server.getLb(e,t).then(t=>this.formatEntries(this.sortServerEntries(t,e))).catch(()=>[])}getEntry(){return this.getEntries(0,0).then(e=>e.length?e[0]:Promise.reject())}sortServerEntries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const r=e.top||[],i=e.nearby||[],a=e.player,s=[],o=e=>{e&&!s.find(t=>t.player_id===e.player_id)&&s.push(e)};return o(a),i.forEach(o),r.forEach(o),s.length=Math.min(s.length,Math.max(t,1)),s.sort((e,t)=>e.rank-t.rank),s}formatEntries(e){return Promise.all(e.map(e=>{const t=JSON.parse(e.extra_data||"{}");return{id:e.player_id,score:e.score,rank:e.rank,avatar:t.avatar||"",title:t.title||"",extra_data:t}}))}tryInitExtraData(){return this.extra_data_init?Promise.resolve():this.initExtraData()}initExtraData(){return this.adapter.leaderboard.getEntry().then(e=>{this.setSelfExtraData(e.extra_data)}).catch(e=>{console.error("PgLeaderboard.initExtraData error",e)})}setSelfExtraData(e){this.extra_data={...this.getDefaultExtraData(),...e},this.extra_data_init=!0}getDefaultExtraData(){return{title:this.adapter.player.getName()||void 0,avatar:this.adapter.player.getAvatar()||void 0}}}class j extends w{constructor(){var e,t,r;super(...arguments),e=this,r=!1,(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="available"))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}getScore(){return Promise.resolve(0)}setScore(e){return Promise.reject()}setExtraData(e,t){return Promise.reject()}getEntries(){return Promise.resolve([])}}function E(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class x{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,E(this,"platform_prefix",""),E(this,"_isReady",!1),E(this,"initWaiters",[]),E(this,"api",void 0),E(this,"advertising",void 0),E(this,"player",void 0),E(this,"purchase",void 0),E(this,"server",void 0),E(this,"leaderboard",void 0),E(this,"storage",void 0),E(this,"modules",[]),E(this,"joinGroup",void 0),E(this,"inviteFriends",void 0),E(this,"makePost",void 0),E(this,"subscribeToEvents",void 0),E(this,"makeReview",void 0),E(this,"setShortcut",void 0),E(this,"addToFavorites",void 0),E(this,"makeStories",void 0),E(this,"share",void 0),E(this,"recommend",void 0),E(this,"subModules",[]),this.advertising=this.createAdvertising(),this.player=this.createPlayer(),this.purchase=this.createPurchase(),this.server=this.createServer(),this.leaderboard=this.createLeaderboard(),this.storage=this.createStorage(),this.modules.push(this.advertising,this.player,this.purchase,this.server,this.leaderboard,this.storage),this.joinGroup=this.createJoinGroup(),this.inviteFriends=this.createInviteFriends(),this.makePost=this.createMakePost(),this.subscribeToEvents=this.createSubscribeToEvents(),this.makeReview=this.createMakeReview(),this.setShortcut=this.createSetShortcut(),this.addToFavorites=this.createAddToFavorites(),this.makeStories=this.createMakeStories(),this.share=this.createShare(),this.recommend=this.createRecommend(),this.subModules.push(this.joinGroup,this.inviteFriends,this.makePost,this.subscribeToEvents,this.makeReview,this.setShortcut,this.addToFavorites,this.makeStories,this.share,this.recommend),this.initSelf()}get isReady(){return this._isReady}getPlatformId(){return this.platform_prefix}getFlag(e){return this.options.flags?.[e]}getGameCode(){return this.options.game_code||this.getDefaultGameCode()}init(){return this.isReady?Promise.resolve():this.getInitPromise()}gameReady(){this.loading(1)}gameplayStart(){}gameplayStop(){}loading(){}getLang(){return"en"}getServerTime(){return this.server.time().catch(()=>Date.now())}domainlock(e){window.location.hostname.includes(e)||setTimeout(()=>{this.redirect(e)},a*(10*Math.random()+10))}redirect(e){window.location.href=e}createServer(){return new f(this)}createAdvertising(){return new r(this)}createPlayer(){return new i(this)}createLeaderboard(){return new j(this)}createStorage(){return new P(this)}createPurchase(){return new l(this)}createJoinGroup(){return new b(this)}createInviteFriends(){return new b(this)}createMakePost(){return new b(this)}createSubscribeToEvents(){return new b(this)}createMakeReview(){return new b(this)}createSetShortcut(){return new b(this)}createAddToFavorites(){return new b(this)}createMakeStories(){return new b(this)}createShare(){return new b(this)}createRecommend(){return new b(this)}initSelf(){let e=!1;const t=()=>{e||(e=!0,this.initApi().then(()=>this.initModules()).then(()=>{console.log("Adapter init success"),this._isReady=!0,this.loading(0),this.callInitWaiters(!0)}).catch(e=>{console.error("Adapter init error",e),this.callInitWaiters(!1,e)}))};window.addEventListener("load",t),"complete"===document.readyState&&t()}initApi(){return Promise.resolve()}initModules(){const e=[...this.modules,...this.subModules];return Promise.all(e.map(e=>e.init()))}getInitPromise(){return new Promise((e,t)=>{this.initWaiters.push({resolve:e,reject:t})})}callInitWaiters(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.initWaiters.forEach(r=>{e?r.resolve():r.reject(t)}),this.initWaiters=[]}getDefaultGameCode(){return this.platform_prefix+"_"+this.options.app_id}}const _=String.fromCharCode(104,116,116,112,115,58,47,47,121,97,110,100,101,120,46,114,117,47,103,97,109,101,115,47,115,100,107,47,118,50),A=String.fromCharCode(104,116,116,112,115,58,47,47,121,97,110,100,101,120,46,114,117,47,103,97,109,101,115,47,97,112,112,47);let D;const T=new o(()=>function(e){let t,r;console.log("includeScript()",e);const i=document.createElement("script"),a=new Promise((e,i)=>{t=e,r=i});return i.src=e,i.onload=()=>{console.log(`script ${e} loaded`),t()},i.onerror=t=>{console.error(`script ${e} error`,t),r(t)},document.head.appendChild(i),a}(I()?"/sdk.js":_).then(()=>(console.log("Yandex SDK included"),window.YaGames.init())).then(e=>(console.log("Yandex SDK initialized",e),D=e,e)).catch(e=>(console.error("Yandex SDK error",e),Promise.reject(e)))),k=new o(()=>C().then(e=>e.getPlayer({scopes:!0}))),R=new o(()=>C().then(e=>e.getPayments()));function I(){const e=window.location.hostname.includes("yandex"),t=void 0!==window.Ya;return e||t}function C(){return T.get()}function M(){return D}function O(){return k.get()}function Y(){return C().then(e=>e.leaderboards)}function G(){return R.get()}class F extends b{init(){return M().feedback.canReview().then(e=>{let{value:t,reason:r}=e;t?(this.available=!0,this.status=!1):(console.log("YandexMakeReview init: reason",r),this.available=!1,this.status=!!this.isAlreadyRatedReason(r))}).catch(e=>{this.available=!1,console.error("YandexMakeReview init: error",e)})}act(){return M().feedback.requestReview().then(e=>{let{feedbackSent:t}=e;if(this.status=t,!t)return Promise.reject("YandexMakeReview act: feedback not sent")}).catch(e=>(console.error("YandexMakeReview act: error",e),Promise.reject(e))).finally(()=>{this.available=!1})}isAlreadyRatedReason(e){return"GAME_RATED"===e||"REVIEW_WAS_REQUESTED"===e}}class N extends b{init(){return M().shortcut.canShowPrompt().then(e=>{let{canShow:t}=e;console.log("YandexSetShortcut init: canShow",t),this.available=t}).catch(e=>{console.error("YandexSetShortcut init: error",e),this.available=!1})}act(){return M().shortcut.showPrompt().then(e=>{let{outcome:t}=e;if("accepted"!==t)return this.status=!1,Promise.reject("YandexSetShortcut act: shortcut not added");this.status=!0}).catch(e=>(console.error("YandexSetShortcut act: error",e),Promise.reject(e))).finally(()=>{this.available=!1,this.init()})}}function L(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class q{constructor(){L(this,"last",0),L(this,"min",3e4)}show(){return new Promise((e,t)=>{try{const r=M(),i=Date.now();if(Math.abs(i-this.last)<this.min)return e(!1);this.last=i;let a=!1;r.adv.showFullscreenAdv({callbacks:{onClose:e,onError:e=>{console.error(e),t(e)},onOpen:()=>{a=!0}}}),setTimeout(()=>{a||t(new Error("Interstitial not opened"))},1e4)}catch(e){console.error(e),t(e)}})}}class W{show(){return new Promise((e,t)=>{try{const r=M();let i=!1,a=!1;r.adv.showRewardedVideo({callbacks:{onError:e=>{console.error(e),t(e)},onRewarded:()=>{a=!0},onClose:()=>{a||t(new Error("Rewarded video not opened")),e()},onOpen:()=>{i=!0}}}),setTimeout(()=>{i||t(new Error("Rewarded video not opened"))},2e4)}catch(e){t(e)}})}}class U{constructor(){var e,t,r;e=this,r=!1,(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="visible"))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}updateStatus(){const e=M();e&&e.adv.getBannerAdvStatus().then(e=>{let{stickyAdvIsShowing:t,reason:r}=e;this.visible=!!t})}show(){const e=M();e&&(this.visible=!0,e.adv.showBannerAdv())}hide(){const e=M();e&&(this.visible=!1,e.adv.hideBannerAdv())}}function B(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class J extends r{constructor(){super(...arguments),B(this,"interstitial",new q),B(this,"rewarded",new W),B(this,"banner",new U)}showInterstitial(){return this.interstitial.show()}isRewardedAvailableNow(){return!0}showRewarded(){return this.rewarded.show()}async showBanner(){this.banner.show()}async hideBanner(){this.banner.hide()}}class z extends w{isAvailable(){return!0}setScore(e,t){return this.isItPossibleToUse().then(()=>Y()).then(t=>t.setScore(this.getLeaderboardName(),Number(e))).catch(e=>{console.error(e)})}getEntries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return Y().then(r=>r.getEntries(this.getLeaderboardName(),{includeUser:!0,quantityAround:t,quantityTop:e})).then(t=>this.formatAndSortYandexEntries(t.entries,e)).catch(e=>(console.error(e),Promise.reject(e)))}formatAndSortYandexEntries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const r=e.map(e=>this.formatEntry(e));return this.sortEntries(r,t)}sortEntries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const r=this.findTopEntries(e,t)||[],i=this.findNearbyEntries(e,t)||[],a=this.findPlayerEntry(e),s=[],o=e=>{e&&!s.find(t=>t.id===e.id)&&s.push(e)};return o(a),i.forEach(o),r.forEach(o),s.length=Math.min(s.length,Math.max(t,1)),s.sort((e,t)=>e.rank-t.rank),s}findPlayerEntry(e){return e.find(e=>e.id===this.adapter.player.getId())}findNearbyEntries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;const r=this.findPlayerEntry(e)?.rank||0,i=e.filter(e=>e.id!==this.adapter.player.getId()).sort((e,t)=>Math.abs(e.rank-r)-Math.abs(t.rank-r));return i.length=Math.min(i.length,t),i}findTopEntries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e.slice(0,t).sort((e,t)=>t.rank-e.rank).slice(0,t)}formatEntry(e){return{id:e.player.uniqueID,title:e.player.publicName,avatar:e.player.getAvatarSrc("small"),score:e.score,rank:e.rank,extra_data:e.extraData?c(e.extraData)||e.extraData:void 0}}getEntry(){return this.isItPossibleToUse().then(()=>Y()).then(e=>e.getPlayerEntry(this.getLeaderboardName())).then(e=>this.formatEntry(e)).catch(e=>(console.error(e),Promise.reject(e)))}setExtraData(e,t){let r;return this.isItPossibleToUse().then(()=>Y()).then(e=>(r=e,r.getPlayerEntry(this.getLeaderboardName()))).then(t=>r.setScore(this.getLeaderboardName(),t.score,h(e))).catch(e=>(console.error(e),Promise.reject(e)))}getLeaderboardName(){return this.adapter.options.leaderboard_name||"main"}isItPossibleToUse(){return this.adapter.player.isAuth()?Promise.resolve():Promise.reject("Player is not authenticated")}}class V extends i{constructor(){var e,t,r;super(...arguments),e=this,r=void 0,(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="player"))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}init(){return O().then(e=>{console.log("YandexPlayer init",e),this.player=e}).catch(e=>{console.error("YandexPlayer init error",e)})}isAuthAvailable(){return!0}isAuth(){return this.player.isAuthorized()}auth(){return M().auth.openAuthDialog().then(()=>this.init())}getId(){return this.player.getUniqueID()}getName(){return this.player.getName()}getAvatar(){return this.player.getPhoto("small")}}class K extends l{constructor(){var e,t,r;super(...arguments),e=this,r="YAN",(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="currency"))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}init(){return this.available=!0,super.init()}getCurrency(){return this.currency}buy(e){return G().then(t=>t.purchase({id:e})).then(e=>e).catch(e=>(console.error("YandexPurchase.buy error",e),Promise.reject(e)))}getPurchases(){return G().then(e=>e.getPurchases()).then(e=>(console.log("YandexPurchase.getPurchases",e),e.map(e=>e.purchaseData||e))).catch(e=>(console.error("YandexPurchase.getPurchases error",e),[]))}consumePurchase(e){return G().then(t=>t.consumePurchase(e)).catch(e=>(console.error("YandexPurchase.consumePurchase error",e),Promise.reject(e)))}loadCatalog(){return G().then(e=>e.getCatalog()).then(e=>this.formatCatalog(e)).catch(e=>(console.error("YandexPurchase.loadCatalog error",e),Promise.reject(e)))}formatCatalog(e){return e&&e.length?e.reduce((e,t)=>(e[t.id]={id:t.id,title:t.title,description:t.description,price:Number(t.priceValue),photo_url:t.imageURI},e),{}):{}}initCurrency(e){const t=e?.[0]?.priceCurrencyCode;t&&(this.currency=t)}}function $(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Q extends P{constructor(){super(...arguments),$(this,"safeStorage",void 0),$(this,"player",void 0)}init(){return Promise.all([this.initPlayer(),this.initStorage()]).then(()=>{console.log("YandexStorage init",this.player,this.safeStorage)}).catch(e=>{console.error("YandexStorage init error",e)})}initPlayer(){return O().then(e=>{this.player=e}).catch(e=>{console.error("YandexStorage initPlayer error",e)})}initStorage(){return M().getStorage().then(e=>{this.safeStorage=e}).catch(e=>{console.error("YandexStorage init error",e)})}getLocalStorage(){return this.safeStorage||super.getLocalStorage()}get(e){return Promise.all([this.getFromPlatform(e)])}set(e,t){return this.setToPlatform(e,t)}getFromPlatform(e){return this.player.getData(e).catch(e=>(console.error("YandexStorage getFromPlatform error",e),[]))}setToPlatform(e,t){return this.player.setData(e,t).catch(e=>(console.error("YandexStorage setToPlatform error",e),Promise.reject(e)))}}class H extends x{constructor(e){var t,r,i;super(e),t=this,i="yandex",(r=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(r="platform_prefix"))in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,console.log("YandexAdapter constructor")}gameReady(){M().features.LoadingAPI?.ready(),super.gameReady()}gameplayStart(){M().features.GameplayAPI?.start()}gameplayStop(){M().features.GameplayAPI?.stop()}getLang(){return M().environment.i18n.lang||"en"}getServerTime(){return Promise.resolve(M().serverTime())}domainlock(e){I()||super.domainlock(e)}redirect(e){super.redirect(A+this.options.app_id)}initApi(){return C().then(e=>{console.log("YandexAdapter initApi",e),this.api=e,this.options.app_id||(this.options.app_id=e.environment.app.id)})}initModules(){return Promise.all([this.initFlags(),super.initModules()])}initFlags(){return M().getFlags().then(e=>{const t=this.options.flags;this.options.flags={...t,...e}})}createPlayer(){return new V(this)}createStorage(){return new Q(this)}createAdvertising(){return new J(this)}createLeaderboard(){return new z(this)}createMakeReview(){return new F(this)}createSetShortcut(){return new N(this)}createPurchase(){return new K(this)}}const X=new(0,t.A)({app_id:393972,leaderboard_name:"MainLeaders"});window.addEventListener("load",function(){window.createGame&&window.createGame(X)})}();!function(){var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){var e={34:function(t,e,n){"use strict";var r=n(4901);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},76:function(t){"use strict";t.exports=Function.prototype.call},81:function(t,e,n){"use strict";var r=n(9565),i=n(9306),s=n(8551),o=n(6823),a=n(851),l=TypeError;t.exports=function(t,e){var n=arguments.length<2?a(t):e;if(i(n))return s(r(n,t));throw new l(o(t)+" is not iterable")}},113:function(t,e,n){"use strict";var r=n(6518),i=n(9213).find,s=n(6469),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r({target:"Array",proto:!0,forced:a},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),s(o)},116:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(2652),o=n(9306),a=n(8551),l=n(1767),c=n(9539),h=n(4549)("find",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:h},{find:function(t){a(this);try{o(t)}catch(t){c(this,"throw",t)}if(h)return i(h,this,t);var e=l(this),n=0;return s(e,function(e,r){if(t(e,n++))return r(e)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},228:function(t){"use strict";var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,r,s,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,s||t,o),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function o(t,e){0===--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,i,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var l,c,h=this._events[a],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,r),!0;case 4:return h.fn.call(h.context,e,r,i),!0;case 5:return h.fn.call(h.context,e,r,i,s),!0;case 6:return h.fn.call(h.context,e,r,i,s,o),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];h.fn.apply(h.context,l)}else{var d,p=h.length;for(c=0;c<p;c++)switch(h[c].once&&this.removeListener(t,h[c].fn,void 0,!0),u){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,e);break;case 3:h[c].fn.call(h[c].context,e,r);break;case 4:h[c].fn.call(h[c].context,e,r,i);break;default:if(!l)for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];h[c].fn.apply(h[c].context,l)}}return!0},a.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,i){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||i&&!a.once||r&&a.context!==r||o(this,s);else{for(var l=0,c=[],h=a.length;l<h;l++)(a[l].fn!==e||i&&!a[l].once||r&&a[l].context!==r)&&c.push(a[l]);c.length?this._events[s]=1===c.length?c[0]:c:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a},235:function(t,e,n){"use strict";var r=n(9213).forEach,i=n(4598)("forEach");t.exports=i?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},280:function(t,e,n){"use strict";var r=n(6518),i=n(7751),s=n(6395),o=n(550),a=n(916).CONSTRUCTOR,l=n(3438),c=i("Promise"),h=s&&!a;r({target:"Promise",stat:!0,forced:s||a},{resolve:function(t){return l(h&&this===c?o:this,t)}})},283:function(t,e,n){"use strict";var r=n(9504),i=n(9039),s=n(4901),o=n(9297),a=n(3724),l=n(350).CONFIGURABLE,c=n(3706),h=n(1181),u=h.enforce,d=h.get,p=String,f=Object.defineProperty,m=r("".slice),g=r("".replace),v=r([].join),y=a&&!i(function(){return 8!==f(function(){},"length",{value:8}).length}),x=String(String).split("String"),w=t.exports=function(t,e,n){"Symbol("===m(p(e),0,7)&&(e="["+g(p(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!o(t,"name")||l&&t.name!==e)&&(a?f(t,"name",{value:e,configurable:!0}):t.name=e),y&&n&&o(n,"arity")&&t.length!==n.arity&&f(t,"length",{value:n.arity});try{n&&o(n,"constructor")&&n.constructor?a&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=u(t);return o(r,"source")||(r.source=v(x,"string"==typeof e?e:"")),t};Function.prototype.toString=w(function(){return s(this)&&d(this).source||c(this)},"toString")},298:function(t,e,n){"use strict";var r=n(2195),i=n(5397),s=n(8480).f,o=n(7680),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"Window"===r(t)?function(t){try{return s(t)}catch(t){return o(a)}}(t):s(i(t))}},350:function(t,e,n){"use strict";var r=n(3724),i=n(9297),s=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=i(s,"name"),l=a&&"something"===function(){}.name,c=a&&(!r||r&&o(s,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},397:function(t,e,n){"use strict";var r=n(7751);t.exports=r("document","documentElement")},414:function(t){"use strict";t.exports=Math.round},421:function(t){"use strict";t.exports={}},436:function(t,e,n){"use strict";var r,i,s,o,a=n(6518),l=n(6395),c=n(8574),h=n(4576),u=n(9167),d=n(9565),p=n(6840),f=n(2967),m=n(687),g=n(7633),v=n(9306),y=n(4901),x=n(34),w=n(679),_=n(2293),b=n(9225).set,A=n(1955),T=n(3138),S=n(1103),E=n(8265),k=n(1181),M=n(550),C=n(916),P=n(6043),I="Promise",R=C.CONSTRUCTOR,O=C.REJECTION_EVENT,D=C.SUBCLASSING,L=k.getterFor(I),F=k.set,B=M&&M.prototype,N=M,W=B,U=h.TypeError,j=h.document,H=h.process,z=P.f,G=z,X=!!(j&&j.createEvent&&h.dispatchEvent),V="unhandledrejection",Y=function(t){var e;return!(!x(t)||!y(e=t.then))&&e},$=function(t,e){var n,r,i,s=e.value,o=1===e.state,a=o?t.ok:t.fail,l=t.resolve,c=t.reject,h=t.domain;try{a?(o||(2===e.rejection&&J(e),e.rejection=1),!0===a?n=s:(h&&h.enter(),n=a(s),h&&(h.exit(),i=!0)),n===t.promise?c(new U("Promise-chain cycle")):(r=Y(n))?d(r,n,l,c):l(n)):c(s)}catch(t){h&&!i&&h.exit(),c(t)}},q=function(t,e){t.notified||(t.notified=!0,A(function(){for(var n,r=t.reactions;n=r.get();)$(n,t);t.notified=!1,e&&!t.rejection&&Z(t)}))},K=function(t,e,n){var r,i;X?((r=j.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),h.dispatchEvent(r)):r={promise:e,reason:n},!O&&(i=h["on"+t])?i(r):t===V&&T("Unhandled promise rejection",n)},Z=function(t){d(b,h,function(){var e,n=t.facade,r=t.value;if(Q(t)&&(e=S(function(){c?H.emit("unhandledRejection",r,n):K(V,n,r)}),t.rejection=c||Q(t)?2:1,e.error))throw e.value})},Q=function(t){return 1!==t.rejection&&!t.parent},J=function(t){d(b,h,function(){var e=t.facade;c?H.emit("rejectionHandled",e):K("rejectionhandled",e,t.value)})},tt=function(t,e,n){return function(r){t(e,r,n)}},et=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,q(t,!0))},nt=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw new U("Promise can't be resolved itself");var r=Y(e);r?A(function(){var n={done:!1};try{d(r,e,tt(nt,n,t),tt(et,n,t))}catch(e){et(n,e,t)}}):(t.value=e,t.state=1,q(t,!1))}catch(e){et({done:!1},e,t)}}};if(R&&(W=(N=function(t){w(this,W),v(t),d(r,this);var e=L(this);try{t(tt(nt,e),tt(et,e))}catch(t){et(e,t)}}).prototype,(r=function(t){F(this,{type:I,done:!1,notified:!1,parent:!1,reactions:new E,rejection:!1,state:0,value:null})}).prototype=p(W,"then",function(t,e){var n=L(this),r=z(_(this,N));return n.parent=!0,r.ok=!y(t)||t,r.fail=y(e)&&e,r.domain=c?H.domain:void 0,0===n.state?n.reactions.add(r):A(function(){$(r,n)}),r.promise}),i=function(){var t=new r,e=L(t);this.promise=t,this.resolve=tt(nt,e),this.reject=tt(et,e)},P.f=z=function(t){return t===N||t===s?new i(t):G(t)},!l&&y(M)&&B!==Object.prototype)){o=B.then,D||p(B,"then",function(t,e){var n=this;return new N(function(t,e){d(o,n,t,e)}).then(t,e)},{unsafe:!0});try{delete B.constructor}catch(t){}f&&f(B,W)}a({global:!0,constructor:!0,wrap:!0,forced:R},{Promise:N}),s=u.Promise,m(N,I,!1,!0),g(I)},453:function(t,e,n){"use strict";var r,i=n(9612),s=n(9383),o=n(1237),a=n(9290),l=n(9538),c=n(8068),h=n(9675),u=n(5345),d=n(1514),p=n(8968),f=n(6188),m=n(8002),g=n(5880),v=n(414),y=n(3093),x=Function,w=function(t){try{return x('"use strict"; return ('+t+").constructor;")()}catch(t){}},_=n(5795),b=n(3036),A=function(){throw new h},T=_?function(){try{return A}catch(t){try{return _(arguments,"callee").get}catch(t){return A}}}():A,S=n(4039)(),E=n(3628),k=n(1064),M=n(8648),C=n(1002),P=n(76),I={},R="undefined"!=typeof Uint8Array&&E?E(Uint8Array):r,O={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":S&&E?E([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":I,"%AsyncGenerator%":I,"%AsyncGeneratorFunction%":I,"%AsyncIteratorPrototype%":I,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":s,"%eval%":eval,"%EvalError%":o,"%Float16Array%":"undefined"==typeof Float16Array?r:Float16Array,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":x,"%GeneratorFunction%":I,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":S&&E?E(E([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&S&&E?E((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":i,"%Object.getOwnPropertyDescriptor%":_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":a,"%ReferenceError%":l,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&S&&E?E((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":S&&E?E(""[Symbol.iterator]()):r,"%Symbol%":S?Symbol:r,"%SyntaxError%":c,"%ThrowTypeError%":T,"%TypedArray%":R,"%TypeError%":h,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":u,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet,"%Function.prototype.call%":P,"%Function.prototype.apply%":C,"%Object.defineProperty%":b,"%Object.getPrototypeOf%":k,"%Math.abs%":d,"%Math.floor%":p,"%Math.max%":f,"%Math.min%":m,"%Math.pow%":g,"%Math.round%":v,"%Math.sign%":y,"%Reflect.getPrototypeOf%":M};if(E)try{null.error}catch(t){var D=E(E(t));O["%Error.prototype%"]=D}var L=function t(e){var n;if("%AsyncFunction%"===e)n=w("async function () {}");else if("%GeneratorFunction%"===e)n=w("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=w("async function* () {}");else if("%AsyncGenerator%"===e){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===e){var i=t("%AsyncGenerator%");i&&E&&(n=E(i.prototype))}return O[e]=n,n},F={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},B=n(6743),N=n(9957),W=B.call(P,Array.prototype.concat),U=B.call(C,Array.prototype.splice),j=B.call(P,String.prototype.replace),H=B.call(P,String.prototype.slice),z=B.call(P,RegExp.prototype.exec),G=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,X=/\\(\\)?/g,V=function(t,e){var n,r=t;if(N(F,r)&&(r="%"+(n=F[r])[0]+"%"),N(O,r)){var i=O[r];if(i===I&&(i=L(r)),void 0===i&&!e)throw new h("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:i}}throw new c("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new h("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new h('"allowMissing" argument must be a boolean');if(null===z(/^%?[^%]*%?$/,t))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(t){var e=H(t,0,1),n=H(t,-1);if("%"===e&&"%"!==n)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new c("invalid intrinsic syntax, expected opening `%`");var r=[];return j(t,G,function(t,e,n,i){r[r.length]=n?j(i,X,"$1"):e||t}),r}(t),r=n.length>0?n[0]:"",i=V("%"+r+"%",e),s=i.name,o=i.value,a=!1,l=i.alias;l&&(r=l[0],U(n,W([0,1],l)));for(var u=1,d=!0;u<n.length;u+=1){var p=n[u],f=H(p,0,1),m=H(p,-1);if(('"'===f||"'"===f||"`"===f||'"'===m||"'"===m||"`"===m)&&f!==m)throw new c("property names with quotes must have matching quotes");if("constructor"!==p&&d||(a=!0),N(O,s="%"+(r+="."+p)+"%"))o=O[s];else if(null!=o){if(!(p in o)){if(!e)throw new h("base intrinsic for "+t+" exists, but the property is not available.");return}if(_&&u+1>=n.length){var g=_(o,p);o=(d=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:o[p]}else d=N(o,p),o=o[p];d&&!a&&(O[s]=o)}}return o}},507:function(t,e,n){"use strict";var r=n(453),i=n(6556),s=n(8859),o=n(9675),a=r("%Map%",!0),l=i("Map.prototype.get",!0),c=i("Map.prototype.set",!0),h=i("Map.prototype.has",!0),u=i("Map.prototype.delete",!0),d=i("Map.prototype.size",!0);t.exports=!!a&&function(){var t,e={assert:function(t){if(!e.has(t))throw new o("Side channel does not contain "+s(t))},delete:function(e){if(t){var n=u(t,e);return 0===d(t)&&(t=void 0),n}return!1},get:function(e){if(t)return l(t,e)},has:function(e){return!!t&&h(t,e)},set:function(e,n){t||(t=new a),c(t,e,n)}};return e}},511:function(t,e,n){"use strict";var r=n(9167),i=n(9297),s=n(1951),o=n(4913).f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});i(e,t)||o(e,t,{value:s.f(t)})}},533:function(t,e,n){"use strict";var r=n(9504),i=n(8014),s=n(655),o=n(2333),a=n(7750),l=r(o),c=r("".slice),h=Math.ceil,u=function(t){return function(e,n,r){var o,u,d=s(a(e)),p=i(n),f=d.length,m=void 0===r?" ":s(r);return p<=f||""===m?d:((u=l(m,h((o=p-f)/m.length))).length>o&&(u=c(u,0,o)),t?d+u:u+d)}};t.exports={start:u(!1),end:u(!0)}},537:function(t,e,n){"use strict";var r=n(550),i=n(4428),s=n(916).CONSTRUCTOR;t.exports=s||!i(function(t){r.all(t).then(void 0,function(){})})},540:function(t){"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},550:function(t,e,n){"use strict";var r=n(4576);t.exports=r.Promise},566:function(t,e,n){"use strict";var r=n(9504),i=n(9306),s=n(34),o=n(9297),a=n(7680),l=n(616),c=Function,h=r([].concat),u=r([].join),d={};t.exports=l?c.bind:function(t){var e=i(this),n=e.prototype,r=a(arguments,1),l=function(){var n=h(r,a(arguments));return this instanceof l?function(t,e,n){if(!o(d,e)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";d[e]=c("C,a","return new C("+u(r,",")+")")}return d[e](t,n)}(e,n.length,n):e.apply(t,n)};return s(n)&&(l.prototype=n),l}},579:function(t,e,n){var r=n(3738).default;t.exports=function(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(r(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports},597:function(t,e,n){"use strict";var r=n(9039),i=n(8227),s=n(9519),o=i("species");t.exports=function(t){return s>=51||!r(function(){var e=[];return(e.constructor={})[o]=function(){return{foo:1}},1!==e[t](Boolean).foo})}},616:function(t,e,n){"use strict";var r=n(9039);t.exports=!r(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})},655:function(t,e,n){"use strict";var r=n(6955),i=String;t.exports=function(t){if("Symbol"===r(t))throw new TypeError("Cannot convert a Symbol value to a string");return i(t)}},679:function(t,e,n){"use strict";var r=n(1625),i=TypeError;t.exports=function(t,e){if(r(e,t))return t;throw new i("Incorrect invocation")}},684:function(t){"use strict";t.exports=function(t,e){var n="function"==typeof Iterator&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch(t){return!0}}},687:function(t,e,n){"use strict";var r=n(4913).f,i=n(9297),s=n(8227)("toStringTag");t.exports=function(t,e,n){t&&!n&&(t=t.prototype),t&&!i(t,s)&&r(t,s,{configurable:!0,value:e})}},706:function(t,e,n){"use strict";var r=n(350).PROPER,i=n(9039),s=n(7452);t.exports=function(t){return i(function(){return!!s[t]()||""!==""[t]()||r&&s[t].name!==t})}},739:function(t,e,n){"use strict";var r=n(6518),i=n(9039),s=n(8981),o=n(2777);r({target:"Date",proto:!0,arity:1,forced:i(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})},{toJSON:function(t){var e=s(this),n=o(e,"number");return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},741:function(t){"use strict";var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},747:function(t,e,n){"use strict";var r=n(6699),i=n(6193),s=n(4659),o=Error.captureStackTrace;t.exports=function(t,e,n,a){s&&(o?o(t,e):r(t,"stack",i(n,a)))}},757:function(t,e,n){"use strict";var r=n(7751),i=n(4901),s=n(1625),o=n(7040),a=Object;t.exports=o?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return i(e)&&s(e.prototype,a(t))}},788:function(t,e,n){"use strict";var r=n(34),i=n(2195),s=n(8227)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[s])?!!e:"RegExp"===i(t))}},825:function(t,e,n){"use strict";var r=n(6518),i=n(7751),s=n(8745),o=n(566),a=n(5548),l=n(8551),c=n(34),h=n(2360),u=n(9039),d=i("Reflect","construct"),p=Object.prototype,f=[].push,m=u(function(){function t(){}return!(d(function(){},[],t)instanceof t)}),g=!u(function(){d(function(){})}),v=m||g;r({target:"Reflect",stat:!0,forced:v,sham:v},{construct:function(t,e){a(t),l(e);var n=arguments.length<3?t:a(arguments[2]);if(g&&!m)return d(t,e,n);if(t===n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return s(f,r,e),new(s(o,t,r))}var i=n.prototype,u=h(c(i)?i:p),v=s(t,u,e);return c(v)?v:u}})},851:function(t,e,n){"use strict";var r=n(6955),i=n(5966),s=n(4117),o=n(6269),a=n(8227)("iterator");t.exports=function(t){if(!s(t))return i(t,a)||i(t,"@@iterator")||o[r(t)]}},887:function(t,e,n){var r=n(6993),i=n(1791);t.exports=function(t,e,n,s,o){return new i(r().w(t,e,n,s),o||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports},906:function(t,e,n){"use strict";n(7495);var r,i,s=n(6518),o=n(9565),a=n(4901),l=n(8551),c=n(655),h=(r=!1,(i=/[ac]/).exec=function(){return r=!0,/./.exec.apply(this,arguments)},!0===i.test("abc")&&r),u=/./.test;s({target:"RegExp",proto:!0,forced:!h},{test:function(t){var e=l(this),n=c(t),r=e.exec;if(!a(r))return o(u,e,n);var i=o(r,e,n);return null!==i&&(l(i),!0)}})},916:function(t,e,n){"use strict";var r=n(4576),i=n(550),s=n(4901),o=n(2796),a=n(3706),l=n(8227),c=n(4215),h=n(6395),u=n(9519),d=i&&i.prototype,p=l("species"),f=!1,m=s(r.PromiseRejectionEvent),g=o("Promise",function(){var t=a(i),e=t!==String(i);if(!e&&66===u)return!0;if(h&&(!d.catch||!d.finally))return!0;if(!u||u<51||!/native code/.test(t)){var n=new i(function(t){t(1)}),r=function(t){t(function(){},function(){})};if((n.constructor={})[p]=r,!(f=n.then(function(){})instanceof r))return!0}return!(e||"BROWSER"!==c&&"DENO"!==c||m)});t.exports={CONSTRUCTOR:g,REJECTION_EVENT:m,SUBCLASSING:f}},920:function(t,e,n){"use strict";var r=n(9675),i=n(8859),s=n(4803),o=n(507),a=n(2271)||o||s;t.exports=function(){var t,e={assert:function(t){if(!e.has(t))throw new r("Side channel does not contain "+i(t))},delete:function(e){return!!t&&t.delete(e)},get:function(e){return t&&t.get(e)},has:function(e){return!!t&&t.has(e)},set:function(e,n){t||(t=a()),t.set(e,n)}};return e}},926:function(t,e,n){"use strict";var r=n(9306),i=n(8981),s=n(7055),o=n(6198),a=TypeError,l="Reduce of empty array with no initial value",c=function(t){return function(e,n,c,h){var u=i(e),d=s(u),p=o(u);if(r(n),0===p&&c<2)throw new a(l);var f=t?p-1:0,m=t?-1:1;if(c<2)for(;;){if(f in d){h=d[f],f+=m;break}if(f+=m,t?f<0:p<=f)throw new a(l)}for(;t?f>=0:p>f;f+=m)f in d&&(h=n(h,d[f],f,u));return h}};t.exports={left:c(!1),right:c(!0)}},958:function(t,e,n){"use strict";n(5240)},1002:function(t){"use strict";t.exports=Function.prototype.apply},1034:function(t,e,n){"use strict";var r=n(9565),i=n(9297),s=n(1625),o=n(5213),a=n(7979),l=RegExp.prototype;t.exports=o.correct?function(t){return t.flags}:function(t){return o.correct||!s(l,t)||i(t,"flags")?t.flags:r(a,t)}},1056:function(t,e,n){"use strict";var r=n(4913).f;t.exports=function(t,e,n){n in t||r(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})}},1064:function(t,e,n){"use strict";var r=n(9612);t.exports=r.getPrototypeOf||null},1072:function(t,e,n){"use strict";var r=n(1828),i=n(8727);t.exports=Object.keys||function(t){return r(t,i)}},1088:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(6395),o=n(350),a=n(4901),l=n(3994),c=n(2787),h=n(2967),u=n(687),d=n(6699),p=n(6840),f=n(8227),m=n(6269),g=n(7657),v=o.PROPER,y=o.CONFIGURABLE,x=g.IteratorPrototype,w=g.BUGGY_SAFARI_ITERATORS,_=f("iterator"),b="keys",A="values",T="entries",S=function(){return this};t.exports=function(t,e,n,o,f,g,E){l(n,e,o);var k,M,C,P=function(t){if(t===f&&L)return L;if(!w&&t&&t in O)return O[t];switch(t){case b:case A:case T:return function(){return new n(this,t)}}return function(){return new n(this)}},I=e+" Iterator",R=!1,O=t.prototype,D=O[_]||O["@@iterator"]||f&&O[f],L=!w&&D||P(f),F="Array"===e&&O.entries||D;if(F&&(k=c(F.call(new t)))!==Object.prototype&&k.next&&(s||c(k)===x||(h?h(k,x):a(k[_])||p(k,_,S)),u(k,I,!0,!0),s&&(m[I]=S)),v&&f===A&&D&&D.name!==A&&(!s&&y?d(O,"name",A):(R=!0,L=function(){return i(D,this)})),f)if(M={values:P(A),keys:g?L:P(b),entries:P(T)},E)for(C in M)(w||R||!(C in O))&&p(O,C,M[C]);else r({target:e,proto:!0,forced:w||R},M);return s&&!E||O[_]===L||p(O,_,L,{name:f}),m[e]=L,M}},1103:function(t){"use strict";t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},1113:function(t){"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},1181:function(t,e,n){"use strict";var r,i,s,o=n(8622),a=n(4576),l=n(34),c=n(6699),h=n(9297),u=n(7629),d=n(6119),p=n(421),f="Object already initialized",m=a.TypeError,g=a.WeakMap;if(o||u.state){var v=u.state||(u.state=new g);v.get=v.get,v.has=v.has,v.set=v.set,r=function(t,e){if(v.has(t))throw new m(f);return e.facade=t,v.set(t,e),e},i=function(t){return v.get(t)||{}},s=function(t){return v.has(t)}}else{var y=d("state");p[y]=!0,r=function(t,e){if(h(t,y))throw new m(f);return e.facade=t,c(t,y,e),e},i=function(t){return h(t,y)?t[y]:{}},s=function(t){return h(t,y)}}t.exports={set:r,get:i,has:s,enforce:function(t){return s(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!l(e)||(n=i(e)).type!==t)throw new m("Incompatible receiver, "+t+" required");return n}}}},1237:function(t){"use strict";t.exports=EvalError},1240:function(t,e,n){"use strict";var r=n(9504);t.exports=r(1.1.valueOf)},1270:function(t,e,n){var r;t=n.nmd(t),function(){e&&e.nodeType,t&&t.nodeType;var i="object"==typeof n.g&&n.g;i.global!==i&&i.window!==i&&i.self;var s,o=2147483647,a=36,l=/^xn--/,c=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,u={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,p=String.fromCharCode;function f(t){throw new RangeError(u[t])}function m(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function g(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+m((t=t.replace(h,".")).split("."),e).join(".")}function v(t){for(var e,n,r=[],i=0,s=t.length;i<s;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<s?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function y(t){return m(t,function(t){var e="";return t>65535&&(e+=p((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+p(t)}).join("")}function x(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:a}function w(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function _(t,e,n){var r=0;for(t=n?d(t/700):t>>1,t+=d(t/e);t>455;r+=a)t=d(t/35);return d(r+36*t/(t+38))}function b(t){var e,n,r,i,s,l,c,h,u,p,m=[],g=t.length,v=0,w=128,b=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&f("not-basic"),m.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<g;){for(s=v,l=1,c=a;i>=g&&f("invalid-input"),((h=x(t.charCodeAt(i++)))>=a||h>d((o-v)/l))&&f("overflow"),v+=h*l,!(h<(u=c<=b?1:c>=b+26?26:c-b));c+=a)l>d(o/(p=a-u))&&f("overflow"),l*=p;b=_(v-s,e=m.length+1,0==s),d(v/e)>o-w&&f("overflow"),w+=d(v/e),v%=e,m.splice(v++,0,w)}return y(m)}function A(t){var e,n,r,i,s,l,c,h,u,m,g,y,x,b,A,T=[];for(y=(t=v(t)).length,e=128,n=0,s=72,l=0;l<y;++l)(g=t[l])<128&&T.push(p(g));for(r=i=T.length,i&&T.push("-");r<y;){for(c=o,l=0;l<y;++l)(g=t[l])>=e&&g<c&&(c=g);for(c-e>d((o-n)/(x=r+1))&&f("overflow"),n+=(c-e)*x,e=c,l=0;l<y;++l)if((g=t[l])<e&&++n>o&&f("overflow"),g==e){for(h=n,u=a;!(h<(m=u<=s?1:u>=s+26?26:u-s));u+=a)A=h-m,b=a-m,T.push(p(w(m+A%b,0))),h=d(A/b);T.push(p(w(h,0))),s=_(n,x,r==i),n=0,++r}++n,++e}return T.join("")}s={version:"1.4.1",ucs2:{decode:v,encode:y},decode:b,encode:A,toASCII:function(t){return g(t,function(t){return c.test(t)?"xn--"+A(t):t})},toUnicode:function(t){return g(t,function(t){return l.test(t)?b(t.slice(4).toLowerCase()):t})}},void 0===(r=function(){return s}.call(e,n,e,t))||(t.exports=r)}()},1278:function(t,e,n){"use strict";var r=n(6518),i=n(3724),s=n(5031),o=n(5397),a=n(7347),l=n(2278);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),i=a.f,c=s(r),h={},u=0;c.length>u;)void 0!==(n=i(r,e=c[u++]))&&l(h,e,n);return h}})},1291:function(t,e,n){"use strict";var r=n(741);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},1296:function(t,e,n){"use strict";var r=n(4495);t.exports=r&&!!Symbol.for&&!!Symbol.keyFor},1333:function(t){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(var r in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var i=Object.getOwnPropertySymbols(t);if(1!==i.length||i[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(t,e);if(42!==s.value||!0!==s.enumerable)return!1}return!0}},1354:function(t){"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),s="/*# ".concat(i," */");return[e].concat([s]).join("\n")}return[e].join("\n")}},1385:function(t,e,n){"use strict";var r=n(9539);t.exports=function(t,e,n){for(var i=t.length-1;i>=0;i--)if(void 0!==t[i])try{n=r(t[i].iterator,e,n)}catch(t){e="throw",n=t}if("throw"===e)throw n;return n}},1415:function(t,e,n){"use strict";n(2405)},1436:function(t,e,n){"use strict";var r=n(8227)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,"/./"[t](e)}catch(t){}}return!1}},1454:function(t,e,n){"use strict";n(1701)},1469:function(t,e,n){"use strict";var r=n(7433);t.exports=function(t,e){return new(r(t))(0===e?0:e)}},1481:function(t,e,n){"use strict";var r=n(6518),i=n(6043);r({target:"Promise",stat:!0,forced:n(916).CONSTRUCTOR},{reject:function(t){var e=i.f(this);return(0,e.reject)(t),e.promise}})},1510:function(t,e,n){"use strict";var r=n(6518),i=n(7751),s=n(9297),o=n(655),a=n(5745),l=n(1296),c=a("string-to-symbol-registry"),h=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!l},{for:function(t){var e=o(t);if(s(c,e))return c[e];var n=i("Symbol")(e);return c[e]=n,h[n]=e,n}})},1514:function(t){"use strict";t.exports=Math.abs},1625:function(t,e,n){"use strict";var r=n(9504);t.exports=r({}.isPrototypeOf)},1699:function(t,e,n){"use strict";var r=n(6518),i=n(9504),s=n(5749),o=n(7750),a=n(655),l=n(1436),c=i("".indexOf);r({target:"String",proto:!0,forced:!l("includes")},{includes:function(t){return!!~c(a(o(this)),a(s(t)),arguments.length>1?arguments[1]:void 0)}})},1701:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(9306),o=n(8551),a=n(1767),l=n(9462),c=n(6319),h=n(9539),u=n(684),d=n(4549),p=n(6395),f=!p&&!u("map",function(){}),m=!p&&!f&&d("map",TypeError),g=p||f||m,v=l(function(){var t=this.iterator,e=o(i(this.next,t));if(!(this.done=!!e.done))return c(t,this.mapper,[e.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(t){o(this);try{s(t)}catch(t){h(this,"throw",t)}return m?i(m,this,t):new v(a(this),{mapper:t})}})},1755:function(t,e,n){"use strict";var r=n(1354),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([t.id,"/* ------- admin-panel ---------- */\r\n.admin-panel__bg {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    background: rgba(0, 0, 0, 0.6);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: 9999;\r\n}\r\n\r\n.admin-panel__window {\r\n    background: gray;\r\n    border-radius: 14px;\r\n    box-shadow: 2px 2px 10px #000000;\r\n    padding: 20px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 5px;\r\n    font-family: sans-serif;\r\n}\r\n\r\n.admin-panel__row {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    gap: 12px;\r\n}\r\n\r\n.admin-panel__btn {\r\n    min-width: 40px;\r\n    padding: 8px 16px;\r\n    border-radius: 8px;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n    margin-top: 10px;\r\n    border: 2px solid #000000;\r\n    transition: border-color 0.18s cubic-bezier(.45, 1.8, .35, 1);\r\n}\r\n\r\n.admin-panel__btn:hover {\r\n    border-color: #ffffff;\r\n}\r\n\r\n.admin-panel__btn--save {\r\n    background: #1EB500;\r\n    color: #fff;\r\n}\r\n\r\n.admin-panel__btn--reset {\r\n    background: #d32424;\r\n    color: #fff;\r\n    margin-left: 8px;\r\n}\r\n\r\n\r\n/* ------- admin-panel__password -------- */\r\n.admin-panel__password {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    gap: 16px;\r\n}\r\n\r\n.admin-panel__password-input {\r\n    font-size: 22px;\r\n    padding: 8px 18px;\r\n    width: 110px;\r\n    border-radius: 7px;\r\n    border: 2px solid #aaa;\r\n    text-align: center;\r\n    outline: none;\r\n    letter-spacing: 8px;\r\n}\r\n\r\n.admin-panel__btn--password {\r\n    min-width: 80px;\r\n    border-radius: 8px;\r\n    font-size: 15px;\r\n    cursor: pointer;\r\n    background: #1176ee;\r\n    color: #fff;\r\n    border: 4px groove #000000;\r\n    transition: border-color 0.18s cubic-bezier(.45, 1.8, .35, 1);\r\n}\r\n\r\n.admin-panel__btn--password:hover {\r\n    border-color: #ffffff;\r\n}\r\n\r\n.admin-panel__password-error {\r\n    color: #d32424;\r\n    font-size: 15px;\r\n    min-height: 18px;\r\n    margin-top: 4px;\r\n}\r\n\r\n\r\n/* -------- btn close ----------- */\r\n.admin-panel__close {\r\n    position: absolute;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n\r\n    top: -10px;\r\n    right: -10px;\r\n    background: gray;\r\n    color: white;\r\n    font-size: 28px;\r\n    cursor: pointer;\r\n    width: 30px;\r\n    height: 30px;\r\n    border-radius: 10px;\r\n}\r\n\r\n.admin-panel__close:hover {\r\n    color: #d32424;\r\n}\r\n\r\n.admin-panel__window {\r\n    position: relative; /*     */\r\n}\r\n","",{version:3,sources:["webpack://./src/styles/adminPanel.css"],names:[],mappings:"AAAA,mCAAmC;AACnC;IACI,eAAe;IACf,MAAM;IACN,OAAO;IACP,YAAY;IACZ,aAAa;IACb,8BAA8B;IAC9B,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,aAAa;AACjB;;AAEA;IACI,gBAAgB;IAChB,mBAAmB;IACnB,gCAAgC;IAChC,aAAa;IACb,aAAa;IACb,sBAAsB;IACtB,QAAQ;IACR,uBAAuB;AAC3B;;AAEA;IACI,aAAa;IACb,eAAe;IACf,mBAAmB;IACnB,8BAA8B;IAC9B,SAAS;AACb;;AAEA;IACI,eAAe;IACf,iBAAiB;IACjB,kBAAkB;IAClB,eAAe;IACf,eAAe;IACf,gBAAgB;IAChB,yBAAyB;IACzB,6DAA6D;AACjE;;AAEA;IACI,qBAAqB;AACzB;;AAEA;IACI,mBAAmB;IACnB,WAAW;AACf;;AAEA;IACI,mBAAmB;IACnB,WAAW;IACX,gBAAgB;AACpB;;;AAGA,2CAA2C;AAC3C;IACI,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,SAAS;AACb;;AAEA;IACI,eAAe;IACf,iBAAiB;IACjB,YAAY;IACZ,kBAAkB;IAClB,sBAAsB;IACtB,kBAAkB;IAClB,aAAa;IACb,mBAAmB;AACvB;;AAEA;IACI,eAAe;IACf,kBAAkB;IAClB,eAAe;IACf,eAAe;IACf,mBAAmB;IACnB,WAAW;IACX,0BAA0B;IAC1B,6DAA6D;AACjE;;AAEA;IACI,qBAAqB;AACzB;;AAEA;IACI,cAAc;IACd,eAAe;IACf,gBAAgB;IAChB,eAAe;AACnB;;;AAGA,mCAAmC;AACnC;IACI,kBAAkB;IAClB,aAAa;IACb,mBAAmB;IACnB,uBAAuB;;IAEvB,UAAU;IACV,YAAY;IACZ,gBAAgB;IAChB,YAAY;IACZ,eAAe;IACf,eAAe;IACf,WAAW;IACX,YAAY;IACZ,mBAAmB;AACvB;;AAEA;IACI,cAAc;AAClB;;AAEA;IACI,kBAAkB,EAAE,8CAA8C;AACtE",sourcesContent:["/* ------- admin-panel ---------- */\r\n.admin-panel__bg {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    background: rgba(0, 0, 0, 0.6);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: 9999;\r\n}\r\n\r\n.admin-panel__window {\r\n    background: gray;\r\n    border-radius: 14px;\r\n    box-shadow: 2px 2px 10px #000000;\r\n    padding: 20px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 5px;\r\n    font-family: sans-serif;\r\n}\r\n\r\n.admin-panel__row {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    gap: 12px;\r\n}\r\n\r\n.admin-panel__btn {\r\n    min-width: 40px;\r\n    padding: 8px 16px;\r\n    border-radius: 8px;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n    margin-top: 10px;\r\n    border: 2px solid #000000;\r\n    transition: border-color 0.18s cubic-bezier(.45, 1.8, .35, 1);\r\n}\r\n\r\n.admin-panel__btn:hover {\r\n    border-color: #ffffff;\r\n}\r\n\r\n.admin-panel__btn--save {\r\n    background: #1EB500;\r\n    color: #fff;\r\n}\r\n\r\n.admin-panel__btn--reset {\r\n    background: #d32424;\r\n    color: #fff;\r\n    margin-left: 8px;\r\n}\r\n\r\n\r\n/* ------- admin-panel__password -------- */\r\n.admin-panel__password {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    gap: 16px;\r\n}\r\n\r\n.admin-panel__password-input {\r\n    font-size: 22px;\r\n    padding: 8px 18px;\r\n    width: 110px;\r\n    border-radius: 7px;\r\n    border: 2px solid #aaa;\r\n    text-align: center;\r\n    outline: none;\r\n    letter-spacing: 8px;\r\n}\r\n\r\n.admin-panel__btn--password {\r\n    min-width: 80px;\r\n    border-radius: 8px;\r\n    font-size: 15px;\r\n    cursor: pointer;\r\n    background: #1176ee;\r\n    color: #fff;\r\n    border: 4px groove #000000;\r\n    transition: border-color 0.18s cubic-bezier(.45, 1.8, .35, 1);\r\n}\r\n\r\n.admin-panel__btn--password:hover {\r\n    border-color: #ffffff;\r\n}\r\n\r\n.admin-panel__password-error {\r\n    color: #d32424;\r\n    font-size: 15px;\r\n    min-height: 18px;\r\n    margin-top: 4px;\r\n}\r\n\r\n\r\n/* -------- btn close ----------- */\r\n.admin-panel__close {\r\n    position: absolute;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n\r\n    top: -10px;\r\n    right: -10px;\r\n    background: gray;\r\n    color: white;\r\n    font-size: 28px;\r\n    cursor: pointer;\r\n    width: 30px;\r\n    height: 30px;\r\n    border-radius: 10px;\r\n}\r\n\r\n.admin-panel__close:hover {\r\n    color: #d32424;\r\n}\r\n\r\n.admin-panel__window {\r\n    position: relative; /*     */\r\n}\r\n"],sourceRoot:""}]),e.A=o},1761:function(t,e,n){"use strict";var r=n(9565),i=n(9504),s=n(9228),o=n(8551),a=n(34),l=n(8014),c=n(655),h=n(7750),u=n(5966),d=n(7829),p=n(1034),f=n(6682),m=i("".indexOf);s("match",function(t,e,n){return[function(e){var n=h(this),i=a(e)?u(e,t):void 0;return i?r(i,e,n):new RegExp(e)[t](c(n))},function(t){var r=o(this),i=c(t),s=n(e,r,i);if(s.done)return s.value;var a=c(p(r));if(-1===m(a,"g"))return f(r,i);var h=-1!==m(a,"u");r.lastIndex=0;for(var u,g=[],v=0;null!==(u=f(r,i));){var y=c(u[0]);g[v]=y,""===y&&(r.lastIndex=d(i,l(r.lastIndex),h)),v++}return 0===v?null:g}]})},1767:function(t){"use strict";t.exports=function(t){return{iterator:t,next:t.next,done:!1}}},1791:function(t,e,n){var r=n(5172),i=n(5546);t.exports=function t(e,n){function s(t,i,o,a){try{var l=e[t](i),c=l.value;return c instanceof r?n.resolve(c.v).then(function(t){s("next",t,o,a)},function(t){s("throw",t,o,a)}):n.resolve(c).then(function(t){l.value=t,o(l)},function(t){return s("throw",t,o,a)})}catch(t){a(t)}}var o;this.next||(i(t.prototype),i(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),i(this,"_invoke",function(t,e,r){function i(){return new n(function(e,n){s(t,r,e,n)})}return o=o?o.then(i,i):i()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports},1828:function(t,e,n){"use strict";var r=n(9504),i=n(9297),s=n(5397),o=n(9617).indexOf,a=n(421),l=r([].push);t.exports=function(t,e){var n,r=s(t),c=0,h=[];for(n in r)!i(a,n)&&i(r,n)&&l(h,n);for(;e.length>c;)i(r,n=e[c++])&&(~o(h,n)||l(h,n));return h}},1951:function(t,e,n){"use strict";var r=n(8227);e.f=r},1955:function(t,e,n){"use strict";var r,i,s,o,a,l=n(4576),c=n(3389),h=n(6080),u=n(9225).set,d=n(8265),p=n(9544),f=n(4265),m=n(7860),g=n(8574),v=l.MutationObserver||l.WebKitMutationObserver,y=l.document,x=l.process,w=l.Promise,_=c("queueMicrotask");if(!_){var b=new d,A=function(){var t,e;for(g&&(t=x.domain)&&t.exit();e=b.get();)try{e()}catch(t){throw b.head&&r(),t}t&&t.enter()};p||g||m||!v||!y?!f&&w&&w.resolve?((o=w.resolve(void 0)).constructor=w,a=h(o.then,o),r=function(){a(A)}):g?r=function(){x.nextTick(A)}:(u=h(u,l),r=function(){u(A)}):(i=!0,s=y.createTextNode(""),new v(A).observe(s,{characterData:!0}),r=function(){s.data=i=!i}),_=function(t){b.head||r(),b.add(t)}}t.exports=_},2003:function(t,e,n){"use strict";var r=n(6518),i=n(6395),s=n(916).CONSTRUCTOR,o=n(550),a=n(7751),l=n(4901),c=n(6840),h=o&&o.prototype;if(r({target:"Promise",proto:!0,forced:s,real:!0},{catch:function(t){return this.then(void 0,t)}}),!i&&l(o)){var u=a("Promise").prototype.catch;h.catch!==u&&c(h,"catch",u,{unsafe:!0})}},2008:function(t,e,n){"use strict";var r=n(6518),i=n(9213).filter;r({target:"Array",proto:!0,forced:!n(597)("filter")},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},2062:function(t,e,n){"use strict";var r=n(6518),i=n(9213).map;r({target:"Array",proto:!0,forced:!n(597)("map")},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},2106:function(t,e,n){"use strict";var r=n(283),i=n(4913);t.exports=function(t,e,n){return n.get&&r(n.get,e,{getter:!0}),n.set&&r(n.set,e,{setter:!0}),i.f(t,e,n)}},2140:function(t,e,n){"use strict";var r={};r[n(8227)("toStringTag")]="z",t.exports="[object z]"===String(r)},2195:function(t,e,n){"use strict";var r=n(9504),i=r({}.toString),s=r("".slice);t.exports=function(t){return s(i(t),8,-1)}},2211:function(t,e,n){"use strict";var r=n(9039);t.exports=!r(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},2259:function(t,e,n){"use strict";n(511)("iterator")},2271:function(t,e,n){"use strict";var r=n(453),i=n(6556),s=n(8859),o=n(507),a=n(9675),l=r("%WeakMap%",!0),c=i("WeakMap.prototype.get",!0),h=i("WeakMap.prototype.set",!0),u=i("WeakMap.prototype.has",!0),d=i("WeakMap.prototype.delete",!0);t.exports=l?function(){var t,e,n={assert:function(t){if(!n.has(t))throw new a("Side channel does not contain "+s(t))},delete:function(n){if(l&&n&&("object"==typeof n||"function"==typeof n)){if(t)return d(t,n)}else if(o&&e)return e.delete(n);return!1},get:function(n){return l&&n&&("object"==typeof n||"function"==typeof n)&&t?c(t,n):e&&e.get(n)},has:function(n){return l&&n&&("object"==typeof n||"function"==typeof n)&&t?u(t,n):!!e&&e.has(n)},set:function(n,r){l&&n&&("object"==typeof n||"function"==typeof n)?(t||(t=new l),h(t,n,r)):o&&(e||(e=o()),e.set(n,r))}};return n}:o},2278:function(t,e,n){"use strict";var r=n(3724),i=n(4913),s=n(6980);t.exports=function(t,e,n){r?i.f(t,e,s(0,n)):t[e]=n}},2293:function(t,e,n){"use strict";var r=n(8551),i=n(5548),s=n(4117),o=n(8227)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||s(n=r(a)[o])?e:i(n)}},2333:function(t,e,n){"use strict";var r=n(1291),i=n(655),s=n(7750),o=RangeError;t.exports=function(t){var e=i(s(this)),n="",a=r(t);if(a<0||a===1/0)throw new o("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(n+=e);return n}},2357:function(t,e,n){"use strict";var r=n(3724),i=n(9039),s=n(9504),o=n(2787),a=n(1072),l=n(5397),c=s(n(8773).f),h=s([].push),u=r&&i(function(){var t=Object.create(null);return t[2]=2,!c(t,2)}),d=function(t){return function(e){for(var n,i=l(e),s=a(i),d=u&&null===o(i),p=s.length,f=0,m=[];p>f;)n=s[f++],r&&!(d?n in i:c(i,n))||h(m,t?[n,i[n]]:i[n]);return m}};t.exports={entries:d(!0),values:d(!1)}},2360:function(t,e,n){"use strict";var r,i=n(8551),s=n(6801),o=n(8727),a=n(421),l=n(397),c=n(4055),h=n(6119),u="prototype",d="script",p=h("IE_PROTO"),f=function(){},m=function(t){return"<"+d+">"+t+"</"+d+">"},g=function(t){t.write(m("")),t.close();var e=t.parentWindow.Object;return t=null,e},v=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}var t,e,n;v="undefined"!=typeof document?document.domain&&r?g(r):(e=c("iframe"),n="java"+d+":",e.style.display="none",l.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(m("document.F=Object")),t.close(),t.F):g(r);for(var i=o.length;i--;)delete v[u][o[i]];return v()};a[p]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(f[u]=i(t),n=new f,f[u]=null,n[p]=t):n=v(),void 0===e?n:s.f(n,e)}},2405:function(t,e,n){"use strict";n(6468)("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},n(6938))},2478:function(t,e,n){"use strict";var r=n(9504),i=n(8981),s=Math.floor,o=r("".charAt),a=r("".replace),l=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,h=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,r,u,d){var p=n+t.length,f=r.length,m=h;return void 0!==u&&(u=i(u),m=c),a(d,m,function(i,a){var c;switch(o(a,0)){case"$":return"$";case"&":return t;case"`":return l(e,0,n);case"'":return l(e,p);case"<":c=u[l(a,1,-1)];break;default:var h=+a;if(0===h)return i;if(h>f){var d=s(h/10);return 0===d?i:d<=f?void 0===r[d-1]?o(a,1):r[d-1]+o(a,1):i}c=r[h-1]}return void 0===c?"":c})}},2489:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(9306),o=n(8551),a=n(1767),l=n(9462),c=n(6319),h=n(6395),u=n(9539),d=n(684),p=n(4549),f=!h&&!d("filter",function(){}),m=!h&&!f&&p("filter",TypeError),g=h||f||m,v=l(function(){for(var t,e,n=this.iterator,r=this.predicate,s=this.next;;){if(t=o(i(s,n)),this.done=!!t.done)return;if(e=t.value,c(n,r,[e,this.counter++],!0))return e}});r({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(t){o(this);try{s(t)}catch(t){u(this,"throw",t)}return m?i(m,this,t):new v(a(this),{predicate:t})}})},2529:function(t){"use strict";t.exports=function(t,e){return{value:t,done:e}}},2577:function(t,e,n){"use strict";n(116)},2603:function(t,e,n){"use strict";var r=n(655);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:r(t)}},2634:function(){},2642:function(t,e,n){"use strict";var r=n(7720),i=Object.prototype.hasOwnProperty,s=Array.isArray,o={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:r.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},a=function(t){return t.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},l=function(t,e,n){if(t&&"string"==typeof t&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&n>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(1===e.arrayLimit?"":"s")+" allowed in an array.");return t},c=function(t,e,n,s){if(t){var o=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,a=/(\[[^[\]]*])/g,c=n.depth>0&&/(\[[^[\]]*])/.exec(o),h=c?o.slice(0,c.index):o,u=[];if(h){if(!n.plainObjects&&i.call(Object.prototype,h)&&!n.allowPrototypes)return;u.push(h)}for(var d=0;n.depth>0&&null!==(c=a.exec(o))&&d<n.depth;){if(d+=1,!n.plainObjects&&i.call(Object.prototype,c[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(c[1])}if(c){if(!0===n.strictDepth)throw new RangeError("Input depth exceeded depth option of "+n.depth+" and strictDepth is true");u.push("["+o.slice(c.index)+"]")}return function(t,e,n,i){var s=0;if(t.length>0&&"[]"===t[t.length-1]){var o=t.slice(0,-1).join("");s=Array.isArray(e)&&e[o]?e[o].length:0}for(var a=i?e:l(e,n,s),c=t.length-1;c>=0;--c){var h,u=t[c];if("[]"===u&&n.parseArrays)h=n.allowEmptyArrays&&(""===a||n.strictNullHandling&&null===a)?[]:r.combine([],a);else{h=n.plainObjects?{__proto__:null}:{};var d="["===u.charAt(0)&&"]"===u.charAt(u.length-1)?u.slice(1,-1):u,p=n.decodeDotInKeys?d.replace(/%2E/g,"."):d,f=parseInt(p,10);n.parseArrays||""!==p?!isNaN(f)&&u!==p&&String(f)===p&&f>=0&&n.parseArrays&&f<=n.arrayLimit?(h=[])[f]=a:"__proto__"!==p&&(h[p]=a):h={0:a}}a=h}return a}(u,e,n,s)}};t.exports=function(t,e){var n=function(t){if(!t)return o;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.decodeDotInKeys&&"boolean"!=typeof t.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(void 0!==t.throwOnLimitExceeded&&"boolean"!=typeof t.throwOnLimitExceeded)throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var e=void 0===t.charset?o.charset:t.charset,n=void 0===t.duplicates?o.duplicates:t.duplicates;if("combine"!==n&&"first"!==n&&"last"!==n)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===t.allowDots?!0===t.decodeDotInKeys||o.allowDots:!!t.allowDots,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:o.allowEmptyArrays,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:o.allowPrototypes,allowSparse:"boolean"==typeof t.allowSparse?t.allowSparse:o.allowSparse,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:o.arrayLimit,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:o.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:o.comma,decodeDotInKeys:"boolean"==typeof t.decodeDotInKeys?t.decodeDotInKeys:o.decodeDotInKeys,decoder:"function"==typeof t.decoder?t.decoder:o.decoder,delimiter:"string"==typeof t.delimiter||r.isRegExp(t.delimiter)?t.delimiter:o.delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:o.depth,duplicates:n,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:o.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:o.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:o.plainObjects,strictDepth:"boolean"==typeof t.strictDepth?!!t.strictDepth:o.strictDepth,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:o.strictNullHandling,throwOnLimitExceeded:"boolean"==typeof t.throwOnLimitExceeded&&t.throwOnLimitExceeded}}(e);if(""===t||null==t)return n.plainObjects?{__proto__:null}:{};for(var h="string"==typeof t?function(t,e){var n={__proto__:null},c=e.ignoreQueryPrefix?t.replace(/^\?/,""):t;c=c.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var h=e.parameterLimit===1/0?void 0:e.parameterLimit,u=c.split(e.delimiter,e.throwOnLimitExceeded?h+1:h);if(e.throwOnLimitExceeded&&u.length>h)throw new RangeError("Parameter limit exceeded. Only "+h+" parameter"+(1===h?"":"s")+" allowed.");var d,p=-1,f=e.charset;if(e.charsetSentinel)for(d=0;d<u.length;++d)0===u[d].indexOf("utf8=")&&("utf8=%E2%9C%93"===u[d]?f="utf-8":"utf8=%26%2310003%3B"===u[d]&&(f="iso-8859-1"),p=d,d=u.length);for(d=0;d<u.length;++d)if(d!==p){var m,g,v=u[d],y=v.indexOf("]="),x=-1===y?v.indexOf("="):y+1;-1===x?(m=e.decoder(v,o.decoder,f,"key"),g=e.strictNullHandling?null:""):(m=e.decoder(v.slice(0,x),o.decoder,f,"key"),g=r.maybeMap(l(v.slice(x+1),e,s(n[m])?n[m].length:0),function(t){return e.decoder(t,o.decoder,f,"value")})),g&&e.interpretNumericEntities&&"iso-8859-1"===f&&(g=a(String(g))),v.indexOf("[]=")>-1&&(g=s(g)?[g]:g);var w=i.call(n,m);w&&"combine"===e.duplicates?n[m]=r.combine(n[m],g):w&&"last"!==e.duplicates||(n[m]=g)}return n}(t,n):t,u=n.plainObjects?{__proto__:null}:{},d=Object.keys(h),p=0;p<d.length;++p){var f=d[p],m=c(f,h[f],n,"string"==typeof t);u=r.merge(u,m,n)}return!0===n.allowSparse?u:r.compact(u)}},2652:function(t,e,n){"use strict";var r=n(6080),i=n(9565),s=n(8551),o=n(6823),a=n(4209),l=n(6198),c=n(1625),h=n(81),u=n(851),d=n(9539),p=TypeError,f=function(t,e){this.stopped=t,this.result=e},m=f.prototype;t.exports=function(t,e,n){var g,v,y,x,w,_,b,A=n&&n.that,T=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_RECORD),E=!(!n||!n.IS_ITERATOR),k=!(!n||!n.INTERRUPTED),M=r(e,A),C=function(t){return g&&d(g,"normal"),new f(!0,t)},P=function(t){return T?(s(t),k?M(t[0],t[1],C):M(t[0],t[1])):k?M(t,C):M(t)};if(S)g=t.iterator;else if(E)g=t;else{if(!(v=u(t)))throw new p(o(t)+" is not iterable");if(a(v)){for(y=0,x=l(t);x>y;y++)if((w=P(t[y]))&&c(m,w))return w;return new f(!1)}g=h(t,v)}for(_=S?t.next:g.next;!(b=i(_,g)).done;){try{w=P(b.value)}catch(t){d(g,"throw",t)}if("object"==typeof w&&w&&c(m,w))return w}return new f(!1)}},2675:function(t,e,n){"use strict";n(6761),n(1510),n(7812),n(3110),n(9773)},2712:function(t,e,n){"use strict";var r=n(6518),i=n(926).left,s=n(4598),o=n(9519);r({target:"Array",proto:!0,forced:!n(8574)&&o>79&&o<83||!s("reduce")},{reduce:function(t){var e=arguments.length;return i(this,t,e,e>1?arguments[1]:void 0)}})},2744:function(t,e,n){"use strict";var r=n(9039);t.exports=!r(function(){return Object.isExtensible(Object.preventExtensions({}))})},2762:function(t,e,n){"use strict";var r=n(6518),i=n(3802).trim;r({target:"String",proto:!0,forced:n(706)("trim")},{trim:function(){return i(this)}})},2777:function(t,e,n){"use strict";var r=n(9565),i=n(34),s=n(757),o=n(5966),a=n(4270),l=n(8227),c=TypeError,h=l("toPrimitive");t.exports=function(t,e){if(!i(t)||s(t))return t;var n,l=o(t,h);if(l){if(void 0===e&&(e="default"),n=r(l,t,e),!i(n)||s(n))return n;throw new c("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},2787:function(t,e,n){"use strict";var r=n(9297),i=n(4901),s=n(8981),o=n(6119),a=n(2211),l=o("IE_PROTO"),c=Object,h=c.prototype;t.exports=a?c.getPrototypeOf:function(t){var e=s(t);if(r(e,l))return e[l];var n=e.constructor;return i(n)&&e instanceof n?n.prototype:e instanceof c?h:null}},2796:function(t,e,n){"use strict";var r=n(9039),i=n(4901),s=/#|\.prototype\./,o=function(t,e){var n=l[a(t)];return n===h||n!==c&&(i(e)?r(e):!!e)},a=o.normalize=function(t){return String(t).replace(s,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",h=o.POLYFILL="P";t.exports=o},2812:function(t){"use strict";var e=TypeError;t.exports=function(t,n){if(t<n)throw new e("Not enough arguments");return t}},2839:function(t,e,n){"use strict";var r=n(4576).navigator,i=r&&r.userAgent;t.exports=i?String(i):""},2892:function(t,e,n){"use strict";var r=n(6518),i=n(6395),s=n(3724),o=n(4576),a=n(9167),l=n(9504),c=n(2796),h=n(9297),u=n(3167),d=n(1625),p=n(757),f=n(2777),m=n(9039),g=n(8480).f,v=n(7347).f,y=n(4913).f,x=n(1240),w=n(3802).trim,_="Number",b=o[_],A=a[_],T=b.prototype,S=o.TypeError,E=l("".slice),k=l("".charCodeAt),M=c(_,!b(" 0o1")||!b("0b1")||b("+0x1")),C=function(t){var e,n=arguments.length<1?0:b(function(t){var e=f(t,"number");return"bigint"==typeof e?e:function(t){var e,n,r,i,s,o,a,l,c=f(t,"number");if(p(c))throw new S("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=w(c),43===(e=k(c,0))||45===e){if(88===(n=k(c,2))||120===n)return NaN}else if(48===e){switch(k(c,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(o=(s=E(c,2)).length,a=0;a<o;a++)if((l=k(s,a))<48||l>i)return NaN;return parseInt(s,r)}return+c}(e)}(t));return d(T,e=this)&&m(function(){x(e)})?u(Object(n),this,C):n};C.prototype=T,M&&!i&&(T.constructor=C),r({global:!0,constructor:!0,wrap:!0,forced:M},{Number:C});var P=function(t,e){for(var n,r=s?g(e):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),i=0;r.length>i;i++)h(e,n=r[i])&&!h(t,n)&&y(t,n,v(e,n))};i&&A&&P(a[_],A),(M||i)&&P(a[_],b)},2953:function(t,e,n){"use strict";var r=n(4576),i=n(7400),s=n(9296),o=n(3792),a=n(6699),l=n(687),c=n(8227)("iterator"),h=o.values,u=function(t,e){if(t){if(t[c]!==h)try{a(t,c,h)}catch(e){t[c]=h}if(l(t,e,!0),i[e])for(var n in o)if(t[n]!==o[n])try{a(t,n,o[n])}catch(e){t[n]=o[n]}}};for(var d in i)u(r[d]&&r[d].prototype,d);u(s,"DOMTokenList")},2967:function(t,e,n){"use strict";var r=n(6706),i=n(34),s=n(7750),o=n(3506);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=r(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return s(n),o(r),i(n)?(e?t(n,r):n.__proto__=r,n):n}}():void 0)},3036:function(t){"use strict";var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch(t){e=!1}t.exports=e},3063:function(t,e,n){"use strict";var r=n(2839);t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},3093:function(t,e,n){"use strict";var r=n(4459);t.exports=function(t){return r(t)||0===t?t:t<0?-1:1}},3110:function(t,e,n){"use strict";var r=n(6518),i=n(7751),s=n(8745),o=n(9565),a=n(9504),l=n(9039),c=n(4901),h=n(757),u=n(7680),d=n(6933),p=n(4495),f=String,m=i("JSON","stringify"),g=a(/./.exec),v=a("".charAt),y=a("".charCodeAt),x=a("".replace),w=a(1.1.toString),_=/[\uD800-\uDFFF]/g,b=/^[\uD800-\uDBFF]$/,A=/^[\uDC00-\uDFFF]$/,T=!p||l(function(){var t=i("Symbol")("stringify detection");return"[null]"!==m([t])||"{}"!==m({a:t})||"{}"!==m(Object(t))}),S=l(function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")}),E=function(t,e){var n=u(arguments),r=d(e);if(c(r)||void 0!==t&&!h(t))return n[1]=function(t,e){if(c(r)&&(e=o(r,this,f(t),e)),!h(e))return e},s(m,null,n)},k=function(t,e,n){var r=v(n,e-1),i=v(n,e+1);return g(b,t)&&!g(A,i)||g(A,t)&&!g(b,r)?"\\u"+w(y(t,0),16):t};m&&r({target:"JSON",stat:!0,arity:3,forced:T||S},{stringify:function(t,e,n){var r=u(arguments),i=s(T?E:m,null,r);return S&&"string"==typeof i?x(i,_,k):i}})},3126:function(t,e,n){"use strict";var r=n(6743),i=n(9675),s=n(76),o=n(3144);t.exports=function(t){if(t.length<1||"function"!=typeof t[0])throw new i("a function is required");return o(r,s,t)}},3138:function(t){"use strict";t.exports=function(t,e){try{1===arguments.length?console.error(t):console.error(t,e)}catch(t){}}},3144:function(t,e,n){"use strict";var r=n(6743),i=n(1002),s=n(76),o=n(7119);t.exports=o||r.call(s,i)},3167:function(t,e,n){"use strict";var r=n(4901),i=n(34),s=n(2967);t.exports=function(t,e,n){var o,a;return s&&r(o=e.constructor)&&o!==n&&i(a=o.prototype)&&a!==n.prototype&&s(t,a),t}},3179:function(t,e,n){"use strict";var r=n(2140),i=n(6955);t.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},3362:function(t,e,n){"use strict";n(436),n(6499),n(2003),n(7743),n(1481),n(280)},3365:function(t,e,n){"use strict";var r,i=n(2744),s=n(4576),o=n(9504),a=n(6279),l=n(3451),c=n(6468),h=n(4006),u=n(34),d=n(1181).enforce,p=n(9039),f=n(8622),m=Object,g=Array.isArray,v=m.isExtensible,y=m.isFrozen,x=m.isSealed,w=m.freeze,_=m.seal,b=!s.ActiveXObject&&"ActiveXObject"in s,A=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},T=c("WeakMap",A,h),S=T.prototype,E=o(S.set);if(f)if(b){r=h.getConstructor(A,"WeakMap",!0),l.enable();var k=o(S.delete),M=o(S.has),C=o(S.get);a(S,{delete:function(t){if(u(t)&&!v(t)){var e=d(this);return e.frozen||(e.frozen=new r),k(this,t)||e.frozen.delete(t)}return k(this,t)},has:function(t){if(u(t)&&!v(t)){var e=d(this);return e.frozen||(e.frozen=new r),M(this,t)||e.frozen.has(t)}return M(this,t)},get:function(t){if(u(t)&&!v(t)){var e=d(this);return e.frozen||(e.frozen=new r),M(this,t)?C(this,t):e.frozen.get(t)}return C(this,t)},set:function(t,e){if(u(t)&&!v(t)){var n=d(this);n.frozen||(n.frozen=new r),M(this,t)?E(this,t,e):n.frozen.set(t,e)}else E(this,t,e);return this}})}else i&&p(function(){var t=w([]);return E(new T,t,1),!y(t)})&&a(S,{set:function(t,e){var n;return g(t)&&(y(t)?n=w:x(t)&&(n=_)),E(this,t,e),n&&n(t),this}})},3389:function(t,e,n){"use strict";var r=n(4576),i=n(3724),s=Object.getOwnPropertyDescriptor;t.exports=function(t){if(!i)return r[t];var e=s(r,t);return e&&e.value}},3392:function(t,e,n){"use strict";var r=n(9504),i=0,s=Math.random(),o=r(1.1.toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+o(++i+s,36)}},3418:function(t,e,n){"use strict";var r=n(6518),i=n(7916);r({target:"Array",stat:!0,forced:!n(4428)(function(t){Array.from(t)})},{from:i})},3438:function(t,e,n){"use strict";var r=n(8551),i=n(34),s=n(6043);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=s.f(t);return(0,n.resolve)(e),n.promise}},3451:function(t,e,n){"use strict";var r=n(6518),i=n(9504),s=n(421),o=n(34),a=n(9297),l=n(4913).f,c=n(8480),h=n(298),u=n(4124),d=n(3392),p=n(2744),f=!1,m=d("meta"),g=0,v=function(t){l(t,m,{value:{objectID:"O"+g++,weakData:{}}})},y=t.exports={enable:function(){y.enable=function(){},f=!0;var t=c.f,e=i([].splice),n={};n[m]=1,t(n).length&&(c.f=function(n){for(var r=t(n),i=0,s=r.length;i<s;i++)if(r[i]===m){e(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:h.f}))},fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,m)){if(!u(t))return"F";if(!e)return"E";v(t)}return t[m].objectID},getWeakData:function(t,e){if(!a(t,m)){if(!u(t))return!0;if(!e)return!1;v(t)}return t[m].weakData},onFreeze:function(t){return p&&f&&u(t)&&!a(t,m)&&v(t),t}};s[m]=!0},3500:function(t,e,n){"use strict";var r=n(4576),i=n(7400),s=n(9296),o=n(235),a=n(6699),l=function(t){if(t&&t.forEach!==o)try{a(t,"forEach",o)}catch(e){t.forEach=o}};for(var c in i)i[c]&&l(r[c]&&r[c].prototype);l(s)},3506:function(t,e,n){"use strict";var r=n(3925),i=String,s=TypeError;t.exports=function(t){if(r(t))return t;throw new s("Can't set "+i(t)+" as a prototype")}},3517:function(t,e,n){"use strict";var r=n(9504),i=n(9039),s=n(4901),o=n(6955),a=n(7751),l=n(3706),c=function(){},h=a("Reflect","construct"),u=/^\s*(?:class|function)\b/,d=r(u.exec),p=!u.test(c),f=function(t){if(!s(t))return!1;try{return h(c,[],t),!0}catch(t){return!1}},m=function(t){if(!s(t))return!1;switch(o(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!d(u,l(t))}catch(t){return!0}};m.sham=!0,t.exports=!h||i(function(){var t;return f(f.call)||!f(Object)||!f(function(){t=!0})||t})?m:f},3579:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(2652),o=n(9306),a=n(8551),l=n(1767),c=n(9539),h=n(4549)("some",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:h},{some:function(t){a(this);try{o(t)}catch(t){c(this,"throw",t)}if(h)return i(h,this,t);var e=l(this),n=0;return s(e,function(e,r){if(t(e,n++))return r()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3628:function(t,e,n){"use strict";var r=n(8648),i=n(1064),s=n(7176);t.exports=r?function(t){return r(t)}:i?function(t){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("getProto: not an object");return i(t)}:s?function(t){return s(t)}:null},3635:function(t,e,n){"use strict";var r=n(9039),i=n(4576).RegExp;t.exports=r(function(){var t=i(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)})},3706:function(t,e,n){"use strict";var r=n(9504),i=n(4901),s=n(7629),o=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(t){return o(t)}),t.exports=s.inspectSource},3717:function(t,e){"use strict";e.f=Object.getOwnPropertySymbols},3724:function(t,e,n){"use strict";var r=n(9039);t.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},3738:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},3772:function(t,e,n){"use strict";n(3365)},3792:function(t,e,n){"use strict";var r=n(5397),i=n(6469),s=n(6269),o=n(1181),a=n(4913).f,l=n(1088),c=n(2529),h=n(6395),u=n(3724),d="Array Iterator",p=o.set,f=o.getterFor(d);t.exports=l(Array,"Array",function(t,e){p(this,{type:d,target:r(t),index:0,kind:e})},function(){var t=f(this),e=t.target,n=t.index++;if(!e||n>=e.length)return t.target=null,c(void 0,!0);switch(t.kind){case"keys":return c(n,!1);case"values":return c(e[n],!1)}return c([n,e[n]],!1)},"values");var m=s.Arguments=s.Array;if(i("keys"),i("values"),i("entries"),!h&&u&&"values"!==m.name)try{a(m,"name",{value:"values"})}catch(t){}},3802:function(t,e,n){"use strict";var r=n(9504),i=n(7750),s=n(655),o=n(7452),a=r("".replace),l=RegExp("^["+o+"]+"),c=RegExp("(^|[^"+o+"])["+o+"]+$"),h=function(t){return function(e){var n=s(i(e));return 1&t&&(n=a(n,l,"")),2&t&&(n=a(n,c,"$1")),n}};t.exports={start:h(1),end:h(2),trim:h(3)}},3851:function(t,e,n){"use strict";var r=n(6518),i=n(9039),s=n(5397),o=n(7347).f,a=n(3724);r({target:"Object",stat:!0,forced:!a||i(function(){o(1)}),sham:!a},{getOwnPropertyDescriptor:function(t,e){return o(s(t),e)}})},3919:function(t,e,n){"use strict";var r=n(1354),i=n.n(r),s=n(6314),o=n.n(s),a=n(1755),l=o()(i());l.i(a.A),l.push([t.id,"* {\r\n    margin: 0;\r\n    padding: 0;\r\n    user-select: none;\r\n    -webkit-touch-callout: none; /* iOS Safari */\r\n    -webkit-user-select: none; /* Safari */\r\n    -khtml-user-select: none; /* Konqueror HTML */\r\n    -moz-user-select: none; /* Old versions of Firefox */\r\n    -ms-user-select: none; /* Internet Explorer/Edge */\r\n    user-select: none; /* Non-prefixed version, currently supported by Chrome, Edge, Opera and Firefox */\r\n}\r\n\r\nhtml, body {\r\n    position: fixed;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #000000;\r\n    display: flex;\r\n    touch-action: none;\r\n\r\n    /*      IOS */\r\n    overflow: hidden;\r\n    -webkit-touch-callout: none;\r\n    -webkit-user-select: none;\r\n    -khtml-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    -webkit-tap-highlight-color: rgba(0,0,0,0);\r\n}\r\n\r\n#canvas-wrapper {\r\n    display: block;\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    touch-action: none;\r\n    /*outline: 4px dashed blue;*/\r\n    /*outline-offset: -4px;*/\r\n}\r\n\r\n#canvas-wrapper canvas {\r\n    display: block;\r\n    touch-action: none;\r\n    /*outline: 8px dashed red;*/\r\n    /*outline-offset: -8px;*/\r\n}\r\n\r\n.icon-light-on {\r\n    filter: brightness(1.2) contrast(1.1);\r\n}\r\n","",{version:3,sources:["webpack://./src/styles/style.css"],names:[],mappings:"AAEA;IACI,SAAS;IACT,UAAU;IACV,iBAAiB;IACjB,2BAA2B,EAAE,eAAe;IAC5C,yBAAyB,EAAE,WAAW;IACtC,wBAAwB,EAAE,mBAAmB;IAC7C,sBAAsB,EAAE,4BAA4B;IACpD,qBAAqB,EAAE,2BAA2B;IAClD,iBAAiB,EAAE,iFAAiF;AACxG;;AAEA;IACI,eAAe;IACf,WAAW;IACX,YAAY;IACZ,yBAAyB;IACzB,aAAa;IACb,kBAAkB;;IAElB,sCAAsC;IACtC,gBAAgB;IAChB,2BAA2B;IAC3B,yBAAyB;IACzB,wBAAwB;IACxB,sBAAsB;IACtB,qBAAqB;IACrB,iBAAiB;IACjB,0CAA0C;AAC9C;;AAEA;IACI,cAAc;IACd,kBAAkB;IAClB,QAAQ;IACR,SAAS;IACT,gCAAgC;IAChC,kBAAkB;IAClB,4BAA4B;IAC5B,wBAAwB;AAC5B;;AAEA;IACI,cAAc;IACd,kBAAkB;IAClB,2BAA2B;IAC3B,wBAAwB;AAC5B;;AAEA;IACI,qCAAqC;AACzC",sourcesContent:["@import url('adminPanel.css');\r\n\r\n* {\r\n    margin: 0;\r\n    padding: 0;\r\n    user-select: none;\r\n    -webkit-touch-callout: none; /* iOS Safari */\r\n    -webkit-user-select: none; /* Safari */\r\n    -khtml-user-select: none; /* Konqueror HTML */\r\n    -moz-user-select: none; /* Old versions of Firefox */\r\n    -ms-user-select: none; /* Internet Explorer/Edge */\r\n    user-select: none; /* Non-prefixed version, currently supported by Chrome, Edge, Opera and Firefox */\r\n}\r\n\r\nhtml, body {\r\n    position: fixed;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #000000;\r\n    display: flex;\r\n    touch-action: none;\r\n\r\n    /*      IOS */\r\n    overflow: hidden;\r\n    -webkit-touch-callout: none;\r\n    -webkit-user-select: none;\r\n    -khtml-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    -webkit-tap-highlight-color: rgba(0,0,0,0);\r\n}\r\n\r\n#canvas-wrapper {\r\n    display: block;\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    touch-action: none;\r\n    /*outline: 4px dashed blue;*/\r\n    /*outline-offset: -4px;*/\r\n}\r\n\r\n#canvas-wrapper canvas {\r\n    display: block;\r\n    touch-action: none;\r\n    /*outline: 8px dashed red;*/\r\n    /*outline-offset: -8px;*/\r\n}\r\n\r\n.icon-light-on {\r\n    filter: brightness(1.2) contrast(1.1);\r\n}\r\n"],sourceRoot:""}]),e.A=l},3921:function(t,e,n){"use strict";var r=n(6518),i=n(2652),s=n(2278);r({target:"Object",stat:!0},{fromEntries:function(t){var e={};return i(t,function(t,n){s(e,t,n)},{AS_ENTRIES:!0}),e}})},3925:function(t,e,n){"use strict";var r=n(34);t.exports=function(t){return r(t)||null===t}},3949:function(t,e,n){"use strict";n(7588)},3994:function(t,e,n){"use strict";var r=n(7657).IteratorPrototype,i=n(2360),s=n(6980),o=n(687),a=n(6269),l=function(){return this};t.exports=function(t,e,n,c){var h=e+" Iterator";return t.prototype=i(r,{next:s(+!c,n)}),o(t,h,!1,!0),a[h]=l,t}},4006:function(t,e,n){"use strict";var r=n(9504),i=n(6279),s=n(3451).getWeakData,o=n(679),a=n(8551),l=n(4117),c=n(34),h=n(2652),u=n(9213),d=n(9297),p=n(1181),f=p.set,m=p.getterFor,g=u.find,v=u.findIndex,y=r([].splice),x=0,w=function(t){return t.frozen||(t.frozen=new _)},_=function(){this.entries=[]},b=function(t,e){return g(t.entries,function(t){return t[0]===e})};_.prototype={get:function(t){var e=b(this,t);if(e)return e[1]},has:function(t){return!!b(this,t)},set:function(t,e){var n=b(this,t);n?n[1]=e:this.entries.push([t,e])},delete:function(t){var e=v(this.entries,function(e){return e[0]===t});return~e&&y(this.entries,e,1),!!~e}},t.exports={getConstructor:function(t,e,n,r){var u=t(function(t,i){o(t,p),f(t,{type:e,id:x++,frozen:null}),l(i)||h(i,t[r],{that:t,AS_ENTRIES:n})}),p=u.prototype,g=m(e),v=function(t,e,n){var r=g(t),i=s(a(e),!0);return!0===i?w(r).set(e,n):i[r.id]=n,t};return i(p,{delete:function(t){var e=g(this);if(!c(t))return!1;var n=s(t);return!0===n?w(e).delete(t):n&&d(n,e.id)&&delete n[e.id]},has:function(t){var e=g(this);if(!c(t))return!1;var n=s(t);return!0===n?w(e).has(t):n&&d(n,e.id)}}),i(p,n?{get:function(t){var e=g(this);if(c(t)){var n=s(t);if(!0===n)return w(e).get(t);if(n)return n[e.id]}},set:function(t,e){return v(this,t,e)}}:{add:function(t){return v(this,t,!0)}}),u}}},4039:function(t,e,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,i=n(1333);t.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&i()}},4055:function(t,e,n){"use strict";var r=n(4576),i=n(34),s=r.document,o=i(s)&&i(s.createElement);t.exports=function(t){return o?s.createElement(t):{}}},4117:function(t){"use strict";t.exports=function(t){return null==t}},4124:function(t,e,n){"use strict";var r=n(9039),i=n(34),s=n(2195),o=n(5652),a=Object.isExtensible,l=r(function(){a(1)});t.exports=l||o?function(t){return!!i(t)&&(!o||"ArrayBuffer"!==s(t))&&(!a||a(t))}:a},4196:function(t,e,n){var r;!function(){"use strict";var i=function(){this.init()};i.prototype={init:function(){var t=this||s;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||s;if(t=parseFloat(t),e.ctx||p(),void 0!==t&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,s.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var r=e._howls[n]._getSoundIds(),i=0;i<r.length;i++){var o=e._howls[n]._soundById(r[i]);o&&o._node&&(o._node.volume=o._volume*t)}return e}return e._volume},mute:function(t){var e=this||s;e.ctx||p(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,s.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var r=e._howls[n]._getSoundIds(),i=0;i<r.length;i++){var o=e._howls[n]._soundById(r[i]);o&&o._node&&(o._node.muted=!!t||o._muted)}return e},stop:function(){for(var t=this||s,e=0;e<t._howls.length;e++)t._howls[e].stop();return t},unload:function(){for(var t=this||s,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,p()),t},codecs:function(t){return(this||s)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||s;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||s,e=null;try{e="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!e||"function"!=typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),r=t._navigator?t._navigator.userAgent:"",i=r.match(/OPR\/(\d+)/g),o=i&&parseInt(i[0].split("/")[1],10)<33,a=-1!==r.indexOf("Safari")&&-1===r.indexOf("Chrome"),l=r.match(/Version\/(.*?) /),c=a&&l&&parseInt(l[1],10)<15;return t._codecs={mp3:!(o||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(e.canPlayType('audio/wav; codecs="1"')||e.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(e.canPlayType("audio/x-m4b;")||e.canPlayType("audio/m4b;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(c||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(c||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||s;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var e=function(n){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,t._releaseHtml5Audio(r)}catch(n){t.noAudio=!0;break}for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var s=t._howls[i]._getSoundIds(),o=0;o<s.length;o++){var a=t._howls[i]._soundById(s[o]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}t._autoResume();var l=t.ctx.createBufferSource();l.buffer=t._scratchBuffer,l.connect(t.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),l.onended=function(){l.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0),document.removeEventListener("keydown",e,!0);for(var n=0;n<t._howls.length;n++)t._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),document.addEventListener("keydown",e,!0),t}},_obtainHtml5Audio:function(){var t=this||s;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(new Audio).play();return e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(t){var e=this||s;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&s.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}},3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&s.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then(function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")}),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var s=new i,o=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};o.prototype={init:function(t){var e=this;return s.ctx||p(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=s.usingWebAudio&&!e._html5,void 0!==s.ctx&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&"none"!==e._preload&&e.load(),e},load:function(){var t=this,e=null;if(s.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var n=0;n<t._src.length;n++){var r,i;if(t._format&&t._format[n])r=t._format[n];else{if("string"!=typeof(i=t._src[n])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(i))||(r=/\.([^.]+)$/.exec(i.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&s.codecs(r)){e=t._src[n];break}}if(e)return t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new a(t),t._webAudio&&c(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,e){var n=this,r=null;if("number"==typeof t)r=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(void 0===t&&(t="__default",!n._playLock)){for(var i=0,o=0;o<n._sounds.length;o++)n._sounds[o]._paused&&!n._sounds[o]._ended&&(i++,r=n._sounds[o]._id);1===i?t=null:r=null}}var a=r?n._soundById(r):n._inactiveSound();if(!a)return null;if(r&&!t&&(t=a._sprite||"__default"),"loaded"!==n._state){a._sprite=t,a._ended=!1;var l=a._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(r&&!a._paused)return e||n._loadQueue("play"),a._id;n._webAudio&&s._autoResume();var c=Math.max(0,a._seek>0?a._seek:n._sprite[t][0]/1e3),h=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-c),u=1e3*h/Math.abs(a._rate),d=n._sprite[t][0]/1e3,p=(n._sprite[t][0]+n._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;var f=function(){a._paused=!1,a._seek=c,a._start=d,a._stop=p,a._loop=!(!a._loop&&!n._sprite[t][2])};if(!(c>=p)){var m=a._node;if(n._webAudio){var g=function(){n._playLock=!1,f(),n._refreshBuffer(a);var t=a._muted||n._muted?0:a._volume;m.gain.setValueAtTime(t,s.ctx.currentTime),a._playStart=s.ctx.currentTime,void 0===m.bufferSource.start?a._loop?m.bufferSource.noteGrainOn(0,c,86400):m.bufferSource.noteGrainOn(0,c,h):a._loop?m.bufferSource.start(0,c,86400):m.bufferSource.start(0,c,h),u!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),u)),e||setTimeout(function(){n._emit("play",a._id),n._loadQueue()},0)};"running"===s.state&&"interrupted"!==s.ctx.state?g():(n._playLock=!0,n.once("resume",g),n._clearTimer(a._id))}else{var v=function(){m.currentTime=c,m.muted=a._muted||n._muted||s._muted||m.muted,m.volume=a._volume*s.volume(),m.playbackRate=a._rate;try{var r=m.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(n._playLock=!0,f(),r.then(function(){n._playLock=!1,m._unlocked=!0,e?n._loadQueue():n._emit("play",a._id)}).catch(function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0})):e||(n._playLock=!1,f(),n._emit("play",a._id)),m.playbackRate=a._rate,m.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),u):(n._endTimers[a._id]=function(){n._ended(a),m.removeEventListener("ended",n._endTimers[a._id],!1)},m.addEventListener("ended",n._endTimers[a._id],!1))}catch(t){n._emit("playerror",a._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=n._src,m.load());var y=window&&window.ejecta||!m.readyState&&s._navigator.isCocoonJS;if(m.readyState>=3||y)v();else{n._playLock=!0,n._state="loading";var x=function(){n._state="loaded",v(),m.removeEventListener(s._canPlayEvent,x,!1)};m.addEventListener(s._canPlayEvent,x,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),r=0;r<n.length;r++){e._clearTimer(n[r]);var i=e._soundById(n[r]);if(i&&!i._paused&&(i._seek=e.seek(n[r]),i._rateSeek=0,i._paused=!0,e._stopFade(n[r]),i._node))if(e._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),e._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||e._emit("pause",i?i._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var r=n._getSoundIds(t),i=0;i<r.length;i++){n._clearTimer(r[i]);var s=n._soundById(r[i]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,n._stopFade(r[i]),s._node&&(n._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),n._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&n._clearSound(s._node))),e||n._emit("stop",s._id))}return n},mute:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,e)}}),n;if(void 0===e){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var r=n._getSoundIds(e),i=0;i<r.length;i++){var o=n._soundById(r[i]);o&&(o._muted=t,o._interval&&n._stopFade(o._id),n._webAudio&&o._node?o._node.gain.setValueAtTime(t?0:o._volume,s.ctx.currentTime):o._node&&(o._node.muted=!!s._muted||t),n._emit("mute",o._id))}return n},volume:function(){var t,e,n,r=this,i=arguments;if(0===i.length)return r._volume;if(1===i.length||2===i.length&&void 0===i[1]?r._getSoundIds().indexOf(i[0])>=0?e=parseInt(i[0],10):t=parseFloat(i[0]):i.length>=2&&(t=parseFloat(i[0]),e=parseInt(i[1],10)),!(void 0!==t&&t>=0&&t<=1))return(n=e?r._soundById(e):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,i)}}),r;void 0===e&&(r._volume=t),e=r._getSoundIds(e);for(var o=0;o<e.length;o++)(n=r._soundById(e[o]))&&(n._volume=t,i[2]||r._stopFade(e[o]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,s.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*s.volume()),r._emit("volume",n._id));return r},fade:function(t,e,n,r){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"fade",action:function(){i.fade(t,e,n,r)}}),i;t=Math.min(Math.max(0,parseFloat(t)),1),e=Math.min(Math.max(0,parseFloat(e)),1),n=parseFloat(n),i.volume(t,r);for(var o=i._getSoundIds(r),a=0;a<o.length;a++){var l=i._soundById(o[a]);if(l){if(r||i._stopFade(o[a]),i._webAudio&&!l._muted){var c=s.ctx.currentTime,h=c+n/1e3;l._volume=t,l._node.gain.setValueAtTime(t,c),l._node.gain.linearRampToValueAtTime(e,h)}i._startFadeInterval(l,t,e,n,o[a],void 0===r)}}return i},_startFadeInterval:function(t,e,n,r,i,s){var o=this,a=e,l=n-e,c=Math.abs(l/.01),h=Math.max(4,c>0?r/c:r),u=Date.now();t._fadeTo=n,t._interval=setInterval(function(){var i=(Date.now()-u)/r;u=Date.now(),a+=l*i,a=Math.round(100*a)/100,a=l<0?Math.max(n,a):Math.min(n,a),o._webAudio?t._volume=a:o.volume(a,t._id,!0),s&&(o._volume=a),(n<e&&a<=n||n>e&&a>=n)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,o.volume(n,t._id),o._emit("fade",t._id))},h)},_stopFade:function(t){var e=this,n=e._soundById(t);return n&&n._interval&&(e._webAudio&&n._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(n._interval),n._interval=null,e.volume(n._fadeTo,t),n._fadeTo=null,e._emit("fade",t)),e},loop:function(){var t,e,n,r=this,i=arguments;if(0===i.length)return r._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(n=r._soundById(parseInt(i[0],10)))&&n._loop;t=i[0],r._loop=t}else 2===i.length&&(t=i[0],e=parseInt(i[1],10));for(var s=r._getSoundIds(e),o=0;o<s.length;o++)(n=r._soundById(s[o]))&&(n._loop=t,r._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,r.playing(s[o])&&(r.pause(s[o],!0),r.play(s[o],!0)))));return r},rate:function(){var t,e,n,r=this,i=arguments;if(0===i.length?e=r._sounds[0]._id:1===i.length?r._getSoundIds().indexOf(i[0])>=0?e=parseInt(i[0],10):t=parseFloat(i[0]):2===i.length&&(t=parseFloat(i[0]),e=parseInt(i[1],10)),"number"!=typeof t)return(n=r._soundById(e))?n._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,i)}}),r;void 0===e&&(r._rate=t),e=r._getSoundIds(e);for(var o=0;o<e.length;o++)if(n=r._soundById(e[o])){r.playing(e[o])&&(n._rateSeek=r.seek(e[o]),n._playStart=r._webAudio?s.ctx.currentTime:n._playStart),n._rate=t,r._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,s.ctx.currentTime):n._node&&(n._node.playbackRate=t);var a=r.seek(e[o]),l=1e3*((r._sprite[n._sprite][0]+r._sprite[n._sprite][1])/1e3-a)/Math.abs(n._rate);!r._endTimers[e[o]]&&n._paused||(r._clearTimer(e[o]),r._endTimers[e[o]]=setTimeout(r._ended.bind(r,n),l)),r._emit("rate",n._id)}return r},seek:function(){var t,e,n=this,r=arguments;if(0===r.length?n._sounds.length&&(e=n._sounds[0]._id):1===r.length?n._getSoundIds().indexOf(r[0])>=0?e=parseInt(r[0],10):n._sounds.length&&(e=n._sounds[0]._id,t=parseFloat(r[0])):2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10)),void 0===e)return 0;if("number"==typeof t&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}}),n;var i=n._soundById(e);if(i){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var o=n.playing(e)?s.ctx.currentTime-i._playStart:0,a=i._rateSeek?i._rateSeek-i._seek:0;return i._seek+(a+o*Math.abs(i._rate))}return i._node.currentTime}var l=n.playing(e);l&&n.pause(e,!0),i._seek=t,i._ended=!1,n._clearTimer(e),n._webAudio||!i._node||isNaN(i._node.duration)||(i._node.currentTime=t);var c=function(){l&&n.play(e,!0),n._emit("seek",e)};if(l&&!n._webAudio){var h=function(){n._playLock?setTimeout(h,0):c()};setTimeout(h,0)}else c()}return n},playing:function(t){var e=this;if("number"==typeof t){var n=e._soundById(t);return!!n&&!n._paused}for(var r=0;r<e._sounds.length;r++)if(!e._sounds[r]._paused)return!0;return!1},duration:function(t){var e=this,n=e._duration,r=e._soundById(t);return r&&(n=e._sprite[r._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,n=0;n<e.length;n++)e[n]._paused||t.stop(e[n]._id),t._webAudio||(t._clearSound(e[n]._node),e[n]._node.removeEventListener("error",e[n]._errorFn,!1),e[n]._node.removeEventListener(s._canPlayEvent,e[n]._loadFn,!1),e[n]._node.removeEventListener("ended",e[n]._endFn,!1),s._releaseHtml5Audio(e[n]._node)),delete e[n]._node,t._clearTimer(e[n]._id);var r=s._howls.indexOf(t);r>=0&&s._howls.splice(r,1);var i=!0;for(n=0;n<s._howls.length;n++)if(s._howls[n]._src===t._src||t._src.indexOf(s._howls[n]._src)>=0){i=!1;break}return l&&i&&delete l[t._src],s.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,r){var i=this["_on"+t];return"function"==typeof e&&i.push(r?{id:n,fn:e,once:r}:{id:n,fn:e}),this},off:function(t,e,n){var r=this,i=r["_on"+t],s=0;if("number"==typeof e&&(n=e,e=null),e||n)for(s=0;s<i.length;s++){var o=n===i[s].id;if(e===i[s].fn&&o||!e&&o){i.splice(s,1);break}}else if(t)r["_on"+t]=[];else{var a=Object.keys(r);for(s=0;s<a.length;s++)0===a[s].indexOf("_on")&&Array.isArray(r[a[s]])&&(r[a[s]]=[])}return r},once:function(t,e,n){return this.on(t,e,n,1),this},_emit:function(t,e,n){for(var r=this,i=r["_on"+t],s=i.length-1;s>=0;s--)i[s].id&&i[s].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(r,i[s].fn),0),i[s].once&&r.off(t,i[s].fn,i[s].id));return r._loadQueue(t),r},_loadQueue:function(t){var e=this;if(e._queue.length>0){var n=e._queue[0];n.event===t&&(e._queue.shift(),e._loadQueue()),t||n.action()}return e},_ended:function(t){var e=this,n=t._sprite;if(!e._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(e._ended.bind(e,t),100),e;var r=!(!t._loop&&!e._sprite[n][2]);if(e._emit("end",t._id),!e._webAudio&&r&&e.stop(t._id,!0).play(t._id),e._webAudio&&r){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=s.ctx.currentTime;var i=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),i)}return e._webAudio&&!r&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),s._autoSuspend()),e._webAudio||r||e.stop(t._id,!0),e},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var n=e._soundById(t);n&&n._node&&n._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,n=0;n<e._sounds.length;n++)if(t===e._sounds[n]._id)return e._sounds[n];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new a(t)},_drain:function(){var t=this,e=t._pool,n=0,r=0;if(!(t._sounds.length<e)){for(r=0;r<t._sounds.length;r++)t._sounds[r]._ended&&n++;for(r=t._sounds.length-1;r>=0;r--){if(n<=e)return;t._sounds[r]._ended&&(t._webAudio&&t._sounds[r]._node&&t._sounds[r]._node.disconnect(0),t._sounds.splice(r,1),n--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],n=0;n<this._sounds.length;n++)e.push(this._sounds[n]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=s.ctx.createBufferSource(),t._node.bufferSource.buffer=l[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,s.ctx.currentTime),this},_cleanBuffer:function(t){var e=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(!t.bufferSource)return this;if(s._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=s._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(t){this._parent=t,this.init()};a.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++s._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,n=s._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),t._node.gain.setValueAtTime(n,s.ctx.currentTime),t._node.paused=!0,t._node.connect(s.masterGain)):s.noAudio||(t._node=s._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(s._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=e._src,t._node.preload=!0===e._preload?"auto":e._preload,t._node.volume=n*s.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++s._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,e=t._parent;e._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),t._node.removeEventListener(s._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,e=t._parent;e._duration===1/0&&(e._duration=Math.ceil(10*t._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var l={},c=function(t){var e=t._src;if(l[e])return t._duration=l[e].duration,void d(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);u(r.buffer,t)}else{var s=new XMLHttpRequest;s.open(t._xhr.method,e,!0),s.withCredentials=t._xhr.withCredentials,s.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach(function(e){s.setRequestHeader(e,t._xhr.headers[e])}),s.onload=function(){var e=(s.status+"")[0];"0"===e||"2"===e||"3"===e?u(s.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete l[e],t.load())},h(s)}},h=function(t){try{t.send()}catch(e){t.onerror()}},u=function(t,e){var n=function(){e._emit("loaderror",null,"Decoding audio data failed.")},r=function(t){t&&e._sounds.length>0?(l[e._src]=t,d(e,t)):n()};"undefined"!=typeof Promise&&1===s.ctx.decodeAudioData.length?s.ctx.decodeAudioData(t).then(r).catch(n):s.ctx.decodeAudioData(t,r,n)},d=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},p=function(){if(s.usingWebAudio){try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(t){s.usingWebAudio=!1}s.ctx||(s.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),e=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=e?parseInt(e[1],10):null;if(t&&n&&n<9){var r=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!r&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}};void 0===(r=function(){return{Howler:s,Howl:o}}.apply(e,[]))||(t.exports=r),e.Howler=s,e.Howl=o,void 0!==n.g?(n.g.HowlerGlobal=i,n.g.Howler=s,n.g.Howl=o,n.g.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=i,window.Howler=s,window.Howl=o,window.Sound=a)}(),function(){"use strict";var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var n=e._howls.length-1;n>=0;n--)e._howls[n].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,n){var r=this;return r.ctx&&r.ctx.listener?(e="number"!=typeof e?r._pos[1]:e,n="number"!=typeof n?r._pos[2]:n,"number"!=typeof t?r._pos:(r._pos=[t,e,n],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(t,e,n,r,i,s){var o=this;if(!o.ctx||!o.ctx.listener)return o;var a=o._orientation;return e="number"!=typeof e?a[1]:e,n="number"!=typeof n?a[2]:n,r="number"!=typeof r?a[3]:r,i="number"!=typeof i?a[4]:i,s="number"!=typeof s?a[5]:s,"number"!=typeof t?a:(o._orientation=[t,e,n,r,i,s],void 0!==o.ctx.listener.forwardX?(o.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):o.ctx.listener.setOrientation(t,e,n,r,i,s),o)},Howl.prototype.init=(t=Howl.prototype.init,function(e){var n=this;return n._orientation=e.orientation||[1,0,0],n._stereo=e.stereo||null,n._pos=e.pos||null,n._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},n._onstereo=e.onstereo?[{fn:e.onstereo}]:[],n._onpos=e.onpos?[{fn:e.onpos}]:[],n._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,n){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(t,n)}}),r;var i=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return r._stereo;r._stereo=t,r._pos=[t,0,0]}for(var s=r._getSoundIds(n),o=0;o<s.length;o++){var a=r._soundById(s[o]);if(a){if("number"!=typeof t)return a._stereo;a._stereo=t,a._pos=[t,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||e(a,i),"spatial"===i?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(t,0,0):a._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit("stereo",a._id)}}return r},Howl.prototype.pos=function(t,n,r,i){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"pos",action:function(){s.pos(t,n,r,i)}}),s;if(n="number"!=typeof n?0:n,r="number"!=typeof r?-.5:r,void 0===i){if("number"!=typeof t)return s._pos;s._pos=[t,n,r]}for(var o=s._getSoundIds(i),a=0;a<o.length;a++){var l=s._soundById(o[a]);if(l){if("number"!=typeof t)return l._pos;l._pos=[t,n,r],l._node&&(l._panner&&!l._panner.pan||e(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setPosition(t,n,r)),s._emit("pos",l._id)}}return s},Howl.prototype.orientation=function(t,n,r,i){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"orientation",action:function(){s.orientation(t,n,r,i)}}),s;if(n="number"!=typeof n?s._orientation[1]:n,r="number"!=typeof r?s._orientation[2]:r,void 0===i){if("number"!=typeof t)return s._orientation;s._orientation=[t,n,r]}for(var o=s._getSoundIds(i),a=0;a<o.length;a++){var l=s._soundById(o[a]);if(l){if("number"!=typeof t)return l._orientation;l._orientation=[t,n,r],l._node&&(l._panner||(l._pos||(l._pos=s._pos||[0,0,-.5]),e(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setOrientation(t,n,r)),s._emit("orientation",l._id)}}return s},Howl.prototype.pannerAttr=function(){var t,n,r,i=this,s=arguments;if(!i._webAudio)return i;if(0===s.length)return i._pannerAttr;if(1===s.length){if("object"!=typeof s[0])return(r=i._soundById(parseInt(s[0],10)))?r._pannerAttr:i._pannerAttr;t=s[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),i._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:i._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:i._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:i._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:i._panningModel})}else 2===s.length&&(t=s[0],n=parseInt(s[1],10));for(var o=i._getSoundIds(n),a=0;a<o.length;a++)if(r=i._soundById(o[a])){var l=r._pannerAttr;l={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:l.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:l.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:l.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:l.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:l.panningModel};var c=r._panner;c||(r._pos||(r._pos=i._pos||[0,0,-.5]),e(r,"spatial"),c=r._panner),c.coneInnerAngle=l.coneInnerAngle,c.coneOuterAngle=l.coneOuterAngle,c.coneOuterGain=l.coneOuterGain,c.distanceModel=l.distanceModel,c.maxDistance=l.maxDistance,c.refDistance=l.refDistance,c.rolloffFactor=l.rolloffFactor,c.panningModel=l.panningModel}return i},Sound.prototype.init=function(t){return function(){var e=this,n=e._parent;e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this),e._stereo?n.stereo(e._stereo):e._pos&&n.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,n=e._parent;return e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,e._stereo?n.stereo(e._stereo):e._pos?n.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,n._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}()},4209:function(t,e,n){"use strict";var r=n(8227),i=n(6269),s=r("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[s]===t)}},4213:function(t,e,n){"use strict";var r=n(3724),i=n(9504),s=n(9565),o=n(9039),a=n(1072),l=n(3717),c=n(8773),h=n(8981),u=n(7055),d=Object.assign,p=Object.defineProperty,f=i([].concat);t.exports=!d||o(function(){if(r&&1!==d({b:1},d(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol("assign detection"),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!==d({},t)[n]||a(d({},e)).join("")!==i})?function(t,e){for(var n=h(t),i=arguments.length,o=1,d=l.f,p=c.f;i>o;)for(var m,g=u(arguments[o++]),v=d?f(a(g),d(g)):a(g),y=v.length,x=0;y>x;)m=v[x++],r&&!s(p,g,m)||(n[m]=g[m]);return n}:d},4215:function(t,e,n){"use strict";var r=n(4576),i=n(2839),s=n(2195),o=function(t){return i.slice(0,t.length)===t};t.exports=o("Bun/")?"BUN":o("Cloudflare-Workers")?"CLOUDFLARE":o("Deno/")?"DENO":o("Node.js/")?"NODE":r.Bun&&"string"==typeof Bun.version?"BUN":r.Deno&&"object"==typeof Deno.version?"DENO":"process"===s(r.process)?"NODE":r.window&&r.document?"BROWSER":"REST"},4265:function(t,e,n){"use strict";var r=n(2839);t.exports=/ipad|iphone|ipod/i.test(r)&&"undefined"!=typeof Pebble},4270:function(t,e,n){"use strict";var r=n(9565),i=n(4901),s=n(34),o=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&i(n=t.toString)&&!s(a=r(n,t)))return a;if(i(n=t.valueOf)&&!s(a=r(n,t)))return a;if("string"!==e&&i(n=t.toString)&&!s(a=r(n,t)))return a;throw new o("Can't convert object to primitive value")}},4373:function(t){t.exports=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports},4376:function(t,e,n){"use strict";var r=n(2195);t.exports=Array.isArray||function(t){return"Array"===r(t)}},4423:function(t,e,n){"use strict";var r=n(6518),i=n(9617).includes,s=n(9039),o=n(6469);r({target:"Array",proto:!0,forced:s(function(){return!Array(1).includes()})},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},4428:function(t,e,n){"use strict";var r=n(8227)("iterator"),i=!1;try{var s=0,o={next:function(){return{done:!!s++}},return:function(){i=!0}};o[r]=function(){return this},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){try{if(!e&&!i)return!1}catch(t){return!1}var n=!1;try{var s={};s[r]=function(){return{next:function(){return{done:n=!0}}}},t(s)}catch(t){}return n}},4459:function(t){"use strict";t.exports=Number.isNaN||function(t){return t!=t}},4495:function(t,e,n){"use strict";var r=n(9519),i=n(9039),s=n(4576).String;t.exports=!!Object.getOwnPropertySymbols&&!i(function(){var t=Symbol("symbol detection");return!s(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41})},4520:function(t,e,n){"use strict";n(2489)},4549:function(t,e,n){"use strict";var r=n(4576);t.exports=function(t,e){var n=r.Iterator,i=n&&n.prototype,s=i&&i[t],o=!1;if(s)try{s.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(t){t instanceof e||(o=!1)}if(!o)return s}},4576:function(t,e,n){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4598:function(t,e,n){"use strict";var r=n(9039);t.exports=function(t,e){var n=[][t];return!!n&&r(function(){n.call(null,e||function(){return 1},1)})}},4601:function(t,e,n){"use strict";var r=n(7751),i=n(9297),s=n(6699),o=n(1625),a=n(2967),l=n(7740),c=n(1056),h=n(3167),u=n(2603),d=n(7584),p=n(747),f=n(3724),m=n(6395);t.exports=function(t,e,n,g){var v="stackTraceLimit",y=g?2:1,x=t.split("."),w=x[x.length-1],_=r.apply(null,x);if(_){var b=_.prototype;if(!m&&i(b,"cause")&&delete b.cause,!n)return _;var A=r("Error"),T=e(function(t,e){var n=u(g?e:t,void 0),r=g?new _(t):new _;return void 0!==n&&s(r,"message",n),p(r,T,r.stack,2),this&&o(b,this)&&h(r,this,T),arguments.length>y&&d(r,arguments[y]),r});if(T.prototype=b,"Error"!==w?a?a(T,A):l(T,A,{name:!0}):f&&v in _&&(c(T,_,v),c(T,_,"prepareStackTrace")),l(T,_),!m)try{b.name!==w&&s(b,"name",w),b.constructor=T}catch(t){}return T}}},4633:function(t,e,n){var r=n(5172),i=n(6993),s=n(5869),o=n(887),a=n(1791),l=n(4373),c=n(579);function h(){"use strict";var e=i(),n=e.m(h),u=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function d(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===u||"GeneratorFunction"===(e.displayName||e.name))}var p={throw:1,return:2,break:3,continue:3};function f(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,p[t],e)},delegateYield:function(t,i,s){return e.resultName=i,n(r.d,c(t),s)},finish:function(t){return n(r.f,t)}},n=function(t,n,i){r.p=e.prev,r.n=e.next;try{return t(n,i)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(t.exports=h=function(){return{wrap:function(t,n,r,i){return e.w(f(t),n,r,i&&i.reverse())},isGeneratorFunction:d,mark:e.m,awrap:function(t,e){return new r(t,e)},AsyncIterator:a,async:function(t,e,n,r,i){return(d(e)?o:s)(f(t),e,n,r,i)},keys:l,values:c}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=h,t.exports.__esModule=!0,t.exports.default=t.exports},4659:function(t,e,n){"use strict";var r=n(9039),i=n(6980);t.exports=!r(function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",i(1,7)),7!==t.stack)})},4756:function(t,e,n){var r=n(4633)();t.exports=r;try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},4765:function(t){"use strict";var e=String.prototype.replace,n=/%20/g,r="RFC3986";t.exports={default:r,formatters:{RFC1738:function(t){return e.call(t,n,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:r}},4782:function(t,e,n){"use strict";var r=n(6518),i=n(4376),s=n(3517),o=n(34),a=n(5610),l=n(6198),c=n(5397),h=n(2278),u=n(8227),d=n(597),p=n(7680),f=d("slice"),m=u("species"),g=Array,v=Math.max;r({target:"Array",proto:!0,forced:!f},{slice:function(t,e){var n,r,u,d=c(this),f=l(d),y=a(t,f),x=a(void 0===e?f:e,f);if(i(d)&&(n=d.constructor,(s(n)&&(n===g||i(n.prototype))||o(n)&&null===(n=n[m]))&&(n=void 0),n===g||void 0===n))return p(d,y,x);for(r=new(void 0===n?g:n)(v(x-y,0)),u=0;y<x;y++,u++)y in d&&h(r,u,d[y]);return r.length=u,r}})},4803:function(t,e,n){"use strict";var r=n(8859),i=n(9675),s=function(t,e,n){for(var r,i=t;null!=(r=i.next);i=r)if(r.key===e)return i.next=r.next,n||(r.next=t.next,t.next=r),r};t.exports=function(){var t,e={assert:function(t){if(!e.has(t))throw new i("Side channel does not contain "+r(t))},delete:function(e){var n=t&&t.next,r=function(t,e){if(t)return s(t,e,!0)}(t,e);return r&&n&&n===r&&(t=void 0),!!r},get:function(e){return function(t,e){if(t){var n=s(t,e);return n&&n.value}}(t,e)},has:function(e){return function(t,e){return!!t&&!!s(t,e)}(t,e)},set:function(e,n){t||(t={next:void 0}),function(t,e,n){var r=s(t,e);r?r.value=n:t.next={key:e,next:t.next,value:n}}(t,e,n)}};return e}},4864:function(t,e,n){"use strict";var r=n(3724),i=n(4576),s=n(9504),o=n(2796),a=n(3167),l=n(6699),c=n(2360),h=n(8480).f,u=n(1625),d=n(788),p=n(655),f=n(1034),m=n(8429),g=n(1056),v=n(6840),y=n(9039),x=n(9297),w=n(1181).enforce,_=n(7633),b=n(8227),A=n(3635),T=n(8814),S=b("match"),E=i.RegExp,k=E.prototype,M=i.SyntaxError,C=s(k.exec),P=s("".charAt),I=s("".replace),R=s("".indexOf),O=s("".slice),D=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,L=/a/g,F=/a/g,B=new E(L)!==L,N=m.MISSED_STICKY,W=m.UNSUPPORTED_Y;if(o("RegExp",r&&(!B||N||A||T||y(function(){return F[S]=!1,E(L)!==L||E(F)===F||"/a/i"!==String(E(L,"i"))})))){for(var U=function(t,e){var n,r,i,s,o,h,m=u(k,this),g=d(t),v=void 0===e,y=[],_=t;if(!m&&g&&v&&t.constructor===U)return t;if((g||u(k,t))&&(t=t.source,v&&(e=f(_))),t=void 0===t?"":p(t),e=void 0===e?"":p(e),_=t,A&&"dotAll"in L&&(r=!!e&&R(e,"s")>-1)&&(e=I(e,/s/g,"")),n=e,N&&"sticky"in L&&(i=!!e&&R(e,"y")>-1)&&W&&(e=I(e,/y/g,"")),T&&(s=function(t){for(var e,n=t.length,r=0,i="",s=[],o=c(null),a=!1,l=!1,h=0,u="";r<=n;r++){if("\\"===(e=P(t,r)))e+=P(t,++r);else if("]"===e)a=!1;else if(!a)switch(!0){case"["===e:a=!0;break;case"("===e:if(i+=e,"?:"===O(t,r+1,r+3))continue;C(D,O(t,r+1))&&(r+=2,l=!0),h++;continue;case">"===e&&l:if(""===u||x(o,u))throw new M("Invalid capture group name");o[u]=!0,s[s.length]=[u,h],l=!1,u="";continue}l?u+=e:i+=e}return[i,s]}(t),t=s[0],y=s[1]),o=a(E(t,e),m?this:k,U),(r||i||y.length)&&(h=w(o),r&&(h.dotAll=!0,h.raw=U(function(t){for(var e,n=t.length,r=0,i="",s=!1;r<=n;r++)"\\"!==(e=P(t,r))?s||"."!==e?("["===e?s=!0:"]"===e&&(s=!1),i+=e):i+="[\\s\\S]":i+=e+P(t,++r);return i}(t),n)),i&&(h.sticky=!0),y.length&&(h.groups=y)),t!==_)try{l(o,"source",""===_?"(?:)":_)}catch(t){}return o},j=h(E),H=0;j.length>H;)g(U,E,j[H++]);k.constructor=U,U.prototype=k,v(i,"RegExp",U,{constructor:!0})}_("RegExp")},4901:function(t){"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},4913:function(t,e,n){"use strict";var r=n(3724),i=n(5917),s=n(8686),o=n(8551),a=n(6969),l=TypeError,c=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u="enumerable",d="configurable",p="writable";e.f=r?s?function(t,e,n){if(o(t),e=a(e),o(n),"function"==typeof t&&"prototype"===e&&"value"in n&&p in n&&!n[p]){var r=h(t,e);r&&r[p]&&(t[e]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:u in n?n[u]:r[u],writable:!1})}return c(t,e,n)}:c:function(t,e,n){if(o(t),e=a(e),o(n),i)try{return c(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new l("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},5031:function(t,e,n){"use strict";var r=n(7751),i=n(9504),s=n(8480),o=n(3717),a=n(8551),l=i([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=s.f(a(t)),n=o.f;return n?l(e,n(t)):e}},5056:function(t,e,n){"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},5072:function(t){"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var s={},o=[],a=0;a<t.length;a++){var l=t[a],c=r.base?l[0]+r.base:l[0],h=s[c]||0,u="".concat(c," ").concat(h);s[c]=h+1;var d=n(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var f=i(p,r);r.byIndex=a,e.splice(a,0,{identifier:u,updater:f,references:1})}o.push(u)}return o}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var s=r(t=t||[],i=i||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--}for(var l=r(t,i),c=0;c<s.length;c++){var h=n(s[c]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}s=l}}},5172:function(t){t.exports=function(t,e){this.v=t,this.k=e},t.exports.__esModule=!0,t.exports.default=t.exports},5213:function(t,e,n){"use strict";var r=n(4576),i=n(9039),s=r.RegExp,o=!i(function(){var t=!0;try{s(".","d")}catch(e){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",i=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in t&&(o.hasIndices="d"),o)i(a,o[a]);return Object.getOwnPropertyDescriptor(s.prototype,"flags").get.call(e)!==r||n!==r});t.exports={correct:o}},5240:function(t,e,n){"use strict";n(6468)("WeakSet",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},n(4006))},5276:function(t,e,n){"use strict";var r=n(6518),i=n(7476),s=n(9617).indexOf,o=n(4598),a=i([].indexOf),l=!!a&&1/a([1],1,-0)<0;r({target:"Array",proto:!0,forced:l||!o("indexOf")},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return l?a(this,t,e)||0:s(this,t,e)}})},5345:function(t){"use strict";t.exports=URIError},5373:function(t,e,n){"use strict";var r=n(8636),i=n(2642),s=n(4765);t.exports={formats:s,parse:i,stringify:r}},5397:function(t,e,n){"use strict";var r=n(7055),i=n(7750);t.exports=function(t){return r(i(t))}},5440:function(t,e,n){"use strict";var r=n(8745),i=n(9565),s=n(9504),o=n(9228),a=n(9039),l=n(8551),c=n(4901),h=n(34),u=n(1291),d=n(8014),p=n(655),f=n(7750),m=n(7829),g=n(5966),v=n(2478),y=n(1034),x=n(6682),w=n(8227)("replace"),_=Math.max,b=Math.min,A=s([].concat),T=s([].push),S=s("".indexOf),E=s("".slice),k=function(t){return void 0===t?t:String(t)},M="$0"==="a".replace(/./,"$0"),C=!!/./[w]&&""===/./[w]("a","$0");o("replace",function(t,e,n){var s=C?"$":"$0";return[function(t,n){var r=f(this),s=h(t)?g(t,w):void 0;return s?i(s,t,r,n):i(e,p(r),t,n)},function(t,i){var o=l(this),a=p(t);if("string"==typeof i&&-1===S(i,s)&&-1===S(i,"$<")){var h=n(e,o,a,i);if(h.done)return h.value}var f=c(i);f||(i=p(i));var g,w=p(y(o)),M=-1!==S(w,"g");M&&(g=-1!==S(w,"u"),o.lastIndex=0);for(var C,P=[];null!==(C=x(o,a))&&(T(P,C),M);)""===p(C[0])&&(o.lastIndex=m(a,d(o.lastIndex),g));for(var I="",R=0,O=0;O<P.length;O++){for(var D,L=p((C=P[O])[0]),F=_(b(u(C.index),a.length),0),B=[],N=1;N<C.length;N++)T(B,k(C[N]));var W=C.groups;if(f){var U=A([L],B,F,a);void 0!==W&&T(U,W),D=p(r(i,void 0,U))}else D=v(L,a,F,B,W,i);F>=R&&(I+=E(a,R,F)+D,R=F+L.length)}return I+E(a,R)}]},!!a(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!M||C)},5506:function(t,e,n){"use strict";var r=n(6518),i=n(2357).entries;r({target:"Object",stat:!0},{entries:function(t){return i(t)}})},5546:function(t){function e(n,r,i,s){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}t.exports=e=function(t,n,r,i){if(n)o?o(t,n,{value:r,enumerable:!i,configurable:!i,writable:!i}):t[n]=r;else{var s=function(n,r){e(t,n,function(t){return this._invoke(n,r,t)})};s("next",0),s("throw",1),s("return",2)}},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,r,i,s)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},5548:function(t,e,n){"use strict";var r=n(3517),i=n(6823),s=TypeError;t.exports=function(t){if(r(t))return t;throw new s(i(t)+" is not a constructor")}},5610:function(t,e,n){"use strict";var r=n(1291),i=Math.max,s=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):s(n,e)}},5652:function(t,e,n){"use strict";var r=n(9039);t.exports=r(function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})},5745:function(t,e,n){"use strict";var r=n(7629);t.exports=function(t,e){return r[t]||(r[t]=e||{})}},5749:function(t,e,n){"use strict";var r=n(788),i=TypeError;t.exports=function(t){if(r(t))throw new i("The method doesn't accept regular expressions");return t}},5795:function(t,e,n){"use strict";var r=n(6549);if(r)try{r([],"length")}catch(t){r=null}t.exports=r},5869:function(t,e,n){var r=n(887);t.exports=function(t,e,n,i,s){var o=r(t,e,n,i,s);return o.next().then(function(t){return t.done?t.value:o.next()})},t.exports.__esModule=!0,t.exports.default=t.exports},5880:function(t){"use strict";t.exports=Math.pow},5917:function(t,e,n){"use strict";var r=n(3724),i=n(9039),s=n(4055);t.exports=!r&&!i(function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a})},5966:function(t,e,n){"use strict";var r=n(9306),i=n(4117);t.exports=function(t,e){var n=t[e];return i(n)?void 0:r(n)}},6033:function(t,e,n){"use strict";n(8523)},6034:function(t,e,n){"use strict";var r=n(6518),i=n(2357).values;r({target:"Object",stat:!0},{values:function(t){return i(t)}})},6043:function(t,e,n){"use strict";var r=n(9306),i=TypeError,s=function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw new i("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)};t.exports.f=function(t){return new s(t)}},6080:function(t,e,n){"use strict";var r=n(7476),i=n(9306),s=n(616),o=r(r.bind);t.exports=function(t,e){return i(t),void 0===e?t:s?o(t,e):function(){return t.apply(e,arguments)}}},6099:function(t,e,n){"use strict";var r=n(2140),i=n(6840),s=n(3179);r||i(Object.prototype,"toString",s,{unsafe:!0})},6119:function(t,e,n){"use strict";var r=n(5745),i=n(3392),s=r("keys");t.exports=function(t){return s[t]||(s[t]=i(t))}},6188:function(t){"use strict";t.exports=Math.max},6193:function(t,e,n){"use strict";var r=n(9504),i=Error,s=r("".replace),o=String(new i("zxcasd").stack),a=/\n\s*at [^:]*:[^\n]*/,l=a.test(o);t.exports=function(t,e){if(l&&"string"==typeof t&&!i.prepareStackTrace)for(;e--;)t=s(t,a,"");return t}},6198:function(t,e,n){"use strict";var r=n(8014);t.exports=function(t){return r(t.length)}},6269:function(t){"use strict";t.exports={}},6279:function(t,e,n){"use strict";var r=n(6840);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},6280:function(t,e,n){"use strict";var r=n(6518),i=n(4576),s=n(8745),o=n(4601),a="WebAssembly",l=i[a],c=7!==new Error("e",{cause:7}).cause,h=function(t,e){var n={};n[t]=o(t,e,c),r({global:!0,constructor:!0,arity:1,forced:c},n)},u=function(t,e){if(l&&l[t]){var n={};n[t]=o(a+"."+t,e,c),r({target:a,stat:!0,constructor:!0,arity:1,forced:c},n)}};h("Error",function(t){return function(e){return s(t,this,arguments)}}),h("EvalError",function(t){return function(e){return s(t,this,arguments)}}),h("RangeError",function(t){return function(e){return s(t,this,arguments)}}),h("ReferenceError",function(t){return function(e){return s(t,this,arguments)}}),h("SyntaxError",function(t){return function(e){return s(t,this,arguments)}}),h("TypeError",function(t){return function(e){return s(t,this,arguments)}}),h("URIError",function(t){return function(e){return s(t,this,arguments)}}),u("CompileError",function(t){return function(e){return s(t,this,arguments)}}),u("LinkError",function(t){return function(e){return s(t,this,arguments)}}),u("RuntimeError",function(t){return function(e){return s(t,this,arguments)}})},6314:function(t){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,r,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var c=0;c<t.length;c++){var h=[].concat(t[c]);r&&o[h[0]]||(void 0!==s&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=s),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),i&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=i):h[4]="".concat(i)),e.push(h))}},e}},6319:function(t,e,n){"use strict";var r=n(8551),i=n(9539);t.exports=function(t,e,n,s){try{return s?e(r(n)[0],n[1]):e(n)}catch(e){i(t,"throw",e)}}},6395:function(t){"use strict";t.exports=!1},6468:function(t,e,n){"use strict";var r=n(6518),i=n(4576),s=n(9504),o=n(2796),a=n(6840),l=n(3451),c=n(2652),h=n(679),u=n(4901),d=n(4117),p=n(34),f=n(9039),m=n(4428),g=n(687),v=n(3167);t.exports=function(t,e,n){var y=-1!==t.indexOf("Map"),x=-1!==t.indexOf("Weak"),w=y?"set":"add",_=i[t],b=_&&_.prototype,A=_,T={},S=function(t){var e=s(b[t]);a(b,t,"add"===t?function(t){return e(this,0===t?0:t),this}:"delete"===t?function(t){return!(x&&!p(t))&&e(this,0===t?0:t)}:"get"===t?function(t){return x&&!p(t)?void 0:e(this,0===t?0:t)}:"has"===t?function(t){return!(x&&!p(t))&&e(this,0===t?0:t)}:function(t,n){return e(this,0===t?0:t,n),this})};if(o(t,!u(_)||!(x||b.forEach&&!f(function(){(new _).entries().next()}))))A=n.getConstructor(e,t,y,w),l.enable();else if(o(t,!0)){var E=new A,k=E[w](x?{}:-0,1)!==E,M=f(function(){E.has(1)}),C=m(function(t){new _(t)}),P=!x&&f(function(){for(var t=new _,e=5;e--;)t[w](e,e);return!t.has(-0)});C||((A=e(function(t,e){h(t,b);var n=v(new _,t,A);return d(e)||c(e,n[w],{that:n,AS_ENTRIES:y}),n})).prototype=b,b.constructor=A),(M||P)&&(S("delete"),S("has"),y&&S("get")),(P||k)&&S(w),x&&b.clear&&delete b.clear}return T[t]=A,r({global:!0,constructor:!0,forced:A!==_},T),g(A,t),x||n.setStrong(A,t,y),A}},6469:function(t,e,n){"use strict";var r=n(8227),i=n(2360),s=n(4913).f,o=r("unscopables"),a=Array.prototype;void 0===a[o]&&s(a,o,{configurable:!0,value:i(null)}),t.exports=function(t){a[o][t]=!0}},6499:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(9306),o=n(6043),a=n(1103),l=n(2652);r({target:"Promise",stat:!0,forced:n(537)},{all:function(t){var e=this,n=o.f(e),r=n.resolve,c=n.reject,h=a(function(){var n=s(e.resolve),o=[],a=0,h=1;l(t,function(t){var s=a++,l=!1;h++,i(n,e,t).then(function(t){l||(l=!0,o[s]=t,--h||r(o))},c)}),--h||r(o)});return h.error&&c(h.value),n.promise}})},6518:function(t,e,n){"use strict";var r=n(4576),i=n(7347).f,s=n(6699),o=n(6840),a=n(9433),l=n(7740),c=n(2796);t.exports=function(t,e){var n,h,u,d,p,f=t.target,m=t.global,g=t.stat;if(n=m?r:g?r[f]||a(f,{}):r[f]&&r[f].prototype)for(h in e){if(d=e[h],u=t.dontCallGetSet?(p=i(n,h))&&p.value:n[h],!c(m?h:f+(g?".":"#")+h,t.forced)&&void 0!==u){if(typeof d==typeof u)continue;l(d,u)}(t.sham||u&&u.sham)&&s(d,"sham",!0),o(n,h,d,t)}}},6549:function(t){"use strict";t.exports=Object.getOwnPropertyDescriptor},6556:function(t,e,n){"use strict";var r=n(453),i=n(3126),s=i([r("%String.prototype.indexOf%")]);t.exports=function(t,e){var n=r(t,!!e);return"function"==typeof n&&s(t,".prototype.")>-1?i([n]):n}},6570:function(t){"use strict";function e(t,e,r){r=r||2;var s,o,a,l,u,d,f,m=e&&e.length,g=m?e[0]*r:t.length,v=n(t,0,g,r,!0),y=[];if(!v||v.next===v.prev)return y;if(m&&(v=function(t,e,r,i){var s,o,a,l=[];for(s=0,o=e.length;s<o;s++)(a=n(t,e[s]*i,s<o-1?e[s+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),l.push(p(a));for(l.sort(c),s=0;s<l.length;s++)r=h(l[s],r);return r}(t,e,v,r)),t.length>80*r){s=a=t[0],o=l=t[1];for(var x=r;x<g;x+=r)(u=t[x])<s&&(s=u),(d=t[x+1])<o&&(o=d),u>a&&(a=u),d>l&&(l=d);f=0!==(f=Math.max(a-s,l-o))?32767/f:0}return i(v,y,r,s,o,f,0),y}function n(t,e,n,r,i){var s,o;if(i===E(t,e,n,r)>0)for(s=e;s<n;s+=r)o=A(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=A(s,t[s],t[s+1],o);return o&&v(o,o.next)&&(T(o),o=o.next),o}function r(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!v(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(T(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,c,h,u,p){if(t){!p&&u&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=d(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ);e++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1)}(i)}(t,c,h,u);for(var f,m,g=t;t.prev!==t.next;)if(f=t.prev,m=t.next,u?o(t,c,h,u):s(t))e.push(f.i/n|0),e.push(t.i/n|0),e.push(m.i/n|0),T(t),t=m.next,g=m.next;else if((t=m)===g){p?1===p?i(t=a(r(t),e,n),e,n,c,h,u,2):2===p&&l(t,e,n,c,h,u):i(r(t),e,n,c,h,u,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(g(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,l=n.y,c=r.y,h=i<s?i<o?i:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=i>s?i>o?i:o:s>o?s:o,p=a>l?a>c?a:c:l>c?l:c,m=r.next;m!==e;){if(m.x>=h&&m.x<=d&&m.y>=u&&m.y<=p&&f(i,a,s,l,o,c,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function o(t,e,n,r){var i=t.prev,s=t,o=t.next;if(g(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,c=o.x,h=i.y,u=s.y,p=o.y,m=a<l?a<c?a:c:l<c?l:c,v=h<u?h<p?h:p:u<p?u:p,y=a>l?a>c?a:c:l>c?l:c,x=h>u?h>p?h:p:u>p?u:p,w=d(m,v,e,n,r),_=d(y,x,e,n,r),b=t.prevZ,A=t.nextZ;b&&b.z>=w&&A&&A.z<=_;){if(b.x>=m&&b.x<=y&&b.y>=v&&b.y<=x&&b!==i&&b!==o&&f(a,h,l,u,c,p,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,A.x>=m&&A.x<=y&&A.y>=v&&A.y<=x&&A!==i&&A!==o&&f(a,h,l,u,c,p,A.x,A.y)&&g(A.prev,A,A.next)>=0)return!1;A=A.nextZ}for(;b&&b.z>=w;){if(b.x>=m&&b.x<=y&&b.y>=v&&b.y<=x&&b!==i&&b!==o&&f(a,h,l,u,c,p,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;A&&A.z<=_;){if(A.x>=m&&A.x<=y&&A.y>=v&&A.y<=x&&A!==i&&A!==o&&f(a,h,l,u,c,p,A.x,A.y)&&g(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function a(t,e,n){var i=t;do{var s=i.prev,o=i.next.next;!v(s,o)&&y(s,i,i.next,o)&&_(s,o)&&_(o,s)&&(e.push(s.i/n|0),e.push(i.i/n|0),e.push(o.i/n|0),T(i),T(i.next),i=t=o),i=i.next}while(i!==t);return r(i)}function l(t,e,n,s,o,a){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&m(l,c)){var h=b(l,c);return l=r(l,l.next),h=r(h,h.next),i(l,e,n,s,o,a,0),void i(h,e,n,s,o,a,0)}c=c.next}l=l.next}while(l!==t)}function c(t,e){return t.x-e.x}function h(t,e){var n=function(t,e){var n,r=e,i=t.x,s=t.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>o&&(o=a,n=r.x<r.next.x?r:r.next,a===i))return n}r=r.next}while(r!==e);if(!n)return null;var l,c=n,h=n.x,d=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=h&&i!==r.x&&f(s<d?i:o,s,h,d,s<d?o:i,s,r.x,r.y)&&(l=Math.abs(s-r.y)/(i-r.x),_(r,t)&&(l<p||l===p&&(r.x>n.x||r.x===n.x&&u(n,r)))&&(n=r,p=l)),r=r.next}while(r!==c);return n}(t,e);if(!n)return e;var i=b(n,t);return r(i,i.next),r(n,n.next)}function u(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function d(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function f(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(_(t,e)&&_(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||v(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,n,r){var i=w(g(t,e,n)),s=w(g(t,e,r)),o=w(g(n,r,t)),a=w(g(n,r,e));return i!==s&&o!==a||!(0!==i||!x(t,n,e))||!(0!==s||!x(t,r,e))||!(0!==o||!x(n,t,r))||!(0!==a||!x(n,e,r))}function x(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function w(t){return t>0?1:t<0?-1:0}function _(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function b(t,e){var n=new S(t.i,t.x,t.y),r=new S(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function A(t,e,n,r){var i=new S(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function T(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(E(t,0,s,n));if(i)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,h=a<l-1?e[a+1]*n:t.length;o-=Math.abs(E(t,c,h,n))}var u=0;for(a=0;a<r.length;a+=3){var d=r[a]*n,p=r[a+1]*n,f=r[a+2]*n;u+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===o&&0===u?0:Math.abs((u-o)/o)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},6682:function(t,e,n){"use strict";var r=n(9565),i=n(8551),s=n(4901),o=n(2195),a=n(7323),l=TypeError;t.exports=function(t,e){var n=t.exec;if(s(n)){var c=r(n,t,e);return null!==c&&i(c),c}if("RegExp"===o(t))return r(a,t,e);throw new l("RegExp#exec called on incompatible receiver")}},6699:function(t,e,n){"use strict";var r=n(3724),i=n(4913),s=n(6980);t.exports=r?function(t,e,n){return i.f(t,e,s(1,n))}:function(t,e,n){return t[e]=n,t}},6706:function(t,e,n){"use strict";var r=n(9504),i=n(9306);t.exports=function(t,e,n){try{return r(i(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}}},6743:function(t,e,n){"use strict";var r=n(9353);t.exports=Function.prototype.bind||r},6761:function(t,e,n){"use strict";var r=n(6518),i=n(4576),s=n(9565),o=n(9504),a=n(6395),l=n(3724),c=n(4495),h=n(9039),u=n(9297),d=n(1625),p=n(8551),f=n(5397),m=n(6969),g=n(655),v=n(6980),y=n(2360),x=n(1072),w=n(8480),_=n(298),b=n(3717),A=n(7347),T=n(4913),S=n(6801),E=n(8773),k=n(6840),M=n(2106),C=n(5745),P=n(6119),I=n(421),R=n(3392),O=n(8227),D=n(1951),L=n(511),F=n(8242),B=n(687),N=n(1181),W=n(9213).forEach,U=P("hidden"),j="Symbol",H="prototype",z=N.set,G=N.getterFor(j),X=Object[H],V=i.Symbol,Y=V&&V[H],$=i.RangeError,q=i.TypeError,K=i.QObject,Z=A.f,Q=T.f,J=_.f,tt=E.f,et=o([].push),nt=C("symbols"),rt=C("op-symbols"),it=C("wks"),st=!K||!K[H]||!K[H].findChild,ot=function(t,e,n){var r=Z(X,e);r&&delete X[e],Q(t,e,n),r&&t!==X&&Q(X,e,r)},at=l&&h(function(){return 7!==y(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a})?ot:Q,lt=function(t,e){var n=nt[t]=y(Y);return z(n,{type:j,tag:t,description:e}),l||(n.description=e),n},ct=function(t,e,n){t===X&&ct(rt,e,n),p(t);var r=m(e);return p(n),u(nt,r)?(n.enumerable?(u(t,U)&&t[U][r]&&(t[U][r]=!1),n=y(n,{enumerable:v(0,!1)})):(u(t,U)||Q(t,U,v(1,y(null))),t[U][r]=!0),at(t,r,n)):Q(t,r,n)},ht=function(t,e){p(t);var n=f(e),r=x(n).concat(ft(n));return W(r,function(e){l&&!s(ut,n,e)||ct(t,e,n[e])}),t},ut=function(t){var e=m(t),n=s(tt,this,e);return!(this===X&&u(nt,e)&&!u(rt,e))&&(!(n||!u(this,e)||!u(nt,e)||u(this,U)&&this[U][e])||n)},dt=function(t,e){var n=f(t),r=m(e);if(n!==X||!u(nt,r)||u(rt,r)){var i=Z(n,r);return!i||!u(nt,r)||u(n,U)&&n[U][r]||(i.enumerable=!0),i}},pt=function(t){var e=J(f(t)),n=[];return W(e,function(t){u(nt,t)||u(I,t)||et(n,t)}),n},ft=function(t){var e=t===X,n=J(e?rt:f(t)),r=[];return W(n,function(t){!u(nt,t)||e&&!u(X,t)||et(r,nt[t])}),r};c||(V=function(){if(d(Y,this))throw new q("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?g(arguments[0]):void 0,e=R(t),n=function(t){var r=void 0===this?i:this;r===X&&s(n,rt,t),u(r,U)&&u(r[U],e)&&(r[U][e]=!1);var o=v(1,t);try{at(r,e,o)}catch(t){if(!(t instanceof $))throw t;ot(r,e,o)}};return l&&st&&at(X,e,{configurable:!0,set:n}),lt(e,t)},k(Y=V[H],"toString",function(){return G(this).tag}),k(V,"withoutSetter",function(t){return lt(R(t),t)}),E.f=ut,T.f=ct,S.f=ht,A.f=dt,w.f=_.f=pt,b.f=ft,D.f=function(t){return lt(O(t),t)},l&&(M(Y,"description",{configurable:!0,get:function(){return G(this).description}}),a||k(X,"propertyIsEnumerable",ut,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!c,sham:!c},{Symbol:V}),W(x(it),function(t){L(t)}),r({target:j,stat:!0,forced:!c},{useSetter:function(){st=!0},useSimple:function(){st=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!l},{create:function(t,e){return void 0===e?y(t):ht(y(t),e)},defineProperty:ct,defineProperties:ht,getOwnPropertyDescriptor:dt}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:pt}),F(),B(V,j),I[U]=!0},6801:function(t,e,n){"use strict";var r=n(3724),i=n(8686),s=n(4913),o=n(8551),a=n(5397),l=n(1072);e.f=r&&!i?Object.defineProperties:function(t,e){o(t);for(var n,r=a(e),i=l(e),c=i.length,h=0;c>h;)s.f(t,n=i[h++],r[n]);return t}},6823:function(t){"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},6837:function(t){"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},6840:function(t,e,n){"use strict";var r=n(4901),i=n(4913),s=n(283),o=n(9433);t.exports=function(t,e,n,a){a||(a={});var l=a.enumerable,c=void 0!==a.name?a.name:e;if(r(n)&&s(n,c,a),a.global)l?t[e]=n:o(e,n);else{try{a.unsafe?t[e]&&(l=!0):delete t[e]}catch(t){}l?t[e]=n:i.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},6933:function(t,e,n){"use strict";var r=n(9504),i=n(4376),s=n(4901),o=n(2195),a=n(655),l=r([].push);t.exports=function(t){if(s(t))return t;if(i(t)){for(var e=t.length,n=[],r=0;r<e;r++){var c=t[r];"string"==typeof c?l(n,c):"number"!=typeof c&&"Number"!==o(c)&&"String"!==o(c)||l(n,a(c))}var h=n.length,u=!0;return function(t,e){if(u)return u=!1,e;if(i(this))return e;for(var r=0;r<h;r++)if(n[r]===t)return e}}}},6938:function(t,e,n){"use strict";var r=n(2360),i=n(2106),s=n(6279),o=n(6080),a=n(679),l=n(4117),c=n(2652),h=n(1088),u=n(2529),d=n(7633),p=n(3724),f=n(3451).fastKey,m=n(1181),g=m.set,v=m.getterFor;t.exports={getConstructor:function(t,e,n,h){var u=t(function(t,i){a(t,d),g(t,{type:e,index:r(null),first:null,last:null,size:0}),p||(t.size=0),l(i)||c(i,t[h],{that:t,AS_ENTRIES:n})}),d=u.prototype,m=v(e),y=function(t,e,n){var r,i,s=m(t),o=x(t,e);return o?o.value=n:(s.last=o={index:i=f(e,!0),key:e,value:n,previous:r=s.last,next:null,removed:!1},s.first||(s.first=o),r&&(r.next=o),p?s.size++:t.size++,"F"!==i&&(s.index[i]=o)),t},x=function(t,e){var n,r=m(t),i=f(e);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key===e)return n};return s(d,{clear:function(){for(var t=m(this),e=t.first;e;)e.removed=!0,e.previous&&(e.previous=e.previous.next=null),e=e.next;t.first=t.last=null,t.index=r(null),p?t.size=0:this.size=0},delete:function(t){var e=this,n=m(e),r=x(e,t);if(r){var i=r.next,s=r.previous;delete n.index[r.index],r.removed=!0,s&&(s.next=i),i&&(i.previous=s),n.first===r&&(n.first=i),n.last===r&&(n.last=s),p?n.size--:e.size--}return!!r},forEach:function(t){for(var e,n=m(this),r=o(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:n.first;)for(r(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!x(this,t)}}),s(d,n?{get:function(t){var e=x(this,t);return e&&e.value},set:function(t,e){return y(this,0===t?0:t,e)}}:{add:function(t){return y(this,t=0===t?0:t,t)}}),p&&i(d,"size",{configurable:!0,get:function(){return m(this).size}}),u},setStrong:function(t,e,n){var r=e+" Iterator",i=v(e),s=v(r);h(t,e,function(t,e){g(this,{type:r,target:t,state:i(t),kind:e,last:null})},function(){for(var t=s(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?u("keys"===e?n.key:"values"===e?n.value:[n.key,n.value],!1):(t.target=null,u(void 0,!0))},n?"entries":"values",!n,!0),d(e)}}},6955:function(t,e,n){"use strict";var r=n(2140),i=n(4901),s=n(2195),o=n(8227)("toStringTag"),a=Object,l="Arguments"===s(function(){return arguments}());t.exports=r?s:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=a(t),o))?n:l?s(e):"Object"===(r=s(e))&&i(e.callee)?"Arguments":r}},6969:function(t,e,n){"use strict";var r=n(2777),i=n(757);t.exports=function(t){var e=r(t,"string");return i(e)?e:e+""}},6980:function(t){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},6993:function(t,e,n){var r=n(5546);function i(){var e,n,s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.toStringTag||"@@toStringTag";function l(t,i,s,o){var a=i&&i.prototype instanceof h?i:h,l=Object.create(a.prototype);return r(l,"_invoke",function(t,r,i){var s,o,a,l=0,h=i||[],u=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return s=t,o=0,a=e,d.n=n,c}};function p(t,r){for(o=t,a=r,n=0;!u&&l&&!i&&n<h.length;n++){var i,s=h[n],p=d.p,f=s[2];t>3?(i=f===r)&&(a=s[(o=s[4])?5:(o=3,3)],s[4]=s[5]=e):s[0]<=p&&((i=t<2&&p<s[1])?(o=0,d.v=r,d.n=s[1]):p<f&&(i=t<3||s[0]>r||r>f)&&(s[4]=t,s[5]=r,d.n=f,o=0))}if(i||t>1)return c;throw u=!0,r}return function(i,h,f){if(l>1)throw TypeError("Generator is already running");for(u&&1===h&&p(h,f),o=h,a=f;(n=o<2?e:a)||!u;){s||(o?o<3?(o>1&&(d.n=-1),p(o,a)):d.n=a:d.v=a);try{if(l=2,s){if(o||(i="next"),n=s[i]){if(!(n=n.call(s,a)))throw TypeError("iterator result is not an object");if(!n.done)return n;a=n.value,o<2&&(o=0)}else 1===o&&(n=s.return)&&n.call(s),o<2&&(a=TypeError("The iterator does not provide a '"+i+"' method"),o=1);s=e}else if((n=(u=d.n<0)?a:t.call(r,d))!==c)break}catch(t){s=e,o=1,a=t}finally{l=1}}return{value:n,done:u}}}(t,s,o),!0),l}var c={};function h(){}function u(){}function d(){}n=Object.getPrototypeOf;var p=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),f=d.prototype=h.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,r(t,a,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=d,r(f,"constructor",d),r(d,"constructor",u),u.displayName="GeneratorFunction",r(d,a,"GeneratorFunction"),r(f),r(f,a,"Generator"),r(f,o,function(){return this}),r(f,"toString",function(){return"[object Generator]"}),(t.exports=i=function(){return{w:l,m:m}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},7040:function(t,e,n){"use strict";var r=n(4495);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7055:function(t,e,n){"use strict";var r=n(9504),i=n(9039),s=n(2195),o=Object,a=r("".split);t.exports=i(function(){return!o("z").propertyIsEnumerable(0)})?function(t){return"String"===s(t)?a(t,""):o(t)}:o},7119:function(t){"use strict";t.exports="undefined"!=typeof Reflect&&Reflect&&Reflect.apply},7176:function(t,e,n){"use strict";var r,i=n(3126),s=n(5795);try{r=[].__proto__===Array.prototype}catch(t){if(!t||"object"!=typeof t||!("code"in t)||"ERR_PROTO_ACCESS"!==t.code)throw t}var o=!!r&&s&&s(Object.prototype,"__proto__"),a=Object,l=a.getPrototypeOf;t.exports=o&&"function"==typeof o.get?i([o.get]):"function"==typeof l&&function(t){return l(null==t?t:a(t))}},7323:function(t,e,n){"use strict";var r,i,s=n(9565),o=n(9504),a=n(655),l=n(7979),c=n(8429),h=n(5745),u=n(2360),d=n(1181).get,p=n(3635),f=n(8814),m=h("native-string-replace",String.prototype.replace),g=RegExp.prototype.exec,v=g,y=o("".charAt),x=o("".indexOf),w=o("".replace),_=o("".slice),b=(i=/b*/g,s(g,r=/a/,"a"),s(g,i,"a"),0!==r.lastIndex||0!==i.lastIndex),A=c.BROKEN_CARET,T=void 0!==/()??/.exec("")[1];(b||T||A||p||f)&&(v=function(t){var e,n,r,i,o,c,h,p=this,f=d(p),S=a(t),E=f.raw;if(E)return E.lastIndex=p.lastIndex,e=s(v,E,S),p.lastIndex=E.lastIndex,e;var k=f.groups,M=A&&p.sticky,C=s(l,p),P=p.source,I=0,R=S;if(M&&(C=w(C,"y",""),-1===x(C,"g")&&(C+="g"),R=_(S,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==y(S,p.lastIndex-1))&&(P="(?: "+P+")",R=" "+R,I++),n=new RegExp("^(?:"+P+")",C)),T&&(n=new RegExp("^"+P+"$(?!\\s)",C)),b&&(r=p.lastIndex),i=s(g,M?n:p,R),M?i?(i.input=_(i.input,I),i[0]=_(i[0],I),i.index=p.lastIndex,p.lastIndex+=i[0].length):p.lastIndex=0:b&&i&&(p.lastIndex=p.global?i.index+i[0].length:r),T&&i&&i.length>1&&s(m,i[0],n,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)}),i&&k)for(i.groups=c=u(null),o=0;o<k.length;o++)c[(h=k[o])[0]]=i[h[1]];return i}),t.exports=v},7347:function(t,e,n){"use strict";var r=n(3724),i=n(9565),s=n(8773),o=n(6980),a=n(5397),l=n(6969),c=n(9297),h=n(5917),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=a(t),e=l(e),h)try{return u(t,e)}catch(t){}if(c(t,e))return o(!i(s.f,t,e),t[e])}},7400:function(t){"use strict";t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},7433:function(t,e,n){"use strict";var r=n(4376),i=n(3517),s=n(34),o=n(8227)("species"),a=Array;t.exports=function(t){var e;return r(t)&&(e=t.constructor,(i(e)&&(e===a||r(e.prototype))||s(e)&&null===(e=e[o]))&&(e=void 0)),void 0===e?a:e}},7452:function(t){"use strict";t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},7465:function(t,e,n){"use strict";var r=n(3724),i=n(3635),s=n(2195),o=n(2106),a=n(1181).get,l=RegExp.prototype,c=TypeError;r&&i&&o(l,"dotAll",{configurable:!0,get:function(){if(this!==l){if("RegExp"===s(this))return!!a(this).dotAll;throw new c("Incompatible receiver, RegExp required")}}})},7476:function(t,e,n){"use strict";var r=n(2195),i=n(9504);t.exports=function(t){if("Function"===r(t))return i(t)}},7495:function(t,e,n){"use strict";var r=n(6518),i=n(7323);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},7550:function(t,e,n){"use strict";n(3579)},7584:function(t,e,n){"use strict";var r=n(34),i=n(6699);t.exports=function(t,e){r(e)&&"cause"in e&&i(t,"cause",e.cause)}},7588:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(2652),o=n(9306),a=n(8551),l=n(1767),c=n(9539),h=n(4549)("forEach",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:h},{forEach:function(t){a(this);try{o(t)}catch(t){c(this,"throw",t)}if(h)return i(h,this,t);var e=l(this),n=0;s(e,function(e){t(e,n++)},{IS_RECORD:!0})}})},7629:function(t,e,n){"use strict";var r=n(6395),i=n(4576),s=n(9433),o="__core-js_shared__",a=t.exports=i[o]||s(o,{});(a.versions||(a.versions=[])).push({version:"3.44.0",mode:r?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7633:function(t,e,n){"use strict";var r=n(7751),i=n(2106),s=n(8227),o=n(3724),a=s("species");t.exports=function(t){var e=r(t);o&&e&&!e[a]&&i(e,a,{configurable:!0,get:function(){return this}})}},7657:function(t,e,n){"use strict";var r,i,s,o=n(9039),a=n(4901),l=n(34),c=n(2360),h=n(2787),u=n(6840),d=n(8227),p=n(6395),f=d("iterator"),m=!1;[].keys&&("next"in(s=[].keys())?(i=h(h(s)))!==Object.prototype&&(r=i):m=!0),!l(r)||o(function(){var t={};return r[f].call(t)!==t})?r={}:p&&(r=c(r)),a(r[f])||u(r,f,function(){return this}),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:m}},7659:function(t){"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},7680:function(t,e,n){"use strict";var r=n(9504);t.exports=r([].slice)},7720:function(t,e,n){"use strict";var r=n(4765),i=Object.prototype.hasOwnProperty,s=Array.isArray,o=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),a=function(t,e){for(var n=e&&e.plainObjects?{__proto__:null}:{},r=0;r<t.length;++r)void 0!==t[r]&&(n[r]=t[r]);return n},l=1024;t.exports={arrayToObject:a,assign:function(t,e){return Object.keys(e).reduce(function(t,n){return t[n]=e[n],t},t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],r=0;r<e.length;++r)for(var i=e[r],o=i.obj[i.prop],a=Object.keys(o),l=0;l<a.length;++l){var c=a[l],h=o[c];"object"==typeof h&&null!==h&&-1===n.indexOf(h)&&(e.push({obj:o,prop:c}),n.push(h))}return function(t){for(;t.length>1;){var e=t.pop(),n=e.obj[e.prop];if(s(n)){for(var r=[],i=0;i<n.length;++i)void 0!==n[i]&&r.push(n[i]);e.obj[e.prop]=r}}}(e),t},decode:function(t,e,n){var r=t.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(t){return r}},encode:function(t,e,n,i,s){if(0===t.length)return t;var a=t;if("symbol"==typeof t?a=Symbol.prototype.toString.call(t):"string"!=typeof t&&(a=String(t)),"iso-8859-1"===n)return escape(a).replace(/%u[0-9a-f]{4}/gi,function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"});for(var c="",h=0;h<a.length;h+=l){for(var u=a.length>=l?a.slice(h,h+l):a,d=[],p=0;p<u.length;++p){var f=u.charCodeAt(p);45===f||46===f||95===f||126===f||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||s===r.RFC1738&&(40===f||41===f)?d[d.length]=u.charAt(p):f<128?d[d.length]=o[f]:f<2048?d[d.length]=o[192|f>>6]+o[128|63&f]:f<55296||f>=57344?d[d.length]=o[224|f>>12]+o[128|f>>6&63]+o[128|63&f]:(p+=1,f=65536+((1023&f)<<10|1023&u.charCodeAt(p)),d[d.length]=o[240|f>>18]+o[128|f>>12&63]+o[128|f>>6&63]+o[128|63&f])}c+=d.join("")}return c},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(s(t)){for(var n=[],r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)},merge:function t(e,n,r){if(!n)return e;if("object"!=typeof n&&"function"!=typeof n){if(s(e))e.push(n);else{if(!e||"object"!=typeof e)return[e,n];(r&&(r.plainObjects||r.allowPrototypes)||!i.call(Object.prototype,n))&&(e[n]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(n);var o=e;return s(e)&&!s(n)&&(o=a(e,r)),s(e)&&s(n)?(n.forEach(function(n,s){if(i.call(e,s)){var o=e[s];o&&"object"==typeof o&&n&&"object"==typeof n?e[s]=t(o,n,r):e.push(n)}else e[s]=n}),e):Object.keys(n).reduce(function(e,s){var o=n[s];return i.call(e,s)?e[s]=t(e[s],o,r):e[s]=o,e},o)}}},7740:function(t,e,n){"use strict";var r=n(9297),i=n(5031),s=n(7347),o=n(4913);t.exports=function(t,e,n){for(var a=i(e),l=o.f,c=s.f,h=0;h<a.length;h++){var u=a[h];r(t,u)||n&&r(n,u)||l(t,u,c(e,u))}}},7743:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(9306),o=n(6043),a=n(1103),l=n(2652);r({target:"Promise",stat:!0,forced:n(537)},{race:function(t){var e=this,n=o.f(e),r=n.reject,c=a(function(){var o=s(e.resolve);l(t,function(t){i(o,e,t).then(n.resolve,r)})});return c.error&&r(c.value),n.promise}})},7745:function(t,e,n){"use strict";var r=n(3724),i=n(8429).MISSED_STICKY,s=n(2195),o=n(2106),a=n(1181).get,l=RegExp.prototype,c=TypeError;r&&i&&o(l,"sticky",{configurable:!0,get:function(){if(this!==l){if("RegExp"===s(this))return!!a(this).sticky;throw new c("Incompatible receiver, RegExp required")}}})},7750:function(t,e,n){"use strict";var r=n(4117),i=TypeError;t.exports=function(t){if(r(t))throw new i("Can't call method on "+t);return t}},7751:function(t,e,n){"use strict";var r=n(4576),i=n(4901);t.exports=function(t,e){return arguments.length<2?(n=r[t],i(n)?n:void 0):r[t]&&r[t][e];var n}},7764:function(t,e,n){"use strict";var r=n(8183).charAt,i=n(655),s=n(1181),o=n(1088),a=n(2529),l="String Iterator",c=s.set,h=s.getterFor(l);o(String,"String",function(t){c(this,{type:l,string:i(t),index:0})},function(){var t,e=h(this),n=e.string,i=e.index;return i>=n.length?a(void 0,!0):(t=r(n,i),e.index+=t.length,a(t,!1))})},7812:function(t,e,n){"use strict";var r=n(6518),i=n(9297),s=n(757),o=n(6823),a=n(5745),l=n(1296),c=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!l},{keyFor:function(t){if(!s(t))throw new TypeError(o(t)+" is not a symbol");if(i(c,t))return c[t]}})},7825:function(t){"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},7829:function(t,e,n){"use strict";var r=n(8183).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},7860:function(t,e,n){"use strict";var r=n(2839);t.exports=/web0s(?!.*chrome)/i.test(r)},7916:function(t,e,n){"use strict";var r=n(6080),i=n(9565),s=n(8981),o=n(6319),a=n(4209),l=n(3517),c=n(6198),h=n(2278),u=n(81),d=n(851),p=Array;t.exports=function(t){var e=s(t),n=l(this),f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m;g&&(m=r(m,f>2?arguments[2]:void 0));var v,y,x,w,_,b,A=d(e),T=0;if(!A||this===p&&a(A))for(v=c(e),y=n?new this(v):p(v);v>T;T++)b=g?m(e[T],T):e[T],h(y,T,b);else for(y=n?new this:[],_=(w=u(e,A)).next;!(x=i(_,w)).done;T++)b=g?o(w,m,[x.value,T],!0):x.value,h(y,T,b);return y.length=T,y}},7979:function(t,e,n){"use strict";var r=n(8551);t.exports=function(){var t=r(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},8002:function(t){"use strict";t.exports=Math.min},8014:function(t,e,n){"use strict";var r=n(1291),i=Math.min;t.exports=function(t){var e=r(t);return e>0?i(e,9007199254740991):0}},8068:function(t){"use strict";t.exports=SyntaxError},8111:function(t,e,n){"use strict";var r=n(6518),i=n(4576),s=n(679),o=n(8551),a=n(4901),l=n(2787),c=n(2106),h=n(2278),u=n(9039),d=n(9297),p=n(8227),f=n(7657).IteratorPrototype,m=n(3724),g=n(6395),v="constructor",y="Iterator",x=p("toStringTag"),w=TypeError,_=i[y],b=g||!a(_)||_.prototype!==f||!u(function(){_({})}),A=function(){if(s(this,f),l(this)===f)throw new w("Abstract class Iterator not directly constructable")},T=function(t,e){m?c(f,t,{configurable:!0,get:function(){return e},set:function(e){if(o(this),this===f)throw new w("You can't redefine this property");d(this,t)?this[t]=e:h(this,t,e)}}):f[t]=e};d(f,x)||T(x,y),!b&&d(f,v)&&f[v]!==Object||T(v,A),A.prototype=f,r({global:!0,constructor:!0,forced:b},{Iterator:A})},8156:function(t,e,n){"use strict";var r=n(6518),i=n(533).start;r({target:"String",proto:!0,forced:n(3063)},{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},8183:function(t,e,n){"use strict";var r=n(9504),i=n(1291),s=n(655),o=n(7750),a=r("".charAt),l=r("".charCodeAt),c=r("".slice),h=function(t){return function(e,n){var r,h,u=s(o(e)),d=i(n),p=u.length;return d<0||d>=p?t?"":void 0:(r=l(u,d))<55296||r>56319||d+1===p||(h=l(u,d+1))<56320||h>57343?t?a(u,d):r:t?c(u,d,d+2):h-56320+(r-55296<<10)+65536}};t.exports={codeAt:h(!1),charAt:h(!0)}},8227:function(t,e,n){"use strict";var r=n(4576),i=n(5745),s=n(9297),o=n(3392),a=n(4495),l=n(7040),c=r.Symbol,h=i("wks"),u=l?c.for||c:c&&c.withoutSetter||o;t.exports=function(t){return s(h,t)||(h[t]=a&&s(c,t)?c[t]:u("Symbol."+t)),h[t]}},8237:function(t,e,n){"use strict";var r=n(6518),i=n(2652),s=n(9306),o=n(8551),a=n(1767),l=n(9539),c=n(4549),h=n(8745),u=n(9039),d=TypeError,p=u(function(){[].keys().reduce(function(){},void 0)}),f=!p&&c("reduce",d);r({target:"Iterator",proto:!0,real:!0,forced:p||f},{reduce:function(t){o(this);try{s(t)}catch(t){l(this,"throw",t)}var e=arguments.length<2,n=e?void 0:arguments[1];if(f)return h(f,this,e?[t]:[t,n]);var r=a(this),c=0;if(i(r,function(r){e?(e=!1,n=r):n=t(n,r,c),c++},{IS_RECORD:!0}),e)throw new d("Reduce of empty iterator with no initial value");return n}})},8242:function(t,e,n){"use strict";var r=n(9565),i=n(7751),s=n(8227),o=n(6840);t.exports=function(){var t=i("Symbol"),e=t&&t.prototype,n=e&&e.valueOf,a=s("toPrimitive");e&&!e[a]&&o(e,a,function(t){return r(n,this)},{arity:1})}},8265:function(t){"use strict";var e=function(){this.head=null,this.tail=null};e.prototype={add:function(t){var e={item:t,next:null},n=this.tail;n?n.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}},t.exports=e},8429:function(t,e,n){"use strict";var r=n(9039),i=n(4576).RegExp,s=r(function(){var t=i("a","y");return t.lastIndex=2,null!==t.exec("abcd")}),o=s||r(function(){return!i("a","y").sticky}),a=s||r(function(){var t=i("^r","gy");return t.lastIndex=2,null!==t.exec("str")});t.exports={BROKEN_CARET:a,MISSED_STICKY:o,UNSUPPORTED_Y:s}},8480:function(t,e,n){"use strict";var r=n(1828),i=n(8727).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},8523:function(t,e,n){"use strict";n(6468)("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},n(6938))},8551:function(t,e,n){"use strict";var r=n(34),i=String,s=TypeError;t.exports=function(t){if(r(t))return t;throw new s(i(t)+" is not an object")}},8574:function(t,e,n){"use strict";var r=n(4215);t.exports="NODE"===r},8622:function(t,e,n){"use strict";var r=n(4576),i=n(4901),s=r.WeakMap;t.exports=i(s)&&/native code/.test(String(s))},8636:function(t,e,n){"use strict";var r=n(920),i=n(7720),s=n(4765),o=Object.prototype.hasOwnProperty,a={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},l=Array.isArray,c=Array.prototype.push,h=function(t,e){c.apply(t,l(e)?e:[e])},u=Date.prototype.toISOString,d=s.default,p={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:i.encode,encodeValuesOnly:!1,filter:void 0,format:d,formatter:s.formatters[d],indices:!1,serializeDate:function(t){return u.call(t)},skipNulls:!1,strictNullHandling:!1},f={},m=function t(e,n,s,o,a,c,u,d,m,g,v,y,x,w,_,b,A,T){for(var S,E=e,k=T,M=0,C=!1;void 0!==(k=k.get(f))&&!C;){var P=k.get(e);if(M+=1,void 0!==P){if(P===M)throw new RangeError("Cyclic object value");C=!0}void 0===k.get(f)&&(M=0)}if("function"==typeof g?E=g(n,E):E instanceof Date?E=x(E):"comma"===s&&l(E)&&(E=i.maybeMap(E,function(t){return t instanceof Date?x(t):t})),null===E){if(c)return m&&!b?m(n,p.encoder,A,"key",w):n;E=""}if("string"==typeof(S=E)||"number"==typeof S||"boolean"==typeof S||"symbol"==typeof S||"bigint"==typeof S||i.isBuffer(E))return m?[_(b?n:m(n,p.encoder,A,"key",w))+"="+_(m(E,p.encoder,A,"value",w))]:[_(n)+"="+_(String(E))];var I,R=[];if(void 0===E)return R;if("comma"===s&&l(E))b&&m&&(E=i.maybeMap(E,m)),I=[{value:E.length>0?E.join(",")||null:void 0}];else if(l(g))I=g;else{var O=Object.keys(E);I=v?O.sort(v):O}var D=d?String(n).replace(/\./g,"%2E"):String(n),L=o&&l(E)&&1===E.length?D+"[]":D;if(a&&l(E)&&0===E.length)return L+"[]";for(var F=0;F<I.length;++F){var B=I[F],N="object"==typeof B&&B&&void 0!==B.value?B.value:E[B];if(!u||null!==N){var W=y&&d?String(B).replace(/\./g,"%2E"):String(B),U=l(E)?"function"==typeof s?s(L,W):L:L+(y?"."+W:"["+W+"]");T.set(e,M);var j=r();j.set(f,T),h(R,t(N,U,s,o,a,c,u,d,"comma"===s&&b&&l(E)?null:m,g,v,y,x,w,_,b,A,j))}}return R};t.exports=function(t,e){var n,i=t,c=function(t){if(!t)return p;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.encodeDotInKeys&&"boolean"!=typeof t.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||p.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=s.default;if(void 0!==t.format){if(!o.call(s.formatters,t.format))throw new TypeError("Unknown format option provided.");n=t.format}var r,i=s.formatters[n],c=p.filter;if(("function"==typeof t.filter||l(t.filter))&&(c=t.filter),r=t.arrayFormat in a?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":p.arrayFormat,"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=void 0===t.allowDots?!0===t.encodeDotInKeys||p.allowDots:!!t.allowDots;return{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:p.addQueryPrefix,allowDots:h,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:p.allowEmptyArrays,arrayFormat:r,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:p.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:void 0===t.delimiter?p.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:p.encode,encodeDotInKeys:"boolean"==typeof t.encodeDotInKeys?t.encodeDotInKeys:p.encodeDotInKeys,encoder:"function"==typeof t.encoder?t.encoder:p.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:p.encodeValuesOnly,filter:c,format:n,formatter:i,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:p.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:p.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:p.strictNullHandling}}(e);"function"==typeof c.filter?i=(0,c.filter)("",i):l(c.filter)&&(n=c.filter);var u=[];if("object"!=typeof i||null===i)return"";var d=a[c.arrayFormat],f="comma"===d&&c.commaRoundTrip;n||(n=Object.keys(i)),c.sort&&n.sort(c.sort);for(var g=r(),v=0;v<n.length;++v){var y=n[v],x=i[y];c.skipNulls&&null===x||h(u,m(x,y,d,f,c.allowEmptyArrays,c.strictNullHandling,c.skipNulls,c.encodeDotInKeys,c.encode?c.encoder:null,c.filter,c.sort,c.allowDots,c.serializeDate,c.format,c.formatter,c.encodeValuesOnly,c.charset,g))}var w=u.join(c.delimiter),_=!0===c.addQueryPrefix?"?":"";return c.charsetSentinel&&("iso-8859-1"===c.charset?_+="utf8=%26%2310003%3B&":_+="utf8=%E2%9C%93&"),w.length>0?_+w:""}},8648:function(t){"use strict";t.exports="undefined"!=typeof Reflect&&Reflect.getPrototypeOf||null},8686:function(t,e,n){"use strict";var r=n(3724),i=n(9039);t.exports=r&&i(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},8706:function(t,e,n){"use strict";var r=n(6518),i=n(9039),s=n(4376),o=n(34),a=n(8981),l=n(6198),c=n(6837),h=n(2278),u=n(1469),d=n(597),p=n(8227),f=n(9519),m=p("isConcatSpreadable"),g=f>=51||!i(function(){var t=[];return t[m]=!1,t.concat()[0]!==t}),v=function(t){if(!o(t))return!1;var e=t[m];return void 0!==e?!!e:s(t)};r({target:"Array",proto:!0,arity:1,forced:!g||!d("concat")},{concat:function(t){var e,n,r,i,s,o=a(this),d=u(o,0),p=0;for(e=-1,r=arguments.length;e<r;e++)if(v(s=-1===e?o:arguments[e]))for(i=l(s),c(p+i),n=0;n<i;n++,p++)n in s&&h(d,p,s[n]);else c(p+1),h(d,p++,s);return d.length=p,d}})},8727:function(t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:function(t,e,n){"use strict";var r=n(616),i=Function.prototype,s=i.apply,o=i.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?o.bind(s):function(){return o.apply(s,arguments)})},8773:function(t,e){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);e.f=i?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},8781:function(t,e,n){"use strict";var r=n(350).PROPER,i=n(6840),s=n(8551),o=n(655),a=n(9039),l=n(1034),c="toString",h=RegExp.prototype,u=h[c],d=a(function(){return"/a/b"!==u.call({source:"a",flags:"b"})}),p=r&&u.name!==c;(d||p)&&i(h,c,function(){var t=s(this);return"/"+o(t.source)+"/"+o(l(t))},{unsafe:!0})},8814:function(t,e,n){"use strict";var r=n(9039),i=n(4576).RegExp;t.exports=r(function(){var t=i("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})},8835:function(t,e,n){"use strict";var r=n(1270);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var s=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(l),h=["%","/","?",";","#"].concat(c),u=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=n(5373);function y(t,e,n){if(t&&"object"==typeof t&&t instanceof i)return t;var r=new i;return r.parse(t,e,n),r}i.prototype.parse=function(t,e,n){if("string"!=typeof t)throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),o=-1!==i&&i<t.indexOf("#")?"?":"#",l=t.split(o);l[0]=l[0].replace(/\\/g,"/");var y=t=l.join(o);if(y=y.trim(),!n&&1===t.split("#").length){var x=a.exec(y);if(x)return this.path=y,this.href=y,this.pathname=x[1],x[2]?(this.search=x[2],this.query=e?v.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var w=s.exec(y);if(w){var _=(w=w[0]).toLowerCase();this.protocol=_,y=y.substr(w.length)}if(n||w||y.match(/^\/\/[^@/]+@[^@/]+/)){var b="//"===y.substr(0,2);!b||w&&m[w]||(y=y.substr(2),this.slashes=!0)}if(!m[w]&&(b||w&&!g[w])){for(var A,T,S=-1,E=0;E<u.length;E++)-1!==(k=y.indexOf(u[E]))&&(-1===S||k<S)&&(S=k);for(-1!==(T=-1===S?y.lastIndexOf("@"):y.lastIndexOf("@",S))&&(A=y.slice(0,T),y=y.slice(T+1),this.auth=decodeURIComponent(A)),S=-1,E=0;E<h.length;E++){var k;-1!==(k=y.indexOf(h[E]))&&(-1===S||k<S)&&(S=k)}-1===S&&(S=y.length),this.host=y.slice(0,S),y=y.slice(S),this.parseHost(),this.hostname=this.hostname||"";var M="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!M)for(var C=this.hostname.split(/\./),P=(E=0,C.length);E<P;E++){var I=C[E];if(I&&!I.match(d)){for(var R="",O=0,D=I.length;O<D;O++)I.charCodeAt(O)>127?R+="x":R+=I[O];if(!R.match(d)){var L=C.slice(0,E),F=C.slice(E+1),B=I.match(p);B&&(L.push(B[1]),F.unshift(B[2])),F.length&&(y="/"+F.join(".")+y),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),M||(this.hostname=r.toASCII(this.hostname));var N=this.port?":"+this.port:"",W=this.hostname||"";this.host=W+N,this.href+=this.host,M&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y))}if(!f[_])for(E=0,P=c.length;E<P;E++){var U=c[E];if(-1!==y.indexOf(U)){var j=encodeURIComponent(U);j===U&&(j=escape(U)),y=y.split(U).join(j)}}var H=y.indexOf("#");-1!==H&&(this.hash=y.substr(H),y=y.slice(0,H));var z=y.indexOf("?");if(-1!==z?(this.search=y.substr(z),this.query=y.substr(z+1),e&&(this.query=v.parse(this.query)),y=y.slice(0,z)):e&&(this.search="",this.query={}),y&&(this.pathname=y),g[_]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){N=this.pathname||"";var G=this.search||"";this.path=N+G}return this.href=this.format(),this},i.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(s=v.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||g[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),e+i+(n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(o=o.replace("#","%23"))+r},i.prototype.resolve=function(t){return this.resolveObject(y(t,!1,!0)).format()},i.prototype.resolveObject=function(t){if("string"==typeof t){var e=new i;e.parse(t,!1,!0),t=e}for(var n=new i,r=Object.keys(this),s=0;s<r.length;s++){var o=r[s];n[o]=this[o]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),l=0;l<a.length;l++){var c=a[l];"protocol"!==c&&(n[c]=t[c])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.pathname="/",n.path=n.pathname),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!g[t.protocol]){for(var h=Object.keys(t),u=0;u<h.length;u++){var d=h[u];n[d]=t[d]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||m[t.protocol])n.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var f=n.pathname||"",v=n.search||"";n.path=f+v}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),x=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=x||y||n.host&&t.pathname,_=w,b=n.pathname&&n.pathname.split("/")||[],A=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(A&&(n.hostname="",n.port=null,n.host&&(""===b[0]?b[0]=n.host:b.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),w=w&&(""===p[0]||""===b[0])),x)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,b=p;else if(p.length)b||(b=[]),b.pop(),b=b.concat(p),n.search=t.search,n.query=t.query;else if(null!=t.search)return A&&(n.host=b.shift(),n.hostname=n.host,(M=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=M.shift(),n.hostname=M.shift(),n.host=n.hostname)),n.search=t.search,n.query=t.query,null===n.pathname&&null===n.search||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!b.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var T=b.slice(-1)[0],S=(n.host||t.host||b.length>1)&&("."===T||".."===T)||""===T,E=0,k=b.length;k>=0;k--)"."===(T=b[k])?b.splice(k,1):".."===T?(b.splice(k,1),E++):E&&(b.splice(k,1),E--);if(!w&&!_)for(;E--;E)b.unshift("..");!w||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),S&&"/"!==b.join("/").substr(-1)&&b.push("");var M,C=""===b[0]||b[0]&&"/"===b[0].charAt(0);return A&&(n.hostname=C?"":b.length?b.shift():"",n.host=n.hostname,(M=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=M.shift(),n.hostname=M.shift(),n.host=n.hostname)),(w=w||n.host&&b.length)&&!C&&b.unshift(""),b.length>0?n.pathname=b.join("/"):(n.pathname=null,n.path=null),null===n.pathname&&null===n.search||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var t=this.host,e=o.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)},e.qg=y,e.hd=function(t,e){return y(t,!1,!0).resolve(e)},e.GP=function(t){return"string"==typeof t&&(t=y(t)),t instanceof i?t.format():i.prototype.format.call(t)}},8859:function(t,e,n){var r="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,s=r&&i&&"function"==typeof i.get?i.get:null,o=r&&Map.prototype.forEach,a="function"==typeof Set&&Set.prototype,l=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,c=a&&l&&"function"==typeof l.get?l.get:null,h=a&&Set.prototype.forEach,u="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,d="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,p="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,f=Boolean.prototype.valueOf,m=Object.prototype.toString,g=Function.prototype.toString,v=String.prototype.match,y=String.prototype.slice,x=String.prototype.replace,w=String.prototype.toUpperCase,_=String.prototype.toLowerCase,b=RegExp.prototype.test,A=Array.prototype.concat,T=Array.prototype.join,S=Array.prototype.slice,E=Math.floor,k="function"==typeof BigInt?BigInt.prototype.valueOf:null,M=Object.getOwnPropertySymbols,C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,P="function"==typeof Symbol&&"object"==typeof Symbol.iterator,I="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,R=Object.prototype.propertyIsEnumerable,O=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function D(t,e){if(t===1/0||t===-1/0||t!=t||t&&t>-1e3&&t<1e3||b.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var r=t<0?-E(-t):E(t);if(r!==t){var i=String(r),s=y.call(e,i.length+1);return x.call(i,n,"$&_")+"."+x.call(x.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return x.call(e,n,"$&_")}var L=n(2634),F=L.custom,B=X(F)?F:null,N={__proto__:null,double:'"',single:"'"},W={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};function U(t,e,n){var r=n.quoteStyle||e,i=N[r];return i+t+i}function j(t){return x.call(String(t),/"/g,"&quot;")}function H(t){return!I||!("object"==typeof t&&(I in t||void 0!==t[I]))}function z(t){return"[object Array]"===$(t)&&H(t)}function G(t){return"[object RegExp]"===$(t)&&H(t)}function X(t){if(P)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return!0;if(!t||"object"!=typeof t||!C)return!1;try{return C.call(t),!0}catch(t){}return!1}t.exports=function t(e,r,i,a){var l=r||{};if(Y(l,"quoteStyle")&&!Y(N,l.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Y(l,"maxStringLength")&&("number"==typeof l.maxStringLength?l.maxStringLength<0&&l.maxStringLength!==1/0:null!==l.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var m=!Y(l,"customInspect")||l.customInspect;if("boolean"!=typeof m&&"symbol"!==m)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Y(l,"indent")&&null!==l.indent&&"\t"!==l.indent&&!(parseInt(l.indent,10)===l.indent&&l.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Y(l,"numericSeparator")&&"boolean"!=typeof l.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var w=l.numericSeparator;if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return K(e,l);if("number"==typeof e){if(0===e)return 1/0/e>0?"0":"-0";var b=String(e);return w?D(e,b):b}if("bigint"==typeof e){var E=String(e)+"n";return w?D(e,E):E}var M=void 0===l.depth?5:l.depth;if(void 0===i&&(i=0),i>=M&&M>0&&"object"==typeof e)return z(e)?"[Array]":"[Object]";var F,W=function(t,e){var n;if("\t"===t.indent)n="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;n=T.call(Array(t.indent+1)," ")}return{base:n,prev:T.call(Array(e+1),n)}}(l,i);if(void 0===a)a=[];else if(q(a,e)>=0)return"[Circular]";function V(e,n,r){if(n&&(a=S.call(a)).push(n),r){var s={depth:l.depth};return Y(l,"quoteStyle")&&(s.quoteStyle=l.quoteStyle),t(e,s,i+1,a)}return t(e,l,i+1,a)}if("function"==typeof e&&!G(e)){var Z=function(t){if(t.name)return t.name;var e=v.call(g.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}(e),rt=nt(e,V);return"[Function"+(Z?": "+Z:" (anonymous)")+"]"+(rt.length>0?" { "+T.call(rt,", ")+" }":"")}if(X(e)){var it=P?x.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):C.call(e);return"object"!=typeof e||P?it:Q(it)}if((F=e)&&"object"==typeof F&&("undefined"!=typeof HTMLElement&&F instanceof HTMLElement||"string"==typeof F.nodeName&&"function"==typeof F.getAttribute)){for(var st="<"+_.call(String(e.nodeName)),ot=e.attributes||[],at=0;at<ot.length;at++)st+=" "+ot[at].name+"="+U(j(ot[at].value),"double",l);return st+=">",e.childNodes&&e.childNodes.length&&(st+="..."),st+"</"+_.call(String(e.nodeName))+">"}if(z(e)){if(0===e.length)return"[]";var lt=nt(e,V);return W&&!function(t){for(var e=0;e<t.length;e++)if(q(t[e],"\n")>=0)return!1;return!0}(lt)?"["+et(lt,W)+"]":"[ "+T.call(lt,", ")+" ]"}if(function(t){return"[object Error]"===$(t)&&H(t)}(e)){var ct=nt(e,V);return"cause"in Error.prototype||!("cause"in e)||R.call(e,"cause")?0===ct.length?"["+String(e)+"]":"{ ["+String(e)+"] "+T.call(ct,", ")+" }":"{ ["+String(e)+"] "+T.call(A.call("[cause]: "+V(e.cause),ct),", ")+" }"}if("object"==typeof e&&m){if(B&&"function"==typeof e[B]&&L)return L(e,{depth:M-i});if("symbol"!==m&&"function"==typeof e.inspect)return e.inspect()}if(function(t){if(!s||!t||"object"!=typeof t)return!1;try{s.call(t);try{c.call(t)}catch(t){return!0}return t instanceof Map}catch(t){}return!1}(e)){var ht=[];return o&&o.call(e,function(t,n){ht.push(V(n,e,!0)+" => "+V(t,e))}),tt("Map",s.call(e),ht,W)}if(function(t){if(!c||!t||"object"!=typeof t)return!1;try{c.call(t);try{s.call(t)}catch(t){return!0}return t instanceof Set}catch(t){}return!1}(e)){var ut=[];return h&&h.call(e,function(t){ut.push(V(t,e))}),tt("Set",c.call(e),ut,W)}if(function(t){if(!u||!t||"object"!=typeof t)return!1;try{u.call(t,u);try{d.call(t,d)}catch(t){return!0}return t instanceof WeakMap}catch(t){}return!1}(e))return J("WeakMap");if(function(t){if(!d||!t||"object"!=typeof t)return!1;try{d.call(t,d);try{u.call(t,u)}catch(t){return!0}return t instanceof WeakSet}catch(t){}return!1}(e))return J("WeakSet");if(function(t){if(!p||!t||"object"!=typeof t)return!1;try{return p.call(t),!0}catch(t){}return!1}(e))return J("WeakRef");if(function(t){return"[object Number]"===$(t)&&H(t)}(e))return Q(V(Number(e)));if(function(t){if(!t||"object"!=typeof t||!k)return!1;try{return k.call(t),!0}catch(t){}return!1}(e))return Q(V(k.call(e)));if(function(t){return"[object Boolean]"===$(t)&&H(t)}(e))return Q(f.call(e));if(function(t){return"[object String]"===$(t)&&H(t)}(e))return Q(V(String(e)));if("undefined"!=typeof window&&e===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&e===globalThis||void 0!==n.g&&e===n.g)return"{ [object globalThis] }";if(!function(t){return"[object Date]"===$(t)&&H(t)}(e)&&!G(e)){var dt=nt(e,V),pt=O?O(e)===Object.prototype:e instanceof Object||e.constructor===Object,ft=e instanceof Object?"":"null prototype",mt=!pt&&I&&Object(e)===e&&I in e?y.call($(e),8,-1):ft?"Object":"",gt=(pt||"function"!=typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(mt||ft?"["+T.call(A.call([],mt||[],ft||[]),": ")+"] ":"");return 0===dt.length?gt+"{}":W?gt+"{"+et(dt,W)+"}":gt+"{ "+T.call(dt,", ")+" }"}return String(e)};var V=Object.prototype.hasOwnProperty||function(t){return t in this};function Y(t,e){return V.call(t,e)}function $(t){return m.call(t)}function q(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function K(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return K(y.call(t,0,e.maxStringLength),e)+r}var i=W[e.quoteStyle||"single"];return i.lastIndex=0,U(x.call(x.call(t,i,"\\$1"),/[\x00-\x1f]/g,Z),"single",e)}function Z(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+w.call(e.toString(16))}function Q(t){return"Object("+t+")"}function J(t){return t+" { ? }"}function tt(t,e,n,r){return t+" ("+e+") {"+(r?et(n,r):T.call(n,", "))+"}"}function et(t,e){if(0===t.length)return"";var n="\n"+e.prev+e.base;return n+T.call(t,","+n)+"\n"+e.prev}function nt(t,e){var n=z(t),r=[];if(n){r.length=t.length;for(var i=0;i<t.length;i++)r[i]=Y(t,i)?e(t[i],t):""}var s,o="function"==typeof M?M(t):[];if(P){s={};for(var a=0;a<o.length;a++)s["$"+o[a]]=o[a]}for(var l in t)Y(t,l)&&(n&&String(Number(l))===l&&l<t.length||P&&s["$"+l]instanceof Symbol||(b.call(/[^\w$]/,l)?r.push(e(l,t)+": "+e(t[l],t)):r.push(l+": "+e(t[l],t))));if("function"==typeof M)for(var c=0;c<o.length;c++)R.call(t,o[c])&&r.push("["+e(o[c])+"]: "+e(t[o[c]],t));return r}},8872:function(t,e,n){"use strict";n(8237)},8968:function(t){"use strict";t.exports=Math.floor},8981:function(t,e,n){"use strict";var r=n(7750),i=Object;t.exports=function(t){return i(r(t))}},8992:function(t,e,n){"use strict";n(8111)},9039:function(t){"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},9085:function(t,e,n){"use strict";var r=n(6518),i=n(4213);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==i},{assign:i})},9167:function(t,e,n){"use strict";var r=n(4576);t.exports=r},9213:function(t,e,n){"use strict";var r=n(6080),i=n(9504),s=n(7055),o=n(8981),a=n(6198),l=n(1469),c=i([].push),h=function(t){var e=1===t,n=2===t,i=3===t,h=4===t,u=6===t,d=7===t,p=5===t||u;return function(f,m,g,v){for(var y,x,w=o(f),_=s(w),b=a(_),A=r(m,g),T=0,S=v||l,E=e?S(f,b):n||d?S(f,0):void 0;b>T;T++)if((p||T in _)&&(x=A(y=_[T],T,w),t))if(e)E[T]=x;else if(x)switch(t){case 3:return!0;case 5:return y;case 6:return T;case 2:c(E,y)}else switch(t){case 4:return!1;case 7:c(E,y)}return u?-1:i||h?h:E}};t.exports={forEach:h(0),map:h(1),filter:h(2),some:h(3),every:h(4),find:h(5),findIndex:h(6),filterReject:h(7)}},9225:function(t,e,n){"use strict";var r,i,s,o,a=n(4576),l=n(8745),c=n(6080),h=n(4901),u=n(9297),d=n(9039),p=n(397),f=n(7680),m=n(4055),g=n(2812),v=n(9544),y=n(8574),x=a.setImmediate,w=a.clearImmediate,_=a.process,b=a.Dispatch,A=a.Function,T=a.MessageChannel,S=a.String,E=0,k={},M="onreadystatechange";d(function(){r=a.location});var C=function(t){if(u(k,t)){var e=k[t];delete k[t],e()}},P=function(t){return function(){C(t)}},I=function(t){C(t.data)},R=function(t){a.postMessage(S(t),r.protocol+"//"+r.host)};x&&w||(x=function(t){g(arguments.length,1);var e=h(t)?t:A(t),n=f(arguments,1);return k[++E]=function(){l(e,void 0,n)},i(E),E},w=function(t){delete k[t]},y?i=function(t){_.nextTick(P(t))}:b&&b.now?i=function(t){b.now(P(t))}:T&&!v?(o=(s=new T).port2,s.port1.onmessage=I,i=c(o.postMessage,o)):a.addEventListener&&h(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!d(R)?(i=R,a.addEventListener("message",I,!1)):i=M in m("script")?function(t){p.appendChild(m("script"))[M]=function(){p.removeChild(this),C(t)}}:function(t){setTimeout(P(t),0)}),t.exports={set:x,clear:w}},9228:function(t,e,n){"use strict";n(7495);var r=n(9565),i=n(6840),s=n(7323),o=n(9039),a=n(8227),l=n(6699),c=a("species"),h=RegExp.prototype;t.exports=function(t,e,n,u){var d=a(t),p=!o(function(){var e={};return e[d]=function(){return 7},7!==""[t](e)}),f=p&&!o(function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return e=!0,null},n[d](""),!e});if(!p||!f||n){var m=/./[d],g=e(d,""[t],function(t,e,n,i,o){var a=e.exec;return a===s||a===h.exec?p&&!o?{done:!0,value:r(m,e,n,i)}:{done:!0,value:r(t,n,e,i)}:{done:!1}});i(String.prototype,t,g[0]),i(h,d,g[1])}u&&l(h[d],"sham",!0)}},9290:function(t){"use strict";t.exports=RangeError},9296:function(t,e,n){"use strict";var r=n(4055)("span").classList,i=r&&r.constructor&&r.constructor.prototype;t.exports=i===Object.prototype?void 0:i},9297:function(t,e,n){"use strict";var r=n(9504),i=n(8981),s=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return s(i(t),e)}},9306:function(t,e,n){"use strict";var r=n(4901),i=n(6823),s=TypeError;t.exports=function(t){if(r(t))return t;throw new s(i(t)+" is not a function")}},9353:function(t){"use strict";var e=Object.prototype.toString,n=Math.max,r=function(t,e){for(var n=[],r=0;r<t.length;r+=1)n[r]=t[r];for(var i=0;i<e.length;i+=1)n[i+t.length]=e[i];return n};t.exports=function(t){var i=this;if("function"!=typeof i||"[object Function]"!==e.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var s,o=function(t){for(var e=[],n=1,r=0;n<t.length;n+=1,r+=1)e[r]=t[n];return e}(arguments),a=n(0,i.length-o.length),l=[],c=0;c<a;c++)l[c]="$"+c;if(s=Function("binder","return function ("+function(t){for(var e="",n=0;n<t.length;n+=1)e+=t[n],n+1<t.length&&(e+=",");return e}(l)+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof s){var e=i.apply(this,r(o,arguments));return Object(e)===e?e:this}return i.apply(t,r(o,arguments))}),i.prototype){var h=function(){};h.prototype=i.prototype,s.prototype=new h,h.prototype=null}return s}},9383:function(t){"use strict";t.exports=Error},9391:function(t,e,n){"use strict";var r=n(6518),i=n(6395),s=n(550),o=n(9039),a=n(7751),l=n(4901),c=n(2293),h=n(3438),u=n(6840),d=s&&s.prototype;if(r({target:"Promise",proto:!0,real:!0,forced:!!s&&o(function(){d.finally.call({then:function(){}},function(){})})},{finally:function(t){var e=c(this,a("Promise")),n=l(t);return this.then(n?function(n){return h(e,t()).then(function(){return n})}:t,n?function(n){return h(e,t()).then(function(){throw n})}:t)}}),!i&&l(s)){var p=a("Promise").prototype.finally;d.finally!==p&&u(d,"finally",p,{unsafe:!0})}},9432:function(t,e,n){"use strict";var r=n(6518),i=n(8981),s=n(1072);r({target:"Object",stat:!0,forced:n(9039)(function(){s(1)})},{keys:function(t){return s(i(t))}})},9433:function(t,e,n){"use strict";var r=n(4576),i=Object.defineProperty;t.exports=function(t,e){try{i(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},9462:function(t,e,n){"use strict";var r=n(9565),i=n(2360),s=n(6699),o=n(6279),a=n(8227),l=n(1181),c=n(5966),h=n(7657).IteratorPrototype,u=n(2529),d=n(9539),p=n(1385),f=a("toStringTag"),m="IteratorHelper",g="WrapForValidIterator",v="normal",y="throw",x=l.set,w=function(t){var e=l.getterFor(t?g:m);return o(i(h),{next:function(){var n=e(this);if(t)return n.nextHandler();if(n.done)return u(void 0,!0);try{var r=n.nextHandler();return n.returnHandlerResult?r:u(r,n.done)}catch(t){throw n.done=!0,t}},return:function(){var n=e(this),i=n.iterator;if(n.done=!0,t){var s=c(i,"return");return s?r(s,i):u(void 0,!0)}if(n.inner)try{d(n.inner.iterator,v)}catch(t){return d(i,y,t)}if(n.openIters)try{p(n.openIters,v)}catch(t){return d(i,y,t)}return i&&d(i,v),u(void 0,!0)}})},_=w(!0),b=w(!1);s(b,f,"Iterator Helper"),t.exports=function(t,e,n){var r=function(r,i){i?(i.iterator=r.iterator,i.next=r.next):i=r,i.type=e?g:m,i.returnHandlerResult=!!n,i.nextHandler=t,i.counter=0,i.done=!1,x(this,i)};return r.prototype=e?_:b,r}},9463:function(t,e,n){"use strict";var r=n(6518),i=n(3724),s=n(4576),o=n(9504),a=n(9297),l=n(4901),c=n(1625),h=n(655),u=n(2106),d=n(7740),p=s.Symbol,f=p&&p.prototype;if(i&&l(p)&&(!("description"in f)||void 0!==p().description)){var m={},g=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:h(arguments[0]),e=c(f,this)?new p(t):void 0===t?p():p(t);return""===t&&(m[e]=!0),e};d(g,p),g.prototype=f,f.constructor=g;var v="Symbol(description detection)"===String(p("description detection")),y=o(f.valueOf),x=o(f.toString),w=/^Symbol\((.*)\)[^)]+$/,_=o("".replace),b=o("".slice);u(f,"description",{configurable:!0,get:function(){var t=y(this);if(a(m,t))return"";var e=x(t),n=v?b(e,7,-1):_(e,w,"$1");return""===n?void 0:n}}),r({global:!0,constructor:!0,forced:!0},{Symbol:g})}},9479:function(t,e,n){"use strict";var r=n(3724),i=n(2106),s=n(5213),o=n(7979);r&&!s.correct&&(i(RegExp.prototype,"flags",{configurable:!0,get:o}),s.correct=!0)},9504:function(t,e,n){"use strict";var r=n(616),i=Function.prototype,s=i.call,o=r&&i.bind.bind(s,s);t.exports=r?o:function(t){return function(){return s.apply(t,arguments)}}},9519:function(t,e,n){"use strict";var r,i,s=n(4576),o=n(2839),a=s.process,l=s.Deno,c=a&&a.versions||l&&l.version,h=c&&c.v8;h&&(i=(r=h.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(i=+r[1]),t.exports=i},9538:function(t){"use strict";t.exports=ReferenceError},9539:function(t,e,n){"use strict";var r=n(9565),i=n(8551),s=n(5966);t.exports=function(t,e,n){var o,a;i(t);try{if(!(o=s(t,"return"))){if("throw"===e)throw n;return n}o=r(o,t)}catch(t){a=!0,o=t}if("throw"===e)throw n;if(a)throw o;return i(o),n}},9544:function(t,e,n){"use strict";var r=n(2839);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},9565:function(t,e,n){"use strict";var r=n(616),i=Function.prototype.call;t.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},9612:function(t){"use strict";t.exports=Object},9617:function(t,e,n){"use strict";var r=n(5397),i=n(5610),s=n(6198),o=function(t){return function(e,n,o){var a=r(e),l=s(a);if(0===l)return!t&&-1;var c,h=i(o,l);if(t&&n!=n){for(;l>h;)if((c=a[h++])!=c)return!0}else for(;l>h;h++)if((t||h in a)&&a[h]===n)return t||h||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},9675:function(t){"use strict";t.exports=TypeError},9773:function(t,e,n){"use strict";var r=n(6518),i=n(4495),s=n(9039),o=n(3717),a=n(8981);r({target:"Object",stat:!0,forced:!i||s(function(){o.f(1)})},{getOwnPropertySymbols:function(t){var e=o.f;return e?e(a(t)):[]}})},9868:function(t,e,n){"use strict";var r=n(6518),i=n(9504),s=n(1291),o=n(1240),a=n(2333),l=n(9039),c=RangeError,h=String,u=Math.floor,d=i(a),p=i("".slice),f=i(1.1.toFixed),m=function(t,e,n){return 0===e?n:e%2==1?m(t,e-1,n*t):m(t*t,e/2,n)},g=function(t,e,n){for(var r=-1,i=n;++r<6;)i+=e*t[r],t[r]=i%1e7,i=u(i/1e7)},v=function(t,e){for(var n=6,r=0;--n>=0;)r+=t[n],t[n]=u(r/e),r=r%e*1e7},y=function(t){for(var e=6,n="";--e>=0;)if(""!==n||0===e||0!==t[e]){var r=h(t[e]);n=""===n?r:n+d("0",7-r.length)+r}return n};r({target:"Number",proto:!0,forced:l(function(){return"0.000"!==f(8e-5,3)||"1"!==f(.9,0)||"1.25"!==f(1.255,2)||"1000000000000000128"!==f(0xde0b6b3a7640080,0)})||!l(function(){f({})})},{toFixed:function(t){var e,n,r,i,a=o(this),l=s(t),u=[0,0,0,0,0,0],f="",x="0";if(l<0||l>20)throw new c("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return h(a);if(a<0&&(f="-",a=-a),a>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(a*m(2,69,1))-69)<0?a*m(2,-e,1):a/m(2,e,1),n*=4503599627370496,(e=52-e)>0){for(g(u,0,n),r=l;r>=7;)g(u,1e7,0),r-=7;for(g(u,m(10,r,1),0),r=e-1;r>=23;)v(u,1<<23),r-=23;v(u,1<<r),g(u,1,1),v(u,2),x=y(u)}else g(u,0,n),g(u,1<<-e,0),x=y(u)+d("0",l);return l>0?f+((i=x.length)<=l?"0."+d("0",l-i)+x:p(x,0,i-l)+"."+p(x,i-l)):f+x}})},9957:function(t,e,n){"use strict";var r=Function.prototype.call,i=Object.prototype.hasOwnProperty,s=n(6743);t.exports=s.call(r,i)}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var s=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,{a:e}),e},r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},r.nc=void 0,function(){"use strict";r(8706);var e=r(5072),n=r.n(e),i=r(7825),s=r.n(i),o=r(7659),a=r.n(o),l=r(5056),c=r.n(l),h=r(540),u=r.n(h),d=r(1113),p=r.n(d),f=r(3919),m={};function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function y(t){var e=function(t){if("object"!=v(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(e)?e:e+""}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y(r.key),r)}}function w(t,e,n){return e&&x(t.prototype,e),n&&x(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _(t,e){if(e&&("object"==v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}function A(t,e){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},A(t,e)}function T(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A(t,e)}function S(t,e,n){return(e=y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}m.styleTagTransform=p(),m.setAttributes=c(),m.insert=a().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=u(),n()(f.A,m),f.A&&f.A.locals&&f.A.locals,r(825),r(6280),r(3792),r(6099),r(7764),r(3772),r(958),r(2953);var E=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(E||{}),k=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(k||{}),M=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(M||{}),C=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(C||{}),P=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(P||{}),I=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(I||{}),R=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(R||{}),O=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(O||{}),D=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(D||{}),L=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(L||{}),F=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(F||{}),B=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(B||{}),N=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(N||{}),W=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(W||{}),U=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(U||{}),j=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(j||{}),H=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(H||{}),z=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(z||{}),G=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(G||{});const X={createCanvas:(t,e)=>{const n=document.createElement("canvas");return n.width=t,n.height=e,n},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")},V={ADAPTER:X,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Y=/iPhone/i,$=/iPod/i,q=/iPad/i,K=/\biOS-universal(?:.+)Mac\b/i,Z=/\bAndroid(?:.+)Mobile\b/i,Q=/Android/i,J=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,tt=/Silk/i,et=/Windows Phone/i,nt=/\bWindows(?:.+)ARM\b/i,rt=/BlackBerry/i,it=/BB10/i,st=/Opera Mini/i,ot=/\b(CriOS|Chrome)(?:.+)Mobile/i,at=/Mobile(?:.+)Firefox\b/i,lt=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};function ct(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,r=n.split("[FBAN");void 0!==r[1]&&(n=r[0]),void 0!==(r=n.split("Twitter"))[1]&&(n=r[0]);var i=function(t){return function(e){return e.test(t)}}(n),s={apple:{phone:i(Y)&&!i(et),ipod:i($),tablet:!i(Y)&&(i(q)||lt(e))&&!i(et),universal:i(K),device:(i(Y)||i($)||i(q)||i(K)||lt(e))&&!i(et)},amazon:{phone:i(J),tablet:!i(J)&&i(tt),device:i(J)||i(tt)},android:{phone:!i(et)&&i(J)||!i(et)&&i(Z),tablet:!i(et)&&!i(J)&&!i(Z)&&(i(tt)||i(Q)),device:!i(et)&&(i(J)||i(tt)||i(Z)||i(Q))||i(/\bokhttp\b/i)},windows:{phone:i(et),tablet:i(nt),device:i(et)||i(nt)},other:{blackberry:i(rt),blackberry10:i(it),opera:i(st),firefox:i(at),chrome:i(ot),device:i(rt)||i(it)||i(st)||i(at)||i(ot)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const ht=(ct.default??ct)(globalThis.navigator);V.RETINA_PREFIX=/@([0-9\.]+)x/,V.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ut=r(228),dt=r(6570);r(8835);const pt={};function ft(t,e,n=3){if(pt[e])return;let r=(new Error).stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`):(r=r.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}\nDeprecated since v${t}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`),console.warn(r))),pt[e]=!0}function mt(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function gt(t){return t.split("?")[0].split("#")[0]}const vt={toPosix(t){return t.replace(new RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){mt(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const n=/^[^/:]+:\/{0,2}/.exec(t);return n?n[0]:""},toAbsolute(t,e,n){if(mt(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const r=gt(this.toPosix(e??V.ADAPTER.getBaseUrl())),i=gt(this.toPosix(n??this.rootname(r)));return(t=this.toPosix(t)).startsWith("/")?vt.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(r,t)},normalize(t){if(mt(t),0===t.length)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;let e="";const n=(t=this.toPosix(t)).startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const r=t.endsWith("/");return t=function(t){let e="",n=0,r=-1,i=0,s=-1;for(let o=0;o<=t.length;++o){if(o<t.length)s=t.charCodeAt(o);else{if(47===s)break;s=47}if(47===s){if(r!==o-1&&1!==i)if(r!==o-1&&2===i){if(e.length<2||2!==n||46!==e.charCodeAt(e.length-1)||46!==e.charCodeAt(e.length-2))if(e.length>2){const t=e.lastIndexOf("/");if(t!==e.length-1){-1===t?(e="",n=0):(e=e.slice(0,t),n=e.length-1-e.lastIndexOf("/")),r=o,i=0;continue}}else if(2===e.length||1===e.length){e="",n=0,r=o,i=0;continue}}else e.length>0?e+=`/${t.slice(r+1,o)}`:e=t.slice(r+1,o),n=o-r-1;r=o,i=0}else 46===s&&-1!==i?++i:i=-1}return e}(t),t.length>0&&r&&(t+="/"),n?`/${t}`:e+t},isAbsolute(t){return mt(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){if(0===t.length)return".";let e;for(let n=0;n<t.length;++n){const r=t[n];if(mt(r),r.length>0)if(void 0===e)e=r;else{const i=t[n-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${r}`:e+=`/${r}`}}return void 0===e?".":this.normalize(e)},dirname(t){if(mt(t),0===t.length)return".";let e=(t=this.toPosix(t)).charCodeAt(0);const n=47===e;let r=-1,i=!0;const s=this.getProtocol(t),o=t;for(let n=(t=t.slice(s.length)).length-1;n>=1;--n)if(e=t.charCodeAt(n),47===e){if(!i){r=n;break}}else i=!1;return-1===r?n?"/":this.isUrl(o)?s+t:s:n&&1===r?"//":s+t.slice(0,r)},rootname(t){mt(t);let e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const n=t.indexOf("/",e.length);e=-1!==n?t.slice(0,n):t,e.endsWith("/")||(e+="/")}return e},basename(t,e){mt(t),e&&mt(e),t=gt(this.toPosix(t));let n,r=0,i=-1,s=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(n=t.length-1;n>=0;--n){const l=t.charCodeAt(n);if(47===l){if(!s){r=n+1;break}}else-1===a&&(s=!1,a=n+1),o>=0&&(l===e.charCodeAt(o)?-1===--o&&(i=n):(o=-1,i=a))}return r===i?i=a:-1===i&&(i=t.length),t.slice(r,i)}for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!s){r=n+1;break}}else-1===i&&(s=!1,i=n+1);return-1===i?"":t.slice(r,i)},extname(t){mt(t);let e=-1,n=0,r=-1,i=!0,s=0;for(let o=(t=gt(this.toPosix(t))).length-1;o>=0;--o){const a=t.charCodeAt(o);if(47!==a)-1===r&&(i=!1,r=o+1),46===a?-1===e?e=o:1!==s&&(s=1):-1!==e&&(s=-1);else if(!i){n=o+1;break}}return-1===e||-1===r||0===s||1===s&&e===r-1&&e===n+1?"":t.slice(e,r)},parse(t){mt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;let n=(t=gt(this.toPosix(t))).charCodeAt(0);const r=this.isAbsolute(t);let i;e.root=this.rootname(t),i=r||this.hasProtocol(t)?1:0;let s=-1,o=0,a=-1,l=!0,c=t.length-1,h=0;for(;c>=i;--c)if(n=t.charCodeAt(c),47!==n)-1===a&&(l=!1,a=c+1),46===n?-1===s?s=c:1!==h&&(h=1):-1!==s&&(h=-1);else if(!l){o=c+1;break}return-1===s||-1===a||0===h||1===h&&s===a-1&&s===o+1?-1!==a&&(e.base=e.name=0===o&&r?t.slice(1,a):t.slice(o,a)):(0===o&&r?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let yt,xt;async function wt(){return yt??(yt=(async()=>{const t=document.createElement("canvas").getContext("webgl");if(!t)return N.UNPACK;const e=await new Promise(t=>{const e=document.createElement("video");e.onloadeddata=()=>t(e),e.onerror=()=>t(null),e.autoplay=!1,e.crossOrigin="anonymous",e.preload="auto",e.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",e.load()});if(!e)return N.UNPACK;const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(r),t.deleteTexture(n),t.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?N.PMA:N.UNPACK})()),yt}var _t={grad:.9,turn:360,rad:360/(2*Math.PI)},bt=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},At=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=Math.pow(10,e)),Math.round(n*t)/n+0},Tt=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),t>n?n:t>e?t:e},St=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},Et=function(t){return{r:Tt(t.r,0,255),g:Tt(t.g,0,255),b:Tt(t.b,0,255),a:Tt(t.a)}},kt=function(t){return{r:At(t.r),g:At(t.g),b:At(t.b),a:At(t.a,3)}},Mt=/^#([0-9a-f]{3,8})$/i,Ct=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Pt=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=Math.max(e,n,r),o=s-Math.min(e,n,r),a=o?s===e?(n-r)/o:s===n?2+(r-e)/o:4+(e-n)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},It=function(t){var e=t.h,n=t.s,r=t.v,i=t.a;e=e/360*6,n/=100,r/=100;var s=Math.floor(e),o=r*(1-n),a=r*(1-(e-s)*n),l=r*(1-(1-e+s)*n),c=s%6;return{r:255*[r,a,o,o,l,r][c],g:255*[l,r,r,a,o,o][c],b:255*[o,o,l,r,r,a][c],a:i}},Rt=function(t){return{h:St(t.h),s:Tt(t.s,0,100),l:Tt(t.l,0,100),a:Tt(t.a)}},Ot=function(t){return{h:At(t.h),s:At(t.s),l:At(t.l),a:At(t.a,3)}},Dt=function(t){return It((n=(e=t).s,{h:e.h,s:(n*=((r=e.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:e.a}));var e,n,r},Lt=function(t){return{h:(e=Pt(t)).h,s:(i=(200-(n=e.s))*(r=e.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,n,r,i},Ft=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Bt=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Nt=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Wt=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ut={string:[[function(t){var e=Mt.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?At(parseInt(t[3]+t[3],16)/255,2):1}:6===t.length||8===t.length?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8===t.length?At(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=Nt.exec(t)||Wt.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:Et({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:void 0===e[7]?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=Ft.exec(t)||Bt.exec(t);if(!e)return null;var n,r,i=Rt({h:(n=e[1],r=e[2],void 0===r&&(r="deg"),Number(n)*(_t[r]||1)),s:Number(e[3]),l:Number(e[4]),a:void 0===e[5]?1:Number(e[5])/(e[6]?100:1)});return Dt(i)},"hsl"]],object:[[function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=void 0===i?1:i;return bt(e)&&bt(n)&&bt(r)?Et({r:Number(e),g:Number(n),b:Number(r),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,n=t.s,r=t.l,i=t.a,s=void 0===i?1:i;if(!bt(e)||!bt(n)||!bt(r))return null;var o=Rt({h:Number(e),s:Number(n),l:Number(r),a:Number(s)});return Dt(o)},"hsl"],[function(t){var e=t.h,n=t.s,r=t.v,i=t.a,s=void 0===i?1:i;if(!bt(e)||!bt(n)||!bt(r))return null;var o=function(t){return{h:St(t.h),s:Tt(t.s,0,100),v:Tt(t.v,0,100),a:Tt(t.a)}}({h:Number(e),s:Number(n),v:Number(r),a:Number(s)});return It(o)},"hsv"]]},jt=function(t,e){for(var n=0;n<e.length;n++){var r=e[n][0](t);if(r)return[r,e[n][1]]}return[null,void 0]},Ht=function(t,e){var n=Lt(t);return{h:n.h,s:Tt(n.s+100*e,0,100),l:n.l,a:n.a}},zt=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Gt=function(t,e){var n=Lt(t);return{h:n.h,s:n.s,l:Tt(n.l+100*e,0,100),a:n.a}},Xt=function(){function t(t){this.parsed=function(t){return"string"==typeof t?jt(t.trim(),Ut.string):"object"==typeof t&&null!==t?jt(t,Ut.object):[null,void 0]}(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return null!==this.parsed},t.prototype.brightness=function(){return At(zt(this.rgba),2)},t.prototype.isDark=function(){return zt(this.rgba)<.5},t.prototype.isLight=function(){return zt(this.rgba)>=.5},t.prototype.toHex=function(){return e=(t=kt(this.rgba)).r,n=t.g,r=t.b,s=(i=t.a)<1?Ct(At(255*i)):"","#"+Ct(e)+Ct(n)+Ct(r)+s;var t,e,n,r,i,s},t.prototype.toRgb=function(){return kt(this.rgba)},t.prototype.toRgbString=function(){return e=(t=kt(this.rgba)).r,n=t.g,r=t.b,(i=t.a)<1?"rgba("+e+", "+n+", "+r+", "+i+")":"rgb("+e+", "+n+", "+r+")";var t,e,n,r,i},t.prototype.toHsl=function(){return Ot(Lt(this.rgba))},t.prototype.toHslString=function(){return e=(t=Ot(Lt(this.rgba))).h,n=t.s,r=t.l,(i=t.a)<1?"hsla("+e+", "+n+"%, "+r+"%, "+i+")":"hsl("+e+", "+n+"%, "+r+"%)";var t,e,n,r,i},t.prototype.toHsv=function(){return t=Pt(this.rgba),{h:At(t.h),s:At(t.s),v:At(t.v),a:At(t.a,3)};var t},t.prototype.invert=function(){return Vt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},t.prototype.saturate=function(t){return void 0===t&&(t=.1),Vt(Ht(this.rgba,t))},t.prototype.desaturate=function(t){return void 0===t&&(t=.1),Vt(Ht(this.rgba,-t))},t.prototype.grayscale=function(){return Vt(Ht(this.rgba,-1))},t.prototype.lighten=function(t){return void 0===t&&(t=.1),Vt(Gt(this.rgba,t))},t.prototype.darken=function(t){return void 0===t&&(t=.1),Vt(Gt(this.rgba,-t))},t.prototype.rotate=function(t){return void 0===t&&(t=15),this.hue(this.hue()+t)},t.prototype.alpha=function(t){return"number"==typeof t?Vt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):At(this.rgba.a,3);var e},t.prototype.hue=function(t){var e=Lt(this.rgba);return"number"==typeof t?Vt({h:t,s:e.s,l:e.l,a:e.a}):At(e.h)},t.prototype.isEqual=function(t){return this.toHex()===Vt(t).toHex()},t}(),Vt=function(t){return t instanceof Xt?t:new Xt(t)},Yt=[];!function(t){t.forEach(function(t){Yt.indexOf(t)<0&&(t(Xt,Ut),Yt.push(t))})}([function(t,e){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in n)r[n[i]]=i;var s={};t.prototype.toName=function(e){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var i,o,a=r[this.toHex()];if(a)return a;if(null==e?void 0:e.closest){var l=this.toRgb(),c=1/0,h="black";if(!s.length)for(var u in n)s[u]=new t(n[u]).toRgb();for(var d in n){var p=(i=l,o=s[d],Math.pow(i.r-o.r,2)+Math.pow(i.g-o.g,2)+Math.pow(i.b-o.b,2));p<c&&(c=p,h=d)}return h}},e.string.push([function(e){var r=e.toLowerCase(),i="transparent"===r?"#0000":n[r];return i?new t(i).toRgb():null},"name"])}]);const $t=class t{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(e){if(e instanceof t)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(null===e)throw new Error("Cannot set PIXI.Color#value to null");(null===this._value||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(t){return"string"==typeof t||"number"==typeof t||t instanceof Number||null===t?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):"object"==typeof t&&null!==t?{...t}:t}isSourceEqual(t,e){const n=typeof t;if(n!==typeof e)return!1;if("number"===n||"string"===n||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length===e.length&&t.every((t,n)=>t===e[n]);if(null!==t&&null!==e){const n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every(n=>t[n]===e[n])}return t===e}toRgba(){const[t,e,n,r]=this._components;return{r:t,g:e,b:n,a:r}}toRgb(){const[t,e,n]=this._components;return{r:t,g:e,b:n}}toRgbaString(){const[t,e,n]=this.toUint8RgbArray();return`rgba(${t},${e},${n},${this.alpha})`}toUint8RgbArray(t){const[e,n,r]=this._components;return(t=t??[])[0]=Math.round(255*e),t[1]=Math.round(255*n),t[2]=Math.round(255*r),t}toRgbArray(t){t=t??[];const[e,n,r]=this._components;return t[0]=e,t[1]=n,t[2]=r,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(e){const[n,r,i,s]=t.temp.setValue(e)._components;return this._components[0]*=n,this._components[1]*=r,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(1===t)return(255<<24)+this._int;if(0===t)return e?0:this._int;let n=this._int>>16&255,r=this._int>>8&255,i=255&this._int;return e&&(n=n*t+.5|0,r=r*t+.5|0,i=i*t+.5|0),(255*t<<24)+(n<<16)+(r<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,n,r]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(n*t)/t,this._components[2]=Math.round(r*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,n,r,i]=this._components;return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}normalize(e){let n,r,i,s;if(("number"==typeof e||e instanceof Number)&&e>=0&&e<=16777215)n=(e>>16&255)/255,r=(e>>8&255)/255,i=(255&e)/255,s=1;else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[n,r,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[n,r,i,s=255]=e,n/=255,r/=255,i/=255,s/=255;else if("string"==typeof e||"object"==typeof e){if("string"==typeof e){const n=t.HEX_PATTERN.exec(e);n&&(e=`#${n[2]}`)}const o=Vt(e);o.isValid()&&(({r:n,g:r,b:i,a:s}=o.rgba),n/=255,r/=255,i/=255)}if(void 0===n)throw new Error(`Unable to convert color ${e}`);this._components[0]=n,this._components[1]=r,this._components[2]=i,this._components[3]=s,this.refreshInt()}refreshInt(){this._clamp(this._components);const[t,e,n]=this._components;this._int=(255*t<<16)+(255*e<<8)+(255*n|0)}_clamp(t,e=0,n=1){return"number"==typeof t?Math.min(Math.max(t,e),n):(t.forEach((r,i)=>{t[i]=Math.min(Math.max(r,e),n)}),t)}};$t.shared=new $t,$t.temp=new $t,$t.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let qt=$t;function Kt(t,e=[]){return ft("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),qt.shared.setValue(t).toRgbArray(e)}function Zt(t){return ft("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),qt.shared.setValue(t).toNumber()}const Qt=function(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[C.NORMAL_NPM]=C.NORMAL,t[C.ADD_NPM]=C.ADD,t[C.SCREEN_NPM]=C.SCREEN,e[C.NORMAL]=C.NORMAL_NPM,e[C.ADD]=C.ADD_NPM,e[C.SCREEN]=C.SCREEN_NPM;const n=[];return n.push(e),n.push(t),n}();function Jt(t,e){return Qt[e?1:0][t]}function te(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}function ee(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,1+((t|=t>>>8)|t>>>16)}function ne(t){return!(t&t-1||!t)}function re(t){let e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,n=((t>>>=n)>15?1:0)<<2,e|=n,n=((t>>>=n)>3?1:0)<<1,e|=n,e|(t>>>=n)>>1}function ie(t,e,n){const r=t.length;let i;if(e>=r||0===n)return;const s=r-(n=e+n>r?r-e:n);for(i=e;i<s;++i)t[i]=t[i+n];t.length=s}function se(t){return 0===t?0:t<0?-1:1}Float32Array,Uint32Array,Int32Array,Uint8Array;let oe=0;function ae(){return++oe}const le=class{constructor(t,e,n,r){this.left=t,this.top=e,this.right=n,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};le.EMPTY=new le(0,0,0,0);let ce=le;const he={},ue=Object.create(null),de=Object.create(null);class pe{constructor(t,e,n){this._canvas=V.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||V.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function fe(t,e,n){for(let r=0,i=4*n*e;r<e;++r,i+=4)if(0!==t[i+3])return!1;return!0}function me(t,e,n,r,i){const s=4*e;for(let e=r,o=r*s+4*n;e<=i;++e,o+=s)if(0!==t[o+3])return!1;return!0}function ge(t,e=1){const n=V.RETINA_PREFIX?.exec(t);return n?parseFloat(n[1]):e}var ve=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(ve||{});const ye=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},xe=(t,e)=>ye(t).priority??e,we={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(ye).forEach(t=>{t.type.forEach(e=>this._removeHandlers[e]?.(t))}),this},add(...t){return t.map(ye).forEach(t=>{t.type.forEach(e=>{const n=this._addHandlers,r=this._queue;n[e]?n[e]?.(t):(r[e]=r[e]||[],r[e]?.push(t))})}),this},handle(t,e,n){const r=this._addHandlers,i=this._removeHandlers;if(r[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);r[t]=e,i[t]=n;const s=this._queue;return s[t]&&(s[t]?.forEach(t=>e(t)),delete s[t]),this},handleByMap(t,e){return this.handle(t,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByList(t,e,n=-1){return this.handle(t,t=>{e.includes(t.ref)||(e.push(t.ref),e.sort((t,e)=>xe(e,n)-xe(t,n)))},t=>{const n=e.indexOf(t.ref);-1!==n&&e.splice(n,1)})}};class _e{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const be=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Ae(t){let e="";for(let n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+=`if(test == ${n}.0){}`);return e}class Te{constructor(){this.data=0,this.blendMode=C.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(t){!!(1&this.data)!==t&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(t){!!(2&this.data)!==t&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(t){!!(4&this.data)!==t&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(t){!!(8&this.data)!==t&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(t){!!(32&this.data)!==t&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(t){!!(16&this.data)!==t&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==C.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new Te;return t.depthTest=!1,t.blend=!0,t}}Te.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Se=[];function Ee(t,e){if(!t)return null;let n="";if("string"==typeof t){const e=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);e&&(n=e[1].toLowerCase())}for(let r=Se.length-1;r>=0;--r){const i=Se[r];if(i.test&&i.test(t,n))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class ke{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,n,r,i,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:c}=this;this._aliasCount++;for(let h=0,u=c.length;h<u;h++)c[h][l](t,e,n,r,i,s,o,a);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(ke.prototype,{dispatch:{value:ke.prototype.emit},run:{value:ke.prototype.emit}});class Me{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ke("setRealSize"),this.onUpdate=new ke("update"),this.onError=new ke("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Ce extends Me{constructor(t,e){const{width:n,height:r}=e||{};if(!n||!r)throw new Error("BufferResource width or height invalid");super(n,r),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,n){const r=t.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,this.unpackAlignment),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===N.UNPACK);const i=e.realWidth,s=e.realHeight;return n.width===i&&n.height===s?r.texSubImage2D(e.target,0,0,0,i,s,e.format,n.type,this.data):(n.width=i,n.height=s,r.texImage2D(e.target,0,n.internalFormat,i,s,0,e.format,n.type,this.data)),!0}dispose(){this.data=null}static test(t){return null===t||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const Pe={scaleMode:L.NEAREST,alphaMode:N.NPM},Ie=class t extends ut{constructor(e=null,n=null){super(),n=Object.assign({},t.defaultOptions,n);const{alphaMode:r,mipmap:i,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:c,format:h,type:u,target:d,resolution:p,resourceOptions:f}=n;e&&!(e instanceof Me)&&((e=Ee(e,f)).internal=!0),this.resolution=p||V.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=c,this._scaleMode=o,this.format=h,this.type=u,this.target=d,this.alphaMode=r,this.uid=ae(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this}setSize(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n)}setRealSize(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=ne(this.realWidth)&&ne(this.realHeight)}setResolution(t){const e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete de[this.cacheId],delete ue[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,n,r=V.STRICT_TEXTURE_CACHE){const i="string"==typeof e;let s=null;if(i)s=e;else{if(!e._pixiId){const t=n?.pixiIdPrefix||"pixiid";e._pixiId=`${t}_${ae()}`}s=e._pixiId}let o=de[s];if(i&&r&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new t(e,n),o.cacheId=s,t.addToCache(o,s)),o}static fromBuffer(e,n,r,i){e=e||new Float32Array(n*r*4);const s=new Ce(e,{width:n,height:r,...i?.resourceOptions});let o,a;return e instanceof Float32Array?(o=I.RGBA,a=O.FLOAT):e instanceof Int32Array?(o=I.RGBA_INTEGER,a=O.INT):e instanceof Uint32Array?(o=I.RGBA_INTEGER,a=O.UNSIGNED_INT):e instanceof Int16Array?(o=I.RGBA_INTEGER,a=O.SHORT):e instanceof Uint16Array?(o=I.RGBA_INTEGER,a=O.UNSIGNED_SHORT):e instanceof Int8Array?(o=I.RGBA,a=O.BYTE):(o=I.RGBA,a=O.UNSIGNED_BYTE),s.internal=!0,new t(s,Object.assign({},Pe,{type:a,format:o},i))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),de[e]&&de[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),de[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=de[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete de[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete de[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};Ie.defaultOptions={mipmap:B.POW2,anisotropicLevel:0,scaleMode:L.LINEAR,wrapMode:F.CLAMP,alphaMode:N.UNPACK,target:R.TEXTURE_2D,format:I.RGBA,type:O.UNSIGNED_BYTE},Ie._globalBatch=0;let Re=Ie;class Oe{constructor(){this.texArray=null,this.blend=0,this.type=P.TRIANGLES,this.start=0,this.size=0,this.data=null}}let De=0;class Le{constructor(t,e=!0,n=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=De++,this.disposeRunner=new ke("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?G.ELEMENT_ARRAY_BUFFER:G.ARRAY_BUFFER}get index(){return this.type===G.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Le(t)}}class Fe{constructor(t,e=0,n=!1,r=O.FLOAT,i,s,o,a=1){this.buffer=t,this.size=e,this.normalized=n,this.type=r,this.stride=i,this.start=s,this.instance=o,this.divisor=a}destroy(){this.buffer=null}static from(t,e,n,r,i){return new Fe(t,e,n,r,i)}}const Be={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array},Ne={5126:4,5123:2,5121:1};let We=0;const Ue={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};class je{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=We++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ke("disposeGeometry"),this.refCount=0}addAttribute(t,e,n=0,r=!1,i,s,o,a=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Le||(e instanceof Array&&(e=new Float32Array(e)),e=new Le(e));const l=t.split("|");if(l.length>1){for(let t=0;t<l.length;t++)this.addAttribute(l[t],e,n,r,i);return this}let c=this.buffers.indexOf(e);return-1===c&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Fe(c,n,r,i,s,o,a),this.instanced=this.instanced||a,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Le||(t instanceof Array&&(t=new Uint16Array(t)),t=new Le(t)),t.type=G.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const t=[],e=[],n=new Le;let r;for(r in this.attributes){const n=this.attributes[r],i=this.buffers[n.buffer];t.push(i.data),e.push(n.size*Ne[n.type]/4),n.buffer=0}for(n.data=function(t,e){let n=0,r=0;const i={};for(let i=0;i<t.length;i++)r+=e[i],n+=t[i].length;const s=new ArrayBuffer(4*n);let o=null,a=0;for(let n=0;n<t.length;n++){const l=e[n],c=t[n],h=te(c);i[h]||(i[h]=new Be[h](s)),o=i[h];for(let t=0;t<c.length;t++)o[(t/l|0)*r+a+t%l]=c[t];a+=l}return new Float32Array(s)}(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new je;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Le(this.buffers[e].data.slice(0));for(const e in this.attributes){const n=this.attributes[e];t.attributes[e]=new Fe(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=G.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new je,n=[],r=[],i=[];let s;for(let e=0;e<t.length;e++){s=t[e];for(let t=0;t<s.buffers.length;t++)r[t]=r[t]||0,r[t]+=s.buffers[t].data.length,i[t]=0}for(let t=0;t<s.buffers.length;t++)n[t]=new(Ue[te(s.buffers[t].data)])(r[t]),e.buffers[t]=new Le(n[t]);for(let e=0;e<t.length;e++){s=t[e];for(let t=0;t<s.buffers.length;t++)n[t].set(s.buffers[t].data,i[t]),i[t]+=s.buffers[t].data.length}if(e.attributes=s.attributes,s.indexBuffer){e.indexBuffer=e.buffers[s.buffers.indexOf(s.indexBuffer)],e.indexBuffer.type=G.ELEMENT_ARRAY_BUFFER;let n=0,r=0,i=0,o=0;for(let t=0;t<s.buffers.length;t++)if(s.buffers[t]!==s.indexBuffer){o=t;break}for(const t in s.attributes){const e=s.attributes[t];(0|e.buffer)===o&&(r+=e.size*Ne[e.type]/4)}for(let s=0;s<t.length;s++){const a=t[s].indexBuffer.data;for(let t=0;t<a.length;t++)e.indexBuffer.data[t+i]+=n;n+=t[s].buffers[o].data.length/r,i+=a.length}}return e}}class He extends je{constructor(t=!1){super(),this._buffer=new Le(null,t,!1),this._indexBuffer=new Le(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,O.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,O.FLOAT).addAttribute("aColor",this._buffer,4,!0,O.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,O.FLOAT).addIndex(this._indexBuffer)}}const ze=2*Math.PI,Ge=180/Math.PI,Xe=Math.PI/180;var Ve=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(Ve||{});class Ye{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Ye(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}Ye.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const $e=[new Ye,new Ye,new Ye,new Ye];class qe{constructor(t=0,e=0,n=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(r),this.type=Ve.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new qe(0,0,0,0)}clone(){return new qe(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const e=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=e)return!1;const n=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>n}const n=this.left,r=this.right,i=this.top,s=this.bottom;if(r<=n||s<=i)return!1;const o=$e[0].set(t.left,t.top),a=$e[1].set(t.left,t.bottom),l=$e[2].set(t.right,t.top),c=$e[3].set(t.right,t.bottom);if(l.x<=o.x||a.y<=o.y)return!1;const h=Math.sign(e.a*e.d-e.b*e.c);if(0===h||(e.apply(o,o),e.apply(a,a),e.apply(l,l),e.apply(c,c),Math.max(o.x,a.x,l.x,c.x)<=n||Math.min(o.x,a.x,l.x,c.x)>=r||Math.max(o.y,a.y,l.y,c.y)<=i||Math.min(o.y,a.y,l.y,c.y)>=s))return!1;const u=h*(a.y-o.y),d=h*(o.x-a.x),p=u*n+d*i,f=u*r+d*i,m=u*n+d*s,g=u*r+d*s;if(Math.max(p,f,m,g)<=u*o.x+d*o.y||Math.min(p,f,m,g)>=u*c.x+d*c.y)return!1;const v=h*(o.y-l.y),y=h*(l.x-o.x),x=v*n+y*i,w=v*r+y*i,_=v*n+y*s,b=v*r+y*s;return!(Math.max(x,w,_,b)<=v*o.x+y*o.y||Math.min(x,w,_,b)>=v*c.x+y*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this}fit(t){const e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=r,this.height=Math.max(i-r,0),this}ceil(t=1,e=.001){const n=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=r,this.height=i-r,this}}qe.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Ke{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.radius=n,this.type=Ve.CIRC}clone(){return new Ke(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let r=this.x-t,i=this.y-e;return r*=r,i*=i,r+i<=n}getBounds(){return new qe(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}Ke.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Ze{constructor(t=0,e=0,n=0,r=0){this.x=t,this.y=e,this.width=n,this.height=r,this.type=Ve.ELIP}clone(){return new Ze(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let n=(t-this.x)/this.width,r=(e-this.y)/this.height;return n*=n,r*=r,n+r<=1}getBounds(){return new qe(this.x-this.width,this.y-this.height,this.width,this.height)}}Ze.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Qe{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if("number"!=typeof e[0]){const t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n].x,e[n].y);e=t}this.points=e,this.type=Ve.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Qe(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let n=!1;const r=this.points.length/2;for(let i=0,s=r-1;i<r;s=i++){const r=this.points[2*i],o=this.points[2*i+1],a=this.points[2*s],l=this.points[2*s+1];o>e!=l>e&&t<(e-o)/(l-o)*(a-r)+r&&(n=!n)}return n}}Qe.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`};class Je{constructor(t=0,e=0,n=0,r=0,i=20){this.x=t,this.y=e,this.width=n,this.height=r,this.radius=i,this.type=Ve.RREC}clone(){return new Je(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let r=t-(this.x+n),i=e-(this.y+n);const s=n*n;if(r*r+i*i<=s||(r=t-(this.x+this.width-n),r*r+i*i<=s)||(i=e-(this.y+this.height-n),r*r+i*i<=s)||(r=t-(this.x+n),r*r+i*i<=s))return!0}return!1}}Je.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class tn{constructor(t=1,e=0,n=0,r=1,i=0,s=0){this.array=null,this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=s}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,n,r,i,s){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=s,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(t,e){e=e||new Ye;const n=t.x,r=t.y;return e.x=this.a*n+this.c*r+this.tx,e.y=this.b*n+this.d*r+this.ty,e}applyInverse(t,e){e=e||new Ye;const n=1/(this.a*this.d+this.c*-this.b),r=t.x,i=t.y;return e.x=this.d*n*r+-this.c*n*i+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*i+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.a,i=this.c,s=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=s*e-this.ty*n,this.ty=s*n+this.ty*e,this}append(t){const e=this.a,n=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this}setTransform(t,e,n,r,i,s,o,a,l){return this.a=Math.cos(o+l)*i,this.b=Math.sin(o+l)*i,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(n*this.a+r*this.c),this.ty=e-(n*this.b+r*this.d),this}prepend(t){const e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const e=this.a,n=this.c;this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,n=this.b,r=this.c,i=this.d,s=t.pivot,o=-Math.atan2(-r,i),a=Math.atan2(n,e),l=Math.abs(o+a);return l<1e-5||Math.abs(ze-l)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=a),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(r*r+i*i),t.position.x=this.tx+(s.x*e+s.y*r),t.position.y=this.ty+(s.x*n+s.y*i),t}invert(){const t=this.a,e=this.b,n=this.c,r=this.d,i=this.tx,s=t*r-e*n;return this.a=r/s,this.b=-e/s,this.c=-n/s,this.d=t/s,this.tx=(n*this.ty-r*i)/s,this.ty=-(t*this.ty-e*i)/s,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new tn;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new tn}static get TEMP_MATRIX(){return new tn}}tn.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const en=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],nn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],rn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],sn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],on=[],an=[],ln=Math.sign;!function(){for(let t=0;t<16;t++){const e=[];on.push(e);for(let n=0;n<16;n++){const r=ln(en[t]*en[n]+rn[t]*nn[n]),i=ln(nn[t]*en[n]+sn[t]*nn[n]),s=ln(en[t]*rn[n]+rn[t]*sn[n]),o=ln(nn[t]*rn[n]+sn[t]*sn[n]);for(let t=0;t<16;t++)if(en[t]===r&&nn[t]===i&&rn[t]===s&&sn[t]===o){e.push(t);break}}}for(let t=0;t<16;t++){const e=new tn;e.set(en[t],nn[t],rn[t],sn[t],0,0),an.push(e)}}();const cn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>en[t],uY:t=>nn[t],vX:t=>rn[t],vY:t=>sn[t],inv:t=>8&t?15&t:7&-t,add:(t,e)=>on[t][e],sub:(t,e)=>on[t][cn.inv(e)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,e)=>2*Math.abs(t)<=Math.abs(e)?e>=0?cn.S:cn.N:2*Math.abs(e)<=Math.abs(t)?t>0?cn.E:cn.W:e>0?t>0?cn.SE:cn.SW:t>0?cn.NE:cn.NW,matrixAppendRotationInv:(t,e,n=0,r=0)=>{const i=an[cn.inv(e)];i.tx=n,i.ty=r,t.append(i)}};class hn{constructor(t,e,n=0,r=0){this._x=n,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new hn(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}hn.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const un=class{constructor(){this.worldTransform=new tn,this.localTransform=new tn,this.position=new hn(this.onChange,this,0,0),this.scale=new hn(this.onChange,this,1,1),this.pivot=new hn(this.onChange,this,0,0),this.skew=new hn(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const n=t.worldTransform,r=this.worldTransform;r.a=e.a*n.a+e.b*n.c,r.b=e.a*n.b+e.b*n.d,r.c=e.c*n.a+e.d*n.c,r.d=e.c*n.b+e.d*n.d,r.tx=e.tx*n.a+e.ty*n.c+n.tx,r.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};un.IDENTITY=new un;let dn=un;dn.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};const pn=[{test:t=>"float"===t.type&&1===t.size&&!t.isArray,code:t=>`\n            if(uv["${t}"] !== ud["${t}"].value)\n            {\n                ud["${t}"].value = uv["${t}"]\n                gl.uniform1f(ud["${t}"].location, uv["${t}"])\n            }\n            `},{test:(t,e)=>!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=e&&void 0===e.castToBaseTexture),code:t=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${t}"], t);\n\n            if(ud["${t}"].value !== t)\n            {\n                ud["${t}"].value = t;\n                gl.uniform1i(ud["${t}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(t,e)=>"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a,code:t=>`\n            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));\n            `,codeUbo:t=>`\n                var ${t}_matrix = uv.${t}.toArray(true);\n\n                data[offset] = ${t}_matrix[0];\n                data[offset+1] = ${t}_matrix[1];\n                data[offset+2] = ${t}_matrix[2];\n        \n                data[offset + 4] = ${t}_matrix[3];\n                data[offset + 5] = ${t}_matrix[4];\n                data[offset + 6] = ${t}_matrix[5];\n        \n                data[offset + 8] = ${t}_matrix[6];\n                data[offset + 9] = ${t}_matrix[7];\n                data[offset + 10] = ${t}_matrix[8];\n            `},{test:(t,e)=>"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${t}"].location, v.x, v.y);\n                }`,codeUbo:t=>`\n                v = uv.${t};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:t=>"vec2"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);\n                }\n            `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                `},{test:(t,e)=>"vec3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                `},{test:t=>"vec4"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])\n                }`}],fn={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},mn={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},gn={};let vn,yn=gn;const xn={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function wn(t){return xn[t]}let _n=null;const bn={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function An(t,e){if(!_n){const e=Object.keys(bn);_n={};for(let n=0;n<e.length;++n){const r=e[n];_n[t[r]]=bn[r]}}return _n[e]}function Tn(t,e,n){if("precision"!==t.substring(0,9)){let r=e;return e===j.HIGH&&n!==j.HIGH&&(r=j.MEDIUM),`precision ${r} float;\n${t}`}return n!==j.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}let Sn=0;const En={},kn=class t{constructor(e,n,r="pixi-shader",i={}){this.extra={},this.id=Sn++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),En[r]?(En[r]++,r+=`-${En[r]}`):En[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}\n${this.fragmentSrc}`,this.vertexSrc=Tn(this.vertexSrc,t.defaultVertexPrecision,j.HIGH),this.fragmentSrc=Tn(this.fragmentSrc,t.defaultFragmentPrecision,function(){if(!vn){vn=j.MEDIUM;const t=function(){if(yn===gn||yn?.isContextLost()){const t=V.ADAPTER.createCanvas();let e;V.PREFER_ENV>=E.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),yn=e}return yn}();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(vn=e.precision?j.HIGH:j.MEDIUM)}}return vn}())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}static from(e,n,r){const i=e+n;let s=he[i];return s||(he[i]=s=new t(e,n,r)),s}};kn.defaultVertexPrecision=j.HIGH,kn.defaultFragmentPrecision=ht.apple.device?j.HIGH:j.MEDIUM;let Mn=kn,Cn=0;class Pn{constructor(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Cn++,this.static=!!e,this.ubo=!!n,t instanceof Le?(this.buffer=t,this.buffer.type=G.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Le(new Float32Array(1)),this.buffer.type=G.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,n){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[t]=new Pn(e,n)}static from(t,e,n){return new Pn(t,e,n)}static uboFrom(t,e){return new Pn(t,e??!0,!0)}}class In{constructor(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof Pn?e:new Pn(e):new Pn({}),this.disposeRunner=new ke("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const n in e.uniforms){const r=e.uniforms[n];if(!0===r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,n){const r=Mn.from(t,e);return new In(r,n)}}class Rn{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const e=new Int32Array(t);for(let n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=Pn.from({uSamplers:e},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Mn(this.vertexSrc,n)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new tn,default:this.defaultGroupCache[t]};return new In(this.programCache[t],e)}generateSampleSrc(t){let e="";e+="\n",e+="\n";for(let n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+=`if(vTextureId < ${n}.5)`),e+="\n{",e+=`\n\tcolor = texture2D(uSamplers[${n}], vTextureCoord);`,e+="\n}";return e+="\n",e+="\n",e}}class On{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}class Dn{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}const Ln=class t extends Dn{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=He,this.vertexSize=6,this.state=Te.for2d(),this.size=4*t.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??function(){let t=!0;const e=V.ADAPTER.getNavigator();if(ht.tablet||ht.phone){if(ht.apple.device){const n=e.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(t=!1)}if(ht.android.device){const n=e.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(t=!1)}}return t?32:4}(),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??!ht.apple.device,this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return ft("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}static get defaultFragmentTemplate(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}setShaderGenerator({vertex:e=t.defaultVertexSrc,fragment:n=t.defaultFragmentTemplate}={}){this.shaderGenerator=new Rn(e,n)}contextChange(){const e=this.renderer.gl;V.PREFER_ENV===E.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),t.defaultMaxTextures),this.maxTextures=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const n=e.createShader(e.FRAGMENT_SHADER);for(;;){const r=be.replace(/%forloop%/gi,Ae(t));if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:n}=t,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new Oe);for(;n.length<i;)n.push(new On);for(let t=0;t<this.maxTextures;t++)this._tempBoundTextures[t]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:n}=this,r=t._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++Re._globalBatch,l=0,c=r[0],h=0;i.copyBoundTextures(s,n);for(let t=0;t<this._bufferSize;++t){const u=e[t];e[t]=null,u._batchEnabled!==a&&(c.count>=n&&(i.boundArray(c,s,a,n),this.buildDrawCalls(c,h,t),h=t,c=r[++l],++a),u._batchEnabled=a,u.touched=o,c.elements[c.count++]=u)}c.count>0&&(i.boundArray(c,s,a,n),this.buildDrawCalls(c,h,this._bufferSize),++l,++a);for(let t=0;t<s.length;t++)s[t]=null;Re._globalBatch=a}buildDrawCalls(e,n,r){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=t._drawCallPool;let c=this._dcIndex,h=this._aIndex,u=this._iIndex,d=l[c];d.start=this._iIndex,d.texArray=e;for(let t=n;t<r;++t){const r=i[t],p=r._texture.baseTexture,f=Qt[p.alphaMode?1:0][r.blendMode];i[t]=null,n<t&&d.blend!==f&&(d.size=u-d.start,n=t,d=l[++c],d.texArray=e,d.start=u),this.packInterleavedGeometry(r,s,o,h,u),h+=r.vertexData.length/2*a,u+=r.indices.length,d.blend=f}n<r&&(d.size=u-d.start,++c),this._dcIndex=c,this._aIndex=h,this._iIndex=u}bindAndClearTexArray(t){const e=this.renderer.texture;for(let n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:n,_indexBuffer:r}=this;t.canUploadSameBuffer?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:n,state:r}=this.renderer,i=t._drawCallPool;let s=null;for(let t=0;t<e;t++){const{texArray:e,type:o,size:a,start:l,blend:c}=i[t];s!==e&&(s=e,this.bindAndClearTexArray(e)),this.state.blendMode=c,r.set(this.state),n.drawElements(o,a,n.UNSIGNED_SHORT,2*l)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),t.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=ee(Math.ceil(t/8)),n=re(e),r=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new _e(r*this.vertexSize*4)),i}getIndexBuffer(t){const e=ee(Math.ceil(t/12)),n=re(e),r=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._iBuffers[n];return i||(this._iBuffers[n]=i=new Uint16Array(r)),i}packInterleavedGeometry(t,e,n,r,i){const{uint32View:s,float32View:o}=e,a=r/this.vertexSize,l=t.uvs,c=t.indices,h=t.vertexData,u=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=qt.shared.setValue(t._tintRGB).toPremultiplied(d,t._texture.baseTexture.alphaMode>0);for(let t=0;t<h.length;t+=2)o[r++]=h[t],o[r++]=h[t+1],o[r++]=l[t],o[r++]=l[t+1],s[r++]=p,o[r++]=u;for(let t=0;t<c.length;t++)n[i++]=a+c[t]}};Ln.defaultBatchSize=4096,Ln.extension={name:"batch",type:ve.RendererPlugin},Ln._drawCallPool=[],Ln._textureArrayPool=[];let Fn=Ln;we.add(Fn);const Bn=class t extends In{constructor(e,n,r){super(Mn.from(e||t.defaultVertexSrc,n||t.defaultFragmentSrc),r),this.padding=0,this.resolution=t.defaultResolution,this.multisample=t.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Te}apply(t,e,n,r,i){t.applyFilter(this,e,n,r)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}};Bn.defaultResolution=1,Bn.defaultMultisample=z.NONE;let Nn=Bn;class Wn{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new qt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:n,backgroundAlpha:r}=t,i=n??e;void 0!==i&&(this.color=i),this.alpha=r}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Wn.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Wn.extension={type:[ve.RendererSystem,ve.CanvasRendererSystem],name:"background"},we.add(Wn);class Un{constructor(t){this.renderer=t,this.emptyRenderer=new Dn(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:n}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=n[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,n,r){const{elements:i,ids:s,count:o}=t;let a=0;for(let t=0;t<o;t++){const o=i[t],l=o._batchLocation;if(l>=0&&l<r&&e[l]===o)s[t]=l;else for(;a<r;){const r=e[a];if(!r||r._batchEnabled!==n||r._batchLocation!==a){s[t]=a,o._batchLocation=a,e[a]=o;break}a++}}}destroy(){this.renderer=null}}Un.extension={type:ve.RendererSystem,name:"batch"},we.add(Un);let jn=0;class Hn{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=jn++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,n=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:n,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=jn++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;void 0!==e.addEventListener&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let n;if(V.PREFER_ENV>=E.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc"),bptc:t.getExtension("EXT_texture_compression_bptc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,void 0!==t.removeEventListener&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Hn.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Hn.extension={type:ve.RendererSystem,name:"context"},we.add(Hn);class zn{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ke("disposeFramebuffer"),this.multisample=z.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new Re(null,{scaleMode:L.NEAREST,resolution:1,mipmap:B.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new Re(null,{scaleMode:L.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:B.OFF,format:I.DEPTH_COMPONENT,type:O.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const r=this.colorTextures[n],i=r.resolution;r.setSize(t/i,e/i)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Gn extends Re{constructor(t={}){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=z.NONE),super(null,t),this.mipmap=B.OFF,this.valid=!0,this._clear=new qt([0,0,0,0]),this.framebuffer=new zn(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Xn extends Me{constructor(t){const e=t;super(e.naturalWidth||e.videoWidth||e.displayWidth||e.width,e.naturalHeight||e.videoHeight||e.displayHeight||e.height),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,n){void 0!==n||e.startsWith("data:")?!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous"):t.crossOrigin=function(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const n=new URL(t,document.baseURI);return n.hostname!==e.hostname||n.port!==e.port||n.protocol!==e.protocol?"anonymous":""}(e)}upload(t,e,n,r){const i=t.gl,s=e.realWidth,o=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||0===r.naturalWidth)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===N.UNPACK),this.noSubImage||e.target!==i.TEXTURE_2D||n.width!==s||n.height!==o?(n.width=s,n.height=o,i.texImage2D(e.target,0,n.internalFormat,e.format,n.type,r)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,e.format,n.type,r),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(e,n),super.update()}dispose(){this.source=null}}class Vn extends Xn{constructor(t,e){if(e=e||{},"string"==typeof t){const n=new Image;Xn.crossOrigin(n,t,e.crossorigin),n.src=t,t=n}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??V.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}load(t){return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((t,e)=>{const n=this.source;this.url=n.src;const r=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.update(),this._load=null,this.createBitmap?t(this.process()):t(this))};n.complete&&n.src?r():(n.onload=r,n.onerror=t=>{e(t),this.onError.emit(t)})})),this._load}process(){const t=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,n=!t.crossOrigin||"anonymous"===t.crossOrigin;return this._process=fetch(t.src,{mode:n?"cors":"no-cors"}).then(t=>t.blob()).then(n=>e(n,0,0,t.width,t.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===N.UNPACK?"premultiply":"none"})).then(t=>this.destroyed?Promise.reject():(this.bitmap=t,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,n){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,n,this.bitmap),!this.preserveBitmap){let t=!0;const r=e._glTextures;for(const i in r){const s=r[i];if(s!==n&&s.dirtyId!==e.dirtyId){t=!1;break}}t&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&("string"==typeof t||t instanceof HTMLImageElement)}}class Yn{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,n){const r=e.width,i=e.height;if(n){const e=t.width/2/r,s=t.height/2/i,o=t.x/r+e,a=t.y/i+s;n=cn.add(n,cn.NW),this.x0=o+e*cn.uX(n),this.y0=a+s*cn.uY(n),n=cn.add(n,2),this.x1=o+e*cn.uX(n),this.y1=a+s*cn.uY(n),n=cn.add(n,2),this.x2=o+e*cn.uX(n),this.y2=a+s*cn.uY(n),n=cn.add(n,2),this.x3=o+e*cn.uX(n),this.y3=a+s*cn.uY(n)}else this.x0=t.x/r,this.y0=t.y/i,this.x1=(t.x+t.width)/r,this.y1=t.y/i,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/i,this.x3=t.x/r,this.y3=(t.y+t.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Yn.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const $n=new Yn;function qn(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class Kn extends ut{constructor(t,e,n,r,i,s,o){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new qe(0,0,1,1)),t instanceof Kn&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.destroyed=!1,this._uvs=$n,this.uvMatrix=null,this.orig=n||e,this._rotate=Number(i||0),!0===i)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new Ye(s.x,s.y):new Ye(0,0),this.defaultBorders=o,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:t}=this.baseTexture;t?.url&&ue[t.url]&&Kn.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Kn.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),n=new Kn(this.baseTexture,!this.noFrame&&t,e,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=t),n}updateUvs(){this._uvs===$n&&(this._uvs=new Yn),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},n=V.STRICT_TEXTURE_CACHE){const r="string"==typeof t;let i=null;if(r)i=t;else if(t instanceof Re){if(!t.cacheId){const n=e?.pixiIdPrefix||"pixiid";t.cacheId=`${n}-${ae()}`,Re.addToCache(t,t.cacheId)}i=t.cacheId}else{if(!t._pixiId){const n=e?.pixiIdPrefix||"pixiid";t._pixiId=`${n}_${ae()}`}i=t._pixiId}let s=ue[i];if(r&&n&&!s)throw new Error(`The cacheId "${i}" does not exist in TextureCache.`);return s||t instanceof Re?!s&&t instanceof Re&&(s=new Kn(t),Kn.addToCache(s,i)):(e.resolution||(e.resolution=ge(t)),s=new Kn(new Re(t,e)),s.baseTexture.cacheId=i,Re.addToCache(s.baseTexture,i),Kn.addToCache(s,i)),s}static fromURL(t,e){const n=Object.assign({autoLoad:!1},e?.resourceOptions),r=Kn.from(t,Object.assign({resourceOptions:n},e),!1),i=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):i.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,n,r){return new Kn(Re.fromBuffer(t,e,n,r))}static fromLoader(t,e,n,r){const i=new Re(t,Object.assign({scaleMode:Re.defaultOptions.scaleMode,resolution:ge(e)},r)),{resource:s}=i;s instanceof Vn&&(s.url=e);const o=new Kn(i);return n||(n=e),Re.addToCache(o.baseTexture,n),Kn.addToCache(o,n),n!==e&&(Re.addToCache(o.baseTexture,e),Kn.addToCache(o,e)),o.baseTexture.valid?Promise.resolve(o):new Promise(t=>{o.baseTexture.once("loaded",()=>t(o))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),ue[e]&&ue[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),ue[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=ue[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete ue[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)ue[t.textureCacheIds[e]]===t&&delete ue[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:n,width:r,height:i}=t,s=e+r>this.baseTexture.width,o=n+i>this.baseTexture.height;if(s||o){const t=s&&o?"and":"or",a=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,l=`Y: ${n} + ${i} = ${n+i} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${a} ${t} ${l}`)}this.valid=r&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Kn._EMPTY||(Kn._EMPTY=new Kn(new Re),qn(Kn._EMPTY),qn(Kn._EMPTY.baseTexture)),Kn._EMPTY}static get WHITE(){if(!Kn._WHITE){const t=V.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),Kn._WHITE=new Kn(Re.from(t)),qn(Kn._WHITE),qn(Kn._WHITE.baseTexture)}return Kn._WHITE}}class Zn extends Kn{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,n=!0){const r=this.baseTexture.resolution,i=Math.round(t*r)/r,s=Math.round(e*r)/r;this.valid=i>0&&s>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=s,n&&this.baseTexture.resize(i,s),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Zn(new Gn(t))}}class Qn{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,n=z.NONE){const r=new Gn(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new Zn(r)}getOptimalTexture(t,e,n=1,r=z.NONE){let i;t=Math.max(Math.ceil(t*n-1e-6),1),e=Math.max(Math.ceil(e*n-1e-6),1),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?i=r>1?-r:-1:(i=((65535&(t=ee(t)))<<16|65535&(e=ee(e)))>>>0,r>1&&(i+=4294967296*r)),this.texturePool[i]||(this.texturePool[i]=[]);let s=this.texturePool[i].pop();return s||(s=this.createTexture(t,e,r)),s.filterPoolKey=i,s.setResolution(n),s}getFilterTexture(t,e,n){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||z.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=!1!==t)for(const t in this.texturePool){const e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0)}this.texturePool={}}setScreenSize(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){this.enableFullScreen=t.width>0&&t.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Qn.SCREEN_KEY=-1;class Jn extends je{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class tr extends je{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Le(this.vertices),this.uvBuffer=new Le(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+e.width/t.width,this.uvs[3]=r,this.uvs[4]=n+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=n,this.uvs[7]=r+e.height/t.height,n=e.x,r=e.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+e.width,this.vertices[3]=r,this.vertices[4]=n+e.width,this.vertices[5]=r+e.height,this.vertices[6]=n,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class er{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=z.NONE,this.sourceFrame=new qe,this.destinationFrame=new qe,this.bindingSourceFrame=new qe,this.bindingDestinationFrame=new qe,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const nr=[new Ye,new Ye,new Ye,new Ye],rr=new tn;class ir{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Qn,this.statePool=[],this.quad=new Jn,this.quadUv=new tr,this.tempRect=new qe,this.activeState={},this.globalUniforms=new Pn({outputFrame:new qe,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const n=this.renderer,r=this.defaultFilterStack,i=this.statePool.pop()||new er,s=n.renderTexture;let o,a;if(s.current){const t=s.current;o=t.resolution,a=t.multisample}else o=n.resolution,a=n.multisample;let l=e[0].resolution||o,c=e[0].multisample??a,h=e[0].padding,u=e[0].autoFit,d=e[0].legacy??!0;for(let t=1;t<e.length;t++){const n=e[t];l=Math.min(l,n.resolution||o),c=Math.min(c,n.multisample??a),h=this.useMaxPadding?Math.max(h,n.padding):h+n.padding,u=u&&n.autoFit,d=d||(n.legacy??!0)}1===r.length&&(this.defaultFilterStack[0].renderTexture=s.current),r.push(i),i.resolution=l,i.multisample=c,i.legacy=d,i.target=t,i.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),i.sourceFrame.pad(h);const p=this.tempRect.copyFrom(s.sourceFrame);n.projection.transform&&this.transformAABB(rr.copyFrom(n.projection.transform).invert(),p),u?(i.sourceFrame.fit(p),(i.sourceFrame.width<=0||i.sourceFrame.height<=0)&&(i.sourceFrame.width=0,i.sourceFrame.height=0)):i.sourceFrame.intersects(p)||(i.sourceFrame.width=0,i.sourceFrame.height=0),this.roundFrame(i.sourceFrame,s.current?s.current.resolution:n.resolution,s.sourceFrame,s.destinationFrame,n.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,l,c),i.filters=e,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=i.sourceFrame.width,f.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(s.sourceFrame),i.bindingDestinationFrame.copyFrom(s.destinationFrame),i.transform=n.projection.transform,n.projection.transform=null,s.bind(i.renderTexture,i.sourceFrame,f),n.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const i=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(i[0]=e.destinationFrame.width,i[1]=e.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],s[0]=Math.round(i[0]*e.resolution),s[1]=Math.round(i[1]*e.resolution),s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*i[2]-.5*s[2],o[3]=e.sourceFrame.height*i[3]-.5*s[3],e.legacy){const t=r.filterArea;t[0]=e.destinationFrame.width,t[1]=e.destinationFrame.height,t[2]=e.sourceFrame.x,t[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const a=t[t.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,a.renderTexture,W.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let t=e.renderTexture,r=this.getOptimalFilterTexture(t.width,t.height,e.resolution);r.filterFrame=t.filterFrame;let i=0;for(i=0;i<n.length-1;++i){1===i&&e.multisample>1&&(r=this.getOptimalFilterTexture(t.width,t.height,e.resolution),r.filterFrame=t.filterFrame),n[i].apply(this,t,r,W.CLEAR,e);const s=t;t=r,r=s}n[i].apply(this,t,a.renderTexture,W.BLEND,e),i>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(t),this.returnFilterTexture(r)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=W.CLEAR){const{renderTexture:n,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){const e=this.tempRect;e.x=0,e.y=0,e.width=t.filterFrame.width,e.height=t.filterFrame.height,n.bind(t,t.filterFrame,e)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const i=1&r.stateId||this.forceClear;(e===W.CLEAR||e===W.BLIT&&i)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,n,r){const i=this.renderer;i.state.set(t.state),this.bindAndClear(n,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(P.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(P.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:n,destinationFrame:r}=this.activeState,{orig:i}=e._texture,s=t.set(r.width,0,0,r.height,n.x,n.y),o=e.worldTransform.copyTo(tn.TEMP_MATRIX);return o.invert(),s.prepend(o),s.scale(1/i.width,1/i.height),s.translate(e.anchor.x,e.anchor.y),s}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,n=1,r=z.NONE){return this.texturePool.getOptimalTexture(t,e,n,r)}getFilterTexture(t,e,n){if("number"==typeof t){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||z.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const n=nr[0],r=nr[1],i=nr[2],s=nr[3];n.set(e.left,e.top),r.set(e.left,e.bottom),i.set(e.right,e.top),s.set(e.right,e.bottom),t.apply(n,n),t.apply(r,r),t.apply(i,i),t.apply(s,s);const o=Math.min(n.x,r.x,i.x,s.x),a=Math.min(n.y,r.y,i.y,s.y),l=Math.max(n.x,r.x,i.x,s.x),c=Math.max(n.y,r.y,i.y,s.y);e.x=o,e.y=a,e.width=l-o,e.height=c-a}roundFrame(t,e,n,r,i){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(i){const{a:t,b:e,c:n,d:r}=i;if((Math.abs(e)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4))return}(i=i?rr.copyFrom(i):rr.identity()).translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.transformAABB(i,t),t.ceil(e),this.transformAABB(i.invert(),t)}}}ir.extension={type:ve.RendererSystem,name:"filter"},we.add(ir);class sr{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=z.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const or=new qe;class ar{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new zn(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new qe,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;V.PREFER_ENV===E.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=t=>e.drawBuffersWEBGL(t):(this.hasMRT=!1,t.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,n=0){const{gl:r}=this;if(t){const i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,i.mipLevel=n),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,i.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let e=0;e<t.colorTextures.length;e++){const n=t.colorTextures[e];this.renderer.texture.unbind(n.parentTextureArray||n)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const t=e.width>>n,r=e.height>>n,i=t/e.width;this.setViewport(e.x*i,e.y*i,t,r)}else{const e=t.width>>n,r=t.height>>n;this.setViewport(0,0,e,r)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,n,r){const i=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),r=Math.round(r),(i.width!==n||i.height!==r||i.x!==t||i.y!==e)&&(i.x=t,i.y=e,i.width=n,i.height=r,this.gl.viewport(t,e,n,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,n,r,i=M.COLOR|M.DEPTH){const{gl:s}=this;s.clearColor(t,e,n,r),s.clear(i)}initFramebuffer(t){const{gl:e}=this,n=new sr(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n}resizeFramebuffer(t){const{gl:e}=this,n=t.glFramebuffers[this.CONTEXT_UID];if(n.stencil){let r;e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),r=1===this.renderer.context.webGLVersion?e.DEPTH_STENCIL:t.depth&&t.stencil?e.DEPTH24_STENCIL8:t.depth?e.DEPTH_COMPONENT24:e.STENCIL_INDEX8,n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,r,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,r,t.width,t.height)}const r=t.colorTextures;let i=r.length;e.drawBuffers||(i=Math.min(i,1));for(let s=0;s<i;s++){const i=r[s],o=i.parentTextureArray||i;this.renderer.texture.bind(o,0),0===s&&n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,o._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:n}=this,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures;let s=i.length;n.drawBuffers||(s=Math.min(s,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||n.createRenderbuffer():r.msaaBuffer&&(n.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const o=[];for(let a=0;a<s;a++){const s=i[a],l=s.parentTextureArray||s;this.renderer.texture.bind(l,0),0===a&&r.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,r.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+a,s.target,l._glTextures[this.CONTEXT_UID].texture,e),o.push(n.COLOR_ATTACHMENT0+a))}if(o.length>1&&n.drawBuffers(o),t.depthTexture&&this.writeDepthTexture){const r=t.depthTexture;this.renderer.texture.bind(r,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,r._glTextures[this.CONTEXT_UID].texture,e)}if(!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture)r.stencil&&(n.deleteRenderbuffer(r.stencil),r.stencil=null);else{let e,i;r.stencil=r.stencil||n.createRenderbuffer(),1===this.renderer.context.webGLVersion?(e=n.DEPTH_STENCIL_ATTACHMENT,i=n.DEPTH_STENCIL):t.depth&&t.stencil?(e=n.DEPTH_STENCIL_ATTACHMENT,i=n.DEPTH24_STENCIL8):t.depth?(e=n.DEPTH_ATTACHMENT,i=n.DEPTH_COMPONENT24):(e=n.STENCIL_ATTACHMENT,i=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,i,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,i,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,e,n.RENDERBUFFER,r.stencil)}}canMultisampleFramebuffer(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let n=z.NONE;if(t<=1||null===e)return n;for(let r=0;r<e.length;r++)if(e[r]<=t){n=e[r];break}return 1===n&&(n=z.NONE),n}blit(t,e,n){const{current:r,renderer:i,gl:s,CONTEXT_UID:o}=this;if(2!==i.context.webGLVersion||!r)return;const a=r.glFramebuffers[o];if(!a)return;if(!t){if(!a.msaaBuffer)return;const e=r.colorTextures[0];if(!e)return;a.blitFramebuffer||(a.blitFramebuffer=new zn(r.width,r.height),a.blitFramebuffer.addColorTexture(0,e)),(t=a.blitFramebuffer).colorTextures[0]!==e&&(t.colorTextures[0]=e,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||((e=or).width=r.width,e.height=r.height),n||(n=e);const l=e.width===n.width&&e.height===n.height;this.bind(t),s.bindFramebuffer(s.READ_FRAMEBUFFER,a.framebuffer),s.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,s.COLOR_BUFFER_BIT,l?s.NEAREST:s.LINEAR),s.bindFramebuffer(s.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const n=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!n)return;delete t.glFramebuffers[this.CONTEXT_UID];const i=this.managedFramebuffers.indexOf(t);i>=0&&this.managedFramebuffers.splice(i,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&r.deleteRenderbuffer(n.msaaBuffer),n.stencil&&r.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const n=t.width,r=t.height,i=this.gl,s=e.stencil=i.createRenderbuffer();let o,a;i.bindRenderbuffer(i.RENDERBUFFER,s),1===this.renderer.context.webGLVersion?(o=i.DEPTH_STENCIL_ATTACHMENT,a=i.DEPTH_STENCIL):t.depth?(o=i.DEPTH_STENCIL_ATTACHMENT,a=i.DEPTH24_STENCIL8):(o=i.STENCIL_ATTACHMENT,a=i.STENCIL_INDEX8),e.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,e.multisample,a,n,r):i.renderbufferStorage(i.RENDERBUFFER,a,n,r),i.framebufferRenderbuffer(i.FRAMEBUFFER,o,i.RENDERBUFFER,s)}reset(){this.current=this.unknownFramebuffer,this.viewport=new qe}destroy(){this.renderer=null}}ar.extension={type:ve.RendererSystem,name:"framebuffer"},we.add(ar);const lr={5126:4,5123:2,5121:1};class cr{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){let e=this.renderer.context.extensions.vertexArrayObject;V.PREFER_ENV===E.WEBGL_LEGACY&&(e=null),e?(t.createVertexArray=()=>e.createVertexArrayOES(),t.bindVertexArray=t=>e.bindVertexArrayOES(t),t.deleteVertexArray=t=>e.deleteVertexArrayOES(t)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(2!==e.webGLVersion){const e=t.getExtension("ANGLE_instanced_arrays");e?(t.vertexAttribDivisor=(t,n)=>e.vertexAttribDivisorANGLE(t,n),t.drawElementsInstanced=(t,n,r,i,s)=>e.drawElementsInstancedANGLE(t,n,r,i,s),t.drawArraysInstanced=(t,n,r,i)=>e.drawArraysInstancedANGLE(t,n,r,i)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:n}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],i=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},i=!0);const s=r[e.program.id]||this.initGeometryVao(t,e,i);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?n.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let n=0;n<t.buffers.length;n++){const r=t.buffers[n];e.update(r)}}checkCompatibility(t,e){const n=t.attributes,r=e.attributeData;for(const t in r)if(!n[t])throw new Error(`shader and geometry incompatible, geometry missing the "${t}" attribute`)}getSignature(t,e){const n=t.attributes,r=e.attributeData,i=["g",t.id];for(const t in n)r[t]&&i.push(t,r[t].location);return i.join("-")}initGeometryVao(t,e,n=!0){const r=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.program;o.glPrograms[i]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);const a=this.getSignature(t,o),l=t.glVertexArrayObjects[this.CONTEXT_UID];let c=l[a];if(c)return l[o.id]=c,c;const h=t.buffers,u=t.attributes,d={},p={};for(const t in h)d[t]=0,p[t]=0;for(const t in u)!u[t].size&&o.attributeData[t]?u[t].size=o.attributeData[t].size:u[t].size||console.warn(`PIXI Geometry attribute '${t}' size cannot be determined (likely the bound shader does not have the attribute)`),d[u[t].buffer]+=u[t].size*lr[u[t].type];for(const t in u){const e=u[t],n=e.size;void 0===e.stride&&(d[e.buffer]===n*lr[e.type]?e.stride=0:e.stride=d[e.buffer]),void 0===e.start&&(e.start=p[e.buffer],p[e.buffer]+=n*lr[e.type])}c=r.createVertexArray(),r.bindVertexArray(c);for(let t=0;t<h.length;t++){const e=h[t];s.bind(e),n&&e._glBuffers[i].refCount++}return this.activateVao(t,o),l[o.id]=c,l[a]=c,r.bindVertexArray(null),s.unbind(G.ARRAY_BUFFER),c}disposeGeometry(t,e){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const n=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,i=t.buffers,s=this.renderer?.buffer;if(t.disposeRunner.remove(this),n){if(s)for(let t=0;t<i.length;t++){const n=i[t]._glBuffers[this.CONTEXT_UID];n&&(n.refCount--,0===n.refCount&&!e&&s.dispose(i[t],e))}if(!e)for(const t in n)if("g"===t[0]){const e=n[t];this._activeVao===e&&this.unbind(),r.deleteVertexArray(e)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)}activateVao(t,e){const n=this.gl,r=this.CONTEXT_UID,i=this.renderer.buffer,s=t.buffers,o=t.attributes;t.indexBuffer&&i.bind(t.indexBuffer);let a=null;for(const t in o){const l=o[t],c=s[l.buffer],h=c._glBuffers[r];if(e.attributeData[t]){a!==h&&(i.bind(c),a=h);const r=e.attributeData[t].location;if(n.enableVertexAttribArray(r),n.vertexAttribPointer(r,l.size,l.type||n.FLOAT,l.normalized,l.stride,l.start),l.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(r,l.divisor)}}}}draw(t,e,n,r){const{gl:i}=this,s=this._activeGeometry;if(s.indexBuffer){const o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?i.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(n||0)*o,r||1):i.drawElements(t,e||s.indexBuffer.data.length,a,(n||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?i.drawArraysInstanced(t,n,e||s.getSize(),r||1):i.drawArrays(t,n,e||s.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}cr.extension={type:ve.RendererSystem,name:"geometry"},we.add(cr);const hr=new tn;class ur{constructor(t,e){this._texture=t,this.mapCoord=new tn,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){void 0===e&&(e=t);const n=this.mapCoord;for(let r=0;r<t.length;r+=2){const i=t[r],s=t[r+1];e[r]=i*n.a+s*n.c+n.tx,e[r+1]=i*n.b+s*n.d+n.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const r=e.orig,i=e.trim;i&&(hr.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(hr));const s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,l=this.clampOffset;return o[0]=(e._frame.x+a+l)/s.width,o[1]=(e._frame.y+a+l)/s.height,o[2]=(e._frame.x+e._frame.width-a+l)/s.width,o[3]=(e._frame.y+e._frame.height-a+l)/s.height,this.uClampOffset[0]=l/s.realWidth,this.uClampOffset[1]=l/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0}}class dr extends Nn{constructor(t,e,n){let r=null;"string"!=typeof t&&void 0===e&&void 0===n&&(r=t,t=void 0,e=void 0,n=void 0),super(t||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",e||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",n),this.maskSprite=r,this.maskMatrix=new tn}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,n,r){const i=this._maskSprite,s=i._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new ur(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,t.applyFilter(this,e,n,r))}}class pr{constructor(t=null){this.type=H.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Nn.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=H.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class fr{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let n=e;if(!n.isMaskData){const t=this.maskDataPool.pop()||new pr;t.pooled=!0,t.maskObject=e,n=t}const r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(r),n._colorMask=r?r._colorMask:15,n.autoDetect&&this.detect(n),n._target=t,n.type!==H.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case H.SCISSOR:this.renderer.scissor.push(n);break;case H.STENCIL:this.renderer.stencil.push(n);break;case H.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case H.COLOR:this.pushColorMask(n)}n.type===H.SPRITE&&this.maskStack.push(n)}pop(t){const e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case H.SCISSOR:this.renderer.scissor.pop(e);break;case H.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case H.SPRITE:this.popSpriteMask(e);break;case H.COLOR:this.popColorMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){const t=this.maskStack[this.maskStack.length-1];t.type===H.SPRITE&&t._filters&&(t._filters[0].maskSprite=t.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=H.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=H.SCISSOR:t.type=H.STENCIL:t.type=H.COLOR}pushSpriteMask(t){const{maskObject:e}=t,n=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new dr])),r[0].resolution=t.resolution,r[0].multisample=t.multisample,r[0].maskSprite=e;const i=n.filterArea;n.filterArea=e.getBounds(!0),this.renderer.filter.push(n,r),n.filterArea=i,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask(!!(1&n),!!(2&n),!!(4&n),!!(8&n))}popColorMask(t){const e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask(!!(1&n),!!(2&n),!!(4&n),!!(8&n))}destroy(){this.renderer=null}}fr.extension={type:ve.RendererSystem,name:"mask"},we.add(fr);class mr{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,n=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==n&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const gr=new tn,vr=[],yr=class t extends mr{constructor(t){super(t),this.glConst=V.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:n}=t,{renderer:r}=this,i=r.renderTexture,s=n.getBounds(!0,vr.pop()??new qe);this.roundFrameToPixels(s,i.current?i.current.resolution:r.resolution,i.sourceFrame,i.destinationFrame,r.projection.transform),e&&s.fit(e),t._scissorRectLocal=s}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:n,c:r,d:i}=t;return(Math.abs(n)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(i)>1e-4)}testScissor(e){const{maskObject:n}=e;if(!n.isFastRect||!n.isFastRect()||t.isMatrixRotated(n.worldTransform)||t.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,n,r,i,s){t.isMatrixRotated(s)||((s=s?gr.copyFrom(s):gr.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*n),e.y=Math.round(e.y*n),e.width=Math.round(e.width*n),e.height=Math.round(e.height*n))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&vr.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;e=this.renderer.renderTexture.current?t.y:this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};yr.extension={type:ve.RendererSystem,name:"scissor"};let xr=yr;we.add(xr);class wr extends mr{constructor(t){super(t),this.glConst=V.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:n}=this.renderer,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;const i=t._colorMask;0!==i&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,r,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==i&&(t._colorMask=i,n.colorMask(!!(1&i),!!(2&i),!!(4&i),!!(8&i))),this._useCurrent()}pop(t){const e=this.renderer.gl;if(0===this.getStackLength())e.disable(e.STENCIL_TEST);else{const n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,r=n?n._colorMask:15;0!==r&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==r&&(n._colorMask=r,e.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r))),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}wr.extension={type:ve.RendererSystem,name:"stencil"},we.add(wr);class _r{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return ft("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return ft("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return ft("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}_r.extension={type:[ve.RendererSystem,ve.CanvasRendererSystem],name:"_plugin"},we.add(_r);class br{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new tn,this.transform=null}update(t,e,n,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);const i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)}calculateProjection(t,e,n,r){const i=this.projectionMatrix,s=r?-1:1;i.identity(),i.a=1/e.width*2,i.d=s*(1/e.height*2),i.tx=-1-e.x*i.a,i.ty=-s-e.y*i.d}setTransform(t){}destroy(){this.renderer=null}}br.extension={type:ve.RendererSystem,name:"projection"},we.add(br);const Ar=new dn,Tr=new qe;class Sr{constructor(t){this.renderer=t,this._tempMatrix=new tn}generateTexture(t,e){const{region:n,...r}=e||{},i=n?.copyTo(Tr)||t.getLocalBounds(Tr,!0),s=r.resolution||this.renderer.resolution;i.width=Math.max(i.width,1/s),i.height=Math.max(i.height,1/s),r.width=i.width,r.height=i.height,r.resolution=s,r.multisample??(r.multisample=this.renderer.multisample);const o=Zn.create(r);this._tempMatrix.tx=-i.x,this._tempMatrix.ty=-i.y;const a=t.transform;return t.transform=Ar,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}Sr.extension={type:[ve.RendererSystem,ve.CanvasRendererSystem],name:"textureGenerator"},we.add(Sr);const Er=new qe,kr=new qe;class Mr{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new qe,this.destinationFrame=new qe,this.viewportFrame=new qe}contextChange(){const t=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,n){const r=this.renderer;let i,s,o;this.current=t,t?(i=t.baseTexture,o=i.resolution,e||(Er.width=t.frame.width,Er.height=t.frame.height,e=Er),n||(kr.x=t.frame.x,kr.y=t.frame.y,kr.width=e.width,kr.height=e.height,n=kr),s=i.framebuffer):(o=r.resolution,e||(Er.width=r._view.screen.width,Er.height=r._view.screen.height,e=Er),n||((n=Er).width=e.width,n.height=e.height));const a=this.viewportFrame;a.x=n.x*o,a.y=n.y*o,a.width=n.width*o,a.height=n.height*o,t||(a.y=r.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(s,a),this.renderer.projection.update(n,e,o,!s),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)}clear(t,e){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=qt.shared.setValue(t||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const i=this.destinationFrame,s=this.current?this.current.baseTexture:this.renderer._view.screen,o=i.width!==s.width||i.height!==s.height;if(o){let{x:t,y:e,width:n,height:r}=this.viewportFrame;t=Math.round(t),e=Math.round(e),n=Math.round(n),r=Math.round(r),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(t,e,n,r)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,e),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Mr.extension={type:ve.RendererSystem,name:"renderTexture"},we.add(Mr);class Cr{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Pr(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function Ir(t){const e=new Array(t);for(let t=0;t<e.length;t++)e[t]=!1;return e}function Rr(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Ir(2*e);case"bvec3":return Ir(3*e);case"bvec4":return Ir(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Or(t,e){const n=t.getShaderSource(e).split("\n").map((t,e)=>`${e}: ${t}`),r=t.getShaderInfoLog(e),i=r.split("\n"),s={},o=i.map(t=>parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(t=>!(!t||s[t]||(s[t]=!0,0))),a=[""];o.forEach(t=>{n[t-1]=`%c${n[t-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=n.join("\n");a[0]=l,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Dr(t,e,n,r,i){n.buffer.update(i)}const Lr={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},Fr={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};let Br,Nr=0;const Wr={textureCount:0,uboCount:0};class Ur{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Nr++}systemCheck(){if(!function(){if("boolean"==typeof Br)return Br;try{Br=!0===new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch{Br=!1}return Br}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const n=t.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),e||(Wr.textureCount=0,Wr.uboCount=0,this.syncUniformGroup(t.uniformGroup,Wr)),r}setUniforms(t){const e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)}syncUniformGroup(t,e){const n=this.getGlProgram();(!t.static||t.dirtyId!==n.uniformDirtyGroups[t.id])&&(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))}syncUniforms(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){const n=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(const r in t.uniforms){const i=e[r];if(!i){!0===t.uniforms[r]?.group&&(t.uniforms[r].ubo?n.push(`\n                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');\n                    `):n.push(`\n                        renderer.shader.syncUniformGroup(uv.${r}, syncData);\n                    `));continue}const s=t.uniforms[r];let o=!1;for(let t=0;t<pn.length;t++)if(pn[t].test(i,s)){n.push(pn[t].code(r,s)),o=!0;break}if(!o){const t=(1!==i.size||i.isArray?mn:fn)[i.type].replace("location",`ud["${r}"].location`);n.push(`\n            cu = ud["${r}"];\n            cv = cu.value;\n            v = uv["${r}"];\n            ${t};`)}}return new Function("ud","uv","renderer","syncData",n.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const n=this.getGlProgram();if(!t.static||0!==t.dirtyId||!n.uniformGroups[t.id]){t.dirtyId=0;const r=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),r(n.uniformData,t.uniforms,this.renderer,Wr,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])}createSyncBufferGroup(t,e,n){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const i=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;const s=this.getSignature(t,this.shader.program.uniformData,"ubo");let o=this._uboCache[s];if(o||(o=this._uboCache[s]=function(t,e){if(!t.autoManage)return{size:0,syncFunc:Dr};const n=function(t,e){const n=[];for(const r in t)e[r]&&n.push(e[r]);return n.sort((t,e)=>t.index-e.index),n}(t.uniforms,e),{uboElements:r,size:i}=function(t){const e=t.map(t=>({data:t,offset:0,dataLen:0,dirty:0}));let n=0,r=0,i=0;for(let t=0;t<e.length;t++){const s=e[t];if(n=Fr[s.data.type],s.data.size>1&&(n=Math.max(n,16)*s.data.size),s.dataLen=n,r%n!==0&&r<16){const t=r%n%16;r+=t,i+=t}r+n>16?(i=16*Math.ceil(i/16),s.offset=i,i+=n,r=n):(s.offset=i,r+=n,i+=n)}return i=16*Math.ceil(i/16),{uboElements:e,size:i}}(n),s=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(let e=0;e<r.length;e++){const n=r[e],i=t.uniforms[n.data.name],o=n.data.name;let a=!1;for(let t=0;t<pn.length;t++){const e=pn[t];if(e.codeUbo&&e.test(n.data,i)){s.push(`offset = ${n.offset/4};`,pn[t].codeUbo(n.data.name,i)),a=!0;break}}if(!a)if(n.data.size>1){const t=wn(n.data.type),e=Math.max(Fr[n.data.type]/16,1),r=t/e,i=(4-r%4)%4;s.push(`\n                cv = ud.${o}.value;\n                v = uv.${o};\n                offset = ${n.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${n.data.size*e}; i++)\n                {\n                    for(var j = 0; j < ${r}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${i};\n                }\n\n                `)}else{const t=Lr[n.data.type];s.push(`\n                cv = ud.${o}.value;\n                v = uv.${o};\n                offset = ${n.offset/4};\n                ${t};\n                `)}}return s.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join("\n"))}}(t,this.shader.program.uniformData)),t.autoManage){const e=new Float32Array(o.size/4);t.buffer.update(e)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,n){const r=t.uniforms,i=[`${n}-`];for(const t in r)i.push(t),e[t]&&i.push(e[t].type);return i.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,n=t.program,r=function(t,e){const n=Pr(t,t.VERTEX_SHADER,e.vertexSrc),r=Pr(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,n),t.attachShader(i,r);const s=e.extra?.transformFeedbackVaryings;if(s&&("function"!=typeof t.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,"separate"===s.bufferMode?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||function(t,e,n,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||Or(t,n),t.getShaderParameter(r,t.COMPILE_STATUS)||Or(t,r),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,i,n,r),e.attributeData=function(t,e){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i);if(r.name.startsWith("gl_"))continue;const s=An(e,r.type),o={type:s,name:r.name,size:wn(s),location:e.getAttribLocation(t,r.name)};n[r.name]=o}return n}(i,t),e.uniformData=function(t,e){const n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const r=e.getActiveUniform(t,i),s=r.name.replace(/\[.*?\]$/,""),o=!!r.name.match(/\[.*?\]$/),a=An(e,r.type);n[s]={name:s,index:i,type:a,size:r.size,isArray:o,value:Rr(a,r.size)}}return n}(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const n=Object.keys(e.attributeData);n.sort((t,e)=>t>e?1:-1);for(let r=0;r<n.length;r++)e.attributeData[n[r]].location=r,t.bindAttribLocation(i,r,n[r]);t.linkProgram(i)}t.deleteShader(n),t.deleteShader(r);const o={};for(const n in e.uniformData){const r=e.uniformData[n];o[n]={location:t.getUniformLocation(i,n),value:Rr(r.type,r.size)}}return new Cr(i,o)}(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Ur.extension={type:ve.RendererSystem,name:"shader"},we.add(Ur);class jr{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.4.3 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}jr.defaultOptions={hello:!1},jr.extension={type:[ve.RendererSystem,ve.CanvasRendererSystem],name:"startup"},we.add(jr);const Hr=class t{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=C.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Te,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=function(t,e=[]){return e[C.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.ADD]=[t.ONE,t.ONE],e[C.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.NONE]=[0,0],e[C.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[C.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[C.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[C.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[C.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[C.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[C.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[C.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[C.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[C.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[C.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,n=0;for(;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):!e&&-1!==n&&this.checks.splice(n,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};Hr.extension={type:ve.RendererSystem,name:"state"};let zr=Hr;we.add(zr);class Gr extends ut{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(e=>t.systems[e]),n=[...e,...Object.keys(t.systems).filter(t=>!e.includes(t))];for(const e of n)this.addSystem(t.systems[e],e)}addRunners(...t){t.forEach(t=>{this.runners[t]=new ke(t)})}addSystem(t,e){const n=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=n,this._systemsHash[e]=n;for(const t in this.runners)this.runners[t].add(n);return this}emitWithCustomOptions(t,e){const n=Object.keys(this._systemsHash);t.items.forEach(r=>{const i=n.find(t=>this._systemsHash[t]===r);r[t.name](e[i])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Xr=class t{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=t.defaultMaxIdle,this.checkCountMax=t.defaultCheckCountMax,this.mode=t.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==U.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let n=!1;for(let r=0;r<e.length;r++){const i=e[r];i.resource&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[r]=null,n=!0)}if(n){let t=0;for(let n=0;n<e.length;n++)null!==e[n]&&(e[t++]=e[n]);e.length=t}}unload(t){const e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(let e=t.children.length-1;e>=0;e--)this.unload(t.children[e])}destroy(){this.renderer=null}};Xr.defaultMode=U.AUTO,Xr.defaultMaxIdle=3600,Xr.defaultCheckCountMax=600,Xr.extension={type:ve.RendererSystem,name:"textureGC"};let Vr=Xr;we.add(Vr);class Yr{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=O.UNSIGNED_BYTE,this.internalFormat=I.RGBA,this.samplerType=0}}class $r{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Re,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){let e;return e="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[O.UNSIGNED_BYTE]:{[I.RGBA]:t.RGBA8,[I.RGB]:t.RGB8,[I.RG]:t.RG8,[I.RED]:t.R8,[I.RGBA_INTEGER]:t.RGBA8UI,[I.RGB_INTEGER]:t.RGB8UI,[I.RG_INTEGER]:t.RG8UI,[I.RED_INTEGER]:t.R8UI,[I.ALPHA]:t.ALPHA,[I.LUMINANCE]:t.LUMINANCE,[I.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[O.BYTE]:{[I.RGBA]:t.RGBA8_SNORM,[I.RGB]:t.RGB8_SNORM,[I.RG]:t.RG8_SNORM,[I.RED]:t.R8_SNORM,[I.RGBA_INTEGER]:t.RGBA8I,[I.RGB_INTEGER]:t.RGB8I,[I.RG_INTEGER]:t.RG8I,[I.RED_INTEGER]:t.R8I},[O.UNSIGNED_SHORT]:{[I.RGBA_INTEGER]:t.RGBA16UI,[I.RGB_INTEGER]:t.RGB16UI,[I.RG_INTEGER]:t.RG16UI,[I.RED_INTEGER]:t.R16UI,[I.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[O.SHORT]:{[I.RGBA_INTEGER]:t.RGBA16I,[I.RGB_INTEGER]:t.RGB16I,[I.RG_INTEGER]:t.RG16I,[I.RED_INTEGER]:t.R16I},[O.UNSIGNED_INT]:{[I.RGBA_INTEGER]:t.RGBA32UI,[I.RGB_INTEGER]:t.RGB32UI,[I.RG_INTEGER]:t.RG32UI,[I.RED_INTEGER]:t.R32UI,[I.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[O.INT]:{[I.RGBA_INTEGER]:t.RGBA32I,[I.RGB_INTEGER]:t.RGB32I,[I.RG_INTEGER]:t.RG32I,[I.RED_INTEGER]:t.R32I},[O.FLOAT]:{[I.RGBA]:t.RGBA32F,[I.RGB]:t.RGB32F,[I.RG]:t.RG32F,[I.RED]:t.R32F,[I.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[O.HALF_FLOAT]:{[I.RGBA]:t.RGBA16F,[I.RGB]:t.RGB16F,[I.RG]:t.RG16F,[I.RED]:t.R16F},[O.UNSIGNED_SHORT_5_6_5]:{[I.RGB]:t.RGB565},[O.UNSIGNED_SHORT_4_4_4_4]:{[I.RGBA]:t.RGBA4},[O.UNSIGNED_SHORT_5_5_5_1]:{[I.RGBA]:t.RGB5_A1},[O.UNSIGNED_INT_2_10_10_10_REV]:{[I.RGBA]:t.RGB10_A2,[I.RGBA_INTEGER]:t.RGB10_A2UI},[O.UNSIGNED_INT_10F_11F_11F_REV]:{[I.RGB]:t.R11F_G11F_B10F},[O.UNSIGNED_INT_5_9_9_9_REV]:{[I.RGB]:t.RGB9_E5},[O.UNSIGNED_INT_24_8]:{[I.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[O.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[I.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:{[O.UNSIGNED_BYTE]:{[I.RGBA]:t.RGBA,[I.RGB]:t.RGB,[I.ALPHA]:t.ALPHA,[I.LUMINANCE]:t.LUMINANCE,[I.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[O.UNSIGNED_SHORT_5_6_5]:{[I.RGB]:t.RGB},[O.UNSIGNED_SHORT_4_4_4_4]:{[I.RGBA]:t.RGBA},[O.UNSIGNED_SHORT_5_5_5_1]:{[I.RGBA]:t.RGBA}},e}(t),this.samplerTypes=function(t){let e;return e="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[t.RGB]:D.FLOAT,[t.RGBA]:D.FLOAT,[t.ALPHA]:D.FLOAT,[t.LUMINANCE]:D.FLOAT,[t.LUMINANCE_ALPHA]:D.FLOAT,[t.R8]:D.FLOAT,[t.R8_SNORM]:D.FLOAT,[t.RG8]:D.FLOAT,[t.RG8_SNORM]:D.FLOAT,[t.RGB8]:D.FLOAT,[t.RGB8_SNORM]:D.FLOAT,[t.RGB565]:D.FLOAT,[t.RGBA4]:D.FLOAT,[t.RGB5_A1]:D.FLOAT,[t.RGBA8]:D.FLOAT,[t.RGBA8_SNORM]:D.FLOAT,[t.RGB10_A2]:D.FLOAT,[t.RGB10_A2UI]:D.FLOAT,[t.SRGB8]:D.FLOAT,[t.SRGB8_ALPHA8]:D.FLOAT,[t.R16F]:D.FLOAT,[t.RG16F]:D.FLOAT,[t.RGB16F]:D.FLOAT,[t.RGBA16F]:D.FLOAT,[t.R32F]:D.FLOAT,[t.RG32F]:D.FLOAT,[t.RGB32F]:D.FLOAT,[t.RGBA32F]:D.FLOAT,[t.R11F_G11F_B10F]:D.FLOAT,[t.RGB9_E5]:D.FLOAT,[t.R8I]:D.INT,[t.R8UI]:D.UINT,[t.R16I]:D.INT,[t.R16UI]:D.UINT,[t.R32I]:D.INT,[t.R32UI]:D.UINT,[t.RG8I]:D.INT,[t.RG8UI]:D.UINT,[t.RG16I]:D.INT,[t.RG16UI]:D.UINT,[t.RG32I]:D.INT,[t.RG32UI]:D.UINT,[t.RGB8I]:D.INT,[t.RGB8UI]:D.UINT,[t.RGB16I]:D.INT,[t.RGB16UI]:D.UINT,[t.RGB32I]:D.INT,[t.RGB32UI]:D.UINT,[t.RGBA8I]:D.INT,[t.RGBA8UI]:D.UINT,[t.RGBA16I]:D.INT,[t.RGBA16UI]:D.UINT,[t.RGBA32I]:D.INT,[t.RGBA32UI]:D.UINT,[t.DEPTH_COMPONENT16]:D.FLOAT,[t.DEPTH_COMPONENT24]:D.FLOAT,[t.DEPTH_COMPONENT32F]:D.FLOAT,[t.DEPTH_STENCIL]:D.FLOAT,[t.DEPTH24_STENCIL8]:D.FLOAT,[t.DEPTH32F_STENCIL8]:D.FLOAT}:{[t.RGB]:D.FLOAT,[t.RGBA]:D.FLOAT,[t.ALPHA]:D.FLOAT,[t.LUMINANCE]:D.FLOAT,[t.LUMINANCE_ALPHA]:D.FLOAT,[t.DEPTH_STENCIL]:D.FLOAT},e}(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let t=0;t<e;t++)this.boundTextures[t]=null;this.emptyTextures={};const n=new Yr(t.createTexture());t.bindTexture(t.TEXTURE_2D,n.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=n,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Yr(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let e=0;e<6;e++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let t=0;t<this.boundTextures.length;t++)this.bind(null,t)}bind(t,e=0){const{gl:n}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let t=0;t<n.length;t++)n[t]===this.unknownTexture&&this.bind(null,t)}for(let r=0;r<n.length;r++)n[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:n,CONTEXT_UID:r}=this;if(n)for(let n=t-1;n>=0;--n){const t=e[n];t&&t._glTextures[r].samplerType!==D.FLOAT&&this.renderer.texture.unbind(t)}}initTexture(t){const e=new Yr(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){e.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??D.FLOAT,2===this.webGLVersion&&t.type===O.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const n=this.renderer;if(this.initTextureType(t,e),t.resource?.upload(n,t,e))e.samplerType!==D.FLOAT&&(this.hasIntegerTextures=!0);else{const r=t.realWidth,i=t.realHeight,s=n.gl;(e.width!==r||e.height!==i||e.dirtyId<0)&&(e.width=r,e.height=i,s.texImage2D(t.target,0,e.internalFormat,r,i,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:n}=this;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const e=this.managedTextures.indexOf(t);-1!==e&&ie(this.managedTextures,e,1)}}updateTextureStyle(t){const e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==B.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=F.CLAMP,t.resource?.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const n=this.gl;if(e.mipmap&&t.mipmap!==B.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===L.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const e=this.renderer.context.extensions.anisotropicFiltering;if(e&&t.anisotropicLevel>0&&t.scaleMode===L.LINEAR){const r=Math.min(t.anisotropicLevel,n.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,e.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===L.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===L.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}$r.extension={type:ve.RendererSystem,name:"texture"},we.add($r);class qr{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,r=t._glTransformFeedbacks[n]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:n,renderer:r}=this;e&&r.shader.bind(e),n.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:n,CONTEXT_UID:r}=this,i=e.createTransformFeedback();t._glTransformFeedbacks[r]=i,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,i);for(let i=0;i<t.buffers.length;i++){const s=t.buffers[i];s&&(n.buffer.update(s),s._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,i,s._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),i}disposeTransformFeedback(t,e){const n=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const i=this.renderer.buffer;if(i)for(let n=0;n<t.buffers.length;n++){const r=t.buffers[n];if(!r)continue;const s=r._glBuffers[this.CONTEXT_UID];s&&(s.refCount--,0===s.refCount&&!e&&i.dispose(r,e))}n&&(e||r.deleteTransformFeedback(n),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}qr.extension={type:ve.RendererSystem,name:"transformFeedback"},we.add(qr);class Kr{constructor(t){this.renderer=t}init(t){this.screen=new qe(0,0,t.width,t.height),this.element=t.view||V.ADAPTER.createCanvas(),this.resolution=t.resolution||V.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const n=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=n,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",n,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}Kr.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Kr.extension={type:[ve.RendererSystem,ve.CanvasRendererSystem],name:"_view"},we.add(Kr),V.PREFER_ENV=E.WEBGL2,V.STRICT_TEXTURE_CACHE=!1,V.RENDER_OPTIONS={...Hn.defaultOptions,...Wn.defaultOptions,...Kr.defaultOptions,...jr.defaultOptions},Object.defineProperties(V,{WRAP_MODE:{get(){return Re.defaultOptions.wrapMode},set(t){ft("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Re.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return Re.defaultOptions.scaleMode},set(t){ft("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Re.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return Re.defaultOptions.mipmap},set(t){ft("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Re.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return Re.defaultOptions.anisotropicLevel},set(t){ft("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Re.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return ft("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Nn.defaultResolution},set(t){Nn.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return ft("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Nn.defaultMultisample},set(t){Nn.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return Fn.defaultMaxTextures},set(t){ft("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Fn.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return Fn.defaultBatchSize},set(t){ft("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Fn.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return Fn.canUploadSameBuffer},set(t){ft("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Fn.canUploadSameBuffer=t}},GC_MODE:{get(){return Vr.defaultMode},set(t){ft("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Vr.defaultMode=t}},GC_MAX_IDLE:{get(){return Vr.defaultMaxIdle},set(t){ft("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Vr.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return Vr.defaultCheckCountMax},set(t){ft("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Vr.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return Mn.defaultVertexPrecision},set(t){ft("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Mn.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return Mn.defaultFragmentPrecision},set(t){ft("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Mn.defaultFragmentPrecision=t}}});var Zr=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Zr||{});class Qr{constructor(t,e=null,n=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Jr=class t{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Qr(null,null,1/0),this.deltaMS=1/t.targetFPMS,this.elapsedMS=1/t.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,n=Zr.NORMAL){return this._addListener(new Qr(t,e,n))}addOnce(t,e,n=Zr.NORMAL){return this._addListener(new Qr(t,e,n,!0))}_addListener(t){let e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this}remove(t,e){let n=this._head.next;for(;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let n;if(e>this.lastTime){if(n=this.elapsedMS=e-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),n*=this.speed,this._minElapsedMS){const t=e-this._lastFrame|0;if(t<this._minElapsedMS)return;this._lastFrame=e-t%this._minElapsedMS}this.deltaMS=n,this.deltaTime=this.deltaMS*t.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const n=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,n)/1e3,t.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!t._shared){const e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared}static get system(){if(!t._system){const e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system}};Jr.targetFPMS=.06;let ti=Jr;Object.defineProperties(V,{TARGET_FPMS:{get(){return ti.targetFPMS},set(t){ft("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ti.targetFPMS=t}}});class ei{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Zr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ti.shared:new ti,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}ei.extension=ve.Application,we.add(ei);const ni=[];we.handleByList(ve.Renderer,ni);const ri="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";class ii{constructor(t){this.renderer=t}contextChange(t){let e;if(1===this.renderer.context.webGLVersion){const n=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,n)}else{const n=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,n)}e>=z.HIGH?this.multisample=z.HIGH:e>=z.MEDIUM?this.multisample=z.MEDIUM:e>=z.LOW?this.multisample=z.LOW:this.multisample=z.NONE}destroy(){}}ii.extension={type:ve.RendererSystem,name:"_multisample"},we.add(ii);class si{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class oi{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,r=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:n,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const i=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,i.buffer)}}bindBufferRange(t,e,n){const{gl:r,CONTEXT_UID:i}=this;n=n||0;const s=t._glBuffers[i]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,s.buffer,256*n,256)}update(t){const{gl:e,CONTEXT_UID:n}=this,r=t._glBuffers[n]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const n=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),n&&(e||r.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:n}=this;return t._glBuffers[e]=new si(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}oi.extension={type:ve.RendererSystem,name:"buffer"},we.add(oi);class ai{constructor(t){this.renderer=t}render(t,e){const n=this.renderer;let r,i,s,o;if(e&&(r=e.renderTexture,i=e.clear,s=e.transform,o=e.skipUpdateTransform),this.renderingToScreen=!r,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=s,!n.context.isLost){if(r||(this.lastObjectRendered=t),!o){const e=t.enableTempParent();t.updateTransform(),t.disableTempParent(e)}n.renderTexture.bind(r),n.batch.currentRenderer.start(),(i??n.background.clearBeforeRender)&&n.renderTexture.clear(),t.render(n),n.batch.currentRenderer.flush(),r&&(e.blit&&n.framebuffer.blit(),r.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ai.extension={type:ve.RendererSystem,name:"objectRenderer"},we.add(ai);const li=class t extends Gr{constructor(e){super(),this.type=k.WEBGL,e=Object.assign({},V.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Pn({projectionMatrix:new tn},!0);const n={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:t.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(n),"useContextAlpha"in e&&(ft("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&"notMultiplied"!==e.useContextAlpha,e.backgroundAlpha=!1===e.useContextAlpha?1:e.backgroundAlpha),this._plugin.rendererPlugins=t.__plugins,this.options=e,this.startup.run(this.options)}static test(t){return!t?.forceCanvas&&(typeof xt>"u"&&(xt=function(){const t={stencil:!0,failIfMajorPerformanceCaveat:V.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!V.ADAPTER.getWebGLRenderingContext())return!1;const e=V.ADAPTER.createCanvas();let n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);const r=!!n?.getContextAttributes()?.stencil;if(n){const t=n.getExtension("WEBGL_lose_context");t&&t.loseContext()}return n=null,r}catch{return!1}}()),xt)}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return ft("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return ft("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return ft("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return ft("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){ft("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return ft("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){ft("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return ft("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};li.extension={type:ve.Renderer,priority:1},li.__plugins={},li.__systems={};let ci=li;we.handleByMap(ve.RendererPlugin,ci.__plugins),we.handleByMap(ve.RendererSystem,ci.__systems),we.add(ci);class hi extends Me{constructor(t,e){const{width:n,height:r}=e||{};super(n,r),this.items=[],this.itemDirtyIds=[];for(let e=0;e<t;e++){const t=new Re;this.items.push(t),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof Me?this.addResourceAt(t[n],n):this.addResourceAt(Ee(t[n],e),n))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(t=>t.resource).filter(t=>t).map(t=>t.load());return this._load=Promise.all(t).then(()=>{const{realWidth:t,realHeight:e}=this.items[0];return this.resize(t,e),this.update(),Promise.resolve(this)}),this._load}}const ui=class t extends hi{constructor(e,n){const{width:r,height:i,autoLoad:s,linkBaseTexture:o}=n||{};if(e&&e.length!==t.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let e=0;e<t.SIDES;e++)this.items[e].target=R.TEXTURE_CUBE_MAP_POSITIVE_X+e;this.linkBaseTexture=!1!==o,e&&this.initFromArray(e,n),!1!==s&&this.load()}bind(t){super.bind(t),t.target=R.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=R.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(e,n,r){const i=this.itemDirtyIds;for(let s=0;s<t.SIDES;s++){const t=this.items[s];(i[s]<t.dirtyId||r.dirtyId<n.dirtyId)&&(t.valid&&t.resource?(t.resource.upload(e,t,r),i[s]=t.dirtyId):i[s]<-1&&(e.gl.texImage2D(t.target,0,r.internalFormat,n.realWidth,n.realHeight,0,n.format,r.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===t.SIDES}};ui.SIDES=6;let di=ui;class pi extends Xn{constructor(t,e){let n,r,i;e=e||{},"string"==typeof t?(n=pi.EMPTY,r=t,i=!0):(n=t,r=null,i=!1),super(n),this.url=r,this.crossOrigin=e.crossOrigin??!0,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??i,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(async(t,e)=>{if(null!==this.url)try{const e=await V.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const n=await e.blob();if(this.destroyed)return;const r=await createImageBitmap(n,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===N.UNPACK?"premultiply":"none"});if(this.destroyed)return void r.close();this.source=r,this.update(),t(this)}catch(t){if(this.destroyed)return;e(t),this.onError.emit(t)}else t(this)})),this._load}upload(t,e,n){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),super.upload(t,e,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&("string"==typeof t||t instanceof ImageBitmap)}static get EMPTY(){return pi._EMPTY=pi._EMPTY??V.ADAPTER.createCanvas(0,0),pi._EMPTY}}const fi=class t extends Xn{constructor(t,e){e=e||{},super(V.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},t.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()})),this._load}_loadSvg(){const t=new Image;Xn.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,n=t.height;if(!e||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=e*this.scale,i=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/n*e,i=this._overrideHeight||this._overrideWidth/e*n),r=Math.round(r),i=Math.round(i);const s=this.source;s.width=r,s.height=i,s._pixiId=`canvas_${ae()}`,s.getContext("2d").drawImage(t,0,0,e,n,0,0,r,i),this._resolve(),this._resolve=null}}static getSize(e){const n=t.SVG_SIZE.exec(e),r={};return n&&(r[n[1]]=Math.round(parseFloat(n[3])),r[n[5]]=Math.round(parseFloat(n[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,n){return"svg"===n||"string"==typeof e&&e.startsWith("data:image/svg+xml")||"string"==typeof e&&t.SVG_XML.test(e)}};fi.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,fi.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let mi=fi;const gi=class t extends Xn{constructor(e,n){if(n=n||{},!(e instanceof HTMLVideoElement)){const r=document.createElement("video");!1!==n.autoLoad&&r.setAttribute("preload","auto"),!1!==n.playsinline&&(r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline","")),!0===n.muted&&(r.setAttribute("muted",""),r.muted=!0),!0===n.loop&&r.setAttribute("loop",""),!1!==n.autoPlay&&r.setAttribute("autoplay",""),"string"==typeof e&&(e=[e]);const i=e[0].src||e[0];Xn.crossOrigin(r,i,n.crossorigin);for(let n=0;n<e.length;++n){const i=document.createElement("source");let{src:s,mime:o}=e[n];if(s=s||e[n],s.startsWith("data:"))o=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const e=s.split("?").shift().toLowerCase(),n=e.slice(e.lastIndexOf(".")+1);o=o||t.MIME_TYPES[n]||`video/${n}`}i.src=s,o&&(i.type=o),r.appendChild(i)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=n.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==n.autoPlay,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==n.autoLoad&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const t=ti.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,n)=>{this.valid?e(this):(this._resolve=e,this._reject=n,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ti.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ti.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ti.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,n){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||t.TYPES.includes(n)}};gi.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],gi.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let vi=gi;Se.push(pi,Vn,class extends Xn{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}},vi,class extends Xn{constructor(t){super(t)}static test(t){return!!globalThis.VideoFrame&&t instanceof globalThis.VideoFrame}},mi,Ce,di,class extends hi{constructor(t,e){const{width:n,height:r}=e||{};let i,s;Array.isArray(t)?(i=t,s=t.length):s=t,super(s,{width:n,height:r}),i&&this.initFromArray(i,e)}addBaseTextureAt(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this}bind(t){super.bind(t),t.target=R.TEXTURE_2D_ARRAY}upload(t,e,n){const{length:r,itemDirtyIds:i,items:s}=this,{gl:o}=t;n.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,e.format,n.type,null);for(let t=0;t<r;t++){const r=s[t];i[t]<r.dirtyId&&(i[t]=r.dirtyId,r.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,t,r.resource.width,r.resource.height,1,e.format,n.type,r.resource.source))}return!0}});class yi{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?qe.EMPTY:((t=t||new qe(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:n,b:r,c:i,d:s,tx:o,ty:a}=t,l=n*e.x+i*e.y+o,c=r*e.x+s*e.y+a;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let e=this.minX,n=this.minY,r=this.maxX,i=this.maxY,s=t[0],o=t[1];e=s<e?s:e,n=o<n?o:n,r=s>r?s:r,i=o>i?o:i,s=t[2],o=t[3],e=s<e?s:e,n=o<n?o:n,r=s>r?s:r,i=o>i?o:i,s=t[4],o=t[5],e=s<e?s:e,n=o<n?o:n,r=s>r?s:r,i=o>i?o:i,s=t[6],o=t[7],e=s<e?s:e,n=o<n?o:n,r=s>r?s:r,i=o>i?o:i,this.minX=e,this.minY=n,this.maxX=r,this.maxY=i}addFrame(t,e,n,r,i){this.addFrameMatrix(t.worldTransform,e,n,r,i)}addFrameMatrix(t,e,n,r,i){const s=t.a,o=t.b,a=t.c,l=t.d,c=t.tx,h=t.ty;let u=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+a*n+c,g=o*e+l*n+h;u=m<u?m:u,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,m=s*r+a*n+c,g=o*r+l*n+h,u=m<u?m:u,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,m=s*e+a*i+c,g=o*e+l*i+h,u=m<u?m:u,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,m=s*r+a*i+c,g=o*r+l*i+h,u=m<u?m:u,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=u,this.minY=d,this.maxX=p,this.maxY=f}addVertexData(t,e,n){let r=this.minX,i=this.minY,s=this.maxX,o=this.maxY;for(let a=e;a<n;a+=2){const e=t[a],n=t[a+1];r=e<r?e:r,i=n<i?n:i,s=e>s?e:s,o=n>o?n:o}this.minX=r,this.minY=i,this.maxX=s,this.maxY=o}addVertices(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)}addVerticesMatrix(t,e,n,r,i=0,s=i){const o=t.a,a=t.b,l=t.c,c=t.d,h=t.tx,u=t.ty;let d=this.minX,p=this.minY,f=this.maxX,m=this.maxY;for(let t=n;t<r;t+=2){const n=e[t],r=e[t+1],g=o*n+l*r+h,v=c*r+a*n+u;d=Math.min(d,g-i),f=Math.max(f,g+i),p=Math.min(p,v-s),m=Math.max(m,v+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m}addBounds(t){const e=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>i?t.maxY:i}addBoundsMask(t,e){const n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=i&&r<=s){const t=this.minX,e=this.minY,o=this.maxX,a=this.maxY;this.minX=n<t?n:t,this.minY=r<e?r:e,this.maxX=i>o?i:o,this.maxY=s>a?s:a}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=i&&r<=s){const t=this.minX,e=this.minY,o=this.maxX,a=this.maxY;this.minX=n<t?n:t,this.minY=r<e?r:e,this.maxX=i>o?i:o,this.maxY=s>a?s:a}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,n,r,i,s){t-=i,e-=s,n+=i,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}class xi extends ut{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new dn,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new yi,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let n=0;n<e.length;++n){const r=e[n];Object.defineProperty(xi.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new qe),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new qe),t=this._localBoundsRect),this._localBounds||(this._localBounds=new yi);const e=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=n?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,i=this._boundsID;this._bounds=this._localBounds;const s=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-i,s}toGlobal(t,e,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,n,r){return e&&(t=e.toGlobal(t,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,e=0,n=1,r=1,i=0,s=0,o=0,a=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new wi),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Ge}set angle(t){this.transform.rotation=t*Xe}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,0===t._maskRefCount&&(t.renderable=!0,t.isMask=!1))}if(this._mask=t,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(0===t._maskRefCount&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class wi extends xi{constructor(){super(...arguments),this.sortDirty=null}}xi.prototype.displayObjectUpdateTransform=xi.prototype.updateTransform;const _i=new tn;function bi(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const Ai=class t extends xi{constructor(){super(),this.children=[],this.sortableChildren=t.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const n=this.getChildIndex(t),r=this.getChildIndex(e);this.children[n]=e,this.children[r]=t,this.onChildrenChange(n<r?n:r)}getChildIndex(t){const e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(t);ie(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],n=this.children.indexOf(e);if(-1===n)return null;e.parent=null,e.transform._parentID=-1,ie(this.children,n,1),this._boundsID++,this.onChildrenChange(n),e.emit("removed",this),this.emit("childRemoved",e,this,n)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,ie(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const n=t,r=e-n;let i;if(r>0&&r<=e){i=this.children.splice(n,r);for(let t=0;t<i.length;++t)i[t].parent=null,i[t].transform&&(i[t].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let t=0;t<i.length;++t)i[t].emit("removed",this),this.emit("childRemoved",i[t],this,t);return i}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,n=this.children.length;e<n;++e){const n=this.children[e];n._lastSortedIndex=e,!t&&0!==n.zIndex&&(t=!0)}t&&this.children.length>1&&this.children.sort(bi),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const e=this.children[t];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){const t=e._mask.isMaskData?e._mask.maskObject:e._mask;t?(t.calculateBounds(),this._bounds.addBoundsMask(e._bounds,t._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const n=super.getLocalBounds(t);if(!e)for(let t=0,e=this.children.length;t<e;++t){const e=this.children[t];e.visible&&e.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const n=e.renderTexture.sourceFrame;if(!(n.width>0&&n.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==t.prototype._render&&(r=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=_i.copyFrom(i),i.prepend(s)):i=s),r&&n.intersects(r,i))this._render(e);else if(this.cullArea)return;for(let t=0,n=this.children.length;t<n;++t){const n=this.children[t],r=n.cullable;n.cullable=r||!this.cullArea,n.render(e),n.cullable=r}}render(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters?.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}}renderAdvanced(t){const e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let t=0;t<e.length;t++)e[t].enabled&&this._enabledFilters.push(e[t])}const r=e&&this._enabledFilters?.length||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==H.NONE));if(r&&t.batch.flush(),e&&this._enabledFilters?.length&&t.filter.push(this,this._enabledFilters),n&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}r&&t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters?.length&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e="boolean"==typeof t?t:t?.children,n=this.removeChildren(0,this.children.length);if(e)for(let e=0;e<n.length;++e)n[e].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}};Ai.defaultSortableChildren=!1;let Ti=Ai;Ti.prototype.containerUpdateTransform=Ti.prototype.updateTransform,Object.defineProperties(V,{SORTABLE_CHILDREN:{get(){return Ti.defaultSortableChildren},set(t){ft("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Ti.defaultSortableChildren=t}}});const Si=new Ye,Ei=new Uint16Array([0,1,2,0,2,3]);class ki extends Ti{constructor(t){super(),this._anchor=new hn(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new qt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=C.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||Kn.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=Ei,this.pluginName="batch",this.isSprite=!0,this._roundPixels=V.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=se(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=se(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty,l=this.vertexData,c=t.trim,h=t.orig,u=this._anchor;let d=0,p=0,f=0,m=0;if(c?(p=c.x-u._x*h.width,d=p+c.width,m=c.y-u._y*h.height,f=m+c.height):(p=-u._x*h.width,d=p+h.width,m=-u._y*h.height,f=m+h.height),l[0]=n*p+i*m+o,l[1]=s*m+r*p+a,l[2]=n*d+i*m+o,l[3]=s*m+r*d+a,l[4]=n*d+i*f+o,l[5]=s*f+r*d+a,l[6]=n*p+i*f+o,l[7]=s*f+r*p+a,this._roundPixels){const t=V.RESOLUTION;for(let e=0;e<l.length;++e)l[e]=Math.round(l[e]*t)/t}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,n=t.orig,r=this._anchor,i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,l=i.d,c=i.tx,h=i.ty,u=-r._x*n.width,d=u+n.width,p=-r._y*n.height,f=p+n.height;if(e[0]=s*u+a*p+c,e[1]=l*p+o*u+h,e[2]=s*d+a*p+c,e[3]=l*p+o*d+h,e[4]=s*d+a*f+c,e[5]=l*f+o*d+h,e[6]=s*u+a*f+c,e[7]=l*f+o*u+h,this._roundPixels){const t=V.RESOLUTION;for(let n=0;n<e.length;++n)e[n]=Math.round(e[n]*t)/t}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return 0===this.children.length?(this._localBounds||(this._localBounds=new yi),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new qe),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Si);const e=this._texture.orig.width,n=this._texture.orig.height,r=-e*this.anchor.x;let i=0;return Si.x>=r&&Si.x<r+e&&(i=-n*this.anchor.y,Si.y>=i&&Si.y<i+n)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const n=t instanceof Kn?t:Kn.from(t,e);return new ki(n)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=se(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=se(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Kn.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const Mi=new tn;xi.prototype._cacheAsBitmap=!1,xi.prototype._cacheData=null,xi.prototype._cacheAsBitmapResolution=null,xi.prototype._cacheAsBitmapMultisample=null;class Ci{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(xi.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;let e;this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Ci),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}),xi.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},xi.prototype._initCachedDisplayObject=function(t){if(this._cacheData?.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const n=this.getLocalBounds(new qe,!0);if(this.filters?.length){const t=this.filters[0].padding;n.pad(t)}const r=this.cacheAsBitmapResolution||t.resolution;n.ceil(r),n.width=Math.max(n.width,1/r),n.height=Math.max(n.height,1/r);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,l=Zn.create({width:n.width,height:n.height,resolution:r,multisample:this.cacheAsBitmapMultisample??t.multisample}),c=`cacheAsBitmap_${ae()}`;this._cacheData.textureCacheId=c,Re.addToCache(l.baseTexture,c),Kn.addToCache(l,c);const h=this.transform.localTransform.copyTo(Mi).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:h,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const u=new ki(l);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-n.x/n.width,u.anchor.y=-n.y/n.height,u.alpha=e,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)},xi.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},xi.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cacheData?.sprite)return;const e=this.getLocalBounds(new qe,!0),n=this.alpha;this.alpha=1;const r=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Zn.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${ae()}`;this._cacheData.textureCacheId=a,Re.addToCache(o.baseTexture,a),Kn.addToCache(o,a);const l=Mi;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=r,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const c=new ki(o);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-e.x/e.width,c.anchor.y=-e.y/e.height,c.alpha=n,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=c.containsPoint.bind(c)},xi.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},xi.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},xi.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Re.removeFromCache(this._cacheData.textureCacheId),Kn.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},xi.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},xi.prototype.name=null,Ti.prototype.getChildByName=function(t,e){for(let e=0,n=this.children.length;e<n;e++)if(this.children[e].name===t)return this.children[e];if(e)for(let e=0,n=this.children.length;e<n;e++){const n=this.children[e];if(!n.getChildByName)continue;const r=n.getChildByName(t,!0);if(r)return r}return null},xi.prototype.getGlobalPosition=function(t=new Ye,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};const Pi={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Ii=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");class Ri extends Nn{constructor(t,e=8,n=4,r=Nn.defaultResolution,i=5){const s=function(t,e){const n=Math.ceil(t/2);let r,i="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";r=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let e=0;e<t;e++){let t=r.replace("%index%",e.toString());t=t.replace("%sampleIndex%",e-(n-1)+".0"),s+=t,s+="\n"}return i=i.replace("%blur%",s),i=i.replace("%size%",t.toString()),i}(i,t),o=function(t){const e=Pi[t],n=e.length;let r,i=Ii,s="";for(let i=0;i<t;i++){let o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",i.toString());r=i,i>=n&&(r=t-i-1),o=o.replace("%value%",e[r].toString()),s+=o,s+="\n"}return i=i.replace("%blur%",s),i=i.replace("%size%",t.toString()),i}(i);super(s,o),this.horizontal=t,this.resolution=r,this._quality=0,this.quality=n,this.blur=e}apply(t,e,n,r){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,r);else{const i=t.getFilterTexture(),s=t.renderer;let o=e,a=i;this.state.blend=!1,t.applyFilter(this,o,a,W.CLEAR);for(let e=1;e<this.passes-1;e++){t.bindAndClear(o,W.BLIT),this.uniforms.uSampler=a;const e=a;a=o,o=e,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,n,r),t.returnFilterTexture(i)}}get blur(){return this.strength}set blur(t){this.padding=1+2*Math.abs(t),this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class Oi extends Nn{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(ri,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",t),this.alpha=1}_loadMatrix(t,e=!1){let n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}tint(t,e){const[n,r,i]=qt.shared.setValue(t).toArray(),s=[n,0,0,0,0,0,r,0,0,0,0,0,i,0,0,0,0,0,1,0];this._loadMatrix(s,e)}greyscale(t,e){const n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}blackAndWhite(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)}hue(t,e){t=(t||0)/180*Math.PI;const n=Math.cos(t),r=Math.sin(t),i=1/3,s=(0,Math.sqrt)(i),o=[n+(1-n)*i,i*(1-n)-s*r,i*(1-n)+s*r,0,0,i*(1-n)+s*r,n+i*(1-n),i*(1-n)-s*r,0,0,i*(1-n)-s*r,i*(1-n)+s*r,n+i*(1-n),0,0,0,0,0,1,0];this._loadMatrix(o,e)}contrast(t,e){const n=(t||0)+1,r=-.5*(n-1),i=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(i,e)}saturate(t=0,e){const n=2*t/3+1,r=-.5*(n-1),i=[n,r,r,0,0,r,n,r,0,0,r,r,n,0,0,0,0,0,1,0];this._loadMatrix(i,e)}desaturate(){this.saturate(-1)}negative(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)}sepia(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)}technicolor(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)}polaroid(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)}toBGR(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)}kodachrome(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)}browni(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)}vintage(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)}colorTone(t,e,n,r,i){t=t||.2,e=e||.15,n=n||16770432,r=r||3375104;const s=qt.shared,[o,a,l]=s.setValue(n).toArray(),[c,h,u]=s.setValue(r).toArray(),d=[.3,.59,.11,0,0,o,a,l,t,0,c,h,u,e,0,o-c,a-h,l-u,0,0];this._loadMatrix(d,i)}night(t,e){const n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}predator(t,e){const n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)}lsd(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Oi.prototype.grayscale=Oi.prototype.greyscale;const Di={AlphaFilter:class extends Nn{constructor(t=1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}},BlurFilter:class extends Nn{constructor(t=8,e=4,n=Nn.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Ri(!0,t,e,n,r),this.blurYFilter=new Ri(!1,t,e,n,r),this.resolution=n,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,n,r){const i=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(i&&s){const i=t.getFilterTexture();this.blurXFilter.apply(t,e,i,W.CLEAR),this.blurYFilter.apply(t,i,n,r),t.returnFilterTexture(i)}else s?this.blurYFilter.apply(t,e,n,r):this.blurXFilter.apply(t,e,n,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}},BlurFilterPass:Ri,ColorMatrixFilter:Oi,DisplacementFilter:class extends Nn{constructor(t,e){const n=new tn;t.renderable=!1,super("attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:t._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=n,null==e&&(e=20),this.scale=new Ye(e,e)}apply(t,e,n,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const i=this.maskSprite.worldTransform,s=Math.sqrt(i.a*i.a+i.b*i.b),o=Math.sqrt(i.c*i.c+i.d*i.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=i.a/s,this.uniforms.rotation[1]=i.b/s,this.uniforms.rotation[2]=i.c/o,this.uniforms.rotation[3]=i.d/o),t.applyFilter(this,e,n,r)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}},FXAAFilter:class extends Nn{constructor(){super("\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}},NoiseFilter:class extends Nn{constructor(t=.5,e=Math.random()){super(ri,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}};Object.entries(Di).forEach(([t,e])=>{Object.defineProperty(Di,t,{get(){return ft("7.1.0",`filters.${t} has moved to ${t}`),e}})});const Li=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(ti.system.add(this.tickerUpdate,this,Zr.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ti.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===t.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}};class Fi{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Fi.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Ye,this.page=new Ye,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,n,r,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Bi extends Fi{constructor(){super(...arguments),this.client=new Ye,this.movement=new Ye,this.offset=new Ye,this.global=new Ye,this.screen=new Ye}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,n,r,i,s,o,a,l,c,h,u,d,p,f){throw new Error("Method not implemented.")}}class Ni extends Bi{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Wi extends Bi{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Wi.DOM_DELTA_PIXEL=0,Wi.DOM_DELTA_LINE=1,Wi.DOM_DELTA_PAGE=2;const Ui=new Ye,ji=new Ye;class Hi{constructor(t){this.dispatch=new ut,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((t,e)=>t.priority-e.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){Li.pauseUpdate=!0;const n=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,Ui.set(t,e),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,e){if(!t.target)return;const n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,i=n.length-1;r<i;r++)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let r=n.length-2;r>=0;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,n=this._allInteractiveElements){if(0===n.length)return;t.eventPhase=t.BUBBLING_PHASE;const r=Array.isArray(e)?e:[e];for(let e=n.length-1;e>=0;e--)r.forEach(r=>{t.currentTarget=n[e],this.notifyTarget(t,r)})}propagationPath(t){const e=[t];for(let n=0;n<2048&&t!==this.rootTarget;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,n,r,i,s=!1){let o=!1;if(this._interactivePrune(t))return null;if(("dynamic"===t.eventMode||"dynamic"===e)&&(Li.pauseUpdate=!1),t.interactiveChildren&&t.children){const a=t.children;for(let l=a.length-1;l>=0;l--){const c=a[l],h=this.hitTestMoveRecursive(c,this._isInteractive(e)?e:c.eventMode,n,r,i,s||i(t,n));if(h){if(h.length>0&&!h[h.length-1].parent)continue;const e=t.isInteractive();(h.length>0||e)&&(e&&this._allInteractiveElements.push(t),h.push(t)),0===this._hitElements.length&&(this._hitElements=h),o=!0}}}const a=this._isInteractive(e),l=t.isInteractive();return a&&l&&this._allInteractiveElements.push(t),s||this._hitElements.length>0?null:o?this._hitElements:a&&!i(t,n)&&r(t,n)?l?[t]:[]:null}hitTestRecursive(t,e,n,r,i){if(this._interactivePrune(t)||i(t,n))return null;if(("dynamic"===t.eventMode||"dynamic"===e)&&(Li.pauseUpdate=!1),t.interactiveChildren&&t.children){const s=t.children;for(let o=s.length-1;o>=0;o--){const a=s[o],l=this.hitTestRecursive(a,this._isInteractive(e)?e:a.eventMode,n,r,i);if(l){if(l.length>0&&!l[l.length-1].parent)continue;const e=t.isInteractive();return(l.length>0||e)&&l.push(t),l}}}const s=this._isInteractive(e),o=t.isInteractive();return s&&r(t,n)?o?[t]:[]:null}_isInteractive(t){return"static"===t||"dynamic"===t}_interactivePrune(t){return!(t&&!t.isMask&&t.visible&&t.renderable&&"none"!==t.eventMode&&("passive"!==t.eventMode||t.interactiveChildren)&&!t.isMask)}hitPruneFn(t,e){if(t.hitArea&&(t.worldTransform.applyInverse(e,ji),!t.hitArea.contains(ji.x,ji.y)))return!0;if(t._mask){const n=t._mask.isMaskData?t._mask.maskObject:t._mask;if(n&&!n.containsPoint?.(e))return!0}return!1}hitTestFn(t,e){return"passive"!==t.eventMode&&(!!t.hitArea||!!t.containsPoint&&t.containsPoint(e))}notifyTarget(t,e){const n=`on${e=e??t.type}`;t.currentTarget[n]?.(t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof Ni))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)this.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){const t=2===e.button;this.dispatchEvent(e,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){if(!(t instanceof Ni))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const n="mouse"===e.pointerType||"pen"===e.pointerType,r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.overTargets);if(r.overTargets?.length>0&&i!==e.target){const r="mousemove"===t.type?"mouseout":"pointerout",s=this.createPointerEvent(t,r,i);if(this.dispatchEvent(s,"pointerout"),n&&this.dispatchEvent(s,"mouseout"),!e.composedPath().includes(i)){const r=this.createPointerEvent(t,"pointerleave",i);for(r.eventPhase=r.AT_TARGET;r.target&&!e.composedPath().includes(r.target);)r.currentTarget=r.target,this.notifyTarget(r),n&&this.notifyTarget(r,"mouseleave"),r.target=r.target.parent;this.freeEvent(r)}this.freeEvent(s)}if(i!==e.target){const r="mousemove"===t.type?"mouseover":"pointerover",s=this.clonePointerEvent(e,r);this.dispatchEvent(s,"pointerover"),n&&this.dispatchEvent(s,"mouseover");let o=i?.parent;for(;o&&o!==this.rootTarget.parent&&o!==e.target;)o=o.parent;if(!o||o===this.rootTarget.parent){const t=this.clonePointerEvent(e,"pointerenter");for(t.eventPhase=t.AT_TARGET;t.target&&t.target!==i&&t.target!==this.rootTarget.parent;)t.currentTarget=t.target,this.notifyTarget(t),n&&this.notifyTarget(t,"mouseenter"),t.target=t.target.parent;this.freeEvent(t)}this.freeEvent(s)}const s=[],o=this.enableGlobalMoveEvents??!0;this.moveOnAll?s.push("pointermove"):this.dispatchEvent(e,"pointermove"),o&&s.push("globalpointermove"),"touch"===e.pointerType&&(this.moveOnAll?s.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),o&&s.push("globaltouchmove")),n&&(this.moveOnAll?s.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),o&&s.push("globalmousemove"),this.cursor=e.target?.cursor),s.length>0&&this.all(e,s),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){if(!(t instanceof Ni))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId),n=this.createPointerEvent(t),r="mouse"===n.pointerType||"pen"===n.pointerType;this.dispatchEvent(n,"pointerover"),r&&this.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(this.cursor=n.target?.cursor);const i=this.clonePointerEvent(n,"pointerenter");for(i.eventPhase=i.AT_TARGET;i.target&&i.target!==this.rootTarget.parent;)i.currentTarget=i.target,this.notifyTarget(i),r&&this.notifyTarget(i,"mouseenter"),i.target=i.target.parent;e.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(i)}mapPointerOut(t){if(!(t instanceof Ni))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId);if(e.overTargets){const n="mouse"===t.pointerType||"pen"===t.pointerType,r=this.findMountedTarget(e.overTargets),i=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(i),n&&this.dispatchEvent(i,"mouseout");const s=this.createPointerEvent(t,"pointerleave",r);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;e.overTargets=null,this.freeEvent(i),this.freeEvent(s)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Ni))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=performance.now(),n=this.createPointerEvent(t);if(this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)this.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){const t=2===n.button;this.dispatchEvent(n,t?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]);let s=i;if(i&&!n.composedPath().includes(i)){let e=i;for(;e&&!n.composedPath().includes(e);){if(n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)this.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){const t=2===n.button;this.notifyTarget(n,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete r.pressTargetsByButton[t.button],s=e}if(s){const i=this.clonePointerEvent(n,"click");i.target=s,i.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:i.target,timeStamp:e});const o=r.clicksByButton[t.button];if(o.target===i.target&&e-o.timeStamp<200?++o.clickCount:o.clickCount=1,o.target=i.target,o.timeStamp=e,i.detail=o.clickCount,"mouse"===i.pointerType){const t=2===i.button;this.dispatchEvent(i,t?"rightclick":"click")}else"touch"===i.pointerType&&this.dispatchEvent(i,"tap");this.dispatchEvent(i,"pointertap"),this.freeEvent(i)}this.freeEvent(n)}mapPointerUpOutside(t){if(!(t instanceof Ni))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(n){let i=n;for(;i;)r.currentTarget=i,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType?this.notifyTarget(r,"touchendoutside"):("mouse"===r.pointerType||"pen"===r.pointerType)&&this.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),i=i.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof Wi))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let n=1;n<t.length&&t[n].parent===e;n++)e=t[n];return e}createPointerEvent(t,e,n){const r=this.allocateEvent(Ni);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=n??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],"string"==typeof e&&(r.type=e),r}createWheelEvent(t){const e=this.allocateEvent(Wi);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const n=this.allocateEvent(Ni);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=e??n.type,n}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof Ni&&e instanceof Ni&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Bi&&e instanceof Bi&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const n=t.currentTarget._events[e];if(n&&t.currentTarget.isInteractive())if("fn"in n)n.once&&t.currentTarget.removeListener(e,n.fn,void 0,!0),n.fn.call(n.context,t);else for(let r=0,i=n.length;r<i&&!t.propagationImmediatelyStopped;r++)n[r].once&&t.currentTarget.removeListener(e,n[r].fn,void 0,!0),n[r].fn.call(n[r].context,t)}}const zi={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Gi=class t{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new Hi(null),Li.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Ni(null),this.rootWheelEvent=new Wi(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...t.defaultEventFeatures},{set:(t,e,n)=>("globalMove"===e&&(this.rootBoundary.enableGlobalMoveEvents=n),t[e]=n,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:n,resolution:r}=this.renderer;this.setTargetElement(n),this.resolution=r,t._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.domElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.domElement.style,n)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let t=0,n=e.length;t<n;t++){const n=e[t],r=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Li.pointerMoved();const e=this.normalizeToPointerData(t);for(let t=0,n=e.length;t<n;t++){const n=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const n=e!==this.domElement?"outside":"",r=this.normalizeToPointerData(t);for(let t=0,e=r.length;t<e;t++){const e=this.bootstrapEvent(this.rootPointerEvent,r[t]);e.type+=n,this.rootBoundary.mapEvent(e)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);for(let t=0,n=e.length;t<n;t++){const n=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,Li.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Li.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Li.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,n){const r=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},i=1/this.resolution;t.x=(e-r.left)*(this.domElement.width/r.width)*i,t.y=(n-r.top)*(this.domElement.height/r.height)*i}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let n=0,r=t.changedTouches.length;n<r;n++){const r=t.changedTouches[n];typeof r.button>"u"&&(r.button=0),typeof r.buttons>"u"&&(r.buttons=1),typeof r.isPrimary>"u"&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),typeof r.width>"u"&&(r.width=r.radiusX||1),typeof r.height>"u"&&(r.height=r.radiusY||1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="touch"),typeof r.pointerId>"u"&&(r.pointerId=r.identifier||0),typeof r.pressure>"u"&&(r.pressure=r.force||.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),typeof r.layerX>"u"&&(r.layerX=r.offsetX=r.clientX),typeof r.layerY>"u"&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof globalThis.PointerEvent)){const n=t;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=1),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,e.push(n)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=zi[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};Gi.extension={name:"events",type:[ve.RendererSystem,ve.CanvasRendererSystem]},Gi.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Xi=Gi;function Vi(t){return"dynamic"===t||"static"===t}we.add(Xi);const Yi={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Vi(Xi.defaultEventMode)},set interactive(t){ft("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Xi.defaultEventMode},set eventMode(t){this._internalInteractive=Vi(t),this._internalEventMode=t},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(t,e,n){const r="boolean"==typeof n&&n||"object"==typeof n&&n.capture,i="object"==typeof n?n.signal:void 0,s="object"==typeof n&&!0===n.once,o="function"==typeof e?void 0:e;t=r?`${t}capture`:t;const a="function"==typeof e?e:e.handleEvent,l=this;i&&i.addEventListener("abort",()=>{l.off(t,a,o)}),s?l.once(t,a,o):l.on(t,a,o)},removeEventListener(t,e,n){const r="function"==typeof e?void 0:e;t="boolean"==typeof n&&n||"object"==typeof n&&n.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,this.off(t,e,r)},dispatchEvent(t){if(!(t instanceof Fi))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};xi.mixin(Yi),xi.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});class $i{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(ht.tablet||ht.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2..toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let t=0;t<e.length;t++)this.updateAccessibleObjects(e[t])}update(){const t=performance.now();if(ht.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:n,width:r,height:i}=this.renderer.view.getBoundingClientRect(),{width:s,height:o,resolution:a}=this.renderer,l=r/s*a,c=i/o*a;let h=this.div;h.style.left=`${e}px`,h.style.top=`${n}px`,h.style.width=`${s}px`,h.style.height=`${o}px`;for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.renderId!==this.renderId)e._accessibleActive=!1,ie(this.children,t,1),this.div.removeChild(e._accessibleDiv),this.pool.push(e._accessibleDiv),e._accessibleDiv=null,t--;else{h=e._accessibleDiv;let t=e.hitArea;const n=e.worldTransform;e.hitArea?(h.style.left=(n.tx+t.x*n.a)*l+"px",h.style.top=(n.ty+t.y*n.d)*c+"px",h.style.width=t.width*n.a*l+"px",h.style.height=t.height*n.d*c+"px"):(t=e.getBounds(),this.capHitArea(t),h.style.left=t.x*l+"px",h.style.top=t.y*c+"px",h.style.width=t.width*l+"px",h.style.height=t.height*c+"px",h.title!==e.accessibleTitle&&null!==e.accessibleTitle&&(h.title=e.accessibleTitle),h.getAttribute("aria-label")!==e.accessibleHint&&null!==e.accessibleHint&&h.setAttribute("aria-label",e.accessibleHint)),(e.accessibleTitle!==h.title||e.tabIndex!==h.tabIndex)&&(h.title=e.accessibleTitle,h.tabIndex=e.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:n}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>n&&(t.height=n-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:(!t.accessibleHint||null===t.accessibleHint)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:n}=t.target,r=this.renderer.events.rootBoundary,i=Object.assign(new Fi(r),{target:n});r.rootTarget=this.renderer.lastObjectRendered,e.forEach(t=>r.dispatchEvent(i,t))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){9===t.keyCode&&this.activate()}_onMouseMove(t){0===t.movementX&&0===t.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}$i.extension={name:"accessibility",type:[ve.RendererPlugin,ve.CanvasRendererPlugin]},we.add($i);const qi=class t{constructor(e){this.stage=new Ti,e=Object.assign({forceCanvas:!1},e),this.renderer=function(t){for(const e of ni)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}(e),t._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(e,n){const r=t._plugins.slice(0);r.reverse(),r.forEach(t=>{t.destroy.call(this)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null}};qi._plugins=[];let Ki=qi;we.handleByList(ve.Application,Ki._plugins);class Zi{static init(t){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let t,e;if(this.cancelResize(),this._resizeTo===globalThis.window)t=globalThis.innerWidth,e=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:r}=this._resizeTo;t=n,e=r}this.renderer.resize(t,e),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Zi.extension=ve.Application,we.add(Zi);const Qi={loader:ve.LoadParser,resolver:ve.ResolveParser,cache:ve.CacheParser,detection:ve.DetectionParser};we.handle(ve.Asset,t=>{const e=t.ref;Object.entries(Qi).filter(([t])=>!!e[t]).forEach(([t,n])=>we.add(Object.assign(e[t],{extension:e[t].extension??n})))},t=>{const e=t.ref;Object.keys(Qi).filter(t=>!!e[t]).forEach(t=>we.remove(e[t]))});class Ji{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<e;n++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function ts(t,e){const n=t.split("?")[0],r=vt.extname(n).toLowerCase();return Array.isArray(e)?e.includes(r):r===e}const es=(t,e,n=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(t=>"string"==typeof t||n?e(t):t):t),ns=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const n=es(t);let r;for(let t=0;t<this.parsers.length;t++){const i=this.parsers[t];if(i.test(e)){r=i.getCacheableAssets(n,e);break}}r||(r={},n.forEach(t=>{r[t]=e}));const i=Object.keys(r),s={cacheKeys:i,keys:n};if(n.forEach(t=>{this._cacheMap.set(t,s)}),i.forEach(t=>{const n=r?r[t]:e;this._cache.has(t)&&this._cache.get(t)!==n&&console.warn("[Cache] already has key:",t),this._cache.set(t,r[t])}),e instanceof Kn){const t=e;n.forEach(e=>{t.baseTexture!==Kn.EMPTY.baseTexture&&Re.addToCache(t.baseTexture,e),Kn.addToCache(t,e)})}}remove(t){if(!this._cacheMap.has(t))return void console.warn(`[Assets] Asset id ${t} was not found in the Cache`);const e=this._cacheMap.get(t);e.cacheKeys.forEach(t=>{this._cache.delete(t)}),e.keys.forEach(t=>{this._cacheMap.delete(t)})}get parsers(){return this._parsers}},rs=t=>!Array.isArray(t);class is{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,n)=>(this._parsersValidated=!1,t[e]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const n={promise:null,parser:null};return n.promise=(async()=>{let r=null,i=null;if(e.loadParser&&(i=this._parserHash[e.loadParser],i||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!i){for(let n=0;n<this.parsers.length;n++){const r=this.parsers[n];if(r.load&&r.test?.(t,e,this)){i=r;break}}if(!i)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await i.load(t,e,this),n.parser=i;for(let t=0;t<this.parsers.length;t++){const i=this.parsers[t];i.parse&&i.parse&&await(i.testParse?.(r,e,this))&&(r=await i.parse(r,e,this)||r,n.parser=i)}return r})(),n}async load(t,e){this._parsersValidated||this._validateParsers();let n=0;const r={},i=rs(t),s=es(t,t=>({alias:[t],src:t})),o=s.length,a=s.map(async t=>{const i=vt.toAbsolute(t.src);if(!r[t.src])try{this.promiseCache[i]||(this.promiseCache[i]=this._getLoadPromiseAndParser(i,t)),r[t.src]=await this.promiseCache[i].promise,e&&e(++n/o)}catch(e){throw delete this.promiseCache[i],delete r[t.src],new Error(`[Loader.load] Failed to load ${i}.\n${e}`)}});return await Promise.all(a),i?r[s[0].src]:r}async unload(t){const e=es(t,t=>({alias:[t],src:t})).map(async t=>{const e=vt.toAbsolute(t.src),n=this.promiseCache[e];if(n){const r=await n.promise;delete this.promiseCache[e],n.parser?.unload?.(r,t,this)}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var ss=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(ss||{});function os(t,e){if(Array.isArray(e)){for(const n of e)if(t.startsWith(`data:${n}`))return!0;return!1}return t.startsWith(`data:${e}`)}const as={extension:{type:ve.LoadParser,priority:ss.Low},name:"loadJson",test(t){return os(t,"application/json")||ts(t,".json")},async load(t){return await(await V.ADAPTER.fetch(t)).json()}};we.add(as);const ls={name:"loadTxt",extension:{type:ve.LoadParser,priority:ss.Low},test(t){return os(t,"text/plain")||ts(t,".txt")},async load(t){return await(await V.ADAPTER.fetch(t)).text()}};we.add(ls);const cs=["normal","bold","100","200","300","400","500","600","700","800","900"],hs=[".ttf",".otf",".woff",".woff2"],us=["font/ttf","font/otf","font/woff","font/woff2"],ds=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,ps=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function fs(t){return ps.test(t)?t:encodeURI(t)}const ms={extension:{type:ve.LoadParser,priority:ss.Low},name:"loadWebFont",test(t){return os(t,us)||ts(t,hs)},async load(t,e){const n=V.ADAPTER.getFontFaceSet();if(n){const r=[],i=e.data?.family??function(t){const e=vt.extname(t),n=vt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1));let r=n.length>0;for(const t of n)if(!t.match(ds)){r=!1;break}let i=n.join(" ");return r||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}(t),s=e.data?.weights?.filter(t=>cs.includes(t))??["normal"],o=e.data??{};for(let e=0;e<s.length;e++){const a=s[e],l=new FontFace(i,`url(${fs(t)})`,{...o,weight:a});await l.load(),n.add(l),r.push(l)}return 1===r.length?r[0]:r}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(t=>V.ADAPTER.getFontFaceSet().delete(t))}};we.add(ms);let gs=null;class vs{constructor(){gs||(gs=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n  async function checkImageBitmap() {\n    try {\n      if (typeof createImageBitmap != "function")\n        return !1;\n      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);\n      return imageBitmap.width === 1 && imageBitmap.height === 1;\n    } catch {\n      return !1;\n    }\n  }\n  checkImageBitmap().then((result) => {\n    self.postMessage(result);\n  });\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(gs)}}vs.revokeObjectURL=function(){gs&&(URL.revokeObjectURL(gs),gs=null)};let ys=null;class xs{constructor(){ys||(ys=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  async function loadImageBitmap(url) {\n    const response = await fetch(url);\n    if (!response.ok)\n      throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n    const imageBlob = await response.blob();\n    return await createImageBitmap(imageBlob);\n  }\n  self.onmessage = async (event) => {\n    try {\n      const imageBitmap = await loadImageBitmap(event.data.data[0]);\n      self.postMessage({\n        data: imageBitmap,\n        uuid: event.data.uuid,\n        id: event.data.id\n      }, [imageBitmap]);\n    } catch (e) {\n      self.postMessage({\n        error: e,\n        uuid: event.data.uuid,\n        id: event.data.id\n      });\n    }\n  };\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(ys)}}xs.revokeObjectURL=function(){ys&&(URL.revokeObjectURL(ys),ys=null)};let ws,_s=0;const bs=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new vs;e.addEventListener("message",n=>{e.terminate(),vs.revokeObjectURL(),t(n.data)})})),this._isImageBitmapSupported}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===ws&&(ws=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<ws&&(this._createdWorkers++,t=(new xs).worker,t.addEventListener("message",t=>{this.complete(t.data),this.returnWorker(t.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){void 0!==t.error?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const n=new Promise((n,r)=>{this.queue.push({id:t,arguments:e,resolve:n,reject:r})});return this.next(),n}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),n=e.id;this.resolveHash[_s]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:_s++,id:n})}};function As(t,e,n){t.resource.internal=!0;const r=new Kn(t),i=()=>{delete e.promiseCache[n],ns.has(n)&&ns.remove(n)};return r.baseTexture.once("destroyed",()=>{n in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())}),r.once("destroyed",()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),r}const Ts=[".jpeg",".jpg",".png",".webp",".avif"],Ss=["image/jpeg","image/png","image/webp","image/avif"],Es={name:"loadTextures",extension:{type:ve.LoadParser,priority:ss.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return os(t,Ss)||ts(t,Ts)},async load(t,e,n){const r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;i=r?this.config.preferWorkers&&await bs.isImageBitmapSupported()?await bs.loadImageBitmap(t):await async function(t){const e=await V.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const n=await e.blob();return await createImageBitmap(n)}(t):await new Promise((e,n)=>{const r=new Image;r.crossOrigin=this.config.crossOrigin,r.src=t,r.complete?e(r):(r.onload=()=>e(r),r.onerror=t=>n(t))});const s={...e.data};s.resolution??(s.resolution=ge(t)),r&&void 0===s.resourceOptions?.ownsImageBitmap&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new Re(i,s);return o.resource.src=t,As(o,n,t)},unload(t){t.destroy(!0)}};we.add(Es);const ks={extension:{type:ve.LoadParser,priority:ss.High},name:"loadSVG",test(t){return os(t,"image/svg+xml")||ts(t,".svg")},async testParse(t){return mi.test(t)},async parse(t,e,n){const r=new mi(t,e?.data?.resourceOptions);await r.load();const i=new Re(r,{resolution:ge(t),...e?.data});return i.resource.src=e.src,As(i,n,e.src)},async load(t,e){return(await V.ADAPTER.fetch(t)).text()},unload:Es.unload};we.add(ks);const Ms=[".mp4",".m4v",".webm",".ogv"],Cs=["video/mp4","video/webm","video/ogg"],Ps={name:"loadVideo",extension:{type:ve.LoadParser,priority:ss.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(t){return os(t,Cs)||ts(t,Ms)},async load(t,e,n){let r;const i=await(await V.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const i={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...e?.data?.resourceOptions,autoLoad:!0},o=new vi(s,i);await o.load();const a=new Re(o,{alphaMode:await wt(),resolution:ge(t),...e?.data});a.resource.src=t,r=As(a,n,t),r.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(t){throw URL.revokeObjectURL(s),t}return r},unload(t){t.destroy(!0)}};function Is(t,e,n,r,i){const s=e[n];for(let o=0;o<s.length;o++){const a=s[o];n<e.length-1?Is(t.replace(r[n],a),e,n+1,r,i):i.push(t.replace(r[n],a))}}function Rs(t){const e=t.match(/\{(.*?)\}/g),n=[];if(e){const r=[];e.forEach(t=>{const e=t.substring(1,t.length-1).split(",");r.push(e)}),Is(t,r,0,e,n)}else n.push(t);return n}we.add(Ps);class Os{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if("string"==typeof t)this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}}getAlias(t){const{alias:e,name:n,src:r,srcs:i}=t;return es(e||n||r||i,t=>"string"==typeof t?t:Array.isArray(t)?t.map(t=>t?.src??t?.srcs??t):t?.src||t?.srcs?t.src??t.srcs:t,!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(t,e){const n=[];Array.isArray(e)?e.forEach(e=>{const r=e.src??e.srcs,i=e.alias??e.name;let s;if("string"==typeof i){const e=this._createBundleAssetId(t,i);n.push(e),s=[i,e]}else{const e=i.map(e=>this._createBundleAssetId(t,e));n.push(...e),s=[...i,...e]}this.add({...e,alias:s,src:r})}):Object.keys(e).forEach(r=>{const i=[r,this._createBundleAssetId(t,r)];if("string"==typeof e[r])this.add({alias:i,src:e[r]});else if(Array.isArray(e[r]))this.add({alias:i,src:e[r]});else{const t=e[r],n=t.src??t.srcs;this.add({...t,alias:i,src:Array.isArray(n)?n:[n]})}n.push(...i)}),this._bundles[t]=n}add(t,e,n,r,i){const s=[];let o;"string"==typeof t||Array.isArray(t)&&"string"==typeof t[0]?(ft("7.2.0","Assets.add now uses an object instead of individual parameters.\nPlease use Assets.add({ alias, src, data, format, loadParser }) instead."),s.push({alias:t,src:e,data:n,format:r,loadParser:i})):Array.isArray(t)?s.push(...t):s.push(t),o=t=>{this.hasKey(t)&&console.warn(`[Resolver] already has key: ${t} overwriting`)},es(s).forEach(t=>{const{src:e,srcs:n}=t;let{data:r,format:i,loadParser:s}=t;const a=es(e||n).map(t=>"string"==typeof t?Rs(t):Array.isArray(t)?t:[t]),l=this.getAlias(t);Array.isArray(l)?l.forEach(o):o(l);const c=[];a.forEach(t=>{t.forEach(t=>{let e={};if("object"!=typeof t){e.src=t;for(let n=0;n<this._parsers.length;n++){const r=this._parsers[n];if(r.test(t)){e=r.parse(t);break}}}else r=t.data??r,i=t.format??i,s=t.loadParser??s,e={...e,...t};if(!l)throw new Error(`[Resolver] alias is undefined for this asset: ${e.src}`);e=this.buildResolvedAsset(e,{aliases:l,data:r,format:i,loadParser:s}),c.push(e)})}),l.forEach(t=>{this._assetMap[t]=c})})}resolveBundle(t){const e=rs(t);t=es(t);const n={};return t.forEach(t=>{const e=this._bundles[t];if(e){const r=this.resolve(e),i={};for(const e in r){const n=r[e];i[this._extractAssetIdFromBundle(t,e)]=n}n[t]=i}}),e?n[t[0]]:n}resolveUrl(t){const e=this.resolve(t);if("string"!=typeof t){const t={};for(const n in e)t[n]=e[n].src;return t}return e.src}resolve(t){const e=rs(t);t=es(t);const n={};return t.forEach(t=>{if(!this._resolverHash[t])if(this._assetMap[t]){let e=this._assetMap[t];const n=e[0],r=this._getPreferredOrder(e);r?.priority.forEach(t=>{r.params[t].forEach(n=>{const r=e.filter(e=>!!e[t]&&e[t]===n);r.length&&(e=r)})}),this._resolverHash[t]=e[0]??n}else this._resolverHash[t]=this.buildResolvedAsset({alias:[t],src:t},{});n[t]=this._resolverHash[t]}),e?n[t[0]]:n}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const e=t[0],n=this._preferredOrder.find(t=>t.params.format.includes(e.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){return this._defaultSearchParams?`${t}${/\?/.test(t)?"&":"?"}${this._defaultSearchParams}`:t}buildResolvedAsset(t,e){const{aliases:n,data:r,loadParser:i,format:s}=e;return(this._basePath||this._rootPath)&&(t.src=vt.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=n??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=i??t.loadParser,t.format=s??t.format??vt.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}const Ds=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Os,this.loader=new is,this.cache=ns,this._backgroundLoader=new Ji(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized)return void console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let e=t.manifest;"string"==typeof e&&(e=await this.load(e)),this.resolver.addManifest(e)}const e=t.texturePreference?.resolution??1,n="number"==typeof e?[e]:e,r=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:n}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,n,r,i){this.resolver.add(t,e,n,r,i)}async load(t,e){this._initialized||await this.init();const n=rs(t),r=es(t).map(t=>{if("string"!=typeof t){const e=this.resolver.getAlias(t);return e.some(t=>!this.resolver.hasKey(t))&&this.add(t),Array.isArray(e)?e[0]:e}return this.resolver.hasKey(t)||this.add({alias:t,src:t}),t}),i=this.resolver.resolve(r),s=await this._mapLoadToResolve(i,e);return n?s[r[0]]:s}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let n=!1;"string"==typeof t&&(n=!0,t=[t]);const r=this.resolver.resolveBundle(t),i={},s=Object.keys(r);let o=0,a=0;const l=()=>{e?.(++o/a)},c=s.map(t=>{const e=r[t];return a+=Object.keys(e).length,this._mapLoadToResolve(e,l).then(e=>{i[t]=e})});return await Promise.all(c),n?i[t[0]]:i}async backgroundLoad(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(t=>{this._backgroundLoader.add(Object.values(t))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return ns.get(t);const e={};for(let n=0;n<t.length;n++)e[n]=ns.get(t[n]);return e}async _mapLoadToResolve(t,e){const n=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const i=await this.loader.load(n,e);this._backgroundLoader.active=!0;const s={};return n.forEach((t,e)=>{const n=i[t.src],o=[t.src];t.alias&&o.push(...t.alias),s[r[e]]=n,ns.set(o,n)}),s}async unload(t){this._initialized||await this.init();const e=es(t).map(t=>"string"!=typeof t?t.src:t),n=this.resolver.resolve(e);await this._unloadFromResolved(n)}async unloadBundle(t){this._initialized||await this.init(),t=es(t);const e=this.resolver.resolveBundle(t),n=Object.keys(e).map(t=>this._unloadFromResolved(e[t]));await Promise.all(n)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(t=>{ns.remove(t.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const n of t.detections)t.skipDetections||await n.test()?e=await n.add(e):t.skipDetections||(e=await n.remove(e));return e=e.filter((t,n)=>e.indexOf(t)===n),e}get detections(){return this._detections}get preferWorkers(){return Es.config.preferWorkers}set preferWorkers(t){ft("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(e=>e in t).forEach(n=>{e.config[n]=t[n]})})}};we.handleByList(ve.LoadParser,Ds.loader.parsers).handleByList(ve.ResolveParser,Ds.resolver.parsers).handleByList(ve.CacheParser,Ds.cache.parsers).handleByList(ve.DetectionParser,Ds.detections);const Ls={extension:ve.CacheParser,test:t=>Array.isArray(t)&&t.every(t=>t instanceof Kn),getCacheableAssets:(t,e)=>{const n={};return t.forEach(t=>{e.forEach((e,r)=>{n[t+(0===r?"":r+1)]=e})}),n}};async function Fs(t){if("Image"in globalThis)return new Promise(e=>{const n=new Image;n.onload=()=>{e(!0)},n.onerror=()=>{e(!1)},n.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}we.add(Ls);const Bs={extension:{type:ve.DetectionParser,priority:1},test:async()=>Fs("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(t=>"avif"!==t)};we.add(Bs);const Ns={extension:{type:ve.DetectionParser,priority:0},test:async()=>Fs("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(t=>"webp"!==t)};we.add(Ns);const Ws=["png","jpg","jpeg"],Us={extension:{type:ve.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...Ws],remove:async t=>t.filter(t=>!Ws.includes(t))};we.add(Us);const js="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Hs(t){return!js&&""!==document.createElement("video").canPlayType(t)}const zs={extension:{type:ve.DetectionParser,priority:0},test:async()=>Hs("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(t=>"webm"!==t)};we.add(zs);const Gs={extension:{type:ve.DetectionParser,priority:0},test:async()=>Hs("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(t=>"mp4"!==t&&"m4v"!==t)};we.add(Gs);const Xs={extension:{type:ve.DetectionParser,priority:0},test:async()=>Hs("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(t=>"ogv"!==t)};we.add(Xs);const Vs={extension:ve.ResolveParser,test:Es.test,parse:t=>({resolution:parseFloat(V.RETINA_PREFIX.exec(t)?.[1]??"1"),format:vt.extname(t).slice(1),src:t})};we.add(Vs);const Ys=(t,e)=>{const n=e.split("?")[1];return n&&(t+=`?${n}`),t};var $s=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))($s||{});const qs={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Ks,Zs;function Qs(){Zs={bptc:Ks.getExtension("EXT_texture_compression_bptc"),astc:Ks.getExtension("WEBGL_compressed_texture_astc"),etc:Ks.getExtension("WEBGL_compressed_texture_etc"),s3tc:Ks.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Ks.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Ks.getExtension("WEBGL_compressed_texture_pvrtc")||Ks.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Ks.getExtension("WEBGL_compressed_texture_etc1"),atc:Ks.getExtension("WEBGL_compressed_texture_atc")}}const Js={extension:{type:ve.DetectionParser,priority:2},test:async()=>{const t=V.ADAPTER.createCanvas().getContext("webgl");return t?(Ks=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{Zs||Qs();const e=[];for(const t in Zs)Zs[t]&&e.push(t);return[...e,...t]},remove:async t=>(Zs||Qs(),t.filter(t=>!(t in Zs)))};we.add(Js);class to extends Ce{constructor(t,e={width:1,height:1,autoLoad:!0}){let n,r;"string"==typeof t?(n=t,r=new Uint8Array):(n=null,r=t),super(r,e),this.origin=n,this.buffer=r?new _e(r):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==e.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load||(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new _e(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this))),this._load}}class eo extends to{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=eo._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||eo._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,n){const r=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;r.pixelStorei(r.UNPACK_ALIGNMENT,4);for(let t=0,e=this.levels;t<e;t++){const{levelID:e,levelWidth:n,levelHeight:i,levelBuffer:s}=this._levelBuffers[t];r.compressedTexImage2D(r.TEXTURE_2D,e,this.format,n,i,0,s)}return!0}onBlobLoaded(){this._levelBuffers=eo._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=35916&&t<=35919)return"s3tc_sRGB";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(36196===t)return"etc1";if(35986===t||35987===t||34798===t)return"atc";if(t>=36492&&t<=36495)return"bptc";if(37808===t)return"astc";throw new Error(`Invalid (compressed) texture format given: ${t}`)}static _createLevelBuffers(t,e,n,r,i,s,o){const a=new Array(n);let l=t.byteOffset,c=s,h=o,u=c+r-1&~(r-1),d=h+i-1&~(i-1),p=u*d*qs[e];for(let s=0;s<n;s++)a[s]={levelID:s,levelWidth:n>1?c:u,levelHeight:n>1?h:d,levelBuffer:new Uint8Array(t.buffer,l,p)},l+=p,c=c>>1||1,h=h>>1||1,u=c+r-1&~(r-1),d=h+i-1&~(i-1),p=u*d*qs[e];return a}}const no=827611204,ro=861165636,io=894720068,so={[no]:$s.COMPRESSED_RGBA_S3TC_DXT1_EXT,[ro]:$s.COMPRESSED_RGBA_S3TC_DXT3_EXT,[io]:$s.COMPRESSED_RGBA_S3TC_DXT5_EXT},oo={70:$s.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:$s.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:$s.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:$s.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:$s.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:$s.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:$s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:$s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:$s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:$s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:$s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:$s.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:$s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT},ao=[171,75,84,88,32,49,49,187,13,10,26,10],lo={[O.UNSIGNED_BYTE]:1,[O.UNSIGNED_SHORT]:2,[O.INT]:4,[O.UNSIGNED_INT]:4,[O.FLOAT]:4,[O.HALF_FLOAT]:8},co={[I.RGBA]:4,[I.RGB]:3,[I.RG]:2,[I.RED]:1,[I.LUMINANCE]:1,[I.LUMINANCE_ALPHA]:2,[I.ALPHA]:1},ho={[O.UNSIGNED_SHORT_4_4_4_4]:2,[O.UNSIGNED_SHORT_5_5_5_1]:2,[O.UNSIGNED_SHORT_5_6_5]:2};function uo(t){switch(t){case I.RGBA:return I.RGBA_INTEGER;case I.RGB:return I.RGB_INTEGER;case I.RG:return I.RG_INTEGER;case I.RED:return I.RED_INTEGER;default:return t}}const po={extension:{type:ve.LoadParser,priority:ss.High},name:"loadDDS",test(t){return ts(t,".dds")},async load(t,e,n){const r=function(t){const e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");const n=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),r=n[3],i=n[4],s=n[7],o=new Uint32Array(t,19*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),a=o[1];if(4&a){const n=o[2];if(808540228!==n){const e=so[n],o=new Uint8Array(t,128);return[new eo(o,{format:e,width:i,height:r,levels:s})]}const a=128,l=new Uint32Array(e.buffer,a,20/Uint32Array.BYTES_PER_ELEMENT),c=l[0],h=l[1],u=l[2],d=l[3],p=oo[c];if(void 0===p)throw new Error(`DDSParser cannot parse texture data with DXGI format ${c}`);if(4===u)throw new Error("DDSParser does not support cubemap textures");if(6===h)throw new Error("DDSParser does not supported 3D texture data");const f=new Array,m=148;if(1===d)f.push(new Uint8Array(t,m));else{const e=qs[p];let n=0,o=i,a=r;for(let t=0;t<s;t++)n+=Math.max(1,o+3&-4)*Math.max(1,a+3&-4)*e,o>>>=1,a>>>=1;let l=m;for(let e=0;e<d;e++)f.push(new Uint8Array(t,l,n)),l+=n}return f.map(t=>new eo(t,{format:p,width:i,height:r,levels:s}))}throw 64&a?new Error("DDSParser does not support uncompressed texture data."):512&a?new Error("DDSParser does not supported YUV uncompressed texture data."):131072&a?new Error("DDSParser does not support single-channel (lumninance) texture data!"):2&a?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}(await(await V.ADAPTER.fetch(t)).arrayBuffer()).map(r=>As(new Re(r,{mipmap:B.OFF,alphaMode:N.NO_PREMULTIPLIED_ALPHA,resolution:ge(t),...e.data}),n,t));return 1===r.length?r[0]:r},unload(t){Array.isArray(t)?t.forEach(t=>t.destroy(!0)):t.destroy(!0)}};we.add(po);const fo={extension:{type:ve.LoadParser,priority:ss.High},name:"loadKTX",test(t){return ts(t,".ktx")},async load(t,e,n){const r=await(await V.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=function(t,e,n=!1){const r=new DataView(e);if(!function(t,e){for(let n=0;n<ao.length;n++)if(e.getUint8(n)!==ao[n])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}(t,r))return null;const i=67305985===r.getUint32(12,!0),s=r.getUint32(16,i),o=r.getUint32(24,i),a=r.getUint32(28,i),l=r.getUint32(36,i),c=r.getUint32(40,i)||1,h=r.getUint32(44,i)||1,u=r.getUint32(48,i)||1,d=r.getUint32(52,i),p=r.getUint32(56,i),f=r.getUint32(60,i);if(0===c||1!==h)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==u)throw new Error("WebGL does not support array textures");const m=l+3&-4,g=c+3&-4,v=new Array(u);let y,x=l*c;if(0===s&&(x=m*g),y=0!==s?lo[s]?lo[s]*co[o]:ho[s]:qs[a],void 0===y)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const w=n?function(t,e,n){const r=new Map;let i=0;for(;i<e;){const s=t.getUint32(64+i,n),o=64+i+4,a=3-(s+3)%4;if(0===s||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&0!==t.getUint8(o+l);l++);if(-1===l){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const c=(new TextDecoder).decode(new Uint8Array(t.buffer,o,l)),h=new DataView(t.buffer,o+l+1,s-l-1);r.set(c,h),i+=4+s+a}return r}(r,f,i):null;let _=x*y,b=l,A=c,T=m,S=g,E=64+f;for(let t=0;t<p;t++){const n=r.getUint32(E,i);let o=E+4;for(let n=0;n<u;n++){let r=v[n];r||(r=v[n]=new Array(p)),r[t]={levelID:t,levelWidth:p>1||0!==s?b:T,levelHeight:p>1||0!==s?A:S,levelBuffer:new Uint8Array(e,o,_)},o+=_}E+=n+4,E=E%4!=0?E+4-E%4:E,b=b>>1||1,A=A>>1||1,T=b+4-1&-4,S=A+4-1&-4,_=T*S*y}return 0!==s?{uncompressed:v.map(t=>{let e=t[0].levelBuffer,n=!1;return s===O.FLOAT?e=new Float32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4):s===O.UNSIGNED_INT?(n=!0,e=new Uint32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)):s===O.INT&&(n=!0,e=new Int32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)),{resource:new Ce(e,{width:t[0].levelWidth,height:t[0].levelHeight}),type:s,format:n?uo(o):o}}),kvData:w}:{compressed:v.map(t=>new eo(null,{format:a,width:l,height:c,levels:p,levelBuffers:t})),kvData:w}}(t,r),a=i??s,l={mipmap:B.OFF,alphaMode:N.NO_PREMULTIPLIED_ALPHA,resolution:ge(t),...e.data},c=a.map(e=>{a===s&&Object.assign(l,{type:e.type,format:e.format});const r=e.resource??e,i=new Re(r,l);return i.ktxKeyValueData=o,As(i,n,t)});return 1===c.length?c[0]:c},unload(t){Array.isArray(t)?t.forEach(t=>t.destroy(!0)):t.destroy(!0)}};we.add(fo);const mo=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],go={extension:ve.ResolveParser,test:t=>{const e=vt.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{const e=t.split("."),n=e.pop();if(["ktx","dds"].includes(n)){const n=e.pop();if(mo.includes(n))return{resolution:parseFloat(V.RETINA_PREFIX.exec(t)?.[1]??"1"),format:n,src:t}}return{resolution:parseFloat(V.RETINA_PREFIX.exec(t)?.[1]??"1"),format:n,src:t}}};we.add(go);const vo=new qe,yo=class t{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){const t=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}async image(t,e,n,r){const i=new Image;return i.src=await this.base64(t,e,n,r),i}async base64(t,e,n,r){const i=this.canvas(t,r);if(void 0!==i.toBlob)return new Promise((t,r)=>{i.toBlob(e=>{if(!e)return void r(new Error("ICanvas.toBlob failed!"));const n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)},e,n)});if(void 0!==i.toDataURL)return i.toDataURL(e,n);if(void 0!==i.convertToBlob){const t=await i.convertToBlob({type:e,quality:n});return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=n,r.readAsDataURL(t)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,n){const{pixels:r,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,n);o&&t._flipY(r,i,s),a&&t._unpremultiplyAlpha(r);const l=new pe(i,s,1),c=new ImageData(new Uint8ClampedArray(r.buffer),i,s);return l.context.putImageData(c,0,0),l.canvas}pixels(e,n){const{pixels:r,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,n);return o&&t._flipY(r,i,s),a&&t._unpremultiplyAlpha(r),r}_rawPixels(t,e){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let r,i,s=!1,o=!1,a=!1;t&&(t instanceof Zn?i=t:(i=n.generateTexture(t,{region:e,resolution:n.resolution,multisample:n.multisample}),a=!0,e&&(vo.width=e.width,vo.height=e.height,e=vo)));const l=n.gl;if(i){if(r=i.baseTexture.resolution,e=e??i.frame,s=!1,o=i.baseTexture.alphaMode>0&&i.baseTexture.format===I.RGBA,!a){n.renderTexture.bind(i);const t=i.framebuffer.glFramebuffers[n.CONTEXT_UID];t.blitFramebuffer&&n.framebuffer.bind(t.blitFramebuffer)}}else r=n.resolution,e||((e=vo).width=n.width/r,e.height=n.height/r),s=!0,o=this._rendererPremultipliedAlpha,n.renderTexture.bind();const c=Math.max(Math.round(e.width*r),1),h=Math.max(Math.round(e.height*r),1),u=new Uint8Array(4*c*h);return l.readPixels(Math.round(e.x*r),Math.round(e.y*r),c,h,l.RGBA,l.UNSIGNED_BYTE,u),a&&i?.destroy(!0),{pixels:u,width:c,height:h,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(t,e,n){const r=e<<2,i=n>>1,s=new Uint8Array(r);for(let e=0;e<i;e++){const i=e*r,o=(n-e-1)*r;s.set(t.subarray(i,i+r)),t.copyWithin(i,o,o+r),t.set(s,o)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let n=0;n<e;n+=4){const e=t[n+3];if(0!==e){const r=255.001/e;t[n]=t[n]*r+.5,t[n+1]=t[n+1]*r+.5,t[n+2]=t[n+2]*r+.5}}}};yo.extension={name:"extract",type:ve.RendererSystem};let xo=yo;we.add(xo);const wo={build(t){const e=t.points;let n,r,i,s,o,a;if(t.type===Ve.CIRC){const e=t.shape;n=e.x,r=e.y,o=a=e.radius,i=s=0}else if(t.type===Ve.ELIP){const e=t.shape;n=e.x,r=e.y,o=e.width,a=e.height,i=s=0}else{const e=t.shape,l=e.width/2,c=e.height/2;n=e.x+l,r=e.y+c,o=a=Math.max(0,Math.min(e.radius,Math.min(l,c))),i=l-o,s=c-a}if(!(o>=0&&a>=0&&i>=0&&s>=0))return void(e.length=0);const l=Math.ceil(2.3*Math.sqrt(o+a)),c=8*l+(i?4:0)+(s?4:0);if(e.length=c,0===c)return;if(0===l)return e.length=8,e[0]=e[6]=n+i,e[1]=e[3]=r+s,e[2]=e[4]=n-i,void(e[5]=e[7]=r-s);let h=0,u=4*l+(i?2:0)+2,d=u,p=c;{const t=i+o,a=s,l=n+t,c=n-t,f=r+a;if(e[h++]=l,e[h++]=f,e[--u]=f,e[--u]=c,s){const t=r-a;e[d++]=c,e[d++]=t,e[--p]=t,e[--p]=l}}for(let t=1;t<l;t++){const c=Math.PI/2*(t/l),f=i+Math.cos(c)*o,m=s+Math.sin(c)*a,g=n+f,v=n-f,y=r+m,x=r-m;e[h++]=g,e[h++]=y,e[--u]=y,e[--u]=v,e[d++]=v,e[d++]=x,e[--p]=x,e[--p]=g}{const t=s+a,o=n+i,l=n-i,c=r+t,u=r-t;e[h++]=o,e[h++]=c,e[--p]=u,e[--p]=o,i&&(e[h++]=l,e[h++]=c,e[--p]=u,e[--p]=l)}},triangulate(t,e){const n=t.points,r=e.points,i=e.indices;if(0===n.length)return;let s=r.length/2;const o=s;let a,l;if(t.type!==Ve.RREC){const e=t.shape;a=e.x,l=e.y}else{const e=t.shape;a=e.x+e.width/2,l=e.y+e.height/2}const c=t.matrix;r.push(t.matrix?c.a*a+c.c*l+c.tx:a,t.matrix?c.b*a+c.d*l+c.ty:l),s++,r.push(n[0],n[1]);for(let t=2;t<n.length;t+=2)r.push(n[t],n[t+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function _o(t,e=!1){const n=t.length;if(n<6)return;let r=0;for(let e=0,i=t[n-2],s=t[n-1];e<n;e+=2){const n=t[e],o=t[e+1];r+=(n-i)*(o+s),i=n,s=o}if(!e&&r>0||e&&r<=0){const e=n/2;for(let r=e+e%2;r<n;r+=2){const e=n-r-2,i=n-r-1,s=r,o=r+1;[t[e],t[s]]=[t[s],t[e]],[t[i],t[o]]=[t[o],t[i]]}}}const bo={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let n=t.points;const r=t.holes,i=e.points,s=e.indices;if(n.length>=6){_o(n,!1);const t=[];for(let e=0;e<r.length;e++){const i=r[e];_o(i.points,!0),t.push(n.length/2),n=n.concat(i.points)}const e=dt(n,t,2);if(!e)return;const o=i.length/2;for(let t=0;t<e.length;t+=3)s.push(e[t]+o),s.push(e[t+1]+o),s.push(e[t+2]+o);for(let t=0;t<n.length;t++)i.push(n[t])}}},Ao={build(t){const e=t.shape,n=e.x,r=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(n,r,n+i,r,n+i,r+s,n,r+s)},triangulate(t,e){const n=t.points,r=e.points;if(0===n.length)return;const i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},To={build(t){wo.build(t)},triangulate(t,e){wo.triangulate(t,e)}};var So=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(So||{}),Eo=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(Eo||{});const ko={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}};class Mo{static curveTo(t,e,n,r,i,s){const o=s[s.length-2],a=s[s.length-1]-e,l=o-t,c=r-e,h=n-t,u=Math.abs(a*h-l*c);if(u<1e-8||0===i)return(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e),null;const d=a*a+l*l,p=c*c+h*h,f=a*c+l*h,m=i*Math.sqrt(d)/u,g=i*Math.sqrt(p)/u,v=m*f/d,y=g*f/p,x=m*h+g*l,w=m*c+g*a,_=l*(g+v),b=a*(g+v),A=h*(m+y),T=c*(m+y);return{cx:x+t,cy:w+e,radius:i,startAngle:Math.atan2(b-w,_-x),endAngle:Math.atan2(T-w,A-x),anticlockwise:l*c>h*a}}static arc(t,e,n,r,i,s,o,a,l){const c=o-s,h=ko._segmentsCount(Math.abs(c)*i,40*Math.ceil(Math.abs(c)/ze)),u=c/(2*h),d=2*u,p=Math.cos(u),f=Math.sin(u),m=h-1,g=m%1/m;for(let t=0;t<=m;++t){const e=u+s+d*(t+g*t),o=Math.cos(e),a=-Math.sin(e);l.push((p*o+f*a)*i+n,(p*-a+f*o)*i+r)}}}class Co{static curveLength(t,e,n,r,i,s,o,a){let l=0,c=0,h=0,u=0,d=0,p=0,f=0,m=0,g=0,v=0,y=0,x=t,w=e;for(let _=1;_<=10;++_)c=_/10,h=c*c,u=h*c,d=1-c,p=d*d,f=p*d,m=f*t+3*p*c*n+3*d*h*i+u*o,g=f*e+3*p*c*r+3*d*h*s+u*a,v=x-m,y=w-g,x=m,w=g,l+=Math.sqrt(v*v+y*y);return l}static curveTo(t,e,n,r,i,s,o){const a=o[o.length-2],l=o[o.length-1];o.length-=2;const c=ko._segmentsCount(Co.curveLength(a,l,t,e,n,r,i,s));let h=0,u=0,d=0,p=0,f=0;o.push(a,l);for(let m=1,g=0;m<=c;++m)g=m/c,h=1-g,u=h*h,d=u*h,p=g*g,f=p*g,o.push(d*a+3*u*g*t+3*h*p*n+f*i,d*l+3*u*g*e+3*h*p*r+f*s)}}function Po(t,e,n,r,i,s,o,a){let l,c;o?(l=r,c=-n):(l=-r,c=n);const h=t-n*i+l,u=e-r*i+c,d=t+n*s+l,p=e+r*s+c;return a.push(h,u,d,p),2}function Io(t,e,n,r,i,s,o,a){const l=n-t,c=r-e;let h=Math.atan2(l,c),u=Math.atan2(i-t,s-e);a&&h<u?h+=2*Math.PI:!a&&h>u&&(u+=2*Math.PI);let d=h;const p=u-h,f=Math.abs(p),m=Math.sqrt(l*l+c*c),g=1+(15*f*Math.sqrt(m)/Math.PI|0),v=p/g;if(d+=v,a){o.push(t,e,n,r);for(let n=1,r=d;n<g;n++,r+=v)o.push(t,e,t+Math.sin(r)*m,e+Math.cos(r)*m);o.push(t,e,i,s)}else{o.push(n,r,t,e);for(let n=1,r=d;n<g;n++,r+=v)o.push(t+Math.sin(r)*m,e+Math.cos(r)*m,t,e);o.push(i,s,t,e)}return 2*g}function Ro(t,e){t.lineStyle.native?function(t,e){let n=0;const r=t.shape,i=t.points||r.points,s=r.type!==Ve.POLY||r.closeStroke;if(0===i.length)return;const o=e.points,a=e.indices,l=i.length/2,c=o.length/2;let h=c;for(o.push(i[0],i[1]),n=1;n<l;n++)o.push(i[2*n],i[2*n+1]),a.push(h,h+1),h++;s&&a.push(h,c)}(t,e):function(t,e){const n=t.shape;let r=t.points||n.points.slice();const i=e.closePointEps;if(0===r.length)return;const s=t.lineStyle,o=new Ye(r[0],r[1]),a=new Ye(r[r.length-2],r[r.length-1]),l=n.type!==Ve.POLY||n.closeStroke,c=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){r=r.slice(),c&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));const t=.5*(o.x+a.x),e=.5*(a.y+o.y);r.unshift(t,e),r.push(t,e)}const h=e.points,u=r.length/2;let d=r.length;const p=h.length/2,f=s.width/2,m=f*f,g=s.miterLimit*s.miterLimit;let v=r[0],y=r[1],x=r[2],w=r[3],_=0,b=0,A=-(y-w),T=v-x,S=0,E=0,k=Math.sqrt(A*A+T*T);A/=k,T/=k,A*=f,T*=f;const M=s.alignment,C=2*(1-M),P=2*M;l||(s.cap===Eo.ROUND?d+=Io(v-A*(C-P)*.5,y-T*(C-P)*.5,v-A*C,y-T*C,v+A*P,y+T*P,h,!0)+2:s.cap===Eo.SQUARE&&(d+=Po(v,y,A,T,C,P,!0,h))),h.push(v-A*C,y-T*C,v+A*P,y+T*P);for(let t=1;t<u-1;++t){v=r[2*(t-1)],y=r[2*(t-1)+1],x=r[2*t],w=r[2*t+1],_=r[2*(t+1)],b=r[2*(t+1)+1],A=-(y-w),T=v-x,k=Math.sqrt(A*A+T*T),A/=k,T/=k,A*=f,T*=f,S=-(w-b),E=x-_,k=Math.sqrt(S*S+E*E),S/=k,E/=k,S*=f,E*=f;const e=x-v,n=y-w,i=x-_,o=b-w,a=e*i+n*o,l=n*i-o*e,c=l<0;if(Math.abs(l)<.001*Math.abs(a)){h.push(x-A*C,w-T*C,x+A*P,w+T*P),a>=0&&(s.join===So.ROUND?d+=Io(x,w,x-A*C,w-T*C,x-S*C,w-E*C,h,!1)+4:d+=2,h.push(x-S*P,w-E*P,x+S*C,w+E*C));continue}const u=(-A+v)*(-T+w)-(-A+x)*(-T+y),p=(-S+_)*(-E+w)-(-S+x)*(-E+b),M=(e*p-i*u)/l,I=(o*u-n*p)/l,R=(M-x)*(M-x)+(I-w)*(I-w),O=x+(M-x)*C,D=w+(I-w)*C,L=x-(M-x)*P,F=w-(I-w)*P,B=c?C:P,N=R<=Math.min(e*e+n*n,i*i+o*o)+B*B*m;let W=s.join;if(W===So.MITER&&R/m>g&&(W=So.BEVEL),N)switch(W){case So.MITER:h.push(O,D,L,F);break;case So.BEVEL:c?h.push(O,D,x+A*P,w+T*P,O,D,x+S*P,w+E*P):h.push(x-A*C,w-T*C,L,F,x-S*C,w-E*C,L,F),d+=2;break;case So.ROUND:c?(h.push(O,D,x+A*P,w+T*P),d+=Io(x,w,x+A*P,w+T*P,x+S*P,w+E*P,h,!0)+4,h.push(O,D,x+S*P,w+E*P)):(h.push(x-A*C,w-T*C,L,F),d+=Io(x,w,x-A*C,w-T*C,x-S*C,w-E*C,h,!1)+4,h.push(x-S*C,w-E*C,L,F))}else{switch(h.push(x-A*C,w-T*C,x+A*P,w+T*P),W){case So.MITER:c?h.push(L,F,L,F):h.push(O,D,O,D),d+=2;break;case So.ROUND:d+=c?Io(x,w,x+A*P,w+T*P,x+S*P,w+E*P,h,!0)+2:Io(x,w,x-A*C,w-T*C,x-S*C,w-E*C,h,!1)+2}h.push(x-S*C,w-E*C,x+S*P,w+E*P),d+=2}}v=r[2*(u-2)],y=r[2*(u-2)+1],x=r[2*(u-1)],w=r[2*(u-1)+1],A=-(y-w),T=v-x,k=Math.sqrt(A*A+T*T),A/=k,T/=k,A*=f,T*=f,h.push(x-A*C,w-T*C,x+A*P,w+T*P),l||(s.cap===Eo.ROUND?d+=Io(x-A*(C-P)*.5,w-T*(C-P)*.5,x-A*C,w-T*C,x+A*P,w+T*P,h,!1)+2:s.cap===Eo.SQUARE&&(d+=Po(x,w,A,T,C,P,!1,h)));const I=e.indices,R=ko.epsilon*ko.epsilon;for(let t=p;t<d+p-2;++t)v=h[2*t],y=h[2*t+1],x=h[2*(t+1)],w=h[2*(t+1)+1],_=h[2*(t+2)],b=h[2*(t+2)+1],!(Math.abs(v*(w-b)+x*(b-y)+_*(y-w))<R)&&I.push(t,t+1,t+2)}(t,e)}class Oo{static curveLength(t,e,n,r,i,s){const o=t-2*n+i,a=e-2*r+s,l=2*n-2*t,c=2*r-2*e,h=4*(o*o+a*a),u=4*(o*l+a*c),d=l*l+c*c,p=2*Math.sqrt(h+u+d),f=Math.sqrt(h),m=2*h*f,g=2*Math.sqrt(d),v=u/f;return(m*p+f*u*(p-g)+(4*d*h-u*u)*Math.log((2*f+v+p)/(v+g)))/(4*m)}static curveTo(t,e,n,r,i){const s=i[i.length-2],o=i[i.length-1],a=ko._segmentsCount(Oo.curveLength(s,o,t,e,n,r));let l=0,c=0;for(let h=1;h<=a;++h){const u=h/a;l=s+(t-s)*u,c=o+(e-o)*u,i.push(l+(t+(n-t)*u-l)*u,c+(e+(r-e)*u-c)*u)}}}const Do={[Ve.POLY]:bo,[Ve.CIRC]:wo,[Ve.ELIP]:wo,[Ve.RECT]:Ao,[Ve.RREC]:To},Lo=[],Fo=[];class Bo{constructor(t,e=null,n=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new Bo(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}class No{constructor(){this.reset()}begin(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}const Wo=new Ye,Uo=class t extends He{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new yi,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Fo.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),Lo.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,n=null,r=null){const i=new Bo(t,e,n,r);return this.graphicsData.push(i),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const n=new Bo(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let n=0;n<e.length;++n){const r=e[n];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(t,Wo):Wo.copyFrom(t),r.shape.contains(Wo.x,Wo.y))){let t=!1;if(r.holes)for(let e=0;e<r.holes.length;e++)if(r.holes[e].shape.contains(Wo.x,Wo.y)){t=!0;break}if(!t)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let n=null,r=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],r=n.style);for(let i=this.shapeIndex;i<e.length;i++){this.shapeIndex++;const s=e[i],o=s.fillStyle,a=s.lineStyle;Do[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix),(o.visible||a.visible)&&this.processHoles(s.holes);for(let e=0;e<2;e++){const i=0===e?o:a;if(!i.visible)continue;const l=i.texture.baseTexture,c=this.indices.length,h=this.points.length/2;l.wrapMode=F.REPEAT,0===e?this.processFill(s):this.processLine(s);const u=this.points.length/2-h;0!==u&&(n&&!this._compareStyles(r,i)&&(n.end(c,h),n=null),n||(n=Lo.pop()||new No,n.begin(i,c,h),this.batches.push(n),r=i),this.addUvs(this.points,t,i.texture,h,u,i.matrix))}}const i=this.indices.length,s=this.points.length/2;if(n&&n.end(i,s),0===this.batches.length)return void(this.batchable=!0);const o=s>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const e=this.graphicsData[t],n=e.fillStyle,r=e.lineStyle;if(n&&!n.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,n=t.length;e<n;e++){const n=t[e];for(let t=0;t<n.size;t++){const e=n.start+t;this.indicesUint16[e]=this.indicesUint16[e]-n.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<2*t.BATCHABLE_SIZE}buildDrawCalls(){let t=++Re._globalBatch;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Fo.push(this.drawCalls[t]);this.drawCalls.length=0;const e=this.colors,n=this.textureIds;let r=Fo.pop();r||(r=new Oe,r.texArray=new On),r.texArray.count=0,r.start=0,r.size=0,r.type=P.TRIANGLES;let i=0,s=null,o=0,a=!1,l=P.TRIANGLES,c=0;this.drawCalls.push(r);for(let h=0;h<this.batches.length;h++){const u=this.batches[h],d=8,p=u.style,f=p.texture.baseTexture;a!==!!p.native&&(a=!!p.native,l=a?P.LINES:P.TRIANGLES,s=null,i=d,t++),s!==f&&(s=f,f._batchEnabled!==t&&(i===d&&(t++,i=0,r.size>0&&(r=Fo.pop(),r||(r=new Oe,r.texArray=new On),this.drawCalls.push(r)),r.start=c,r.size=0,r.texArray.count=0,r.type=l),f.touched=1,f._batchEnabled=t,f._batchLocation=i,f.wrapMode=F.REPEAT,r.texArray.elements[r.texArray.count++]=f,i++)),r.size+=u.size,c+=u.size,o=f._batchLocation,this.addColors(e,p.color,p.alpha,u.attribSize,u.attribStart),this.addTextureIds(n,o,u.attribSize,u.attribStart)}Re._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(3*t.length*4),s=new Float32Array(i),o=new Uint32Array(i);let a=0;for(let i=0;i<t.length/2;i++)s[a++]=t[2*i],s[a++]=t[2*i+1],s[a++]=e[2*i],s[a++]=e[2*i+1],o[a++]=n[i],s[a++]=r[i];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?bo.triangulate(t,this):Do[t.type].triangulate(t,this)}processLine(t){Ro(t,this);for(let e=0;e<t.holes.length;e++)Ro(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const n=t[e];Do[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let n=0;n<t.length/2;n++){const r=t[2*n],i=t[2*n+1];t[2*n]=e.a*r+e.c*i+e.tx,t[2*n+1]=e.b*r+e.d*i+e.ty}}addColors(t,e,n,r,i=0){const s=qt.shared.setValue(e).toLittleEndianNumber(),o=qt.shared.setValue(s).toPremultiplied(n);t.length=Math.max(t.length,i+r);for(let e=0;e<r;e++)t[i+e]=o}addTextureIds(t,e,n,r=0){t.length=Math.max(t.length,r+n);for(let i=0;i<n;i++)t[r+i]=e}addUvs(t,e,n,r,i,s=null){let o=0;const a=e.length,l=n.frame;for(;o<i;){let n=t[2*(r+o)],i=t[2*(r+o)+1];if(s){const t=s.a*n+s.c*i+s.tx;i=s.b*n+s.d*i+s.ty,n=t}o++,e.push(n/l.width,i/l.height)}const c=n.baseTexture;(l.width<c.width||l.height<c.height)&&this.adjustUvs(e,n,a,i)}adjustUvs(t,e,n,r){const i=e.baseTexture,s=1e-6,o=n+2*r,a=e.frame,l=a.width/i.width,c=a.height/i.height;let h=a.x/a.width,u=a.y/a.height,d=Math.floor(t[n]+s),p=Math.floor(t[n+1]+s);for(let e=n+2;e<o;e+=2)d=Math.min(d,Math.floor(t[e]+s)),p=Math.min(p,Math.floor(t[e+1]+s));h-=d,u-=p;for(let e=n;e<o;e+=2)t[e]=(t[e]+h)*l,t[e+1]=(t[e+1]+u)*c}};Uo.BATCHABLE_SIZE=100;let jo=Uo;class Ho{constructor(){this.color=16777215,this.alpha=1,this.texture=Kn.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Ho;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=Kn.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class zo extends Ho{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Eo.BUTT,this.join=So.MITER,this.miterLimit=10}clone(){const t=new zo;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Eo.BUTT,this.join=So.MITER,this.miterLimit=10}}const Go={},Xo=class t extends Ti{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Ho,this._lineStyle=new zo,this._matrix=null,this._holeMode=!1,this.state=Te.for2d(),this._geometry=t||new jo,this._geometry.refCount++,this._transformID=-1,this._tintColor=new qt(16777215),this.blendMode=C.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new t(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,n,r=.5,i=!1){return"number"==typeof t&&(t={width:t,color:e,alpha:n,alignment:r,native:i}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:Kn.WHITE,color:t?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Eo.BUTT,join:So.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.width>0&&t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:n},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Qe,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Qe,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return(r!==t||i!==e)&&n.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,n,r){this._initCurve();const i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),Oo.curveTo(t,e,n,r,i),this}bezierCurveTo(t,e,n,r,i,s){return this._initCurve(),Co.curveTo(t,e,n,r,i,s,this.currentPath.points),this}arcTo(t,e,n,r,i){this._initCurve(t,e);const s=this.currentPath.points,o=Mo.curveTo(t,e,n,r,i,s);if(o){const{cx:t,cy:e,radius:n,startAngle:r,endAngle:i,anticlockwise:s}=o;this.arc(t,e,n,r,i,s)}return this}arc(t,e,n,r,i,s=!1){if(r===i)return this;if(!s&&i<=r?i+=ze:s&&r<=i&&(r+=ze),i-r===0)return this;const o=t+Math.cos(r)*n,a=e+Math.sin(r)*n,l=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const t=Math.abs(c[c.length-2]-o),e=Math.abs(c[c.length-1]-a);t<l&&e<l||c.push(o,a)}else this.moveTo(o,a),c=this.currentPath.points;return Mo.arc(o,a,t,e,n,r,i,s,c),this}beginFill(t=0,e){return this.beginTextureFill({texture:Kn.WHITE,color:t,alpha:e})}normalizeColor(t){const e=qt.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:Kn.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:n},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,n,r){return this.drawShape(new qe(t,e,n,r))}drawRoundedRect(t,e,n,r,i){return this.drawShape(new Je(t,e,n,r,i))}drawCircle(t,e,n){return this.drawShape(new Ke(t,e,n))}drawEllipse(t,e,n,r){return this.drawShape(new Ze(t,e,n,r))}drawPolygon(...t){let e,n=!0;const r=t[0];r.points?(n=r.closeStroke,e=r.points):e=Array.isArray(t[0])?t[0]:t;const i=new Qe(e);return i.closeStroke=n,this.drawShape(i),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==Ve.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(let r=0;r<n;r++){const n=t.batches[r],i=n.style.color,s=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),o=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),a={vertexData:s,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:o,_batchRGB:qt.shared.setValue(i).toRgbArray(),_tintRGB:i,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=a}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,n=this.batches.length;e<n;e++){const n=this.batches[e];n.worldAlpha=this.worldAlpha*n.alpha,t.plugins[this.pluginName].render(n)}}}_renderDirect(t){const e=this._resolveDirectShader(t),n=this._geometry,r=this.worldAlpha,i=e.uniforms,s=n.drawCalls;i.translationMatrix=this.transform.worldTransform,qt.shared.setValue(this._tintColor).premultiply(r).toArray(i.tint),t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(let e=0,r=s.length;e<r;e++)this._renderDrawCallDirect(t,n.drawCalls[e])}_renderDrawCallDirect(t,e){const{texArray:n,type:r,size:i,start:s}=e,o=n.count;for(let e=0;e<o;e++)t.texture.bind(n.elements[e],e);t.geometry.draw(r,i,s)}_resolveDirectShader(t){let e=this.shader;const n=this.pluginName;if(!e){if(!Go[n]){const{maxTextures:e}=t.plugins[n],r=new Int32Array(e);for(let t=0;t<e;t++)r[t]=t;const i={tint:new Float32Array([1,1,1,1]),translationMatrix:new tn,default:Pn.from({uSamplers:r},!0)},s=t.plugins[n]._shader.program;Go[n]=new In(s,i)}e=Go[n]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:n,maxX:r,maxY:i}=t.bounds;this._bounds.addFrame(this.transform,e,n,r,i)}containsPoint(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=qt.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty,l=this._geometry.points,c=this.vertexData;let h=0;for(let t=0;t<l.length;t+=2){const e=l[t],u=l[t+1];c[h++]=n*e+i*u+o,c[h++]=s*u+r*e+a}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};Xo.curves=ko,Xo._TEMP_POINT=new Ye;let Vo=Xo;class Yo{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const $o=new Ye,qo=new Qe,Ko=class t extends Ti{constructor(t,e,n,r=P.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=n||Te.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=V.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(e){const n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===P.TRIANGLES&&n.length<2*t.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const r=this.transform.worldTransform,i=r.a,s=r.b,o=r.c,a=r.d,l=r.tx,c=r.ty,h=this.vertexData;for(let t=0;t<h.length/2;t++){const n=e[2*t],r=e[2*t+1];h[2*t]=i*n+o*r+l,h[2*t+1]=s*n+a*r+c}if(this._roundPixels){const t=V.RESOLUTION;for(let e=0;e<h.length;++e)h[e]=Math.round(h[e]*t)/t}this.vertexDirty=n}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Yo(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,$o);const e=this.geometry.getBuffer("aVertexPosition").data,n=qo.points,r=this.geometry.getIndex().data,i=r.length,s=4===this.drawMode?3:1;for(let t=0;t+2<i;t+=s){const i=2*r[t],s=2*r[t+1],o=2*r[t+2];if(n[0]=e[i],n[1]=e[i+1],n[2]=e[s],n[3]=e[s+1],n[4]=e[o],n[5]=e[o+1],qo.contains($o.x,$o.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};Ko.BATCHABLE_SIZE=100;let Zo=Ko;class Qo extends je{constructor(t,e,n){super();const r=new Le(t),i=new Le(e,!0),s=new Le(n,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,O.FLOAT).addAttribute("aTextureCoord",i,2,!1,O.FLOAT).addIndex(s),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}class Jo extends In{constructor(t,e){const n={uSampler:t,alpha:1,uTextureMatrix:tn.IDENTITY,uColor:new Float32Array([1,1,1,1])};(e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e)).uniforms&&Object.assign(n,e.uniforms),super(e.program||Mn.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),n),this._colorDirty=!1,this.uvMatrix=new ur(t),this.batchable=void 0===e.program,this.pluginName=e.pluginName,this._tintColor=new qt(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;qt.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class ta extends Zo{constructor(t=Kn.EMPTY,e,n,r,i){const s=new Qo(e,n,r);s.getBuffer("aVertexPosition").static=!1,super(s,new Jo(t),null,i),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class ea extends Ti{constructor(t=1500,e,n=16384,r=!1){super(),n>16384&&(n=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=n,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=C.NORMAL,this.autoResize=r,this.roundPixels=!0,this.baseTexture=null,this.setProperties(e),this._tintColor=new qt(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintColor.toRgbArray(this.tintRgb)}render(t){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}onChildrenChange(t){const e=Math.floor(t/this._batchSize);for(;this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID}dispose(){if(this._buffers){for(let t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}destroy(t){super.destroy(t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class na{constructor(t,e,n){this.geometry=new je,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<t.length;++n){let r=t[n];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||O.FLOAT,offset:r.offset},e[n]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Le(function(t,e=null){const n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${n}`);for(let t=0,r=0;t<n;t+=6,r+=4)e[t+0]=r+0,e[t+1]=r+1,e[t+2]=r+2,e[t+3]=r+0,e[t+4]=r+2,e[t+5]=r+3;return e}(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let t=0;t<this.dynamicProperties.length;++t){const n=this.dynamicProperties[t];n.offset=e,e+=n.size,this.dynamicStride+=n.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Le(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let t=0;t<this.staticProperties.length;++t){const e=this.staticProperties[t];e.offset=r,r+=e.size,this.staticStride+=e.size}const i=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(i),this.staticDataUint32=new Uint32Array(i),this.staticBuffer=new Le(this.staticData,!0,!1);for(let e=0;e<this.dynamicProperties.length;++e){const n=this.dynamicProperties[e];t.addAttribute(n.attributeName,this.dynamicBuffer,0,n.type===O.UNSIGNED_BYTE,n.type,4*this.dynamicStride,4*n.offset)}for(let e=0;e<this.staticProperties.length;++e){const n=this.staticProperties[e];t.addAttribute(n.attributeName,this.staticBuffer,0,n.type===O.UNSIGNED_BYTE,n.type,4*this.staticStride,4*n.offset)}}uploadDynamic(t,e,n){for(let r=0;r<this.dynamicProperties.length;r++){const i=this.dynamicProperties[r];i.uploadFunction(t,e,n,i.type===O.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,n){for(let r=0;r<this.staticProperties.length;r++){const i=this.staticProperties[r];i.uploadFunction(t,e,n,i.type===O.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}class ra extends Dn{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new tn,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:O.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=In.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=Te.for2d()}render(t){const e=t.children,n=t._maxSize,r=t._batchSize,i=this.renderer;let s=e.length;if(0===s)return;s>n&&!t.autoResize&&(s=n);let o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));const a=e[0]._texture.baseTexture,l=a.alphaMode>0;this.state.blendMode=Jt(t.blendMode,l),i.state.set(this.state);const c=i.gl,h=t.worldTransform.copyTo(this.tempMatrix);h.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=qt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);let u=!1;for(let n=0,a=0;n<s;n+=r,a+=1){let l=s-n;l>r&&(l=r),a>=o.length&&o.push(this._generateOneMoreBuffer(t));const h=o[a];h.uploadDynamic(e,n,l);const d=t._bufferUpdateIDs[a]||0;u=u||h._updateID<d,u&&(h._updateID=t._updateID,h.uploadStatic(e,n,l)),i.geometry.bind(h.geometry),c.drawElements(c.TRIANGLES,6*l,c.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],n=t._maxSize,r=t._batchSize,i=t._properties;for(let t=0;t<n;t+=r)e.push(new na(this.properties,i,r));return e}_generateOneMoreBuffer(t){const e=t._batchSize,n=t._properties;return new na(this.properties,n,e)}uploadVertices(t,e,n,r,i,s){let o=0,a=0,l=0,c=0;for(let h=0;h<n;++h){const n=t[e+h],u=n._texture,d=n.scale.x,p=n.scale.y,f=u.trim,m=u.orig;f?(a=f.x-n.anchor.x*m.width,o=a+f.width,c=f.y-n.anchor.y*m.height,l=c+f.height):(o=m.width*(1-n.anchor.x),a=m.width*-n.anchor.x,l=m.height*(1-n.anchor.y),c=m.height*-n.anchor.y),r[s]=a*d,r[s+1]=c*p,r[s+i]=o*d,r[s+i+1]=c*p,r[s+2*i]=o*d,r[s+2*i+1]=l*p,r[s+3*i]=a*d,r[s+3*i+1]=l*p,s+=4*i}}uploadPosition(t,e,n,r,i,s){for(let o=0;o<n;o++){const n=t[e+o].position;r[s]=n.x,r[s+1]=n.y,r[s+i]=n.x,r[s+i+1]=n.y,r[s+2*i]=n.x,r[s+2*i+1]=n.y,r[s+3*i]=n.x,r[s+3*i+1]=n.y,s+=4*i}}uploadRotation(t,e,n,r,i,s){for(let o=0;o<n;o++){const n=t[e+o].rotation;r[s]=n,r[s+i]=n,r[s+2*i]=n,r[s+3*i]=n,s+=4*i}}uploadUvs(t,e,n,r,i,s){for(let o=0;o<n;++o){const n=t[e+o]._texture._uvs;n?(r[s]=n.x0,r[s+1]=n.y0,r[s+i]=n.x1,r[s+i+1]=n.y1,r[s+2*i]=n.x2,r[s+2*i+1]=n.y2,r[s+3*i]=n.x3,r[s+3*i+1]=n.y3,s+=4*i):(r[s]=0,r[s+1]=0,r[s+i]=0,r[s+i+1]=0,r[s+2*i]=0,r[s+2*i+1]=0,r[s+3*i]=0,r[s+3*i+1]=0,s+=4*i)}}uploadTint(t,e,n,r,i,s){for(let o=0;o<n;++o){const n=t[e+o],a=qt.shared.setValue(n._tintRGB).toPremultiplied(n.alpha,n.texture.baseTexture.alphaMode>0);r[s]=a,r[s+i]=a,r[s+2*i]=a,r[s+3*i]=a,s+=4*i}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}ra.extension={name:"particle",type:ve.RendererPlugin},we.add(ra);var ia=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(ia||{});const sa={willReadFrequently:!0},oa=class t{static get experimentalLetterSpacingSupported(){let e=t._experimentalLetterSpacingSupported;if(void 0!==e){const n=V.ADAPTER.getCanvasRenderingContext2D().prototype;e=t._experimentalLetterSpacingSupported="letterSpacing"in n||"textLetterSpacing"in n}return e}constructor(t,e,n,r,i,s,o,a,l){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=i,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=l}static measureText(e,n,r,i=t._canvas){r=r??n.wordWrap;const s=n.toFontString(),o=t.measureFont(s);0===o.fontSize&&(o.fontSize=n.fontSize,o.ascent=n.fontSize);const a=i.getContext("2d",sa);a.font=s;const l=(r?t.wordWrap(e,n,i):e).split(/(?:\r\n|\r|\n)/),c=new Array(l.length);let h=0;for(let e=0;e<l.length;e++){const r=t._measureText(l[e],n.letterSpacing,a);c[e]=r,h=Math.max(h,r)}let u=h+n.strokeThickness;n.dropShadow&&(u+=n.dropShadowDistance);const d=n.lineHeight||o.fontSize+n.strokeThickness;let p=Math.max(d,o.fontSize+2*n.strokeThickness)+n.leading+(l.length-1)*(d+n.leading);return n.dropShadow&&(p+=n.dropShadowDistance),new t(e,n,u,p,l,c,d+n.leading,h,o)}static _measureText(e,n,r){let i=!1;t.experimentalLetterSpacingSupported&&(t.experimentalLetterSpacing?(r.letterSpacing=`${n}px`,r.textLetterSpacing=`${n}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let s=r.measureText(e).width;return s>0&&(i?s-=n:s+=(t.graphemeSegmenter(e).length-1)*n),s}static wordWrap(e,n,r=t._canvas){const i=r.getContext("2d",sa);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:c,whiteSpace:h}=n,u=t.collapseSpaces(h),d=t.collapseNewlines(h);let p=!u;const f=n.wordWrapWidth+c,m=t.tokenize(e);for(let e=0;e<m.length;e++){let r=m[e];if(t.isNewline(r)){if(!d){a+=t.addLine(o),p=!u,o="",s=0;continue}r=" "}if(u){const e=t.isBreakingSpace(r),n=t.isBreakingSpace(o[o.length-1]);if(e&&n)continue}const h=t.getFromCache(r,c,l,i);if(h>f)if(""!==o&&(a+=t.addLine(o),o="",s=0),t.canBreakWords(r,n.breakWords)){const e=t.wordWrapSplit(r);for(let h=0;h<e.length;h++){let u=e[h],d=u,m=1;for(;e[h+m];){const i=e[h+m];if(t.canBreakChars(d,i,r,h,n.breakWords))break;u+=i,d=i,m++}h+=m-1;const g=t.getFromCache(u,c,l,i);g+s>f&&(a+=t.addLine(o),p=!1,o="",s=0),o+=u,s+=g}}else{o.length>0&&(a+=t.addLine(o),o="",s=0);const n=e===m.length-1;a+=t.addLine(r,!n),p=!1,o="",s=0}else h+s>f&&(p=!1,a+=t.addLine(o),o="",s=0),(o.length>0||!t.isBreakingSpace(r)||p)&&(o+=r,s+=h)}return a+=t.addLine(o,!1),a}static addLine(e,n=!0){return e=t.trimRight(e),n?`${e}\n`:e}static getFromCache(e,n,r,i){let s=r[e];return"number"!=typeof s&&(s=t._measureText(e,n,i)+n,r[e]=s),s}static collapseSpaces(t){return"normal"===t||"pre-line"===t}static collapseNewlines(t){return"normal"===t}static trimRight(e){if("string"!=typeof e)return"";for(let n=e.length-1;n>=0;n--){const r=e[n];if(!t.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static isNewline(e){return"string"==typeof e&&t._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,n){return"string"==typeof e&&t._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const n=[];let r="";if("string"!=typeof e)return n;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];t.isBreakingSpace(s,o)||t.isNewline(s)?(""!==r&&(n.push(r),r=""),n.push(s)):r+=s}return""!==r&&n.push(r),n}static canBreakWords(t,e){return e}static canBreakChars(t,e,n,r,i){return!0}static wordWrapSplit(e){return t.graphemeSegmenter(e)}static measureFont(e){if(t._fonts[e])return t._fonts[e];const n={ascent:0,descent:0,fontSize:0},r=t._canvas,i=t._context;i.font=e;const s=t.METRICS_STRING+t.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let a=Math.ceil(i.measureText(t.BASELINE_SYMBOL).width);const l=Math.ceil(t.HEIGHT_MULTIPLIER*a);if(a=a*t.BASELINE_MULTIPLIER|0,0===o||0===l)return t._fonts[e]=n,n;r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);const c=i.getImageData(0,0,o,l).data,h=c.length,u=4*o;let d=0,p=0,f=!1;for(d=0;d<a;++d){for(let t=0;t<u;t+=4)if(255!==c[p+t]){f=!0;break}if(f)break;p+=u}for(n.ascent=a-d,p=h-u,f=!1,d=l;d>a;--d){for(let t=0;t<u;t+=4)if(255!==c[p+t]){f=!0;break}if(f)break;p-=u}return n.descent=d-a,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n}static clearMetrics(e=""){e?delete t._fonts[e]:t._fonts={}}static get _canvas(){if(!t.__canvas){let e;try{const n=new OffscreenCanvas(0,0);if(n.getContext("2d",sa)?.measureText)return t.__canvas=n,n;e=V.ADAPTER.createCanvas()}catch{e=V.ADAPTER.createCanvas()}e.width=e.height=10,t.__canvas=e}return t.__canvas}static get _context(){return t.__context||(t.__context=t._canvas.getContext("2d",sa)),t.__context}};oa.METRICS_STRING="|q",oa.BASELINE_SYMBOL="M",oa.BASELINE_MULTIPLIER=1.4,oa.HEIGHT_MULTIPLIER=2,oa.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(t=>t.segment)}return t=>[...t]})(),oa.experimentalLetterSpacing=!1,oa._fonts={},oa._newlines=[10,13],oa._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let aa=oa;const la=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ca=class t{constructor(t){this.styleID=0,this.reset(),da(this,t,t)}clone(){const e={};return da(e,this,t.defaultStyle),new t(e)}reset(){da(this,t.defaultStyle,t.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=ua(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=ua(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=ua(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let t=e.length-1;t>=0;t--){let n=e[t].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!la.includes(n)&&(n=`"${n}"`),e[t]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};ca.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:ia.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let ha=ca;function ua(t){const e=qt.shared,n=t=>{const n=e.setValue(t);return 1===n.alpha?n.toHex():n.toRgbaString()};return Array.isArray(t)?t.map(n):n(t)}function da(t,e,n){for(const r in n)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}const pa={texture:!0,children:!1,baseTexture:!0},fa=class t extends ki{constructor(e,n,r){let i=!1;r||(r=V.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;const s=Kn.from(r);s.orig=new qe,s.trim=new qe,super(s),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=t.defaultResolution??V.RESOLUTION,this._autoResolution=t.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=n,this.localStyleID=-1}static get experimentalLetterSpacing(){return aa.experimentalLetterSpacing}static set experimentalLetterSpacing(t){ft("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),aa.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const n=this.context,r=aa.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=r.width,s=r.height,o=r.lines,a=r.lineHeight,l=r.lineWidths,c=r.maxLineWidth,h=r.fontProperties;let u,d;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,s)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;const p=e.dropShadow?2:1;for(let t=0;t<p;++t){const i=e.dropShadow&&0===t,p=i?Math.ceil(Math.max(1,s)+2*e.padding):0,f=p*this._resolution;if(i){n.fillStyle="black",n.strokeStyle="black";const t=e.dropShadowColor,r=e.dropShadowBlur*this._resolution,i=e.dropShadowDistance*this._resolution;n.shadowColor=qt.shared.setValue(t).setAlpha(e.dropShadowAlpha).toRgbaString(),n.shadowBlur=r,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*i,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*i+f}else n.fillStyle=this._generateFillStyle(e,o,r),n.strokeStyle=e.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let m=(a-h.fontSize)/2;a-h.fontSize<0&&(m=0);for(let t=0;t<o.length;t++)u=e.strokeThickness/2,d=e.strokeThickness/2+t*a+h.ascent+m,"right"===e.align?u+=c-l[t]:"center"===e.align&&(u+=(c-l[t])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(o[t],u+e.padding,d+e.padding-p,!0),e.fill&&this.drawLetterSpacing(o[t],u+e.padding,d+e.padding-p)}this.updateTexture()}drawLetterSpacing(t,e,n,r=!1){const i=this._style.letterSpacing;let s=!1;if(aa.experimentalLetterSpacingSupported&&(aa.experimentalLetterSpacing?(this.context.letterSpacing=`${i}px`,this.context.textLetterSpacing=`${i}px`,s=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===i||s)return void(r?this.context.strokeText(t,e,n):this.context.fillText(t,e,n));let o=e;const a=aa.graphemeSegmenter(t);let l=this.context.measureText(t).width,c=0;for(let t=0;t<a.length;++t){const e=a[t];r?this.context.strokeText(e,o,n):this.context.fillText(e,o,n);let s="";for(let e=t+1;e<a.length;++e)s+=a[e];c=this.context.measureText(s).width,o+=l-c+i,l=c}}updateTexture(){const t=this.canvas;if(this._style.trim){const e=function(t){const e=function(t){const{width:e,height:n}=t,r=t.getContext("2d",{willReadFrequently:!0});if(null===r)throw new TypeError("Failed to get canvas 2D context");const i=r.getImageData(0,0,e,n).data;let s=0,o=0,a=e-1,l=n-1;for(;o<n&&fe(i,e,o);)++o;if(o===n)return ce.EMPTY;for(;fe(i,e,l);)--l;for(;me(i,e,s,o,l);)++s;for(;me(i,e,a,o,l);)--a;return++a,++l,new ce(s,o,a,l)}(t),{width:n,height:r}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(null===s)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,n,r)}return{width:n,height:r,data:i}}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}const e=this._texture,n=this._style,r=n.trim?0:n.padding,i=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-r,e.trim.y=-r,e.orig.width=e._frame.width-2*r,e.orig.height=e._frame.height-2*r,this._onTextureUpdate(),i.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),-1===this._textureID&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,n){const r=t.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];let i;const s=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,a=this.canvas.width/this._resolution-s-2*o,l=this.canvas.height/this._resolution-s-2*o,c=r.slice(),h=t.fillGradientStops.slice();if(!h.length){const t=c.length+1;for(let e=1;e<t;++e)h.push(e/t)}if(c.unshift(r[0]),h.unshift(0),c.push(r[r.length-1]),h.push(1),t.fillGradientType===ia.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,o,a/2,l+o);const r=n.fontProperties.fontSize+t.strokeThickness;for(let t=0;t<e.length;t++){const s=n.lineHeight*(t-1)+r,o=n.lineHeight*t;let a=o;t>0&&s>o&&(a=(o+s)/2);const u=o+r,d=n.lineHeight*(t+1);let p=u;t+1<e.length&&d<u&&(p=(u+d)/2);const f=(p-a)/l;for(let t=0;t<c.length;t++){let e=0;e="number"==typeof h[t]?h[t]:t/c.length;let n=Math.min(1,Math.max(0,a/l+e*f));n=Number(n.toFixed(5)),i.addColorStop(n,c[t])}}}else{i=this.context.createLinearGradient(o,l/2,a+o,l/2);const t=c.length+1;let e=1;for(let n=0;n<c.length;n++){let r;r="number"==typeof h[n]?h[n]:e/t,i.addColorStop(r,c[n]),e++}}return i}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},pa,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=se(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=se(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},this._style=t instanceof ha?t:new ha(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};fa.defaultAutoResolution=!0;let ma=fa;class ga{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function va(t,e){let n=!1;if(t?._textures?.length)for(let r=0;r<t._textures.length;r++)if(t._textures[r]instanceof Kn){const i=t._textures[r].baseTexture;e.includes(i)||(e.push(i),n=!0)}return n}function ya(t,e){if(t.baseTexture instanceof Re){const n=t.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function xa(t,e){if(t._texture&&t._texture instanceof Kn){const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function wa(t,e){return e instanceof ma&&(e.updateText(!0),!0)}function _a(t,e){if(e instanceof ha){const t=e.toFontString();return aa.measureFont(t),!0}return!1}function ba(t,e){if(t instanceof ma){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function Aa(t,e){return t instanceof ha&&(e.includes(t)||e.push(t),!0)}const Ta=class t{constructor(e){this.limiter=new ga(t.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(ba),this.registerFindHook(Aa),this.registerFindHook(va),this.registerFindHook(ya),this.registerFindHook(xa),this.registerUploadHook(wa),this.registerUploadHook(_a)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,ti.system.addOnce(this.tick,this,Zr.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed)for(let n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)ti.system.addOnce(this.tick,this,Zr.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,n=t.length;e<n;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Ti)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&ti.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};Ta.uploadsPerFrame=4;let Sa=Ta;function Ea(t,e){return e instanceof Re&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function ka(t,e){if(!(e instanceof Vo))return!1;const{geometry:n}=e;e.finishPoly(),n.updateBatches();const{batches:r}=n;for(let e=0;e<r.length;e++){const{texture:n}=r[e].style;n&&Ea(t,n.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function Ma(t,e){return t instanceof Vo&&(e.push(t),!0)}Object.defineProperties(V,{UPLOADS_PER_FRAME:{get(){return Sa.uploadsPerFrame},set(t){ft("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Sa.uploadsPerFrame=t}}});class Ca extends Sa{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(Ma),this.registerUploadHook(Ea),this.registerUploadHook(ka)}}Ca.extension={name:"prepare",type:ve.RendererSystem},we.add(Ca);class Pa extends ki{constructor(t,e=!0){super(t[0]instanceof Kn?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(ti.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(ti.shared.add(this.update,this,Zr.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){let n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];const r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let n=0;n<t.length;++n)e.push(Kn.from(t[n]));return new Pa(e)}static fromImages(t){const e=[];for(let n=0;n<t.length;++n)e.push(Kn.from(t[n]));return new Pa(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof Kn)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(ti.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(ti.shared.add(this.update,this),this._isConnectedToTicker=!0))}}new Ye;var Ia="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";const Ra=new tn;class Oa extends Dn{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new tr,this.state=Te.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=In.from(Ia,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?In.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):In.from(Ia,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e)}render(t){const e=this.renderer,n=this.quad;let r=n.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);const i=t.uvRespectAnchor?t.anchor.x:0,s=t.uvRespectAnchor?t.anchor.y:0;r=n.uvs,r[0]=r[6]=-i,r[1]=r[3]=-s,r[2]=r[4]=1-i,r[5]=r[7]=1-s,n.invalidate();const o=t._texture,a=o.baseTexture,l=a.alphaMode>0,c=t.tileTransform.localTransform,h=t.uvMatrix;let u=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;u&&(a._glTextures[e.CONTEXT_UID]?u=a.wrapMode!==F.CLAMP:a.wrapMode===F.CLAMP&&(a.wrapMode=F.REPEAT));const d=u?this.simpleShader:this.shader,p=o.width,f=o.height,m=t._width,g=t._height;Ra.set(c.a*p/m,c.b*p/g,c.c*f/m,c.d*f/g,c.tx/m,c.ty/g),Ra.invert(),u?Ra.prepend(h.mapCoord):(d.uniforms.uMapCoord=h.mapCoord.toArray(!0),d.uniforms.uClampFrame=h.uClampFrame,d.uniforms.uClampOffset=h.uClampOffset),d.uniforms.uTransform=Ra.toArray(!0),d.uniforms.uColor=qt.shared.setValue(t.tint).premultiply(t.worldAlpha,l).toArray(d.uniforms.uColor),d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=o,e.shader.bind(d),e.geometry.bind(n),this.state.blendMode=Jt(t.blendMode,l),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Oa.extension={name:"tilingSprite",type:ve.RendererPlugin},we.add(Oa);const Da=class t{constructor(t,e,n){this.linkedSheets=[],(t instanceof Re||t instanceof Kn)&&(t={texture:t,data:e,resolutionFilename:n});const{texture:r,data:i,resolutionFilename:s=null,cachePrefix:o=""}=t;this.cachePrefix=o,this._texture=r instanceof Kn?r:null,this.baseTexture=r instanceof Re?r:this._texture.baseTexture,this.textures={},this.animations={},this.data=i;const a=this.baseTexture.resource;this.resolution=this._updateResolution(s||(a?a.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let n=ge(t,null);return null===n&&(n="number"==typeof e?e:parseFloat(e??"1")),1!==n&&this.baseTexture.setResolution(n),n}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let n=e;const r=t.BATCH_SIZE;for(;n-e<r&&n<this._frameKeys.length;){const t=this._frameKeys[n],e=this._frames[t],r=e.frame;if(r){let n=null,i=null;const s=!1!==e.trimmed&&e.sourceSize?e.sourceSize:e.frame,o=new qe(0,0,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution);n=e.rotated?new qe(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.h)/this.resolution,Math.floor(r.w)/this.resolution):new qe(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution),!1!==e.trimmed&&e.spriteSourceSize&&(i=new qe(Math.floor(e.spriteSourceSize.x)/this.resolution,Math.floor(e.spriteSourceSize.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution)),this.textures[t]=new Kn(this.baseTexture,n,o,i,e.rotated?2:0,e.anchor,e.borders),Kn.addToCache(this.textures[t],this.cachePrefix+t.toString())}n++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let n=0;n<t[e].length;n++){const r=t[e][n];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*t.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};Da.BATCH_SIZE=1e3;let La=Da;const Fa=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function Ba(t,e,n){const r={};if(t.forEach(t=>{r[t]=e}),Object.keys(e.textures).forEach(t=>{r[`${e.cachePrefix}${t}`]=e.textures[t]}),!n){const n=vt.dirname(t[0]);e.linkedSheets.forEach((t,i)=>{Object.assign(r,Ba([`${n}/${e.data.meta.related_multi_packs[i]}`],t,!0))})}return r}const Na={extension:ve.Asset,cache:{test:t=>t instanceof La,getCacheableAssets:(t,e)=>Ba(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),n=e.pop(),r=e.pop();return"json"===n&&Fa.includes(r)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(V.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:ve.LoadParser,priority:ss.Normal},async testParse(t,e){return".json"===vt.extname(e.src).toLowerCase()&&!!t.frames},async parse(t,e,n){const{texture:r,imageFilename:i,cachePrefix:s}=e?.data??{};let o,a=vt.dirname(e.src);if(a&&a.lastIndexOf("/")!==a.length-1&&(a+="/"),r&&r.baseTexture)o=r;else{const r=Ys(a+(i??t.meta.image),e.src);o=(await n.load([r]))[r]}const l=new La({texture:o.baseTexture,data:t,resolutionFilename:e.src,cachePrefix:s});await l.parse();const c=t?.meta?.related_multi_packs;if(Array.isArray(c)){const t=[];for(const r of c){if("string"!=typeof r)continue;let i=a+r;e.data?.ignoreMultiPack||(i=Ys(i,e.src),t.push(n.load({src:i,data:{ignoreMultiPack:!0}})))}const r=await Promise.all(t);l.linkedSheets=r,r.forEach(t=>{t.linkedSheets=[l].concat(l.linkedSheets.filter(e=>e!==t))})}return l},unload(t){t.destroy(!0)}}};we.add(Na);class Wa{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Ua{static test(t){return"string"==typeof t&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const t in e){const r=e[t].match(/^[a-z]+/gm)[0],i=e[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(const t in i){const e=i[t].split("="),n=e[0],r=e[1].replace(/"/gm,""),o=parseFloat(r),a=isNaN(o)?r:o;s[n]=a}n[r].push(s)}const r=new Wa;return n.info.forEach(t=>r.info.push({face:t.face,size:parseInt(t.size,10)})),n.common.forEach(t=>r.common.push({lineHeight:parseInt(t.lineHeight,10)})),n.page.forEach(t=>r.page.push({id:parseInt(t.id,10),file:t.file})),n.char.forEach(t=>r.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})),n.kerning.forEach(t=>r.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})),n.distanceField.forEach(t=>r.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType})),r}}class ja{static test(t){const e=t;return"string"!=typeof t&&"getElementsByTagName"in t&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")}static parse(t){const e=new Wa,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),a=t.getElementsByTagName("distanceField");for(let t=0;t<n.length;t++)e.info.push({face:n[t].getAttribute("face"),size:parseInt(n[t].getAttribute("size"),10)});for(let t=0;t<r.length;t++)e.common.push({lineHeight:parseInt(r[t].getAttribute("lineHeight"),10)});for(let t=0;t<i.length;t++)e.page.push({id:parseInt(i[t].getAttribute("id"),10)||0,file:i[t].getAttribute("file")});for(let t=0;t<s.length;t++){const n=s[t];e.char.push({id:parseInt(n.getAttribute("id"),10),page:parseInt(n.getAttribute("page"),10)||0,x:parseInt(n.getAttribute("x"),10),y:parseInt(n.getAttribute("y"),10),width:parseInt(n.getAttribute("width"),10),height:parseInt(n.getAttribute("height"),10),xoffset:parseInt(n.getAttribute("xoffset"),10),yoffset:parseInt(n.getAttribute("yoffset"),10),xadvance:parseInt(n.getAttribute("xadvance"),10)})}for(let t=0;t<o.length;t++)e.kerning.push({first:parseInt(o[t].getAttribute("first"),10),second:parseInt(o[t].getAttribute("second"),10),amount:parseInt(o[t].getAttribute("amount"),10)});for(let t=0;t<a.length;t++)e.distanceField.push({fieldType:a[t].getAttribute("fieldType"),distanceRange:parseInt(a[t].getAttribute("distanceRange"),10)});return e}}class Ha{static test(t){return!("string"!=typeof t||!t.includes("<font>"))&&ja.test(V.ADAPTER.parseXML(t))}static parse(t){return ja.parse(V.ADAPTER.parseXML(t))}}const za=[Ua,ja,Ha];function Ga(t,e,n,r,i,s,o){const a=n.text,l=n.fontProperties;e.translate(r,i),e.scale(s,s);const c=o.strokeThickness/2,h=-o.strokeThickness/2;if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=function(t,e,n,r,i,s){const o=n.fill;if(!Array.isArray(o))return o;if(1===o.length)return o[0];let a;const l=n.dropShadow?n.dropShadowDistance:0,c=n.padding||0,h=t.width/r-l-2*c,u=t.height/r-l-2*c,d=o.slice(),p=n.fillGradientStops.slice();if(!p.length){const t=d.length+1;for(let e=1;e<t;++e)p.push(e/t)}if(d.unshift(o[0]),p.unshift(0),d.push(o[o.length-1]),p.push(1),n.fillGradientType===ia.LINEAR_VERTICAL){a=e.createLinearGradient(h/2,c,h/2,u+c);let t=0;const r=(s.fontProperties.fontSize+n.strokeThickness)/u;for(let e=0;e<i.length;e++){const n=s.lineHeight*e;for(let e=0;e<d.length;e++){let i=0;i="number"==typeof p[e]?p[e]:e/d.length;const s=n/u+i*r;let o=Math.max(t,s);o=Math.min(o,1),a.addColorStop(o,d[e]),t=o}}}else{a=e.createLinearGradient(c,u/2,h+c,u/2);const t=d.length+1;let n=1;for(let e=0;e<d.length;e++){let r;r="number"==typeof p[e]?p[e]:n/t,a.addColorStop(r,d[e]),n++}}return a}(t,e,o,s,[a],n),e.strokeStyle=o.stroke,o.dropShadow){const t=o.dropShadowColor,n=o.dropShadowBlur*s,r=o.dropShadowDistance*s;e.shadowColor=qt.shared.setValue(t).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=n,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*r,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*r}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,c,h+n.lineHeight-l.descent),o.fill&&e.fillText(a,c,h+n.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Xa(t){return Array.from?Array.from(t):t.split("")}function Va(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}const Ya=class t{constructor(t,e,n){const[r]=t.info,[i]=t.common,[s]=t.page,[o]=t.distanceField,a=ge(s.file),l={};this._ownsTextures=n,this.font=r.face,this.size=r.size,this.lineHeight=i.lineHeight/a,this.chars={},this.pageTextures=l;for(let n=0;n<t.page.length;n++){const{id:r,file:i}=t.page[n];l[r]=e instanceof Array?e[n]:e[i],o?.fieldType&&"none"!==o.fieldType&&(l[r].baseTexture.alphaMode=N.NO_PREMULTIPLIED_ALPHA,l[r].baseTexture.mipmap=B.OFF)}for(let e=0;e<t.char.length;e++){const{id:n,page:r}=t.char[e];let{x:i,y:s,width:o,height:c,xoffset:h,yoffset:u,xadvance:d}=t.char[e];i/=a,s/=a,o/=a,c/=a,h/=a,u/=a,d/=a;const p=new qe(i+l[r].frame.x/a,s+l[r].frame.y/a,o,c);this.chars[n]={xOffset:h,yOffset:u,xAdvance:d,kerning:{},texture:new Kn(l[r].baseTexture,p),page:r}}for(let e=0;e<t.kerning.length;e++){let{first:n,second:r,amount:i}=t.kerning[e];n/=a,r/=a,i/=a,this.chars[r]&&(this.chars[r].kerning[n]=i)}this.distanceFieldRange=o?.distanceRange,this.distanceFieldType=o?.fieldType?.toLowerCase()??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(e,n,r){let i;if(e instanceof Wa)i=e;else{const t=function(t){for(let e=0;e<za.length;e++)if(za[e].test(t))return za[e];return null}(e);if(!t)throw new Error("Unrecognized data format for font.");i=t.parse(e)}n instanceof Kn&&(n=[n]);const s=new t(i,n,r);return t.available[s.font]=s,s}static uninstall(e){const n=t.available[e];if(!n)throw new Error(`No font found named '${e}'`);n.destroy(),delete t.available[e]}static from(e,n,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:a,textureHeight:l,...c}=Object.assign({},t.defaultOptions,r),h=function(t){"string"==typeof t&&(t=[t]);const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];if(Array.isArray(r)){if(2!==r.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const t=r[0].charCodeAt(0),n=r[1].charCodeAt(0);if(n<t)throw new Error("[BitmapFont]: Invalid character range.");for(let r=t,i=n;r<=i;r++)e.push(String.fromCharCode(r))}else e.push(...Xa(r))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(i),u=n instanceof ha?n:new ha(n),d=a,p=new Wa;p.info[0]={face:u.fontFamily,size:u.fontSize},p.common[0]={lineHeight:u.fontSize};let f,m,g,v=0,y=0,x=0;const w=[],_=[];for(let t=0;t<h.length;t++){f||(f=V.ADAPTER.createCanvas(),f.width=a,f.height=l,m=f.getContext("2d"),g=new Re(f,{resolution:o,...c}),w.push(g),_.push(new Kn(g)),p.page.push({id:_.length-1,file:""}));const e=h[t],n=aa.measureText(e,u,!1,f),r=n.width,i=Math.ceil(n.height),b=Math.ceil(("italic"===u.fontStyle?2:1)*r);if(y>=l-i*o){if(0===y)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${e}')`);--t,f=null,m=null,g=null,y=0,v=0,x=0;continue}if(x=Math.max(i+n.fontProperties.descent,x),b*o+v>=d){if(0===v)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${e}')`);--t,y+=x*o,y=Math.ceil(y),v=0,x=0;continue}Ga(f,m,n,v,y,o,u);const A=Va(n.text);p.char.push({id:A,page:_.length-1,x:v/o,y:y/o,width:b,height:i,xoffset:0,yoffset:0,xadvance:r-(u.dropShadow?u.dropShadowDistance:0)-(u.stroke?u.strokeThickness:0)}),v+=(b+2*s)*o,v=Math.ceil(v)}if(!r?.skipKerning)for(let t=0,e=h.length;t<e;t++){const n=h[t];for(let t=0;t<e;t++){const e=h[t],r=m.measureText(n).width,i=m.measureText(e).width,s=m.measureText(n+e).width-(r+i);s&&p.kerning.push({first:Va(n),second:Va(e),amount:s})}}const b=new t(p,_,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=b,b}};Ya.ALPHA=[["a","z"],["A","Z"]," "],Ya.NUMERIC=[["0","9"]],Ya.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Ya.ASCII=[[" ","~"]],Ya.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Ya.ALPHANUMERIC},Ya.available={};let $a=Ya;const qa=[],Ka=[],Za=[];(class t extends Ti{constructor(e,n={}){super();const{align:r,tint:i,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},t.styleDefaults,n);if(!$a.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new qt(i),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new hn(()=>{this.dirty=!0},this,0,0),this._roundPixels=V.ROUND_PIXELS,this.dirty=!0,this._resolution=V.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const t=$a.available[this._fontName],e=this.fontSize,n=e/t.size,r=new Ye,i=[],s=[],o=[],a=Xa(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),l=this._maxWidth*t.size/e,c="none"===t.distanceFieldType?qa:Ka;let h=null,u=0,d=0,p=0,f=-1,m=0,g=0,v=0,y=0;for(let e=0;e<a.length;e++){const n=a[e],c=Va(n);if(/(?:\s)/.test(n)&&(f=e,m=u,y++),"\r"===n||"\n"===n){s.push(u),o.push(-1),d=Math.max(d,u),++p,++g,r.x=0,r.y+=t.lineHeight,h=null,y=0;continue}const x=t.chars[c];if(!x)continue;h&&x.kerning[h]&&(r.x+=x.kerning[h]);const w=Za.pop()||{texture:Kn.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ye};w.texture=x.texture,w.line=p,w.charCode=c,w.position.x=Math.round(r.x+x.xOffset+this._letterSpacing/2),w.position.y=Math.round(r.y+x.yOffset),w.prevSpaces=y,i.push(w),u=w.position.x+Math.max(x.xAdvance-x.xOffset,x.texture.orig.width),r.x+=x.xAdvance+this._letterSpacing,v=Math.max(v,x.yOffset+x.texture.height),h=c,-1!==f&&l>0&&r.x>l&&(++g,ie(i,1+f-g,1+e-f),e=f,f=-1,s.push(m),o.push(i.length>0?i[i.length-1].prevSpaces:0),d=Math.max(d,m),p++,r.x=0,r.y+=t.lineHeight,h=null,y=0)}const x=a[a.length-1];"\r"!==x&&"\n"!==x&&(/(?:\s)/.test(x)&&(u=m),s.push(u),d=Math.max(d,u),o.push(-1));const w=[];for(let t=0;t<=p;t++){let e=0;"right"===this._align?e=d-s[t]:"center"===this._align?e=(d-s[t])/2:"justify"===this._align&&(e=o[t]<0?0:(d-s[t])/o[t]),w.push(e)}const _=i.length,b={},A=[],T=this._activePagesMeshData;c.push(...T);for(let e=0;e<_;e++){const n=i[e].texture,r=n.baseTexture.uid;if(!b[r]){let e=c.pop();if(!e){const n=new Qo;let r,i;"none"===t.distanceFieldType?(r=new Jo(Kn.EMPTY),i=C.NORMAL):(r=new Jo(Kn.EMPTY,{program:Mn.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n"),uniforms:{uFWidth:0}}),i=C.NORMAL_NPM);const s=new Zo(n,r);s.blendMode=i,e={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:s,vertices:null,uvs:null,indices:null}}e.index=0,e.indexCount=0,e.vertexCount=0,e.uvsCount=0,e.total=0;const{_textureCache:i}=this;i[r]=i[r]||new Kn(n.baseTexture),e.mesh.texture=i[r],e.mesh.tint=this._tintColor.value,A.push(e),b[r]=e}b[r].total++}for(let t=0;t<T.length;t++)A.includes(T[t])||this.removeChild(T[t].mesh);for(let t=0;t<A.length;t++)A[t].mesh.parent!==this&&this.addChild(A[t].mesh);this._activePagesMeshData=A;for(const t in b){const e=b[t],n=e.total;if(!(e.indices?.length>6*n)||e.vertices.length<2*Zo.BATCHABLE_SIZE)e.vertices=new Float32Array(8*n),e.uvs=new Float32Array(8*n),e.indices=new Uint16Array(6*n);else{const t=e.total,n=e.vertices;for(let e=4*t*2;e<n.length;e++)n[e]=0}e.mesh.size=6*n}for(let t=0;t<_;t++){const e=i[t];let r=e.position.x+w[e.line]*("justify"===this._align?e.prevSpaces:1);this._roundPixels&&(r=Math.round(r));const s=r*n,o=e.position.y*n,a=e.texture,l=b[a.baseTexture.uid],c=a.frame,h=a._uvs,u=l.index++;l.indices[6*u+0]=0+4*u,l.indices[6*u+1]=1+4*u,l.indices[6*u+2]=2+4*u,l.indices[6*u+3]=0+4*u,l.indices[6*u+4]=2+4*u,l.indices[6*u+5]=3+4*u,l.vertices[8*u+0]=s,l.vertices[8*u+1]=o,l.vertices[8*u+2]=s+c.width*n,l.vertices[8*u+3]=o,l.vertices[8*u+4]=s+c.width*n,l.vertices[8*u+5]=o+c.height*n,l.vertices[8*u+6]=s,l.vertices[8*u+7]=o+c.height*n,l.uvs[8*u+0]=h.x0,l.uvs[8*u+1]=h.y0,l.uvs[8*u+2]=h.x1,l.uvs[8*u+3]=h.y1,l.uvs[8*u+4]=h.x2,l.uvs[8*u+5]=h.y2,l.uvs[8*u+6]=h.x3,l.uvs[8*u+7]=h.y3}this._textWidth=d*n,this._textHeight=(r.y+t.lineHeight)*n;for(const t in b){const e=b[t];if(0!==this.anchor.x||0!==this.anchor.y){let t=0;const n=this._textWidth*this.anchor.x,r=this._textHeight*this.anchor.y;for(let i=0;i<e.total;i++)e.vertices[t++]-=n,e.vertices[t++]-=r,e.vertices[t++]-=n,e.vertices[t++]-=r,e.vertices[t++]-=n,e.vertices[t++]-=r,e.vertices[t++]-=n,e.vertices[t++]-=r}this._maxLineHeight=v*n;const r=e.mesh.geometry.getBuffer("aVertexPosition"),i=e.mesh.geometry.getBuffer("aTextureCoord"),s=e.mesh.geometry.getIndex();r.data=e.vertices,i.data=e.uvs,s.data=e.indices,r.update(),i.update(),s.update()}for(let t=0;t<i.length;t++)Za.push(i[t]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:n,size:r}=$a.available[this._fontName];if("none"!==n){const{a:n,b:i,c:s,d:o}=this.worldTransform,a=Math.sqrt(n*n+i*i),l=Math.sqrt(s*s+o*o),c=(Math.abs(a)+Math.abs(l))/2,h=this.fontSize/r,u=t._view.resolution;for(const t of this._activePagesMeshData)t.mesh.shader.uniforms.uFWidth=c*e*h*u}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=$a.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!$a.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??$a.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,n="none"===$a.available[this._fontName].distanceFieldType?qa:Ka;n.push(...this._activePagesMeshData);for(const t of this._activePagesMeshData)this.removeChild(t.mesh);this._activePagesMeshData=[],n.filter(t=>e[t.mesh.texture.baseTexture.uid]).forEach(t=>{t.mesh.texture=Kn.EMPTY});for(const t in e)e[t].destroy(),delete e[t];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}}).styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const Qa=[".xml",".fnt"],Ja={extension:{type:ve.LoadParser,priority:ss.Normal},name:"loadBitmapFont",test(t){return Qa.includes(vt.extname(t).toLowerCase())},async testParse(t){return Ua.test(t)||Ha.test(t)},async parse(t,e,n){const r=Ua.test(t)?Ua.parse(t):Ha.parse(t),{src:i}=e,{page:s}=r,o=[];for(let t=0;t<s.length;++t){const e=s[t].file;let n=vt.join(vt.dirname(i),e);n=Ys(n,i),o.push(n)}const a=await n.load(o),l=o.map(t=>a[t]);return $a.install(r,l,!0)},async load(t,e){return(await V.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};we.add(Ja);const tl=class t extends ha{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new t(Object.keys(t.defaultOptions).reduce((t,n)=>({...t,[n]:e[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,0===e.refs&&(e.fontFace&&document.fonts.delete(e.fontFace),delete t.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,n={}){const{availableFonts:r}=t;if(r[e]){const t=r[e];return this._fonts.push(t),t.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return V.ADAPTER.fetch(e).then(t=>t.blob()).then(async t=>new Promise((e,n)=>{const r=URL.createObjectURL(t),i=new FileReader;i.onload=()=>e([r,i.result]),i.onerror=n,i.readAsDataURL(t)})).then(async([t,i])=>{const s=Object.assign({family:vt.basename(e,vt.extname(e)),weight:"normal",style:"normal",display:"auto",src:t,dataSrc:i,refs:1,originalUrl:e,fontFace:null},n);r[e]=s,this._fonts.push(s),this.styleID++;const o=new FontFace(s.family,`url(${s.src})`,{weight:s.weight,style:s.style,display:s.display});s.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){const e=t.filter(t=>!this._overrides.includes(t));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(t=>this._overrides.includes(t));e.length>0&&(this._overrides=this._overrides.filter(t=>!e.includes(t)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}\n            @font-face {\n                font-family: "${e.family}";\n                src: url('${e.dataSrc}');\n                font-weight: ${e.weight};\n                font-style: ${e.style};\n                font-display: ${e.display};\n            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=Zt(t)),"number"==typeof t?(e=t,ft("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),qt.shared.setValue(e).toHex()):t;var e}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(255*e|0).toString(16).padStart(2,"0"));const i=`${n}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${i} ${t}`}reset(){Object.assign(this,t.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=V.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};tl.availableFonts={},tl.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let el=tl;const nl=class t extends ki{constructor(e="",n={}){super(Kn.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const r=new Image,i=Kn.from(r,{scaleMode:V.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new qe,i.trim=new qe,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),c=document.createElementNS(o,"div"),h=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=t.defaultMaxWidth,this.maxHeight=t.defaultMaxHeight,this._domElement=c,this._styleElement=h,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(h),this._foreignObject.appendChild(c),this._image=r,this._loadImage=new Image,this._autoResolution=t.defaultAutoResolution,this._resolution=t.defaultResolution??V.RESOLUTION,this.text=e,this.style=n}measureText(t){const{text:e,style:n,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:n.toCSS(r)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const i=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:s,height:o}=i;(s>this.maxWidth||o>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const a=Math.min(this.maxWidth,Math.ceil(s)),l=Math.min(this.maxHeight,Math.ceil(o));return this._svgRoot.setAttribute("width",a.toString()),this._svgRoot.setAttribute("height",l.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(r)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:a+2*n.padding,height:l+2*n.padding}}async updateText(t=!0){const{style:e,_image:n,_loadImage:r}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:i,height:s}=this.measureText();n.width=r.width=Math.ceil(Math.max(1,i)),n.height=r.height=Math.ceil(Math.max(1,s)),this._updateID++;const o=this._updateID;await new Promise(t=>{r.onload=async()=>{o<this._updateID||(await e.onBeforeDraw(),n.src=r.src,r.onload=null,r.src="",this.updateTexture()),t()};const i=(new XMLSerializer).serializeToString(this._svgRoot);r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(i)}`})}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:n,resolution:r}=this,{padding:i}=t,{baseTexture:s}=e;e.trim.width=e._frame.width=n.width/r,e.trim.height=e._frame.height=n.height/r,e.trim.x=-i,e.trim.y=-i,e.orig.width=e._frame.width-2*i,e.orig.height=e._frame.height-2*i,this._onTextureUpdate(),s.setRealSize(n.width,n.height,r),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},t.defaultDestroyOptions,e),super.destroy(e);const n=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=n,this._svgRoot?.remove(),this._svgRoot=n,this._domElement?.remove(),this._domElement=n,this._foreignObject?.remove(),this._foreignObject=n,this._styleElement?.remove(),this._styleElement=n,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=n,this._image.src="",this._image=n}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=se(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=se(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&((t=t||{})instanceof el?(this.ownsStyle=!1,this._style=t):t instanceof ha?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=el.from(t)):(this.ownsStyle=!0,this._style=new el(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(""===t||null==t?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};nl.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},nl.defaultMaxWidth=2024,nl.defaultMaxHeight=2024,nl.defaultAutoResolution=!0,r(9868);var rl="game2_HOPA_Simple",il="main",sl={YA_CLOUD_SERVER:"https://storage.yandexcloud.net/dra/detective/v4/",OK:"https://dravk.ru/poisk_ok/",VK:"https://dravk.ru/hog/detective/vk/",PLAYGAMA_REMOTE:"https://cdn.dra.games/hog/detective/playgama/",CRAZY_GAMES_REMOTE:"https://cdn.dra.games/hog/detective/crazyGames/",GIT_TEST_LOCAL:"https://raw.githubusercontent.com/westerovs/testServer/refs/heads/".concat(il,"/").concat(rl,"/yandex-hybrid-test/localeAssets/"),GIT_TEST_REMOTE:"https://raw.githubusercontent.com/westerovs/testServer/refs/heads/".concat(il,"/").concat(rl,"/yandex-hybrid-test/remoteAssets/"),GIT_TEST_ALL:"https://raw.githubusercontent.com/westerovs/testServer/refs/heads/".concat(il,"/").concat(rl,"/assets-full/"),TEST_RESKIN:"https://test.dravk.ru/hog/detective/reskin-test/assets/"},ol={WIDTH:2560,HEIGHT:1080,HALF_W:1280,HALF_H:540,get CENTER(){return{x:1280,y:540}},get isLandscape(){return matchMedia("(orientation: landscape)").matches},get isPortrait(){return matchMedia("(orientation: portrait)").matches}},al="preloadState",ll="gameState",cl="levelState",hl="levelPreload",ul="shadows",dl="words",pl="generator",fl={useLevelTypeGeneration:"true",useCounterFlag:"true",useHudShadow:"true",useHudWords:"true",useTimerRewardDuration:"180",levelAdDelay:"120"},ml={local:sl.GIT_TEST_LOCAL,remote:sl.GIT_TEST_REMOTE};function gl(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function vl(t,e){return t.get(xl(t,e))}function yl(t,e,n){return t.set(xl(t,e),n),n}function xl(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wl=new WeakMap,_l=new WeakMap,bl=new WeakMap,Al=new WeakMap,Tl=new WeakMap,Sl=w(function t(e,n){var r=this;g(this,t),gl(this,wl,void 0),gl(this,_l,void 0),gl(this,bl,void 0),gl(this,Al,void 0),gl(this,Tl,function(){yl(_l,r,new Ti),vl(_l,r).zIndex=5,vl(_l,r).name="ui",r.viewport.addChild(vl(_l,r)),yl(bl,r,new Ti),vl(bl,r).name="uiInner",vl(bl,r).sortableChildren=!0,vl(_l,r).addChild(vl(bl,r)),yl(Al,r,new Vo),vl(Al,r).name="uiRect",vl(Al,r).alpha=.5,vl(Al,r).visible=!1,vl(_l,r).addChild(vl(Al,r)),vl(wl,r).uiRect=vl(Al,r),vl(wl,r).uiInner=vl(bl,r),vl(wl,r).ui=vl(_l,r)}),S(this,"resizeUi",function(){var t=Math.min(ol.WIDTH/window.innerWidth,ol.HEIGHT/window.innerHeight),e=window.innerWidth*t,n=ol.HEIGHT/window.innerHeight,i=window.innerHeight*n,s=vl(Al,r);s.clear(),s.lineStyle(8,65280),s.beginFill(255),s.drawRect(4,4,e-4,i-4),s.endFill(),vl(_l,r).pivot.set(s.width/2,s.height/2),vl(_l,r).position.set(ol.HALF_W,ol.HALF_H)}),yl(wl,this,e),this.viewport=n,vl(Tl,this).call(this)},[{key:"ui",get:function(){return vl(_l,this)}},{key:"uiInner",get:function(){return vl(bl,this)}},{key:"uiRect",get:function(){return vl(Al,this)}}]);function El(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(El=function(){return!!t})()}var kl=new WeakMap,Ml=function(t){function e(t){var n;return g(this,e),n=function(t,e){return e=b(e),_(t,El()?Reflect.construct(e,[],b(t).constructor):e.apply(t,void 0))}(this,e),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(n,kl,function(){var t=(new Vo).beginFill(16711680).drawRect(0,0,ol.WIDTH,ol.HEIGHT);t.visible=!1,n.addChild(t)}),S(n,"resize",function(){var t=n.resizeData,e=t.scaleFactor,r=t.x,i=t.y;n.game.scaleFactor=e,n.game.resizeData=n.resizeData,n.scale.set(e),n.position.set(r,i),n.uiLayer.resizeUi()}),n.game=t,n.name="mainViewport",n.sortableChildren=!0,n.uiLayer=new Sl(t,n),function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(kl,n).call(n),n}return T(e,t),w(e,[{key:"scaleFactor",get:function(){return+(window.innerHeight/ol.HEIGHT).toFixed(3)}},{key:"resizeData",get:function(){var t=this.scaleFactor;return{scaleFactor:t,x:+((window.innerWidth-ol.WIDTH*t)/2).toFixed(3),y:+((window.innerHeight-ol.HEIGHT*t)/2).toFixed(3),differentX:Math.abs((window.innerWidth-ol.WIDTH)/2),differentY:Math.abs((window.innerHeight-ol.HEIGHT)/2)}}},{key:"ui",get:function(){return this.uiLayer.ui}},{key:"uiInner",get:function(){return this.uiLayer.uiInner}},{key:"uiRect",get:function(){return this.uiLayer.uiRect}}])}(Ti),Cl=(r(8992),r(3949),r(3500),r(113),r(4423),r(9432),r(6034),r(1415),r(1699),r(2577),{SDK:"SDK",STORAGE:"STORAGE",Metrika:"Metrika",GamePreload:"GamePreload",StateGame:"StateGame",LevelPreload:"LevelPreload",DestroyMessage:"DestroyMessage",Config:"config",SOUND_MANAGER:"SOUND_MANAGER",Hud:"Hud"}),Pl={default:"#00A5FE",sdk:"#28FF5A",storage:"#00DEFE",metrika:"#BBFE64",gamePreload:"yellow",lvlPreload:"orange",config:"#FEE000",destroy:"#D764FE",warning:"tomato",error:"red",green:"#08FE00"},Il=function(t){var e=Object.keys(Pl).find(function(e){return e.toLowerCase()===t.toLowerCase()});return e?Pl[e]:Pl.default},Rl=new Set;Rl.add(Cl.Config),Rl.add(Cl.STORAGE);var Ol=w(function t(){g(this,t)},null,[{key:"log",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(Rl.has(t)){var s;(s=console).log.apply(s,["%c[".concat(t,"]"),"color: ".concat(Il(t)),e].concat(r))}else{var o;if(Object.values(Cl).includes(t))return;(o=console).log.apply(o,["%c[Logger]","color: ".concat(Il(t)),t,e].concat(r))}}},{key:"warn",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(Rl.has(t)){var s;(s=console).warn.apply(s,["[".concat(t,"]"),e].concat(r))}else{var o;if(Object.values(Cl).includes(t))return;(o=console).log.apply(o,["%c[Logger]","color: ".concat(Pl.warning),e].concat(r))}}}]);function Dl(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Ll(t,e){return t.get(Bl(t,e))}function Fl(t,e,n){return t.set(Bl(t,e),n),n}function Bl(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nl=new WeakMap,Wl=new WeakMap,Ul=new WeakMap,jl=new WeakMap,Hl=new WeakMap,zl=new WeakMap,Gl=new WeakMap,Xl=new WeakMap,Vl=new WeakMap,Yl=new WeakMap,$l=w(function t(e){var n=this;return g(this,t),Dl(this,Nl,void 0),Dl(this,Wl,void 0),Dl(this,Ul,void 0),Dl(this,jl,void 0),Dl(this,Hl,void 0),Dl(this,zl,void 0),Dl(this,Gl,void 0),Dl(this,Xl,function(){var t=window.innerWidth,e=window.innerHeight;Fl(Wl,n,t),Fl(Ul,n,e),Ll(jl,n)&&clearTimeout(Ll(jl,n)),Fl(jl,n,setTimeout(function(){window.innerWidth===Ll(Wl,n)&&window.innerHeight===Ll(Ul,n)&&(t===Ll(Hl,n)&&e===Ll(zl,n)||(Fl(Hl,n,t),Fl(zl,n,e),Ll(Yl,n).call(n))),Fl(Gl,n,!1)},120))}),Dl(this,Vl,function(){Ll(Gl,n)||(Fl(Gl,n,!0),Ol.warn("","forceResize"),Ll(Yl,n).call(n),Fl(Gl,n,!1))}),Dl(this,Yl,function(){Ll(Nl,n).viewport.resize(),Ll(Nl,n).states.forEach(function(t){t.isInitialized&&t.resize()})}),"object"===v(t.instance)?t.instance:(Fl(Nl,this,e),Ll(Nl,this).forceResize=Ll(Vl,this),window.addEventListener("resize",Ll(Xl,this)),Ll(Xl,this).call(this),t.instance=this)});function ql(t,e,n,r,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Kl(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(t){ql(s,r,i,o,a,"next",t)}function a(t){ql(s,r,i,o,a,"throw",t)}o(void 0)})}}function Zl(){return Zl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Zl.apply(null,arguments)}var Ql=r(4756),Jl=r.n(Ql);r(9479);const tc=t=>"string"==typeof t,ec=()=>{let t,e;const n=new Promise((n,r)=>{t=n,e=r});return n.resolve=t,n.reject=e,n},nc=t=>null==t?"":""+t,rc=/###/g,ic=t=>t&&t.indexOf("###")>-1?t.replace(rc,"."):t,sc=t=>!t||tc(t),oc=(t,e,n)=>{const r=tc(e)?e.split("."):e;let i=0;for(;i<r.length-1;){if(sc(t))return{};const e=ic(r[i]);!t[e]&&n&&(t[e]=new n),t=Object.prototype.hasOwnProperty.call(t,e)?t[e]:{},++i}return sc(t)?{}:{obj:t,k:ic(r[i])}},ac=(t,e,n)=>{const{obj:r,k:i}=oc(t,e,Object);if(void 0!==r||1===e.length)return void(r[i]=n);let s=e[e.length-1],o=e.slice(0,e.length-1),a=oc(t,o,Object);for(;void 0===a.obj&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),a=oc(t,o,Object),a?.obj&&void 0!==a.obj[`${a.k}.${s}`]&&(a.obj=void 0);a.obj[`${a.k}.${s}`]=n},lc=(t,e)=>{const{obj:n,k:r}=oc(t,e);if(n&&Object.prototype.hasOwnProperty.call(n,r))return n[r]},cc=(t,e,n)=>{for(const r in e)"__proto__"!==r&&"constructor"!==r&&(r in t?tc(t[r])||t[r]instanceof String||tc(e[r])||e[r]instanceof String?n&&(t[r]=e[r]):cc(t[r],e[r],n):t[r]=e[r]);return t},hc=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var uc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const dc=t=>tc(t)?t.replace(/[&<>"'\/]/g,t=>uc[t]):t,pc=[" ",",","?","!",";"],fc=new class{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const e=this.regExpMap.get(t);if(void 0!==e)return e;const n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}}(20),mc=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!t)return;if(t[e]){if(!Object.prototype.hasOwnProperty.call(t,e))return;return t[e]}const r=e.split(n);let i=t;for(let t=0;t<r.length;){if(!i||"object"!=typeof i)return;let e,s="";for(let o=t;o<r.length;++o)if(o!==t&&(s+=n),s+=r[o],e=i[s],void 0!==e){if(["string","number","boolean"].indexOf(typeof e)>-1&&o<r.length-1)continue;t+=o-t+1;break}i=e}return i},gc=t=>t?.replace("_","-"),vc={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console?.[t]?.apply?.(console,e)}};class yc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(t,e)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||vc,this.options=e,this.debug=e.debug}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}deprecate(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,n,r){return r&&!this.debug?null:(tc(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new yc(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new yc(this.logger,t)}}var xc=new yc;class wc{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(t=>{this.observers[t]||(this.observers[t]=new Map);const n=this.observers[t].get(e)||0;this.observers[t].set(e,n+1)}),this}off(t,e){this.observers[t]&&(e?this.observers[t].delete(e):delete this.observers[t])}emit(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(t=>{let[e,r]=t;for(let t=0;t<r;t++)e(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(e=>{let[r,i]=e;for(let e=0;e<i;e++)r.apply(r,[t,...n])})}}class _c extends wc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,s=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;t.indexOf(".")>-1?o=t.split("."):(o=[t,e],n&&(Array.isArray(n)?o.push(...n):tc(n)&&i?o.push(...n.split(i)):o.push(n)));const a=lc(this.data,o);return!a&&!e&&!n&&t.indexOf(".")>-1&&(t=o[0],e=o[1],n=o.slice(2).join(".")),!a&&s&&tc(n)?mc(this.data?.[t]?.[e],n,i):a}addResource(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const s=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator;let o=[t,e];n&&(o=o.concat(s?n.split(s):n)),t.indexOf(".")>-1&&(o=t.split("."),r=e,e=o[1]),this.addNamespaces(e),ac(this.data,o,r),i.silent||this.emit("added",t,e,n,r)}addResources(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const r in n)(tc(n[r])||Array.isArray(n[r]))&&this.addResource(t,e,r,n[r],{silent:!0});r.silent||this.emit("added",t,e,n)}addResourceBundle(t,e,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},o=[t,e];t.indexOf(".")>-1&&(o=t.split("."),r=n,n=e,e=o[1]),this.addNamespaces(e);let a=lc(this.data,o)||{};s.skipCopy||(n=JSON.parse(JSON.stringify(n))),r?cc(a,n,i):a={...a,...n},ac(this.data,o,a),s.silent||this.emit("added",t,e,n)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return void 0!==this.getResource(t,e)}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(t=>e[t]&&Object.keys(e[t]).length>0)}toJSON(){return this.data}}var bc={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,i){return t.forEach(t=>{e=this.processors[t]?.process(e,n,r,i)??e}),e}};const Ac={},Tc=t=>!tc(t)&&"boolean"!=typeof t&&"number"!=typeof t;class Sc extends wc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),((t,e,n)=>{["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach(t=>{e[t]&&(n[t]=e[t])})})(0,t,this),this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=xc.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==t)return!1;const n=this.resolve(t,e);return void 0!==n?.res}extractFromKey(t,e){let n=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");const r=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator;let i=e.ns||this.options.defaultNS||[];const s=n&&t.indexOf(n)>-1,o=!(this.options.userDefinedKeySeparator||e.keySeparator||this.options.userDefinedNsSeparator||e.nsSeparator||((t,e,n)=>{e=e||"",n=n||"";const r=pc.filter(t=>e.indexOf(t)<0&&n.indexOf(t)<0);if(0===r.length)return!0;const i=fc.getRegExp(`(${r.map(t=>"?"===t?"\\?":t).join("|")})`);let s=!i.test(t);if(!s){const e=t.indexOf(n);e>0&&!i.test(t.substring(0,e))&&(s=!0)}return s})(t,n,r));if(s&&!o){const e=t.match(this.interpolator.nestingRegexp);if(e&&e.length>0)return{key:t,namespaces:tc(i)?[i]:i};const s=t.split(n);(n!==r||n===r&&this.options.ns.indexOf(s[0])>-1)&&(i=s.shift()),t=s.join(r)}return{key:t,namespaces:tc(i)?[i]:i}}translate(t,e,n){if("object"!=typeof e&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof e&&(e={...e}),e||(e={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);const r=void 0!==e.returnDetails?e.returnDetails:this.options.returnDetails,i=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,{key:s,namespaces:o}=this.extractFromKey(t[t.length-1],e),a=o[o.length-1],l=e.lng||this.language,c=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===l?.toLowerCase()){if(c){const t=e.nsSeparator||this.options.nsSeparator;return r?{res:`${a}${t}${s}`,usedKey:s,exactUsedKey:s,usedLng:l,usedNS:a,usedParams:this.getUsedParamsDetails(e)}:`${a}${t}${s}`}return r?{res:s,usedKey:s,exactUsedKey:s,usedLng:l,usedNS:a,usedParams:this.getUsedParamsDetails(e)}:s}const h=this.resolve(t,e);let u=h?.res;const d=h?.usedKey||s,p=h?.exactUsedKey||s,f=void 0!==e.joinArrays?e.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject,g=void 0!==e.count&&!tc(e.count),v=Sc.hasDefaultValue(e),y=g?this.pluralResolver.getSuffix(l,e.count,e):"",x=e.ordinal&&g?this.pluralResolver.getSuffix(l,e.count,{ordinal:!1}):"",w=g&&!e.ordinal&&0===e.count,_=w&&e[`defaultValue${this.options.pluralSeparator}zero`]||e[`defaultValue${y}`]||e[`defaultValue${x}`]||e.defaultValue;let b=u;m&&!u&&v&&(b=_);const A=Tc(b),T=Object.prototype.toString.apply(b);if(!(m&&b&&A&&["[object Number]","[object Function]","[object RegExp]"].indexOf(T)<0)||tc(f)&&Array.isArray(b))if(m&&tc(f)&&Array.isArray(u))u=u.join(f),u&&(u=this.extendTranslation(u,t,e,n));else{let r=!1,o=!1;!this.isValidLookup(u)&&v&&(r=!0,u=_),this.isValidLookup(u)||(o=!0,u=s);const c=(e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&o?void 0:u,d=v&&_!==u&&this.options.updateMissing;if(o||r||d){if(this.logger.log(d?"updateKey":"missingKey",l,a,s,d?_:u),i){const t=this.resolve(s,{...e,keySeparator:!1});t&&t.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let t=[];const n=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if("fallback"===this.options.saveMissingTo&&n&&n[0])for(let e=0;e<n.length;e++)t.push(n[e]);else"all"===this.options.saveMissingTo?t=this.languageUtils.toResolveHierarchy(e.lng||this.language):t.push(e.lng||this.language);const r=(t,n,r)=>{const i=v&&r!==u?r:c;this.options.missingKeyHandler?this.options.missingKeyHandler(t,a,n,i,d,e):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(t,a,n,i,d,e),this.emit("missingKey",t,a,n,u)};this.options.saveMissing&&(this.options.saveMissingPlurals&&g?t.forEach(t=>{const n=this.pluralResolver.getSuffixes(t,e);w&&e[`defaultValue${this.options.pluralSeparator}zero`]&&n.indexOf(`${this.options.pluralSeparator}zero`)<0&&n.push(`${this.options.pluralSeparator}zero`),n.forEach(n=>{r([t],s+n,e[`defaultValue${n}`]||_)})}):r(t,s,_))}u=this.extendTranslation(u,t,e,h,n),o&&u===s&&this.options.appendNamespaceToMissingKey&&(u=`${a}:${s}`),(o||r)&&this.options.parseMissingKeyHandler&&(u=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${a}:${s}`:s,r?u:void 0))}else{if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const t=this.options.returnedObjectHandler?this.options.returnedObjectHandler(d,b,{...e,ns:o}):`key '${s} (${this.language})' returned an object instead of string.`;return r?(h.res=t,h.usedParams=this.getUsedParamsDetails(e),h):t}if(i){const t=Array.isArray(b),n=t?[]:{},r=t?p:d;for(const t in b)if(Object.prototype.hasOwnProperty.call(b,t)){const s=`${r}${i}${t}`;n[t]=v&&!u?this.translate(s,{...e,defaultValue:Tc(_)?_[t]:void 0,joinArrays:!1,ns:o}):this.translate(s,{...e,joinArrays:!1,ns:o}),n[t]===s&&(n[t]=b[t])}u=n}}return r?(h.res=u,h.usedParams=this.getUsedParamsDetails(e),h):u}extendTranslation(t,e,n,r,i){var s=this;if(this.i18nFormat?.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const o=tc(t)&&(void 0!==n?.interpolation?.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let a;if(o){const e=t.match(this.interpolator.nestingRegexp);a=e&&e.length}let l=n.replace&&!tc(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),t=this.interpolator.interpolate(t,l,n.lng||this.language||r.usedLng,n),o){const e=t.match(this.interpolator.nestingRegexp);a<(e&&e.length)&&(n.nest=!1)}!n.lng&&r&&r.res&&(n.lng=this.language||r.usedLng),!1!==n.nest&&(t=this.interpolator.nest(t,function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return i?.[0]!==r[0]||n.context?s.translate(...r,e):(s.logger.warn(`It seems you are nesting recursively key: ${r[0]} in key: ${e[0]}`),null)},n)),n.interpolation&&this.interpolator.reset()}const o=n.postProcess||this.options.postProcess,a=tc(o)?[o]:o;return null!=t&&a?.length&&!1!==n.applyPostProcessor&&(t=bc.handle(a,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let e,n,r,i,s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tc(t)&&(t=[t]),t.forEach(t=>{if(this.isValidLookup(e))return;const a=this.extractFromKey(t,o),l=a.key;n=l;let c=a.namespaces;this.options.fallbackNS&&(c=c.concat(this.options.fallbackNS));const h=void 0!==o.count&&!tc(o.count),u=h&&!o.ordinal&&0===o.count,d=void 0!==o.context&&(tc(o.context)||"number"==typeof o.context)&&""!==o.context,p=o.lngs?o.lngs:this.languageUtils.toResolveHierarchy(o.lng||this.language,o.fallbackLng);c.forEach(t=>{this.isValidLookup(e)||(s=t,Ac[`${p[0]}-${t}`]||!this.utils?.hasLoadedNamespace||this.utils?.hasLoadedNamespace(s)||(Ac[`${p[0]}-${t}`]=!0,this.logger.warn(`key "${n}" for languages "${p.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(n=>{if(this.isValidLookup(e))return;i=n;const s=[l];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(s,l,n,t,o);else{let t;h&&(t=this.pluralResolver.getSuffix(n,o.count,o));const e=`${this.options.pluralSeparator}zero`,r=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(h&&(s.push(l+t),o.ordinal&&0===t.indexOf(r)&&s.push(l+t.replace(r,this.options.pluralSeparator)),u&&s.push(l+e)),d){const n=`${l}${this.options.contextSeparator}${o.context}`;s.push(n),h&&(s.push(n+t),o.ordinal&&0===t.indexOf(r)&&s.push(n+t.replace(r,this.options.pluralSeparator)),u&&s.push(n+e))}}let a;for(;a=s.pop();)this.isValidLookup(e)||(r=a,e=this.getResource(n,t,a,o))}))})}),{res:e,usedKey:n,exactUsedKey:r,usedLng:i,usedNS:s}}isValidLookup(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}getResource(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat?.getResource?this.i18nFormat.getResource(t,e,n,r):this.resourceStore.getResource(t,e,n,r)}getUsedParamsDetails(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&!tc(t.replace);let r=n?t.replace:t;if(n&&void 0!==t.count&&(r.count=t.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!n){r={...r};for(const t of e)delete r[t]}return r}static hasDefaultValue(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&"defaultValue"===e.substring(0,12)&&void 0!==t[e])return!0;return!1}}class Ec{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=xc.create("languageUtils")}getScriptPartFromCode(t){if(!(t=gc(t))||t.indexOf("-")<0)return null;const e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}getLanguagePartFromCode(t){if(!(t=gc(t))||t.indexOf("-")<0)return t;const e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(tc(t)&&t.indexOf("-")>-1){let e;try{e=Intl.getCanonicalLocales(t)[0]}catch(t){}return e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach(t=>{if(e)return;const n=this.formatLanguageCode(t);this.options.supportedLngs&&!this.isSupportedCode(n)||(e=n)}),!e&&this.options.supportedLngs&&t.forEach(t=>{if(e)return;const n=this.getLanguagePartFromCode(t);if(this.isSupportedCode(n))return e=n;e=this.options.supportedLngs.find(t=>t===n?t:t.indexOf("-")<0&&n.indexOf("-")<0?void 0:t.indexOf("-")>0&&n.indexOf("-")<0&&t.substring(0,t.indexOf("-"))===n||0===t.indexOf(n)&&n.length>1?t:void 0)}),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),tc(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}toResolveHierarchy(t,e){const n=this.getFallbackCodes(e||this.options.fallbackLng||[],t),r=[],i=t=>{t&&(this.isSupportedCode(t)?r.push(t):this.logger.warn(`rejecting language code not found in supportedLngs: ${t}`))};return tc(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(t))):tc(t)&&i(this.formatLanguageCode(t)),n.forEach(t=>{r.indexOf(t)<0&&i(this.formatLanguageCode(t))}),r}}const kc={zero:0,one:1,two:2,few:3,many:4,other:5},Mc={select:t=>1===t?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class Cc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=t,this.options=e,this.logger=xc.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=gc("dev"===t?"en":t),r=e.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:n,type:r});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let s;try{s=new Intl.PluralRules(n,{type:r})}catch(n){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Mc;if(!t.match(/-|_/))return Mc;const r=this.languageUtils.getLanguagePartFromCode(t);s=this.getRule(r,e)}return this.pluralRulesCache[i]=s,s}needsPlural(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),n?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(t,n).map(t=>`${e}${t}`)}getSuffixes(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),n?n.resolvedOptions().pluralCategories.sort((t,e)=>kc[t]-kc[e]).map(t=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${t}`):[]}getSuffix(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getRule(t,n);return r?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${r.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,n))}}const Pc=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=((t,e,n)=>{const r=lc(t,n);return void 0!==r?r:lc(e,n)})(t,e,n);return!s&&i&&tc(n)&&(s=mc(t,n,r),void 0===s&&(s=mc(e,n,r))),s},Ic=t=>t.replace(/\$/g,"$$$$");class Rc{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=xc.create("interpolator"),this.options=t,this.format=t?.interpolation?.format||(t=>t),this.init(t)}init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:e,escapeValue:n,useRawValueToEscape:r,prefix:i,prefixEscaped:s,suffix:o,suffixEscaped:a,formatSeparator:l,unescapeSuffix:c,unescapePrefix:h,nestingPrefix:u,nestingPrefixEscaped:d,nestingSuffix:p,nestingSuffixEscaped:f,nestingOptionsSeparator:m,maxReplaces:g,alwaysFormat:v}=t.interpolation;this.escape=void 0!==e?e:dc,this.escapeValue=void 0===n||n,this.useRawValueToEscape=void 0!==r&&r,this.prefix=i?hc(i):s||"{{",this.suffix=o?hc(o):a||"}}",this.formatSeparator=l||",",this.unescapePrefix=c?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":c||"",this.nestingPrefix=u?hc(u):d||hc("$t("),this.nestingSuffix=p?hc(p):f||hc(")"),this.nestingOptionsSeparator=m||",",this.maxReplaces=g||1e3,this.alwaysFormat=void 0!==v&&v,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(t,e)=>t?.source===e?(t.lastIndex=0,t):new RegExp(e,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,n,r){let i,s,o;const a=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},l=t=>{if(t.indexOf(this.formatSeparator)<0){const i=Pc(e,a,t,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(i,void 0,n,{...r,...e,interpolationkey:t}):i}const i=t.split(this.formatSeparator),s=i.shift().trim(),o=i.join(this.formatSeparator).trim();return this.format(Pc(e,a,s,this.options.keySeparator,this.options.ignoreJSONStructure),o,n,{...r,...e,interpolationkey:s})};this.resetRegExp();const c=r?.missingInterpolationHandler||this.options.missingInterpolationHandler,h=void 0!==r?.interpolation?.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:t=>Ic(t)},{regex:this.regexp,safeValue:t=>this.escapeValue?Ic(this.escape(t)):Ic(t)}].forEach(e=>{for(o=0;i=e.regex.exec(t);){const n=i[1].trim();if(s=l(n),void 0===s)if("function"==typeof c){const e=c(t,i,r);s=tc(e)?e:""}else if(r&&Object.prototype.hasOwnProperty.call(r,n))s="";else{if(h){s=i[0];continue}this.logger.warn(`missed to pass in variable ${n} for interpolating ${t}`),s=""}else tc(s)||this.useRawValueToEscape||(s=nc(s));const a=e.safeValue(s);if(t=t.replace(i[0],a),h?(e.regex.lastIndex+=s.length,e.regex.lastIndex-=i[0].length):e.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),t}nest(t,e){let n,r,i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=(t,e)=>{const n=this.nestingOptionsSeparator;if(t.indexOf(n)<0)return t;const r=t.split(new RegExp(`${n}[ ]*{`));let s=`{${r[1]}`;t=r[0],s=this.interpolate(s,i);const o=s.match(/'/g),a=s.match(/"/g);((o?.length??0)%2==0&&!a||a.length%2!=0)&&(s=s.replace(/'/g,'"'));try{i=JSON.parse(s),e&&(i={...e,...i})}catch(e){return this.logger.warn(`failed parsing options string in nesting for key ${t}`,e),`${t}${n}${s}`}return i.defaultValue&&i.defaultValue.indexOf(this.prefix)>-1&&delete i.defaultValue,t};for(;n=this.nestingRegexp.exec(t);){let a=[];i={...s},i=i.replace&&!tc(i.replace)?i.replace:i,i.applyPostProcessor=!1,delete i.defaultValue;let l=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){const t=n[1].split(this.formatSeparator).map(t=>t.trim());n[1]=t.shift(),a=t,l=!0}if(r=e(o.call(this,n[1].trim(),i),i),r&&n[0]===t&&!tc(r))return r;tc(r)||(r=nc(r)),r||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${t}`),r=""),l&&(r=a.reduce((t,e)=>this.format(t,e,s.lng,{...s,interpolationkey:n[1].trim()}),r.trim())),t=t.replace(n[0],r),this.regexp.lastIndex=0}return t}}const Oc=t=>{const e={};return(n,r,i)=>{let s=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(s={...s,[i.interpolationkey]:void 0});const o=r+JSON.stringify(s);let a=e[o];return a||(a=t(gc(r),i),e[o]=a),a(n)}};class Dc{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=xc.create("formatter"),this.options=t,this.formats={number:Oc((t,e)=>{const n=new Intl.NumberFormat(t,{...e});return t=>n.format(t)}),currency:Oc((t,e)=>{const n=new Intl.NumberFormat(t,{...e,style:"currency"});return t=>n.format(t)}),datetime:Oc((t,e)=>{const n=new Intl.DateTimeFormat(t,{...e});return t=>n.format(t)}),relativetime:Oc((t,e)=>{const n=new Intl.RelativeTimeFormat(t,{...e});return t=>n.format(t,e.range||"day")}),list:Oc((t,e)=>{const n=new Intl.ListFormat(t,{...e});return t=>n.format(t)})},this.init(t)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=e.interpolation.formatSeparator||","}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=Oc(e)}format(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=e.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(t=>t.indexOf(")")>-1)){const t=i.findIndex(t=>t.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,t)].join(this.formatSeparator)}const s=i.reduce((t,e)=>{const{formatName:i,formatOptions:s}=(t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const i=r[1].substring(0,r[1].length-1);"currency"===e&&i.indexOf(":")<0?n.currency||(n.currency=i.trim()):"relativetime"===e&&i.indexOf(":")<0?n.range||(n.range=i.trim()):i.split(";").forEach(t=>{if(t){const[e,...r]=t.split(":"),i=r.join(":").trim().replace(/^'+|'+$/g,""),s=e.trim();n[s]||(n[s]=i),"false"===i&&(n[s]=!1),"true"===i&&(n[s]=!0),isNaN(i)||(n[s]=parseInt(i,10))}})}return{formatName:e,formatOptions:n}})(e);if(this.formats[i]){let e=t;try{const o=r?.formatParams?.[r.interpolationkey]||{},a=o.locale||o.lng||r.locale||r.lng||n;e=this.formats[i](t,a,{...s,...r,...o})}catch(t){this.logger.warn(t)}return e}return this.logger.warn(`there was no format function for ${i}`),t},t);return s}}class Lc extends wc{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=t,this.store=e,this.services=n,this.languageUtils=n.languageUtils,this.options=r,this.logger=xc.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(n,r.backend,r)}queueLoad(t,e,n,r){const i={},s={},o={},a={};return t.forEach(t=>{let r=!0;e.forEach(e=>{const o=`${t}|${e}`;!n.reload&&this.store.hasResourceBundle(t,e)?this.state[o]=2:this.state[o]<0||(1===this.state[o]?void 0===s[o]&&(s[o]=!0):(this.state[o]=1,r=!1,void 0===s[o]&&(s[o]=!0),void 0===i[o]&&(i[o]=!0),void 0===a[e]&&(a[e]=!0)))}),r||(o[t]=!0)}),(Object.keys(i).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(i),pending:Object.keys(s),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(a)}}loaded(t,e,n){const r=t.split("|"),i=r[0],s=r[1];e&&this.emit("failedLoading",i,s,e),!e&&n&&this.store.addResourceBundle(i,s,n,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&n&&(this.state[t]=0);const o={};this.queue.forEach(n=>{((t,e,n)=>{const{obj:r,k:i}=oc(t,e,Object);r[i]=r[i]||[],r[i].push(n)})(n.loaded,[i],s),((t,e)=>{void 0!==t.pending[e]&&(delete t.pending[e],t.pendingCount--)})(n,t),e&&n.errors.push(e),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach(t=>{o[t]||(o[t]={});const e=n.loaded[t];e.length&&e.forEach(e=>{void 0===o[t][e]&&(o[t][e]=!0)})}),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(t=>!t.done)}read(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!t.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:t,ns:e,fcName:n,tried:r,wait:i,callback:s});this.readingCalls++;const o=(o,a)=>{if(this.readingCalls--,this.waitingReads.length>0){const t=this.waitingReads.shift();this.read(t.lng,t.ns,t.fcName,t.tried,t.wait,t.callback)}o&&a&&r<this.maxRetries?setTimeout(()=>{this.read.call(this,t,e,n,r+1,2*i,s)},i):s(o,a)},a=this.backend[n].bind(this.backend);if(2!==a.length)return a(t,e,o);try{const n=a(t,e);n&&"function"==typeof n.then?n.then(t=>o(null,t)).catch(o):o(null,n)}catch(t){o(t)}}prepareLoading(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();tc(t)&&(t=this.languageUtils.toResolveHierarchy(t)),tc(e)&&(e=[e]);const i=this.queueLoad(t,e,n,r);if(!i.toLoad.length)return i.pending.length||r(),null;i.toLoad.forEach(t=>{this.loadOne(t)})}load(t,e,n){this.prepareLoading(t,e,{},n)}reload(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}loadOne(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t.split("|"),r=n[0],i=n[1];this.read(r,i,"read",void 0,void 0,(n,s)=>{n&&this.logger.warn(`${e}loading namespace ${i} for language ${r} failed`,n),!n&&s&&this.logger.log(`${e}loaded namespace ${i} for language ${r}`,s),this.loaded(t,n,s)})}saveMissing(t,e,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(!this.services?.utils?.hasLoadedNamespace||this.services?.utils?.hasLoadedNamespace(e)){if(null!=n&&""!==n){if(this.backend?.create){const a={...s,isUpdate:i},l=this.backend.create.bind(this.backend);if(l.length<6)try{let i;i=5===l.length?l(t,e,n,r,a):l(t,e,n,r),i&&"function"==typeof i.then?i.then(t=>o(null,t)).catch(o):o(null,i)}catch(t){o(t)}else l(t,e,n,r,o,a)}t&&t[0]&&this.store.addResource(t[0],e,n,r)}}else this.logger.warn(`did not save key "${n}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const Fc=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if("object"==typeof t[1]&&(e=t[1]),tc(t[1])&&(e.defaultValue=t[1]),tc(t[2])&&(e.tDescription=t[2]),"object"==typeof t[2]||"object"==typeof t[3]){const n=t[3]||t[2];Object.keys(n).forEach(t=>{e[t]=n[t]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),Bc=t=>(tc(t.ns)&&(t.ns=[t.ns]),tc(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),tc(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs?.indexOf?.("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),"boolean"==typeof t.initImmediate&&(t.initAsync=t.initImmediate),t),Nc=()=>{};class Wc extends wc{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;var n;if(super(),this.options=Bc(t),this.services={},this.logger=xc,this.modules={external:[]},n=this,Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{"function"==typeof n[t]&&(n[t]=n[t].bind(n))}),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof e&&(n=e,e={}),null==e.defaultNS&&e.ns&&(tc(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const r=Fc();this.options={...r,...this.options,...Bc(e)},this.options.interpolation={...r.interpolation,...this.options.interpolation},void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);const i=t=>t?"function"==typeof t?new t:t:null;if(!this.options.isClone){let e;this.modules.logger?xc.init(i(this.modules.logger),this.options):xc.init(null,this.options),e=this.modules.formatter?this.modules.formatter:Dc;const n=new Ec(this.options);this.store=new _c(this.options.resources,this.options);const s=this.services;s.logger=xc,s.resourceStore=this.store,s.languageUtils=n,s.pluralResolver=new Cc(n,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!e||this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format||(s.formatter=i(e),s.formatter.init(s,this.options),this.options.interpolation.format=s.formatter.format.bind(s.formatter)),s.interpolator=new Rc(this.options),s.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},s.backendConnector=new Lc(i(this.modules.backend),s.resourceStore,s,this.options),s.backendConnector.on("*",function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit(e,...r)}),this.modules.languageDetector&&(s.languageDetector=i(this.modules.languageDetector),s.languageDetector.init&&s.languageDetector.init(s,this.options.detection,this.options)),this.modules.i18nFormat&&(s.i18nFormat=i(this.modules.i18nFormat),s.i18nFormat.init&&s.i18nFormat.init(this)),this.translator=new Sc(this.services,this.options),this.translator.on("*",function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit(e,...r)}),this.modules.external.forEach(t=>{t.init&&t.init(this)})}if(this.format=this.options.interpolation.format,n||(n=Nc),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const t=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);t.length>0&&"dev"!==t[0]&&(this.options.lng=t[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(e=>{this[e]=function(){return t.store[e](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(e=>{this[e]=function(){return t.store[e](...arguments),t}});const s=ec(),o=()=>{const t=(t,e)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),s.resolve(e),n(t,e)};if(this.languages&&!this.isInitialized)return t(null,this.t.bind(this));this.changeLanguage(this.options.lng,t)};return this.options.resources||!this.options.initAsync?o():setTimeout(o,0),s}loadResources(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nc;const n=tc(t)?t:this.language;if("function"==typeof t&&(e=t),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===n?.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return e();const t=[],r=e=>{e&&"cimode"!==e&&this.services.languageUtils.toResolveHierarchy(e).forEach(e=>{"cimode"!==e&&t.indexOf(e)<0&&t.push(e)})};n?r(n):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(t=>r(t)),this.options.preload?.forEach?.(t=>r(t)),this.services.backendConnector.load(t,this.options.ns,t=>{t||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),e(t)})}else e(null)}reloadResources(t,e,n){const r=ec();return"function"==typeof t&&(n=t,t=void 0),"function"==typeof e&&(n=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),n||(n=Nc),this.services.backendConnector.reload(t,e,t=>{r.resolve(),n(t)}),r}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&bc.addPostProcessor(t),"formatter"===t.type&&(this.modules.formatter=t),"3rdParty"===t.type&&this.modules.external.push(t),this}setResolvedLanguage(t){if(t&&this.languages&&!(["cimode","dev"].indexOf(t)>-1))for(let t=0;t<this.languages.length;t++){const e=this.languages[t];if(!(["cimode","dev"].indexOf(e)>-1)&&this.store.hasLanguageSomeTranslations(e)){this.resolvedLanguage=e;break}}}changeLanguage(t,e){var n=this;this.isLanguageChangingTo=t;const r=ec();this.emit("languageChanging",t);const i=t=>{this.language=t,this.languages=this.services.languageUtils.toResolveHierarchy(t),this.resolvedLanguage=void 0,this.setResolvedLanguage(t)},s=(t,s)=>{s?(i(s),this.translator.changeLanguage(s),this.isLanguageChangingTo=void 0,this.emit("languageChanged",s),this.logger.log("languageChanged",s)):this.isLanguageChangingTo=void 0,r.resolve(function(){return n.t(...arguments)}),e&&e(t,function(){return n.t(...arguments)})},o=e=>{t||e||!this.services.languageDetector||(e=[]);const n=tc(e)?e:this.services.languageUtils.getBestMatchFromCodes(e);n&&(this.language||i(n),this.translator.language||this.translator.changeLanguage(n),this.services.languageDetector?.cacheUserLanguage?.(n)),this.loadResources(n,t=>{s(t,n)})};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t):o(this.services.languageDetector.detect()),r}getFixedT(t,e,n){var r=this;const i=function(t,e){let s;if("object"!=typeof e){for(var o=arguments.length,a=new Array(o>2?o-2:0),l=2;l<o;l++)a[l-2]=arguments[l];s=r.options.overloadTranslationOptionHandler([t,e].concat(a))}else s={...e};s.lng=s.lng||i.lng,s.lngs=s.lngs||i.lngs,s.ns=s.ns||i.ns,""!==s.keyPrefix&&(s.keyPrefix=s.keyPrefix||n||i.keyPrefix);const c=r.options.keySeparator||".";let h;return h=s.keyPrefix&&Array.isArray(t)?t.map(t=>`${s.keyPrefix}${c}${t}`):s.keyPrefix?`${s.keyPrefix}${c}${t}`:t,r.t(h,s)};return tc(t)?i.lng=t:i.lngs=t,i.ns=e,i.keyPrefix=n,i}t(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.translator?.translate(...e)}exists(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.translator?.exists(...e)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=e.lng||this.resolvedLanguage||this.languages[0],r=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;const s=(t,e)=>{const n=this.services.backendConnector.state[`${t}|${e}`];return-1===n||0===n||2===n};if(e.precheck){const t=e.precheck(this,s);if(void 0!==t)return t}return!(!this.hasResourceBundle(n,t)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!s(n,t)||r&&!s(i,t)))}loadNamespaces(t,e){const n=ec();return this.options.ns?(tc(t)&&(t=[t]),t.forEach(t=>{this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}),this.loadResources(t=>{n.resolve(),e&&e(t)}),n):(e&&e(),Promise.resolve())}loadLanguages(t,e){const n=ec();tc(t)&&(t=[t]);const r=this.options.preload||[],i=t.filter(t=>r.indexOf(t)<0&&this.services.languageUtils.isSupportedCode(t));return i.length?(this.options.preload=r.concat(i),this.loadResources(t=>{n.resolve(),e&&e(t)}),n):(e&&e(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!t)return"rtl";const e=this.services?.languageUtils||new Ec(Fc());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(e.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new Wc(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nc;const n=t.forkResourceStore;n&&delete t.forkResourceStore;const r={...this.options,...t,isClone:!0},i=new Wc(r);if(void 0===t.debug&&void 0===t.prefix||(i.logger=i.logger.clone(t)),["store","services","language"].forEach(t=>{i[t]=this[t]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},n){const t=Object.keys(this.store.data).reduce((t,e)=>(t[e]={...this.store.data[e]},Object.keys(t[e]).reduce((n,r)=>(n[r]={...t[e][r]},n),{})),{});i.store=new _c(t,r),i.services.resourceStore=i.store}return i.translator=new Sc(i.services,r),i.translator.on("*",function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i.emit(t,...n)}),i.init(r,e),i.translator.options=r,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Uc=Wc.createInstance();Uc.createInstance=Wc.createInstance,Uc.createInstance,Uc.dir,Uc.init,Uc.loadResources,Uc.reloadResources,Uc.use,Uc.changeLanguage,Uc.getFixedT,Uc.t,Uc.exists,Uc.setDefaultNamespace,Uc.hasLoadedNamespace,Uc.loadNamespaces,Uc.loadLanguages;var jc=w(function t(e){var n=this;g(this,t),S(this,"isInitialized",!1),S(this,"game",null),S(this,"view",null),S(this,"checkInitialize",function(){n.isInitialized||n.initialize()}),this.game=e,this.game.on(this.initEventName,this.checkInitialize)},[{key:"initEventName",get:function(){return"baseState"}},{key:"initialize",value:function(){Ol.log("","[checkout state ".concat(this.initEventName,"]")),this.game.currentStateName=this.initEventName,this.game.emit("checkoutState",this.initEventName)}},{key:"update",value:function(){}},{key:"resize",value:function(){}},{key:"terminate",value:function(){}}]);function Hc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function zc(t,e){if(t){if("string"==typeof t)return Hc(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hc(t,e):void 0}}function Gc(t){return function(t){if(Array.isArray(t))return Hc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||zc(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r(2062),r(9085),r(1454);var Xc=function(t,e){try{var n=null;if(t.prototype instanceof xi)if(t===Pa)try{n=new t([Kn.EMPTY])}catch(t){console.log(["createElement AnimatedSprite"],t)}else n=new t;else n=t(e);e&&e.ref&&e.ref(n);for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return i.forEach(function(t){return Vc(n,t)}),n.once("added",function(){e&&Yc(n,e)}),n}catch(t){console.log(["createElement"],t)}},Vc=function(t,e){Array.isArray(e)?e.forEach(function(e){Vc(t,e)}):t.addChild(e)};function Yc(t,e){Object.keys(e).forEach(function(n){var r;"texture"!==n?"textures"!==n?"classes"!==n?"position"!==n?t[n]=e[n]:(r=t.position).set.apply(r,Gc(e.position)):function(t,e){t.classes||Object.defineProperty(t,"classes",{get:function(){return t._classes},set:function(e){t._classes||(t._classes={}),Object.assign(t._classes,e);var n={};for(var r in t._classes)"function"==typeof t._classes[r]?n[r]=t._classes[r]():n[r]=t._classes[r];Yc(t,n)}}),t.classes=e.classes}(t,e):t.textures=e.textures.map(function(t){return $c(t)}):t.texture=$c(e.texture)})}function $c(t){try{if("string"==typeof t){var e=Kn.from(t);return e!==Kn.EMPTY?e:Ds.get(t)||Kn.WHITE}return t instanceof Kn?t:Kn.WHITE}catch(e){return console.error("getTexture",t,e),Kn.WHITE}}function qc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kc(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}r(5276),r(3362),r(4864),r(7465),r(7495),r(7745),r(906),r(8781),r(1761),r(8156);var Zc,Qc,Jc,th,eh,nh,rh,ih,sh,oh,ah,lh={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ch={duration:.5,overwrite:!1,delay:0},hh=1e8,uh=1e-8,dh=2*Math.PI,ph=dh/4,fh=0,mh=Math.sqrt,gh=Math.cos,vh=Math.sin,yh=function(t){return"string"==typeof t},xh=function(t){return"function"==typeof t},wh=function(t){return"number"==typeof t},_h=function(t){return void 0===t},bh=function(t){return"object"==typeof t},Ah=function(t){return!1!==t},Th=function(){return"undefined"!=typeof window},Sh=function(t){return xh(t)||yh(t)},Eh="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},kh=Array.isArray,Mh=/(?:-?\.?\d|\.)+/gi,Ch=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Ph=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ih=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Rh=/[+-]=-?[.\d]+/,Oh=/[^,'"\[\]\s]+/gi,Dh=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Lh={},Fh={},Bh=function(t){return(Fh=pu(t,Lh))&&pp},Nh=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Wh=function(t,e){return!e&&console.warn(t)},Uh=function(t,e){return t&&(Lh[t]=e)&&Fh&&(Fh[t]=e)||Lh},jh=function(){return 0},Hh={suppressEvents:!0,isStart:!0,kill:!1},zh={suppressEvents:!0,kill:!1},Gh={suppressEvents:!0},Xh={},Vh=[],Yh={},$h={},qh={},Kh=30,Zh=[],Qh="",Jh=function(t){var e,n,r=t[0];if(bh(r)||xh(r)||(t=[t]),!(e=(r._gsap||{}).harness)){for(n=Zh.length;n--&&!Zh[n].targetTest(r););e=Zh[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new kd(t[n],e)))||t.splice(n,1);return t},tu=function(t){return t._gsap||Jh(Gu(t))[0]._gsap},eu=function(t,e,n){return(n=t[e])&&xh(n)?t[e]():_h(n)&&t.getAttribute&&t.getAttribute(e)||n},nu=function(t,e){return(t=t.split(",")).forEach(e)||t},ru=function(t){return Math.round(1e5*t)/1e5||0},iu=function(t){return Math.round(1e7*t)/1e7||0},su=function(t,e){var n=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),"+"===n?t+r:"-"===n?t-r:"*"===n?t*r:t/r},ou=function(t,e){for(var n=e.length,r=0;t.indexOf(e[r])<0&&++r<n;);return r<n},au=function(){var t,e,n=Vh.length,r=Vh.slice(0);for(Yh={},Vh.length=0,t=0;t<n;t++)(e=r[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},lu=function(t){return!!(t._initted||t._startAt||t.add)},cu=function(t,e,n,r){Vh.length&&!Qc&&au(),t.render(e,n,r||!!(Qc&&e<0&&lu(t))),Vh.length&&!Qc&&au()},hu=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(Oh).length<2?e:yh(t)?t.trim():t},uu=function(t){return t},du=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},pu=function(t,e){for(var n in e)t[n]=e[n];return t},fu=function t(e,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(e[r]=bh(n[r])?t(e[r]||(e[r]={}),n[r]):n[r]);return e},mu=function(t,e){var n,r={};for(n in t)n in e||(r[n]=t[n]);return r},gu=function(t){var e,n=t.parent||th,r=t.keyframes?(e=kh(t.keyframes),function(t,n){for(var r in n)r in t||"duration"===r&&e||"ease"===r||(t[r]=n[r])}):du;if(Ah(t.inherit))for(;n;)r(t,n.vars.defaults),n=n.parent||n._dp;return t},vu=function(t,e,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var s,o=t[r];if(i)for(s=e[i];o&&o[i]>s;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[r]=e,e._prev=o,e.parent=e._dp=t,e},yu=function(t,e,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=e._prev,s=e._next;i?i._next=s:t[n]===e&&(t[n]=s),s?s._prev=i:t[r]===e&&(t[r]=i),e._next=e._prev=e.parent=null},xu=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},wu=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},_u=function(t,e,n,r){return t._startAt&&(Qc?t._startAt.revert(zh):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},bu=function t(e){return!e||e._ts&&t(e.parent)},Au=function(t){return t._repeat?Tu(t._tTime,t=t.duration()+t._rDelay)*t:0},Tu=function(t,e){var n=Math.floor(t=iu(t/e));return t&&n===t?n-1:n},Su=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Eu=function(t){return t._end=iu(t._start+(t._tDur/Math.abs(t._ts||t._rts||uh)||0))},ku=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=iu(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Eu(t),n._dirty||wu(n,t)),t},Mu=function(t,e){var n;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(n=Su(t.rawTime(),e),(!e._dur||Uu(0,e.totalDuration(),n)-e._tTime>uh)&&e.render(n,!0)),wu(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},Cu=function(t,e,n,r){return e.parent&&xu(e),e._start=iu((wh(n)?n:n||t!==th?Bu(t,n,e):t._time)+e._delay),e._end=iu(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),vu(t,e,"_first","_last",t._sort?"_start":0),Ou(e)||(t._recent=e),r||Mu(t,e),t._ts<0&&ku(t,t._tTime),t},Pu=function(t,e){return(Lh.ScrollTrigger||Nh("scrollTrigger",e))&&Lh.ScrollTrigger.create(e,t)},Iu=function(t,e,n,r,i){return Ld(t,e,i),t._initted?!n&&t._pt&&!Qc&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&sh!==fd.frame?(Vh.push(t),t._lazy=[i,r],1):void 0:1},Ru=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},Ou=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},Du=function(t,e,n,r){var i=t._repeat,s=iu(e)||0,o=t._tTime/t._tDur;return o&&!r&&(t._time*=s/t._dur),t._dur=s,t._tDur=i?i<0?1e10:iu(s*(i+1)+t._rDelay*i):s,o>0&&!r&&ku(t,t._tTime=t._tDur*o),t.parent&&Eu(t),n||wu(t.parent,t),t},Lu=function(t){return t instanceof Cd?wu(t):Du(t,t._dur)},Fu={_start:0,endTime:jh,totalDuration:jh},Bu=function t(e,n,r){var i,s,o,a=e.labels,l=e._recent||Fu,c=e.duration()>=hh?l.endTime(!1):e._dur;return yh(n)&&(isNaN(n)||n in a)?(s=n.charAt(0),o="%"===n.substr(-1),i=n.indexOf("="),"<"===s||">"===s?(i>=0&&(n=n.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(i<0?l:r).totalDuration()/100:1)):i<0?(n in a||(a[n]=c),a[n]):(s=parseFloat(n.charAt(i-1)+n.substr(i+1)),o&&r&&(s=s/100*(kh(r)?r[0]:r).totalDuration()),i>1?t(e,n.substr(0,i-1),r)+s:c+s)):null==n?c:+n},Nu=function(t,e,n){var r,i,s=wh(e[1]),o=(s?2:1)+(t<2?0:1),a=e[o];if(s&&(a.duration=e[1]),a.parent=n,t){for(r=a,i=n;i&&!("immediateRender"in r);)r=i.vars.defaults||{},i=Ah(i.vars.inherit)&&i.parent;a.immediateRender=Ah(r.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return new Ud(e[0],a,e[o+1])},Wu=function(t,e){return t||0===t?e(t):e},Uu=function(t,e,n){return n<t?t:n>e?e:n},ju=function(t,e){return yh(t)&&(e=Dh.exec(t))?e[1]:""},Hu=[].slice,zu=function(t,e){return t&&bh(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&bh(t[0]))&&!t.nodeType&&t!==eh},Gu=function(t,e,n){return Jc&&!e&&Jc.selector?Jc.selector(t):!yh(t)||n||!nh&&md()?kh(t)?function(t,e,n){return void 0===n&&(n=[]),t.forEach(function(t){var r;return yh(t)&&!e||zu(t,1)?(r=n).push.apply(r,Gu(t)):n.push(t)})||n}(t,n):zu(t)?Hu.call(t,0):t?[t]:[]:Hu.call((e||rh).querySelectorAll(t),0)},Xu=function(t){return t=Gu(t)[0]||Wh("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return Gu(e,n.querySelectorAll?n:n===t?Wh("Invalid scope")||rh.createElement("div"):t)}},Vu=function(t){return t.sort(function(){return.5-Math.random()})},Yu=function(t){if(xh(t))return t;var e=bh(t)?t:{each:t},n=bd(e.ease),r=e.from||0,i=parseFloat(e.base)||0,s={},o=r>0&&r<1,a=isNaN(r)||o,l=e.axis,c=r,h=r;return yh(r)?c=h={center:.5,edges:.5,end:1}[r]||0:!o&&a&&(c=r[0],h=r[1]),function(t,o,u){var d,p,f,m,g,v,y,x,w,_=(u||e).length,b=s[_];if(!b){if(!(w="auto"===e.grid?0:(e.grid||[1,hh])[1])){for(y=-hh;y<(y=u[w++].getBoundingClientRect().left)&&w<_;);w<_&&w--}for(b=s[_]=[],d=a?Math.min(w,_)*c-.5:r%w,p=w===hh?0:a?_*h/w-.5:r/w|0,y=0,x=hh,v=0;v<_;v++)f=v%w-d,m=p-(v/w|0),b[v]=g=l?Math.abs("y"===l?m:f):mh(f*f+m*m),g>y&&(y=g),g<x&&(x=g);"random"===r&&Vu(b),b.max=y-x,b.min=x,b.v=_=(parseFloat(e.amount)||parseFloat(e.each)*(w>_?_-1:l?"y"===l?_/w:w:Math.max(w,_/w))||0)*("edges"===r?-1:1),b.b=_<0?i-_:i,b.u=ju(e.amount||e.each)||0,n=n&&_<0?wd(n):n}return _=(b[t]-b.min)/b.max||0,iu(b.b+(n?n(_):_)*b.v)+b.u}},$u=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var r=iu(Math.round(parseFloat(n)/t)*t*e);return(r-r%1)/e+(wh(n)?0:ju(n))}},qu=function(t,e){var n,r,i=kh(t);return!i&&bh(t)&&(n=i=t.radius||hh,t.values?(t=Gu(t.values),(r=!wh(t[0]))&&(n*=n)):t=$u(t.increment)),Wu(e,i?xh(t)?function(e){return r=t(e),Math.abs(r-e)<=n?r:e}:function(e){for(var i,s,o=parseFloat(r?e.x:e),a=parseFloat(r?e.y:0),l=hh,c=0,h=t.length;h--;)(i=r?(i=t[h].x-o)*i+(s=t[h].y-a)*s:Math.abs(t[h]-o))<l&&(l=i,c=h);return c=!n||l<=n?t[c]:e,r||c===e||wh(e)?c:c+ju(e)}:$u(t))},Ku=function(t,e,n,r){return Wu(kh(t)?!e:!0===n?!!(n=0):!r,function(){return kh(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*r)/r})},Zu=function(t,e,n){return Wu(n,function(n){return t[~~e(n)]})},Qu=function(t){for(var e,n,r,i,s=0,o="";~(e=t.indexOf("random(",s));)r=t.indexOf(")",e),i="["===t.charAt(e+7),n=t.substr(e+7,r-e-7).match(i?Oh:Mh),o+=t.substr(s,e-s)+Ku(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),s=r+1;return o+t.substr(s,t.length-s)},Ju=function(t,e,n,r,i){var s=e-t,o=r-n;return Wu(i,function(e){return n+((e-t)/s*o||0)})},td=function(t,e,n){var r,i,s,o=t.labels,a=hh;for(r in o)(i=o[r]-e)<0==!!n&&i&&a>(i=Math.abs(i))&&(s=r,a=i);return s},ed=function(t,e,n){var r,i,s,o=t.vars,a=o[e],l=Jc,c=t._ctx;if(a)return r=o[e+"Params"],i=o.callbackScope||t,n&&Vh.length&&au(),c&&(Jc=c),s=r?a.apply(i,r):a.call(i),Jc=l,s},nd=function(t){return xu(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Qc),t.progress()<1&&ed(t,"onInterrupt"),t},rd=[],id=function(t){if(t)if(t=!t.name&&t.default||t,Th()||t.headless){var e=t.name,n=xh(t),r=e&&!n&&t.init?function(){this._props=[]}:t,i={init:jh,render:qd,add:Od,kill:Zd,modifier:Kd,rawVars:0},s={targetTest:0,get:0,getSetter:Xd,aliases:{},register:0};if(md(),t!==r){if($h[e])return;du(r,du(mu(t,i),s)),pu(r.prototype,pu(i,mu(t,s))),$h[r.prop=e]=r,t.targetTest&&(Zh.push(r),Xh[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Uh(e,r),t.register&&t.register(pp,r,tp)}else rd.push(t)},sd=255,od={aqua:[0,sd,sd],lime:[0,sd,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,sd],navy:[0,0,128],white:[sd,sd,sd],olive:[128,128,0],yellow:[sd,sd,0],orange:[sd,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[sd,0,0],pink:[sd,192,203],cyan:[0,sd,sd],transparent:[sd,sd,sd,0]},ad=function(t,e,n){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*sd+.5|0},ld=function(t,e,n){var r,i,s,o,a,l,c,h,u,d,p=t?wh(t)?[t>>16,t>>8&sd,t&sd]:0:od.black;if(!p){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),od[t])p=od[t];else if("#"===t.charAt(0)){if(t.length<6&&(r=t.charAt(1),i=t.charAt(2),s=t.charAt(3),t="#"+r+r+i+i+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(p=parseInt(t.substr(1,6),16))>>16,p>>8&sd,p&sd,parseInt(t.substr(7),16)/255];p=[(t=parseInt(t.substr(1),16))>>16,t>>8&sd,t&sd]}else if("hsl"===t.substr(0,3))if(p=d=t.match(Mh),e){if(~t.indexOf("="))return p=t.match(Ch),n&&p.length<4&&(p[3]=1),p}else o=+p[0]%360/360,a=+p[1]/100,r=2*(l=+p[2]/100)-(i=l<=.5?l*(a+1):l+a-l*a),p.length>3&&(p[3]*=1),p[0]=ad(o+1/3,r,i),p[1]=ad(o,r,i),p[2]=ad(o-1/3,r,i);else p=t.match(Mh)||od.transparent;p=p.map(Number)}return e&&!d&&(r=p[0]/sd,i=p[1]/sd,s=p[2]/sd,l=((c=Math.max(r,i,s))+(h=Math.min(r,i,s)))/2,c===h?o=a=0:(u=c-h,a=l>.5?u/(2-c-h):u/(c+h),o=c===r?(i-s)/u+(i<s?6:0):c===i?(s-r)/u+2:(r-i)/u+4,o*=60),p[0]=~~(o+.5),p[1]=~~(100*a+.5),p[2]=~~(100*l+.5)),n&&p.length<4&&(p[3]=1),p},cd=function(t){var e=[],n=[],r=-1;return t.split(ud).forEach(function(t){var i=t.match(Ph)||[];e.push.apply(e,i),n.push(r+=i.length+1)}),e.c=n,e},hd=function(t,e,n){var r,i,s,o,a="",l=(t+a).match(ud),c=e?"hsla(":"rgba(",h=0;if(!l)return t;if(l=l.map(function(t){return(t=ld(t,e,1))&&c+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"}),n&&(s=cd(t),(r=n.c).join(a)!==s.c.join(a)))for(o=(i=t.replace(ud,"1").split(Ph)).length-1;h<o;h++)a+=i[h]+(~r.indexOf(h)?l.shift()||c+"0,0,0,0)":(s.length?s:l.length?l:n).shift());if(!i)for(o=(i=t.split(ud)).length-1;h<o;h++)a+=i[h]+l[h];return a+i[o]},ud=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in od)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),dd=/hsl[a]?\(/,pd=function(t){var e,n=t.join(" ");if(ud.lastIndex=0,ud.test(n))return e=dd.test(n),t[1]=hd(t[1],e),t[0]=hd(t[0],e,cd(t[1])),!0},fd=function(){var t,e,n,r,i,s,o=Date.now,a=500,l=33,c=o(),h=c,u=1e3/240,d=u,p=[],f=function n(f){var m,g,v,y,x=o()-h,w=!0===f;if((x>a||x<0)&&(c+=x-l),((m=(v=(h+=x)-c)-d)>0||w)&&(y=++r.frame,i=v-1e3*r.time,r.time=v/=1e3,d+=m+(m>=u?4:u-m),g=1),w||(t=e(n)),g)for(s=0;s<p.length;s++)p[s](v,i,y,f)};return r={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(t){return i/(1e3/(t||60))},wake:function(){ih&&(!nh&&Th()&&(eh=nh=window,rh=eh.document||{},Lh.gsap=pp,(eh.gsapVersions||(eh.gsapVersions=[])).push(pp.version),Bh(Fh||eh.GreenSockGlobals||!eh.gsap&&eh||{}),rd.forEach(id)),n="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,t&&r.sleep(),e=n||function(t){return setTimeout(t,d-1e3*r.time+1|0)},ah=1,f(2))},sleep:function(){(n?cancelAnimationFrame:clearTimeout)(t),ah=0,e=jh},lagSmoothing:function(t,e){a=t||1/0,l=Math.min(e||33,a)},fps:function(t){u=1e3/(t||240),d=1e3*r.time+u},add:function(t,e,n){var i=e?function(e,n,s,o){t(e,n,s,o),r.remove(i)}:t;return r.remove(t),p[n?"unshift":"push"](i),md(),i},remove:function(t,e){~(e=p.indexOf(t))&&p.splice(e,1)&&s>=e&&s--},_listeners:p},r}(),md=function(){return!ah&&fd.wake()},gd={},vd=/^[\d.\-M][\d.\-,\s]/,yd=/["']/g,xd=function(t){for(var e,n,r,i={},s=t.substr(1,t.length-3).split(":"),o=s[0],a=1,l=s.length;a<l;a++)n=s[a],e=a!==l-1?n.lastIndexOf(","):n.length,r=n.substr(0,e),i[o]=isNaN(r)?r.replace(yd,"").trim():+r,o=n.substr(e+1).trim();return i},wd=function(t){return function(e){return 1-t(1-e)}},_d=function t(e,n){for(var r,i=e._first;i;)i instanceof Cd?t(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?t(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},bd=function(t,e){return t&&(xh(t)?t:gd[t]||function(t){var e,n,r,i,s=(t+"").split("("),o=gd[s[0]];return o&&s.length>1&&o.config?o.config.apply(null,~t.indexOf("{")?[xd(s[1])]:(e=t,n=e.indexOf("(")+1,r=e.indexOf(")"),i=e.indexOf("(",n),e.substring(n,~i&&i<r?e.indexOf(")",r+1):r)).split(",").map(hu)):gd._CE&&vd.test(t)?gd._CE("",t):o}(t))||e},Ad=function(t,e,n,r){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===r&&(r=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var i,s={easeIn:e,easeOut:n,easeInOut:r};return nu(t,function(t){for(var e in gd[t]=Lh[t]=s,gd[i=t.toLowerCase()]=n,s)gd[i+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=gd[t+"."+e]=s[e]}),s},Td=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},Sd=function t(e,n,r){var i=n>=1?n:1,s=(r||(e?.3:.45))/(n<1?n:1),o=s/dh*(Math.asin(1/i)||0),a=function(t){return 1===t?1:i*Math.pow(2,-10*t)*vh((t-o)*s)+1},l="out"===e?a:"in"===e?function(t){return 1-a(1-t)}:Td(a);return s=dh/s,l.config=function(n,r){return t(e,n,r)},l},Ed=function t(e,n){void 0===n&&(n=1.70158);var r=function(t){return t?--t*t*((n+1)*t+n)+1:0},i="out"===e?r:"in"===e?function(t){return 1-r(1-t)}:Td(r);return i.config=function(n){return t(e,n)},i};nu("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var n=e<5?e+1:e;Ad(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},function(t){return 1-Math.pow(1-t,n)},function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2})}),gd.Linear.easeNone=gd.none=gd.Linear.easeIn,Ad("Elastic",Sd("in"),Sd("out"),Sd()),function(t,e){var n=1/e,r=2*n,i=2.5*n,s=function(s){return s<n?t*s*s:s<r?t*Math.pow(s-1.5/e,2)+.75:s<i?t*(s-=2.25/e)*s+.9375:t*Math.pow(s-2.625/e,2)+.984375};Ad("Bounce",function(t){return 1-s(1-t)},s)}(7.5625,2.75),Ad("Expo",function(t){return Math.pow(2,10*(t-1))*t+t*t*t*t*t*t*(1-t)}),Ad("Circ",function(t){return-(mh(1-t*t)-1)}),Ad("Sine",function(t){return 1===t?1:1-gh(t*ph)}),Ad("Back",Ed("in"),Ed("out"),Ed()),gd.SteppedEase=gd.steps=Lh.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,r=t+(e?0:1),i=e?1:0;return function(t){return((r*Uu(0,.99999999,t)|0)+i)*n}}},ch.ease=gd["quad.out"],nu("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return Qh+=t+","+t+"Params,"});var kd=function(t,e){this.id=fh++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:eu,this.set=e?e.getSetter:Xd},Md=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Du(this,+t.duration,1,1),this.data=t.data,Jc&&(this._ctx=Jc,Jc.data.push(this)),ah||fd.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,Du(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(md(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(ku(this,t),!n._dp||n.parent||Mu(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&Cu(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===uh||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),cu(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+Au(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+Au(this),e):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?Tu(this._tTime,n)+1:1},e.timeScale=function(t,e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var n=this.parent&&this._ts?Su(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(Uu(-Math.abs(this._delay),this.totalDuration(),n),!1!==e),Eu(this),function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t}(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(md(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==uh&&(this._tTime-=uh)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&Cu(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(Ah(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Su(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=Gh);var e=Qc;return Qc=t,lu(this)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),Qc=e,this},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(Math.abs(e._ts)||1),e=e._dp;return!this.parent&&this._sat?this._sat.globalTime(t):n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,Lu(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,Lu(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(Bu(this,t),Ah(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,Ah(e)),this._dur||(this._zTime=-1e-8),this},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-uh))},e.eventCallback=function(t,e,n){var r=this.vars;return arguments.length>1?(e?(r[t]=e,n&&(r[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete r[t],this):r[t]},e.then=function(t){var e=this;return new Promise(function(n){var r=xh(t)?t:uu,i=function(){var t=e.then;e.then=null,xh(r)&&(r=r(e))&&(r.then||r===e)&&(e.then=t),n(r),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?i():e._prom=i})},e.kill=function(){nd(this)},t}();du(Md.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Cd=function(t){function e(e,n){var r;return void 0===e&&(e={}),(r=t.call(this,e)||this).labels={},r.smoothChildTiming=!!e.smoothChildTiming,r.autoRemoveChildren=!!e.autoRemoveChildren,r._sort=Ah(e.sortChildren),th&&Cu(e.parent||th,qc(r),n),e.reversed&&r.reverse(),e.paused&&r.paused(!0),e.scrollTrigger&&Pu(qc(r),e.scrollTrigger),r}Kc(e,t);var n=e.prototype;return n.to=function(t,e,n){return Nu(0,arguments,this),this},n.from=function(t,e,n){return Nu(1,arguments,this),this},n.fromTo=function(t,e,n,r){return Nu(2,arguments,this),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,gu(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Ud(t,e,Bu(this,n),1),this},n.call=function(t,e,n){return Cu(this,Ud.delayedCall(0,t,e),n)},n.staggerTo=function(t,e,n,r,i,s,o){return n.duration=e,n.stagger=n.stagger||r,n.onComplete=s,n.onCompleteParams=o,n.parent=this,new Ud(t,n,Bu(this,i)),this},n.staggerFrom=function(t,e,n,r,i,s,o){return n.runBackwards=1,gu(n).immediateRender=Ah(n.immediateRender),this.staggerTo(t,e,n,r,i,s,o)},n.staggerFromTo=function(t,e,n,r,i,s,o,a){return r.startAt=n,gu(r).immediateRender=Ah(r.immediateRender),this.staggerTo(t,e,r,i,s,o,a)},n.render=function(t,e,n){var r,i,s,o,a,l,c,h,u,d,p,f,m=this._time,g=this._dirty?this.totalDuration():this._tDur,v=this._dur,y=t<=0?0:iu(t),x=this._zTime<0!=t<0&&(this._initted||!v);if(this!==th&&y>g&&t>=0&&(y=g),y!==this._tTime||n||x){if(m!==this._time&&v&&(y+=this._time-m,t+=this._time-m),r=y,u=this._start,l=!(h=this._ts),x&&(v||(m=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(p=this._yoyo,a=v+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*a+t,e,n);if(r=iu(y%a),y===g?(o=this._repeat,r=v):((o=~~(d=iu(y/a)))&&o===d&&(r=v,o--),r>v&&(r=v)),d=Tu(this._tTime,a),!m&&this._tTime&&d!==o&&this._tTime-d*a-this._dur<=0&&(d=o),p&&1&o&&(r=v-r,f=1),o!==d&&!this._lock){var w=p&&1&d,_=w===(p&&1&o);if(o<d&&(w=!w),m=w?0:y%v?v:y,this._lock=1,this.render(m||(f?0:iu(o*a)),e,!v)._lock=0,this._tTime=y,!e&&this.parent&&ed(this,"onRepeat"),this.vars.repeatRefresh&&!f&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(v=this._dur,g=this._tDur,_&&(this._lock=2,m=w?v:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!f&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;_d(this,f)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(t,e,n){var r;if(n>e)for(r=t._first;r&&r._start<=n;){if("isPause"===r.data&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=n;){if("isPause"===r.data&&r._start<e)return r;r=r._prev}}(this,iu(m),iu(r)),c&&(y-=r-(r=c._start))),this._tTime=y,this._time=r,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,m=0),!m&&y&&!e&&!d&&(ed(this,"onStart"),this._tTime!==y))return this;if(r>=m&&t>=0)for(i=this._first;i;){if(s=i._next,(i._act||r>=i._start)&&i._ts&&c!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(r-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(r-i._start)*i._ts,e,n),r!==this._time||!this._ts&&!l){c=0,s&&(y+=this._zTime=-1e-8);break}}i=s}else{i=this._last;for(var b=t<0?t:r;i;){if(s=i._prev,(i._act||b<=i._end)&&i._ts&&c!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(b-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(b-i._start)*i._ts,e,n||Qc&&lu(i)),r!==this._time||!this._ts&&!l){c=0,s&&(y+=this._zTime=b?-1e-8:uh);break}}i=s}}if(c&&!e&&(this.pause(),c.render(r>=m?0:-1e-8)._zTime=r>=m?1:-1,this._ts))return this._start=u,Eu(this),this.render(t,e,n);this._onUpdate&&!e&&ed(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&m)&&(u!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||((t||!v)&&(y===g&&this._ts>0||!y&&this._ts<0)&&xu(this,1),e||t<0&&!m||!y&&!m&&g||(ed(this,y===g&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(wh(e)||(e=Bu(this,e,t)),!(t instanceof Md)){if(kh(t))return t.forEach(function(t){return n.add(t,e)}),this;if(yh(t))return this.addLabel(t,e);if(!xh(t))return this;t=Ud.delayedCall(0,t)}return this!==t?Cu(this,t,e):this},n.getChildren=function(t,e,n,r){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===r&&(r=-hh);for(var i=[],s=this._first;s;)s._start>=r&&(s instanceof Ud?e&&i.push(s):(n&&i.push(s),t&&i.push.apply(i,s.getChildren(!0,e,n)))),s=s._next;return i},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return yh(t)?this.removeLabel(t):xh(t)?this.killTweensOf(t):(t.parent===this&&yu(this,t),t===this._recent&&(this._recent=this._last),wu(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=iu(fd.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=Bu(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var r=Ud.delayedCall(0,e||jh,n);return r.data="isPause",this._hasPause=1,Cu(this,r,Bu(this,t))},n.removePause=function(t){var e=this._first;for(t=Bu(this,t);e;)e._start===t&&"isPause"===e.data&&xu(e),e=e._next},n.killTweensOf=function(t,e,n){for(var r=this.getTweensOf(t,n),i=r.length;i--;)Pd!==r[i]&&r[i].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,r=[],i=Gu(t),s=this._first,o=wh(e);s;)s instanceof Ud?ou(s._targets,i)&&(o?(!Pd||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&r.push(s):(n=s.getTweensOf(i,e)).length&&r.push.apply(r,n),s=s._next;return r},n.tweenTo=function(t,e){e=e||{};var n,r=this,i=Bu(r,t),s=e,o=s.startAt,a=s.onStart,l=s.onStartParams,c=s.immediateRender,h=Ud.to(r,du({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:e.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale())||uh,onStart:function(){if(r.pause(),!n){var t=e.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale());h._dur!==t&&Du(h,t,0,1).render(h._time,!0,!0),n=1}a&&a.apply(h,l||[])}},e));return c?h.render(0):h},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,du({startAt:{time:Bu(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),td(this,Bu(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),td(this,Bu(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+uh)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var r,i=this._first,s=this.labels;i;)i._start>=n&&(i._start+=t,i._end+=t),i=i._next;if(e)for(r in s)s[r]>=n&&(s[r]+=t);return wu(this)},n.invalidate=function(e){var n=this._first;for(this._lock=0;n;)n.invalidate(e),n=n._next;return t.prototype.invalidate.call(this,e)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),wu(this)},n.totalDuration=function(t){var e,n,r,i=0,s=this,o=s._last,a=hh;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(r=s.parent;o;)e=o._prev,o._dirty&&o.totalDuration(),(n=o._start)>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,Cu(s,o,n-o._delay,1)._lock=0):a=n,n<0&&o._ts&&(i-=n,(!r&&!s._dp||r&&r.smoothChildTiming)&&(s._start+=n/s._ts,s._time-=n,s._tTime-=n),s.shiftChildren(-n,!1,-1/0),a=0),o._end>i&&o._ts&&(i=o._end),o=e;Du(s,s===th&&s._time>i?s._time:i,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(t){if(th._ts&&(cu(th,Su(t,th)),sh=fd.frame),fd.frame>=Kh){Kh+=lh.autoSleep||120;var e=th._first;if((!e||!e._ts)&&lh.autoSleep&&fd._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||fd.sleep()}}},e}(Md);du(Cd.prototype,{_lock:0,_hasPause:0,_forcing:0});var Pd,Id,Rd=function(t,e,n,r,i,s,o){var a,l,c,h,u,d,p,f,m=new tp(this._pt,t,e,0,1,$d,null,i),g=0,v=0;for(m.b=n,m.e=r,n+="",(p=~(r+="").indexOf("random("))&&(r=Qu(r)),s&&(s(f=[n,r],t,e),n=f[0],r=f[1]),l=n.match(Ih)||[];a=Ih.exec(r);)h=a[0],u=r.substring(g,a.index),c?c=(c+1)%5:"rgba("===u.substr(-5)&&(c=1),h!==l[v++]&&(d=parseFloat(l[v-1])||0,m._pt={_next:m._pt,p:u||1===v?u:",",s:d,c:"="===h.charAt(1)?su(d,h)-d:parseFloat(h)-d,m:c&&c<4?Math.round:0},g=Ih.lastIndex);return m.c=g<r.length?r.substring(g,r.length):"",m.fp=o,(Rh.test(r)||p)&&(m.e=0),this._pt=m,m},Od=function(t,e,n,r,i,s,o,a,l,c){xh(r)&&(r=r(i||0,t,s));var h,u=t[e],d="get"!==n?n:xh(u)?l?t[e.indexOf("set")||!xh(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():u,p=xh(u)?l?zd:Hd:jd;if(yh(r)&&(~r.indexOf("random(")&&(r=Qu(r)),"="===r.charAt(1)&&((h=su(d,r)+(ju(d)||0))||0===h)&&(r=h)),!c||d!==r||Id)return isNaN(d*r)||""===r?(!u&&!(e in t)&&Nh(e,r),Rd.call(this,t,e,d,r,p,a||lh.stringFilter,l)):(h=new tp(this._pt,t,e,+d||0,r-(d||0),"boolean"==typeof u?Yd:Vd,0,p),l&&(h.fp=l),o&&h.modifier(o,this,t),this._pt=h)},Dd=function(t,e,n,r,i,s){var o,a,l,c;if($h[t]&&!1!==(o=new $h[t]).init(i,o.rawVars?e[t]:function(t,e,n,r,i){if(xh(t)&&(t=Bd(t,i,e,n,r)),!bh(t)||t.style&&t.nodeType||kh(t)||Eh(t))return yh(t)?Bd(t,i,e,n,r):t;var s,o={};for(s in t)o[s]=Bd(t[s],i,e,n,r);return o}(e[t],r,i,s,n),n,r,s)&&(n._pt=a=new tp(n._pt,i,t,0,1,o.render,o,0,o.priority),n!==oh))for(l=n._ptLookup[n._targets.indexOf(i)],c=o._props.length;c--;)l[o._props[c]]=a;return o},Ld=function t(e,n,r){var i,s,o,a,l,c,h,u,d,p,f,m,g,v=e.vars,y=v.ease,x=v.startAt,w=v.immediateRender,_=v.lazy,b=v.onUpdate,A=v.runBackwards,T=v.yoyoEase,S=v.keyframes,E=v.autoRevert,k=e._dur,M=e._startAt,C=e._targets,P=e.parent,I=P&&"nested"===P.data?P.vars.targets:C,R="auto"===e._overwrite&&!Zc,O=e.timeline;if(O&&(!S||!y)&&(y="none"),e._ease=bd(y,ch.ease),e._yEase=T?wd(bd(!0===T?y:T,ch.ease)):0,T&&e._yoyo&&!e._repeat&&(T=e._yEase,e._yEase=e._ease,e._ease=T),e._from=!O&&!!v.runBackwards,!O||S&&!v.stagger){if(m=(u=C[0]?tu(C[0]).harness:0)&&v[u.prop],i=mu(v,Xh),M&&(M._zTime<0&&M.progress(1),n<0&&A&&w&&!E?M.render(-1,!0):M.revert(A&&k?zh:Hh),M._lazy=0),x){if(xu(e._startAt=Ud.set(C,du({data:"isStart",overwrite:!1,parent:P,immediateRender:!0,lazy:!M&&Ah(_),startAt:null,delay:0,onUpdate:b&&function(){return ed(e,"onUpdate")},stagger:0},x))),e._startAt._dp=0,e._startAt._sat=e,n<0&&(Qc||!w&&!E)&&e._startAt.revert(zh),w&&k&&n<=0&&r<=0)return void(n&&(e._zTime=n))}else if(A&&k&&!M)if(n&&(w=!1),o=du({overwrite:!1,data:"isFromStart",lazy:w&&!M&&Ah(_),immediateRender:w,stagger:0,parent:P},i),m&&(o[u.prop]=m),xu(e._startAt=Ud.set(C,o)),e._startAt._dp=0,e._startAt._sat=e,n<0&&(Qc?e._startAt.revert(zh):e._startAt.render(-1,!0)),e._zTime=n,w){if(!n)return}else t(e._startAt,uh,uh);for(e._pt=e._ptCache=0,_=k&&Ah(_)||_&&!k,s=0;s<C.length;s++){if(h=(l=C[s])._gsap||Jh(C)[s]._gsap,e._ptLookup[s]=p={},Yh[h.id]&&Vh.length&&au(),f=I===C?s:I.indexOf(l),u&&!1!==(d=new u).init(l,m||i,e,f,I)&&(e._pt=a=new tp(e._pt,l,d.name,0,1,d.render,d,0,d.priority),d._props.forEach(function(t){p[t]=a}),d.priority&&(c=1)),!u||m)for(o in i)$h[o]&&(d=Dd(o,i,e,f,l,I))?d.priority&&(c=1):p[o]=a=Od.call(e,l,o,"get",i[o],f,I,0,v.stringFilter);e._op&&e._op[s]&&e.kill(l,e._op[s]),R&&e._pt&&(Pd=e,th.killTweensOf(l,p,e.globalTime(n)),g=!e.parent,Pd=0),e._pt&&_&&(Yh[h.id]=1)}c&&Jd(e),e._onInit&&e._onInit(e)}e._onUpdate=b,e._initted=(!e._op||e._pt)&&!g,S&&n<=0&&O.render(hh,!0,!0)},Fd=function(t,e,n,r){var i,s,o=e.ease||r||"power1.inOut";if(kh(e))s=n[t]||(n[t]=[]),e.forEach(function(t,n){return s.push({t:n/(e.length-1)*100,v:t,e:o})});else for(i in e)s=n[i]||(n[i]=[]),"ease"===i||s.push({t:parseFloat(t),v:e[i],e:o})},Bd=function(t,e,n,r,i){return xh(t)?t.call(e,n,r,i):yh(t)&&~t.indexOf("random(")?Qu(t):t},Nd=Qh+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Wd={};nu(Nd+",id,stagger,delay,duration,paused,scrollTrigger",function(t){return Wd[t]=1});var Ud=function(t){function e(e,n,r,i){var s;"number"==typeof n&&(r.duration=n,n=r,r=null);var o,a,l,c,h,u,d,p,f=(s=t.call(this,i?n:gu(n))||this).vars,m=f.duration,g=f.delay,v=f.immediateRender,y=f.stagger,x=f.overwrite,w=f.keyframes,_=f.defaults,b=f.scrollTrigger,A=f.yoyoEase,T=n.parent||th,S=(kh(e)||Eh(e)?wh(e[0]):"length"in n)?[e]:Gu(e);if(s._targets=S.length?Jh(S):Wh("GSAP target "+e+" not found. https://gsap.com",!lh.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=x,w||y||Sh(m)||Sh(g)){if(n=s.vars,(o=s.timeline=new Cd({data:"nested",defaults:_||{},targets:T&&"nested"===T.data?T.vars.targets:S})).kill(),o.parent=o._dp=qc(s),o._start=0,y||Sh(m)||Sh(g)){if(c=S.length,d=y&&Yu(y),bh(y))for(h in y)~Nd.indexOf(h)&&(p||(p={}),p[h]=y[h]);for(a=0;a<c;a++)(l=mu(n,Wd)).stagger=0,A&&(l.yoyoEase=A),p&&pu(l,p),u=S[a],l.duration=+Bd(m,qc(s),a,u,S),l.delay=(+Bd(g,qc(s),a,u,S)||0)-s._delay,!y&&1===c&&l.delay&&(s._delay=g=l.delay,s._start+=g,l.delay=0),o.to(u,l,d?d(a,u,S):0),o._ease=gd.none;o.duration()?m=g=0:s.timeline=0}else if(w){gu(du(o.vars.defaults,{ease:"none"})),o._ease=bd(w.ease||n.ease||"none");var E,k,M,C=0;if(kh(w))w.forEach(function(t){return o.to(S,t,">")}),o.duration();else{for(h in l={},w)"ease"===h||"easeEach"===h||Fd(h,w[h],l,w.easeEach);for(h in l)for(E=l[h].sort(function(t,e){return t.t-e.t}),C=0,a=0;a<E.length;a++)(M={ease:(k=E[a]).e,duration:(k.t-(a?E[a-1].t:0))/100*m})[h]=k.v,o.to(S,M,C),C+=M.duration;o.duration()<m&&o.to({},{duration:m-o.duration()})}}m||s.duration(m=o.duration())}else s.timeline=0;return!0!==x||Zc||(Pd=qc(s),th.killTweensOf(S),Pd=0),Cu(T,qc(s),r),n.reversed&&s.reverse(),n.paused&&s.paused(!0),(v||!m&&!w&&s._start===iu(T._time)&&Ah(v)&&bu(qc(s))&&"nested"!==T.data)&&(s._tTime=-1e-8,s.render(Math.max(0,-g)||0)),b&&Pu(qc(s),b),s}Kc(e,t);var n=e.prototype;return n.render=function(t,e,n){var r,i,s,o,a,l,c,h,u,d=this._time,p=this._tDur,f=this._dur,m=t<0,g=t>p-uh&&!m?p:t<uh?0:t;if(f){if(g!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m||this._lazy){if(r=g,h=this.timeline,this._repeat){if(o=f+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*o+t,e,n);if(r=iu(g%o),g===p?(s=this._repeat,r=f):(s=~~(a=iu(g/o)))&&s===a?(r=f,s--):r>f&&(r=f),(l=this._yoyo&&1&s)&&(u=this._yEase,r=f-r),a=Tu(this._tTime,o),r===d&&!n&&this._initted&&s===a)return this._tTime=g,this;s!==a&&(h&&this._yEase&&_d(h,l),this.vars.repeatRefresh&&!l&&!this._lock&&r!==o&&this._initted&&(this._lock=n=1,this.render(iu(o*s),!0).invalidate()._lock=0))}if(!this._initted){if(Iu(this,m?t:r,n,e,g))return this._tTime=0,this;if(!(d===this._time||n&&this.vars.repeatRefresh&&s!==a))return this;if(f!==this._dur)return this.render(t,e,n)}if(this._tTime=g,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(u||this._ease)(r/f),this._from&&(this.ratio=c=1-c),!d&&g&&!e&&!a&&(ed(this,"onStart"),this._tTime!==g))return this;for(i=this._pt;i;)i.r(c,i.d),i=i._next;h&&h.render(t<0?t:h._dur*h._ease(r/this._dur),e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(m&&_u(this,t,0,n),ed(this,"onUpdate")),this._repeat&&s!==a&&this.vars.onRepeat&&!e&&this.parent&&ed(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(m&&!this._onUpdate&&_u(this,t,0,!0),(t||!f)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&xu(this,1),e||m&&!d||!(g||d||l)||(ed(this,g===p?"onComplete":"onReverseComplete",!0),this._prom&&!(g<p&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,r){var i,s,o,a=t.ratio,l=e<0||!e&&(!t._start&&Ru(t)&&(t._initted||!Ou(t))||(t._ts<0||t._dp._ts<0)&&!Ou(t))?0:1,c=t._rDelay,h=0;if(c&&t._repeat&&(h=Uu(0,t._tDur,e),s=Tu(h,c),t._yoyo&&1&s&&(l=1-l),s!==Tu(t._tTime,c)&&(a=1-l,t.vars.repeatRefresh&&t._initted&&t.invalidate())),l!==a||Qc||r||t._zTime===uh||!e&&t._zTime){if(!t._initted&&Iu(t,e,r,n,h))return;for(o=t._zTime,t._zTime=e||(n?uh:0),n||(n=e&&!o),t.ratio=l,t._from&&(l=1-l),t._time=0,t._tTime=h,i=t._pt;i;)i.r(l,i.d),i=i._next;e<0&&_u(t,e,0,!0),t._onUpdate&&!n&&ed(t,"onUpdate"),h&&t._repeat&&!n&&t.parent&&ed(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===l&&(l&&xu(t,1),n||Qc||(ed(t,l?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},n.resetTo=function(t,e,n,r,i){ah||fd.wake(),this._ts||this.play();var s=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||Ld(this,s),function(t,e,n,r,i,s,o,a){var l,c,h,u,d=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!d)for(d=t._ptCache[e]=[],h=t._ptLookup,u=t._targets.length;u--;){if((l=h[u][e])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return Id=1,t.vars[e]="+=0",Ld(t,o),Id=0,a?Wh(e+" not eligible for reset"):1;d.push(l)}for(u=d.length;u--;)(l=(c=d[u])._pt||c).s=!r&&0!==r||i?l.s+(r||0)+s*l.c:r,l.c=n-l.s,c.e&&(c.e=ru(n)+ju(c.e)),c.b&&(c.b=l.s+ju(c.b))}(this,t,e,n,r,this._ease(s/this._dur),s,i)?this.resetTo(t,e,n,r,1):(ku(this,0),this.parent||vu(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?nd(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Qc),this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,Pd&&!0!==Pd.vars.overwrite)._first||nd(this),this.parent&&n!==this.timeline.totalDuration()&&Du(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,s,o,a,l,c,h=this._targets,u=t?Gu(t):h,d=this._ptLookup,p=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,r=n===e.length;r&&n--&&t[n]===e[n];);return n<0}(h,u))return"all"===e&&(this._pt=0),nd(this);for(r=this._op=this._op||[],"all"!==e&&(yh(e)&&(a={},nu(e,function(t){return a[t]=1}),e=a),e=function(t,e){var n,r,i,s,o=t[0]?tu(t[0]).harness:0,a=o&&o.aliases;if(!a)return e;for(r in n=pu({},e),a)if(r in n)for(i=(s=a[r].split(",")).length;i--;)n[s[i]]=n[r];return n}(h,e)),c=h.length;c--;)if(~u.indexOf(h[c]))for(a in i=d[c],"all"===e?(r[c]=e,o=i,s={}):(s=r[c]=r[c]||{},o=e),o)(l=i&&i[a])&&("kill"in l.d&&!0!==l.d.kill(a)||yu(this,l,"_pt"),delete i[a]),"all"!==s&&(s[a]=1);return this._initted&&!this._pt&&p&&nd(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,e){return Nu(1,arguments)},e.delayedCall=function(t,n,r,i){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},e.fromTo=function(t,e,n){return Nu(2,arguments)},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return th.killTweensOf(t,e,n)},e}(Md);du(Ud.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),nu("staggerTo,staggerFrom,staggerFromTo",function(t){Ud[t]=function(){var e=new Cd,n=Hu.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}});var jd=function(t,e,n){return t[e]=n},Hd=function(t,e,n){return t[e](n)},zd=function(t,e,n,r){return t[e](r.fp,n)},Gd=function(t,e,n){return t.setAttribute(e,n)},Xd=function(t,e){return xh(t[e])?Hd:_h(t[e])&&t.setAttribute?Gd:jd},Vd=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},Yd=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},$d=function(t,e){var n=e._pt,r="";if(!t&&e.b)r=e.b;else if(1===t&&e.e)r=e.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+r,n=n._next;r+=e.c}e.set(e.t,e.p,r,e)},qd=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},Kd=function(t,e,n,r){for(var i,s=this._pt;s;)i=s._next,s.p===r&&s.modifier(t,e,n),s=i},Zd=function(t){for(var e,n,r=this._pt;r;)n=r._next,r.p===t&&!r.op||r.op===t?yu(this,r,"_pt"):r.dep||(e=1),r=n;return!e},Qd=function(t,e,n,r){r.mSet(t,e,r.m.call(r.tween,n,r.mt),r)},Jd=function(t){for(var e,n,r,i,s=t._pt;s;){for(e=s._next,n=r;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:i)?s._prev._next=s:r=s,(s._next=n)?n._prev=s:i=s,s=e}t._pt=r},tp=function(){function t(t,e,n,r,i,s,o,a,l){this.t=e,this.s=r,this.c=i,this.p=n,this.r=s||Vd,this.d=o||this,this.set=a||jd,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=Qd,this.m=t,this.mt=n,this.tween=e},t}();nu(Qh+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return Xh[t]=1}),Lh.TweenMax=Lh.TweenLite=Ud,Lh.TimelineLite=Lh.TimelineMax=Cd,th=new Cd({sortChildren:!1,defaults:ch,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),lh.stringFilter=pd;var ep=[],np={},rp=[],ip=0,sp=0,op=function(t){return(np[t]||rp).map(function(t){return t()})},ap=function(){var t=Date.now(),e=[];t-ip>2&&(op("matchMediaInit"),ep.forEach(function(t){var n,r,i,s,o=t.queries,a=t.conditions;for(r in o)(n=eh.matchMedia(o[r]).matches)&&(i=1),n!==a[r]&&(a[r]=n,s=1);s&&(t.revert(),i&&e.push(t))}),op("matchMediaRevert"),e.forEach(function(t){return t.onMatch(t,function(e){return t.add(null,e)})}),ip=t,op("matchMedia"))},lp=function(){function t(t,e){this.selector=e&&Xu(e),this.data=[],this._r=[],this.isReverted=!1,this.id=sp++,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,n){xh(t)&&(n=e,e=t,t=xh);var r=this,i=function(){var t,i=Jc,s=r.selector;return i&&i!==r&&i.data.push(r),n&&(r.selector=Xu(n)),Jc=r,t=e.apply(r,arguments),xh(t)&&r._r.push(t),Jc=i,r.selector=s,r.isReverted=!1,t};return r.last=i,t===xh?i(r,function(t){return r.add(null,t)}):t?r[t]=i:i},e.ignore=function(t){var e=Jc;Jc=null,t(this),Jc=e},e.getTweens=function(){var e=[];return this.data.forEach(function(n){return n instanceof t?e.push.apply(e,n.getTweens()):n instanceof Ud&&!(n.parent&&"nested"===n.parent.data)&&e.push(n)}),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var n=this;if(t?function(){for(var e,r=n.getTweens(),i=n.data.length;i--;)"isFlip"===(e=n.data[i]).data&&(e.revert(),e.getChildren(!0,!0,!1).forEach(function(t){return r.splice(r.indexOf(t),1)}));for(r.map(function(t){return{g:t._dur||t._delay||t._sat&&!t._sat.vars.immediateRender?t.globalTime(0):-1/0,t:t}}).sort(function(t,e){return e.g-t.g||-1/0}).forEach(function(e){return e.t.revert(t)}),i=n.data.length;i--;)(e=n.data[i])instanceof Cd?"nested"!==e.data&&(e.scrollTrigger&&e.scrollTrigger.revert(),e.kill()):!(e instanceof Ud)&&e.revert&&e.revert(t);n._r.forEach(function(e){return e(t,n)}),n.isReverted=!0}():this.data.forEach(function(t){return t.kill&&t.kill()}),this.clear(),e)for(var r=ep.length;r--;)ep[r].id===this.id&&ep.splice(r,1)},e.revert=function(t){this.kill(t||{})},t}(),cp=function(){function t(t){this.contexts=[],this.scope=t,Jc&&Jc.data.push(this)}var e=t.prototype;return e.add=function(t,e,n){bh(t)||(t={matches:t});var r,i,s,o=new lp(0,n||this.scope),a=o.conditions={};for(i in Jc&&!o.selector&&(o.selector=Jc.selector),this.contexts.push(o),e=o.add("onMatch",e),o.queries=t,t)"all"===i?s=1:(r=eh.matchMedia(t[i]))&&(ep.indexOf(o)<0&&ep.push(o),(a[i]=r.matches)&&(s=1),r.addListener?r.addListener(ap):r.addEventListener("change",ap));return s&&e(o,function(t){return o.add(null,t)}),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach(function(e){return e.kill(t,!0)})},t}(),hp={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(function(t){return id(t)})},timeline:function(t){return new Cd(t)},getTweensOf:function(t,e){return th.getTweensOf(t,e)},getProperty:function(t,e,n,r){yh(t)&&(t=Gu(t)[0]);var i=tu(t||{}).get,s=n?uu:hu;return"native"===n&&(n=""),t?e?s(($h[e]&&$h[e].get||i)(t,e,n,r)):function(e,n,r){return s(($h[e]&&$h[e].get||i)(t,e,n,r))}:t},quickSetter:function(t,e,n){if((t=Gu(t)).length>1){var r=t.map(function(t){return pp.quickSetter(t,e,n)}),i=r.length;return function(t){for(var e=i;e--;)r[e](t)}}t=t[0]||{};var s=$h[e],o=tu(t),a=o.harness&&(o.harness.aliases||{})[e]||e,l=s?function(e){var r=new s;oh._pt=0,r.init(t,n?e+n:e,oh,0,[t]),r.render(1,r),oh._pt&&qd(1,oh)}:o.set(t,a);return s?l:function(e){return l(t,a,n?e+n:e,o,1)}},quickTo:function(t,e,n){var r,i=pp.to(t,du(((r={})[e]="+=0.1",r.paused=!0,r.stagger=0,r),n||{})),s=function(t,n,r){return i.resetTo(e,t,n,r)};return s.tween=i,s},isTweening:function(t){return th.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=bd(t.ease,ch.ease)),fu(ch,t||{})},config:function(t){return fu(lh,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,r=t.plugins,i=t.defaults,s=t.extendTimeline;(r||"").split(",").forEach(function(t){return t&&!$h[t]&&!Lh[t]&&Wh(e+" effect requires "+t+" plugin.")}),qh[e]=function(t,e,r){return n(Gu(t),du(e||{},i),r)},s&&(Cd.prototype[e]=function(t,n,r){return this.add(qh[e](t,bh(n)?n:(r=n)&&{},this),r)})},registerEase:function(t,e){gd[t]=bd(e)},parseEase:function(t,e){return arguments.length?bd(t,e):gd},getById:function(t){return th.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,r,i=new Cd(t);for(i.smoothChildTiming=Ah(t.smoothChildTiming),th.remove(i),i._dp=0,i._time=i._tTime=th._time,n=th._first;n;)r=n._next,!e&&!n._dur&&n instanceof Ud&&n.vars.onComplete===n._targets[0]||Cu(i,n,n._start-n._delay),n=r;return Cu(th,i,0),i},context:function(t,e){return t?new lp(t,e):Jc},matchMedia:function(t){return new cp(t)},matchMediaRefresh:function(){return ep.forEach(function(t){var e,n,r=t.conditions;for(n in r)r[n]&&(r[n]=!1,e=1);e&&t.revert()})||ap()},addEventListener:function(t,e){var n=np[t]||(np[t]=[]);~n.indexOf(e)||n.push(e)},removeEventListener:function(t,e){var n=np[t],r=n&&n.indexOf(e);r>=0&&n.splice(r,1)},utils:{wrap:function t(e,n,r){var i=n-e;return kh(e)?Zu(e,t(0,e.length),n):Wu(r,function(t){return(i+(t-e)%i)%i+e})},wrapYoyo:function t(e,n,r){var i=n-e,s=2*i;return kh(e)?Zu(e,t(0,e.length-1),n):Wu(r,function(t){return e+((t=(s+(t-e)%s)%s||0)>i?s-t:t)})},distribute:Yu,random:Ku,snap:qu,normalize:function(t,e,n){return Ju(t,e,0,1,n)},getUnit:ju,clamp:function(t,e,n){return Wu(n,function(n){return Uu(t,e,n)})},splitColor:ld,toArray:Gu,selector:Xu,mapRange:Ju,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce(function(t,e){return e(t)},t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||ju(n))}},interpolate:function t(e,n,r,i){var s=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!s){var o,a,l,c,h,u=yh(e),d={};if(!0===r&&(i=1)&&(r=null),u)e={p:e},n={p:n};else if(kh(e)&&!kh(n)){for(l=[],c=e.length,h=c-2,a=1;a<c;a++)l.push(t(e[a-1],e[a]));c--,s=function(t){t*=c;var e=Math.min(h,~~t);return l[e](t-e)},r=n}else i||(e=pu(kh(e)?[]:{},e));if(!l){for(o in n)Od.call(d,e,o,"get",n[o]);s=function(t){return qd(t,d)||(u?e.p:e)}}}return Wu(r,s)},shuffle:Vu},install:Bh,effects:qh,ticker:fd,updateRoot:Cd.updateRoot,plugins:$h,globalTimeline:th,core:{PropTween:tp,globals:Uh,Tween:Ud,Timeline:Cd,Animation:Md,getCache:tu,_removeLinkedListItem:yu,reverting:function(){return Qc},context:function(t){return t&&Jc&&(Jc.data.push(t),t._ctx=Jc),Jc},suppressOverwrites:function(t){return Zc=t}}};nu("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return hp[t]=Ud[t]}),fd.add(Cd.updateRoot),oh=hp.to({},{duration:0});var up=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},dp=function(t,e){return{name:t,headless:1,rawVars:1,init:function(t,n,r){r._onInit=function(t){var r,i;if(yh(n)&&(r={},nu(n,function(t){return r[t]=1}),n=r),e){for(i in r={},n)r[i]=e(n[i]);n=r}!function(t,e){var n,r,i,s=t._targets;for(n in e)for(r=s.length;r--;)(i=t._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=up(i,n)),i&&i.modifier&&i.modifier(e[n],t,s[r],n))}(t,n)}}}},pp=hp.registerPlugin({name:"attr",init:function(t,e,n,r,i){var s,o,a;for(s in this.tween=n,e)a=t.getAttribute(s)||"",(o=this.add(t,"setAttribute",(a||0)+"",e[s],r,i,0,0,s)).op=s,o.b=a,this._props.push(s)},render:function(t,e){for(var n=e._pt;n;)Qc?n.set(n.t,n.p,n.b,n):n.r(t,n.d),n=n._next}},{name:"endArray",headless:1,init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n],0,0,0,0,0,1)}},dp("roundProps",$u),dp("modifiers"),dp("snap",qu))||hp;Ud.version=Cd.version=pp.version="3.13.0",ih=1,Th()&&md(),gd.Power0,gd.Power1,gd.Power2,gd.Power3,gd.Power4,gd.Linear,gd.Quad,gd.Cubic,gd.Quart,gd.Quint,gd.Strong,gd.Elastic,gd.Back,gd.SteppedEase,gd.Bounce,gd.Sine,gd.Expo,gd.Circ;var fp,mp,gp,vp,yp,xp,wp,_p,bp={},Ap=180/Math.PI,Tp=Math.PI/180,Sp=Math.atan2,Ep=/([A-Z])/g,kp=/(left|right|width|margin|padding|x)/i,Mp=/[\s,\(]\S/,Cp={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Pp=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},Ip=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},Rp=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},Op=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},Dp=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},Lp=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},Fp=function(t,e,n){return t.style[e]=n},Bp=function(t,e,n){return t.style.setProperty(e,n)},Np=function(t,e,n){return t._gsap[e]=n},Wp=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},Up=function(t,e,n,r,i){var s=t._gsap;s.scaleX=s.scaleY=n,s.renderTransform(i,s)},jp=function(t,e,n,r,i){var s=t._gsap;s[e]=n,s.renderTransform(i,s)},Hp="transform",zp=Hp+"Origin",Gp=function t(e,n){var r=this,i=this.target,s=i.style,o=i._gsap;if(e in bp&&s){if(this.tfm=this.tfm||{},"transform"===e)return Cp.transform.split(",").forEach(function(e){return t.call(r,e,n)});if(~(e=Cp[e]||e).indexOf(",")?e.split(",").forEach(function(t){return r.tfm[t]=cf(i,t)}):this.tfm[e]=o.x?o[e]:cf(i,e),e===zp&&(this.tfm.zOrigin=o.zOrigin),this.props.indexOf(Hp)>=0)return;o.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(zp,n,"")),e=Hp}(s||n)&&this.props.push(e,n,s[e])},Xp=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},Vp=function(){var t,e,n=this.props,r=this.target,i=r.style,s=r._gsap;for(t=0;t<n.length;t+=3)n[t+1]?2===n[t+1]?r[n[t]](n[t+2]):r[n[t]]=n[t+2]:n[t+2]?i[n[t]]=n[t+2]:i.removeProperty("--"===n[t].substr(0,2)?n[t]:n[t].replace(Ep,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)s[e]=this.tfm[e];s.svg&&(s.renderTransform(),r.setAttribute("data-svg-origin",this.svgo||"")),(t=wp())&&t.isStart||i[Hp]||(Xp(i),s.zOrigin&&i[zp]&&(i[zp]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},Yp=function(t,e){var n={target:t,props:[],revert:Vp,save:Gp};return t._gsap||pp.core.getCache(t),e&&t.style&&t.nodeType&&e.split(",").forEach(function(t){return n.save(t)}),n},$p=function(t,e){var n=mp.createElementNS?mp.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):mp.createElement(t);return n&&n.style?n:mp.createElement(t)},qp=function t(e,n,r){var i=getComputedStyle(e);return i[n]||i.getPropertyValue(n.replace(Ep,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&t(e,Zp(n)||n,1)||""},Kp="O,Moz,ms,Ms,Webkit".split(","),Zp=function(t,e,n){var r=(e||yp).style,i=5;if(t in r&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);i--&&!(Kp[i]+t in r););return i<0?null:(3===i?"ms":i>=0?Kp[i]:"")+t},Qp=function(){"undefined"!=typeof window&&window.document&&(fp=window,mp=fp.document,gp=mp.documentElement,yp=$p("div")||{style:{}},$p("div"),Hp=Zp(Hp),zp=Hp+"Origin",yp.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_p=!!Zp("perspective"),wp=pp.core.reverting,vp=1)},Jp=function(t){var e,n=t.ownerSVGElement,r=$p("svg",n&&n.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=t.cloneNode(!0);i.style.display="block",r.appendChild(i),gp.appendChild(r);try{e=i.getBBox()}catch(t){}return r.removeChild(i),gp.removeChild(r),e},tf=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},ef=function(t){var e,n;try{e=t.getBBox()}catch(r){e=Jp(t),n=1}return e&&(e.width||e.height)||n||(e=Jp(t)),!e||e.width||e.x||e.y?e:{x:+tf(t,["x","cx","x1"])||0,y:+tf(t,["y","cy","y1"])||0,width:0,height:0}},nf=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!ef(t))},rf=function(t,e){if(e){var n,r=t.style;e in bp&&e!==zp&&(e=Hp),r.removeProperty?("ms"!==(n=e.substr(0,2))&&"webkit"!==e.substr(0,6)||(e="-"+e),r.removeProperty("--"===n?e:e.replace(Ep,"-$1").toLowerCase())):r.removeAttribute(e)}},sf=function(t,e,n,r,i,s){var o=new tp(t._pt,e,n,0,1,s?Lp:Dp);return t._pt=o,o.b=r,o.e=i,t._props.push(n),o},of={deg:1,rad:1,turn:1},af={grid:1,flex:1},lf=function t(e,n,r,i){var s,o,a,l,c=parseFloat(r)||0,h=(r+"").trim().substr((c+"").length)||"px",u=yp.style,d=kp.test(n),p="svg"===e.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===i,v="%"===i;if(i===h||!c||of[i]||of[h])return c;if("px"!==h&&!g&&(c=t(e,n,r,"px")),l=e.getCTM&&nf(e),(v||"%"===h)&&(bp[n]||~n.indexOf("adius")))return s=l?e.getBBox()[d?"width":"height"]:e[f],ru(v?c/s*m:c/100*s);if(u[d?"width":"height"]=m+(g?h:i),o="rem"!==i&&~n.indexOf("adius")||"em"===i&&e.appendChild&&!p?e:e.parentNode,l&&(o=(e.ownerSVGElement||{}).parentNode),o&&o!==mp&&o.appendChild||(o=mp.body),(a=o._gsap)&&v&&a.width&&d&&a.time===fd.time&&!a.uncache)return ru(c/a.width*m);if(!v||"height"!==n&&"width"!==n)(v||"%"===h)&&!af[qp(o,"display")]&&(u.position=qp(e,"position")),o===e&&(u.position="static"),o.appendChild(yp),s=yp[f],o.removeChild(yp),u.position="absolute";else{var y=e.style[n];e.style[n]=m+i,s=e[f],y?e.style[n]=y:rf(e,n)}return d&&v&&((a=tu(o)).time=fd.time,a.width=o[f]),ru(g?s*c/m:s&&c?m/s*c:0)},cf=function(t,e,n,r){var i;return vp||Qp(),e in Cp&&"transform"!==e&&~(e=Cp[e]).indexOf(",")&&(e=e.split(",")[0]),bp[e]&&"transform"!==e?(i=_f(t,r),i="transformOrigin"!==e?i[e]:i.svg?i.origin:bf(qp(t,zp))+" "+i.zOrigin+"px"):(!(i=t.style[e])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=ff[e]&&ff[e](t,e,n)||qp(t,e)||eu(t,e)||("opacity"===e?1:0)),n&&!~(i+"").trim().indexOf(" ")?lf(t,e,i,n)+n:i},hf=function(t,e,n,r){if(!n||"none"===n){var i=Zp(e,t,1),s=i&&qp(t,i,1);s&&s!==n?(e=i,n=s):"borderColor"===e&&(n=qp(t,"borderTopColor"))}var o,a,l,c,h,u,d,p,f,m,g,v=new tp(this._pt,t.style,e,0,1,$d),y=0,x=0;if(v.b=n,v.e=r,n+="","var(--"===(r+="").substring(0,6)&&(r=qp(t,r.substring(4,r.indexOf(")")))),"auto"===r&&(u=t.style[e],t.style[e]=r,r=qp(t,e)||r,u?t.style[e]=u:rf(t,e)),pd(o=[n,r]),r=o[1],l=(n=o[0]).match(Ph)||[],(r.match(Ph)||[]).length){for(;a=Ph.exec(r);)d=a[0],f=r.substring(y,a.index),h?h=(h+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(h=1),d!==(u=l[x++]||"")&&(c=parseFloat(u)||0,g=u.substr((c+"").length),"="===d.charAt(1)&&(d=su(c,d)+g),p=parseFloat(d),m=d.substr((p+"").length),y=Ph.lastIndex-m.length,m||(m=m||lh.units[e]||g,y===r.length&&(r+=m,v.e+=m)),g!==m&&(c=lf(t,e,u,m)||0),v._pt={_next:v._pt,p:f||1===x?f:",",s:c,c:p-c,m:h&&h<4||"zIndex"===e?Math.round:0});v.c=y<r.length?r.substring(y,r.length):""}else v.r="display"===e&&"none"===r?Lp:Dp;return Rh.test(r)&&(v.e=0),this._pt=v,v},uf={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},df=function(t){var e=t.split(" "),n=e[0],r=e[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==r&&"right"!==r||(t=n,n=r,r=t),e[0]=uf[n]||n,e[1]=uf[r]||r,e.join(" ")},pf=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,r,i,s=e.t,o=s.style,a=e.u,l=s._gsap;if("all"===a||!0===a)o.cssText="",r=1;else for(i=(a=a.split(",")).length;--i>-1;)n=a[i],bp[n]&&(r=1,n="transformOrigin"===n?zp:Hp),rf(s,n);r&&(rf(s,Hp),l&&(l.svg&&s.removeAttribute("transform"),o.scale=o.rotate=o.translate="none",_f(s,1),l.uncache=1,Xp(o)))}},ff={clearProps:function(t,e,n,r,i){if("isFromStart"!==i.data){var s=t._pt=new tp(t._pt,e,n,0,0,pf);return s.u=r,s.pr=-10,s.tween=i,t._props.push(n),1}}},mf=[1,0,0,1,0,0],gf={},vf=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},yf=function(t){var e=qp(t,Hp);return vf(e)?mf:e.substr(7).match(Ch).map(ru)},xf=function(t,e){var n,r,i,s,o=t._gsap||tu(t),a=t.style,l=yf(t);return o.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(i=t.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?mf:l:(l!==mf||t.offsetParent||t===gp||o.svg||(i=a.display,a.display="block",(n=t.parentNode)&&(t.offsetParent||t.getBoundingClientRect().width)||(s=1,r=t.nextElementSibling,gp.appendChild(t)),l=yf(t),i?a.display=i:rf(t,"display"),s&&(r?n.insertBefore(t,r):n?n.appendChild(t):gp.removeChild(t))),e&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},wf=function(t,e,n,r,i,s){var o,a,l,c=t._gsap,h=i||xf(t,!0),u=c.xOrigin||0,d=c.yOrigin||0,p=c.xOffset||0,f=c.yOffset||0,m=h[0],g=h[1],v=h[2],y=h[3],x=h[4],w=h[5],_=e.split(" "),b=parseFloat(_[0])||0,A=parseFloat(_[1])||0;n?h!==mf&&(a=m*y-g*v)&&(l=b*(-g/a)+A*(m/a)-(m*w-g*x)/a,b=b*(y/a)+A*(-v/a)+(v*w-y*x)/a,A=l):(b=(o=ef(t)).x+(~_[0].indexOf("%")?b/100*o.width:b),A=o.y+(~(_[1]||_[0]).indexOf("%")?A/100*o.height:A)),r||!1!==r&&c.smooth?(x=b-u,w=A-d,c.xOffset=p+(x*m+w*v)-x,c.yOffset=f+(x*g+w*y)-w):c.xOffset=c.yOffset=0,c.xOrigin=b,c.yOrigin=A,c.smooth=!!r,c.origin=e,c.originIsAbsolute=!!n,t.style[zp]="0px 0px",s&&(sf(s,c,"xOrigin",u,b),sf(s,c,"yOrigin",d,A),sf(s,c,"xOffset",p,c.xOffset),sf(s,c,"yOffset",f,c.yOffset)),t.setAttribute("data-svg-origin",b+" "+A)},_f=function(t,e){var n=t._gsap||new kd(t);if("x"in n&&!e&&!n.uncache)return n;var r,i,s,o,a,l,c,h,u,d,p,f,m,g,v,y,x,w,_,b,A,T,S,E,k,M,C,P,I,R,O,D,L=t.style,F=n.scaleX<0,B="px",N="deg",W=getComputedStyle(t),U=qp(t,zp)||"0";return r=i=s=l=c=h=u=d=p=0,o=a=1,n.svg=!(!t.getCTM||!nf(t)),W.translate&&("none"===W.translate&&"none"===W.scale&&"none"===W.rotate||(L[Hp]=("none"!==W.translate?"translate3d("+(W.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==W.rotate?"rotate("+W.rotate+") ":"")+("none"!==W.scale?"scale("+W.scale.split(" ").join(",")+") ":"")+("none"!==W[Hp]?W[Hp]:"")),L.scale=L.rotate=L.translate="none"),g=xf(t,n.svg),n.svg&&(n.uncache?(k=t.getBBox(),U=n.xOrigin-k.x+"px "+(n.yOrigin-k.y)+"px",E=""):E=!e&&t.getAttribute("data-svg-origin"),wf(t,E||U,!!E||n.originIsAbsolute,!1!==n.smooth,g)),f=n.xOrigin||0,m=n.yOrigin||0,g!==mf&&(w=g[0],_=g[1],b=g[2],A=g[3],r=T=g[4],i=S=g[5],6===g.length?(o=Math.sqrt(w*w+_*_),a=Math.sqrt(A*A+b*b),l=w||_?Sp(_,w)*Ap:0,(u=b||A?Sp(b,A)*Ap+l:0)&&(a*=Math.abs(Math.cos(u*Tp))),n.svg&&(r-=f-(f*w+m*b),i-=m-(f*_+m*A))):(D=g[6],R=g[7],C=g[8],P=g[9],I=g[10],O=g[11],r=g[12],i=g[13],s=g[14],c=(v=Sp(D,I))*Ap,v&&(E=T*(y=Math.cos(-v))+C*(x=Math.sin(-v)),k=S*y+P*x,M=D*y+I*x,C=T*-x+C*y,P=S*-x+P*y,I=D*-x+I*y,O=R*-x+O*y,T=E,S=k,D=M),h=(v=Sp(-b,I))*Ap,v&&(y=Math.cos(-v),O=A*(x=Math.sin(-v))+O*y,w=E=w*y-C*x,_=k=_*y-P*x,b=M=b*y-I*x),l=(v=Sp(_,w))*Ap,v&&(E=w*(y=Math.cos(v))+_*(x=Math.sin(v)),k=T*y+S*x,_=_*y-w*x,S=S*y-T*x,w=E,T=k),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,h=180-h),o=ru(Math.sqrt(w*w+_*_+b*b)),a=ru(Math.sqrt(S*S+D*D)),v=Sp(T,S),u=Math.abs(v)>2e-4?v*Ap:0,p=O?1/(O<0?-O:O):0),n.svg&&(E=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!vf(qp(t,Hp)),E&&t.setAttribute("transform",E))),Math.abs(u)>90&&Math.abs(u)<270&&(F?(o*=-1,u+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,u+=u<=0?180:-180)),e=e||n.uncache,n.x=r-((n.xPercent=r&&(!e&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-r)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+B,n.y=i-((n.yPercent=i&&(!e&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-i)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+B,n.z=s+B,n.scaleX=ru(o),n.scaleY=ru(a),n.rotation=ru(l)+N,n.rotationX=ru(c)+N,n.rotationY=ru(h)+N,n.skewX=u+N,n.skewY=d+N,n.transformPerspective=p+B,(n.zOrigin=parseFloat(U.split(" ")[2])||!e&&n.zOrigin||0)&&(L[zp]=bf(U)),n.xOffset=n.yOffset=0,n.force3D=lh.force3D,n.renderTransform=n.svg?Cf:_p?Mf:Tf,n.uncache=0,n},bf=function(t){return(t=t.split(" "))[0]+" "+t[1]},Af=function(t,e,n){var r=ju(e);return ru(parseFloat(e)+parseFloat(lf(t,"x",n+"px",r)))+r},Tf=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Mf(t,e)},Sf="0deg",Ef="0px",kf=") ",Mf=function(t,e){var n=e||this,r=n.xPercent,i=n.yPercent,s=n.x,o=n.y,a=n.z,l=n.rotation,c=n.rotationY,h=n.rotationX,u=n.skewX,d=n.skewY,p=n.scaleX,f=n.scaleY,m=n.transformPerspective,g=n.force3D,v=n.target,y=n.zOrigin,x="",w="auto"===g&&t&&1!==t||!0===g;if(y&&(h!==Sf||c!==Sf)){var _,b=parseFloat(c)*Tp,A=Math.sin(b),T=Math.cos(b);b=parseFloat(h)*Tp,_=Math.cos(b),s=Af(v,s,A*_*-y),o=Af(v,o,-Math.sin(b)*-y),a=Af(v,a,T*_*-y+y)}m!==Ef&&(x+="perspective("+m+kf),(r||i)&&(x+="translate("+r+"%, "+i+"%) "),(w||s!==Ef||o!==Ef||a!==Ef)&&(x+=a!==Ef||w?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+kf),l!==Sf&&(x+="rotate("+l+kf),c!==Sf&&(x+="rotateY("+c+kf),h!==Sf&&(x+="rotateX("+h+kf),u===Sf&&d===Sf||(x+="skew("+u+", "+d+kf),1===p&&1===f||(x+="scale("+p+", "+f+kf),v.style[Hp]=x||"translate(0, 0)"},Cf=function(t,e){var n,r,i,s,o,a=e||this,l=a.xPercent,c=a.yPercent,h=a.x,u=a.y,d=a.rotation,p=a.skewX,f=a.skewY,m=a.scaleX,g=a.scaleY,v=a.target,y=a.xOrigin,x=a.yOrigin,w=a.xOffset,_=a.yOffset,b=a.forceCSS,A=parseFloat(h),T=parseFloat(u);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=Tp,p*=Tp,n=Math.cos(d)*m,r=Math.sin(d)*m,i=Math.sin(d-p)*-g,s=Math.cos(d-p)*g,p&&(f*=Tp,o=Math.tan(p-f),i*=o=Math.sqrt(1+o*o),s*=o,f&&(o=Math.tan(f),n*=o=Math.sqrt(1+o*o),r*=o)),n=ru(n),r=ru(r),i=ru(i),s=ru(s)):(n=m,s=g,r=i=0),(A&&!~(h+"").indexOf("px")||T&&!~(u+"").indexOf("px"))&&(A=lf(v,"x",h,"px"),T=lf(v,"y",u,"px")),(y||x||w||_)&&(A=ru(A+y-(y*n+x*i)+w),T=ru(T+x-(y*r+x*s)+_)),(l||c)&&(o=v.getBBox(),A=ru(A+l/100*o.width),T=ru(T+c/100*o.height)),o="matrix("+n+","+r+","+i+","+s+","+A+","+T+")",v.setAttribute("transform",o),b&&(v.style[Hp]=o)},Pf=function(t,e,n,r,i){var s,o,a=360,l=yh(i),c=parseFloat(i)*(l&&~i.indexOf("rad")?Ap:1)-r,h=r+c+"deg";return l&&("short"===(s=i.split("_")[1])&&(c%=a)!==c%180&&(c+=c<0?a:-360),"cw"===s&&c<0?c=(c+36e9)%a-~~(c/a)*a:"ccw"===s&&c>0&&(c=(c-36e9)%a-~~(c/a)*a)),t._pt=o=new tp(t._pt,e,n,r,c,Ip),o.e=h,o.u="deg",t._props.push(n),o},If=function(t,e){for(var n in e)t[n]=e[n];return t},Rf=function(t,e,n){var r,i,s,o,a,l,c,h=If({},n._gsap),u=n.style;for(i in h.svg?(s=n.getAttribute("transform"),n.setAttribute("transform",""),u[Hp]=e,r=_f(n,1),rf(n,Hp),n.setAttribute("transform",s)):(s=getComputedStyle(n)[Hp],u[Hp]=e,r=_f(n,1),u[Hp]=s),bp)(s=h[i])!==(o=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(a=ju(s)!==(c=ju(o))?lf(n,i,s,c):parseFloat(s),l=parseFloat(o),t._pt=new tp(t._pt,r,i,a,l-a,Pp),t._pt.u=c||0,t._props.push(i));If(r,h)};nu("padding,margin,Width,Radius",function(t,e){var n="Top",r="Right",i="Bottom",s="Left",o=(e<3?[n,r,i,s]:[n+s,n+r,i+r,i+s]).map(function(n){return e<2?t+n:"border"+n+t});ff[e>1?"border"+t:t]=function(t,e,n,r,i){var s,a;if(arguments.length<4)return s=o.map(function(e){return cf(t,e,n)}),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(r+"").split(" "),a={},o.forEach(function(t,e){return a[t]=s[e]=s[e]||s[(e-1)/2|0]}),t.init(e,a,i)}});var Of,Df,Lf={name:"css",register:Qp,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,r,i){var s,o,a,l,c,h,u,d,p,f,m,g,v,y,x,w,_=this._props,b=t.style,A=n.vars.startAt;for(u in vp||Qp(),this.styles=this.styles||Yp(t),w=this.styles.props,this.tween=n,e)if("autoRound"!==u&&(o=e[u],!$h[u]||!Dd(u,e,n,r,t,i)))if(c=typeof o,h=ff[u],"function"===c&&(c=typeof(o=o.call(n,r,t,i))),"string"===c&&~o.indexOf("random(")&&(o=Qu(o)),h)h(this,t,u,o,n)&&(x=1);else if("--"===u.substr(0,2))s=(getComputedStyle(t).getPropertyValue(u)+"").trim(),o+="",ud.lastIndex=0,ud.test(s)||(d=ju(s),p=ju(o)),p?d!==p&&(s=lf(t,u,s,p)+p):d&&(o+=d),this.add(b,"setProperty",s,o,r,i,0,0,u),_.push(u),w.push(u,0,b[u]);else if("undefined"!==c){if(A&&u in A?(s="function"==typeof A[u]?A[u].call(n,r,t,i):A[u],yh(s)&&~s.indexOf("random(")&&(s=Qu(s)),ju(s+"")||"auto"===s||(s+=lh.units[u]||ju(cf(t,u))||""),"="===(s+"").charAt(1)&&(s=cf(t,u))):s=cf(t,u),l=parseFloat(s),(f="string"===c&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),a=parseFloat(o),u in Cp&&("autoAlpha"===u&&(1===l&&"hidden"===cf(t,"visibility")&&a&&(l=0),w.push("visibility",0,b.visibility),sf(this,b,"visibility",l?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==u&&"transform"!==u&&~(u=Cp[u]).indexOf(",")&&(u=u.split(",")[0])),m=u in bp)if(this.styles.save(u),"string"===c&&"var(--"===o.substring(0,6)&&(o=qp(t,o.substring(4,o.indexOf(")"))),a=parseFloat(o)),g||((v=t._gsap).renderTransform&&!e.parseTransform||_f(t,e.parseTransform),y=!1!==e.smoothOrigin&&v.smooth,(g=this._pt=new tp(this._pt,b,Hp,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===u)this._pt=new tp(this._pt,v,"scaleY",v.scaleY,(f?su(v.scaleY,f+a):a)-v.scaleY||0,Pp),this._pt.u=0,_.push("scaleY",u),u+="X";else{if("transformOrigin"===u){w.push(zp,0,b[zp]),o=df(o),v.svg?wf(t,o,0,y,0,this):((p=parseFloat(o.split(" ")[2])||0)!==v.zOrigin&&sf(this,v,"zOrigin",v.zOrigin,p),sf(this,b,u,bf(s),bf(o)));continue}if("svgOrigin"===u){wf(t,o,1,y,0,this);continue}if(u in gf){Pf(this,v,u,l,f?su(l,f+o):o);continue}if("smoothOrigin"===u){sf(this,v,"smooth",v.smooth,o);continue}if("force3D"===u){v[u]=o;continue}if("transform"===u){Rf(this,o,t);continue}}else u in b||(u=Zp(u)||u);if(m||(a||0===a)&&(l||0===l)&&!Mp.test(o)&&u in b)a||(a=0),(d=(s+"").substr((l+"").length))!==(p=ju(o)||(u in lh.units?lh.units[u]:d))&&(l=lf(t,u,s,p)),this._pt=new tp(this._pt,m?v:b,u,l,(f?su(l,f+a):a)-l,m||"px"!==p&&"zIndex"!==u||!1===e.autoRound?Pp:Op),this._pt.u=p||0,d!==p&&"%"!==p&&(this._pt.b=s,this._pt.r=Rp);else if(u in b)hf.call(this,t,u,s,f?f+o:o);else if(u in t)this.add(t,u,s||t[u],f?f+o:o,r,i);else if("parseTransform"!==u){Nh(u,o);continue}m||(u in b?w.push(u,0,b[u]):"function"==typeof t[u]?w.push(u,2,t[u]()):w.push(u,1,s||t[u])),_.push(u)}x&&Jd(this)},render:function(t,e){if(e.tween._time||!wp())for(var n=e._pt;n;)n.r(t,n.d),n=n._next;else e.styles.revert()},get:cf,aliases:Cp,getSetter:function(t,e,n){var r=Cp[e];return r&&r.indexOf(",")<0&&(e=r),e in bp&&e!==zp&&(t._gsap.x||cf(t,"x"))?n&&xp===n?"scale"===e?Wp:Np:(xp=n||{})&&("scale"===e?Up:jp):t.style&&!_h(t.style[e])?Fp:~e.indexOf("-")?Bp:Xd(t,e)},core:{_removeProperty:rf,_getMatrix:xf}};pp.utils.checkPrefix=Zp,pp.core.getStyleSaver=Yp,Df=nu("x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+(Of="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(t){bp[t]=1}),nu(Of,function(t){lh.units[t]="deg",gf[t]=1}),Cp[Df[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+Of,nu("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(t){var e=t.split(":");Cp[e[1]]=Df[e[0]]}),nu("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){lh.units[t]="px"}),pp.registerPlugin(Lf);var Ff=pp.registerPlugin(Lf)||pp,Bf=(Ff.core.Tween,"GAME"),Nf="ADAPTER",Wf="storage",Uf="soundManager",jf="gameConfig",Hf="PAYMENT_MANAGER",zf="UI_CONTROLLER",Gf=function(){function t(){g(this,t)}return w(t,null,[{key:"game",get:function(){return t.get(Bf)}},{key:"adapter",get:function(){return t.get(Nf)}},{key:"storage",get:function(){return t.get(Wf)}},{key:"soundManager",get:function(){return t.get(Uf)}},{key:"gameConfig",get:function(){return t.get(jf)}},{key:"paymentManager",get:function(){return t.get(Hf)}},{key:"uiController",get:function(){return t.get(zf)}},{key:"register",value:function(e,n){var r={name:e,instance:n};Gc(t.services).some(function(t){return t.name===e})||t.services.add(r)}},{key:"get",value:function(e){var n=Gc(t.services).find(function(t){return t.name===e});return n?n.instance:void 0}}])}();S(Gf,"services",new Set);class Xf extends Nn{constructor(t=4,e=3,n=!1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",n?"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}\n":"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}"),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new Ye,this.pixelSize=1,this._clamp=n,Array.isArray(t)?this.kernels=t:(this._blur=t,this.quality=e)}apply(t,e,n,r){const i=this._pixelSize.x/e._frame.width,s=this._pixelSize.y/e._frame.height;let o;if(1===this._quality||0===this._blur)o=this._kernels[0]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*s,t.applyFilter(this,e,n,r);else{const a=t.getFilterTexture();let l,c=e,h=a;const u=this._quality-1;for(let e=0;e<u;e++)o=this._kernels[e]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*s,t.applyFilter(this,c,h,1),l=c,c=h,h=l;o=this._kernels[u]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*s,t.applyFilter(this,c,n,r),t.returnFilterTexture(a)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((t,e)=>t+e+.5,0))}_generateKernels(){const t=this._blur,e=this._quality,n=[t];if(t>0){let r=t;const i=t/e;for(let t=1;t<e;t++)r-=i,n.push(r)}this._kernels=n,this._updatePadding()}get kernels(){return this._kernels}set kernels(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max(...t)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(t){"number"==typeof t?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof Ye?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}get blur(){return this._blur}set blur(t){this._blur=t,this._generateKernels()}}var Vf="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}";class Yf extends Nn{constructor(t=.5){super(Vf,"\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform float threshold;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    // A simple & fast algorithm for getting brightness.\n    // It's inaccuracy , but good enought for this feature.\n    float _max = max(max(color.r, color.g), color.b);\n    float _min = min(min(color.r, color.g), color.b);\n    float brightness = (_max + _min) * 0.5;\n\n    if(brightness > threshold) {\n        gl_FragColor = color;\n    } else {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n}\n"),this.threshold=t}get threshold(){return this.uniforms.threshold}set threshold(t){this.uniforms.threshold=t}}const $f=class extends Nn{constructor(t){super(Vf,"uniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D bloomTexture;\nuniform float bloomScale;\nuniform float brightness;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    color.rgb *= brightness;\n    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);\n    bloomColor.rgb *= bloomScale;\n    gl_FragColor = color + bloomColor;\n}\n"),this.bloomScale=1,this.brightness=1,this._resolution=V.FILTER_RESOLUTION,"number"==typeof t&&(t={threshold:t});const e=Object.assign($f.defaults,t);this.bloomScale=e.bloomScale,this.brightness=e.brightness;const{kernels:n,blur:r,quality:i,pixelSize:s,resolution:o}=e;this._extractFilter=new Yf(e.threshold),this._extractFilter.resolution=o,this._blurFilter=n?new Xf(n):new Xf(r,i),this.pixelSize=s,this.resolution=o}apply(t,e,n,r,i){const s=t.getFilterTexture();this._extractFilter.apply(t,e,s,1,i);const o=t.getFilterTexture();this._blurFilter.apply(t,s,o,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=o,t.applyFilter(this,e,n,r),t.returnFilterTexture(o),t.returnFilterTexture(s)}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get threshold(){return this._extractFilter.threshold}set threshold(t){this._extractFilter.threshold=t}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};$f.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:V.FILTER_RESOLUTION};const qf=class extends Nn{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","uniform float radius;\nuniform float strength;\nuniform vec2 center;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nvoid main()\n{\n    vec2 coord = vTextureCoord * filterArea.xy;\n    coord -= center * dimensions.xy;\n    float distance = length(coord);\n    if (distance < radius) {\n        float percent = distance / radius;\n        if (strength > 0.0) {\n            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n        } else {\n            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n        }\n    }\n    coord += center * dimensions.xy;\n    coord /= filterArea.xy;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    gl_FragColor = color;\n}\n"),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,qf.defaults,t)}apply(t,e,n,r){const{width:i,height:s}=e.filterFrame;this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=s,t.applyFilter(this,e,n,r)}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get strength(){return this.uniforms.strength}set strength(t){this.uniforms.strength=t}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}};var Kf;qf.defaults={center:[.5,.5],radius:100,strength:1},(Kf=Kf||{}).stringify=function(){var t={"visit_linear-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return t.visit_gradient(e)},"visit_radial-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return t.visit_gradient(e)},visit_gradient:function(e){var n=t.visit(e.orientation);return n&&(n+=", "),e.type+"("+n+t.visit(e.colorStops)+")"},visit_shape:function(e){var n=e.value,r=t.visit(e.at),i=t.visit(e.style);return i&&(n+=" "+i),r&&(n+=" at "+r),n},"visit_default-radial":function(e){var n="",r=t.visit(e.at);return r&&(n+=r),n},"visit_extent-keyword":function(e){var n=e.value,r=t.visit(e.at);return r&&(n+=" at "+r),n},"visit_position-keyword":function(t){return t.value},visit_position:function(e){return t.visit(e.value.x)+" "+t.visit(e.value.y)},"visit_%":function(t){return t.value+"%"},visit_em:function(t){return t.value+"em"},visit_px:function(t){return t.value+"px"},visit_literal:function(e){return t.visit_color(e.value,e)},visit_hex:function(e){return t.visit_color("#"+e.value,e)},visit_rgb:function(e){return t.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return t.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,n){var r=e,i=t.visit(n.length);return i&&(r+=" "+i),r},visit_angular:function(t){return t.value+"deg"},visit_directional:function(t){return"to "+t.value},visit_array:function(e){var n="",r=e.length;return e.forEach(function(e,i){n+=t.visit(e),i<r-1&&(n+=", ")}),n},visit:function(e){if(!e)return"";if(e instanceof Array)return t.visit_array(e,"");if(e.type){var n=t["visit_"+e.type];if(n)return n(e);throw Error("Missing visitor visit_"+e.type)}throw Error("Invalid node.")}};return function(e){return t.visit(e)}}(),(Kf=Kf||{}).parse=function(){var t=/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,e=/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,n=/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,r=/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,i=/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,s=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,o=/^(left|center|right|top|bottom)/i,a=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,u=/^\(/,d=/^\)/,p=/^,/,f=/^\#([0-9a-fA-F]+)/,m=/^([a-zA-Z]+)/,g=/^rgb/i,v=/^rgba/i,y=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,x="";function w(t){var e=new Error(x+": "+t);throw e.source=x,e}function _(){return b("linear-gradient",t,T)||b("repeating-linear-gradient",e,T)||b("radial-gradient",n,S)||b("repeating-radial-gradient",r,S)}function b(t,e,n){return A(e,function(e){var r=n();return r&&(F(p)||w("Missing comma before color stops")),{type:t,orientation:r,colorStops:P(I)}})}function A(t,e){var n=F(t);if(n){F(u)||w("Missing (");var r=e(n);return F(d)||w("Missing )"),r}}function T(){return L("directional",i,1)||L("angular",h,1)}function S(){var t,e,n=E();return n&&((t=[]).push(n),e=x,F(p)&&((n=E())?t.push(n):x=e)),t}function E(){var t=function(){var t=L("shape",/^(circle)/i,0);return t&&(t.style=D()||k()),t}()||function(){var t=L("shape",/^(ellipse)/i,0);return t&&(t.style=O()||k()),t}();if(t)t.at=M();else{var e=k();if(e){t=e;var n=M();n&&(t.at=n)}else{var r=C();r&&(t={type:"default-radial",at:r})}}return t}function k(){return L("extent-keyword",s,1)}function M(){if(L("position",/^at/,0)){var t=C();return t||w("Missing positioning value"),t}}function C(){var t={x:O(),y:O()};if(t.x||t.y)return{type:"position",value:t}}function P(t){var e=t(),n=[];if(e)for(n.push(e);F(p);)(e=t())?n.push(e):w("One extra comma");return n}function I(){var t=L("hex",f,1)||A(v,function(){return{type:"rgba",value:P(R)}})||A(g,function(){return{type:"rgb",value:P(R)}})||L("literal",m,0);return t||w("Expected color definition"),t.length=O(),t}function R(){return F(y)[1]}function O(){return L("%",l,1)||L("position-keyword",o,1)||D()}function D(){return L("px",a,1)||L("em",c,1)}function L(t,e,n){var r=F(e);if(r)return{type:t,value:r[n]}}function F(t){var e,n;return(n=/^[\n\r\t\s]+/.exec(x))&&B(n[0].length),(e=t.exec(x))&&B(e[0].length),e}function B(t){x=x.substr(t)}return function(t){return x=t.toString(),function(){var t=P(_);return x.length>0&&w("Invalid input not EOF"),t}()}}();var Zf=Kf.parse;Kf.stringify;var Qf={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Jf={red:0,orange:60,yellow:120,green:180,blue:240,purple:300},tm={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},em={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,n,r,i,s,o=t[0]/360,a=t[1]/100,l=t[2]/100;if(0===a)return[s=255*l,s,s];e=2*l-(n=l<.5?l*(1+a):l+a-l*a),i=[0,0,0];for(var c=0;c<3;c++)(r=o+1/3*-(c-1))<0?r++:r>1&&r--,s=6*r<1?e+6*(n-e)*r:2*r<1?n:3*r<2?e+(n-e)*(2/3-r)*6:e,i[c]=255*s;return i}};function nm(t){switch(typeof t){case"string":return function(t){const e=function(t){Array.isArray(t)&&t.raw&&(t=String.raw(...arguments));var e,n=function(t){var e,n,r=[],i=1;if("string"==typeof t)if(Qf[t])r=Qf[t].slice(),n="rgb";else if("transparent"===t)i=0,n="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(t)){var s=t.slice(1);i=1,(l=s.length)<=4?(r=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===l&&(i=parseInt(s[3]+s[3],16)/255)):(r=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===l&&(i=parseInt(s[6]+s[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),n="rgb"}else if(e=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var o=e[1],a="rgb"===o;n=s=o.replace(/a$/,"");var l="cmyk"===s?4:"gray"===s?1:3;r=e[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(t,e){if(/%$/.test(t))return e===l?parseFloat(t)/100:"rgb"===s?255*parseFloat(t)/100:parseFloat(t);if("h"===s[e]){if(/deg$/.test(t))return parseFloat(t);if(void 0!==Jf[t])return Jf[t]}return parseFloat(t)}),o===s&&r.push(1),i=a||void 0===r[l]?1:r[l],r=r.slice(0,l)}else t.length>10&&/[0-9](?:\s|\/)/.test(t)&&(r=t.match(/([0-9]+)/g).map(function(t){return parseFloat(t)}),n=t.match(/([a-z])/gi).join("").toLowerCase());else isNaN(t)?Array.isArray(t)||t.length?(r=[t[0],t[1],t[2]],n="rgb",i=4===t.length?t[3]:1):t instanceof Object&&(null!=t.r||null!=t.red||null!=t.R?(n="rgb",r=[t.r||t.red||t.R||0,t.g||t.green||t.G||0,t.b||t.blue||t.B||0]):(n="hsl",r=[t.h||t.hue||t.H||0,t.s||t.saturation||t.S||0,t.l||t.lightness||t.L||t.b||t.brightness]),i=t.a||t.alpha||t.opacity||1,null!=t.opacity&&(i/=100)):(n="rgb",r=[t>>>16,(65280&t)>>>8,255&t]);return{space:n,values:r,alpha:i}}(t);if(!n.space)return[];const r="h"===n.space[0]?em.min:tm.min,i="h"===n.space[0]?em.max:tm.max;return(e=Array(3))[0]=Math.min(Math.max(n.values[0],r[0]),i[0]),e[1]=Math.min(Math.max(n.values[1],r[1]),i[1]),e[2]=Math.min(Math.max(n.values[2],r[2]),i[2]),"h"===n.space[0]&&(e=em.rgb(e)),e.push(Math.min(Math.max(n.alpha,0),1)),e}(t);if(!e)throw new Error(`Unable to parse color "${t}" as RGBA.`);return[e[0]/255,e[1]/255,e[2]/255,e[3]]}(t);case"number":return Kt(t);default:return t}}function rm(t){return nm(function(t){switch(t.type){case"hex":return`#${t.value}`;case"literal":return t.value;default:return`${t.type}(${t.value.join(",")})`}}(t))}function im(t){return t.toString().length>6?parseFloat(t.toString().substring(0,6)):t}tm.hsl=function(t){var e,n,r=t[0]/255,i=t[1]/255,s=t[2]/255,o=Math.min(r,i,s),a=Math.max(r,i,s),l=a-o;return a===o?e=0:r===a?e=(i-s)/l:i===a?e=2+(s-r)/l:s===a&&(e=4+(r-i)/l),(e=Math.min(60*e,360))<0&&(e+=360),n=(o+a)/2,[e,100*(a===o?0:n<=.5?l/(a+o):l/(2-a-o)),100*n]};var sm=Object.defineProperty,om=Object.defineProperties,am=Object.getOwnPropertyDescriptors,lm=Object.getOwnPropertySymbols,cm=Object.prototype.hasOwnProperty,hm=Object.prototype.propertyIsEnumerable,um=(t,e,n)=>e in t?sm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dm=(t,e)=>{for(var n in e||(e={}))cm.call(e,n)&&um(t,n,e[n]);if(lm)for(var n of lm(e))hm.call(e,n)&&um(t,n,e[n]);return t};const pm=class extends Nn{constructor(t){var e,n;let r;if(r=t&&"css"in t?((t,e)=>om(t,am(e)))(dm({},function(t){const e=Zf(function(t){let e=t.replace(/\s{2,}/gu," ");return e=e.replace(/;/g,""),e=e.replace(/ ,/g,","),e=e.replace(/\( /g,"("),e=e.replace(/ \)/g,")"),e.trim()}(t));if(0===e.length)throw new Error("Invalid CSS gradient.");if(1!==e.length)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const n=e[0],r=function(t){const e={"linear-gradient":0,"radial-gradient":1};if(!(t in e))throw new Error(`Unsupported gradient type "${t}"`);return e[t]}(n.type),i=function(t){const e=function(t){const e=[];for(let n=0;n<t.length;n++){const r=t[n];let i=-1;"literal"===r.type&&r.length&&"type"in r.length&&"%"===r.length.type&&"value"in r.length&&(i=parseFloat(r.length.value)/100),e.push(i)}const n=t=>{for(let n=t;n<e.length;n++)if(-1!==e[n])return{indexDelta:n-t,offset:e[n]};return{indexDelta:e.length-1-t,offset:1}};let r=0;for(let t=0;t<e.length;t++){const i=e[t];if(-1!==i)r=i;else if(0===t)e[t]=0;else if(t+1===e.length)e[t]=1;else{const i=n(t),s=(i.offset-r)/(1+i.indexDelta);for(let n=0;n<=i.indexDelta;n++)e[t+n]=r+(n+1)*s;t+=i.indexDelta,r=e[t]}}return e.map(im)}(t),n=[];for(let r=0;r<t.length;r++){const i=rm(t[r]);n.push({offset:e[r],color:i.slice(0,3),alpha:i[3]})}return n}(n.colorStops),s=function(t){if(void 0===t)return 0;if("type"in t&&"value"in t)switch(t.type){case"angular":return parseFloat(t.value);case"directional":return function(t){const e={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(t in e))throw new Error(`Unsupported directional value "${t}"`);return e[t]}(t.value)}return 0}(n.orientation);return{type:r,stops:i,angle:s}}(t.css||"")),{alpha:null!=(e=t.alpha)?e:pm.defaults.alpha,maxColors:null!=(n=t.maxColors)?n:pm.defaults.maxColors}):dm(dm({},pm.defaults),t),!r.stops||r.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;\n}\n","const float PI = 3.1415926538;\nconst float PI_2 = PI*2.;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nuniform sampler2D uSampler;\n\nconst int TYPE_LINEAR = 0;\nconst int TYPE_RADIAL = 1;\nconst int TYPE_CONIC = 2;\nconst int MAX_STOPS = 32;\n\nuniform int uNumStops;\nuniform float uAlphas[3*MAX_STOPS];\nuniform vec3 uColors[MAX_STOPS];\nuniform float uOffsets[MAX_STOPS];\nuniform int uType;\nuniform float uAngle;\nuniform float uAlpha;\nuniform int uMaxColors;\nuniform bool uReplace;\n\nstruct ColorStop {\n    float offset;\n    vec3 color;\n    float alpha;\n};\n\nmat2 rotate2d(float angle){\n    return mat2(cos(angle), -sin(angle),\n    sin(angle), cos(angle));\n}\n\nfloat projectLinearPosition(vec2 pos, float angle){\n    vec2 center = vec2(0.5);\n    vec2 result = pos - center;\n    result = rotate2d(angle) * result;\n    result = result + center;\n    return clamp(result.x, 0., 1.);\n}\n\nfloat projectRadialPosition(vec2 pos) {\n    float r = distance(vFilterCoord, vec2(0.5));\n    return clamp(2.*r, 0., 1.);\n}\n\nfloat projectAnglePosition(vec2 pos, float angle) {\n    vec2 center = pos - vec2(0.5);\n    float polarAngle=atan(-center.y, center.x);\n    return mod(polarAngle + angle, PI_2) / PI_2;\n}\n\nfloat projectPosition(vec2 pos, int type, float angle) {\n    if (type == TYPE_LINEAR) {\n        return projectLinearPosition(pos, angle);\n    } else if (type == TYPE_RADIAL) {\n        return projectRadialPosition(pos);\n    } else if (type == TYPE_CONIC) {\n        return projectAnglePosition(pos, angle);\n    }\n\n    return pos.y;\n}\n\nvoid main(void) {\n    // current/original color\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n\n    // skip calculations if gradient alpha is 0\n    if (0.0 == uAlpha) {\n        gl_FragColor = currentColor;\n        return;\n    }\n\n    // project position\n    float y = projectPosition(vFilterCoord, uType, radians(uAngle));\n\n    // check gradient bounds\n    float offsetMin = uOffsets[0];\n    float offsetMax = 0.0;\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (i == uNumStops-1){ // last index\n            offsetMax = uOffsets[i];\n        }\n    }\n\n    if (y  < offsetMin || y > offsetMax) {\n        gl_FragColor = currentColor;\n        return;\n    }\n\n    // limit colors\n    if (uMaxColors > 0) {\n        float stepSize = 1./float(uMaxColors);\n        float stepNumber = float(floor(y/stepSize));\n        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment\n    }\n\n    // find color stops\n    ColorStop from;\n    ColorStop to;\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (y >= uOffsets[i]) {\n            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);\n            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);\n        }\n\n        if (i == uNumStops-1){ // last index\n            break;\n        }\n    }\n\n    // mix colors from stops\n    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);\n    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);\n\n    float segmentHeight = to.offset - from.offset;\n    float relativePos = y - from.offset;// position from 0 to [segmentHeight]\n    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].\n\n    float gradientAlpha = uAlpha * currentColor.a;\n    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;\n\n    if (uReplace == false) {\n        // mix resulting color with current color\n        gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);\n    } else {\n        // replace with gradient color\n        gl_FragColor = gradientColor;\n    }\n}\n"),this._stops=[],this.autoFit=!1,Object.assign(this,r)}get stops(){return this._stops}set stops(t){const e=function(t){return[...t].sort((t,e)=>t.offset-e.offset)}(t),n=new Float32Array(3*e.length);for(let t=0;t<e.length;t++){const r=nm(e[t].color),i=3*t;n[i+0]=r[0],n[i+1]=r[1],n[i+2]=r[2]}this.uniforms.uColors=n,this.uniforms.uOffsets=e.map(t=>t.offset),this.uniforms.uAlphas=e.map(t=>t.alpha),this.uniforms.uNumStops=e.length,this._stops=e}set type(t){this.uniforms.uType=t}get type(){return this.uniforms.uType}set angle(t){this.uniforms.uAngle=t-90}get angle(){return this.uniforms.uAngle+90}set alpha(t){this.uniforms.uAlpha=t}get alpha(){return this.uniforms.uAlpha}set maxColors(t){this.uniforms.uMaxColors=t}get maxColors(){return this.uniforms.uMaxColors}set replace(t){this.uniforms.uReplace=t}get replace(){return this.uniforms.uReplace}};let fm=pm;fm.LINEAR=0,fm.RADIAL=1,fm.CONIC=2,fm.defaults={type:pm.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0,replace:!1};class mm extends Nn{constructor(t=0,e=1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 color;\nuniform float alpha;\n\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = vec4(mix(currentColor.rgb, color.rgb, currentColor.a * alpha), currentColor.a);\n}\n"),this._color=0,this._alpha=1,this.uniforms.color=new Float32Array(3),this.color=t,this.alpha=e}set color(t){const e=this.uniforms.color;"number"==typeof t?(Kt(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._color=Zt(e))}get color(){return this._color}set alpha(t){this.uniforms.alpha=t,this._alpha=t}get alpha(){return this._alpha}}const gm=class extends Nn{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nconst float SQRT_2 = 1.414213;\n\nconst float light = 1.0;\n\nuniform float curvature;\nuniform float lineWidth;\nuniform float lineContrast;\nuniform bool verticalLine;\nuniform float noise;\nuniform float noiseSize;\n\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\n\nuniform float seed;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));\n    \n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 rgb = gl_FragColor.rgb;\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        rgb += _noise * noise;\n    }\n\n    if (lineWidth > 0.0)\n    {\n        float _c = curvature > 0. ? curvature : 1.;\n        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;\n        vec2 uv = dir * k;\n\n        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;\n        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;\n        rgb *= j;\n        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);\n        rgb *= 0.99 + ceil(segment) * 0.015;\n    }\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    gl_FragColor.rgb = rgb;\n}\n"),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,gm.defaults,t)}apply(t,e,n,r){const{width:i,height:s}=e.filterFrame;this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=s,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,e,n,r)}set curvature(t){this.uniforms.curvature=t}get curvature(){return this.uniforms.curvature}set lineWidth(t){this.uniforms.lineWidth=t}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(t){this.uniforms.lineContrast=t}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(t){this.uniforms.verticalLine=t}get verticalLine(){return this.uniforms.verticalLine}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};gm.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var vm=Object.defineProperty,xm=Object.getOwnPropertySymbols,wm=Object.prototype.hasOwnProperty,_m=Object.prototype.propertyIsEnumerable,bm=(t,e,n)=>e in t?vm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Am=(t,e)=>{for(var n in e||(e={}))wm.call(e,n)&&bm(t,n,e[n]);if(xm)for(var n of xm(e))_m.call(e,n)&&bm(t,n,e[n]);return t};const Tm=class extends Nn{constructor(t){super(),this.angle=45,this._distance=5,this._resolution=V.FILTER_RESOLUTION;const e=t?Am(Am({},Tm.defaults),t):Tm.defaults,{kernels:n,blur:r,quality:i,pixelSize:s,resolution:o}=e;this._offset=new hn(this._updatePadding,this),this._tintFilter=new Nn("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform vec3 color;\n\nuniform vec2 shift;\nuniform vec4 inputSize;\n\nvoid main(void){\n    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = color.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= alpha;\n\n    gl_FragColor = sample;\n}"),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=o,this._blurFilter=n?new Xf(n):new Xf(r,i),this.pixelSize=s,this.resolution=o;const{shadowOnly:a,rotation:l,distance:c,offset:h,alpha:u,color:d}=e;this.shadowOnly=a,void 0!==l&&void 0!==c?(this.rotation=l,this.distance=c):this.offset=h,this.alpha=u,this.color=d}apply(t,e,n,r){const i=t.getFilterTexture();this._tintFilter.apply(t,e,i,1),this._blurFilter.apply(t,i,n,r),!0!==this.shadowOnly&&t.applyFilter(this,e,n,0),t.returnFilterTexture(i)}_updatePadding(){const t=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=t+2*this.blur}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(t){this._offset.copyFrom(t),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get distance(){return this._distance}set distance(t){ft("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=t,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/Xe}set rotation(t){ft("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=t*Xe,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(t){this._tintFilter.uniforms.alpha=t}get color(){return Zt(this._tintFilter.uniforms.color)}set color(t){Kt(t,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};Tm.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:V.FILTER_RESOLUTION};const Sm=class extends Nn{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","// precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\nuniform float aspect;\n\nuniform sampler2D displacementMap;\nuniform float offset;\nuniform float sinDir;\nuniform float cosDir;\nuniform int fillMode;\n\nuniform float seed;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nconst int TRANSPARENT = 0;\nconst int ORIGINAL = 1;\nconst int LOOP = 2;\nconst int CLAMP = 3;\nconst int MIRROR = 4;\n\nvoid main(void)\n{\n    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;\n\n    if (coord.x > 1.0 || coord.y > 1.0) {\n        return;\n    }\n\n    float cx = coord.x - 0.5;\n    float cy = (coord.y - 0.5) * aspect;\n    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;\n\n    // displacementMap: repeat\n    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);\n\n    // displacementMap: mirror\n    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);\n\n    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));\n\n    float displacement = (dc.r - dc.g) * (offset / filterArea.x);\n\n    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);\n\n    if (fillMode == CLAMP) {\n        coord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    } else {\n        if( coord.x > filterClamp.z ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x -= filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x = filterClamp.z * 2.0 - coord.x;\n            }\n        } else if( coord.x < filterClamp.x ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x += filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x *= -filterClamp.z;\n            }\n        }\n\n        if( coord.y > filterClamp.w ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y -= filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y = filterClamp.w * 2.0 - coord.y;\n            }\n        } else if( coord.y < filterClamp.y ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y += filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y *= -filterClamp.w;\n            }\n        }\n    }\n\n    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;\n    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;\n    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;\n    gl_FragColor.a = texture2D(uSampler, coord).a;\n}\n"),this.offset=100,this.fillMode=Sm.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=Kn.from(this._canvas,{scaleMode:L.NEAREST}),Object.assign(this,Sm.defaults,t)}apply(t,e,n,r){const{width:i,height:s}=e.filterFrame;this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/i,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,e,n,r)}_randomizeSizes(){const t=this._sizes,e=this._slices-1,n=this.sampleSize,r=Math.min(this.minSize/n,.9/this._slices);if(this.average){const n=this._slices;let i=1;for(let s=0;s<e;s++){const e=i/(n-s),o=Math.max(e*(1-.6*Math.random()),r);t[s]=o,i-=o}t[e]=i}else{let n=1;const i=Math.sqrt(1/this._slices);for(let s=0;s<e;s++){const e=Math.max(i*n*Math.random(),r);t[s]=e,n-=e}t[e]=n}this.shuffle()}shuffle(){const t=this._sizes;for(let e=this._slices-1;e>0;e--){const n=Math.random()*e|0,r=t[e];t[e]=t[n],t[n]=r}}_randomizeOffsets(){for(let t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const t=this.sampleSize,e=this.texture,n=this._canvas.getContext("2d");n.clearRect(0,0,8,t);let r,i=0;for(let e=0;e<this._slices;e++){r=Math.floor(256*this._offsets[e]);const s=this._sizes[e]*t,o=r>0?r:0,a=r<0?-r:0;n.fillStyle=`rgba(${o}, ${a}, 0, 1)`,n.fillRect(0,0|i,t,s+1|0),i+=s}e.baseTexture.update(),this.uniforms.displacementMap=e}set sizes(t){const e=Math.min(this._slices,t.length);for(let n=0;n<e;n++)this._sizes[n]=t[n]}get sizes(){return this._sizes}set offsets(t){const e=Math.min(this._slices,t.length);for(let n=0;n<e;n++)this._offsets[n]=t[n]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())}get direction(){return this._direction}set direction(t){if(this._direction===t)return;this._direction=t;const e=t*Xe;this.uniforms.sinDir=Math.sin(e),this.uniforms.cosDir=Math.cos(e)}get red(){return this.uniforms.red}set red(t){this.uniforms.red=t}get green(){return this.uniforms.green}set green(t){this.uniforms.green=t}get blue(){return this.uniforms.blue}set blue(t){this.uniforms.blue=t}destroy(){var t;null==(t=this.texture)||t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};let Em=Sm;Em.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},Em.TRANSPARENT=0,Em.ORIGINAL=1,Em.LOOP=2,Em.CLAMP=3,Em.MIRROR=4;const km=class extends Nn{constructor(t){const e=Object.assign({},km.defaults,t),{outerStrength:n,innerStrength:r,color:i,knockout:s,quality:o,alpha:a}=e,l=Math.round(e.distance);super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nuniform float outerStrength;\nuniform float innerStrength;\n\nuniform vec4 glowColor;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform bool knockout;\nuniform float alpha;\n\nconst float PI = 3.14159265358979323846264;\n\nconst float DIST = __DIST__;\nconst float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);\nconst float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);\n\nconst float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;\n\nvoid main(void) {\n    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);\n\n    float totalAlpha = 0.0;\n\n    vec2 direction;\n    vec2 displaced;\n    vec4 curColor;\n\n    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {\n       direction = vec2(cos(angle), sin(angle)) * px;\n\n       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {\n           displaced = clamp(vTextureCoord + direction * \n                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);\n\n           curColor = texture2D(uSampler, displaced);\n\n           totalAlpha += (DIST - curDistance) * curColor.a;\n       }\n    }\n    \n    curColor = texture2D(uSampler, vTextureCoord);\n\n    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);\n\n    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;\n    float innerGlowStrength = min(1.0, innerGlowAlpha);\n    \n    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);\n\n    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);\n    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);\n\n    if (knockout) {\n      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;\n      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);\n    }\n    else {\n      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;\n      gl_FragColor = innerColor + outerGlowColor;\n    }\n}\n".replace(/__ANGLE_STEP_SIZE__/gi,`${(1/o/l).toFixed(7)}`).replace(/__DIST__/gi,`${l.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:i,outerStrength:n,innerStrength:r,padding:l,knockout:s,alpha:a})}get color(){return Zt(this.uniforms.glowColor)}set color(t){Kt(t,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(t){this.uniforms.outerStrength=t}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(t){this.uniforms.innerStrength=t}get knockout(){return this.uniforms.knockout}set knockout(t){this.uniforms.knockout=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};km.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};const Mm=class extends Nn{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform vec2 light;\nuniform bool parallel;\nuniform float aspect;\n\nuniform float gain;\nuniform float lacunarity;\nuniform float time;\nuniform float alpha;\n\n${perlin}\n\nvoid main(void) {\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    float d;\n\n    if (parallel) {\n        float _cos = light.x;\n        float _sin = light.y;\n        d = (_cos * coord.x) + (_sin * coord.y * aspect);\n    } else {\n        float dx = coord.x - light.x / dimensions.x;\n        float dy = (coord.y - light.y / dimensions.y) * aspect;\n        float dis = sqrt(dx * dx + dy * dy) + 0.00001;\n        d = dy / dis;\n    }\n\n    vec3 dir = vec3(d, d, 0.0);\n\n    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);\n    noise = mix(noise, 0.0, 0.3);\n    //fade vertically.\n    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);\n    mist.a = 1.0;\n    // apply user alpha\n    mist *= alpha;\n\n    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;\n\n}\n".replace("${perlin}","vec3 mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\n    return mod289(((x * 34.0) + 1.0) * x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t)\n{\n    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n// Classic Perlin noise, periodic variant\nfloat pnoise(vec3 P, vec3 rep)\n{\n    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n    Pi0 = mod289(Pi0);\n    Pi1 = mod289(Pi1);\n    vec3 Pf0 = fract(P); // Fractional part for interpolation\n    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\n    vec4 iz0 = Pi0.zzzz;\n    vec4 iz1 = Pi1.zzzz;\n    vec4 ixy = permute(permute(ix) + iy);\n    vec4 ixy0 = permute(ixy + iz0);\n    vec4 ixy1 = permute(ixy + iz1);\n    vec4 gx0 = ixy0 * (1.0 / 7.0);\n    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n    gx0 = fract(gx0);\n    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n    vec4 sz0 = step(gz0, vec4(0.0));\n    gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n    gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n    vec4 gx1 = ixy1 * (1.0 / 7.0);\n    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n    gx1 = fract(gx1);\n    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n    vec4 sz1 = step(gz1, vec4(0.0));\n    gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n    gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n    g000 *= norm0.x;\n    g010 *= norm0.y;\n    g100 *= norm0.z;\n    g110 *= norm0.w;\n    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n    g001 *= norm1.x;\n    g011 *= norm1.y;\n    g101 *= norm1.z;\n    g111 *= norm1.w;\n    float n000 = dot(g000, Pf0);\n    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n    float n111 = dot(g111, Pf1);\n    vec3 fade_xyz = fade(Pf0);\n    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n    return 2.2 * n_xyz;\n}\nfloat turb(vec3 P, vec3 rep, float lacunarity, float gain)\n{\n    float sum = 0.0;\n    float sc = 1.0;\n    float totalgain = 1.0;\n    for (float i = 0.0; i < 6.0; i++)\n    {\n        sum += totalgain * pnoise(P * sc, rep);\n        sc *= lacunarity;\n        totalgain *= gain;\n    }\n    return abs(sum);\n}\n")),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);const e=Object.assign(Mm.defaults,t);this._angleLight=new Ye,this.angle=e.angle,this.gain=e.gain,this.lacunarity=e.lacunarity,this.alpha=e.alpha,this.parallel=e.parallel,this.center=e.center,this.time=e.time}apply(t,e,n,r){const{width:i,height:s}=e.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/i,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,n,r)}get angle(){return this._angle}set angle(t){this._angle=t;const e=t*Xe;this._angleLight.x=Math.cos(e),this._angleLight.y=Math.sin(e)}get gain(){return this.uniforms.gain}set gain(t){this.uniforms.gain=t}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(t){this.uniforms.lacunarity=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};Mm.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};const Cm=class extends Nn{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float uHue;\nuniform float uAlpha;\nuniform bool uColorize;\nuniform float uSaturation;\nuniform float uLightness;\n\n// https://en.wikipedia.org/wiki/Luma_(video)\nconst vec3 weight = vec3(0.299, 0.587, 0.114);\n\nfloat getWeightedAverage(vec3 rgb) {\n    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;\n}\n\n// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243\nconst vec3 k = vec3(0.57735, 0.57735, 0.57735);\n\nvec3 hueShift(vec3 color, float angle) {\n    float cosAngle = cos(angle);\n    return vec3(\n    color * cosAngle +\n    cross(k, color) * sin(angle) +\n    k * dot(k, color) * (1.0 - cosAngle)\n    );\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    vec4 result = color;\n\n    // colorize\n    if (uColorize) {\n        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);\n    }\n\n    // hue\n    result.rgb = hueShift(result.rgb, uHue);\n\n    // saturation\n    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js\n    float average = (result.r + result.g + result.b) / 3.0;\n\n    if (uSaturation > 0.) {\n        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));\n    } else {\n        result.rgb -= (average - result.rgb) * uSaturation;\n    }\n\n    // lightness\n    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));\n\n    // alpha\n    gl_FragColor = mix(color, result, uAlpha);\n}\n"),this._hue=0;const e=Object.assign({},Cm.defaults,t);Object.assign(this,e)}get hue(){return this._hue}set hue(t){this._hue=t,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}get colorize(){return this.uniforms.uColorize}set colorize(t){this.uniforms.uColorize=t}get lightness(){return this.uniforms.uLightness}set lightness(t){this.uniforms.uLightness=t}get saturation(){return this.uniforms.uSaturation}set saturation(t){this.uniforms.uSaturation=t}};Cm.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};const Pm=class extends Nn{constructor(t,e=0){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform float sepia;\nuniform float noise;\nuniform float noiseSize;\nuniform float scratch;\nuniform float scratchDensity;\nuniform float scratchWidth;\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\nuniform float seed;\n\nconst float SQRT_2 = 1.414213;\nconst vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvec3 Overlay(vec3 src, vec3 dst)\n{\n    // if (dst <= 0.5) then: 2 * src * dst\n    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)\n    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),\n                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),\n                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));\n}\n\n\nvoid main()\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 color = gl_FragColor.rgb;\n\n    if (sepia > 0.0)\n    {\n        float gray = (color.x + color.y + color.z) / 3.0;\n        vec3 grayscale = vec3(gray);\n\n        color = Overlay(SEPIA_RGB, grayscale);\n\n        color = grayscale + sepia * (color - grayscale);\n    }\n\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        vec2 dir = vec2(vec2(0.5, 0.5) - coord);\n        dir.y *= dimensions.y / dimensions.x;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    if (scratchDensity > seed && scratch != 0.0)\n    {\n        float phase = seed * 256.0;\n        float s = mod(floor(phase), 2.0);\n        float dist = 1.0 / scratchDensity;\n        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));\n        if (d < seed * 0.6 + 0.4)\n        {\n            highp float period = scratchDensity * 10.0;\n\n            float xx = coord.x * period + phase;\n            float aa = abs(mod(xx, 0.5) * 4.0);\n            float bb = mod(floor(xx / 0.5), 2.0);\n            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);\n\n            float kk = 2.0 * period;\n            float dw = scratchWidth / dimensions.x * (0.75 + seed);\n            float dh = dw * kk;\n\n            float tine = (yy - (2.0 - dh));\n\n            if (tine > 0.0) {\n                float _sign = sign(scratch);\n\n                tine = s * tine / period + scratch + 0.1;\n                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);\n\n                color.rgb *= tine;\n            }\n        }\n    }\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);\n        // float _noise = snoise(d) * 0.5;\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        color += _noise * noise;\n    }\n\n    gl_FragColor.rgb = color;\n}\n"),this.seed=0,this.uniforms.dimensions=new Float32Array(2),"number"==typeof t?(this.seed=t,t=void 0):this.seed=e,Object.assign(this,Pm.defaults,t)}apply(t,e,n,r){var i,s;this.uniforms.dimensions[0]=null==(i=e.filterFrame)?void 0:i.width,this.uniforms.dimensions[1]=null==(s=e.filterFrame)?void 0:s.height,this.uniforms.seed=this.seed,t.applyFilter(this,e,n,r)}set sepia(t){this.uniforms.sepia=t}get sepia(){return this.uniforms.sepia}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set scratch(t){this.uniforms.scratch=t}get scratch(){return this.uniforms.scratch}set scratchDensity(t){this.uniforms.scratchDensity=t}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(t){this.uniforms.scratchWidth=t}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};Pm.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};const Im=class extends Nn{constructor(t=1,e=0,n=.1,r=1,i=!1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterClamp;\n\nuniform float uAlpha;\nuniform vec2 uThickness;\nuniform vec4 uColor;\nuniform bool uKnockout;\n\nconst float DOUBLE_PI = 2. * 3.14159265358979323846264;\nconst float ANGLE_STEP = ${angleStep};\n\nfloat outlineMaxAlphaAtPos(vec2 pos) {\n    if (uThickness.x == 0. || uThickness.y == 0.) {\n        return 0.;\n    }\n\n    vec4 displacedColor;\n    vec2 displacedPos;\n    float maxAlpha = 0.;\n\n    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {\n        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);\n        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);\n        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));\n        maxAlpha = max(maxAlpha, displacedColor.a);\n    }\n\n    return maxAlpha;\n}\n\nvoid main(void) {\n    vec4 sourceColor = texture2D(uSampler, vTextureCoord);\n    vec4 contentColor = sourceColor * float(!uKnockout);\n    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);\n    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);\n    gl_FragColor = contentColor + outlineColor;\n}\n".replace(/\$\{angleStep\}/,Im.getAngleStep(n))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=r,this.uniforms.uKnockout=i,Object.assign(this,{thickness:t,color:e,quality:n,alpha:r,knockout:i})}static getAngleStep(t){const e=Math.max(t*Im.MAX_SAMPLES,Im.MIN_SAMPLES);return(2*Math.PI/e).toFixed(7)}apply(t,e,n,r){this.uniforms.uThickness[0]=this._thickness/e._frame.width,this.uniforms.uThickness[1]=this._thickness/e._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,t.applyFilter(this,e,n,r)}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get color(){return Zt(this.uniforms.uColor)}set color(t){Kt(t,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(t){this._knockout=t}get thickness(){return this._thickness}set thickness(t){this._thickness=t,this.padding=t}};let Rm=Im;Rm.MIN_SAMPLES=1,Rm.MAX_SAMPLES=100;const Om=class extends Nn{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nuniform bool mirror;\nuniform float boundary;\nuniform vec2 amplitude;\nuniform vec2 waveLength;\nuniform vec2 alpha;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 coord = pixelCoord / dimensions;\n\n    if (coord.y < boundary) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    float k = (coord.y - boundary) / (1. - boundary + 0.0001);\n    float areaY = boundary * dimensions.y / filterArea.y;\n    float v = areaY + areaY - vTextureCoord.y;\n    float y = mirror ? v : vTextureCoord.y;\n\n    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;\n    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;\n    float _alpha = (alpha.y - alpha.x) * k + alpha.x;\n\n    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;\n    x = clamp(x, filterClamp.x, filterClamp.z);\n\n    vec4 color = texture2D(uSampler, vec2(x, y));\n\n    gl_FragColor = color * _alpha;\n}\n"),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Om.defaults,t)}apply(t,e,n,r){var i,s;this.uniforms.dimensions[0]=null==(i=e.filterFrame)?void 0:i.width,this.uniforms.dimensions[1]=null==(s=e.filterFrame)?void 0:s.height,this.uniforms.time=this.time,t.applyFilter(this,e,n,r)}set mirror(t){this.uniforms.mirror=t}get mirror(){return this.uniforms.mirror}set boundary(t){this.uniforms.boundary=t}get boundary(){return this.uniforms.boundary}set amplitude(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]}get waveLength(){return this.uniforms.waveLength}set alpha(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]}get alpha(){return this.uniforms.alpha}};Om.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};const Dm=class extends Nn{constructor(t=[0,0],e,n=0){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nuniform vec2 center;\n\nuniform float amplitude;\nuniform float wavelength;\n// uniform float power;\nuniform float brightness;\nuniform float speed;\nuniform float radius;\n\nuniform float time;\n\nconst float PI = 3.14159;\n\nvoid main()\n{\n    float halfWavelength = wavelength * 0.5 / filterArea.x;\n    float maxRadius = radius / filterArea.x;\n    float currentRadius = time * speed / filterArea.x;\n\n    float fade = 1.0;\n\n    if (maxRadius > 0.0) {\n        if (currentRadius > maxRadius) {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\n    }\n\n    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);\n    dir.y *= filterArea.y / filterArea.x;\n    float dist = length(dir);\n\n    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    vec2 diffUV = normalize(dir);\n\n    float diff = (dist - currentRadius) / halfWavelength;\n\n    float p = 1.0 - pow(abs(diff), 2.0);\n\n    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );\n    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );\n\n    vec2 offset = diffUV * powDiff / filterArea.xy;\n\n    // Do clamp :\n    vec2 coord = vTextureCoord + offset;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    // No clamp :\n    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);\n\n    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;\n\n    gl_FragColor = color;\n}\n"),this.center=t,Object.assign(this,Dm.defaults,e),this.time=n}apply(t,e,n,r){this.uniforms.time=this.time,t.applyFilter(this,e,n,r)}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}get amplitude(){return this.uniforms.amplitude}set amplitude(t){this.uniforms.amplitude=t}get wavelength(){return this.uniforms.wavelength}set wavelength(t){this.uniforms.wavelength=t}get brightness(){return this.uniforms.brightness}set brightness(t){this.uniforms.brightness=t}get speed(){return this.uniforms.speed}set speed(t){this.uniforms.speed=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}};Dm.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};class Lm extends Nn{constructor(t){var e,n;super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    color /= total;\n    color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n"),this.uniforms.blur=t.blur,this.uniforms.gradientBlur=t.gradientBlur,this.uniforms.start=null!=(e=t.start)?e:new Ye(0,window.innerHeight/2),this.uniforms.end=null!=(n=t.end)?n:new Ye(600,window.innerHeight/2),this.uniforms.delta=new Ye(30,30),this.uniforms.texSize=new Ye(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(t){this.uniforms.blur=t}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(t){this.uniforms.gradientBlur=t}get start(){return this.uniforms.start}set start(t){this.uniforms.start=t,this.updateDelta()}get end(){return this.uniforms.end}set end(t){this.uniforms.end=t,this.updateDelta()}}class Fm extends Lm{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=t/n,this.uniforms.delta.y=e/n}}class Bm extends Lm{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=-e/n,this.uniforms.delta.y=t/n}}const Nm=class extends Nn{constructor(t,e,n,r){super(),"number"==typeof t&&(ft("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),t={blur:t,gradientBlur:e,start:n,end:r}),t=Object.assign({},Nm.defaults,t),this.tiltShiftXFilter=new Fm(t),this.tiltShiftYFilter=new Bm(t)}apply(t,e,n,r){const i=t.getFilterTexture();this.tiltShiftXFilter.apply(t,e,i,1),this.tiltShiftYFilter.apply(t,i,n,r),t.returnFilterTexture(i)}get blur(){return this.tiltShiftXFilter.blur}set blur(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}get start(){return this.tiltShiftXFilter.start}set start(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}get end(){return this.tiltShiftXFilter.end}set end(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}};Nm.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};const Wm=class extends Nn{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 twist(vec2 coord)\n{\n    coord -= offset;\n\n    float dist = length(coord);\n\n    if (dist < radius)\n    {\n        float ratioDist = (radius - dist) / radius;\n        float angleMod = ratioDist * ratioDist * angle;\n        float s = sin(angleMod);\n        float c = cos(angleMod);\n        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n    }\n\n    coord += offset;\n\n    return coord;\n}\n\nvoid main(void)\n{\n\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = twist(coord);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord );\n\n}\n"),Object.assign(this,Wm.defaults,t)}get offset(){return this.uniforms.offset}set offset(t){this.uniforms.offset=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get angle(){return this.uniforms.angle}set angle(t){this.uniforms.angle=t}};Wm.defaults={radius:200,angle:4,padding:20,offset:new Ye};var Um=Object.getOwnPropertySymbols,jm=Object.prototype.hasOwnProperty,Hm=Object.prototype.propertyIsEnumerable;const zm=class extends Nn{constructor(t){const e=Object.assign(zm.defaults,t),{maxKernelSize:n}=e,r=((t,e)=>{var n={};for(var r in t)jm.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&Um)for(var r of Um(t))e.indexOf(r)<0&&Hm.call(t,r)&&(n[r]=t[r]);return n})(e,["maxKernelSize"]);super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uCenter;\nuniform float uStrength;\nuniform float uInnerRadius;\nuniform float uRadius;\n\nconst float MAX_KERNEL_SIZE = ${maxKernelSize};\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand(vec2 co, float seed) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);\n    return fract(sin(sn) * c + seed);\n}\n\nvoid main() {\n\n    float minGradient = uInnerRadius * 0.3;\n    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;\n\n    float gradient = uRadius * 0.3;\n    float radius = (uRadius - gradient * 0.5) / filterArea.x;\n\n    float countLimit = MAX_KERNEL_SIZE;\n\n    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);\n    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));\n\n    float strength = uStrength;\n\n    float delta = 0.0;\n    float gap;\n    if (dist < innerRadius) {\n        delta = innerRadius - dist;\n        gap = minGradient;\n    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity\n        delta = dist - radius;\n        gap = gradient;\n    }\n\n    if (delta > 0.0) {\n        float normalCount = gap / filterArea.x;\n        delta = (normalCount - delta) / normalCount;\n        countLimit *= delta;\n        strength *= delta;\n        if (countLimit < 1.0)\n        {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n    }\n\n    // randomize the lookup values to hide the fixed number of samples\n    float offset = rand(vTextureCoord, 0.0);\n\n    float total = 0.0;\n    vec4 color = vec4(0.0);\n\n    dir *= strength;\n\n    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {\n        float percent = (t + offset) / MAX_KERNEL_SIZE;\n        float weight = 4.0 * (percent - percent * percent);\n        vec2 p = vTextureCoord + dir * percent;\n        vec4 sample = texture2D(uSampler, p);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample * weight;\n        total += weight;\n\n        if (t > countLimit){\n            break;\n        }\n    }\n\n    color /= total;\n    // switch back from pre-multiplied alpha\n    // color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n".replace("${maxKernelSize}",n.toFixed(1))),Object.assign(this,r)}get center(){return this.uniforms.uCenter}set center(t){this.uniforms.uCenter=t}get strength(){return this.uniforms.uStrength}set strength(t){this.uniforms.uStrength=t}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(t){this.uniforms.uInnerRadius=t}get radius(){return this.uniforms.uRadius}set radius(t){(t<0||t===1/0)&&(t=-1),this.uniforms.uRadius=t}};zm.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};var Gm=w(function t(){g(this,t)},null,[{key:"getRandomID",value:function(){return(+new Date).toString(16)+(1e8*Math.random()|0).toString(16)}},{key:"calculateDistance",value:function(t,e,n,r){return Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2))}},{key:"getRandomNumber",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return+(Math.random()*(e-t)+t).toFixed(n)}},{key:"clamp",value:function(t,e,n){return Math.max(e,Math.min(n,t))}},{key:"testForAABB",value:function(t,e){var n=t.getBounds(),r=e.getBounds();return n.x<r.x+r.width&&n.x+n.width>r.x&&n.y<r.y+r.height&&n.y+n.height>r.y}}]);S(Gm,"getScale",function(t,e){var n=t.width;return e.width/n}),S(Gm,"isNumber",function(t){return"number"==typeof t&&!isNaN(t)});var Xm=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t&&(t.progress(n),t.kill(),t.clear(),e&&(t=null))},Vm=function(t,e){var n=e.hide,r=e.fadeToHalf,i=e.fadeInFromZeroToHalf,s=e.fadeInFromFullToHalf,o=e.fadeToDark,a=e.duration,l=void 0===a?.3:a;return t.visible=!0,n?Ff.to(t,{alpha:0,visible:!1,duration:l}):r?Ff.to(t,{alpha:.65,duration:l}):i?Ff.fromTo(t,{alpha:0},{alpha:.5,duration:l}):s?Ff.fromTo(t,{alpha:1},{alpha:.5,duration:l}):o?Ff.to(t,{alpha:1,duration:l}):void 0},Ym=function(t,e){var n=e.show,r=e.showAll,i=e.hide,s=e.duration,o=void 0===s?.3:s,a=e.delay,l=void 0===a?0:a,c=t.refs,h=c.optionsWheel,u=c.hudView,d=c.btnHint,p=t.uiInner;return n?Ff.timeline().fromTo([p],{alpha:0},{alpha:1,duration:o,delay:l,visible:!0}):r?Ff.timeline().fromTo([p,h,u,d],{alpha:0},{alpha:1,duration:o,delay:l,visible:!0}):i?Ff.timeline().to([p,h,u,d],{alpha:0,duration:o,delay:l,visible:!1}):void 0},$m=w(function t(){g(this,t)},null,[{key:"click",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;return this.clickTimeLine=Ff.timeline().fromTo(t.scale,{x:t.scale.x,y:t.scale.y},{x:t.scale.x-n,y:t.scale.y-r,yoyo:!0,repeat:1,duration:.1}),new Promise(function(t){e.clickTimeLine.eventCallback("onComplete",function(){Xm(e.clickTimeLine),t()})})}},{key:"initOverHandler",value:function(t,e,n){(Array.isArray(t)?t:[t]).forEach(function(t){var r=t.scale.x-.05*Math.sign(t.scale.x),i=t.scale.y-.05*Math.sign(t.scale.y),s={x:void 0!==e?e:r,y:void 0!==e?e:i},o={x:void 0!==n?n:t.scale.x,y:void 0!==n?n:t.scale.y};t.on("pointerover",function(){return Ff.to(t.scale,{x:s.x,y:s.y,duration:.2})}),t.on("pointerout",function(){return Ff.to(t.scale,{x:o.x,y:o.y,duration:.2})})})}}]);function qm(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Km(t,e){return t.get(Zm(t,e))}function Zm(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}S($m,"clickTimeLine",null);var Qm=new WeakMap,Jm=new WeakMap,tg=w(function t(e){var n=this;g(this,t),qm(this,Qm,void 0),S(this,"view",void 0),S(this,"innerModal",void 0),S(this,"fade",void 0),qm(this,Jm,function(){var t=n.view.getChildByName("innerModal"),e=n.view.getChildByName("innerContainer",1);t.addChild(e)}),S(this,"show",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.showCallback(),$m.initOverHandler(Km(Qm,n)),n.view.visible=!0,Km(Qm,n).eventMode="none",t.next=1,Ff.timeline().set(n.innerModal,{visible:!0}).fromTo(n.view,{alpha:0},{alpha:1,ease:"linear"}).fromTo(n.innerModal.scale,{x:0,y:0},{x:1,y:1,ease:"back.out(2.5)"},"<");case 1:Km(Qm,n).eventMode="static",Gf.soundManager.unmute();case 2:case"end":return t.stop()}},t)}))),S(this,"hide",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Gf.soundManager.play("sfx_btnClick"),n.view.interactiveChildren=!1,t.next=1,$m.click(Km(Qm,n));case 1:return t.next=2,Ff.timeline().to(n.view,{alpha:0,duration:.1,ease:"linear"},"<").set(n.view,{visible:!1,interactiveChildren:!0});case 2:n.hideCallback();case 3:case"end":return t.stop()}},t)}))),this.view=e,this.innerModal=this.view.getChildByName("innerModal",1),this.fade=this.view.getChildByName("fade"),function(t,e,n){t.set(Zm(t,e),n)}(Qm,this,this.view.getChildByName("btnClose",1)),Km(Qm,this).on("pointerup",this.hide),Km(Jm,this).call(this)},[{key:"showCallback",value:function(){}},{key:"hideCallback",value:function(){}}]);function eg(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(eg=function(){return!!t})()}var ng,rg=new WeakMap,ig=function(t){function e(t,n){var r;return g(this,e),r=function(t,e,n){return e=b(e),_(t,eg()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,void 0)}(r,rg),function(t,e,n){t.set(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e),n)}(rg,r,t),r.fade.alpha=null!=n?n:r.fade.alpha,r}return T(e,t),w(e)}(tg),sg=(r(9391),99603095),og={GAME_PRELOAD:{initialize:"GAME_PRELOAD:initialize",loadPlayerData:"GAME_PRELOAD:loadPlayerData",showAd:"GAME_PRELOAD:showAd"},LEVEL_PRELOAD:{loading:"LEVEL_PRELOAD:loading",loadBundle:"LEVEL_PRELOAD:loadBundle"},SOUND_PRELOAD:{preload:"SOUND_PRELOAD:preload"}},ag=w(function t(){g(this,t)});ng=ag,S(ag,"btnStart",function(){"function"==typeof ym&&ym(sg,"reachGoal","clickBtnStart")}),S(ag,"mainScreenBtnStore",function(){"function"==typeof ym&&ym(sg,"reachGoal","mainScreenBtnStore")}),S(ag,"btnLeaders",function(){"function"==typeof ym&&ym(sg,"reachGoal","clickBtnLeaders")}),S(ag,"userReviewClickOk",function(){"function"==typeof ym&&ym(sg,"reachGoal","userReviewClickOk")}),S(ag,"userReviewClickLater",function(){"function"==typeof ym&&ym(sg,"reachGoal","userReviewClickLater")}),S(ag,"finalScreenBtnNext",function(){"function"==typeof ym&&ym(sg,"reachGoal","finalScreenBtnNext")}),S(ag,"finalScreenBtnHome",function(){"function"==typeof ym&&ym(sg,"reachGoal","finalScreenBtnHome")}),S(ag,"finalScreenBtnDisableAd",function(){"function"==typeof ym&&ym(sg,"reachGoal","finalScreenBtnDisableAd")}),S(ag,"finalScreenBtnStore",function(){"function"==typeof ym&&ym(sg,"reachGoal","finalScreenBtnStore")}),S(ag,"noHintsClickBtnStore",function(){"function"==typeof ym&&ym(sg,"reachGoal","noHintsClickBtnStore")}),S(ag,"noHintsClickBtnReward",function(){"function"==typeof ym&&ym(sg,"reachGoal","noHintsClickBtnReward")}),S(ag,"completeGame",function(){"function"==typeof ym&&ym(sg,"reachGoal","completeGame")}),S(ag,"gameTimeTracker",function(){"function"==typeof ym&&ym(sg,"reachGoal","gameTimeTracker")}),S(ag,"rewardedAdWatched",function(){"function"==typeof ym&&ym(sg,"reachGoal","rewardedAdWatched")}),S(ag,"interstitialWatched",function(){"function"==typeof ym&&ym(sg,"reachGoal","interstitialWatched")}),S(ag,"forceReload",function(){"function"==typeof ym&&ym(sg,"reachGoal","forceReload")}),S(ag,"startLevel",function(t,e){if("function"==typeof ym){var n=t.spineName,r=t.currentSkinName,i=e.userLevel;ym(sg,"params",{startLevel:{spineName:n,currentSkinName:r,userLevel:i}})}}),S(ag,"completeLevel",function(t,e,n){if("function"==typeof ym){var r=t.spineName,i=t.currentSkinName,s=e.userLevel;ym(sg,"params",{completeLevel:{spineName:r,currentSkinName:i,userLevel:S({},s,{levelPlayTime:n})}})}}),S(ag,"earlyExit",function(t,e,n){if("function"==typeof ym){var r=t.spineName,i=t.currentSkinName,s=e.userLevel;ym(sg,"params",{earlyExit:{spineName:r,currentSkinName:i,userLevel:S({},s,{levelPlayTime:n})}})}}),S(ag,"useHint",function(t,e){if("function"==typeof ym){var n=t.spineName,r=t.currentSkinName;ym(sg,"params",{useHint:{spineName:n,currentSkinName:r,spriteName:e.name}})}}),S(ag,"hintCounter",function(t,e){if("function"==typeof ym){var n=t.userLevel+1,r=t.playerData,i=r.levelIndex,s=r.skinIndex;ym(sg,"params",{hintCounter:{spineName:i,currentSkinName:s,userLevel:S({},n,{counter:e})}})}}),S(ag,"missClickCounter",function(t,e){if("function"==typeof ym){var n=t.userLevel+1,r=t.playerData,i=r.levelIndex,s=r.skinIndex;ym(sg,"params",{missClickCounter:{counter:e,userLevel:n,spineName:i,currentSkinName:s}})}}),S(ag,"purchase",function(t){"function"==typeof ym&&ym(sg,"params",{purchase:{id:t}})}),S(ag,"soundLoadErr",function(t,e){"function"==typeof ym&&ym(sg,"params",{soundLoadErr:{src:t,err:e}})}),S(ag,"preloadError",function(t,e){if("function"==typeof ym)try{var n=(null==e?void 0:e.message)||"Unknown error",r=(null==e?void 0:e.stack)||"No stack available",i=S({},"error_".concat(t),{error:{message:n,stack:r}});ym(sg,"params",i)}catch(t){console.warn("metrika preloadError",t)}}),S(ag,"testingErrors",function(){var t,e,n,r,i,s,o=new Error("  ");ng.preloadError(null==og||null===(t=og.GAME_PRELOAD)||void 0===t?void 0:t.initialize,o),ng.preloadError(null==og||null===(e=og.GAME_PRELOAD)||void 0===e?void 0:e.loadPlayerData,o),ng.preloadError(null==og||null===(n=og.GAME_PRELOAD)||void 0===n?void 0:n.showAd,o),ng.preloadError(null==og||null===(r=og.LEVEL_PRELOAD)||void 0===r?void 0:r.loading,o),ng.preloadError(null==og||null===(i=og.LEVEL_PRELOAD)||void 0===i?void 0:i.loadBundle,o),ng.preloadError(null==og||null===(s=og.SOUND_PRELOAD)||void 0===s?void 0:s.preload,o)}),S(ag,"loadDuration",function(t){"function"==typeof ym&&ym(sg,"params",{gameLoadTime:t})});var lg,cg,hg="1.0.0",ug="timer_StoreBtnReward",dg="isTutorial_shadows",pg="isTutorial_words",fg="isTutorial_generator",mg=(S(S(S(S(S(S(S(S(S(S(lg={},"version",hg),"userLevel",1),"hints",3),"hasAdPass",!1),"levelIndex",0),"skinIndex",1),"partIndex",1),"option_isPlayMusic",!0),"option_isPlaySFX",!0),"option_isLight",!0),S(S(S(S(S(S(S(S(lg,"option_isDebug",!1),ug,null),"timer_NoHintsPupUpBtnReward",null),fg,!1),dg,!1),pg,!1),"playerId",null),"savedAt",null)),gg=function(){function t(){g(this,t)}return w(t,null,[{key:"flags",get:function(){return t.adapter.options.flags}},{key:"isUserAuth",get:function(){return t.adapter.player.isAuth()}}])}();cg=gg,S(gg,"sdk",void 0),S(gg,"makeReview",void 0),S(gg,"leaderboard",void 0),S(gg,"purchase",void 0),S(gg,"player",void 0),S(gg,"adapter",void 0),S(gg,"initSdk",function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return cg.adapter=e,t.next=1,e.init().catch(function(t){return console.error("[init sdk]",t)});case 1:cg.sdk=e,cg.makeReview=e.makeReview,cg.leaderboard=e.leaderboard,cg.purchase=e.purchase,cg.player=e.player,cg.gamePlayStop(),Gf.paymentManager.consumePendingPayments(),cg.showBanner(),cg.checkAvailableFlags();case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),S(gg,"isReady",function(){var t=cg.adapter.isReady;return t||(console.error("[SdkManager]: SDK is not initialized"),cg.initSdk()),t}),S(gg,"gameplayStart",function(){var t;null===(t=cg.sdk)||void 0===t||t.gameplayStart()}),S(gg,"gamePlayStop",function(){var t;null===(t=cg.sdk)||void 0===t||t.gameplayStop()}),S(gg,"gameReady",function(){cg.adapter.gameReady()}),S(gg,"checkAvailableFlags",function(){var t=cg.adapter.options.flags;t&&Object.keys(t).length>0?Ol.log(Cl.SDK,"SDK flags are available:",t):(cg.adapter.options.flags=fl,console.log("  flags ".concat(t,"  ,  "),cg.adapter.options.flags))}),S(gg,"getPlayerId",function(){var t;return(null===(t=cg.sdk)||void 0===t||null===(t=t.player)||void 0===t?void 0:t.getId())||null}),S(gg,"getLocalStorage",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,cg.adapter.storage.getLocalStorage();case 1:return t.abrupt("return",t.sent);case 2:case"end":return t.stop()}},t)}))),S(gg,"getStorage",Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object.keys(mg),t.next=1,cg.adapter.storage.get(e);case 1:return t.abrupt("return",t.sent);case 2:case"end":return t.stop()}},t)}))),S(gg,"showInterstitial",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.onOpen,n=t.onClosed,r=t.onFinally,i=t.onError;return new Promise(function(t){var s=Gf.soundManager;s.pauseAll(),e&&e(),cg.adapter.advertising.showInterstitial().then(function(){n&&n()}).catch(function(t){console.error("[showInterstitial]",t),i&&i()}).finally(function(){s.unPauseAll(),s.unmute(),r&&r(),t()})})}),S(gg,"showRewarded",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.onOpen,n=t.onRewarded,r=t.onFinally,i=t.onError,s=Gf.soundManager;s.pauseAll(),e&&e(),cg.adapter.advertising.showRewarded().then(function(){n&&n()}).catch(function(t){i&&i()}).finally(function(){s.unPauseAll(),s.unmute(),r&&r()})}),S(gg,"showBanner",function(){var t;"vk"===(null===(t=cg.flags)||void 0===t||null===(t=t.platform)||void 0===t?void 0:t.id)&&cg.adapter.advertising.showBanner()}),S(gg,"getLang",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,cg.adapter.getLang();case 1:return t.abrupt("return",t.sent);case 2:case"end":return t.stop()}},t)}))),S(gg,"getServerTime",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,cg.adapter.getServerTime();case 1:return t.abrupt("return",t.sent);case 2:case"end":return t.stop()}},t)}))),S(gg,"getPlatformId",function(){var t,e=null===(t=cg.sdk)||void 0===t?void 0:t.getPlatformId();return Ol.log("","platformId: ".concat(e)),e}),r(4782);var vg,yg=function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,s=t.w,o=void 0===s?0:s,a=t.h,l=void 0===a?0:a,c=t.r,h=void 0===c?0:c,u=t.color,d=void 0===u?16773939:u,p=t.alpha,f=void 0===p?1:p,m=t.center,g=void 0!==m&&m,v=new Vo;return v.beginFill(d),v.drawRoundedRect(n,i,o,l,h),v.endFill(),v.alpha=f,g&&v.position.set(-v.width/2+n,-v.height/2+i),v},xg=function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,s=t.w,o=void 0===s?0:s,a=t.h,l=void 0===a?0:a,c=t.lineWidth,h=void 0===c?2:c,u=t.color,d=void 0===u?16711680:u,p=t.alpha,f=void 0===p?1:p,m=t.center,g=void 0!==m&&m,v=new Vo;return v.lineStyle(h,d,f),v.drawRect(n,i,o,l),g&&v.position.set(-v.width/2+n,-v.height/2+i),v},wg=function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,s=t.r,o=void 0===s?50:s,a=t.color,l=void 0===a?16773939:a,c=t.alpha,h=void 0===c?1:c,u=new Vo;return u.beginFill(l),u.drawCircle(n,i,o/2),u.endFill(),u.alpha=h,u},_g=w(function t(){g(this,t)},null,[{key:"hasWord",value:function(t,e){return new RegExp(e,"i").test(t)}},{key:"createSprite",value:function(t){var e=Ds.get(t);if(!e){console.error("Texture '".concat(t,"' not found"));var n=new ki(Kn.WHITE);return n.width=10,n.height=10,n}return new ki(e)}},{key:"isCrazyGames",get:function(){var t,e=gg.getPlatformId(),n=null===(t=gg.flags)||void 0===t||null===(t=t.platform)||void 0===t?void 0:t.platformNames;if(n)return n[e]===(null==n?void 0:n.crazy_games)}},{key:"checkPixelPerfect",value:function(t,e){var n=e.sprite,r=t.data.getLocalPosition(n),i=Math.round(r.x),s=Math.round(r.y),o=yg({x:i-5,y:s-5,w:10,h:10});n.addChild(o)}}]);vg=_g,S(_g,"removeTexturesFromCache",function(t){for(var e in t)ue[e]&&(ue[e].destroy(!0),delete ue[e]),de[e]&&(de[e].destroy(!0),delete de[e])}),S(_g,"createSpriteSheet",function(){var t=Kl(Jl().mark(function t(e,n){var r,i=arguments;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i.length>2&&void 0!==i[2]&&i[2]&&vg.removeTexturesFromCache(n.frames),r=new La(e,n),t.next=1,r.parse();case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),S(_g,"destroySpriteSheet",function(t){for(var e=0,n=Object.keys(t.frames);e<n.length;e++){var r=n[e];delete ue[r],delete de[r]}}),S(_g,"isStringTrue",function(t){return!0===t||"true"===t}),S(_g,"extractSuffix",function(t){var e=t.match(/_(.+)$/);return e?e[1]:null}),S(_g,"checkWebp",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"jpg";return"undefined"==typeof document?t:0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")?"webp":t}),S(_g,"detectLevelType",function(t){var e=vg.extractSuffix(t),n=S(S(S({},ul,{isEnabled:vg.isStringTrue(gg.adapter.options.flags.useHudShadow)}),dl,{isEnabled:vg.isStringTrue(gg.adapter.options.flags.useHudWords)}),pl,{isEnabled:vg.isStringTrue(gg.adapter.options.flags.useLevelTypeGeneration)})[e];return n?{leveTypeName:e,isEnabled:n.isEnabled}:Promise.resolve(!1)}),S(_g,"showError",function(t){vg.purchaseError=new ig(window.game.refs.purchaseErrorView),vg.purchaseError.show(),console.error("[onPurchase]:",t)}),S(_g,"shouldSkipPrerollOnFirstLevel",function(t){var e;return(null===(e=gg.flags)||void 0===e||null===(e=e.platform)||void 0===e?void 0:e.noPreroll)&&0===t}),S(_g,"maybeShowAd",function(t,e){var n,r,i=new Promise(function(t){r=t});return"vk"===(null===(n=gg.flags)||void 0===n||null===(n=n.platform)||void 0===n?void 0:n.id)?(Ol.log(Cl.LevelPreload,"[flag vk], blocking showAd"),r(!0),i):vg.shouldSkipPrerollOnFirstLevel(e)?(console.warn(" ,   !"),r(!0),i):t.playerData.hasAdPass?(r(!0),i):(gg.showInterstitial({onFinally:function(){return r(!0)}}),i)}),S(_g,"createBtn",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.textureKey,n=t.name,r=t.interactive,i=void 0===r||r,s=t.position,o=void 0===s?{x:0,y:0}:s,a=t.anchor,l=void 0===a?{x:.5,y:.5}:a,c=new ki(Kn.from(e));return c.anchor.set(l.x,l.y),c.name=void 0===n?e:n,i&&(c.cursor="pointer",c.eventMode="static"),c.position.copyFrom(o),c}),S(_g,"createBtnContainer",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.textureKey,n=t.name,r=t.interactive,i=void 0===r||r,s=t.position,o=void 0===s?{x:0,y:0}:s,a=t.anchor,l=void 0===a?{x:.5,y:.5}:a,c=new ki(Kn.from(e));c.anchor.set(l.x,l.y);var h=new Ti;return h.addChild(c),h.name=void 0===n?e:n,h.position.copyFrom(o),i&&(h.cursor="pointer",h.eventMode="static"),h}),S(_g,"showTextPreloadAttempts",function(){var t=Kl(Jl().mark(function t(e,n,r){var i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=2500*n,!(n>=r)){t.next=2;break}return e&&(e.text="Download error. \n reloading..."),console.error("Download error. \n reloading..."),t.next=1,new Promise(function(){setTimeout(function(){return location.reload()},1e3)});case 1:return t.abrupt("return",t.sent);case 2:if(e&&(e.text="Download error. \nAttempt ".concat(n+1," out of ").concat(r)),console.error("Download error. \nAttempt ".concat(n+1," out of ").concat(r)),!(n<r)){t.next=3;break}return t.next=3,new Promise(function(t){return setTimeout(t,i)});case 3:case"end":return t.stop()}},t)}));return function(e,n,r){return t.apply(this,arguments)}}());var bg=function(t){var e=Object.keys(t).map(function(e){return t[e].resize?Promise.resolve(t[e].resize()):Promise.resolve()});return Promise.all(e)},Ag=function(t){return new Promise(function(e){navigator.onLine?e():(t.text=" ...",t.text=Uc.t("noInternet"),Ol.warn("","  ..."),window.addEventListener("online",e,{once:!0}))})},Tg=function(t){var e=Math.floor(t/1e3),n=Math.floor(e/60),r=e%60;return{minutes:String(n).padStart(2,"0"),seconds:String(r).padStart(2,"0")}};function Sg(){var t={},e={x:ol.HALF_W,y:ol.HALF_H,anchor:{x:.5,y:.5},style:{fontSize:50,fill:16777215,fontFamily:"NotoSerif",align:"center"}},n=yg({w:ol.WIDTH,h:ol.HEIGHT,color:0});return Xc(Ti,{width:ol.WIDTH,height:ol.HEIGHT,refs:t,resize:function(){return bg(t)},sortableChildren:!0},n,Xc(ma,{text:Uc.t("textLoading")+"...",ref:function(e){return t.preloadText=e},classes:e}))}var Eg=function(){var t=ml.remote;return{bundles:[{name:"gameScreen",assets:[{alias:"startScreen",src:"".concat(t,"assets/images/game/startScreen.webp")},{alias:"NotoSerif",src:"".concat(t,"assets/fonts/NotoSerif/NotoSerif.woff2")}]},{name:"fonts",assets:[{alias:"Pacifico",src:"".concat(t,"assets/fonts/Pacifico/Pacifico.woff2")}]},{name:"gameLogoSpecial",assets:[{alias:"gameLogoSpecial",src:"".concat(t,"assets/images/game/game-logo.png")}]}]}};function kg(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Mg(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var Cg,Pg=new WeakMap,Ig=new WeakMap,Rg=new WeakMap,Og=w(function t(){var e=this;return g(this,t),kg(this,Pg,18e4),kg(this,Ig,function(){Ol.log(Cl.Metrika,"GameTimeTrackerCounter start"),setInterval(Mg(Rg,e),Mg(Pg,e))}),kg(this,Rg,function(){ag.gameTimeTracker()}),"object"===v(t.instance)?t.instance:(Mg(Ig,this).call(this),t.instance=this)}),Dg="firstClick",Lg="gameResize",Fg="isDebug",Bg="hit",Ng="missClick",Wg="usedHint",Ug="completePartLevel",jg="completeLevel",Hg="completeLevelWin",zg="clearLevel",Gg="updateTargets",Xg="allItemsFound",Vg="lvCounterStat",Yg="paymentManager:hasNoAdsPass",$g="paymentManager:giveFreeHints",qg="options:muteSFX",Kg="options:unmuteSFX",Zg="options:muteMusic",Qg="options:unmuteMusic",Jg="timer:timerTick",tv="timer:kill",ev="storage:hintsUpdated",nv="payment:completeLevel",rv="store:hide",iv="promoCardBue",sv="hidePromoCard",ov=["en","ru"],av=w(function t(){g(this,t)},null,[{key:"validate",value:function(t){var e=(t||"").toLowerCase();return ov.includes(e)?e:(console.error("","locale ".concat(e," is not supported, return en")),"en")}}]);function lv(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,s,o,a=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return a}}(t,e)||zc(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Cg=av,S(av,"locale",void 0),S(av,"init",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Cg.initializeI18n();case 1:case"end":return t.stop()}},t)}))),S(av,"initializeI18n",Kl(Jl().mark(function t(){var e,n,r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,gg.getLang();case 1:return e=t.sent,n=Cg.validate(e),Cg.locale=n,r=Gf.gameConfig,t.next=2,r.locales;case 2:return i=t.sent,t.next=3,Uc.init({lng:n,resources:{en:{translation:i.en},ru:{translation:i.ru}}});case 3:case"end":return t.stop()}},t)}))),r(2892),r(5506),r(2008),r(3921),r(4520),r(7550);var cv,hv=w(function t(){return g(this,t),S(this,"skipLevel",function(t){var e=_v.getGameLevelData(t).levelType;if(console.warn("levelType:",e),!e)return Promise.resolve(!1);var n=S(S(S({},ul,{flagName:gg.adapter.options.flags.useHudShadow,offMessage:"   "}),dl,{flagName:gg.adapter.options.flags.useHudWords,offMessage:"   "}),pl,{flagName:gg.adapter.options.flags.useLevelTypeGeneration,offMessage:"   "})[e];if(!n)return Promise.resolve(!1);var r=_g.isStringTrue(n.flagName);return console.log(e,r),r?Promise.resolve(!0):(console.log(" "),console.log(n.offMessage),Promise.resolve(!1))}),"object"===v(t.instance)||(t.instance=this),t.instance},null,[{key:"levelAdDelay",get:function(){return+gg.adapter.options.flags.levelAdDelay}}]);function uv(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function dv(t,e){return t.get(pv(t,e))}function pv(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}S(hv,"getTimerRewardDuration",function(){return+gg.adapter.options.flags.useTimerRewardDuration}),S(hv,"getFilteredLevels",function(){var t=S(S(S({},ul,gg.adapter.options.flags.useHudShadow),dl,gg.adapter.options.flags.useHudWords),pl,gg.adapter.options.flags.useLevelTypeGeneration),e=Object.entries(t).filter(function(t){var e=lv(t,2)[1];return!_g.isStringTrue(e)}).map(function(t){return lv(t,1)[0].toLowerCase()}),n=Gf.gameConfig.levels;return Object.fromEntries(Object.entries(n).filter(function(t){var n=lv(t,2)[1].spineName;return!e.some(function(t){return n.toLowerCase().includes(t)})}))});var fv={hogItems:"hogItems",hogItems1:"hogItems2"},mv=new WeakMap,gv=new WeakMap,vv=new WeakMap,yv=new WeakMap,xv=new WeakMap,wv=new WeakMap,_v=w(function t(){var e=this;g(this,t),uv(this,mv,Gf.storage),uv(this,gv,5),uv(this,vv,null),S(this,"getConfig",function(){var n=dv(mv,e).playerData,r=n.levelIndex,i=n.skinIndex,s=t.getGameLevelData(r),o=s.spineName,a=s.amb,l=s.backgroundName,c=dv(yv,e).call(e,i);return function(t,e,n){t.set(pv(t,e),n)}(vv,e,{spineName:o,bgTexture:l,levelParts:Object.values(fv),hogItemsBone:null,currentSkinName:"mode1/skin_mode1_v".concat(c),amb:a}),dv(wv,e).call(e,a),dv(vv,e)}),uv(this,yv,function(t){return 0===t?1:t>5?5:t<0?1:t}),S(this,"updateSavedLevel",function(){var t=dv(mv,e).playerData.levelIndex;dv(mv,e).playerData.levelIndex=t+1,dv(xv,e).call(e),dv(mv,e).save()}),uv(this,xv,function(){dv(mv,e).playerData.levelIndex>t.maxLevels&&(Ol.log(Cl.Config,"   ,   level"),dv(mv,e).playerData.skinIndex++,dv(mv,e).playerData.partIndex++,dv(mv,e).playerData.skinIndex>dv(gv,e)&&(Ol.log(Cl.Config,"   ,  "),dv(mv,e).playerData.skinIndex=1,ag.completeGame()),dv(mv,e).playerData.levelIndex=0)}),uv(this,wv,function(n){var r,i=dv(mv,e).playerData,s=i.levelIndex,o=i.skinIndex,a=i.partIndex;Ol.log(Cl.Config,"level in levels: ".concat(s,"\n      spineName: ").concat(null===(r=dv(vv,e))||void 0===r?void 0:r.spineName,"\n      levelIndex ").concat(s," / ").concat(t.maxLevels,"\n      skinIndex: ").concat(o," / ").concat(dv(gv,e),"\n      partIndex: ").concat(a,"\n      amb: ").concat(n,"\n    ")),ag.startLevel(dv(vv,e),dv(mv,e))})},null,[{key:"maxLevels",get:function(){var t=hv.getFilteredLevels();return Object.keys(t).length-1}}]);function bv(t,e,n){Av(t,e),e.set(t,n)}function Av(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tv(t,e){return t.get(Ev(t,e))}function Sv(t,e,n){return t.set(Ev(t,e),n),n}function Ev(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}cv=_v,S(_v,"levelJsonNumber",null),S(_v,"getLevelNumber",function(t){var e=t.match(/level(\d+)/);return e?Number(e[1]):null}),S(_v,"getGameLevelData",function(t){var e=Gf.storage;t>cv.maxLevels&&(e.playerData.levelIndex=cv.maxLevels,t=cv.maxLevels);var n=hv.getFilteredLevels(),r=Object.entries(n)[t][1],i=r.spineName,s=r.amb,o=cv.getLevelNumber(i);cv.levelJsonNumber=o;var a="back_lv".concat(o),l="hudData-".concat(o),c=ml.local;return r.isRemote&&(c=ml.remote),{hybridPath:c,amb:s,levelData:r,levelJsonNumber:o,backgroundName:a,background:{alias:a,src:"".concat(c,"assets/images/backgrounds/").concat(a,".webp")},spineName:i,levelType:_g.extractSuffix(i),levelAtlas:"".concat(c,"assets/gameLevels/").concat(i,".atlas"),levelJson:"".concat(c,"assets/gameLevels/").concat(i,".json"),levelSpriteSheet:{alias:"".concat(i),src:"".concat(c,"assets/gameLevels/").concat(i,".webp")},hudDataName:l,hudJson:"".concat(c,"assets/hud/").concat(l,".json"),hudSpriteSheet:{alias:l,src:"".concat(c,"assets/hud/").concat(l,".png")}}}),S(_v,"getSpeechAndTextData",function(t,e){var n=e.playerData.skinIndex,r=cv.levelJsonNumber,i=n%2?0:1;try{var s=Gf.gameConfig.storyText;return{introText:s["lv".concat(r)].intro.text[i],outroText:s["lv".concat(r)].outro.text[i],introSpeech:s["lv".concat(r)].intro.speech[i],outroSpeech:s["lv".concat(r)].outro.speech[i]}}catch(t){return console.error("[getSpeechAndTextData]",t),{}}});var kv=new WeakMap,Mv=new WeakMap,Cv=new WeakMap,Pv=new WeakMap,Iv=new WeakMap,Rv=new WeakMap,Ov=new WeakMap,Dv=new WeakSet,Lv=new WeakMap,Fv=new WeakMap,Bv=new WeakMap,Nv=new WeakMap,Wv=new WeakMap,Uv=new WeakMap,jv=new WeakMap,Hv=w(function t(e,n){var r=this;g(this,t),function(t,e){Av(t,e),e.add(t)}(this,Dv),bv(this,kv,{}),bv(this,Mv,void 0),bv(this,Cv,void 0),bv(this,Pv,void 0),bv(this,Iv,void 0),bv(this,Rv,void 0),bv(this,Ov,function(){var t=Tv(Iv,r).playerData,e=_v.maxLevels;return{checkboxes:[{key:"option_isDebug",label:"option_isDebug:",value:t.option_isDebug,tooltip:" "},{key:"isTutorial_shadows",label:" shadows:",value:t.isTutorial_shadows,tooltip:"  -   "},{key:"isTutorial_words",label:" words:",value:t.isTutorial_words,tooltip:"  -   "},{key:"isTutorial_generator",label:" extreme:",value:t.isTutorial_generator,tooltip:"  -   "},{key:"hasAdPass",label:" NoAds:",value:t.hasAdPass,tooltip:"   -   "}],selects:[{key:"levelIndex",label:"level",max:e,value:t.levelIndex,tooltip:" "},{key:"skinIndex",label:"skin(part)",min:1,max:5,value:t.skinIndex,tooltip:"     ,    1 , "},{key:"partIndex",label:"partIndex",min:1,max:9999,value:t.partIndex,tooltip:"     ,       , "},{key:"userLevel",label:"userLevel",min:1,max:9999,value:t.userLevel,tooltip:"  , "},{key:"hints",label:"hints",max:100,value:t.hints,tooltip:"- "}]}}),bv(this,Lv,function(){var t=document.createElement("div");t.className="admin-panel__bg",t.innerHTML='<div class="admin-panel__window"></div>',document.body.append(t),Sv(Cv,r,t),Sv(Pv,r,t.querySelector(".admin-panel__window")),Tv(Fv,r).call(r)}),bv(this,Fv,function(){var t=document.createElement("button");t.className="admin-panel__close",t.innerHTML="&times;",t.addEventListener("click",function(){return r.destroy()}),document.querySelector(".admin-panel__window").append(t)}),S(this,"renderComponents",function(){Ev(Dv,r,Gv).call(r,Tv(Pv,r)),Ev(Dv,r,Xv).call(r,Tv(Pv,r)),Ev(Dv,r,Yv).call(r,Tv(Pv,r))}),bv(this,Bv,function(t){var e=t.target.dataset.key;Tv(kv,r)[e]=!!t.target.checked}),bv(this,Nv,function(t){var e=t.target.dataset.key;Tv(kv,r)[e]=Number(t.target.value)}),bv(this,Wv,function(){var t={};Tv(Mv,r).checkboxes.forEach(function(e){t[e.key]=Tv(kv,r)[e.key]}),Tv(Mv,r).selects.forEach(function(e){t[e.key]=Tv(kv,r)[e.key]}),Tv(Uv,r).call(r,t)}),bv(this,Uv,function(t){var e=t.hints,n=t.option_isDebug,i=t.isTutorial_shadows,s=t.isTutorial_words,o=t.isTutorial_generator,a=t.hasAdPass,l=t.levelIndex,c=t.skinIndex,h=t.partIndex,u=t.userLevel,d=Tv(Iv,r).playerData;d.option_isDebug=n,d.hasAdPass=a,d.hints=e,d.levelIndex=l,d.skinIndex=c,d.partIndex=h,d.userLevel=u,d.isTutorial_shadows=i,d.isTutorial_words=s,d.isTutorial_generator=o,r.destroy(),Tv(Iv,r).save(),Gf.game.app.stage.visible=!1,setTimeout(function(){return location.reload()},1e3),console.log("saved")}),bv(this,jv,function(){console.warn("HardReset!"),Tv(Iv,r).resetAllData(),r.destroy()}),S(this,"destroy",function(){var t;console.log("adminPanel destroy"),null===(t=Tv(Cv,r))||void 0===t||t.remove()}),Sv(Iv,this,e),Sv(Rv,this,n),Sv(Mv,this,Tv(Ov,this).call(this)),Ev(Dv,this,zv).call(this),Tv(Lv,this).call(this),this.renderComponents()});function zv(){var t=this;Tv(Mv,this).checkboxes.forEach(function(e){Tv(kv,t)[e.key]=e.value}),Tv(Mv,this).selects.forEach(function(e){Tv(kv,t)[e.key]=e.value})}function Gv(t){var e=this;Tv(Mv,this).checkboxes.forEach(function(n){var r=document.createElement("div");r.className="admin-panel__row",r.innerHTML='\n        <label for="cb_'.concat(n.key,'"').concat(n.tooltip?' title="'.concat(n.tooltip,'"'):"",">").concat(n.label,'</label>\n        <input id="cb_').concat(n.key,'" type="checkbox" ').concat(n.value?"checked":"",">\n      ");var i=r.querySelector("input");i.dataset.key=n.key,i.addEventListener("change",Tv(Bv,e)),t.appendChild(r)})}function Xv(t){var e=this,n=Object.values(Tv(Rv,this).levels);Tv(Mv,this).selects.forEach(function(r){var i,s=document.createElement("div");s.className="admin-panel__row";for(var o="",a=null!==(i=r.min)&&void 0!==i?i:0;a<=r.max;a++){var l=a;if("levelIndex"===r.key){var c=n[a];l="[".concat(a,"] spine ").concat(c.spineName)}o+='<option value="'.concat(a,'" ').concat(a===r.value?"selected":"",">").concat(l,"</option>")}s.innerHTML='\n        <label for="sel_'.concat(r.key,'"').concat(r.tooltip?' title="'.concat(r.tooltip,'"'):"",">").concat(r.label,'</label>\n        <select id="sel_').concat(r.key,'">').concat(o,"</select>\n      ");var h=s.querySelector("select");h.dataset.key=r.key,h.addEventListener("change",Tv(Nv,e)),t.appendChild(s)})}function Vv(t,e,n){var r=document.createElement("button");return r.className=e,r.innerText=t,r.addEventListener("click",n,{once:!0}),r}function Yv(t){var e=document.createElement("div");e.className="admin-panel__row";var n=Ev(Dv,this,Vv).call(this,"Save","admin-panel__btn admin-panel__btn--save",Tv(Wv,this)),r=Ev(Dv,this,Vv).call(this,"Hard Reset","admin-panel__btn admin-panel__btn--reset",Tv(jv,this));e.appendChild(n),e.appendChild(r),t.appendChild(e)}function $v(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function qv(t,e){return t.get(Zv(t,e))}function Kv(t,e,n){return t.set(Zv(t,e),n),n}function Zv(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qv,Jv=new WeakMap,ty=new WeakMap,ey=new WeakMap,ny=new WeakMap,ry=new WeakMap,iy=new WeakMap,sy=new WeakMap,oy=new WeakMap,ay=new WeakMap,ly=new WeakMap,cy=new WeakMap,hy=new WeakMap,uy=new WeakMap,dy=new WeakMap,py=new WeakMap,fy=new WeakMap,my=new WeakMap,gy=new WeakMap,vy=new WeakMap,yy=new WeakMap,xy=new WeakMap,wy=new WeakMap,_y=w(function t(e,n,r){var i=this;g(this,t),$v(this,Jv,void 0),$v(this,ty,void 0),$v(this,ey,void 0),$v(this,ny,[]),$v(this,ry,1e3),$v(this,iy,2e3),$v(this,sy,3),$v(this,oy,60),$v(this,ay,void 0),$v(this,ly,void 0),$v(this,cy,void 0),$v(this,hy,!1),$v(this,uy,!1),$v(this,dy,null),$v(this,py,function(){Kv(ly,i,qv(my,i).call(i,qv(ay,i),{x:0,y:ol.HEIGHT-qv(oy,i)})),qv(ly,i).on("pointerup",qv(gy,i)),Kv(cy,i,qv(my,i).call(i,qv(ay,i),{x:qv(Jv,i).uiRect.width-qv(oy,i),y:ol.HEIGHT-qv(oy,i)})),qv(cy,i).on("pointerup",qv(vy,i))}),$v(this,fy,function(){qv(cy,i).x=qv(Jv,i).uiRect.width-qv(oy,i)}),$v(this,my,function(t,e){var n=e.x,r=e.y,s=new Vo;return s.alpha=qv(ty,i).playerData.option_isDebug?1:0,s.beginFill(16749823),s.drawRect(0,0,qv(oy,i),qv(oy,i)),s.endFill(),s.eventMode="static",s.position.set(n,r),s.name="adminPanelButton",t.addChild(s),s}),$v(this,gy,function(){if(qv(Jv,i).stateName===ll)return qv(uy,i)?(clearTimeout(qv(dy,i)),qv(yy,i).call(i),void qv(wy,i).call(i)):void(qv(hy,i)||qv(xy,i).call(i,function(){Kv(hy,i,!0),clearTimeout(qv(dy,i)),Kv(dy,i,setTimeout(function(){qv(yy,i).call(i)},qv(iy,i)))}))}),$v(this,vy,function(){qv(hy,i)&&!qv(uy,i)&&qv(xy,i).call(i,function(){Kv(uy,i,!0),clearTimeout(qv(dy,i)),Kv(dy,i,setTimeout(function(){qv(yy,i).call(i)},qv(iy,i)))})}),$v(this,yy,function(){Kv(hy,i,!1),Kv(uy,i,!1),Kv(ny,i,[]),clearTimeout(qv(dy,i))}),$v(this,xy,function(t){var e=Date.now();qv(ny,i).push(e),qv(ny,i).length>qv(sy,i)&&qv(ny,i).shift(),qv(ny,i).length===qv(sy,i)&&qv(ny,i)[qv(sy,i)-1]-qv(ny,i)[0]<=qv(ry,i)*(qv(sy,i)-1)&&(t&&t(),Kv(ny,i,[]))}),$v(this,wy,function(){new Hv(qv(ty,i),qv(ey,i))}),Kv(Jv,this,e),Kv(ay,this,e.ui),Kv(ty,this,n),Kv(ey,this,r),qv(py,this).call(this),qv(Jv,this).on(Lg,qv(fy,this))}),by=w(function t(){g(this,t)});Qv=by,S(by,"loadJson",function(){var t=Kl(Jl().mark(function t(e){var n,r;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,fetch(e);case 1:return(n=t.sent).ok||console.error("  JSON: ".concat(n.status)),t.next=2,n.json();case 2:return t.abrupt("return",t.sent);case 3:return t.prev=3,r=t.catch(0),console.error("   JSON url: ".concat(e),r),t.abrupt("return",Promise.resolve(!1));case 4:case"end":return t.stop()}},t,null,[[0,3]])}));return function(e){return t.apply(this,arguments)}}()),S(by,"loadAtlas",function(){var t=Kl(Jl().mark(function t(e){var n,r;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,fetch(e);case 1:return(n=t.sent).ok||console.error("  .atlas: ".concat(n.status)),t.next=2,n.text();case 2:return t.abrupt("return",t.sent);case 3:return t.prev=3,r=t.catch(0),console.error("   ATLAS:",r),t.abrupt("return",Promise.resolve(!1));case 4:case"end":return t.stop()}},t,null,[[0,3]])}));return function(e){return t.apply(this,arguments)}}()),S(by,"loadTexture",function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,n){Kn.fromURL(e).then(function(e){t(e)}).catch(function(t){console.warn("Failed to load texture:",t),n(t)})}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),S(by,"loadSpriteSheet",function(){var t=Kl(Jl().mark(function t(e){var n,r,i,s,o,a,l,c,h,u;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.spriteSheetName,r=e.folderPath,i=void 0===r?"":r,s=e.exists,o=void 0===s?"png":s,l="".concat(a=ml.remote,"assets/").concat(i,"/").concat(n,".json"),c="".concat(a,"assets/").concat(i,"/").concat(n,".").concat(o),t.next=1,Qv.loadJson(l);case 1:return h=t.sent,t.next=2,Ds.load({alias:n,src:c});case 2:return t.next=3,Ds.get(n);case 3:return u=t.sent,t.next=4,_g.createSpriteSheet(u,h);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());var Ay={fontSize:30,fill:4909312,stroke:0,strokeThickness:2},Ty=function(){function t(){g(this,t)}return w(t,null,[{key:"showDebugInfo",value:function(e){var n=new ma("",Ay);n.position.set(10,800);var r=new ma("",Ay);r.position.set(10,838),e.viewport.ui.addChild(n,r),e.app.ticker.add(function(){n.text="FPS: ".concat(Math.round(e.app.ticker.FPS))}),setInterval(t.showMemoryData,1e3,r)}},{key:"showMemoryData",value:function(e){var n=t.calcTextureMemory(),r=n.texturesCount,i=n.totalMemory,s=Ds.cache._cache.size;e.text="Cache textures: ".concat(r,"\n")+"Cache total: ".concat(s,"\n")+"~GPU: ".concat(i," MB")}},{key:"calcRenderTextureStats",value:function(){var t=0,e=0;return Ds.cache._cache.forEach(function(n){var r;if(n instanceof Zn&&null!==(r=n.baseTexture)&&void 0!==r&&r.valid){var i=n.baseTexture.width*n.baseTexture.resolution,s=n.baseTexture.height*n.baseTexture.resolution;e+=i*s*4,t++}}),{renderTextureCount:t,renderTextureMemory:(e/1024/1024).toFixed(2)}}},{key:"calcTextureMemory",value:function(){var t,e=(S(S(S(S(S(S(S(S(S(S(t={},I.RGBA,"RGBA"),I.RGB,"RGB"),I.ALPHA,"ALPHA"),I.LUMINANCE_ALPHA,"LUMINANCE_ALPHA"),I.LUMINANCE,"LUMINANCE"),I.RED,"RED"),I.RED_INTEGER,"RED_INTEGER"),I.RG,"RG"),I.RG_INTEGER,"RG_INTEGER"),I.RGB_INTEGER,"RGB_INTEGER"),S(S(S(t,I.RGBA_INTEGER,"RGBA_INTEGER"),I.DEPTH_COMPONENT,"DEPTH_COMPONENT"),I.DEPTH_STENCIL,"DEPTH_STENCIL")),n=0,r=0,i=[];Ds.cache._cache.forEach(function(t,s){var o;if(t instanceof Re?o=t:t.baseTexture instanceof Re&&(o=t.baseTexture),o&&o.valid){var a=o.width*o.resolution,l=o.height*o.resolution,c=o.format||I.RGBA,h=e[c]||"UNKNOWN (".concat(c,")"),u=4;c===I.RGB?u=3:c===I.ALPHA?u=1:c===I.LUMINANCE_ALPHA&&(u=2);var d=a*l*u;n+=d,r++,i.push({key:s,width:a,height:l,format:h,sizeMB:+(d/1024/1024).toFixed(2)})}});var s=(n/1024/1024).toFixed(2);return{texturesCount:r,totalMemory:s}}}])}();function Sy(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Sy=function(){return!!t})()}function Ey(t,e,n,r){var i=Zl(b(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function ky(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function My(t,e){return t.get(Py(t,e))}function Cy(t,e,n){return t.set(Py(t,e),n),n}function Py(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}S(Ty,"sayHello",function(){new ci({hello:!0})}),window.getCache=Ds.cache._cache;var Iy=new WeakMap,Ry=new WeakMap,Oy=new WeakMap,Dy=new WeakMap,Ly=new WeakMap,Fy=new WeakMap,By=new WeakMap,Ny=new WeakMap,Wy=new WeakMap,Uy=new WeakMap,jy=new WeakMap,Hy=new WeakMap,zy=new WeakMap,Gy=function(t){function e(){var t;g(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=function(t,e,n){return e=b(e),_(t,Sy()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[].concat(r)),ky(t,Iy,void 0),ky(t,Ry,void 0),ky(t,Oy,void 0),ky(t,Dy,Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ds.init({manifest:Eg()});case 1:return t.next=2,Ds.loadBundle("gameScreen");case 2:if(null===(e=gg.flags)||void 0===e||null===(e=e.platform)||void 0===e||!e.noStore){t.next=3;break}return t.next=3,Ds.loadBundle("gameLogoSpecial");case 3:Ol.log(Cl.GamePreload,"gameScreen loaded");case 4:case"end":return t.stop()}},t)}))),ky(t,Ly,Kl(Jl().mark(function e(){return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,Gf.gameConfig.loadLocalesJson();case 1:return My(By,t).call(t,10),e.next=2,av.init();case 2:Gf.game.locale=av.locale;case 3:case"end":return e.stop()}},e)}))),ky(t,Fy,function(){Cy(Iy,t,new Sg(t.game)),t.game.viewport.addChild(My(Iy,t)),My(By,t).call(t,0),t.isInitialized=!0,Ol.log(Cl.GamePreload,"initView")}),ky(t,By,function(e){var n,r=null===(n=My(Iy,t))||void 0===n||null===(n=n.refs)||void 0===n?void 0:n.preloadText;if(My(Iy,t)&&r){var i=Uc.t("textLoading")||"",s=i?"".concat(i," ").concat(e,"%"):"";r.text="".concat(s),r.style.fontFamily="NotoSerif",Cy(Ry,t,r)}}),ky(t,Ny,Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,by.loadSpriteSheet({spriteSheetName:"startScreenUi",folderPath:"ui"});case 1:t.next=3;break;case 2:t.prev=2,e=t.catch(0),Ol.warn(Cl.GamePreload,e);case 3:case"end":return t.stop()}},t,null,[[0,2]])}))),ky(t,Wy,Kl(Jl().mark(function e(){return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,Gf.gameConfig.loadLevelsJson();case 1:return e.next=2,Gf.storage.load();case 2:My(jy,t).call(t);case 3:case"end":return e.stop()}},e)}))),ky(t,Uy,Kl(Jl().mark(function e(){return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.terminate(),!_g.isCrazyGames){e.next=1;break}return t.game.emit(hl),e.abrupt("return");case 1:t.game.emit(t.game.stateAfterPreload);case 2:case"end":return e.stop()}},e)}))),ky(t,jy,function(){var t;null!==(t=gg.flags)&&void 0!==t&&null!==(t=t.platform)&&void 0!==t&&t.noPreroll||Gf.storage.playerData.hasAdPass||gg.showInterstitial()}),ky(t,Hy,function(){My(zy,t).call(t),Ds.backgroundLoadBundle(["fonts"]),Gf.soundManager.preloadSFXFMain(),new Og,setTimeout(t.game.forceResize,1e3),Gf.storage.playerData.option_isDebug&&Ty.showDebugInfo(t.game,Gf.storage.playerData.version),new _y(t.game,Gf.storage,Gf.gameConfig)}),ky(t,zy,function(){var e=performance.now(),n=Math.trunc(e-My(Oy,t));Ol.log("","sdk + game loaded in ".concat(n," ms")),ag.loadDuration(n)}),t}return T(e,t),w(e,[{key:"initEventName",get:function(){return al}},{key:"initialize",value:(n=Kl(Jl().mark(function t(){var n,r,i,s;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:Ey(e,"initialize",this,3)([]),Cy(Oy,this,performance.now()),n=0,r=10,My(Fy,this).call(this);case 1:if(!(n<r)){t.next=12;break}return t.prev=2,t.next=3,gg.initSdk(Gf.adapter);case 3:return My(By,this).call(this,20),t.next=4,My(Ly,this).call(this);case 4:return Gf.soundManager.init(),My(By,this).call(this,40),t.next=5,My(Dy,this).call(this);case 5:return My(By,this).call(this,60),t.next=6,My(Wy,this).call(this);case 6:return gg.gameReady(),My(By,this).call(this,60),t.next=7,My(Ny,this).call(this);case 7:return My(By,this).call(this,100),t.next=8,My(Uy,this).call(this);case 8:return My(Hy,this).call(this),t.abrupt("continue",12);case 9:return t.prev=9,s=t.catch(2),n++,t.next=10,_g.showTextPreloadAttempts(My(Ry,this),n,r);case 10:if(!(n>=r)){t.next=11;break}return console.error("[MODULES.GamePreload] initialize error: ".concat(s)),ag.preloadError(null==og||null===(i=og.GAME_PRELOAD)||void 0===i?void 0:i.initialize,s),t.abrupt("continue",12);case 11:t.next=1;break;case 12:case"end":return t.stop()}},t,this,[[2,9]])})),function(){return n.apply(this,arguments)})},{key:"resize",value:function(){var t=Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,null===(e=My(Iy,this))||void 0===e?void 0:e.resize();case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"terminate",value:function(){this.game.emit(zg),My(Iy,this).destroy({children:!0}),this.game.uiInner.removeChildren(),Cy(Iy,this,null),this.isInitialized=!1}}]);var n}(jc),Xy=function(t){return new Proxy(t,{get:function(t,e,n){var r=function(t){var e=Object.keys(t),n=new RegExp(/\(.*\)/);return e.filter(function(t){return n.test(t)})}(t).filter(function(n){return!!t[n].hasOwnProperty(e)&&matchMedia(n).matches});return 0===r.length?t[e]:t[r[r.length-1]][e]}})},Vy=function(t,e){var n=t.uiInner,r=function(n){if(n.classes){if(!n.name)return void console.warn("".concat(n,"  !"));var i=e(t)[n.name];if(!i)return;n.classes=Xy(i)}n.children&&n.children.length>0&&n.children.forEach(r)};n.children.forEach(r)},Yy={fill:"#000000",fontFamily:"NotoSerif",fontWeight:"800"},$y=function(t){if(!t.stateName)return{};var e=t.uiRect,n={x:t.uiRect.width/2,y:t.uiRect.height/2},r=t.uiRect.width,i=t.refs.gameLogoSpecial||{};return t.stateName===ll?{optionsWheel:Xy({x:70,y:60,"(orientation: landscape)":{}}),userLevel:Xy({x:r-120,y:60,"(orientation: landscape)":{}}),btnContainer:Xy({x:n.x,y:395,"(orientation: landscape)":{}}),gameLogoSpecial:Xy({x:n.x,y:370,scale:{x:i.width>e.width?e.width/i.width:1,y:i.width>e.width?e.width/i.width:1},"(orientation: landscape)":{scale:{x:1,y:1}}})}:t.stateName===cl?{learningView:Xy({x:n.x,y:n.y,"(orientation: landscape)":{}}),optionsWheel:Xy({x:70,y:60,"(orientation: landscape)":{}}),foundItemsCounterView:Xy({x:70,y:206,"(orientation: landscape)":{}}),btnHint:Xy({type:"button",x:e.width-110,y:60,"(orientation: landscape)":{}}),introSpeechBubble:Xy({x:n.x,y:n.y,texture:"intro-text-bubble",anchor:{x:.5,y:.5},scale:{x:1.2,y:1.2},"(orientation: landscape)":{}})}:void 0},qy={fade:{texture:Kn.WHITE,width:ol.WIDTH+1,height:ol.HEIGHT,tint:0}};function Ky(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Zy(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ky(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ky(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}r(2675),r(3851),r(1278);var Qy=function(t){var e=t.typeTexture,n=t.texture,r=t.iconScale;return Xc(Ti,{cursor:"pointer",eventMode:"static"},Xc(ki,{texture:e,type:"button",anchor:{x:.5,y:.5}}),Xc(ki,{name:"icon",texture:n,anchor:{x:.5,y:.5},scale:{x:r,y:r}}))},Jy=function(t){var e=t.texture,n=void 0===e?"":e,r=t.iconScale;return Xc(Qy,{typeTexture:"btn-circle",texture:n,iconScale:void 0===r?1:r})},tx=function(t){var e=t.texture,n=void 0===e?"":e,r=t.iconScale;return Xc(Qy,{typeTexture:"btn-oval",texture:n,iconScale:void 0===r?1:r})},ex=function(t){var e,n=t.texture,r=void 0===n?"btn-bronze":n,i=t.text,s=void 0===i?"":i;return t.fontSize,e=t.textStyle||Zy(Zy({},Yy),{},{fill:16777215}),Xc(ki,{texture:r,type:"button",anchor:{x:.5,y:.5},cursor:"pointer",eventMode:"static"},Xc(ma,{name:"innerText",text:s,style:e,anchor:{x:.5,y:.5}}))},nx=function(t){var e,n=t.texture,r=void 0===n?"btn-bronze":n,i=t.text,s=void 0===i?"":i,o=(t.fontSize,t.setFilter),a=void 0===o?[]:o;return e=t.textStyle||Zy(Zy({},Yy),{},{fill:16777215}),Xc(Ti,{type:"button",cursor:"pointer",eventMode:"static",filters:[a]},Xc(ki,{texture:r,anchor:{x:.5,y:.5}}),Xc(ma,{name:"innerText",text:s,style:e,anchor:{x:.5,y:.5}}))},rx=function(t){var e=t.texture,n=t.scaleValue,r=void 0===n?1:n,i=t.text,s=t.style;return Xc(Ti,{name:"btnLater",type:"button",eventMode:"static",cursor:"pointer"},Xc(ki,{texture:e,scale:{x:r,y:r},anchor:{x:.5,y:.5}}),Xc(ma,{text:i,style:s,anchor:{x:.5,y:.5}}))},ix=function(t){var e=t.game,n=t.refs;return Xc(ki,{ref:function(t){return n.optionsWheel=t},name:"optionsWheel",texture:"icon-wheel",eventMode:"static",cursor:"pointer",type:"button",classes:$y(e).optionsWheel,anchor:{x:.5,y:.5},visible:!1})};function sx(){var t={},e={fade:{texture:Kn.WHITE,width:ol.WIDTH,height:ol.HEIGHT,tint:0,alpha:.5},optionPopUp:Xy({x:ol.HALF_W+20,y:ol.HALF_H,pivot:function(){return{x:t.optionPopUp.width/2,y:t.optionPopUp.height/2}},"(orientation: landscape)":{}}),iconClose:{x:426,y:2},btnMainSfx:{x:140,y:92},btnMainSound:{x:290,y:92},btnMainScreen:{x:140,y:212},btnMainLight:{x:290,y:212}},n=new Vo;return n.lineStyle(10,9142607,1),n.beginFill(16445894),n.drawRect(0,0,430,300),n.endFill(),Xc(Ti,{ref:function(e){return t.root=e},eventMode:"static",name:"optionView",zIndex:10,resize:function(){t.optionPopUp.classes=e.optionPopUp}},Xc(ki,{classes:e.fade,name:"fade",alpha:0}),Xc(Ti,{classes:e.optionPopUp,name:"optionPopUp",ref:function(e){return t.optionPopUp=e},eventMode:"static"},n,Xc(ex,{texture:"icon-close",name:"btnClose",classes:e.iconClose}),Xc(Jy,{type:"button",texture:"icon-home",name:"btnMainScreen",classes:e.btnMainScreen}),Xc(Jy,{type:"button",texture:"icon-music-off",name:"soundBtn",classes:e.btnMainSound}),Xc(Jy,{type:"button",texture:"icon-sfx-off",name:"sfxBtn",classes:e.btnMainSfx}),Xc(Jy,{type:"button",texture:"icon-light-off",name:"btnLight",classes:e.btnMainLight})))}function ox(){var t={},e={};return Xc(Ti,{ref:function(t){return e.root=t},style:t,classes:t,resize:function(){e.root.classes=e.root.style},refs:e})}function ax(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function lx(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ax(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ax(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var cx=function(t){var e=t.game,n=t.refs;return Xc(Ti,{ref:function(t){return n.userLevel=t},name:"userLevel",classes:$y(e).userLevel},Xc(ki,{texture:"user-level-frame",anchor:{x:.5,y:.5}}),Xc(ma,{name:"playerLevelText",anchor:{x:.5,y:.5},text:1,x:28,y:2,style:lx({},Yy)}))};function hx(t){var e,n=t.refs,r=t.game,i=null!==(e=gg.flags)&&void 0!==e&&null!==(e=e.platform)&&void 0!==e&&e.noStore?[{name:"btnStart",text:Uc.t("btnStart"),y:250,texture:"btn-bronze"}]:[{name:"btnStart",text:Uc.t("btnStart"),y:-7,texture:"btn-bronze"},{name:"btnStore",text:Uc.t("store"),y:132,icon:""},{name:"btnLeaderboard",text:Uc.t("Leaders"),y:264,icon:""}];return Xc(Ti,{ref:function(t){return n.startScreenView=t}},Xc(ox,{name:"btnContainer",ref:function(t){return n.btnContainer=t},style:$y(r).btnContainer},i.map(function(t){return function(t){var e=t.name,n=t.texture,r=void 0===n?"btn-gold":n,i=t.text,s=t.x,o=void 0===s?0:s,a=t.y,l=void 0===a?0:a,c=(t.icon,"btnStart"===e?1.1:1),h="btnStart"===e?48:36;return Xc(Ti,{name:e,typeName:"button",x:o,y:l,eventMode:"static",cursor:"pointer"},Xc(ki,{texture:r,anchor:{x:.5,y:.5},scale:{x:c,y:c}}),Xc(ma,{name:"btnText",text:i,style:lx(lx({},Yy),{},{fontSize:h}),anchor:{x:.5,y:.5}}))}(t)})))}function ux(t){var e=t.bodyColor,n=void 0===e?16445894:e,r=t.borderColor,i=void 0===r?9142607:r,s=t.size,o=void 0===s?{w:430,h:300}:s,a=t.fadeAlpha,l=void 0===a?.65:a,c={},h={modal:Xy({x:ol.HALF_W,y:ol.HALF_H,"(orientation: landscape)":{}}),btnClose:{x:o.w/2,y:-o.h/2,anchor:{x:.5,y:.5},cursor:"pointer",eventMode:"static"}},u=new Vo;return u.lineStyle(10,i,1),u.beginFill(n),u.drawRect(0,0,o.w,o.h),u.endFill(),u.pivot.set(o.w/2,o.h/2),Xc(Ti,{ref:function(t){return c.root=t},eventMode:"static",zIndex:10,visible:!1},Xc(ki,{texture:Kn.WHITE,name:"fade",tint:0,width:ol.WIDTH,height:ol.HEIGHT,alpha:l}),Xc(Ti,{name:"innerModal",classes:h.modal},u,Xc(ex,{texture:"icon-close",name:"btnClose",classes:h.btnClose})))}function dx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function px(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dx(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dx(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function fx(){var t={};return Xc(ux,{ref:function(e){return t.root=e},zIndex:11,size:{w:430,h:260},fadeAlpha:0},Xc(function(){return Xc(Ti,{name:"innerContainer"},Xc(ma,{name:"innerText",text:"".concat(Uc.t("purchaseError")),anchor:{x:.5,y:.5},style:px(px({},Yy),{},{fontSize:35,wordWrap:!0,wordWrapWidth:400,align:"center",fontFamily:"NotoSerif"})}))},null))}function mx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function gx(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mx(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mx(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function vx(){var t={};return Xc(ux,{ref:function(e){return t.root=e},fadeAlpha:0},[Xc(Ti,{name:"innerView"},Xc(ma,{text:"".concat(Uc.t("authorizationHeader")),y:-80,style:gx(gx({},Yy),{},{fontSize:36}),anchor:{x:.5,y:.5}}),Xc(ma,{text:"".concat(Uc.t("authorizationText1")),x:-190,y:-28,style:gx(gx({},Yy),{},{fontSize:22}),anchor:{x:0,y:.5}}),Xc(ma,{text:"".concat(Uc.t("authorizationText2")),x:-190,y:7,style:gx(gx({},Yy),{},{fontSize:22}),anchor:{x:0,y:.5}}),Xc(ex,{texture:"btn-bronze",text:"".concat(Uc.t("authorizationBtn")),textStyle:{fill:0,fontSize:40},y:85,x:0,scale:{x:.6,y:.6},name:"btnEnter"}))])}var yx={store:{free:{hints:3},smallPack:{hints:5},mediumPack:{hints:15},largePack:{hints:50},extraLargePack:{hints:100},noAdPack:{id:"noAdPack",hasAdPass:!0}},promo:{promoStartedPack:{id:"promoStartedPack"},promoRemoveAdPack:{id:"promoRemoveAdPack"},promoMegaHintsPack:{id:"promoMegaHintsPack"}},rateUsHints:5};function xx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function wx(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xx(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xx(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var _x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,s=t.w,o=void 0===s?420:s,a=t.h,l=void 0===a?466:a,c=t.center,h=t.text,u=void 0===h?"":h,d=t.beginFill,p=void 0===d?3019539:d,f=t.borderFill,m=void 0===f?9142607:f,g=new Vo;return g.beginFill(p),g.lineStyle(10,m,1),g.drawRect(n+5,i+5,o,l),g.endFill(),c&&g.position.set(-g.width/2+n+5,-g.height/2+i+5),Xc(Ti,null,g,Xc(ki,{texture:"frame-header",anchor:{x:.5,y:0},x:o/2+5,y:22}),Xc(ma,{x:o/2+5,y:54,text:u,anchor:{x:.5,y:.5},style:wx(wx({},Yy),{},{fontSize:36})}),Xc(ex,{x:o+5,y:4,name:"btnClose",texture:"icon-close"}))};function bx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ax(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bx(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bx(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Tx={free:{id:"free",textInCard:"x".concat(yx.store.free.hints),texture:"icon-loupe"},smallPack:{id:"smallPack",textInCard:"x".concat(yx.store.smallPack.hints),texture:"icon-loupe"},mediumPack:{id:"mediumPack",textInCard:"x".concat(yx.store.mediumPack.hints),texture:"icon-loupe"},largePack:{id:"largePack",textInCard:"x".concat(yx.store.largePack.hints),texture:"icon-loupe"},extraLargePack:{id:"extraLargePack",textInCard:"x".concat(yx.store.extraLargePack.hints),texture:"icon-loupe"},noAdPack:{id:"noAdPack",textInCard:"",texture:"icon-noAd"}},Sx={view:Xy({x:ol.HALF_W,y:ol.HALF_H-60,scale:{x:1.1,y:1.1},"(orientation: landscape)":{scale:{x:1.4,y:1.4}}}),getLocale:function(){return"ru"===window.game.locale?10:"en"===window.game.locale?18:void 0},btnPriceTextStyle:function(t){return{x:t===Tx.free.id?12:0,y:0,anchor:{x:.5,y:.5},style:Ax(Ax({},Yy),{},{fontSize:t===Tx.free.id?Sx.getLocale():18})}},iconCard:function(t){return t===Tx.noAdPack.id?{scale:{x:1,y:1},anchor:{x:.5,y:.5},y:-20}:{scale:{x:.6,y:.6},anchor:{x:.5,y:.5},y:-40}}},Ex=function(){var t=function(t){var e=Tx[t],n=e.texture,r=e.textInCard,i=t===Tx.free.id,s=t===Tx.free.id?Uc.t("free"):"";return Xc(Ti,{name:t,typeName:"card",eventMode:"static"},Xc(ki,{texture:"store-card",anchor:{x:.5,y:.5}},Xc(ki,{name:"cardPic",texture:n,classes:Sx.iconCard(t)})),Xc(ma,{name:"textTitle",text:r,y:10,anchor:{x:.5,y:.5},style:Ax(Ax({},Yy),{},{fontSize:28})}),Xc(ma,{name:"isBuy",text:"".concat(Uc.t("purchased")),y:38,anchor:{x:.5,y:.5},style:Ax(Ax({},Yy),{},{fontSize:18}),visible:!1}),Xc(Ti,{y:50,typeName:"button",name:"btnPrice",cursor:"pointer",eventMode:"static"},Xc(ki,{texture:"btn-bronze",scale:{x:.35,y:.35},anchor:{x:.5,y:.5}}),Xc(ma,{name:"priceText",text:s,classes:Sx.btnPriceTextStyle(t)}),Xc(ki,{texture:"icon-play",x:-32,name:"iconPlay",anchor:{x:.5,y:.5},visible:i,scale:{x:.5,y:.5}})))};return Xc(ox,{zIndex:10,style:Sx.view,pivot:{x:215,y:215},visible:!1},Xc(_x,{h:496,text:"".concat(Uc.t("store"))}),Xc(function(){return Xc(Ti,{x:215,y:123},Xc(ki,{texture:"icon-store-hint-counter",anchor:{x:.5,y:.5}}),Xc(ma,{name:"textStoreCounter",x:50,anchor:{x:1,y:.5},style:Ax(Ax({},Yy),{},{fontSize:25,fill:16774605})}))},null),Xc(Ti,{name:"cardsContainer",x:14,y:236},function(){for(var e=[],n=Object.keys(Tx),r=0;r<6;r++){var i=t(n[r]),s=r%3*128+14,o=166*Math.floor(r/3);i.position.set(59+s,o),e.push(i)}return e}()),Xc(ma,{name:"textLoading",text:"...",visible:!1,x:215,y:250,anchor:{x:.5,y:.5},style:{fill:16777215,fontSize:44,fontWeight:"800",fontFamily:"NotoSerif"}}))};function kx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Mx(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kx(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kx(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Cx={view:Xy({x:ol.HALF_W,y:ol.HALF_H-124,scale:{x:1.1,y:1.1},"(orientation: landscape)":{scale:{x:1.4,y:1.4}}})},Px=function(){var t=14277081;return Xc(Ti,{name:"gapRow",y:105,x:215,visible:!1,alpha:0},wg({x:-18,r:9,color:t}),wg({r:9,color:t}),wg({x:18,r:9,color:t}))},Ix=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.id,i=e.title,s=e.rank,o=e.score,a=void 0===o?0:o,l=e.y,c=void 0===l?0:l,h=i.length>18?"".concat(i.slice(0,20),"..."):i,u=wg({r:42,color:13421772});return u.name="mask",Xc(Ti,{id:n,name:"scoreRow",y:c,rank:s,score:a,isPlayer:!1},Xc(ma,{text:s,name:"rank",x:38,y:34,anchor:{x:.5,y:.5},style:Mx(Mx({},r.g),{},{fill:16777215,fontSize:16})}),Xc(Ti,{name:"avatarContainer",x:85,y:34},u),Xc(ma,{text:h,name:"userName",anchor:{x:0,y:.5},x:113,y:34,style:Mx(Mx({},Yy),{},{fill:16777215,fontSize:16})}),Xc(ma,{name:"score",text:a,x:386,style:Mx(Mx({},Yy),{},{fill:16577179,fontSize:20}),anchor:{x:1,y:.5},y:34}),Xc(ki,{texture:"icon-cup",x:390,y:34,anchor:{x:0,y:.5}}),((t=yg({x:10,y:68,w:410,h:2,color:16777215})).alpha=.4,t.name="borderBottom",t))},Rx=function(){return Xc(ox,{visible:!1,style:Cx.view,pivot:{x:215,y:233}},Xc(_x,{h:640,text:"".concat(Uc.t("Leaders"))}),Xc(Px,null),Xc(ma,{text:"".concat(Uc.t("textLoading"),"..."),name:"textLoading",anchor:{x:.5,y:.5},x:215,y:360,style:Mx(Mx({},Yy),{},{fill:16777215,fontSize:35,align:"center"})}),Xc(Ti,{name:"list",y:87,alpha:0}))},Ox=function(t){var e=t.refs;return Xc(ki,{ref:function(t){return e.telegram=t},name:"telegram",texture:"telegram",eventMode:"static",cursor:"pointer",type:"button",x:70,y:155,anchor:{x:.5,y:.5},visible:!0})},Dx=function(t){var e=t.game,n=t.refs;return Xc(ki,{texture:"gameLogoSpecial",name:"gameLogoSpecial",ref:function(t){return n.gameLogoSpecial=t},classes:$y(e).gameLogoSpecial,anchor:{x:.5,y:.5}})};function Lx(t){var e,n={};return t.uiInner.addChild(Xc(cx,{game:t,refs:n}),Xc(ix,{game:t,refs:n}),Xc(hx,{ref:function(t){return n.startScreenView=t},game:t,refs:n})),"yandex"===gg.getPlatformId()&&t.uiInner.addChild(Xc(Ox,{game:t,refs:n})),null!==(e=gg.flags)&&void 0!==e&&null!==(e=e.platform)&&void 0!==e&&e.noStore&&t.uiInner.addChild(Xc(Dx,{game:t,refs:n})),Xc(Ti,{refs:n,resize:function(){return bg(n)},sortableChildren:!0,name:"gameView"},Xc(function(){return Xc(Ti,{ref:function(t){return n.wrapper=t},name:"wrapper",sortableChildren:!0},Xc(ki,{texture:"startScreen"}),Xc(ki,{ref:function(t){return n.fade=t},name:"fade",visible:!1,classes:qy.fade}),Xc(Ex,{ref:function(t){return n.storeView=t},refs:n}),Xc(Rx,{ref:function(t){return n.scoreboardView=t}}))},null),Xc(fx,{ref:function(t){return n.purchaseErrorView=t}}),Xc(sx,{ref:function(t){return n.optionsView=t},visible:!1}),Xc(vx,{ref:function(t){return n.authorizationView=t},visible:!1}))}function Fx(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Bx(t,e,n){return t.set(Wx(t,e),n),n}function Nx(t,e){return t.get(Wx(t,e))}function Wx(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ux=new WeakMap,jx=new WeakMap,Hx=new WeakMap,zx=new WeakMap,Gx=new WeakMap,Xx=new WeakMap,Vx=new WeakMap,Yx=new WeakMap,$x=new WeakMap,qx=new WeakMap,Kx=new WeakMap,Zx=new WeakMap,Qx=new WeakMap,Jx=new WeakMap,tw=new WeakMap,ew=new WeakMap,nw=new WeakMap,rw=new WeakMap,iw=new WeakMap,sw=new WeakMap,ow=new WeakMap,aw=new WeakMap,lw=new WeakMap,cw=new WeakMap,hw=new WeakMap,uw=w(function t(e){var n=this;g(this,t),Fx(this,Ux,window.game),Fx(this,jx,Nx(Ux,this).refs),Fx(this,Hx,Gf.storage),Fx(this,zx,Nx(Hx,this).playerData),Fx(this,Gx,Nx(jx,this).optionsView),Fx(this,Xx,Nx(Gx,this).getChildByName("optionPopUp")),Fx(this,Vx,Nx(jx,this).optionsWheel),Fx(this,Yx,void 0),Fx(this,$x,void 0),Fx(this,qx,void 0),Fx(this,Kx,void 0),Fx(this,Zx,void 0),Fx(this,Qx,void 0),Fx(this,Jx,null),S(this,"viewIsShow",!1),S(this,"show",Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Nx(lw,n).call(n,!0,"+=90");case 1:return Nx(Ux,n).stateName===cl&&gg.gamePlayStop(),e={w:430,h:300},t.next=2,Ff.from(Nx($x,n),{x:e.w/2,y:e.h/2,alpha:0,ease:"back.inOut"});case 2:case"end":return t.stop()}},t)}))),S(this,"hide",Kl(Jl().mark(function t(){var e,r=arguments;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=!(r.length>0&&void 0!==r[0])||r[0],t.next=1,Nx(lw,n).call(n,!1,"-=90");case 1:Nx(Ux,n).stateName===cl&&e&&gg.gameplayStart();case 2:case"end":return t.stop()}},t)}))),Fx(this,tw,function(){n.hide(),Nx(aw,n).call(n,!1)}),Fx(this,ew,function(){Bx(Yx,n,Nx(Xx,n).getChildByName("btnClose")),Bx(qx,n,Nx(Xx,n).getChildByName("btnMainScreen")),Bx(Kx,n,Nx(Xx,n).getChildByName("soundBtn")),Bx(Zx,n,Nx(Xx,n).getChildByName("sfxBtn")),Bx(Qx,n,Nx(Xx,n).getChildByName("btnLight")),Bx($x,n,[Nx(qx,n),Nx(Kx,n),Nx(Zx,n),Nx(Qx,n)]),$m.initOverHandler([Nx(Vx,n),Nx(Yx,n)].concat(Gc(Nx($x,n))))}),Fx(this,nw,function(){Nx(iw,n).call(n),Nx(sw,n).call(n),Nx(ow,n).call(n)}),Fx(this,rw,function(t){return t.getChildByName("icon")}),Fx(this,iw,function(){Nx(zx,n).option_isPlayMusic||(Nx(rw,n).call(n,Nx(Kx,n)).texture=Kn.from("icon-music-off"),Nx(Ux,n).emit(Zg)),Nx(zx,n).option_isPlayMusic&&(Nx(rw,n).call(n,Nx(Kx,n)).texture=Kn.from("icon-music-on"),Nx(Ux,n).emit(Qg))}),Fx(this,sw,function(){Nx(zx,n).option_isPlaySFX||(Nx(rw,n).call(n,Nx(Zx,n)).texture=Kn.from("icon-sfx-off"),Nx(Ux,n).emit(qg)),Nx(zx,n).option_isPlaySFX&&(Nx(rw,n).call(n,Nx(Zx,n)).texture=Kn.from("icon-sfx-on"),Nx(Ux,n).emit(Kg))}),Fx(this,ow,function(){document.getElementById("canvas-wrapper").classList.toggle("icon-light-on",Nx(zx,n).option_isLight),Nx(zx,n).option_isLight||(Nx(rw,n).call(n,Nx(Qx,n)).texture=Kn.from("icon-light-off")),Nx(zx,n).option_isLight&&(Nx(rw,n).call(n,Nx(Qx,n)).texture=Kn.from("icon-light-on"))}),Fx(this,aw,function(t){var e=t?"on":"off",r=t?"addEventListener":"removeEventListener";Nx(Vx,n)[e]("pointerdown",n.onWheelHandler),Nx(Ux,n)[e](jg,Nx(tw,n)),document[r]("keydown",Nx(hw,n))}),Fx(this,lw,function(){var t=Kl(Jl().mark(function t(e,r){var i,s;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(i=Nx(Jx,n))||void 0===i||!i.isActive()){t.next=1;break}return t.abrupt("return");case 1:return s=Nx(Gx,n).getChildByName("fade",2),t.abrupt("return",Bx(Jx,n,Ff.timeline().set([Nx(Gx,n)],{visible:e}).set(Nx(Xx,n),{visible:!1}).to(Nx(Vx,n),{angle:r,duration:.2,ease:"linear"}).to(s,{alpha:e?.5:0,duration:.2},"<").set(Nx(jx,n).wrapper,{filters:e?[qy.blur]:[],duration:.2},"<").eventCallback("onComplete",function(){var t;n.viewIsShow=e,(t=Nx(Jx,n))&&(t.kill(),t.clear(),t=null),e&&Ff.timeline().set(Nx(Xx,n),{visible:!0}).fromTo(Nx(Xx,n),{alpha:0},{alpha:1,duration:.2,ease:"back.out(1.5)"});var r=e?"on":"off";Nx(Gx,n)[r]("pointerdown",Nx(cw,n))})));case 2:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),S(this,"onWheelHandler",function(){n.viewIsShow=!n.viewIsShow,Gf.soundManager.play("sfx_btnClick"),n.viewIsShow?n.show():n.hide()}),Fx(this,cw,function(t){var e=t.target;if(e.name===Nx(Gx,n).name&&n.viewIsShow&&n.hide(),e.name===Nx(qx,n).name){if(n.hide(!1),Nx(Ux,n).stateName===ll)return;Nx(Ux,n).stateName===cl&&n.state.checkoutState(ll)}e.name===Nx(Kx,n).name&&(Nx(Hx,n).gameSettings.toggleMusic(),Nx(iw,n).call(n)),e.name===Nx(Zx,n).name&&(Nx(Hx,n).gameSettings.toggleSFX(),Nx(sw,n).call(n)),e.name===Nx(Qx,n).name&&(Nx(Hx,n).gameSettings.toggleLightMode(),Nx(ow,n).call(n)),e.name===Nx(Yx,n).name&&n.hide(),e.name!==Nx(Xx,n).name&&Gf.soundManager.play("sfx_btnClick")}),Fx(this,hw,function(t){"escape"===t.key.toLowerCase()&&n.viewIsShow&&n.hide()}),this.state=e,Nx(ew,this).call(this),Nx(nw,this).call(this),Nx(aw,this).call(this,!0)}),dw="store",pw="scoreboard",fw="authorization",mw="rateUs",gw=new WeakMap,vw=w(function t(e){var n=this;g(this,t),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,gw,window.game),S(this,"view",void 0),S(this,"uiManager",void 0),this.uiManager=e;var r=this.constructor.viewName;this.view=function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(gw,this).refs[r],this.btnClose=this.view.getChildByName("btnClose",3),this.btnClose.on("pointerdown",function(){return n.uiManager.closeModule(n.constructor.moduleName)}),$m.initOverHandler(this.btnClose)},[{key:"show",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.view.visible=!0,this.btnClose.eventMode="none",t.next=1,Ff.timeline().fromTo(this.view,{alpha:0},{alpha:1,ease:"back.out(2.5)"},"<");case 1:this.view,this.btnClose.eventMode="static";case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"hide",value:function(){var t=Kl(Jl().mark(function t(){var e,n=arguments;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:this.btnClose,Gf.soundManager.play("sfx_btnClick"),this.view.interactiveChildren=!1,t.next=1,$m.click(e);case 1:return t.abrupt("return",Ff.timeline().to(this.view,{alpha:0,duration:.2,ease:"none"},"<").set(this.view,{visible:!1,interactiveChildren:!0}));case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),yw="btnFreeTimer",xw=new WeakSet,ww=w(function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.game,r=e.duration,i=e.log,s=void 0!==i&&i,o=e.label,a=void 0===o?"defaultTimer":o;g(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,xw),this.game=n,this.duration=Math.floor(r),this.log=s,this.label=a,this.remainingTime=this.duration,this.timerTween=null,this.game.on(jg,this.kill.bind(this)),this.game.on(zg,this.kill.bind(this))},[{key:"start",value:function(){var t=this,e=Math.ceil(this.remainingTime);this.timerTween=Ff.to(this,{remainingTime:0,duration:this.duration,ease:"none",onUpdate:function(){var n=Math.ceil(t.remainingTime);n!==e&&(e=n,function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(xw,t,_w).call(t,n))},onComplete:function(){t.kill()}})}},{key:"kill",value:function(){this.timerTween&&(Ol.log(Cl.DestroyMessage,"[Timer] ".concat(this.label," kill")),this.timerTween.kill(),this.timerTween=null,this.game.emit(tv,{label:this.label}))}}]);function _w(t){this.log&&console.log("[Timer] ".concat(this.label," tick"),t),this.game.emit(Jg,{label:this.label,currentTime:t,currentTimeWithZero:t>9?t:"0".concat(t)})}var bw=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16773393,e=new mm;return e.color=t,e.name="colorOverlay",e},Aw=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.brightness,n=void 0===e?.5:e,r=t.greyscale,i=void 0===r?.5:r,s=t.blackWhite,o=void 0!==s&&s,a=new Oi;return a.brightness(n,!1),a.greyscale(i,o),a.name="colorMatrix",a};function Tw(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Sw(t,e,n){return t.set(kw(t,e),n),n}function Ew(t,e){return t.get(kw(t,e))}function kw(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mw=new WeakMap,Cw=new WeakMap,Pw=new WeakMap,Iw=new WeakMap,Rw=new WeakMap,Ow=new WeakMap,Dw=new WeakMap,Lw=new WeakMap,Fw=new WeakMap,Bw=new WeakMap,Nw=new WeakMap,Ww=new WeakMap,Uw=new WeakMap,jw=new WeakMap,Hw=new WeakMap,zw=new WeakMap,Gw=new WeakMap,Xw=new WeakMap,Vw=w(function t(){var e=this;g(this,t),Tw(this,Mw,window.game),Tw(this,Cw,Gf.storage),Tw(this,Pw,!1),Tw(this,Iw,void 0),Tw(this,Rw,void 0),Tw(this,Ow,void 0),S(this,"btn",void 0),S(this,"timer",void 0),Tw(this,Dw,hv.getTimerRewardDuration()),S(this,"destroy",function(){var t;Ol.log(Cl.DestroyMessage,"[BtnTimer] destroy"),null===(t=e.timer)||void 0===t||t.kill(),e.btn&&e.btn.off("pointerup",Ew(zw,e)),Ew(Bw,e).call(e,!1)}),Tw(this,Lw,function(t){e.timer=new ww({game:Ew(Mw,e),duration:t,label:Ew(Iw,e)}),e.timer.start()}),Tw(this,Fw,function(t){if(t)return Sw(Pw,e,!0),e.btn.filters=[Aw()],void(e.btn.eventMode="none");Sw(Pw,e,!1),e.btn.filters=[],e.btn.eventMode="static"}),Tw(this,Bw,function(t){var n=t?"on":"off";Ew(Mw,e)[n](Jg,Ew(Nw,e)),Ew(Mw,e)[n](tv,Ew(Ww,e))}),Tw(this,Nw,function(t){var n=t.label,r=t.currentTimeWithZero;n===Ew(Iw,e)&&e.onTimerTick(r)}),Tw(this,Ww,function(t){t.label===Ew(Iw,e)&&(Ew(Fw,e).call(e,!1),e.onTimerEnd())}),Tw(this,Uw,Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,gg.getServerTime();case 1:return e=t.sent,t.abrupt("return",Math.floor(e/1e3));case 2:case"end":return t.stop()}},t)}))),S(this,"findServerTime",Kl(Jl().mark(function t(){var n,r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=Ew(Cw,e).playerData[Ew(Rw,e)])){t.next=2;break}return t.next=1,Ew(Uw,e).call(e);case 1:return r=t.sent,i=r-n,t.abrupt("return",Ew(Dw,e)-i);case 2:return t.abrupt("return",!1);case 3:case"end":return t.stop()}},t)}))),Tw(this,jw,Kl(Jl().mark(function t(){var n;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,e.findServerTime();case 1:if(!(n=t.sent)){t.next=2;break}return Ew(Lw,e).call(e,n),Ew(Fw,e).call(e,!0),t.abrupt("return",!0);case 2:return t.abrupt("return",!1);case 3:case"end":return t.stop()}},t)}))),Tw(this,Hw,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ew(Uw,e).call(e);case 1:Ew(Cw,e).playerData[Ew(Rw,e)]=t.sent,Ew(Cw,e).save();case 2:case"end":return t.stop()}},t)}))),Tw(this,zw,function(){Ew(Pw,e)||(Sw(Pw,e,!0),Sw(Ow,e,!1),gg.showRewarded({onRewarded:Ew(Gw,e),onFinally:Ew(Xw,e),onError:e.onError}))}),Tw(this,Gw,function(){Sw(Ow,e,!0),Ew(Cw,e).addHints(yx.store.free.hints),Ew(Lw,e).call(e,Ew(Dw,e)),Ew(Fw,e).call(e,!0),Ew(Hw,e).call(e),Ew(Mw,e).emit($g,Ew(Iw,e))}),Tw(this,Xw,function(){Ew(Ow,e)&&Gf.soundManager.play("sfx_store"),Sw(Pw,e,!1)})},[{key:"init",value:function(t,e,n){this.btn=t,this.btn.on("pointerup",Ew(zw,this)),Sw(Iw,this,e),Sw(Rw,this,n),Ew(Bw,this).call(this,!0),Ew(jw,this).call(this)}},{key:"onError",value:function(t){}},{key:"onTimerEnd",value:function(){}},{key:"onTimerTick",value:function(t){}}]);function Yw(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Yw=function(){return!!t})()}function $w(t,e,n,r){var i=Zl(b(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function qw(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Kw(t,e){return t.get(Qw(t,e))}function Zw(t,e,n){return t.set(Qw(t,e),n),n}function Qw(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jw=new WeakMap,t_=new WeakMap,e_=new WeakMap,n_=new WeakMap,r_=new WeakMap,i_=new WeakMap,s_=function(t){function e(){var t;return g(this,e),t=function(t,e){return e=b(e),_(t,Yw()?Reflect.construct(e,[],b(t).constructor):e.apply(t,void 0))}(this,e),qw(t,Jw,void 0),qw(t,t_,void 0),qw(t,e_,void 0),S(t,"btn",void 0),qw(t,n_,Kl(Jl().mark(function e(){var n;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.findServerTime();case 1:(n=e.sent)&&n>0&&Kw(i_,t).call(t,n);case 2:case"end":return e.stop()}},e)}))),qw(t,r_,function(){Zw(e_,t,t.btn.getChildByName("iconPlay")),Zw(Jw,t,t.btn.getChildByName("priceText"));var e=Kw(Jw,t);e.initText=e.text,e.initFontSize=e.style.fontSize,e.initPosX=e.x}),qw(t,i_,function(e){var n=Math.floor(e/60),r=e%60,i=String(n).padStart(2,"0"),s=String(r).padStart(2,"0");Kw(Jw,t).text="".concat(i," : ").concat(s),Kw(Jw,t).style.fontSize=18,Kw(Jw,t).x=10}),"object"===v(e.instance)||(e.instance=t),_(t,e.instance)}return T(e,t),w(e,[{key:"init",value:function(t,n){$w(e,"init",this,3)([t,yw,ug]),Zw(t_,this,n),Kw(r_,this).call(this),Kw(n_,this).call(this)}},{key:"onTimerTick",value:function(t){Kw(i_,this).call(this,t)}},{key:"onTimerEnd",value:function(){$w(e,"onTimerEnd",this,3)([]),Kw(Jw,this).text=Kw(Jw,this).initText,Kw(Jw,this).style.fontSize=Kw(Jw,this).initFontSize,Kw(Jw,this).x=Kw(Jw,this).initPosX,Kw(e_,this).visible=!0}},{key:"onError",value:function(t){_g.showError(t)}}])}(Vw);function o_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function a_(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o_(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o_(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function l_(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(l_=function(){return!!t})()}function c_(t,e,n,r){var i=Zl(b(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function h_(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function u_(t,e,n){return t.set(p_(t,e),n),n}function d_(t,e){return t.get(p_(t,e))}function p_(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var f_=new WeakMap,m_=new WeakMap,g_=new WeakMap,v_=new WeakMap,y_=new WeakMap,x_=new WeakMap,w_=new WeakMap,__=new WeakMap,b_=new WeakMap,A_=new WeakMap,T_=new WeakMap,S_=new WeakMap,E_=new WeakMap,k_=new WeakMap,M_=new WeakMap,C_=new WeakMap,P_=new WeakMap,I_=new WeakMap,R_=new WeakMap,O_=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,l_()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),h_(n,f_,window.game),h_(n,m_,d_(f_,n).refs),h_(n,g_,d_(m_,n).storeView),h_(n,v_,d_(g_,n).getChildByName("textStoreCounter",2)),h_(n,y_,d_(g_,n).getChildByName("cardsContainer",2)),h_(n,x_,d_(y_,n).children.map(function(t){return t.getChildByName("btnPrice")})),h_(n,w_,Gf.storage),h_(n,__,null),h_(n,b_,void 0),h_(n,A_,Gf.paymentManager),S(n,"btnFree",void 0),h_(n,T_,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return d_(S_,n).call(n,!0),d_(E_,n).call(n),d_(k_,n).call(n),d_(M_,n).call(n),d_(P_,n).call(n),t.next=1,d_(C_,n).call(n);case 1:d_(I_,n).call(n,!0);case 2:case"end":return t.stop()}},t)}))),h_(n,S_,function(t){var e=t?"on":"off";d_(f_,n)[e](ev,d_(P_,n)),d_(f_,n)[e](Yg,d_(k_,n))}),h_(n,E_,Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,gg.purchase.getCatalog();case 1:if((e=t.sent)&&(null==e||!e.length)){t.next=2;break}return t.abrupt("return");case 2:Object.values(e).forEach(function(t){var e,r=t.id,i=t.price,s=d_(y_,n).children.find(function(t){return t.name===r});if(s){var o=null==s?void 0:s.getChildByName("priceText",2),a=gg.purchase.getCurrency();if("vk"===(null===(e=gg.flags)||void 0===e||null===(e=e.platform)||void 0===e?void 0:e.id))return o.text="".concat(i," \n ").concat(a),void(o.style=a_(a_({},o.style),{},{fontSize:16,align:"center",lineHeight:14}));o.text="".concat(i," ").concat(a)}});case 3:case"end":return t.stop()}},t)}))),h_(n,k_,function(){if(d_(w_,n).playerData.hasAdPass){var t=d_(x_,n).find(function(t){return"noAdPack"===t.parent.name}),e=t.parent,r=e.getChildByName("isBuy");t.visible=!1,r.visible=!0,e.interactiveChildren=!1;var i=new Oi;i.brightness(.6,!0),i.greyscale(.6,!0),e.filters=[i]}}),h_(n,M_,function(){var t=d_(x_,n).find(function(t){return"free"===t.parent.name});d_(b_,n).init(t,n)}),h_(n,C_,function(){return Xm(d_(__,n),!0),u_(__,n,Ff.timeline().fromTo(d_(y_,n).children.map(function(t){return t.scale}),{x:0,y:0},{x:1,y:1,stagger:.13}))}),h_(n,P_,function(){d_(v_,n).text=d_(w_,n).playerData.hints}),h_(n,I_,function(t){var e=t?"on":"off",r=t?"static":"none";d_(y_,n).eventMode=r,d_(y_,n)[e]("pointerup",d_(R_,n))}),h_(n,R_,function(){var t=Kl(Jl().mark(function t(e){var r,i,s;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.target,i=r.parent,s=i.name,"button"===r.typeName&&"free"!==s){t.next=1;break}return t.abrupt("return");case 1:return t.next=2,d_(A_,n).onPurchase(s);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),$m.initOverHandler(d_(x_,n)),u_(b_,n,new s_(n)),n}return T(e,t),w(e,[{key:"show",value:function(){c_(e,"show",this,3)([]),d_(T_,this).call(this)}},{key:"hide",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,c_(e,"hide",this,3)([]);case 1:d_(b_,this).destroy(),d_(I_,this).call(this,!1),d_(S_,this).call(this,!1),Xm(d_(__,this),!0),d_(f_,this).emit(rv);case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}(vw);function D_(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(D_=function(){return!!t})()}function L_(t,e,n,r){var i=Zl(b(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function F_(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function B_(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}S(O_,"viewName","storeView"),S(O_,"moduleName",dw);var N_=new WeakMap,W_=new WeakMap,U_=new WeakMap,j_=new WeakMap,H_=new WeakMap,z_=new WeakMap,G_=new WeakMap,X_=new WeakMap,V_=new WeakMap,Y_=new WeakMap,$_=new WeakMap,q_=new WeakMap,K_=new WeakMap,Z_=new WeakMap,Q_=new WeakMap,J_=new WeakMap,tb=new WeakMap,eb=new WeakMap,nb=new WeakMap,rb=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,D_()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),F_(n,N_,window.game),F_(n,W_,B_(N_,n).refs),F_(n,U_,B_(W_,n).scoreboardView),F_(n,j_,B_(U_,n).getChildByName("gapRow")),F_(n,H_,B_(U_,n).getChildByName("list")),F_(n,z_,B_(U_,n).getChildByName("textLoading")),F_(n,G_,5),F_(n,X_,8),F_(n,V_,2),F_(n,Y_,Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,gg.leaderboard.getEntries(B_(X_,n),B_(V_,n));case 1:if(e=t.sent){t.next=2;break}return B_(z_,n).text=Uc.t("scoreBoard.networkError"),t.abrupt("return",Promise.resolve(e));case 2:if(0!==(null==e?void 0:e.length)){t.next=3;break}return B_(z_,n).text=Uc.t("scoreBoard.noPlayers"),t.abrupt("return",Promise.resolve(e));case 3:return B_(z_,n).text="".concat(Uc.t("textLoading"),"..."),t.abrupt("return",Promise.resolve(e));case 4:case"end":return t.stop()}},t)}))),F_(n,$_,function(t){console.log(t.length);var e=gg.sdk.player.getId(),n=t.find(function(t){return(null==t?void 0:t.id)===e});t.forEach(function(t){t.id,t.title;var e=t.rank;console.log("".concat(n.title,"  player.rank ").concat(n.rank," < ").concat(e," ").concat(n.rank<e)),n.rank<e&&console.warn("player   ")})}),F_(n,q_,function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,new Promise(function(t){Object.values(e).forEach(function(r,i){var s=r.title,o=r.id,a=r.avatar,l=r.rank,c=r.score,h=Ix({id:o,rank:l,title:s,score:c,y:68*i});B_(H_,n).addChild(h),B_(tb,n).call(n,h,a),B_(eb,n).call(n,i),B_(Q_,n).call(n,h,i),B_(K_,n).call(n,e),i===e.length-1&&t()})});case 1:B_(Z_,n).call(n),B_(J_,n).call(n,.5);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),F_(n,K_,function(t){t.length>B_(G_,n)&&(B_(j_,n).visible=!0),B_(j_,n).y=100+68*B_(G_,n)}),F_(n,Z_,function(){var t=gg.sdk.player.getId(),e=B_(H_,n).children.find(function(e){return(null==e?void 0:e.id)===t});if(e){var r=e.getChildByName("userName");e.isPlayer=!0,r.tint=65449}}),F_(n,Q_,function(t,e){7===e&&(t.getChildByName("borderBottom").visible=!1)}),F_(n,J_,function(){Ff.timeline().fromTo([B_(H_,n),B_(j_,n)],{alpha:0},{alpha:1,duration:.1,ease:"none"}).set(B_(z_,n),{visible:!1},"<")}),F_(n,tb,function(){var t=Kl(Jl().mark(function t(e,n){var r,i,s,o,a,l,c;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getChildByName("avatarContainer",1),i=r.getChildByName("mask",1),t.prev=1,t.next=2,Kn.fromURL(n);case 2:s=t.sent,(o=new ki(s)).scale.set(42/s.width),o.anchor.set(.5),r.addChild(o),o.mask=i,t.next=4;break;case 3:t.prev=3,c=t.catch(1),console.warn("[SDK createAvatar] URL: ".concat(n),c),a=Kn.from("avatar-user-default"),(l=new ki(a)).anchor.set(.5),r.addChild(l),l.mask=i;case 4:case"end":return t.stop()}},t,null,[[1,3]])}));return function(e,n){return t.apply(this,arguments)}}()),F_(n,eb,function(t,e){0===e&&B_(nb,n).call(n,t,"leader-medal1"),1===e&&B_(nb,n).call(n,t,"leader-medal2"),2===e&&B_(nb,n).call(n,t,"leader-medal3")}),F_(n,nb,function(t,e){var n=t.getChildByName("rank");n.visible=!1;var r=new ki(Kn.from(e));r.anchor.set(.5),r.position.set(n.x,n.y),t.addChild(r)}),n.uiManager=t,n}return T(e,t),w(e,[{key:"show",value:function(){var t=Kl(Jl().mark(function t(){var n;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return L_(e,"show",this,3)([]),B_(z_,this).visible=!0,t.next=1,B_(Y_,this).call(this);case 1:if(n=t.sent){t.next=2;break}return t.abrupt("return");case 2:B_(q_,this).call(this,n);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"hide",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,L_(e,"hide",this,3)([]);case 1:B_(H_,this).removeChildren(),B_(j_,this).visible=!1,B_(H_,this).alpha=0,B_(j_,this).alpha=0,B_(z_,this).visible=!1;case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}(vw);function ib(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ib=function(){return!!t})()}function sb(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function ob(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}S(rb,"viewName","scoreboardView"),S(rb,"moduleName",pw);var ab=new WeakMap,lb=new WeakMap,cb=new WeakMap,hb=new WeakMap,ub=new WeakMap,db=new WeakMap,pb=new WeakMap,fb=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,ib()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),sb(n,ab,window.game),sb(n,lb,ob(ab,n).refs),sb(n,cb,ob(lb,n).authorizationView),sb(n,hb,ob(cb,n).getChildByName("innerModal",1)),sb(n,ub,ob(cb,n).getChildByName("innerView")),sb(n,db,ob(ub,n).getChildByName("btnEnter")),sb(n,pb,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.uiManager.closeModule(e.moduleName),gg.player.auth().then(function(){console.log("[Authorization] The player is successfully logged in, page reload!"),location.reload()}).catch(function(){console.log("[Authorization] The player is not logged in!.")});case 1:case"end":return t.stop()}},t)}))),ob(hb,n).addChild(ob(ub,n)),n}return T(e,t),w(e,[{key:"show",value:function(){!function(t,e,n){var r=Zl(b(t.prototype),"show",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]),$m.initOverHandler(ob(db,this)),ob(db,this).once("pointerup",ob(pb,this))}}])}(vw);function mb(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function gb(t,e,n){return t.set(yb(t,e),n),n}function vb(t,e){return t.get(yb(t,e))}function yb(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}S(fb,"viewName","authorizationView"),S(fb,"moduleName",fw);var xb=new WeakMap,wb=new WeakMap,_b=new WeakMap,bb=new WeakMap,Ab=new WeakMap,Tb=new WeakMap,Sb=new WeakMap,Eb=new WeakMap,kb=new WeakMap,Mb=w(function t(e){var n=this;g(this,t),mb(this,xb,window.game),mb(this,wb,vb(xb,this).refs),mb(this,_b,void 0),mb(this,bb,void 0),mb(this,Ab,void 0),S(this,"getModule",function(t){return vb(Ab,n)[t]}),S(this,"showModule",function(t){gg.adapter.purchase.isAvailable()?(vb(Tb,n).call(n),vb(Eb,n).call(n),vb(Ab,n)[t].show(),document.addEventListener("keydown",vb(kb,n))):console.error("SdkManager.adapter.purchase.isAvailable() not found")}),S(this,"closeModule",function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return document.removeEventListener("keydown",vb(kb,n)),t.next=1,vb(Ab,n)[e].hide();case 1:vb(Sb,n).call(n);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),mb(this,Tb,function(){vb(_b,n).setInteractive(!1);var t=vb(xb,n).uiInner,e=vb(wb,n).fade;Ff.timeline().to(e,{alpha:.65,visible:!0}).to([vb(bb,n),t],{alpha:0,duration:.2,visible:!1},"<")}),mb(this,Sb,function(){var t=vb(xb,n).uiInner,e=vb(wb,n).fade;Ff.timeline().call(function(){return vb(_b,n).setInteractive(!0)}).to([vb(bb,n),t],{alpha:1,duration:.1,visible:!0}).to(e,{alpha:0,visible:!1},"<")}),mb(this,Eb,function(){Object.keys(vb(Ab,n)).forEach(function(t){vb(Ab,n)[t].visible=!1})}),mb(this,kb,function(t){if("Escape"===t.key)return Object.entries(vb(Ab,n)).find(function(t){var e=lv(t,2),r=e[0];e[1].view.visible&&n.closeModule(r)})}),gb(_b,this,e),gb(bb,this,vb(wb,this).startScreenView),gb(Ab,this,S(S(S({},dw,new O_(this)),pw,new rb(this)),fw,new fb(this)))});function Cb(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Pb(t,e,n){return t.set(Rb(t,e),n),n}function Ib(t,e){return t.get(Rb(t,e))}function Rb(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ob=new WeakMap,Db=new WeakMap,Lb=new WeakMap,Fb=new WeakMap,Bb=new WeakMap,Nb=new WeakMap,Wb=new WeakMap,Ub=new WeakMap,jb=new WeakMap,Hb=new WeakMap,zb=new WeakMap,Gb=new WeakMap,Xb=new WeakMap,Vb=new WeakMap,Yb=new WeakMap,$b=new WeakMap,qb=new WeakMap,Kb=new WeakMap,Zb=new WeakMap,Qb=new WeakMap,Jb=new WeakMap,tA=new WeakMap,eA=new WeakMap,nA=w(function t(e){var n=this;g(this,t),Cb(this,Ob,window.game),Cb(this,Db,Ib(Ob,this).app.stage),Cb(this,Lb,Ib(Ob,this).refs),Cb(this,Fb,Ib(Lb,this).startScreenView),Cb(this,Bb,Ff.timeline()),Cb(this,Nb,Gf.storage),Cb(this,Wb,new Mb(this)),Cb(this,Ub,Ib(Fb,this).getChildByName("btnContainer")),Cb(this,jb,Ib(Lb,this).telegram),Cb(this,Hb,void 0),Cb(this,zb,null),Cb(this,Gb,void 0),S(this,"init",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:Pb(Gb,n,Gf.soundManager),Vm(Ib(Lb,n).fade,{hide:!0}),Ib(Db,n).interactiveChildren=!0,n.setInteractive(!0),Ib(tA,n).call(n,{show:!0,delay:.5}),Ib(Qb,n).call(n);case 1:case"end":return t.stop()}},t)}))),S(this,"setInteractive",function(t){var e=t?"on":"off",r=t?"static":"none";Ib(Ub,n).eventMode=r,Ib(Ub,n)[e]("pointerup",Ib(Vb,n)),Ib(jb,n)&&Ib(jb,n)[e]("pointerup",Ib(Kb,n)),Ib(Lb,n).optionsWheel.eventMode=r}),Cb(this,Xb,function(){Ib(Lb,n).userLevel.getChildByName("playerLevelText",1).text=Ib(Nb,n).userLevel}),Cb(this,Vb,function(){var t=Kl(Jl().mark(function t(e){var r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.target,!(null!==(r=n.clickTimeLine)&&void 0!==r&&r.isActive||"btnContainer"===i.name)){t.next=1;break}return t.abrupt("return");case 1:if(!Ib(zb,n).viewIsShow){t.next=2;break}return t.abrupt("return");case 2:"btnStart"===i.name&&Ib(Yb,n).call(n,i),"btnStore"===i.name&&Ib($b,n).call(n,i),"btnLeaderboard"===i.name&&Ib(qb,n).call(n,i),"button"===i.typeName&&Ib(Gb,n).play("sfx_btnClick");case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),Cb(this,Yb,function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return ag.btnStart(),Ib(Ub,n).interactiveChildren=!1,Ib(Gb,n).stopAll(),t.next=1,Ib(Jb,n).call(n,e);case 1:Ib(Zb,n).call(n);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),Cb(this,$b,function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return ag.mainScreenBtnStore(),t.next=1,Ib(Jb,n).call(n,e);case 1:Ib(Wb,n).showModule(dw);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),Cb(this,qb,function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return ag.btnLeaders(),t.next=1,Ib(Jb,n).call(n,e);case 1:if(!gg.isUserAuth){t.next=2;break}return Ol.log(""," ."),Ib(Wb,n).showModule(pw),t.abrupt("return");case 2:Ol.warn("","  ."),Ib(Wb,n).showModule(fw);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),Cb(this,Kb,function(){Ib(Gb,n).play("sfx_btnClick"),window.open("https://t.me/+WpIblpkA3y03ZDAy","_blank")}),Cb(this,Zb,function(){Ib(Ob,n).emit(zg),n.state.checkoutState(hl)}),Cb(this,Qb,function(){Ib(jb,n)&&Pb(Hb,n,Ff.timeline().fromTo(Ib(jb,n).scale,{x:1,y:1},{x:1.1,y:1.1,duration:.5,yoyo:!0,repeat:-1}))}),Cb(this,Jb,function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.clickTimeLine=Ff.timeline().fromTo(e.scale,{x:e.scale.x,y:e.scale.y},{x:1.1,y:1.1,yoyo:!0,repeat:1,duration:.1}),t.abrupt("return",new Promise(function(t){n.clickTimeLine.eventCallback("onComplete",function(){Xm(n.clickTimeLine),n.clickTimeLine=null,t()})}));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),Cb(this,tA,function(t){var e=t.show,r=t.hide,i=t.delay,s=void 0===i?0:i,o=Ib(Lb,n).optionsWheel,a=Ib(Ob,n).uiInner;return e?Ff.timeline().fromTo([a,o],{alpha:0},{alpha:1,delay:s,visible:!0}):r?Ff.timeline().to([a,o],{alpha:0,delay:s,visible:!1}):void 0}),Cb(this,eA,function(){Ib(Ob,n).off(zg,Ib(eA,n)),Xm(Ib(Bb,n),!0),Xm(Ib(Hb,n),!0)}),this.state=e,Pb(zb,this,new uw(this.state)),Ib(Ob,this).uiInner.visible=!1,Ib(Xb,this).call(this),$m.initOverHandler(Gc(Ib(Ub,this).children)),Ib(Ob,this).on(zg,Ib(eA,this))});class rA{constructor(t,e,n){this.value=t,this.time=e,this.next=null,this.isStepped=!1,this.ease=n?"function"==typeof n?n:uA(n):null}static createList(t){if("list"in t){const e=t.list;let n;const{value:r,time:i}=e[0],s=n=new rA("string"==typeof r?hA(r):r,i,t.ease);if(e.length>2||2===e.length&&e[1].value!==r)for(let t=1;t<e.length;++t){const{value:r,time:i}=e[t];n.next=new rA("string"==typeof r?hA(r):r,i),n=n.next}return s.isStepped=!!t.isStepped,s}const e=new rA("string"==typeof t.start?hA(t.start):t.start,0);return t.end!==t.start&&(e.next=new rA("string"==typeof t.end?hA(t.end):t.end,1)),e}}let iA=Kn.from;const sA=Math.PI/180;function oA(t,e){if(!t)return;const n=Math.sin(t),r=Math.cos(t),i=e.x*r-e.y*n,s=e.x*n+e.y*r;e.x=i,e.y=s}function aA(t,e,n){return t<<16|e<<8|n}function lA(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function cA(t,e){t.x*=e,t.y*=e}function hA(t,e){let n;return e||(e={}),"#"===t.charAt(0)?t=t.substr(1):0===t.indexOf("0x")&&(t=t.substr(2)),8===t.length&&(n=t.substr(0,2),t=t.substr(2)),e.r=parseInt(t.substr(0,2),16),e.g=parseInt(t.substr(2,2),16),e.b=parseInt(t.substr(4,2),16),n&&(e.a=parseInt(n,16)),e}function uA(t){const e=t.length,n=1/e;return function(r){const i=e*r|0,s=(r-i*n)*e,o=t[i]||t[e-1];return o.s+s*(2*(1-s)*(o.cp-o.s)+s*(o.e-o.s))}}function dA(t){return t?(t=t.toUpperCase().replace(/ /g,"_"),C[t]||C.NORMAL):C.NORMAL}var pA;class fA extends ki{constructor(t){super(),this.prevChild=this.nextChild=null,this.emitter=t,this.config={},this.anchor.x=this.anchor.y=.5,this.maxLife=0,this.age=0,this.agePercent=0,this.oneOverLife=0,this.next=null,this.prev=null,this.init=this.init,this.kill=this.kill}init(t){this.maxLife=t,this.age=this.agePercent=0,this.rotation=0,this.position.x=this.position.y=0,this.scale.x=this.scale.y=1,this.tint=16777215,this.alpha=1,this.oneOverLife=1/this.maxLife,this.visible=!0}kill(){this.emitter.recycle(this)}destroy(){this.parent&&this.parent.removeChild(this),this.emitter=this.next=this.prev=null,super.destroy()}}!function(t){t[t.Spawn=0]="Spawn",t[t.Normal=2]="Normal",t[t.Late=5]="Late"}(pA||(pA={}));const mA=ti.shared,gA=Symbol("Position particle per emitter position");class vA{constructor(t,e){this.initBehaviors=[],this.updateBehaviors=[],this.recycleBehaviors=[],this.minLifetime=0,this.maxLifetime=0,this.customEase=null,this._frequency=1,this.spawnChance=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=new Ye,this.particlesPerWave=1,this.rotation=0,this.ownerPos=new Ye,this._prevEmitterPos=new Ye,this._prevPosIsValid=!1,this._posChanged=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this._completeCallback=null,this.parent=t,e&&this.init(e),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos}static registerBehavior(t){vA.knownBehaviors[t.type]=t}get frequency(){return this._frequency}set frequency(t){this._frequency="number"==typeof t&&t>0?t:1}get parent(){return this._parent}set parent(t){this.cleanup(),this._parent=t}init(t){if(!t)return;this.cleanup(),this._origConfig=t,this.minLifetime=t.lifetime.min,this.maxLifetime=t.lifetime.max,t.ease?this.customEase="function"==typeof t.ease?t.ease:uA(t.ease):this.customEase=null,this.particlesPerWave=1,t.particlesPerWave&&t.particlesPerWave>1&&(this.particlesPerWave=t.particlesPerWave),this.frequency=t.frequency,this.spawnChance="number"==typeof t.spawnChance&&t.spawnChance>0?t.spawnChance:1,this.emitterLifetime=t.emitterLifetime||-1,this.maxParticles=t.maxParticles>0?t.maxParticles:1e3,this.addAtBack=!!t.addAtBack,this.rotation=0,this.ownerPos.set(0),t.pos?this.spawnPos.copyFrom(t.pos):this.spawnPos.set(0),this._prevEmitterPos.copyFrom(this.spawnPos),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=void 0===t.emit||!!t.emit,this.autoUpdate=!!t.autoUpdate;const e=t.behaviors.map(t=>{const e=vA.knownBehaviors[t.type];return e?new e(t.config):(console.error(`Unknown behavior: ${t.type}`),null)}).filter(t=>!!t);e.push(gA),e.sort((t,e)=>t===gA?e.order===pA.Spawn?1:-1:e===gA?t.order===pA.Spawn?-1:1:t.order-e.order),this.initBehaviors=e.slice(),this.updateBehaviors=e.filter(t=>t!==gA&&t.updateParticle),this.recycleBehaviors=e.filter(t=>t!==gA&&t.recycleParticle)}getBehavior(t){return vA.knownBehaviors[t]&&this.initBehaviors.find(e=>e instanceof vA.knownBehaviors[t])||null}fillPool(t){for(;t>0;--t){const t=new fA(this);t.next=this._poolFirst,this._poolFirst=t}}recycle(t,e=!1){for(let n=0;n<this.recycleBehaviors.length;++n)this.recycleBehaviors[n].recycleParticle(t,!e);t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t===this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t===this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),t.prev=null,t.next=this._poolFirst,this._poolFirst=t,t.parent&&t.parent.removeChild(t),--this.particleCount}rotate(t){if(this.rotation===t)return;const e=t-this.rotation;this.rotation=t,oA(e,this.spawnPos),this._posChanged=!0}updateSpawnPos(t,e){this._posChanged=!0,this.spawnPos.x=t,this.spawnPos.y=e}updateOwnerPos(t,e){this._posChanged=!0,this.ownerPos.x=t,this.ownerPos.y=e}resetPositionTracking(){this._prevPosIsValid=!1}get emit(){return this._emit}set emit(t){this._emit=!!t,this._emitterLife=this.emitterLifetime}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){this._autoUpdate&&!t?mA.remove(this.update,this):!this._autoUpdate&&t&&mA.add(this.update,this),this._autoUpdate=!!t}playOnceAndDestroy(t){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0,this._completeCallback=t}playOnce(t){this.emit=!0,this._completeCallback=t}update(t){if(this._autoUpdate&&(t=.001*mA.elapsedMS),!this._parent)return;for(let e,n=this._activeParticlesFirst;n;n=e)if(e=n.next,n.age+=t,n.age>n.maxLife||n.age<0)this.recycle(n);else{let e=n.age*n.oneOverLife;this.customEase&&(e=4===this.customEase.length?this.customEase(e,0,1,1):this.customEase(e)),n.agePercent=e;for(let e=0;e<this.updateBehaviors.length;++e)if(this.updateBehaviors[e].updateParticle(n,t)){this.recycle(n);break}}let e,n;this._prevPosIsValid&&(e=this._prevEmitterPos.x,n=this._prevEmitterPos.y);const r=this.ownerPos.x+this.spawnPos.x,i=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=t<0?0:t;this._spawnTimer<=0;){if(this._emitterLife>=0&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles){this._spawnTimer+=this._frequency;continue}let s,o;if(this._prevPosIsValid&&this._posChanged){const a=1+this._spawnTimer/t;s=(r-e)*a+e,o=(i-n)*a+n}else s=r,o=i;let a=null,l=null;for(let t=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),e=0;e<t;++e){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let t,e;t=this.minLifetime===this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer>=t||(this._poolFirst?(e=this._poolFirst,this._poolFirst=this._poolFirst.next,e.next=null):e=new fA(this),e.init(t),this.addAtBack?this._parent.addChildAt(e,0):this._parent.addChild(e),a?(l.next=e,e.prev=l,l=e):l=a=e,++this.particleCount)}if(a){this._activeParticlesLast?(this._activeParticlesLast.next=a,a.prev=this._activeParticlesLast,this._activeParticlesLast=l):(this._activeParticlesFirst=a,this._activeParticlesLast=l);for(let t=0;t<this.initBehaviors.length;++t){const e=this.initBehaviors[t];if(e===gA)for(let t,e=a;e;e=t){t=e.next,0!==this.rotation&&(oA(this.rotation,e.position),e.rotation+=this.rotation),e.position.x+=s,e.position.y+=o,e.age+=-this._spawnTimer;let n=e.age*e.oneOverLife;this.customEase&&(n=4===this.customEase.length?this.customEase(n,0,1,1):this.customEase(n)),e.agePercent=n}else e.initParticles(a)}for(let t,e=a;e;e=t){t=e.next;for(let t=0;t<this.updateBehaviors.length;++t)if(this.updateBehaviors[t].updateParticle(e,-this._spawnTimer)){this.recycle(e);break}}}this._spawnTimer+=this._frequency}if(this._posChanged&&(this._prevEmitterPos.x=r,this._prevEmitterPos.y=i,this._prevPosIsValid=!0,this._posChanged=!1),!this._emit&&!this._activeParticlesFirst){if(this._completeCallback){const t=this._completeCallback;this._completeCallback=null,t()}this._destroyWhenComplete&&this.destroy()}}emitNow(){const t=this.ownerPos.x+this.spawnPos.x,e=this.ownerPos.y+this.spawnPos.y;let n=null,r=null;for(let t=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),e=0;e<t;++e){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let t,e;this._poolFirst?(t=this._poolFirst,this._poolFirst=this._poolFirst.next,t.next=null):t=new fA(this),e=this.minLifetime===this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,t.init(e),this.addAtBack?this._parent.addChildAt(t,0):this._parent.addChild(t),n?(r.next=t,t.prev=r,r=t):r=n=t,++this.particleCount}if(n){this._activeParticlesLast?(this._activeParticlesLast.next=n,n.prev=this._activeParticlesLast,this._activeParticlesLast=r):(this._activeParticlesFirst=n,this._activeParticlesLast=r);for(let r=0;r<this.initBehaviors.length;++r){const i=this.initBehaviors[r];if(i===gA)for(let r,i=n;i;i=r)r=i.next,0!==this.rotation&&(oA(this.rotation,i.position),i.rotation+=this.rotation),i.position.x+=t,i.position.y+=e;else i.initParticles(n)}}}cleanup(){let t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t,!0);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0}get destroyed(){return!(this._parent&&this.initBehaviors.length)}destroy(){let t;this.autoUpdate=!1,this.cleanup();for(let e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=this._parent=this.spawnPos=this.ownerPos=this.customEase=this._completeCallback=null,this.initBehaviors.length=this.updateBehaviors.length=this.recycleBehaviors.length=0}}vA.knownBehaviors={};class yA{constructor(t){this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h}getRandPos(t){t.x=Math.random()*this.w+this.x,t.y=Math.random()*this.h+this.y}}yA.type="rect",yA.editorConfig=null;class xA{constructor(t){this.x=t.x||0,this.y=t.y||0,this.radius=t.radius,this.innerRadius=t.innerRadius||0,this.rotation=!!t.affectRotation}getRandPos(t){this.innerRadius!==this.radius?t.x=Math.random()*(this.radius-this.innerRadius)+this.innerRadius:t.x=this.radius,t.y=0;const e=Math.random()*Math.PI*2;this.rotation&&(t.rotation+=e),oA(e,t.position),t.position.x+=this.x,t.position.y+=this.y}}xA.type="torus",xA.editorConfig=null;class wA{constructor(t){this.segments=[],this.countingLengths=[],this.totalLength=0,this.init(t)}init(t){if(t&&t.length)if(Array.isArray(t[0]))for(let e=0;e<t.length;++e){const n=t[e];let r=n[0];for(let t=1;t<n.length;++t){const e=n[t];this.segments.push({p1:r,p2:e,l:0}),r=e}}else{let e=t[0];for(let n=1;n<t.length;++n){const r=t[n];this.segments.push({p1:e,p2:r,l:0}),e=r}}else this.segments.push({p1:{x:0,y:0},p2:{x:0,y:0},l:0});for(let t=0;t<this.segments.length;++t){const{p1:e,p2:n}=this.segments[t],r=Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y));this.segments[t].l=r,this.totalLength+=r,this.countingLengths.push(this.totalLength)}}getRandPos(t){const e=Math.random()*this.totalLength;let n,r;if(1===this.segments.length)n=this.segments[0],r=e;else for(let t=0;t<this.countingLengths.length;++t)if(e<this.countingLengths[t]){n=this.segments[t],r=0===t?e:e-this.countingLengths[t-1];break}r/=n.l||1;const{p1:i,p2:s}=n;t.x=i.x+r*(s.x-i.x),t.y=i.y+r*(s.y-i.y)}}wA.type="polygonalChain",wA.editorConfig=null;class _A{constructor(t){var e;this.order=pA.Late,this.minStart=t.minStart,this.maxStart=t.maxStart,this.accel=t.accel,this.rotate=!!t.rotate,this.maxSpeed=null!==(e=t.maxSpeed)&&void 0!==e?e:0}initParticles(t){let e=t;for(;e;){const t=Math.random()*(this.maxStart-this.minStart)+this.minStart;e.config.velocity?e.config.velocity.set(t,0):e.config.velocity=new Ye(t,0),oA(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const n=t.config.velocity,r=n.x,i=n.y;if(n.x+=this.accel.x*e,n.y+=this.accel.y*e,this.maxSpeed){const t=lA(n);t>this.maxSpeed&&cA(n,this.maxSpeed/t)}t.x+=(r+n.x)/2*e,t.y+=(i+n.y)/2*e,this.rotate&&(t.rotation=Math.atan2(n.y,n.x))}}function bA(t){return this.ease&&(t=this.ease(t)),(this.first.next.value-this.first.value)*t+this.first.value}function AA(t){this.ease&&(t=this.ease(t));const e=this.first.value,n=this.first.next.value;return aA((n.r-e.r)*t+e.r,(n.g-e.g)*t+e.g,(n.b-e.b)*t+e.b)}function TA(t){this.ease&&(t=this.ease(t));let e=this.first,n=e.next;for(;t>n.time;)e=n,n=n.next;return t=(t-e.time)/(n.time-e.time),(n.value-e.value)*t+e.value}function SA(t){this.ease&&(t=this.ease(t));let e=this.first,n=e.next;for(;t>n.time;)e=n,n=n.next;t=(t-e.time)/(n.time-e.time);const r=e.value,i=n.value;return aA((i.r-r.r)*t+r.r,(i.g-r.g)*t+r.g,(i.b-r.b)*t+r.b)}function EA(t){this.ease&&(t=this.ease(t));let e=this.first;for(;e.next&&t>e.next.time;)e=e.next;return e.value}function kA(t){this.ease&&(t=this.ease(t));let e=this.first;for(;e.next&&t>e.next.time;)e=e.next;const n=e.value;return aA(n.r,n.g,n.b)}_A.type="moveAcceleration",_A.editorConfig=null;class MA{constructor(t=!1){this.first=null,this.isColor=!!t,this.interpolate=null,this.ease=null}reset(t){this.first=t,t.next&&t.next.time>=1?this.interpolate=this.isColor?AA:bA:t.isStepped?this.interpolate=this.isColor?kA:EA:this.interpolate=this.isColor?SA:TA,this.ease=this.first.ease}}class CA{constructor(t){this.order=pA.Normal,this.list=new MA(!1),this.list.reset(rA.createList(t.alpha))}initParticles(t){let e=t;for(;e;)e.alpha=this.list.first.value,e=e.next}updateParticle(t){t.alpha=this.list.interpolate(t.agePercent)}}CA.type="alpha",CA.editorConfig=null;class PA{constructor(t){this.order=pA.Normal,this.value=t.alpha}initParticles(t){let e=t;for(;e;)e.alpha=this.value,e=e.next}}function IA(t){const e=[];for(let n=0;n<t.length;++n){let r=t[n];if("string"==typeof r)e.push(iA(r));else if(r instanceof Kn)e.push(r);else{let t=r.count||1;for(r="string"==typeof r.texture?iA(r.texture):r.texture;t>0;--t)e.push(r)}}return e}PA.type="alphaStatic",PA.editorConfig=null;class RA{constructor(t){this.order=pA.Normal,this.anims=[];for(let e=0;e<t.anims.length;++e){const n=t.anims[e],r=IA(n.textures),i=n.framerate<0?-1:n.framerate>0?n.framerate:60,s={textures:r,duration:i>0?r.length/i:0,framerate:i,loop:i>0&&!!n.loop};this.anims.push(s)}}initParticles(t){let e=t;for(;e;){const t=Math.floor(Math.random()*this.anims.length),n=e.config.anim=this.anims[t];e.texture=n.textures[0],e.config.animElapsed=0,-1===n.framerate?(e.config.animDuration=e.maxLife,e.config.animFramerate=n.textures.length/e.maxLife):(e.config.animDuration=n.duration,e.config.animFramerate=n.framerate),e=e.next}}updateParticle(t,e){const n=t.config,r=n.anim;n.animElapsed+=e,n.animElapsed>=n.animDuration&&(n.anim.loop?n.animElapsed=n.animElapsed%n.animDuration:n.animElapsed=n.animDuration-1e-6);const i=n.animElapsed*n.animFramerate+1e-7|0;t.texture=r.textures[i]||r.textures[r.textures.length-1]||Kn.EMPTY}}RA.type="animatedRandom",RA.editorConfig=null;class OA{constructor(t){this.order=pA.Normal;const e=t.anim,n=IA(e.textures),r=e.framerate<0?-1:e.framerate>0?e.framerate:60;this.anim={textures:n,duration:r>0?n.length/r:0,framerate:r,loop:r>0&&!!e.loop}}initParticles(t){let e=t;const n=this.anim;for(;e;)e.texture=n.textures[0],e.config.animElapsed=0,-1===n.framerate?(e.config.animDuration=e.maxLife,e.config.animFramerate=n.textures.length/e.maxLife):(e.config.animDuration=n.duration,e.config.animFramerate=n.framerate),e=e.next}updateParticle(t,e){const n=this.anim,r=t.config;r.animElapsed+=e,r.animElapsed>=r.animDuration&&(n.loop?r.animElapsed=r.animElapsed%r.animDuration:r.animElapsed=r.animDuration-1e-6);const i=r.animElapsed*r.animFramerate+1e-7|0;t.texture=n.textures[i]||n.textures[n.textures.length-1]||Kn.EMPTY}}OA.type="animatedSingle",OA.editorConfig=null;class DA{constructor(t){this.order=pA.Normal,this.value=t.blendMode}initParticles(t){let e=t;for(;e;)e.blendMode=dA(this.value),e=e.next}}DA.type="blendMode",DA.editorConfig=null;class LA{constructor(t){this.order=pA.Spawn,this.spacing=t.spacing*sA,this.start=t.start*sA,this.distance=t.distance}initParticles(t){let e=0,n=t;for(;n;){let t;t=this.spacing?this.start+this.spacing*e:Math.random()*Math.PI*2,n.rotation=t,this.distance&&(n.position.x=this.distance,oA(t,n.position)),n=n.next,++e}}}LA.type="spawnBurst",LA.editorConfig=null;class FA{constructor(t){this.order=pA.Normal,this.list=new MA(!0),this.list.reset(rA.createList(t.color))}initParticles(t){let e=t;const n=this.list.first.value,r=aA(n.r,n.g,n.b);for(;e;)e.tint=r,e=e.next}updateParticle(t){t.tint=this.list.interpolate(t.agePercent)}}FA.type="color",FA.editorConfig=null;class BA{constructor(t){this.order=pA.Normal;let e=t.color;"#"===e.charAt(0)?e=e.substr(1):0===e.indexOf("0x")&&(e=e.substr(2)),this.value=parseInt(e,16)}initParticles(t){let e=t;for(;e;)e.tint=this.value,e=e.next}}BA.type="colorStatic",BA.editorConfig=null;class NA{constructor(t){this.order=pA.Normal,this.index=0,this.textures=t.textures.map(t=>"string"==typeof t?iA(t):t)}initParticles(t){let e=t;for(;e;)e.texture=this.textures[this.index],++this.index>=this.textures.length&&(this.index=0),e=e.next}}NA.type="textureOrdered",NA.editorConfig=null;const WA=new Ye,UA=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atanh","atan2","cbrt","ceil","cos","cosh","exp","expm1","floor","fround","hypot","log","log1p","log10","log2","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh"],jA=new RegExp(["[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]"].concat(UA).join("|"),"g");class HA{constructor(t){var e;if(this.order=pA.Late,t.path)if("function"==typeof t.path)this.path=t.path;else try{this.path=function(t){const e=t.match(jA);for(let t=e.length-1;t>=0;--t)UA.indexOf(e[t])>=0&&(e[t]=`Math.${e[t]}`);return t=e.join(""),new Function("x",`return ${t};`)}(t.path)}catch(t){this.path=null}else this.path=t=>t;this.list=new MA(!1),this.list.reset(rA.createList(t.speed)),this.minMult=null!==(e=t.minMult)&&void 0!==e?e:1}initParticles(t){let e=t;for(;e;){e.config.initRotation=e.rotation,e.config.initPosition?e.config.initPosition.copyFrom(e.position):e.config.initPosition=new Ye(e.x,e.y),e.config.movement=0;const t=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=t,e=e.next}}updateParticle(t,e){const n=this.list.interpolate(t.agePercent)*t.config.speedMult;t.config.movement+=n*e,WA.x=t.config.movement,WA.y=this.path(WA.x),oA(t.config.initRotation,WA),t.position.x=t.config.initPosition.x+WA.x,t.position.y=t.config.initPosition.y+WA.y}}HA.type="movePath",HA.editorConfig=null;class zA{constructor(){this.order=pA.Spawn}initParticles(t){}}zA.type="spawnPoint",zA.editorConfig=null;class GA{constructor(t){this.order=pA.Normal,this.textures=t.textures.map(t=>"string"==typeof t?iA(t):t)}initParticles(t){let e=t;for(;e;){const t=Math.floor(Math.random()*this.textures.length);e.texture=this.textures[t],e=e.next}}}GA.type="textureRandom",GA.editorConfig=null;class XA{constructor(t){this.order=pA.Normal,this.minStart=t.minStart*sA,this.maxStart=t.maxStart*sA,this.minSpeed=t.minSpeed*sA,this.maxSpeed=t.maxSpeed*sA,this.accel=t.accel*sA}initParticles(t){let e=t;for(;e;)this.minStart===this.maxStart?e.rotation+=this.maxStart:e.rotation+=Math.random()*(this.maxStart-this.minStart)+this.minStart,e.config.rotSpeed=Math.random()*(this.maxSpeed-this.minSpeed)+this.minSpeed,e=e.next}updateParticle(t,e){if(this.accel){const n=t.config.rotSpeed;t.config.rotSpeed+=this.accel*e,t.rotation+=(t.config.rotSpeed+n)/2*e}else t.rotation+=t.config.rotSpeed*e}}XA.type="rotation",XA.editorConfig=null;class VA{constructor(t){this.order=pA.Normal,this.min=t.min*sA,this.max=t.max*sA}initParticles(t){let e=t;for(;e;)this.min===this.max?e.rotation+=this.max:e.rotation+=Math.random()*(this.max-this.min)+this.min,e=e.next}}VA.type="rotationStatic",VA.editorConfig=null;class YA{constructor(t){this.order=pA.Late+1,this.rotation=(t.rotation||0)*sA}initParticles(t){let e=t;for(;e;)e.rotation=this.rotation,e=e.next}}YA.type="noRotation",YA.editorConfig=null;class $A{constructor(t){var e;this.order=pA.Normal,this.list=new MA(!1),this.list.reset(rA.createList(t.scale)),this.minMult=null!==(e=t.minMult)&&void 0!==e?e:1}initParticles(t){let e=t;for(;e;){const t=Math.random()*(1-this.minMult)+this.minMult;e.config.scaleMult=t,e.scale.x=e.scale.y=this.list.first.value*t,e=e.next}}updateParticle(t){t.scale.x=t.scale.y=this.list.interpolate(t.agePercent)*t.config.scaleMult}}$A.type="scale",$A.editorConfig=null;class qA{constructor(t){this.order=pA.Normal,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const t=Math.random()*(this.max-this.min)+this.min;e.scale.x=e.scale.y=t,e=e.next}}}qA.type="scaleStatic",qA.editorConfig=null;class KA{constructor(t){this.order=pA.Spawn;const e=KA.shapes[t.type];if(!e)throw new Error(`No shape found with type '${t.type}'`);this.shape=new e(t.data)}static registerShape(t,e){KA.shapes[e||t.type]=t}initParticles(t){let e=t;for(;e;)this.shape.getRandPos(e),e=e.next}}KA.type="spawnShape",KA.editorConfig=null,KA.shapes={},KA.registerShape(wA),KA.registerShape(yA),KA.registerShape(xA),KA.registerShape(xA,"circle");class ZA{constructor(t){this.order=pA.Normal,this.texture="string"==typeof t.texture?iA(t.texture):t.texture}initParticles(t){let e=t;for(;e;)e.texture=this.texture,e=e.next}}ZA.type="textureSingle",ZA.editorConfig=null;class QA{constructor(t){var e;this.order=pA.Late,this.list=new MA(!1),this.list.reset(rA.createList(t.speed)),this.minMult=null!==(e=t.minMult)&&void 0!==e?e:1}initParticles(t){let e=t;for(;e;){const t=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=t,e.config.velocity?e.config.velocity.set(this.list.first.value*t,0):e.config.velocity=new Ye(this.list.first.value*t,0),oA(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const n=this.list.interpolate(t.agePercent)*t.config.speedMult,r=t.config.velocity;(function(t){const e=1/lA(t);t.x*=e,t.y*=e})(r),cA(r,n),t.x+=r.x*e,t.y+=r.y*e}}QA.type="moveSpeed",QA.editorConfig=null;class JA{constructor(t){this.order=pA.Late,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const t=Math.random()*(this.max-this.min)+this.min;e.config.velocity?e.config.velocity.set(t,0):e.config.velocity=new Ye(t,0),oA(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const n=t.config.velocity;t.x+=n.x*e,t.y+=n.y*e}}JA.type="moveSpeedStatic",JA.editorConfig=null,vA.registerBehavior(_A),vA.registerBehavior(CA),vA.registerBehavior(PA),vA.registerBehavior(RA),vA.registerBehavior(OA),vA.registerBehavior(DA),vA.registerBehavior(LA),vA.registerBehavior(FA),vA.registerBehavior(BA),vA.registerBehavior(NA),vA.registerBehavior(HA),vA.registerBehavior(zA),vA.registerBehavior(GA),vA.registerBehavior(XA),vA.registerBehavior(VA),vA.registerBehavior(YA),vA.registerBehavior($A),vA.registerBehavior(qA),vA.registerBehavior(KA),vA.registerBehavior(ZA),vA.registerBehavior(QA),vA.registerBehavior(JA);var tT=JSON.parse('{"alpha":{"start":0.8,"end":0},"scale":{"start":0.2,"end":3.2,"minimumScaleMultiplier":0.2},"color":{"start":"#ffdd00","end":"#ffdd00"},"speed":{"start":0.1,"end":1,"minimumSpeedMultiplier":1},"acceleration":{"x":20,"y":-30},"maxSpeed":30,"noRotation":true,"rotationSpeed":{"min":0,"max":0},"startRotation":{"min":0,"max":0},"lifetime":{"min":1,"max":10},"blendMode":"normal","frequency":0.01,"emitterLifetime":-1,"maxParticles":500,"pos":{"x":0,"y":0},"addAtBack":false,"spawnType":"rect"}');function eT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function nT(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?eT(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):eT(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function rT(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function iT(t,e){return t.get(oT(t,e))}function sT(t,e,n){return t.set(oT(t,e),n),n}function oT(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var aT=new WeakMap,lT=new WeakMap,cT=new WeakMap,hT=new WeakMap,uT=new WeakMap,dT=w(function t(e,n){var r=this;g(this,t),rT(this,aT,void 0),rT(this,lT,void 0),rT(this,cT,void 0),rT(this,hT,void 0),S(this,"init",function(){try{if(sT(lT,r,new ea(250)),!iT(hT,r))return void console.warn("[MagicDust]    ");iT(hT,r).addChildAt(iT(lT,r),1),iT(cT,r).on(zg,r.destroy),iT(uT,r).call(r)}catch(t){console.error("[MagicDust]    MagicDust:",t)}}),rT(this,uT,function(){try{var t=Kn.from("particle")||Kn.WHITE;t||console.warn("[MagicDust]     ");var e=function(t,e){var n,r,i,s,o,a,l,c,h,u,d,p,f,m,g,v,y,x,w,_,b;if("behaviors"in t)return t;const A={lifetime:t.lifetime,ease:t.ease,particlesPerWave:t.particlesPerWave,frequency:t.frequency,spawnChance:t.spawnChance,emitterLifetime:t.emitterLifetime,maxParticles:t.maxParticles,addAtBack:t.addAtBack,pos:t.pos,emit:t.emit,autoUpdate:t.autoUpdate,behaviors:[]};if(t.alpha)if("start"in t.alpha)if(t.alpha.start===t.alpha.end)1!==t.alpha.start&&A.behaviors.push({type:"alphaStatic",config:{alpha:t.alpha.start}});else{const e={list:[{time:0,value:t.alpha.start},{time:1,value:t.alpha.end}]};A.behaviors.push({type:"alpha",config:{alpha:e}})}else 1===t.alpha.list.length?1!==t.alpha.list[0].value&&A.behaviors.push({type:"alphaStatic",config:{alpha:t.alpha.list[0].value}}):A.behaviors.push({type:"alpha",config:{alpha:t.alpha}});if(t.acceleration&&(t.acceleration.x||t.acceleration.y)){let e,i;"start"in t.speed?(e=t.speed.start*(null!==(n=t.speed.minimumSpeedMultiplier)&&void 0!==n?n:1),i=t.speed.start):(e=t.speed.list[0].value*(null!==(r=t.minimumSpeedMultiplier)&&void 0!==r?r:1),i=t.speed.list[0].value),A.behaviors.push({type:"moveAcceleration",config:{accel:t.acceleration,minStart:e,maxStart:i,rotate:!t.noRotation,maxSpeed:t.maxSpeed}})}else if(null===(i=t.extraData)||void 0===i?void 0:i.path){let e,n;"start"in t.speed?(n=null!==(s=t.speed.minimumSpeedMultiplier)&&void 0!==s?s:1,e=t.speed.start===t.speed.end?{list:[{time:0,value:t.speed.start}]}:{list:[{time:0,value:t.speed.start},{time:1,value:t.speed.end}]}):(e=t.speed,n=null!==(o=t.minimumSpeedMultiplier)&&void 0!==o?o:1),A.behaviors.push({type:"movePath",config:{path:t.extraData.path,speed:e,minMult:n}})}else if(t.speed)if("start"in t.speed)if(t.speed.start===t.speed.end)A.behaviors.push({type:"moveSpeedStatic",config:{min:t.speed.start*(null!==(a=t.speed.minimumSpeedMultiplier)&&void 0!==a?a:1),max:t.speed.start}});else{const e={list:[{time:0,value:t.speed.start},{time:1,value:t.speed.end}]};A.behaviors.push({type:"moveSpeed",config:{speed:e,minMult:t.speed.minimumSpeedMultiplier}})}else 1===t.speed.list.length?A.behaviors.push({type:"moveSpeedStatic",config:{min:t.speed.list[0].value*(null!==(l=t.minimumSpeedMultiplier)&&void 0!==l?l:1),max:t.speed.list[0].value}}):A.behaviors.push({type:"moveSpeed",config:{speed:t.speed,minMult:null!==(c=t.minimumSpeedMultiplier)&&void 0!==c?c:1}});if(t.scale)if("start"in t.scale){const e=null!==(h=t.scale.minimumScaleMultiplier)&&void 0!==h?h:1;if(t.scale.start===t.scale.end)A.behaviors.push({type:"scaleStatic",config:{min:t.scale.start*e,max:t.scale.start}});else{const n={list:[{time:0,value:t.scale.start},{time:1,value:t.scale.end}]};A.behaviors.push({type:"scale",config:{scale:n,minMult:e}})}}else if(1===t.scale.list.length){const e=null!==(u=t.minimumScaleMultiplier)&&void 0!==u?u:1,n=t.scale.list[0].value;A.behaviors.push({type:"scaleStatic",config:{min:n*e,max:n}})}else A.behaviors.push({type:"scale",config:{scale:t.scale,minMult:null!==(d=t.minimumScaleMultiplier)&&void 0!==d?d:1}});if(t.color)if("start"in t.color)if(t.color.start===t.color.end)"ffffff"!==t.color.start&&A.behaviors.push({type:"colorStatic",config:{color:t.color.start}});else{const e={list:[{time:0,value:t.color.start},{time:1,value:t.color.end}]};A.behaviors.push({type:"color",config:{color:e}})}else 1===t.color.list.length?"ffffff"!==t.color.list[0].value&&A.behaviors.push({type:"colorStatic",config:{color:t.color.list[0].value}}):A.behaviors.push({type:"color",config:{color:t.color}});if(t.rotationAcceleration||(null===(p=t.rotationSpeed)||void 0===p?void 0:p.min)||(null===(f=t.rotationSpeed)||void 0===f?void 0:f.max)?A.behaviors.push({type:"rotation",config:{accel:t.rotationAcceleration||0,minSpeed:(null===(m=t.rotationSpeed)||void 0===m?void 0:m.min)||0,maxSpeed:(null===(g=t.rotationSpeed)||void 0===g?void 0:g.max)||0,minStart:(null===(v=t.startRotation)||void 0===v?void 0:v.min)||0,maxStart:(null===(y=t.startRotation)||void 0===y?void 0:y.max)||0}}):((null===(x=t.startRotation)||void 0===x?void 0:x.min)||(null===(w=t.startRotation)||void 0===w?void 0:w.max))&&A.behaviors.push({type:"rotationStatic",config:{min:(null===(_=t.startRotation)||void 0===_?void 0:_.min)||0,max:(null===(b=t.startRotation)||void 0===b?void 0:b.max)||0}}),t.noRotation&&A.behaviors.push({type:"noRotation",config:{}}),t.blendMode&&"normal"!==t.blendMode&&A.behaviors.push({type:"blendMode",config:{blendMode:t.blendMode}}),Array.isArray(e)&&"string"!=typeof e[0]&&"framerate"in e[0]){for(let t=0;t<e.length;++t)"matchLife"===e[t].framerate&&(e[t].framerate=-1);A.behaviors.push({type:"animatedRandom",config:{anims:e}})}else"string"!=typeof e&&"framerate"in e?("matchLife"===e.framerate&&(e.framerate=-1),A.behaviors.push({type:"animatedSingle",config:{anim:e}})):t.orderedArt&&Array.isArray(e)?A.behaviors.push({type:"textureOrdered",config:{textures:e}}):Array.isArray(e)?A.behaviors.push({type:"textureRandom",config:{textures:e}}):A.behaviors.push({type:"textureSingle",config:{texture:e}});if("burst"===t.spawnType)A.behaviors.push({type:"spawnBurst",config:{start:t.angleStart||0,spacing:t.particleSpacing,distance:0}});else if("point"===t.spawnType)A.behaviors.push({type:"spawnPoint",config:{}});else{let e;"ring"===t.spawnType?e={type:"torus",data:{x:t.spawnCircle.x,y:t.spawnCircle.y,radius:t.spawnCircle.r,innerRadius:t.spawnCircle.minR,affectRotation:!0}}:"circle"===t.spawnType?e={type:"torus",data:{x:t.spawnCircle.x,y:t.spawnCircle.y,radius:t.spawnCircle.r,innerRadius:0,affectRotation:!1}}:"rect"===t.spawnType?e={type:"rect",data:t.spawnRect}:"polygonalChain"===t.spawnType&&(e={type:"polygonalChain",data:t.spawnPolygon}),e&&A.behaviors.push({type:"spawnShape",config:e})}return A}(nT(nT({},tT),{},{spawnRect:{x:iT(hT,r).x,y:0,w:iT(hT,r).width,h:iT(hT,r).height}}),[t]);sT(aT,r,new vA(iT(lT,r),e)),iT(aT,r).autoUpdate=!0,iT(aT,r).emit=!0}catch(t){console.error("[MagicDust]    :",t)}}),S(this,"destroy",function(){try{iT(aT,r)&&(iT(aT,r).emit=!1,iT(aT,r).autoUpdate=!1,iT(aT,r).cleanup(),iT(aT,r).destroy(),sT(aT,r,null)),iT(lT,r)&&(iT(lT,r).destroy({children:!0}),sT(lT,r,null)),iT(cT,r).off(zg,r.destroy),Ol.log("","[MagicDust] destroy")}catch(t){Ol.warn("","[MagicDust]",t)}}),sT(cT,this,e),sT(hT,this,n)},[{key:"container",get:function(){return iT(lT,this)}}]);function pT(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(pT=function(){return!!t})()}function fT(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function mT(t,e){return t.get(vT(t,e))}function gT(t,e,n){return t.set(vT(t,e),n),n}function vT(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yT=new WeakMap,xT=new WeakMap,wT=new WeakMap,_T=new WeakMap,bT=new WeakMap,AT=new WeakMap,TT=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,pT()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),fT(n,yT,null),fT(n,xT,null),fT(n,wT,null),fT(n,_T,null),fT(n,bT,null),fT(n,AT,null),S(n,"restart",function(){console.log("[StateGame restart]"),n.terminate(),mT(yT,n).emit(ll)}),S(n,"checkoutState",function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.terminate(),mT(yT,n).emit(e);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),gT(yT,n,t),gT(bT,n,mT(yT,n).ui),n}return T(e,t),w(e,[{key:"initEventName",get:function(){return ll}},{key:"initialize",value:function(){!function(t,e,n){var r=Zl(b(t.prototype),"initialize",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]),gT(xT,this,new Lx(mT(yT,this))),mT(xT,this).addChild(mT(bT,this)),mT(yT,this).viewport.addChild(mT(xT,this)),mT(yT,this).view=mT(xT,this),mT(yT,this).refs=mT(xT,this).refs,gT(wT,this,mT(xT,this).refs),this.game.stateName=this.initEventName,this.isInitialized=!0,this.start()}},{key:"start",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return gg.gamePlayStop(),this.stateStartScreen=new nA(this),this.stateStartScreen.init(),t.next=1,this.resize();case 1:Ol.log(Cl.StateGame,"The game is running!"),new dT(this.game,mT(yT,this).refs.wrapper).init(),gT(AT,this,Gf.soundManager);case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"resize",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Vy(this.game,$y),t.next=1,mT(xT,this).resize();case 1:mT(yT,this).emit(Lg,!0);case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"terminate",value:function(){mT(yT,this).emit(jg),mT(yT,this).off(Lg,!0),Ff.killTweensOf("*"),Ff.globalTimeline.clear(),this.game.viewport.addChild(mT(bT,this)),this.game.uiInner.removeChildren(),mT(xT,this).destroy({children:!0}),gT(xT,this,null),gT(_T,this,null),this.stateStartScreen=null,this.isInitialized=!1,Gf.soundManager.stopAll()}}])}(jc),ST=(r(5440),r(9463),r(2259),r(3418),r(2762),(t=>(t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping",t))(ST||{}));class ET{constructor(t,e=new Array,n=0,r=new DataView(t.buffer)){this.strings=e,this.index=n,this.buffer=r}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){const t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){const t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),n=127&e;return 128&e&&(e=this.readByte(),n|=(127&e)<<7,128&e&&(e=this.readByte(),n|=(127&e)<<14,128&e&&(e=this.readByte(),n|=(127&e)<<21,128&e&&(e=this.readByte(),n|=(127&e)<<28)))),t?n:n>>>1^-(1&n)}readStringRef(){const t=this.readInt(!0);return 0==t?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let n=0;n<t;){const t=this.readUnsignedByte();switch(t>>4){case 12:case 13:e+=String.fromCharCode((31&t)<<6|63&this.readByte()),n+=2;break;case 14:e+=String.fromCharCode((15&t)<<12|(63&this.readByte())<<6|63&this.readByte()),n+=3;break;default:e+=String.fromCharCode(t),n++}}return e}readFloat(){const t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return 0!=this.readByte()}}var kT=(t=>(t[t.setup=0]="setup",t[t.first=1]="first",t[t.replace=2]="replace",t[t.add=3]="add",t))(kT||{}),MT=(t=>(t[t.mixIn=0]="mixIn",t[t.mixOut=1]="mixOut",t))(MT||{}),CT=(t=>(t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent",t))(CT||{}),PT=(t=>(t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale",t))(PT||{}),IT=(t=>(t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection",t))(IT||{});function RT(t){switch(t.toLowerCase()){case"nearest":return OT.Nearest;case"linear":return OT.Linear;case"mipmap":return OT.MipMap;case"mipmapnearestnearest":return OT.MipMapNearestNearest;case"mipmaplinearnearest":return OT.MipMapLinearNearest;case"mipmapnearestlinear":return OT.MipMapNearestLinear;case"mipmaplinearlinear":return OT.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${t}`)}}var OT=(t=>(t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear",t))(OT||{}),DT=(t=>(t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat",t))(DT||{});class LT{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){const t=this.texture;return t.trim?t.trim.width:t.orig.width}get height(){const t=this.texture;return t.trim?t.trim.height:t.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){const t=this.texture;return t.trim?t.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){const t=this.texture;return t.trim?t.trim.y:0}get spineOffsetY(){const t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return 0!==this.texture.rotate}get degrees(){return(360-45*this.texture.rotate)%360}}class FT{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}}class BT{constructor(t,e,n){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,n)}addTexture(t,e){const n=this.pages;let r=null;for(let t=0;t<n.length;t++)if(n[t].baseTexture===e.baseTexture){r=n[t];break}if(null===r){r=new WT,r.name="texturePage";const t=e.baseTexture;r.width=t.realWidth,r.height=t.realHeight,r.baseTexture=t,r.minFilter=r.magFilter=OT.Nearest,r.uWrap=DT.ClampToEdge,r.vWrap=DT.ClampToEdge,n.push(r)}const i=new UT;return i.name=t,i.page=r,i.texture=e,i.index=-1,this.regions.push(i),i}addTextureHash(t,e){for(const n in t)t.hasOwnProperty(n)&&this.addTexture(e&&-1!==n.indexOf(".")?n.substr(0,n.lastIndexOf(".")):n,t[n])}addSpineAtlas(t,e,n){return this.load(t,e,n)}load(t,e,n){if(null==e)throw new Error("textureLoader cannot be null.");const r=new NT(t),i=new Array(4);let s=null;const o={};let a=null;o.size=()=>{s.width=parseInt(i[1]),s.height=parseInt(i[2])},o.format=()=>{},o.filter=()=>{s.minFilter=RT(i[1]),s.magFilter=RT(i[2])},o.repeat=()=>{-1!=i[1].indexOf("x")&&(s.uWrap=DT.Repeat),-1!=i[1].indexOf("y")&&(s.vWrap=DT.Repeat)},o.pma=()=>{s.pma="true"==i[1]};const l={xy:()=>{a.x=parseInt(i[1]),a.y=parseInt(i[2])},size:()=>{a.width=parseInt(i[1]),a.height=parseInt(i[2])},bounds:()=>{a.x=parseInt(i[1]),a.y=parseInt(i[2]),a.width=parseInt(i[3]),a.height=parseInt(i[4])},offset:()=>{a.offsetX=parseInt(i[1]),a.offsetY=parseInt(i[2])},orig:()=>{a.originalWidth=parseInt(i[1]),a.originalHeight=parseInt(i[2])},offsets:()=>{a.offsetX=parseInt(i[1]),a.offsetY=parseInt(i[2]),a.originalWidth=parseInt(i[3]),a.originalHeight=parseInt(i[4])},rotate:()=>{const t=i[1];let e=0;e="true"==t.toLocaleLowerCase()?6:"false"==t.toLocaleLowerCase()?0:(720-parseFloat(t))%360/45,a.rotate=e},index:()=>{a.index=parseInt(i[1])}};let c=r.readLine();for(;null!=c&&0==c.trim().length;)c=r.readLine();for(;null!=c&&0!=c.trim().length&&0!=r.readEntry(i,c);)c=r.readLine();const h=()=>{for(;;){if(null==c)return n&&n(this);if(0==c.trim().length)s=null,c=r.readLine();else{if(null===s){for(s=new WT,s.name=c.trim();0!=r.readEntry(i,c=r.readLine());){const t=o[i[0]];t&&t()}this.pages.push(s),e(s.name,t=>{if(null===t)return this.pages.splice(this.pages.indexOf(s),1),n&&n(null);s.baseTexture=t,s.pma&&(t.alphaMode=N.PMA),t.valid||t.setSize(s.width,s.height),s.setFilters(),s.width&&s.height||(s.width=t.realWidth,s.height=t.realHeight,s.width&&s.height||console.log(`ERROR spine atlas page ${s.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),h()});break}{a=new FT;const t=new UT;t.name=c,t.page=s;let e=null,n=null;for(;;){const t=r.readEntry(i,c=r.readLine());if(0==t)break;const s=l[i[0]];if(s)s();else{null==e&&(e=[],n=[]),e.push(i[0]);const r=[];for(let e=0;e<t;e++)r.push(parseInt(i[e+1]));n.push(r)}}0==a.originalWidth&&0==a.originalHeight&&(a.originalWidth=a.width,a.originalHeight=a.height);const o=s.baseTexture.resolution;a.x/=o,a.y/=o,a.width/=o,a.height/=o,a.originalWidth/=o,a.originalHeight/=o,a.offsetX/=o,a.offsetY/=o;const h=a.rotate%4!=0,u=new qe(a.x,a.y,h?a.height:a.width,h?a.width:a.height),d=new qe(0,0,a.originalWidth,a.originalHeight),p=new qe(a.offsetX,a.originalHeight-a.height-a.offsetY,a.width,a.height);t.texture=new Kn(t.page.baseTexture,u,d,p,a.rotate),t.index=a.index,t.texture.updateUvs(),this.regions.push(t)}}}};h()}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}dispose(){for(let t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()}}class NT{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(null==e)return 0;if(0==(e=e.trim()).length)return 0;const n=e.indexOf(":");if(-1==n)return 0;t[0]=e.substr(0,n).trim();for(let r=1,i=n+1;;r++){const n=e.indexOf(",",i);if(-1==n)return t[r]=e.substr(i).trim(),r;if(t[r]=e.substr(i,n-i).trim(),i=n+1,4==r)return 4}}}class WT{constructor(){this.minFilter=OT.Nearest,this.magFilter=OT.Nearest,this.uWrap=DT.ClampToEdge,this.vWrap=DT.ClampToEdge}setFilters(){const t=this.baseTexture,e=this.minFilter;e==OT.Linear?t.scaleMode=L.LINEAR:this.minFilter==OT.Nearest?t.scaleMode=L.NEAREST:(t.mipmap=B.POW2,e==OT.MipMapNearestNearest?t.scaleMode=L.NEAREST:t.scaleMode=L.LINEAR)}}class UT extends LT{}class jT{constructor(){this.entries={},this.size=0}add(t){const e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}addAll(t){const e=this.size;for(let e=0,n=t.length;e<n;e++)this.add(t[e]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const HT=class{constructor(t=0,e=0,n=0,r=0){this.r=t,this.g=e,this.b=n,this.a=r}set(t,e,n,r){return this.r=t,this.g=e,this.b=n,this.a=r,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=8!=t.length?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,n,r){return this.r+=t,this.g+=e,this.b+=n,this.a+=r,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}static rgb888ToColor(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}static fromString(t){return(new HT).setFromString(t)}};let zT=HT;zT.WHITE=new HT(1,1,1,1),zT.RED=new HT(1,0,0,1),zT.GREEN=new HT(0,1,0,1),zT.BLUE=new HT(0,0,1,1),zT.MAGENTA=new HT(1,0,1,1);const GT=class{static clamp(t,e,n){return t<e?e:t>n?n:t}static cosDeg(t){return Math.cos(t*GT.degRad)}static sinDeg(t){return Math.sin(t*GT.degRad)}static signum(t){return Math.sign(t)}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){const e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}static randomTriangular(t,e){return GT.randomTriangularWith(t,e,.5*(t+e))}static randomTriangularWith(t,e,n){const r=Math.random(),i=e-t;return r<=(n-t)/i?t+Math.sqrt(r*i*(n-t)):e-Math.sqrt((1-r)*i*(e-n))}static isPowerOfTwo(t){return t&&!(t&t-1)}};let XT=GT;XT.PI=3.1415927,XT.PI2=2*GT.PI,XT.radiansToDegrees=180/GT.PI,XT.radDeg=GT.radiansToDegrees,XT.degreesToRadians=GT.PI/180,XT.degRad=GT.degreesToRadians;const VT=class{static arrayCopy(t,e,n,r,i){for(let s=e,o=r;s<e+i;s++,o++)n[o]=t[s]}static arrayFill(t,e,n,r){for(let i=e;i<n;i++)t[i]=r}static setArraySize(t,e,n=0){const r=t.length;if(r==e)return t;if(t.length=e,r<e)for(let i=r;i<e;i++)t[i]=n;return t}static ensureArrayCapacity(t,e,n=0){return t.length>=e?t:VT.setArraySize(t,e,n)}static newArray(t,e){const n=new Array(t);for(let r=0;r<t;r++)n[r]=e;return n}static newFloatArray(t){if(VT.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);const e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}static newShortArray(t){if(VT.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);const e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}static toFloatArray(t){return VT.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return VT.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e,n=!0){for(let n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}};let YT=VT;YT.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array;class $T{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class qT{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){const t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}}const KT=[0,0,0];class ZT extends ki{constructor(){super(...arguments),this.region=null,this.attachment=null}}class QT extends ta{constructor(t,e,n,r,i){super(t,e,n,r,i),this.region=null,this.attachment=null}}const JT=class extends Ti{constructor(t){if(super(),!t)throw new Error("The spineData param is required.");if("string"==typeof t)throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=t,this.createSkeleton(t),this.slotContainers=[],this.tempClipContainers=[];for(let t=0,e=this.skeleton.slots.length;t<e;t++){const e=this.skeleton.slots[t],n=e.getAttachment(),r=this.newContainer();if(this.slotContainers.push(r),this.addChild(r),this.tempClipContainers.push(null),n)if(n.type===ST.Region){const t=n.name,i=this.createSprite(e,n,t);e.currentSprite=i,e.currentSpriteName=t,r.addChild(i)}else if(n.type===ST.Mesh){const t=this.createMesh(e,n);e.currentMesh=t,e.currentMeshId=n.id,e.currentMeshName=n.name,r.addChild(t)}else n.type===ST.Clipping&&(this.createGraphics(e,n),r.addChild(e.clippingContainer),r.addChild(e.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(t){t!=this._debug&&(this._debug?.unregisterSpine(this),t?.registerSpine(this),this._debug=t)}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this.updateTransform=t?JT.prototype.autoUpdateTransform:Ti.prototype.updateTransform)}get tint(){return Zt(this.tintRgb)}set tint(t){this.tintRgb=Kt(t,this.tintRgb)}get delayLimit(){return(void 0!==this.localDelayLimit?this.localDelayLimit:0)||Number.MAX_VALUE}update(t){const e=this.delayLimit;if(t>e&&(t=e),this.state.update(t),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();const n=this.skeleton.slots,r=this.color;let i=null,s=null;r?(i=r.light,s=r.dark):i=this.tintRgb;for(let t=0,e=n.length;t<e;t++){const e=n[t],r=e.getAttachment(),o=this.slotContainers[t];if(!r){o.visible=!1;continue}let a=null;r.sequence&&r.sequence.apply(e,r);let l=r.region;const c=r.color;switch(null!=r&&r.type){case ST.Region:if(o.transform.setFromMatrix(e.bone.matrix),l=r.region,e.currentMesh&&(e.currentMesh.visible=!1,e.currentMesh=null,e.currentMeshId=void 0,e.currentMeshName=void 0),!l){e.currentSprite&&(e.currentSprite.renderable=!1);break}if(!e.currentSpriteName||e.currentSpriteName!==r.name){const t=r.name;if(e.currentSprite&&(e.currentSprite.visible=!1),e.sprites=e.sprites||{},void 0!==e.sprites[t])e.sprites[t].visible=!0;else{const n=this.createSprite(e,r,t);o.addChild(n)}e.currentSprite=e.sprites[t],e.currentSpriteName=t}e.currentSprite.renderable=!0,e.hackRegion||this.setSpriteRegion(r,e.currentSprite,l),e.currentSprite.color?a=e.currentSprite.color:(KT[0]=i[0]*e.color.r*c.r,KT[1]=i[1]*e.color.g*c.g,KT[2]=i[2]*e.color.b*c.b,e.currentSprite.tint=Zt(KT)),e.currentSprite.blendMode=e.blendMode;break;case ST.Mesh:if(e.currentSprite){e.currentSprite.visible=!1,e.currentSprite=null,e.currentSpriteName=void 0;const t=new dn;t._parentID=-1,t._worldID=o.transform._worldID,o.transform=t}if(!l){e.currentMesh&&(e.currentMesh.renderable=!1);break}const t=r.id;if(void 0===e.currentMeshId||e.currentMeshId!==t){const n=t;if(e.currentMesh&&(e.currentMesh.visible=!1),e.meshes=e.meshes||{},void 0!==e.meshes[n])e.meshes[n].visible=!0;else{const t=this.createMesh(e,r);o.addChild(t)}e.currentMesh=e.meshes[n],e.currentMeshName=r.name,e.currentMeshId=n}e.currentMesh.renderable=!0,r.computeWorldVerticesOld(e,e.currentMesh.vertices),e.currentMesh.color?a=e.currentMesh.color:(KT[0]=i[0]*e.color.r*c.r,KT[1]=i[1]*e.color.g*c.g,KT[2]=i[2]*e.color.b*c.b,e.currentMesh.tint=Zt(KT)),e.currentMesh.blendMode=e.blendMode,e.hackRegion||this.setMeshRegion(r,e.currentMesh,l);break;case ST.Clipping:e.currentGraphics||(this.createGraphics(e,r),o.addChild(e.clippingContainer),o.addChild(e.currentGraphics)),this.updateGraphics(e,r),o.alpha=1,o.visible=!0;continue;default:o.visible=!1;continue}if(o.visible=!0,a){let t=e.color.r*c.r,n=e.color.g*c.g,r=e.color.b*c.b;a.setLight(i[0]*t+s[0]*(1-t),i[1]*n+s[1]*(1-n),i[2]*r+s[2]*(1-r)),e.darkColor?(t=e.darkColor.r,n=e.darkColor.g,r=e.darkColor.b):(t=0,n=0,r=0),a.setDark(i[0]*t+s[0]*(1-t),i[1]*n+s[1]*(1-n),i[2]*r+s[2]*(1-r))}o.alpha=e.color.a}const o=this.skeleton.drawOrder;let a=null,l=null;for(let t=0,e=o.length;t<e;t++){const e=n[o[t].data.index],r=this.slotContainers[o[t].data.index];if(l||null!==r.parent&&r.parent!==this&&(r.parent.removeChild(r),r.parent=this),e.currentGraphics&&e.getAttachment())l=e.clippingContainer,a=e.getAttachment(),l.children.length=0,this.children[t]=r,a.endSlot===e.data&&(a.endSlot=null);else if(l){let n=this.tempClipContainers[t];n||(n=this.tempClipContainers[t]=this.newContainer(),n.visible=!1),this.children[t]=n,r.parent=null,l.addChild(r),a.endSlot==e.data&&(l.renderable=!0,l=null,a=null)}else this.children[t]=r}this._debug?.renderDebug(this)}setSpriteRegion(t,e,n){e.attachment===t&&e.region===n||(e.region=n,e.attachment=t,e.texture=n.texture,e.rotation=t.rotation*XT.degRad,e.position.x=t.x,e.position.y=t.y,e.alpha=t.color.a,n.size?(e.scale.x=n.size.width/n.originalWidth,e.scale.y=-n.size.height/n.originalHeight):(e.scale.x=t.scaleX*t.width/n.originalWidth,e.scale.y=-t.scaleY*t.height/n.originalHeight))}setMeshRegion(t,e,n){e.attachment===t&&e.region===n||(e.region=n,e.attachment=t,e.texture=n.texture,n.texture.updateUvs(),e.uvBuffer.update(t.regionUVs))}autoUpdateTransform(){{this.lastTime=this.lastTime||Date.now();const t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(t)}Ti.prototype.updateTransform.call(this)}createSprite(t,e,n){let r=e.region;t.hackAttachment===e&&(r=t.hackRegion);const i=r?r.texture:null,s=this.newSprite(i);return s.anchor.set(.5),r&&this.setSpriteRegion(e,s,e.region),t.sprites=t.sprites||{},t.sprites[n]=s,s}createMesh(t,e){!e.region&&e.sequence&&e.sequence.apply(t,e);let n=e.region;t.hackAttachment===e&&(n=t.hackRegion,t.hackAttachment=null,t.hackRegion=null);const r=this.newMesh(n?n.texture:null,new Float32Array(e.regionUVs.length),e.regionUVs,new Uint16Array(e.triangles),P.TRIANGLES);return void 0!==r._canvasPadding&&(r._canvasPadding=1.5),r.alpha=e.color.a,r.region=e.region,n&&this.setMeshRegion(e,r,n),t.meshes=t.meshes||{},t.meshes[e.id]=r,r}createGraphics(t,e){const n=this.newGraphics(),r=new Qe([]);return n.clear(),n.beginFill(16777215,1),n.drawPolygon(r),n.renderable=!1,t.currentGraphics=n,t.clippingContainer=this.newContainer(),t.clippingContainer.mask=t.currentGraphics,n}updateGraphics(t,e){const n=t.currentGraphics.geometry,r=n.graphicsData[0].shape.points,i=e.worldVerticesLength;r.length=i,e.computeWorldVertices(t,0,i,r,0,2),n.invalidate()}hackTextureBySlotIndex(t,e=null,n=null){const r=this.skeleton.slots[t];if(!r)return!1;const i=r.getAttachment();let s=i.region;return e?(s=new LT,s.texture=e,s.size=n,r.hackRegion=s,r.hackAttachment=i):(r.hackRegion=null,r.hackAttachment=null),r.currentSprite?this.setSpriteRegion(i,r.currentSprite,s):r.currentMesh&&this.setMeshRegion(i,r.currentMesh,s),!0}hackTextureBySlotName(t,e=null,n=null){const r=this.skeleton.findSlotIndex(t);return-1!=r&&this.hackTextureBySlotIndex(r,e,n)}hackTextureAttachment(t,e,n,r=null){const i=this.skeleton.findSlotIndex(t),s=this.skeleton.getAttachmentByName(t,e);s.region.texture=n;const o=this.skeleton.slots[i];if(!o)return!1;const a=o.getAttachment();if(e===a.name){let t=s.region;return n?(t=new LT,t.texture=n,t.size=r,o.hackRegion=t,o.hackAttachment=a):(o.hackRegion=null,o.hackAttachment=null),o.currentSprite&&o.currentSprite.region!=t?(this.setSpriteRegion(a,o.currentSprite,t),o.currentSprite.region=t):o.currentMesh&&o.currentMesh.region!=t&&this.setMeshRegion(a,o.currentMesh,t),!0}return!1}newContainer(){return new Ti}newSprite(t){return new ZT(t)}newGraphics(){return new Vo}newMesh(t,e,n,r,i){return new QT(t,e,n,r,i)}transformHack(){return 1}hackAttachmentGroups(t,e,n){if(!t)return;const r=[],i=[];for(let s=0,o=this.skeleton.slots.length;s<o;s++){const o=this.skeleton.slots[s],a=o.currentSpriteName||o.currentMeshName||"",l=o.currentSprite||o.currentMesh;a.endsWith(t)?(l.parentGroup=e,i.push(l)):n&&l&&(l.parentGroup=n,r.push(l))}return[r,i]}destroy(t){this.debug=null;for(let e=0,n=this.skeleton.slots.length;e<n;e++){const n=this.skeleton.slots[e];for(const e in n.meshes)n.meshes[e].destroy(t);n.meshes=null;for(const e in n.sprites)n.sprites[e].destroy(t);n.sprites=null}for(let e=0,n=this.slotContainers.length;e<n;e++)this.slotContainers[e].destroy(t);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(t)}};let tS=JT;tS.clippingPolygon=[],Object.defineProperty(tS.prototype,"visible",{get(){return this._visible},set(t){t!==this._visible&&(this._visible=t,t&&(this.lastTime=0))}});const eS={extension:ve.Asset,loader:{extension:{type:ve.LoadParser,priority:ss.Normal},test(t){return ts(t,".atlas")},async load(t){const e=await V.ADAPTER.fetch(t);return await e.text()},testParse(t,e){const n=ts(e.src,".atlas"),r="string"==typeof t;return Promise.resolve(n&&r)},async parse(t,e,n){const r=e.data;let i=vt.dirname(e.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let s=null,o=null;const a=new Promise((t,e)=>{s=t,o=e});let l;const c=t=>{t||o("Something went terribly wrong loading a spine .atlas file\nMost likely your texture failed to load."),s(l)};if(r.image||r.images){const e=Object.assign(r.image?{default:r.image}:{},r.images);l=new BT(t,(t,n)=>{const r=e[t]||e.default;r&&r.baseTexture?n(r.baseTexture):n(r)},c)}else l=new BT(t,nS(n,i,r.imageMetadata),c);return await a},unload(t){t.dispose()}}},nS=(t,e,n)=>async(r,i)=>{try{const s=vt.normalize([...e.split(vt.sep),r].join(vt.sep));i((await t.load({src:s,data:n})).baseTexture)}catch(t){console.error("Spine: error in texture loader",t),i(null)}};function rS(t){return t.hasOwnProperty("bones")}we.add(eS);class iS{constructor(){}installLoader(){const t=this,e={extension:ve.Asset,loader:{extension:{type:ve.LoadParser,priority:ss.Normal},test(t){return ts(t,".skel")},async load(t){const e=await V.ADAPTER.fetch(t);return await e.arrayBuffer()},testParse(t,e){const n=ts(e.src,".json")&&rS(t),r=ts(e.src,".skel")&&t instanceof ArrayBuffer,i=!1===e.data?.spineAtlas;return Promise.resolve(n&&!i||r)},async parse(e,n,r){const i=vt.extname(n.src).toLowerCase(),s=vt.basename(n.src,i);let o=vt.dirname(n.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a=null,l=e;ts(n.src,".json")&&rS(e)?a=t.createJsonParser():(a=t.createBinaryParser(),l=new Uint8Array(e));const c=n.data||{},h=c?.spineSkeletonScale??null;h&&(a.scale=h);const u=c.spineAtlas;if(u&&u.pages)return t.parseData(a,u,l);const d=c.atlasRawData;if(d){let e=null,n=null;const i=new Promise((t,r)=>{e=t,n=r}),s=new BT(d,nS(r,o,c.imageMetadata),t=>{t||n("Something went terribly wrong loading a spine .atlas file\nMost likely your texture failed to load."),e(s)}),h=await i;return t.parseData(a,h,l)}let p=c.spineAtlasFile;p||(p=`${o+s}.atlas`);const f=await r.load({src:p,data:c,alias:c.spineAtlasAlias});return t.parseData(a,f,l)}}};return we.add(e),e}}class sS{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}}const oS=class extends sS{constructor(t){super(t),this.id=oS.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,n,r,i,s){n=i+(n>>1)*s;const o=t.bone.skeleton,a=t.deform;let l=this.vertices;const c=this.bones;if(!c){a.length>0&&(l=a);const o=t.bone.matrix,c=o.tx,h=o.ty,u=o.a,d=o.c,p=o.b,f=o.d;for(let t=e,o=i;o<n;t+=2,o+=s){const e=l[t],n=l[t+1];r[o]=e*u+n*d+c,r[o+1]=e*p+n*f+h}return}let h=0,u=0;for(let t=0;t<e;t+=2){const t=c[h];h+=t+1,u+=t}const d=o.bones;if(0==a.length)for(let t=i,e=3*u;t<n;t+=s){let n=0,i=0,s=c[h++];for(s+=h;h<s;h++,e+=3){const t=d[c[h]].matrix,r=l[e],s=l[e+1],o=l[e+2];n+=(r*t.a+s*t.c+t.tx)*o,i+=(r*t.b+s*t.d+t.ty)*o}r[t]=n,r[t+1]=i}else{const t=a;for(let e=i,o=3*u,a=u<<1;e<n;e+=s){let n=0,i=0,s=c[h++];for(s+=h;h<s;h++,o+=3,a+=2){const e=d[c[h]].matrix,r=l[o]+t[a],s=l[o+1]+t[a+1],u=l[o+2];n+=(r*e.a+s*e.c+e.tx)*u,i+=(r*e.b+s*e.d+e.ty)*u}r[e]=n,r[e+1]=i}}}copyTo(t){this.bones?(t.bones=new Array(this.bones.length),YT.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=YT.newFloatArray(this.vertices.length),YT.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttachment=this.timelineAttachment}};let aS=oS;aS.nextID=0;class lS extends aS{constructor(t){super(t),this.type=ST.BoundingBox,this.color=new zT(1,1,1,1)}copy(){const t=new lS(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class cS extends aS{constructor(t){super(t),this.type=ST.Clipping,this.endSlot=null,this.color=new zT(.2275,.2275,.8078,1)}copy(){const t=new cS(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class hS extends aS{constructor(t,e){super(t),this.type=ST.Mesh,this.region=null,this.triangles=[],this.color=new zT(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new zT(0,0,0,0),this.path=e}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();const t=new hS(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),YT.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),YT.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),YT.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,n,r,i,s){null!=this.sequence&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,n,r,i,s)}newLinkedMesh(){const t=new hS(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t}}class uS extends aS{constructor(t){super(t),this.type=ST.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new zT(1,1,1,1)}copy(){const t=new uS(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),YT.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class dS extends aS{constructor(t){super(t),this.type=ST.Point,this.x=0,this.y=0,this.rotation=0,this.color=new zT(.38,.94,0,1)}computeWorldPosition(t,e){const n=t.matrix;return e.x=this.x*n.a+this.y*n.c+t.worldX,e.y=this.x*n.b+this.y*n.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,n=XT.cosDeg(this.rotation),r=XT.sinDeg(this.rotation),i=n*e.a+r*e.c,s=n*e.b+r*e.d;return Math.atan2(s,i)*XT.radDeg}copy(){const t=new dS(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const pS=class extends sS{constructor(t,e){super(t),this.type=ST.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new zT(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=YT.newFloatArray(8),this.uvs=YT.newFloatArray(8),this.tempColor=new zT(1,1,1,1),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");const t=this.region,e=this.width/this.region.originalWidth*this.scaleX,n=this.height/this.region.originalHeight*this.scaleY,r=-this.width/2*this.scaleX+this.region.offsetX*e,i=-this.height/2*this.scaleY+this.region.offsetY*n,s=r+this.region.width*e,o=i+this.region.height*n,a=this.rotation*Math.PI/180,l=Math.cos(a),c=Math.sin(a),h=this.x,u=this.y,d=r*l+h,p=r*c,f=i*l+u,m=i*c,g=s*l+h,v=s*c,y=o*l+u,x=o*c,w=this.offset;w[0]=d-m,w[1]=f+p,w[2]=d-x,w[3]=y+p,w[4]=g-x,w[5]=y+v,w[6]=g-m,w[7]=f+v;const _=this.uvs;90==t.degrees?(_[2]=t.u,_[3]=t.v2,_[4]=t.u,_[5]=t.v,_[6]=t.u2,_[7]=t.v,_[0]=t.u2,_[1]=t.v2):(_[0]=t.u,_[1]=t.v2,_[2]=t.u,_[3]=t.v,_[4]=t.u2,_[5]=t.v,_[6]=t.u2,_[7]=t.v2)}computeWorldVertices(t,e,n,r){null!=this.sequence&&this.sequence.apply(t,this);const i=t.bone,s=this.offset,o=i.matrix,a=o.tx,l=o.ty,c=o.a,h=o.c,u=o.b,d=o.d;let p=0,f=0;p=s[0],f=s[1],e[n]=p*c+f*h+a,e[n+1]=p*u+f*d+l,n+=r,p=s[2],f=s[3],e[n]=p*c+f*h+a,e[n+1]=p*u+f*d+l,n+=r,p=s[4],f=s[5],e[n]=p*c+f*h+a,e[n+1]=p*u+f*d+l,n+=r,p=s[6],f=s[7],e[n]=p*c+f*h+a,e[n+1]=p*u+f*d+l}copy(){const t=new pS(this.name,this.path);return t.region=this.region,t.rendererObject=this.rendererObject,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,YT.arrayCopy(this.uvs,0,t.uvs,0,8),YT.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t.sequence=null!=this.sequence?this.sequence.copy():null,t}};let fS=pS;fS.X1=0,fS.Y1=1,fS.C1R=2,fS.C1G=3,fS.C1B=4,fS.C1A=5,fS.U1=6,fS.V1=7,fS.X2=8,fS.Y2=9,fS.C2R=10,fS.C2G=11,fS.C2B=12,fS.C2A=13,fS.U2=14,fS.V2=15,fS.X3=16,fS.Y3=17,fS.C3R=18,fS.C3G=19,fS.C3B=20,fS.C3A=21,fS.U3=22,fS.V3=23,fS.X4=24,fS.Y4=25,fS.C4R=26,fS.C4G=27,fS.C4B=28,fS.C4A=29,fS.U4=30,fS.V4=31;const mS=class{constructor(t){this.id=mS.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(t)}copy(){const t=new mS(this.regions.length);return YT.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t}apply(t,e){let n=t.sequenceIndex;-1==n&&(n=this.setupIndex),n>=this.regions.length&&(n=this.regions.length-1);const r=this.regions[n];e.region!=r&&(e.region=r)}getPath(t,e){let n=t;const r=(this.start+e).toString();for(let t=this.digits-r.length;t>0;t--)n+="0";return n+=r,n}static nextID(){return mS._nextID++}};let gS=mS;gS._nextID=0;var vS=(t=>(t[t.hold=0]="hold",t[t.once=1]="once",t[t.loop=2]="loop",t[t.pingpong=3]="pingpong",t[t.onceReverse=4]="onceReverse",t[t.loopReverse=5]="loopReverse",t[t.pingpongReverse=6]="pingpongReverse",t))(vS||{});const yS=[0,1,2,3,4,5,6];class xS{constructor(t,e,n){if(this.timelines=[],this.timelineIds=new jT,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=n}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(let e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,n,r,i,s,o,a){if(!t)throw new Error("skeleton cannot be null.");r&&0!=this.duration&&(n%=this.duration,e>0&&(e%=this.duration));const l=this.timelines;for(let r=0,c=l.length;r<c;r++)l[r].apply(t,e,n,i,s,o,a)}}class wS{constructor(t,e){this.propertyIds=e,this.frames=YT.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){const n=t.length;for(let r=1;r<n;r++)if(t[r]>e)return r-1;return n-1}static search(t,e,n){const r=t.length;for(let i=n;i<r;i+=n)if(t[i]>e)return i-n;return r-n}}class _S extends wS{constructor(t,e,n){super(t,n),this.curves=YT.newFloatArray(t+18*e),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){const e=this.getFrameCount()+18*t;if(this.curves.length>e){const t=YT.newFloatArray(e);YT.arrayCopy(this.curves,0,t,0,e),this.curves=t}}setBezier(t,e,n,r,i,s,o,a,l,c,h){const u=this.curves;let d=this.getFrameCount()+18*t;0==n&&(u[e]=2+d);const p=.03*(r-2*s+a),f=.03*(i-2*o+l),m=.006*(3*(s-a)-r+c),g=.006*(3*(o-l)-i+h);let v=2*p+m,y=2*f+g,x=.3*(s-r)+p+.16666667*m,w=.3*(o-i)+f+.16666667*g,_=r+x,b=i+w;for(let t=d+18;d<t;d+=2)u[d]=_,u[d+1]=b,x+=v,w+=y,v+=m,y+=g,_+=x,b+=w}getBezierValue(t,e,n,r){const i=this.curves;if(i[r]>t){const s=this.frames[e],o=this.frames[e+n];return o+(t-s)/(i[r]-s)*(i[r+1]-o)}const s=r+18;for(r+=2;r<s;r+=2)if(i[r]>=t){const e=i[r-2],n=i[r-1];return n+(t-e)/(i[r]-e)*(i[r+1]-n)}e+=this.getFrameEntries();const o=i[s-2],a=i[s-1];return a+(t-o)/(this.frames[e]-o)*(this.frames[e+n]-a)}}class bS extends _S{constructor(t,e,n){super(t,e,[n])}getFrameEntries(){return 2}setFrame(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+1]=n}getCurveValue(t){const e=this.frames;let n=e.length-2;for(let r=2;r<=n;r+=2)if(e[r]>t){n=r-2;break}const r=this.curves[n>>1];switch(r){case 0:const r=e[n],i=e[n+1];return i+(t-r)/(e[n+2]-r)*(e[n+2+1]-i);case 1:return e[n+1]}return this.getBezierValue(t,n,1,r-2)}}class AS extends _S{constructor(t,e,n,r){super(t,e,[n,r])}getFrameEntries(){return 3}setFrame(t,e,n,r){t*=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r}}class TS extends bS{constructor(t,e,n){super(t,e,`0|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case kT.setup:return void(a.rotation=a.data.rotation);case kT.first:a.rotation+=(a.data.rotation-a.rotation)*i}return}let l=this.getCurveValue(n);switch(s){case kT.setup:a.rotation=a.data.rotation+l*i;break;case kT.first:case kT.replace:l+=a.data.rotation-a.rotation;case kT.add:a.rotation+=l*i}}}class SS extends AS{constructor(t,e,n){super(t,e,`1|${n}`,`2|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case kT.setup:return a.x=a.data.x,void(a.y=a.data.y);case kT.first:a.x+=(a.data.x-a.x)*i,a.y+=(a.data.y-a.y)*i}return}let c=0,h=0;const u=wS.search(l,n,3),d=this.curves[u/3];switch(d){case 0:const t=l[u];c=l[u+1],h=l[u+2];const e=(n-t)/(l[u+3]-t);c+=(l[u+3+1]-c)*e,h+=(l[u+3+2]-h)*e;break;case 1:c=l[u+1],h=l[u+2];break;default:c=this.getBezierValue(n,u,1,d-2),h=this.getBezierValue(n,u,2,d+18-2)}switch(s){case kT.setup:a.x=a.data.x+c*i,a.y=a.data.y+h*i;break;case kT.first:case kT.replace:a.x+=(a.data.x+c-a.x)*i,a.y+=(a.data.y+h-a.y)*i;break;case kT.add:a.x+=c*i,a.y+=h*i}}}class ES extends bS{constructor(t,e,n){super(t,e,`1|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case kT.setup:return void(a.x=a.data.x);case kT.first:a.x+=(a.data.x-a.x)*i}return}const l=this.getCurveValue(n);switch(s){case kT.setup:a.x=a.data.x+l*i;break;case kT.first:case kT.replace:a.x+=(a.data.x+l-a.x)*i;break;case kT.add:a.x+=l*i}}}class kS extends bS{constructor(t,e,n){super(t,e,`2|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case kT.setup:return void(a.y=a.data.y);case kT.first:a.y+=(a.data.y-a.y)*i}return}const l=this.getCurveValue(n);switch(s){case kT.setup:a.y=a.data.y+l*i;break;case kT.first:case kT.replace:a.y+=(a.data.y+l-a.y)*i;break;case kT.add:a.y+=l*i}}}class MS extends AS{constructor(t,e,n){super(t,e,`3|${n}`,`4|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case kT.setup:return a.scaleX=a.data.scaleX,void(a.scaleY=a.data.scaleY);case kT.first:a.scaleX+=(a.data.scaleX-a.scaleX)*i,a.scaleY+=(a.data.scaleY-a.scaleY)*i}return}let c,h;const u=wS.search(l,n,3),d=this.curves[u/3];switch(d){case 0:const t=l[u];c=l[u+1],h=l[u+2];const e=(n-t)/(l[u+3]-t);c+=(l[u+3+1]-c)*e,h+=(l[u+3+2]-h)*e;break;case 1:c=l[u+1],h=l[u+2];break;default:c=this.getBezierValue(n,u,1,d-2),h=this.getBezierValue(n,u,2,d+18-2)}if(c*=a.data.scaleX,h*=a.data.scaleY,1==i)s==kT.add?(a.scaleX+=c-a.data.scaleX,a.scaleY+=h-a.data.scaleY):(a.scaleX=c,a.scaleY=h);else{let t=0,e=0;if(o==MT.mixOut)switch(s){case kT.setup:t=a.data.scaleX,e=a.data.scaleY,a.scaleX=t+(Math.abs(c)*XT.signum(t)-t)*i,a.scaleY=e+(Math.abs(h)*XT.signum(e)-e)*i;break;case kT.first:case kT.replace:t=a.scaleX,e=a.scaleY,a.scaleX=t+(Math.abs(c)*XT.signum(t)-t)*i,a.scaleY=e+(Math.abs(h)*XT.signum(e)-e)*i;break;case kT.add:a.scaleX+=(c-a.data.scaleX)*i,a.scaleY+=(h-a.data.scaleY)*i}else switch(s){case kT.setup:t=Math.abs(a.data.scaleX)*XT.signum(c),e=Math.abs(a.data.scaleY)*XT.signum(h),a.scaleX=t+(c-t)*i,a.scaleY=e+(h-e)*i;break;case kT.first:case kT.replace:t=Math.abs(a.scaleX)*XT.signum(c),e=Math.abs(a.scaleY)*XT.signum(h),a.scaleX=t+(c-t)*i,a.scaleY=e+(h-e)*i;break;case kT.add:a.scaleX+=(c-a.data.scaleX)*i,a.scaleY+=(h-a.data.scaleY)*i}}}}class CS extends bS{constructor(t,e,n){super(t,e,`3|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case kT.setup:return void(a.scaleX=a.data.scaleX);case kT.first:a.scaleX+=(a.data.scaleX-a.scaleX)*i}return}const l=this.getCurveValue(n)*a.data.scaleX;if(1==i)s==kT.add?a.scaleX+=l-a.data.scaleX:a.scaleX=l;else{let t=0;if(o==MT.mixOut)switch(s){case kT.setup:t=a.data.scaleX,a.scaleX=t+(Math.abs(l)*XT.signum(t)-t)*i;break;case kT.first:case kT.replace:t=a.scaleX,a.scaleX=t+(Math.abs(l)*XT.signum(t)-t)*i;break;case kT.add:a.scaleX+=(l-a.data.scaleX)*i}else switch(s){case kT.setup:t=Math.abs(a.data.scaleX)*XT.signum(l),a.scaleX=t+(l-t)*i;break;case kT.first:case kT.replace:t=Math.abs(a.scaleX)*XT.signum(l),a.scaleX=t+(l-t)*i;break;case kT.add:a.scaleX+=(l-a.data.scaleX)*i}}}}class PS extends bS{constructor(t,e,n){super(t,e,`4|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case kT.setup:return void(a.scaleY=a.data.scaleY);case kT.first:a.scaleY+=(a.data.scaleY-a.scaleY)*i}return}const l=this.getCurveValue(n)*a.data.scaleY;if(1==i)s==kT.add?a.scaleY+=l-a.data.scaleY:a.scaleY=l;else{let t=0;if(o==MT.mixOut)switch(s){case kT.setup:t=a.data.scaleY,a.scaleY=t+(Math.abs(l)*XT.signum(t)-t)*i;break;case kT.first:case kT.replace:t=a.scaleY,a.scaleY=t+(Math.abs(l)*XT.signum(t)-t)*i;break;case kT.add:a.scaleY+=(l-a.data.scaleY)*i}else switch(s){case kT.setup:t=Math.abs(a.data.scaleY)*XT.signum(l),a.scaleY=t+(l-t)*i;break;case kT.first:case kT.replace:t=Math.abs(a.scaleY)*XT.signum(l),a.scaleY=t+(l-t)*i;break;case kT.add:a.scaleY+=(l-a.data.scaleY)*i}}}}class IS extends AS{constructor(t,e,n){super(t,e,`5|${n}`,`6|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case kT.setup:return a.shearX=a.data.shearX,void(a.shearY=a.data.shearY);case kT.first:a.shearX+=(a.data.shearX-a.shearX)*i,a.shearY+=(a.data.shearY-a.shearY)*i}return}let c=0,h=0;const u=wS.search(l,n,3),d=this.curves[u/3];switch(d){case 0:const t=l[u];c=l[u+1],h=l[u+2];const e=(n-t)/(l[u+3]-t);c+=(l[u+3+1]-c)*e,h+=(l[u+3+2]-h)*e;break;case 1:c=l[u+1],h=l[u+2];break;default:c=this.getBezierValue(n,u,1,d-2),h=this.getBezierValue(n,u,2,d+18-2)}switch(s){case kT.setup:a.shearX=a.data.shearX+c*i,a.shearY=a.data.shearY+h*i;break;case kT.first:case kT.replace:a.shearX+=(a.data.shearX+c-a.shearX)*i,a.shearY+=(a.data.shearY+h-a.shearY)*i;break;case kT.add:a.shearX+=c*i,a.shearY+=h*i}}}class RS extends bS{constructor(t,e,n){super(t,e,`5|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case kT.setup:return void(a.shearX=a.data.shearX);case kT.first:a.shearX+=(a.data.shearX-a.shearX)*i}return}const l=this.getCurveValue(n);switch(s){case kT.setup:a.shearX=a.data.shearX+l*i;break;case kT.first:case kT.replace:a.shearX+=(a.data.shearX+l-a.shearX)*i;break;case kT.add:a.shearX+=l*i}}}class OS extends bS{constructor(t,e,n){super(t,e,`6|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case kT.setup:return void(a.shearY=a.data.shearY);case kT.first:a.shearY+=(a.data.shearY-a.shearY)*i}return}const l=this.getCurveValue(n);switch(s){case kT.setup:a.shearY=a.data.shearY+l*i;break;case kT.first:case kT.replace:a.shearY+=(a.data.shearY+l-a.shearY)*i;break;case kT.add:a.shearY+=l*i}}}class DS extends _S{constructor(t,e,n){super(t,e,[`7|${n}`,`8|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 5}setFrame(t,e,n,r,i,s){t*=5,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=s}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=this.frames,c=a.color;if(n<l[0]){const t=a.data.color;switch(s){case kT.setup:return void c.setFromColor(t);case kT.first:c.add((t.r-c.r)*i,(t.g-c.g)*i,(t.b-c.b)*i,(t.a-c.a)*i)}return}let h=0,u=0,d=0,p=0;const f=wS.search(l,n,5),m=this.curves[f/5];switch(m){case 0:const t=l[f];h=l[f+1],u=l[f+2],d=l[f+3],p=l[f+4];const e=(n-t)/(l[f+5]-t);h+=(l[f+5+1]-h)*e,u+=(l[f+5+2]-u)*e,d+=(l[f+5+3]-d)*e,p+=(l[f+5+4]-p)*e;break;case 1:h=l[f+1],u=l[f+2],d=l[f+3],p=l[f+4];break;default:h=this.getBezierValue(n,f,1,m-2),u=this.getBezierValue(n,f,2,m+18-2),d=this.getBezierValue(n,f,3,m+36-2),p=this.getBezierValue(n,f,4,m+54-2)}1==i?c.set(h,u,d,p):(s==kT.setup&&c.setFromColor(a.data.color),c.add((h-c.r)*i,(u-c.g)*i,(d-c.b)*i,(p-c.a)*i))}}class LS extends _S{constructor(t,e,n){super(t,e,[`7|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 4}setFrame(t,e,n,r,i){t<<=2,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=this.frames,c=a.color;if(n<l[0]){const t=a.data.color;switch(s){case kT.setup:return c.r=t.r,c.g=t.g,void(c.b=t.b);case kT.first:c.r+=(t.r-c.r)*i,c.g+=(t.g-c.g)*i,c.b+=(t.b-c.b)*i}return}let h=0,u=0,d=0;const p=wS.search(l,n,4),f=this.curves[p>>2];switch(f){case 0:const t=l[p];h=l[p+1],u=l[p+2],d=l[p+3];const e=(n-t)/(l[p+4]-t);h+=(l[p+4+1]-h)*e,u+=(l[p+4+2]-u)*e,d+=(l[p+4+3]-d)*e;break;case 1:h=l[p+1],u=l[p+2],d=l[p+3];break;default:h=this.getBezierValue(n,p,1,f-2),u=this.getBezierValue(n,p,2,f+18-2),d=this.getBezierValue(n,p,3,f+36-2)}if(1==i)c.r=h,c.g=u,c.b=d;else{if(s==kT.setup){const t=a.data.color;c.r=t.r,c.g=t.g,c.b=t.b}c.r+=(h-c.r)*i,c.g+=(u-c.g)*i,c.b+=(d-c.b)*i}}}class FS extends bS{constructor(t,e,n){super(t,e,`8|${n}`),this.slotIndex=0,this.slotIndex=n}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=a.color;if(n<this.frames[0]){const t=a.data.color;switch(s){case kT.setup:return void(l.a=t.a);case kT.first:l.a+=(t.a-l.a)*i}return}const c=this.getCurveValue(n);1==i?l.a=c:(s==kT.setup&&(l.a=a.data.color.a),l.a+=(c-l.a)*i)}}class BS extends _S{constructor(t,e,n){super(t,e,[`7|${n}`,`8|${n}`,`9|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 8}setFrame(t,e,n,r,i,s,o,a,l){t<<=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=s,this.frames[t+5]=o,this.frames[t+6]=a,this.frames[t+7]=l}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=this.frames,c=a.color,h=a.darkColor;if(n<l[0]){const t=a.data.color,e=a.data.darkColor;switch(s){case kT.setup:return c.setFromColor(t),h.r=e.r,h.g=e.g,void(h.b=e.b);case kT.first:c.add((t.r-c.r)*i,(t.g-c.g)*i,(t.b-c.b)*i,(t.a-c.a)*i),h.r+=(e.r-h.r)*i,h.g+=(e.g-h.g)*i,h.b+=(e.b-h.b)*i}return}let u=0,d=0,p=0,f=0,m=0,g=0,v=0;const y=wS.search(l,n,8),x=this.curves[y>>3];switch(x){case 0:const t=l[y];u=l[y+1],d=l[y+2],p=l[y+3],f=l[y+4],m=l[y+5],g=l[y+6],v=l[y+7];const e=(n-t)/(l[y+8]-t);u+=(l[y+8+1]-u)*e,d+=(l[y+8+2]-d)*e,p+=(l[y+8+3]-p)*e,f+=(l[y+8+4]-f)*e,m+=(l[y+8+5]-m)*e,g+=(l[y+8+6]-g)*e,v+=(l[y+8+7]-v)*e;break;case 1:u=l[y+1],d=l[y+2],p=l[y+3],f=l[y+4],m=l[y+5],g=l[y+6],v=l[y+7];break;default:u=this.getBezierValue(n,y,1,x-2),d=this.getBezierValue(n,y,2,x+18-2),p=this.getBezierValue(n,y,3,x+36-2),f=this.getBezierValue(n,y,4,x+54-2),m=this.getBezierValue(n,y,5,x+72-2),g=this.getBezierValue(n,y,6,x+90-2),v=this.getBezierValue(n,y,7,x+108-2)}if(1==i)c.set(u,d,p,f),h.r=m,h.g=g,h.b=v;else{if(s==kT.setup){c.setFromColor(a.data.color);const t=a.data.darkColor;h.r=t.r,h.g=t.g,h.b=t.b}c.add((u-c.r)*i,(d-c.g)*i,(p-c.b)*i,(f-c.a)*i),h.r+=(m-h.r)*i,h.g+=(g-h.g)*i,h.b+=(v-h.b)*i}}}class NS extends _S{constructor(t,e,n){super(t,e,[`7|${n}`,`9|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 7}setFrame(t,e,n,r,i,s,o,a){t*=7,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=s,this.frames[t+5]=o,this.frames[t+6]=a}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=this.frames,c=a.color,h=a.darkColor;if(n<l[0]){const t=a.data.color,e=a.data.darkColor;switch(s){case kT.setup:return c.r=t.r,c.g=t.g,c.b=t.b,h.r=e.r,h.g=e.g,void(h.b=e.b);case kT.first:c.r+=(t.r-c.r)*i,c.g+=(t.g-c.g)*i,c.b+=(t.b-c.b)*i,h.r+=(e.r-h.r)*i,h.g+=(e.g-h.g)*i,h.b+=(e.b-h.b)*i}return}let u=0,d=0,p=0,f=0,m=0,g=0;const v=wS.search(l,n,7),y=this.curves[v/7];switch(y){case 0:const t=l[v];u=l[v+1],d=l[v+2],p=l[v+3],f=l[v+4],m=l[v+5],g=l[v+6];const e=(n-t)/(l[v+7]-t);u+=(l[v+7+1]-u)*e,d+=(l[v+7+2]-d)*e,p+=(l[v+7+3]-p)*e,f+=(l[v+7+4]-f)*e,m+=(l[v+7+5]-m)*e,g+=(l[v+7+6]-g)*e;break;case 1:u=l[v+1],d=l[v+2],p=l[v+3],f=l[v+4],m=l[v+5],g=l[v+6];break;default:u=this.getBezierValue(n,v,1,y-2),d=this.getBezierValue(n,v,2,y+18-2),p=this.getBezierValue(n,v,3,y+36-2),f=this.getBezierValue(n,v,4,y+54-2),m=this.getBezierValue(n,v,5,y+72-2),g=this.getBezierValue(n,v,6,y+90-2)}if(1==i)c.r=u,c.g=d,c.b=p,h.r=f,h.g=m,h.b=g;else{if(s==kT.setup){const t=a.data.color,e=a.data.darkColor;c.r=t.r,c.g=t.g,c.b=t.b,h.r=e.r,h.g=e.g,h.b=e.b}c.r+=(u-c.r)*i,c.g+=(d-c.g)*i,c.b+=(p-c.b)*i,h.r+=(f-h.r)*i,h.g+=(m-h.g)*i,h.b+=(g-h.b)*i}}}class WS extends wS{constructor(t,e){super(t,[`10|${e}`]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];a.bone.active&&(o!=MT.mixOut?n<this.frames[0]?s!=kT.setup&&s!=kT.first||this.setAttachment(t,a,a.data.attachmentName):this.setAttachment(t,a,this.attachmentNames[wS.search1(this.frames,n)]):s==kT.setup&&this.setAttachment(t,a,a.data.attachmentName))}setAttachment(t,e,n){e.setAttachment(n?t.getAttachment(this.slotIndex,n):null)}}class US extends _S{constructor(t,e,n,r){super(t,e,[`11|${n}|${r.id}`]),this.slotIndex=0,this.slotIndex=n,this.attachment=r,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.vertices[t]=n}setBezier(t,e,n,r,i,s,o,a,l,c,h){const u=this.curves;let d=this.getFrameCount()+18*t;0==n&&(u[e]=2+d);const p=.03*(r-2*s+a),f=.03*l-.06*o,m=.006*(3*(s-a)-r+c),g=.018*(o-l+.33333333);let v=2*p+m,y=2*f+g,x=.3*(s-r)+p+.16666667*m,w=.3*o+f+.16666667*g,_=r+x,b=w;for(let t=d+18;d<t;d+=2)u[d]=_,u[d+1]=b,x+=v,w+=y,v+=m,y+=g,_+=x,b+=w}getCurvePercent(t,e){const n=this.curves;let r=n[e];switch(r){case 0:const n=this.frames[e];return(t-n)/(this.frames[e+this.getFrameEntries()]-n);case 1:return 0}if(r-=2,n[r]>t){const i=this.frames[e];return n[r+1]*(t-i)/(n[r]-i)}const i=r+18;for(r+=2;r<i;r+=2)if(n[r]>=t){const e=n[r-2],i=n[r-1];return i+(t-e)/(n[r]-e)*(n[r+1]-i)}const s=n[i-2],o=n[i-1];return o+(1-o)*(t-s)/(this.frames[e+this.getFrameEntries()]-s)}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=a.getAttachment();if(!l)return;if(!(l instanceof aS)||l.timelineAttachment!=this.attachment)return;const c=a.deform;0==c.length&&(s=kT.setup);const h=this.vertices,u=h[0].length,d=this.frames;if(n<d[0]){switch(s){case kT.setup:return void(c.length=0);case kT.first:if(1==i)return void(c.length=0);c.length=u;const t=l;if(t.bones){i=1-i;for(let t=0;t<u;t++)c[t]*=i}else{const e=t.vertices;for(let t=0;t<u;t++)c[t]+=(e[t]-c[t])*i}}return}if(c.length=u,n>=d[d.length-1]){const t=h[d.length-1];if(1==i)if(s==kT.add){const e=l;if(e.bones)for(let e=0;e<u;e++)c[e]+=t[e];else{const n=e.vertices;for(let e=0;e<u;e++)c[e]+=t[e]-n[e]}}else YT.arrayCopy(t,0,c,0,u);else switch(s){case kT.setup:{const e=l;if(e.bones)for(let e=0;e<u;e++)c[e]=t[e]*i;else{const n=e.vertices;for(let e=0;e<u;e++){const r=n[e];c[e]=r+(t[e]-r)*i}}break}case kT.first:case kT.replace:for(let e=0;e<u;e++)c[e]+=(t[e]-c[e])*i;break;case kT.add:const e=l;if(e.bones)for(let e=0;e<u;e++)c[e]+=t[e]*i;else{const n=e.vertices;for(let e=0;e<u;e++)c[e]+=(t[e]-n[e])*i}}return}const p=wS.search1(d,n),f=this.getCurvePercent(n,p),m=h[p],g=h[p+1];if(1==i)if(s==kT.add){const t=l;if(t.bones)for(let t=0;t<u;t++){const e=m[t];c[t]+=e+(g[t]-e)*f}else{const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];c[t]+=n+(g[t]-n)*f-e[t]}}}else for(let t=0;t<u;t++){const e=m[t];c[t]=e+(g[t]-e)*f}else switch(s){case kT.setup:{const t=l;if(t.bones)for(let t=0;t<u;t++){const e=m[t];c[t]=(e+(g[t]-e)*f)*i}else{const e=t.vertices;for(let t=0;t<u;t++){const n=m[t],r=e[t];c[t]=r+(n+(g[t]-n)*f-r)*i}}break}case kT.first:case kT.replace:for(let t=0;t<u;t++){const e=m[t];c[t]+=(e+(g[t]-e)*f-c[t])*i}break;case kT.add:const t=l;if(t.bones)for(let t=0;t<u;t++){const e=m[t];c[t]+=(e+(g[t]-e)*f)*i}else{const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];c[t]+=(n+(g[t]-n)*f-e[t])*i}}}}}const jS=class extends wS{constructor(t){super(t,jS.propertyIds),this.events=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,n,r,i,s,o){if(!r)return;const a=this.frames,l=this.frames.length;if(e>n)this.apply(t,e,Number.MAX_VALUE,r,i,s,o),e=-1;else if(e>=a[l-1])return;if(n<a[0])return;let c=0;if(e<a[0])c=0;else{c=wS.search1(a,e)+1;const t=a[c];for(;c>0&&a[c-1]==t;)c--}for(;c<l&&n>=a[c];c++)r.push(this.events[c])}};let HS=jS;HS.propertyIds=["12"];const zS=class extends wS{constructor(t){super(t,zS.propertyIds),this.drawOrders=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.drawOrders[t]=n}apply(t,e,n,r,i,s,o){if(o==MT.mixOut)return void(s==kT.setup&&YT.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));if(n<this.frames[0])return void(s!=kT.setup&&s!=kT.first||YT.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));const a=wS.search1(this.frames,n),l=this.drawOrders[a];if(l){const e=t.drawOrder,n=t.slots;for(let t=0,r=l.length;t<r;t++)e[t]=n[l[t]]}else YT.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length)}};let GS=zS;GS.propertyIds=["13"];class XS extends _S{constructor(t,e,n){super(t,e,[`14|${n}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=n}getFrameEntries(){return 6}setFrame(t,e,n,r,i,s,o){t*=6,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=s?1:0,this.frames[t+5]=o?1:0}apply(t,e,n,r,i,s,o){const a=t.ikConstraints[this.ikConstraintIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case kT.setup:return a.mix=a.data.mix,a.softness=a.data.softness,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,void(a.stretch=a.data.stretch);case kT.first:a.mix+=(a.data.mix-a.mix)*i,a.softness+=(a.data.softness-a.softness)*i,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}return}let c=0,h=0;const u=wS.search(l,n,6),d=this.curves[u/6];switch(d){case 0:const t=l[u];c=l[u+1],h=l[u+2];const e=(n-t)/(l[u+6]-t);c+=(l[u+6+1]-c)*e,h+=(l[u+6+2]-h)*e;break;case 1:c=l[u+1],h=l[u+2];break;default:c=this.getBezierValue(n,u,1,d-2),h=this.getBezierValue(n,u,2,d+18-2)}s==kT.setup?(a.mix=a.data.mix+(c-a.data.mix)*i,a.softness=a.data.softness+(h-a.data.softness)*i,o==MT.mixOut?(a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch):(a.bendDirection=l[u+3],a.compress=0!=l[u+4],a.stretch=0!=l[u+5])):(a.mix+=(c-a.mix)*i,a.softness+=(h-a.softness)*i,o==MT.mixIn&&(a.bendDirection=l[u+3],a.compress=0!=l[u+4],a.stretch=0!=l[u+5]))}}class VS extends _S{constructor(t,e,n){super(t,e,[`15|${n}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=n}getFrameEntries(){return 7}setFrame(t,e,n,r,i,s,o,a){const l=this.frames;l[t*=7]=e,l[t+1]=n,l[t+2]=r,l[t+3]=i,l[t+4]=s,l[t+5]=o,l[t+6]=a}apply(t,e,n,r,i,s,o){const a=t.transformConstraints[this.transformConstraintIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){const t=a.data;switch(s){case kT.setup:return a.mixRotate=t.mixRotate,a.mixX=t.mixX,a.mixY=t.mixY,a.mixScaleX=t.mixScaleX,a.mixScaleY=t.mixScaleY,void(a.mixShearY=t.mixShearY);case kT.first:a.mixRotate+=(t.mixRotate-a.mixRotate)*i,a.mixX+=(t.mixX-a.mixX)*i,a.mixY+=(t.mixY-a.mixY)*i,a.mixScaleX+=(t.mixScaleX-a.mixScaleX)*i,a.mixScaleY+=(t.mixScaleY-a.mixScaleY)*i,a.mixShearY+=(t.mixShearY-a.mixShearY)*i}return}let c,h,u,d,p,f;const m=wS.search(l,n,7),g=this.curves[m/7];switch(g){case 0:const t=l[m];c=l[m+1],h=l[m+2],u=l[m+3],d=l[m+4],p=l[m+5],f=l[m+6];const e=(n-t)/(l[m+7]-t);c+=(l[m+7+1]-c)*e,h+=(l[m+7+2]-h)*e,u+=(l[m+7+3]-u)*e,d+=(l[m+7+4]-d)*e,p+=(l[m+7+5]-p)*e,f+=(l[m+7+6]-f)*e;break;case 1:c=l[m+1],h=l[m+2],u=l[m+3],d=l[m+4],p=l[m+5],f=l[m+6];break;default:c=this.getBezierValue(n,m,1,g-2),h=this.getBezierValue(n,m,2,g+18-2),u=this.getBezierValue(n,m,3,g+36-2),d=this.getBezierValue(n,m,4,g+54-2),p=this.getBezierValue(n,m,5,g+72-2),f=this.getBezierValue(n,m,6,g+90-2)}if(s==kT.setup){const t=a.data;a.mixRotate=t.mixRotate+(c-t.mixRotate)*i,a.mixX=t.mixX+(h-t.mixX)*i,a.mixY=t.mixY+(u-t.mixY)*i,a.mixScaleX=t.mixScaleX+(d-t.mixScaleX)*i,a.mixScaleY=t.mixScaleY+(p-t.mixScaleY)*i,a.mixShearY=t.mixShearY+(f-t.mixShearY)*i}else a.mixRotate+=(c-a.mixRotate)*i,a.mixX+=(h-a.mixX)*i,a.mixY+=(u-a.mixY)*i,a.mixScaleX+=(d-a.mixScaleX)*i,a.mixScaleY+=(p-a.mixScaleY)*i,a.mixShearY+=(f-a.mixShearY)*i}}class YS extends bS{constructor(t,e,n){super(t,e,`16|${n}`),this.pathConstraintIndex=0,this.pathConstraintIndex=n}apply(t,e,n,r,i,s,o){const a=t.pathConstraints[this.pathConstraintIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case kT.setup:return void(a.position=a.data.position);case kT.first:a.position+=(a.data.position-a.position)*i}return}const l=this.getCurveValue(n);s==kT.setup?a.position=a.data.position+(l-a.data.position)*i:a.position+=(l-a.position)*i}}class $S extends bS{constructor(t,e,n){super(t,e,`17|${n}`),this.pathConstraintIndex=0,this.pathConstraintIndex=n}apply(t,e,n,r,i,s,o){const a=t.pathConstraints[this.pathConstraintIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case kT.setup:return void(a.spacing=a.data.spacing);case kT.first:a.spacing+=(a.data.spacing-a.spacing)*i}return}const l=this.getCurveValue(n);s==kT.setup?a.spacing=a.data.spacing+(l-a.data.spacing)*i:a.spacing+=(l-a.spacing)*i}}class qS extends _S{constructor(t,e,n){super(t,e,[`18|${n}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=n}getFrameEntries(){return 4}setFrame(t,e,n,r,i){const s=this.frames;s[t<<=2]=e,s[t+1]=n,s[t+2]=r,s[t+3]=i}apply(t,e,n,r,i,s,o){const a=t.pathConstraints[this.pathConstraintIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case kT.setup:return a.mixRotate=a.data.mixRotate,a.mixX=a.data.mixX,void(a.mixY=a.data.mixY);case kT.first:a.mixRotate+=(a.data.mixRotate-a.mixRotate)*i,a.mixX+=(a.data.mixX-a.mixX)*i,a.mixY+=(a.data.mixY-a.mixY)*i}return}let c,h,u;const d=wS.search(l,n,4),p=this.curves[d>>2];switch(p){case 0:const t=l[d];c=l[d+1],h=l[d+2],u=l[d+3];const e=(n-t)/(l[d+4]-t);c+=(l[d+4+1]-c)*e,h+=(l[d+4+2]-h)*e,u+=(l[d+4+3]-u)*e;break;case 1:c=l[d+1],h=l[d+2],u=l[d+3];break;default:c=this.getBezierValue(n,d,1,p-2),h=this.getBezierValue(n,d,2,p+18-2),u=this.getBezierValue(n,d,3,p+36-2)}if(s==kT.setup){const t=a.data;a.mixRotate=t.mixRotate+(c-t.mixRotate)*i,a.mixX=t.mixX+(h-t.mixX)*i,a.mixY=t.mixY+(u-t.mixY)*i}else a.mixRotate+=(c-a.mixRotate)*i,a.mixX+=(h-a.mixX)*i,a.mixY+=(u-a.mixY)*i}}const KS=class extends wS{constructor(t,e,n){super(t,[`19|${e}|${n.sequence.id}`]),this.slotIndex=e,this.attachment=n}getFrameEntries(){return KS.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(t,e,n,r,i){const s=this.frames;s[t*=KS.ENTRIES]=e,s[t+KS.MODE]=n|r<<4,s[t+KS.DELAY]=i}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=a.attachment,c=this.attachment;if(!(l==c||l instanceof aS&&l.timelineAttachment==c))return;const h=this.frames;if(n<h[0])return void(s!=kT.setup&&s!=kT.first||(a.sequenceIndex=-1));const u=wS.search(h,n,KS.ENTRIES),d=h[u],p=h[u+KS.MODE],f=h[u+KS.DELAY];if(!this.attachment.sequence)return;let m=p>>4;const g=this.attachment.sequence.regions.length,v=yS[15&p];if(v!=vS.hold)switch(m+=(n-d)/f+1e-5|0,v){case vS.once:m=Math.min(g-1,m);break;case vS.loop:m%=g;break;case vS.pingpong:{const t=(g<<1)-2;m=0==t?0:m%t,m>=g&&(m=t-m);break}case vS.onceReverse:m=Math.max(g-1-m,0);break;case vS.loopReverse:m=g-1-m%g;break;case vS.pingpongReverse:{const t=(g<<1)-2;m=0==t?0:(m+g-1)%t,m>=g&&(m=t-m)}}a.sequenceIndex=m}};let ZS=KS;ZS.ENTRIES=3,ZS.MODE=1,ZS.DELAY=2;const QS=class{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new nE(this),this.propertyIDs=new jT,this.animationsChanged=!1,this.trackEntryPool=new $T(()=>new eE),this.data=t}static emptyAnimation(){return QS._emptyAnimation}update(t){t*=this.timeScale;const e=this.tracks;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(!r)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let i=t*r.timeScale;if(r.delay>0){if(r.delay-=i,r.delay>0)continue;i=-r.delay,r.delay=0}let s=r.next;if(s){const e=r.trackLast-s.delay;if(e>=0){for(s.delay=0,s.trackTime+=0==r.timeScale?0:(e/r.timeScale+t)*s.timeScale,r.trackTime+=i,this.setCurrent(n,s,!0);s.mixingFrom;)s.mixTime+=t,s=s.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&!r.mixingFrom){e[n]=null,this.queue.end(r),this.clearNext(r);continue}if(r.mixingFrom&&this.updateMixingFrom(r,t)){let t=r.mixingFrom;for(r.mixingFrom=null,t&&(t.mixingTo=null);t;)this.queue.end(t),t=t.mixingFrom}r.trackTime+=i}this.queue.drain()}updateMixingFrom(t,e){const n=t.mixingFrom;if(!n)return!0;const r=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,n.mixingFrom&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),r):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)}apply(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,n=this.tracks;let r=!1;for(let i=0,s=n.length;i<s;i++){const s=n[i];if(!s||s.delay>0)continue;r=!0;const o=0==i?kT.first:s.mixBlend;let a=s.alpha;s.mixingFrom?a*=this.applyMixingFrom(s,t,o):s.trackTime>=s.trackEnd&&!s.next&&(a=0);const l=s.animationLast,c=s.getAnimationTime();let h=c,u=e;s.reverse&&(h=s.animation.duration-h,u=null);const d=s.animation.timelines,p=d.length;if(0==i&&1==a||o==kT.add)for(let e=0;e<p;e++){YT.webkit602BugfixHelper(a,o);const n=d[e];n instanceof WS?this.applyAttachmentTimeline(n,t,h,o,!0):n.apply(t,l,h,u,a,o,MT.mixIn)}else{const e=s.timelineMode,n=s.shortestRotation,r=!n&&s.timelinesRotation.length!=p<<1;r&&(s.timelinesRotation.length=p<<1);for(let i=0;i<p;i++){const c=d[i],p=e[i]==iE?o:kT.setup;!n&&c instanceof TS?this.applyRotateTimeline(c,t,h,a,p,s.timelinesRotation,i<<1,r):c instanceof WS?this.applyAttachmentTimeline(c,t,h,o,!0):(YT.webkit602BugfixHelper(a,o),c.apply(t,l,h,u,a,p,MT.mixIn))}}this.queueEvents(s,c),e.length=0,s.nextAnimationLast=c,s.nextTrackLast=s.trackTime}const i=this.unkeyedState+cE,s=t.slots;for(let e=0,n=t.slots.length;e<n;e++){const n=s[e];if(n.attachmentState==i){const e=n.data.attachmentName;n.setAttachment(e?t.getAttachment(n.data.index,e):null)}}return this.unkeyedState+=2,this.queue.drain(),r}applyMixingFrom(t,e,n){const r=t.mixingFrom;r.mixingFrom&&this.applyMixingFrom(r,e,n);let i=0;0==t.mixDuration?(i=1,n==kT.first&&(n=kT.setup)):(i=t.mixTime/t.mixDuration,i>1&&(i=1),n!=kT.first&&(n=r.mixBlend));const s=i<r.attachmentThreshold,o=i<r.drawOrderThreshold,a=r.animation.timelines,l=a.length,c=r.alpha*t.interruptAlpha,h=c*(1-i),u=r.animationLast,d=r.getAnimationTime();let p=d,f=null;if(r.reverse?p=r.animation.duration-p:i<r.eventThreshold&&(f=this.events),n==kT.add)for(let t=0;t<l;t++)a[t].apply(e,u,p,f,h,n,MT.mixOut);else{const t=r.timelineMode,i=r.timelineHoldMix,d=r.shortestRotation,m=!d&&r.timelinesRotation.length!=l<<1;m&&(r.timelinesRotation.length=l<<1),r.totalAlpha=0;for(let g=0;g<l;g++){const l=a[g];let v,y=MT.mixOut,x=0;switch(t[g]){case iE:if(!o&&l instanceof GS)continue;v=n,x=h;break;case sE:v=kT.setup,x=h;break;case oE:v=n,x=c;break;case aE:v=kT.setup,x=c;break;default:v=kT.setup;const t=i[g];x=c*Math.max(0,1-t.mixTime/t.mixDuration)}r.totalAlpha+=x,!d&&l instanceof TS?this.applyRotateTimeline(l,e,p,x,v,r.timelinesRotation,g<<1,m):l instanceof WS?this.applyAttachmentTimeline(l,e,p,v,s):(YT.webkit602BugfixHelper(x,n),o&&l instanceof GS&&v==kT.setup&&(y=MT.mixIn),l.apply(e,u,p,f,x,v,y))}}return t.mixDuration>0&&this.queueEvents(r,d),this.events.length=0,r.nextAnimationLast=d,r.nextTrackLast=r.trackTime,i}applyAttachmentTimeline(t,e,n,r,i){const s=e.slots[t.slotIndex];s.bone.active&&(n<t.frames[0]?r!=kT.setup&&r!=kT.first||this.setAttachment(e,s,s.data.attachmentName,i):this.setAttachment(e,s,t.attachmentNames[wS.search1(t.frames,n)],i),s.attachmentState<=this.unkeyedState&&(s.attachmentState=this.unkeyedState+cE))}setAttachment(t,e,n,r){e.setAttachment(n?t.getAttachment(e.data.index,n):null),r&&(e.attachmentState=this.unkeyedState+hE)}applyRotateTimeline(t,e,n,r,i,s,o,a){if(a&&(s[o]=0),1==r)return void t.apply(e,0,n,null,1,i,MT.mixIn);const l=e.bones[t.boneIndex];if(!l.active)return;let c=0,h=0;if(n<t.frames[0])switch(i){case kT.setup:l.rotation=l.data.rotation;default:return;case kT.first:c=l.rotation,h=l.data.rotation}else c=i==kT.setup?l.data.rotation:l.rotation,h=l.data.rotation+t.getCurveValue(n);let u=0,d=h-c;if(d-=360*(16384-(16384.499999999996-d/360|0)),0==d)u=s[o];else{let t=0,e=0;a?(t=0,e=d):(t=s[o],e=s[o+1]);const n=d>0;let r=t>=0;XT.signum(e)!=XT.signum(d)&&Math.abs(e)<=90&&(Math.abs(t)>180&&(t+=360*XT.signum(t)),r=n),u=d+t-t%360,r!=n&&(u+=360*XT.signum(t)),s[o]=u}s[o+1]=d,l.rotation=c+u*r}queueEvents(t,e){const n=t.animationStart,r=t.animationEnd,i=r-n,s=t.trackLast%i,o=this.events;let a=0;const l=o.length;for(;a<l;a++){const e=o[a];if(e.time<s)break;e.time>r||this.queue.event(t,e)}let c=!1;for(c=t.loop?0==i||s>t.trackTime%i:e>=r&&t.animationLast<r,c&&this.queue.complete(t);a<l;a++){const e=o[a];e.time<n||this.queue.event(t,e)}}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(!e)return;this.queue.end(e),this.clearNext(e);let n=e;for(;;){const t=n.mixingFrom;if(!t)break;this.queue.end(t),n.mixingFrom=null,n.mixingTo=null,n=t}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,n){const r=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,r&&(n&&this.queue.interrupt(r),e.mixingFrom=r,r.mixingTo=e,e.mixTime=0,r.mixingFrom&&r.mixDuration>0&&(e.interruptAlpha*=Math.min(1,r.mixTime/r.mixDuration)),r.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,n=!1){const r=this.data.skeletonData.findAnimation(e);if(!r)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,r,n)}setAnimationWith(t,e,n=!1){if(!e)throw new Error("animation cannot be null.");let r=!0,i=this.expandToIndex(t);i&&(-1==i.nextTrackLast?(this.tracks[t]=i.mixingFrom,this.queue.interrupt(i),this.queue.end(i),this.clearNext(i),i=i.mixingFrom,r=!1):this.clearNext(i));const s=this.trackEntry(t,e,n,i);return this.setCurrent(t,s,r),this.queue.drain(),s}addAnimation(t,e,n=!1,r=0){const i=this.data.skeletonData.findAnimation(e);if(!i)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,i,n,r)}addAnimationWith(t,e,n=!1,r=0){if(!e)throw new Error("animation cannot be null.");let i=this.expandToIndex(t);if(i)for(;i.next;)i=i.next;const s=this.trackEntry(t,e,n,i);return i?(i.next=s,s.previous=i,r<=0&&(r+=i.getTrackComplete()-s.mixDuration)):(this.setCurrent(t,s,!0),this.queue.drain()),s.delay=r,s}setEmptyAnimation(t,e=0){const n=this.setAnimationWith(t,QS.emptyAnimation(),!1);return n.mixDuration=e,n.trackEnd=e,n}addEmptyAnimation(t,e=0,n=0){const r=this.addAnimationWith(t,QS.emptyAnimation(),!1,n);return n<=0&&(r.delay+=r.mixDuration-e),r.mixDuration=e,r.trackEnd=e,r}setEmptyAnimations(t=0){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,n=this.tracks.length;e<n;e++){const n=this.tracks[e];n&&this.setEmptyAnimation(n.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(YT.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,n,r){const i=this.trackEntryPool.obtain();return i.reset(),i.trackIndex=t,i.animation=e,i.loop=n,i.holdPrevious=!1,i.reverse=!1,i.shortestRotation=!1,i.eventThreshold=0,i.attachmentThreshold=0,i.drawOrderThreshold=0,i.animationStart=0,i.animationEnd=e.duration,i.animationLast=-1,i.nextAnimationLast=-1,i.delay=0,i.trackTime=0,i.trackLast=-1,i.nextTrackLast=-1,i.trackEnd=Number.MAX_VALUE,i.timeScale=1,i.alpha=1,i.mixTime=0,i.mixDuration=r?this.data.getMix(r.animation,e):0,i.interruptAlpha=1,i.totalAlpha=0,i.mixBlend=kT.replace,i}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();const t=this.tracks;for(let e=0,n=t.length;e<n;e++){let n=t[e];if(n){for(;n.mixingFrom;)n=n.mixingFrom;do{n.mixingTo&&n.mixBlend==kT.add||this.computeHold(n),n=n.mixingTo}while(n)}}}computeHold(t){const e=t.mixingTo,n=t.animation.timelines,r=t.animation.timelines.length,i=t.timelineMode;i.length=r;const s=t.timelineHoldMix;s.length=0;const o=this.propertyIDs;if(e&&e.holdPrevious)for(let t=0;t<r;t++)i[t]=o.addAll(n[t].getPropertyIds())?aE:oE;else t:for(let a=0;a<r;a++){const r=n[a],l=r.getPropertyIds();if(o.addAll(l))if(!e||r instanceof WS||r instanceof GS||r instanceof HS||!e.animation.hasTimeline(l))i[a]=sE;else{for(let n=e.mixingTo;n;n=n.mixingTo)if(!n.animation.hasTimeline(l)){if(t.mixDuration>0){i[a]=lE,s[a]=n;continue t}break}i[a]=aE}else i[a]=iE}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,n){QS.deprecatedWarning1||(QS.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,n)}addAnimationByName(t,e,n,r){QS.deprecatedWarning2||(QS.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,n,r)}hasAnimation(t){return null!==this.data.skeletonData.findAnimation(t)}hasAnimationByName(t){return QS.deprecatedWarning3||(QS.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let JS=QS;JS._emptyAnimation=new xS("<empty>",[],0),JS.deprecatedWarning1=!1,JS.deprecatedWarning2=!1,JS.deprecatedWarning3=!1;const tE=class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=kT.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){const t=this.animationEnd-this.animationStart;if(0!=t){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}get time(){return tE.deprecatedWarning1||(tE.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){tE.deprecatedWarning1||(tE.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return tE.deprecatedWarning2||(tE.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){tE.deprecatedWarning2||(tE.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let eE=tE;eE.deprecatedWarning1=!1,eE.deprecatedWarning2=!1;class nE{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(rE.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(rE.interrupt),this.objects.push(t)}end(t){this.objects.push(rE.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(rE.dispose),this.objects.push(t)}complete(t){this.objects.push(rE.complete),this.objects.push(t)}event(t,e){this.objects.push(rE.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let n=0;n<t.length;n+=2){const r=t[n],i=t[n+1];switch(r){case rE.start:i.listener&&i.listener.start&&i.listener.start(i);for(let t=0;t<e.length;t++){const n=e[t];n.start&&n.start(i)}break;case rE.interrupt:i.listener&&i.listener.interrupt&&i.listener.interrupt(i);for(let t=0;t<e.length;t++){const n=e[t];n.interrupt&&n.interrupt(i)}break;case rE.end:i.listener&&i.listener.end&&i.listener.end(i);for(let t=0;t<e.length;t++){const n=e[t];n.end&&n.end(i)}case rE.dispose:i.listener&&i.listener.dispose&&i.listener.dispose(i);for(let t=0;t<e.length;t++){const n=e[t];n.dispose&&n.dispose(i)}this.animState.trackEntryPool.free(i);break;case rE.complete:i.listener&&i.listener.complete&&i.listener.complete(i);for(let t=0;t<e.length;t++){const n=e[t];n.complete&&n.complete(i)}break;case rE.event:const r=t[2+n++];i.listener&&i.listener.event&&i.listener.event(i,r);for(let t=0;t<e.length;t++){const n=e[t];n.event&&n.event(i,r)}}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var rE=(t=>(t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event",t))(rE||{});const iE=0,sE=1,oE=2,aE=3,lE=4,cE=1,hE=2;class uE{constructor(t){this.atlas=t}loadSequence(t,e,n){const r=n.regions;for(let i=0,s=r.length;i<s;i++){const s=n.getPath(e,i),o=this.atlas.findRegion(s);if(null==o)throw new Error(`Region not found in atlas: ${s} (sequence: ${t})`);r[i]=o,r[i].renderObject=r[i]}}newRegionAttachment(t,e,n,r){const i=new fS(e,n);if(null!=r)this.loadSequence(e,n,r);else{const t=this.atlas.findRegion(n);if(!t)throw new Error(`Region not found in atlas: ${n} (region attachment: ${e})`);t.renderObject=t,i.region=t}return i}newMeshAttachment(t,e,n,r){const i=new hS(e,n);if(null!=r)this.loadSequence(e,n,r);else{const t=this.atlas.findRegion(n);if(!t)throw new Error(`Region not found in atlas: ${n} (mesh attachment: ${e})`);t.renderObject=t,i.region=t}return i}newBoundingBoxAttachment(t,e){return new lS(e)}newPathAttachment(t,e){return new uS(e)}newPointAttachment(t,e){return new dS(e)}newClippingAttachment(t,e){return new cS(e)}}class dE{constructor(t,e,n){if(this.matrix=new tn,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,n,r,i,s,o){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=r,this.ascaleY=i,this.ashearX=s,this.ashearY=o;const a=this.parent,l=this.matrix,c=this.skeleton.scaleX,h=-this.skeleton.scaleY;if(!a){const a=this.skeleton,u=n+90+o;return l.a=XT.cosDeg(n+s)*r*c,l.c=XT.cosDeg(u)*i*c,l.b=XT.sinDeg(n+s)*r*h,l.d=XT.sinDeg(u)*i*h,l.tx=t*c+a.x,void(l.ty=e*h+a.y)}let u=a.matrix.a,d=a.matrix.c,p=a.matrix.b,f=a.matrix.d;switch(l.tx=u*t+d*e+a.matrix.tx,l.ty=p*t+f*e+a.matrix.ty,this.data.transformMode){case IT.Normal:{const t=n+90+o,e=XT.cosDeg(n+s)*r,a=XT.cosDeg(t)*i,c=XT.sinDeg(n+s)*r,h=XT.sinDeg(t)*i;return l.a=u*e+d*c,l.c=u*a+d*h,l.b=p*e+f*c,void(l.d=p*a+f*h)}case IT.OnlyTranslation:{const t=n+90+o;l.a=XT.cosDeg(n+s)*r,l.c=XT.cosDeg(t)*i,l.b=XT.sinDeg(n+s)*r,l.d=XT.sinDeg(t)*i;break}case IT.NoRotationOrReflection:{let t=u*u+p*p,e=0;t>1e-4?(t=Math.abs(u*f-d*p)/t,u/=c,p/=h,d=p*t,f=u*t,e=Math.atan2(p,u)*XT.radDeg):(u=0,p=0,e=90-Math.atan2(f,d)*XT.radDeg);const a=n+s-e,m=n+o-e+90,g=XT.cosDeg(a)*r,v=XT.cosDeg(m)*i,y=XT.sinDeg(a)*r,x=XT.sinDeg(m)*i;l.a=u*g-d*y,l.c=u*v-d*x,l.b=p*g+f*y,l.d=p*v+f*x;break}case IT.NoScale:case IT.NoScaleOrReflection:{const t=XT.cosDeg(n),e=XT.sinDeg(n);let a=(u*t+d*e)/c,m=(p*t+f*e)/h,g=Math.sqrt(a*a+m*m);g>1e-5&&(g=1/g),a*=g,m*=g,g=Math.sqrt(a*a+m*m),this.data.transformMode==IT.NoScale&&u*f-d*p<0!=(c<0!=h<0)&&(g=-g);const v=Math.PI/2+Math.atan2(m,a),y=Math.cos(v)*g,x=Math.sin(v)*g,w=XT.cosDeg(s)*r,_=XT.cosDeg(90+o)*i,b=XT.sinDeg(s)*r,A=XT.sinDeg(90+o)*i;l.a=a*w+y*b,l.c=a*_+y*A,l.b=m*w+x*b,l.d=m*_+x*A;break}}l.a*=c,l.c*=c,l.b*=h,l.d*=h}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*XT.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*XT.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)}updateAppliedTransform(){const t=this.parent,e=this.matrix;if(!t)return this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*XT.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,void(this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*XT.radDeg);const n=t.matrix,r=1/(n.a*n.d-n.b*n.c),i=e.tx-n.tx,s=e.ty-n.ty;this.ax=i*n.d*r-s*n.c*r,this.ay=s*n.a*r-i*n.b*r;const o=r*n.d,a=r*n.a,l=r*n.c,c=r*n.b,h=o*e.a-l*e.b,u=o*e.c-l*e.d,d=a*e.b-c*e.a,p=a*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(h*h+d*d),this.ascaleX>1e-4){const t=h*p-u*d;this.ascaleY=t/this.ascaleX,this.ashearY=Math.atan2(h*u+d*p,t)*XT.radDeg,this.arotation=Math.atan2(d,h)*XT.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+p*p),this.ashearY=0,this.arotation=90-Math.atan2(p,u)*XT.radDeg}worldToLocal(t){const e=this.matrix,n=e.a,r=e.c,i=e.b,s=e.d,o=1/(n*s-r*i),a=t.x-e.tx,l=t.y-e.ty;return t.x=a*s*o-l*r*o,t.y=l*n*o-a*i*o,t}localToWorld(t){const e=this.matrix,n=t.x,r=t.y;return t.x=n*e.a+r*e.c+e.tx,t.y=n*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){const e=XT.sinDeg(t),n=XT.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*n,r.d*n-r.c*e)*XT.radDeg}localToWorldRotation(t){t-=this.rotation-this.shearX;const e=XT.sinDeg(t),n=XT.cosDeg(t),r=this.matrix;return Math.atan2(n*r.b+e*r.d,n*r.a+e*r.c)*XT.radDeg}rotateWorld(t){const e=this.matrix,n=e.a,r=e.c,i=e.b,s=e.d,o=XT.cosDeg(t),a=XT.sinDeg(t);e.a=o*n-a*i,e.c=o*r-a*s,e.b=a*n+o*i,e.d=a*r+o*s}}class pE{constructor(t,e,n){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=IT.Normal,this.skinRequired=!1,this.color=new zT,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}}class fE{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let n=0;n<t.bones.length;n++){const r=e.findBone(t.bones[n].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[n].name}`);this.bones.push(r)}const n=e.findBone(t.target.name);if(!n)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=n}isActive(){return this.active}update(){if(0==this.mix)return;const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(t,e,n,r,i,s,o){const a=t.parent.matrix;if(!a)throw new Error("IK bone must have parent.");const l=a.a;let c=a.c;const h=a.b;let u=a.d,d=-t.ashearX-t.arotation,p=0,f=0;const m=t.skeleton.scaleX,g=-t.skeleton.scaleY;switch(t.data.transformMode){case IT.OnlyTranslation:p=(e-t.worldX)*XT.signum(m),f=(n-t.worldY)*XT.signum(g);break;case IT.NoRotationOrReflection:const r=Math.abs(l*u-c*h)/(l*l+h*h),i=l/m,s=h/g;c=-s*r*m,u=i*r*g,d+=Math.atan2(s,i)*XT.radDeg;default:const o=e-a.tx,v=n-a.ty,y=l*u-c*h;p=(o*u-v*c)/y-t.ax,f=(v*l-o*h)/y-t.ay}d+=Math.atan2(f,p)*XT.radDeg,t.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);let v=t.ascaleX,y=t.ascaleY;if(r||i){switch(t.data.transformMode){case IT.NoScale:case IT.NoScaleOrReflection:p=e-t.worldX,f=n-t.worldY}const a=t.data.length*v,l=Math.sqrt(p*p+f*f);if(r&&l<a||i&&l>a&&a>1e-4){const t=(l/a-1)*o+1;v*=t,s&&(y*=t)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*o,v,y,t.ashearX,t.ashearY)}apply2(t,e,n,r,i,s,o,a,l){const c=t.ax,h=t.ay;let u=t.ascaleX,d=t.ascaleY,p=u,f=d,m=e.ascaleX;const g=t.matrix;let v=0,y=0,x=0;u<0?(u=-u,v=180,x=-1):(v=0,x=1),d<0&&(d=-d,x=-x),m<0?(m=-m,y=180):y=0;const w=e.ax;let _=0,b=0,A=0,T=g.a,S=g.c,E=g.b,k=g.d;const M=Math.abs(u-d)<=1e-4;!M||s?(_=0,b=T*w+g.tx,A=E*w+g.ty):(_=e.ay,b=T*w+S*_+g.tx,A=E*w+k*_+g.ty);const C=t.parent.matrix;if(!C)throw new Error("IK parent must itself have a parent.");T=C.a,S=C.c,E=C.b,k=C.d;const P=1/(T*k-S*E);let I=b-C.tx,R=A-C.ty;const O=(I*k-R*S)*P-c,D=(R*T-I*E)*P-h,L=Math.sqrt(O*O+D*D);let F,B,N=e.data.length*m;if(L<1e-4)return this.apply1(t,n,r,!1,s,!1,l),void e.updateWorldTransformWith(w,_,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);I=n-C.tx,R=r-C.ty;let W=(I*k-R*S)*P-c,U=(R*T-I*E)*P-h,j=W*W+U*U;if(0!=a){a*=u*(m+1)*.5;const t=Math.sqrt(j),e=t-L-N*u+a;if(e>0){let n=Math.min(1,e/(2*a))-1;n=(e-a*(1-n*n))/t,W-=n*W,U-=n*U,j=W*W+U*U}}t:if(M){N*=u;let t=(j-L*L-N*N)/(2*L*N);t<-1?(t=-1,B=Math.PI*i):t>1?(t=1,B=0,s&&(T=(Math.sqrt(j)/(L+N)-1)*l+1,p*=T,o&&(f*=T))):B=Math.acos(t)*i,T=L+N*t,S=N*Math.sin(B),F=Math.atan2(U*T-W*S,W*T+U*S)}else{T=u*N,S=d*N;const t=T*T,e=S*S,n=Math.atan2(U,W);E=e*L*L+t*j-t*e;const r=-2*e*L,s=e-t;if(k=r*r-4*s*E,k>=0){let t=Math.sqrt(k);r<0&&(t=-t),t=.5*-(r+t);const e=t/s,o=E/t,a=Math.abs(e)<Math.abs(o)?e:o;if(a*a<=j){R=Math.sqrt(j-a*a)*i,F=n-Math.atan2(R,a),B=Math.atan2(R/d,(a-L)/u);break t}}let o=XT.PI,a=L-T,l=a*a,c=0,h=0,p=L+T,f=p*p,m=0;E=-T*L/(t-e),E>=-1&&E<=1&&(E=Math.acos(E),I=T*Math.cos(E)+L,R=S*Math.sin(E),k=I*I+R*R,k<l&&(o=E,l=k,a=I,c=R),k>f&&(h=E,f=k,p=I,m=R)),j<=.5*(l+f)?(F=n-Math.atan2(c*i,a),B=o*i):(F=n-Math.atan2(m*i,p),B=h*i)}const H=Math.atan2(_,w)*x;let z=t.arotation;F=(F-H)*XT.radDeg+v-z,F>180?F-=360:F<-180&&(F+=360),t.updateWorldTransformWith(c,h,z+F*l,p,f,0,0),z=e.arotation,B=((B+H)*XT.radDeg-e.ashearX)*x+y-z,B>180?B-=360:B<-180&&(B+=360),e.updateWorldTransformWith(w,_,z+B*l,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class mE{constructor(t,e,n){this.name=t,this.order=e,this.skinRequired=n}}class gE extends mE{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class vE extends mE{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=CT.Fixed,this.spacingMode=yE.Fixed,this.rotateMode=PT.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var yE=(t=>(t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent",t[t.Proportional=3]="Proportional",t))(yE||{});const xE=class{constructor(t,e){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let n=0,r=t.bones.length;n<r;n++){const r=e.findBone(t.bones[n].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[n].name}.`);this.bones.push(r)}const n=e.findSlot(t.target.name);if(!n)throw new Error(`Couldn't find target bone ${t.target.name}`);this.target=n,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}isActive(){return this.active}update(){const t=this.target.getAttachment();if(!(t instanceof uS))return;const e=this.mixRotate,n=this.mixX,r=this.mixY;if(0==e&&0==n&&0==r)return;const i=this.data,s=i.rotateMode==PT.Tangent,o=i.rotateMode==PT.ChainScale,a=this.bones,l=a.length,c=s?l:l+1,h=YT.setArraySize(this.spaces,c),u=o?this.lengths=YT.setArraySize(this.lengths,l):[],d=this.spacing;switch(i.spacingMode){case yE.Percent:if(o)for(let t=0,e=c-1;t<e;t++){const e=a[t],n=e.data.length;if(n<xE.epsilon)u[t]=0;else{const r=n*e.matrix.a,i=n*e.matrix.b;u[t]=Math.sqrt(r*r+i*i)}}YT.arrayFill(h,1,c,d);break;case yE.Proportional:let t=0;for(let e=0,n=c-1;e<n;){const n=a[e],r=n.data.length;if(r<xE.epsilon)o&&(u[e]=0),h[++e]=d;else{const i=r*n.matrix.a,s=r*n.matrix.b,a=Math.sqrt(i*i+s*s);o&&(u[e]=a),h[++e]=a,t+=a}}if(t>0){t=c/t*d;for(let e=1;e<c;e++)h[e]*=t}break;default:const e=i.spacingMode==yE.Length;for(let t=0,n=c-1;t<n;){const n=a[t],r=n.data.length;if(r<xE.epsilon)o&&(u[t]=0),h[++t]=d;else{const i=r*n.matrix.a,s=r*n.matrix.b,a=Math.sqrt(i*i+s*s);o&&(u[t]=a),h[++t]=(e?r+d:d)*a/r}}}const p=this.computeWorldPositions(t,c,s);let f=p[0],m=p[1],g=i.offsetRotation,v=!1;if(0==g)v=i.rotateMode==PT.Chain;else{v=!1;const t=this.target.bone.matrix;g*=t.a*t.d-t.b*t.c>0?XT.degRad:-XT.degRad}for(let t=0,i=3;t<l;t++,i+=3){const l=a[t],c=l.matrix;c.tx+=(f-c.tx)*n,c.ty+=(m-c.ty)*r;const d=p[i],y=p[i+1],x=d-f,w=y-m;if(o){const n=u[t];if(0!=n){const t=(Math.sqrt(x*x+w*w)/n-1)*e+1;c.a*=t,c.b*=t}}if(f=d,m=y,e>0){const n=c.a,r=c.c,o=c.b,a=c.d;let u=0,d=0,y=0;if(u=s?p[i-1]:0==h[t+1]?p[i+2]:Math.atan2(w,x),u-=Math.atan2(o,n),v){d=Math.cos(u),y=Math.sin(u);const t=l.data.length;f+=(t*(d*n-y*o)-x)*e,m+=(t*(y*n+d*o)-w)*e}else u+=g;u>XT.PI?u-=XT.PI2:u<-XT.PI&&(u+=XT.PI2),u*=e,d=Math.cos(u),y=Math.sin(u),c.a=d*n-y*o,c.c=d*r-y*a,c.b=y*n+d*o,c.d=y*r+d*a}l.updateAppliedTransform()}}computeWorldPositions(t,e,n){const r=this.target;let i=this.position;const s=this.spaces,o=YT.setArraySize(this.positions,3*e+2);let a=this.world;const l=t.closed;let c=t.worldVerticesLength,h=c/6,u=xE.NONE;if(!t.constantSpeed){const d=t.lengths;h-=l?1:2;const p=d[h];let f;switch(this.data.positionMode==CT.Percent&&(i*=p),this.data.spacingMode){case yE.Percent:f=p;break;case yE.Proportional:f=p/e;break;default:f=1}a=YT.setArraySize(this.world,8);for(let m=0,g=0,v=0;m<e;m++,g+=3){const e=s[m]*f;i+=e;let y=i;if(l)y%=p,y<0&&(y+=p),v=0;else{if(y<0){u!=xE.BEFORE&&(u=xE.BEFORE,t.computeWorldVertices(r,2,4,a,0,2)),this.addBeforePosition(y,a,0,o,g);continue}if(y>p){u!=xE.AFTER&&(u=xE.AFTER,t.computeWorldVertices(r,c-6,4,a,0,2)),this.addAfterPosition(y-p,a,0,o,g);continue}}for(;;v++){const t=d[v];if(!(y>t)){if(0==v)y/=t;else{const e=d[v-1];y=(y-e)/(t-e)}break}}v!=u&&(u=v,l&&v==h?(t.computeWorldVertices(r,c-4,4,a,0,2),t.computeWorldVertices(r,0,4,a,4,2)):t.computeWorldVertices(r,6*v+2,8,a,0,2)),this.addCurvePosition(y,a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],o,g,n||m>0&&0==e)}return o}l?(c+=2,a=YT.setArraySize(this.world,c),t.computeWorldVertices(r,2,c-4,a,0,2),t.computeWorldVertices(r,0,2,a,c-4,2),a[c-2]=a[0],a[c-1]=a[1]):(h--,c-=4,a=YT.setArraySize(this.world,c),t.computeWorldVertices(r,2,c,a,0,2));const d=YT.setArraySize(this.curves,h);let p,f=0,m=a[0],g=a[1],v=0,y=0,x=0,w=0,_=0,b=0,A=0,T=0,S=0,E=0,k=0,M=0,C=0,P=0;for(let t=0,e=2;t<h;t++,e+=6)v=a[e],y=a[e+1],x=a[e+2],w=a[e+3],_=a[e+4],b=a[e+5],A=.1875*(m-2*v+x),T=.1875*(g-2*y+w),S=.09375*(3*(v-x)-m+_),E=.09375*(3*(y-w)-g+b),k=2*A+S,M=2*T+E,C=.75*(v-m)+A+.16666667*S,P=.75*(y-g)+T+.16666667*E,f+=Math.sqrt(C*C+P*P),C+=k,P+=M,k+=S,M+=E,f+=Math.sqrt(C*C+P*P),C+=k,P+=M,f+=Math.sqrt(C*C+P*P),C+=k+S,P+=M+E,f+=Math.sqrt(C*C+P*P),d[t]=f,m=_,g=b;switch(this.data.positionMode==CT.Percent&&(i*=f),this.data.spacingMode){case yE.Percent:p=f;break;case yE.Proportional:p=f/e;break;default:p=1}const I=this.segments;let R=0;for(let t=0,r=0,h=0,O=0;t<e;t++,r+=3){const e=s[t]*p;i+=e;let D=i;if(l)D%=f,D<0&&(D+=f),h=0;else{if(D<0){this.addBeforePosition(D,a,0,o,r);continue}if(D>f){this.addAfterPosition(D-f,a,c-4,o,r);continue}}for(;;h++){const t=d[h];if(!(D>t)){if(0==h)D/=t;else{const e=d[h-1];D=(D-e)/(t-e)}break}}if(h!=u){u=h;let t=6*h;for(m=a[t],g=a[t+1],v=a[t+2],y=a[t+3],x=a[t+4],w=a[t+5],_=a[t+6],b=a[t+7],A=.03*(m-2*v+x),T=.03*(g-2*y+w),S=.006*(3*(v-x)-m+_),E=.006*(3*(y-w)-g+b),k=2*A+S,M=2*T+E,C=.3*(v-m)+A+.16666667*S,P=.3*(y-g)+T+.16666667*E,R=Math.sqrt(C*C+P*P),I[0]=R,t=1;t<8;t++)C+=k,P+=M,k+=S,M+=E,R+=Math.sqrt(C*C+P*P),I[t]=R;C+=k,P+=M,R+=Math.sqrt(C*C+P*P),I[8]=R,C+=k+S,P+=M+E,R+=Math.sqrt(C*C+P*P),I[9]=R,O=0}for(D*=R;;O++){const t=I[O];if(!(D>t)){if(0==O)D/=t;else{const e=I[O-1];D=O+(D-e)/(t-e)}break}}this.addCurvePosition(.1*D,m,g,v,y,x,w,_,b,o,r,n||t>0&&0==e)}return o}addBeforePosition(t,e,n,r,i){const s=e[n],o=e[n+1],a=e[n+2]-s,l=e[n+3]-o,c=Math.atan2(l,a);r[i]=s+t*Math.cos(c),r[i+1]=o+t*Math.sin(c),r[i+2]=c}addAfterPosition(t,e,n,r,i){const s=e[n+2],o=e[n+3],a=s-e[n],l=o-e[n+1],c=Math.atan2(l,a);r[i]=s+t*Math.cos(c),r[i+1]=o+t*Math.sin(c),r[i+2]=c}addCurvePosition(t,e,n,r,i,s,o,a,l,c,h,u){if(0==t||isNaN(t))return c[h]=e,c[h+1]=n,void(c[h+2]=Math.atan2(i-n,r-e));const d=t*t,p=d*t,f=1-t,m=f*f,g=m*f,v=f*t,y=3*v,x=f*y,w=y*t,_=e*g+r*x+s*w+a*p,b=n*g+i*x+o*w+l*p;c[h]=_,c[h+1]=b,u&&(c[h+2]=t<.001?Math.atan2(i-n,r-e):Math.atan2(b-(n*m+i*v*2+o*d),_-(e*m+r*v*2+s*d)))}};let wE=xE;wE.NONE=-1,wE.BEFORE=-2,wE.AFTER=-3,wE.epsilon=1e-5;class _E{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new zT,this.darkColor=t.darkColor?new zT:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(t instanceof aS&&this.attachment instanceof aS&&t.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class bE{constructor(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new qT,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let n=0;n<t.bones.length;n++){const r=e.findBone(t.bones[n].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[n].name}.`);this.bones.push(r)}const n=e.findBone(t.target.name);if(!n)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=n}isActive(){return this.active}update(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleX&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){const t=this.mixRotate,e=this.mixX,n=this.mixY,r=this.mixScaleX,i=this.mixScaleY,s=this.mixShearY,o=0!=e||0!=n,a=this.target,l=a.matrix,c=l.a,h=l.c,u=l.b,d=l.d,p=c*d-h*u>0?XT.degRad:-XT.degRad,f=this.data.offsetRotation*p,m=this.data.offsetShearY*p,g=this.bones;for(let l=0,p=g.length;l<p;l++){const p=g[l],v=p.matrix;if(0!=t){const e=v.a,n=v.c,r=v.b,i=v.d;let s=Math.atan2(u,c)-Math.atan2(r,e)+f;s>XT.PI?s-=XT.PI2:s<-XT.PI&&(s+=XT.PI2),s*=t;const o=Math.cos(s),a=Math.sin(s);v.a=o*e-a*r,v.c=o*n-a*i,v.b=a*e+o*r,v.d=a*n+o*i}if(o){const t=this.temp;a.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),v.tx+=(t.x-v.tx)*e,v.ty+=(t.y-v.ty)*n}if(0!=r){let t=Math.sqrt(v.a*v.a+v.b*v.b);0!=t&&(t=(t+(Math.sqrt(c*c+u*u)-t+this.data.offsetScaleX)*r)/t),v.a*=t,v.b*=t}if(0!=i){let t=Math.sqrt(v.c*v.c+v.d*v.d);0!=t&&(t=(t+(Math.sqrt(h*h+d*d)-t+this.data.offsetScaleY)*i)/t),v.c*=t,v.d*=t}if(s>0){const t=v.c,e=v.d,n=Math.atan2(e,t);let r=Math.atan2(d,h)-Math.atan2(u,c)-(n-Math.atan2(v.b,v.a));r>XT.PI?r-=XT.PI2:r<-XT.PI&&(r+=XT.PI2),r=n+(r+m)*s;const i=Math.sqrt(t*t+e*e);v.c=Math.cos(r)*i,v.d=Math.sin(r)*i}p.updateAppliedTransform()}}applyRelativeWorld(){const t=this.mixRotate,e=this.mixX,n=this.mixY,r=this.mixScaleX,i=this.mixScaleY,s=this.mixShearY,o=0!=e||0!=n,a=this.target,l=a.matrix,c=l.a,h=l.c,u=l.b,d=l.d,p=c*d-h*u>0?XT.degRad:-XT.degRad,f=this.data.offsetRotation*p,m=this.data.offsetShearY*p,g=this.bones;for(let l=0,p=g.length;l<p;l++){const p=g[l],v=p.matrix;if(0!=t){const e=v.a,n=v.c,r=v.b,i=v.d;let s=Math.atan2(u,c)+f;s>XT.PI?s-=XT.PI2:s<-XT.PI&&(s+=XT.PI2),s*=t;const o=Math.cos(s),a=Math.sin(s);v.a=o*e-a*r,v.c=o*n-a*i,v.b=a*e+o*r,v.d=a*n+o*i}if(o){const t=this.temp;a.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),v.tx+=t.x*e,v.ty+=t.y*n}if(0!=r){const t=(Math.sqrt(c*c+u*u)-1+this.data.offsetScaleX)*r+1;v.a*=t,v.b*=t}if(0!=i){const t=(Math.sqrt(h*h+d*d)-1+this.data.offsetScaleY)*i+1;v.c*=t,v.d*=t}if(s>0){let t=Math.atan2(d,h)-Math.atan2(u,c);t>XT.PI?t-=XT.PI2:t<-XT.PI&&(t+=XT.PI2);const e=v.c,n=v.d;t=Math.atan2(n,e)+(t-XT.PI/2+m)*s;const r=Math.sqrt(e*e+n*n);v.c=Math.cos(t)*r,v.d=Math.sin(t)*r}p.updateAppliedTransform()}}applyAbsoluteLocal(){const t=this.mixRotate,e=this.mixX,n=this.mixY,r=this.mixScaleX,i=this.mixScaleY,s=this.mixShearY,o=this.target,a=this.bones;for(let l=0,c=a.length;l<c;l++){const c=a[l];let h=c.arotation;if(0!=t){let e=o.arotation-h+this.data.offsetRotation;e-=360*(16384-(16384.499999999996-e/360|0)),h+=e*t}let u=c.ax,d=c.ay;u+=(o.ax-u+this.data.offsetX)*e,d+=(o.ay-d+this.data.offsetY)*n;let p=c.ascaleX,f=c.ascaleY;0!=r&&0!=p&&(p=(p+(o.ascaleX-p+this.data.offsetScaleX)*r)/p),0!=i&&0!=f&&(f=(f+(o.ascaleY-f+this.data.offsetScaleY)*i)/f);let m=c.ashearY;if(0!=s){let t=o.ashearY-m+this.data.offsetShearY;t-=360*(16384-(16384.499999999996-t/360|0)),m+=t*s}c.updateWorldTransformWith(u,d,h,p,f,c.ashearX,m)}}applyRelativeLocal(){const t=this.mixRotate,e=this.mixX,n=this.mixY,r=this.mixScaleX,i=this.mixScaleY,s=this.mixShearY,o=this.target,a=this.bones;for(let l=0,c=a.length;l<c;l++){const c=a[l],h=c.arotation+(o.arotation+this.data.offsetRotation)*t,u=c.ax+(o.ax+this.data.offsetX)*e,d=c.ay+(o.ay+this.data.offsetY)*n,p=c.ascaleX*((o.ascaleX-1+this.data.offsetScaleX)*r+1),f=c.ascaleY*((o.ascaleY-1+this.data.offsetScaleY)*i+1),m=c.ashearY+(o.ashearY+this.data.offsetShearY)*s;c.updateWorldTransformWith(u,d,h,p,f,c.ashearX,m)}}}const AE=class{constructor(t){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let r;if(n.parent){const t=this.bones[n.parent.index];r=new dE(n,this,t),t.children.push(r)}else r=new dE(n,this,null);this.bones.push(r)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const n=t.slots[e],r=this.bones[n.boneData.index],i=new _E(n,r);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const n=t.ikConstraints[e];this.ikConstraints.push(new fE(n,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const n=t.transformConstraints[e];this.transformConstraints.push(new bE(n,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const n=t.pathConstraints[e];this.pathConstraints.push(new wE(n,this))}this.color=new zT(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;const t=this.bones;for(let e=0,n=t.length;e<n;e++){const n=t[e];n.sorted=n.data.skinRequired,n.active=!n.sorted}if(this.skin){const t=this.skin.bones;for(let e=0,n=this.skin.bones.length;e<n;e++){let n=this.bones[t[e].index];do{n.sorted=!1,n.active=!0,n=n.parent}while(n)}}const e=this.ikConstraints,n=this.transformConstraints,r=this.pathConstraints,i=e.length,s=n.length,o=r.length,a=i+s+o;t:for(let t=0;t<a;t++){for(let n=0;n<i;n++){const r=e[n];if(r.data.order==t){this.sortIkConstraint(r);continue t}}for(let e=0;e<s;e++){const r=n[e];if(r.data.order==t){this.sortTransformConstraint(r);continue t}}for(let e=0;e<o;e++){const n=r[e];if(n.data.order==t){this.sortPathConstraint(n);continue t}}}for(let e=0,n=t.length;e<n;e++)this.sortBone(t[e])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&YT.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target;this.sortBone(e);const n=t.bones,r=n[0];if(this.sortBone(r),1==n.length)this._updateCache.push(t),this.sortReset(r.children);else{const e=n[n.length-1];this.sortBone(e),this._updateCache.push(t),this.sortReset(r.children),e.sorted=!0}}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&YT.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target,n=e.data.index,r=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,n,r),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,r);for(let t=0,e=this.data.skins.length;t<e;t++)this.sortPathConstraintAttachment(this.data.skins[t],n,r);const i=e.getAttachment();i instanceof uS&&this.sortPathConstraintAttachmentWith(i,r);const s=t.bones,o=s.length;for(let t=0;t<o;t++)this.sortBone(s[t]);this._updateCache.push(t);for(let t=0;t<o;t++)this.sortReset(s[t].children);for(let t=0;t<o;t++)s[t].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&YT.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);const e=t.bones,n=e.length;if(t.data.local)for(let t=0;t<n;t++){const n=e[t];this.sortBone(n.parent),this.sortBone(n)}else for(let t=0;t<n;t++)this.sortBone(e[t]);this._updateCache.push(t);for(let t=0;t<n;t++)this.sortReset(e[t].children);for(let t=0;t<n;t++)e[t].sorted=!0}sortPathConstraintAttachment(t,e,n){const r=t.attachments[e];if(r)for(const t in r)this.sortPathConstraintAttachmentWith(r[t],n)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof uS))return;const n=t.bones;if(n){const t=this.bones;for(let e=0,r=n.length;e<r;){let r=n[e++];for(r+=e;e<r;)this.sortBone(t[n[e++]])}}else this.sortBone(e)}sortBone(t){if(!t)return;if(t.sorted)return;const e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,n=t.length;e<n;e++){const n=t[e];n.active&&(n.sorted&&this.sortReset(n.children),n.sorted=!1)}}updateWorldTransform(){const t=this.bones;for(let e=0,n=t.length;e<n;e++){const n=t[e];n.ax=n.x,n.ay=n.y,n.arotation=n.rotation,n.ascaleX=n.scaleX,n.ascaleY=n.scaleY,n.ashearX=n.shearX,n.ashearY=n.shearY}const e=this._updateCache;for(let t=0,n=e.length;t<n;t++)e[t].update()}updateWorldTransformWith(t){const e=this.getRootBone(),n=t.matrix.a,r=t.matrix.c,i=t.matrix.b,s=t.matrix.d;e.matrix.tx=n*this.x+r*this.y+t.worldX,e.matrix.ty=i*this.x+s*this.y+t.worldY;const o=e.rotation+90+e.shearY,a=XT.cosDeg(e.rotation+e.shearX)*e.scaleX,l=XT.cosDeg(o)*e.scaleY,c=XT.sinDeg(e.rotation+e.shearX)*e.scaleX,h=XT.sinDeg(o)*e.scaleY,u=this.scaleX,d=-this.scaleY;e.matrix.a=(n*a+r*c)*u,e.matrix.c=(n*l+r*h)*u,e.matrix.b=(i*a+s*c)*d,e.matrix.d=(i*l+s*h)*d;const p=this._updateCache;for(let t=0,n=p.length;t<n;t++){const n=p[t];n!=e&&n.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let e=0,n=t.length;e<n;e++)t[e].setToSetupPose();const e=this.ikConstraints;for(let t=0,n=e.length;t<n;t++){const n=e[t];n.mix=n.data.mix,n.softness=n.data.softness,n.bendDirection=n.data.bendDirection,n.compress=n.data.compress,n.stretch=n.data.stretch}const n=this.transformConstraints;for(let t=0,e=n.length;t<e;t++){const e=n[t],r=e.data;e.mixRotate=r.mixRotate,e.mixX=r.mixX,e.mixY=r.mixY,e.mixScaleX=r.mixScaleX,e.mixScaleY=r.mixScaleY,e.mixShearY=r.mixShearY}const r=this.pathConstraints;for(let t=0,e=r.length;t<e;t++){const e=r[t],n=e.data;e.position=n.position,e.spacing=n.spacing,e.mixRotate=n.mixRotate,e.mixX=n.mixX,e.mixY=n.mixY}}setSlotsToSetupPose(){const t=this.slots;YT.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,n=t.length;e<n;e++)t[e].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,r=e.length;n<r;n++)if(e[n].data.name==t)return n;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,r=e.length;n<r;n++)if(e[n].data.name==t)return n;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(!e)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else{const e=this.slots;for(let n=0,r=e.length;n<r;n++){const r=e[n],i=r.data.attachmentName;if(i){const e=t.getAttachment(n,i);e&&r.setAttachment(e)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){const n=this.data.findSlot(t);if(!n)throw new Error(`Can't find slot with name ${t}`);return this.getAttachment(n.index,e)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){const n=this.skin.getAttachment(t,e);if(n)return n}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(!t)throw new Error("slotName cannot be null.");const n=this.slots;for(let r=0,i=n.length;r<i;r++){const i=n[r];if(i.data.name==t){let n=null;if(e&&(n=this.getAttachment(r,e),!n))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);return void i.setAttachment(n)}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}getBoundsRect(){const t=new qT,e=new qT;return this.getBounds(t,e),{x:t.x,y:t.y,width:e.x,height:e.y}}getBounds(t,e,n=new Array(2)){if(!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");const r=this.drawOrder;let i=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let t=0,e=r.length;t<e;t++){const e=r[t];if(!e.bone.active)continue;let l=0,c=null;const h=e.getAttachment();if(h instanceof fS)l=8,c=YT.setArraySize(n,l,0),h.computeWorldVertices(e,c,0,2);else if(h instanceof hS){const t=h;l=t.worldVerticesLength,c=YT.setArraySize(n,l,0),t.computeWorldVertices(e,0,l,c,0,2)}if(c)for(let t=0,e=c.length;t<e;t+=2){const e=c[t],n=c[t+1];i=Math.min(i,e),s=Math.min(s,n),o=Math.max(o,e),a=Math.max(a,n)}}t.set(i,s),e.set(o-i,a-s)}get flipX(){return-1==this.scaleX}set flipX(t){AE.deprecatedWarning1||(AE.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return-1==this.scaleY}set flipY(t){AE.deprecatedWarning1||(AE.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let TE=AE;TE.deprecatedWarning1=!1;class SE{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}}class EE{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,r=e.length;n<r;n++)if(e[n].name==t)return n;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,r=e.length;n<r;n++)if(e[n].name==t)return n;return-1}findSkin(t){if(!t)throw new Error("skinName cannot be null.");const e=this.skins;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");const e=this.events;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");const e=this.animations;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraintIndex(t){if(null==t)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let n=0,r=e.length;n<r;n++)if(e[n].name==t)return n;return-1}}class kE{constructor(t,e,n){if(this.index=0,this.color=new zT(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=C.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!n)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n}}class ME extends mE{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class CE{constructor(t,e,n){this.slotIndex=t,this.name=e,this.attachment=n}}class PE{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,n){if(!n)throw new Error("attachment cannot be null.");const r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=n}addSkin(t){for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let r=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==n){r=!0;break}r||this.bones.push(n)}for(let e=0;e<t.constraints.length;e++){const n=t.constraints[e];let r=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==n){r=!0;break}r||this.constraints.push(n)}const e=t.getAttachments();for(let t=0;t<e.length;t++){const n=e[t];this.setAttachment(n.slotIndex,n.name,n.attachment)}}copySkin(t){for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let r=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==n){r=!0;break}r||this.bones.push(n)}for(let e=0;e<t.constraints.length;e++){const n=t.constraints[e];let r=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==n){r=!0;break}r||this.constraints.push(n)}const e=t.getAttachments();for(let t=0;t<e.length;t++){const n=e[t];n.attachment&&(n.attachment instanceof hS?(n.attachment=n.attachment.newLinkedMesh(),this.setAttachment(n.slotIndex,n.name,n.attachment)):(n.attachment=n.attachment.copy(),this.setAttachment(n.slotIndex,n.name,n.attachment)))}}getAttachment(t,e){const n=this.attachments[t];return n?n[e]:null}removeAttachment(t,e){const n=this.attachments[t];n&&delete n[e]}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const n=this.attachments[e];if(n)for(const r in n){const i=n[r];i&&t.push(new CE(e,r,i))}}return t}getAttachmentsForSlot(t,e){const n=this.attachments[t];if(n)for(const r in n){const i=n[r];i&&e.push(new CE(t,r,i))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let n=0;for(let r=0;r<t.slots.length;r++){const i=t.slots[r],s=i.getAttachment();if(s&&n<e.attachments.length){const t=e.attachments[n];for(const e in t)if(s==t[e]){const t=this.getAttachment(n,e);t&&i.setAttachment(t);break}}n++}}}class IE{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}}class RE{constructor(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new EE;n.name="";const r=new ET(t),i=r.readInt32(),s=r.readInt32();n.hash=0==s&&0==i?null:s.toString(16)+i.toString(16),n.version=r.readString();const o=n.version.substr(0,3);if("4.0"!==o&&"4.1"!==o){const t=`Spine 4.1 loader cant load version ${n.version}. Please configure your pixi-spine bundle`;console.error(t)}this.ver40="4.0"===o,n.x=r.readFloat(),n.y=r.readFloat(),n.width=r.readFloat(),n.height=r.readFloat();const a=r.readBoolean();a&&(n.fps=r.readFloat(),n.imagesPath=r.readString(),n.audioPath=r.readString());let l=0;l=r.readInt(!0);for(let t=0;t<l;t++){const t=r.readString();if(!t)throw new Error("String in string table must not be null.");r.strings.push(t)}l=r.readInt(!0);for(let t=0;t<l;t++){const i=r.readString();if(!i)throw new Error("Bone name must not be null.");const s=0==t?null:n.bones[r.readInt(!0)],o=new pE(t,i,s);o.rotation=r.readFloat(),o.x=r.readFloat()*e,o.y=r.readFloat()*e,o.scaleX=r.readFloat(),o.scaleY=r.readFloat(),o.shearX=r.readFloat(),o.shearY=r.readFloat(),o.length=r.readFloat()*e,o.transformMode=r.readInt(!0),o.skinRequired=r.readBoolean(),a&&zT.rgba8888ToColor(o.color,r.readInt32()),n.bones.push(o)}l=r.readInt(!0);for(let t=0;t<l;t++){const e=r.readString();if(!e)throw new Error("Slot name must not be null.");const i=n.bones[r.readInt(!0)],s=new kE(t,e,i);zT.rgba8888ToColor(s.color,r.readInt32());const o=r.readInt32();-1!=o&&zT.rgb888ToColor(s.darkColor=new zT,o),s.attachmentName=r.readStringRef(),s.blendMode=r.readInt(!0),n.slots.push(s)}l=r.readInt(!0);for(let t,i=0;i<l;i++){const i=r.readString();if(!i)throw new Error("IK constraint data name must not be null.");const s=new gE(i);s.order=r.readInt(!0),s.skinRequired=r.readBoolean(),t=r.readInt(!0);for(let e=0;e<t;e++)s.bones.push(n.bones[r.readInt(!0)]);s.target=n.bones[r.readInt(!0)],s.mix=r.readFloat(),s.softness=r.readFloat()*e,s.bendDirection=r.readByte(),s.compress=r.readBoolean(),s.stretch=r.readBoolean(),s.uniform=r.readBoolean(),n.ikConstraints.push(s)}l=r.readInt(!0);for(let t,i=0;i<l;i++){const i=r.readString();if(!i)throw new Error("Transform constraint data name must not be null.");const s=new ME(i);s.order=r.readInt(!0),s.skinRequired=r.readBoolean(),t=r.readInt(!0);for(let e=0;e<t;e++)s.bones.push(n.bones[r.readInt(!0)]);s.target=n.bones[r.readInt(!0)],s.local=r.readBoolean(),s.relative=r.readBoolean(),s.offsetRotation=r.readFloat(),s.offsetX=r.readFloat()*e,s.offsetY=r.readFloat()*e,s.offsetScaleX=r.readFloat(),s.offsetScaleY=r.readFloat(),s.offsetShearY=r.readFloat(),s.mixRotate=r.readFloat(),s.mixX=r.readFloat(),s.mixY=r.readFloat(),s.mixScaleX=r.readFloat(),s.mixScaleY=r.readFloat(),s.mixShearY=r.readFloat(),n.transformConstraints.push(s)}l=r.readInt(!0);for(let t,i=0;i<l;i++){const i=r.readString();if(!i)throw new Error("Path constraint data name must not be null.");const s=new vE(i);s.order=r.readInt(!0),s.skinRequired=r.readBoolean(),t=r.readInt(!0);for(let e=0;e<t;e++)s.bones.push(n.bones[r.readInt(!0)]);s.target=n.slots[r.readInt(!0)],s.positionMode=r.readInt(!0),s.spacingMode=r.readInt(!0),s.rotateMode=r.readInt(!0),s.offsetRotation=r.readFloat(),s.position=r.readFloat(),s.positionMode==CT.Fixed&&(s.position*=e),s.spacing=r.readFloat(),s.spacingMode!=yE.Length&&s.spacingMode!=yE.Fixed||(s.spacing*=e),s.mixRotate=r.readFloat(),s.mixX=r.readFloat(),s.mixY=r.readFloat(),n.pathConstraints.push(s)}const c=this.readSkin(r,n,!0,a);c&&(n.defaultSkin=c,n.skins.push(c));{let t=n.skins.length;for(YT.setArraySize(n.skins,l=t+r.readInt(!0));t<l;t++){const e=this.readSkin(r,n,!1,a);if(!e)throw new Error("readSkin() should not have returned null.");n.skins[t]=e}}l=this.linkedMeshes.length;for(let t=0;t<l;t++){const e=this.linkedMeshes[t],r=e.skin?n.findSkin(e.skin):n.defaultSkin;if(!r)throw new Error("Not skin found for linked mesh.");if(!e.parent)throw new Error("Linked mesh parent must not be null");const i=r.getAttachment(e.slotIndex,e.parent);if(!i)throw new Error(`Parent mesh not found: ${e.parent}`);e.mesh.timelineAttachment=e.inheritTimeline?i:e.mesh,e.mesh.setParentMesh(i)}this.linkedMeshes.length=0,l=r.readInt(!0);for(let t=0;t<l;t++){const t=r.readStringRef();if(!t)throw new Error;const e=new IE(t);e.intValue=r.readInt(!1),e.floatValue=r.readFloat(),e.stringValue=r.readString(),e.audioPath=r.readString(),e.audioPath&&(e.volume=r.readFloat(),e.balance=r.readFloat()),n.events.push(e)}l=r.readInt(!0);for(let t=0;t<l;t++){const t=r.readString();if(!t)throw new Error("Animatio name must not be null.");n.animations.push(this.readAnimation(r,t,n))}return n}readSkin(t,e,n,r){let i=null,s=0;if(n){if(s=t.readInt(!0),0==s)return null;i=new PE("default")}else{const n=t.readStringRef();if(!n)throw new Error("Skin name must not be null.");i=new PE(n),i.bones.length=t.readInt(!0);for(let n=0,r=i.bones.length;n<r;n++)i.bones[n]=e.bones[t.readInt(!0)];for(let n=0,r=t.readInt(!0);n<r;n++)i.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let n=0,r=t.readInt(!0);n<r;n++)i.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let n=0,r=t.readInt(!0);n<r;n++)i.constraints.push(e.pathConstraints[t.readInt(!0)]);s=t.readInt(!0)}for(let n=0;n<s;n++){const n=t.readInt(!0);for(let s=0,o=t.readInt(!0);s<o;s++){const s=t.readStringRef();if(!s)throw new Error("Attachment name must not be null");const o=this.readAttachment(t,e,i,n,s,r);o&&i.setAttachment(n,s,o)}}return i}readAttachment(t,e,n,r,i,s){const o=this.scale;let a=t.readStringRef();switch(a||(a=i),t.readByte()){case ST.Region:{let e=t.readStringRef();const r=t.readFloat(),i=t.readFloat(),s=t.readFloat(),l=t.readFloat(),c=t.readFloat(),h=t.readFloat(),u=t.readFloat(),d=t.readInt32(),p=this.readSequence(t);e||(e=a);const f=this.attachmentLoader.newRegionAttachment(n,a,e,p);return f?(f.path=e,f.x=i*o,f.y=s*o,f.scaleX=l,f.scaleY=c,f.rotation=r,f.width=h*o,f.height=u*o,zT.rgba8888ToColor(f.color,d),f.sequence=p,null==p&&f.updateRegion(),f):null}case ST.BoundingBox:{const e=t.readInt(!0),r=this.readVertices(t,e),i=s?t.readInt32():0,o=this.attachmentLoader.newBoundingBoxAttachment(n,a);return o?(o.worldVerticesLength=e<<1,o.vertices=r.vertices,o.bones=r.bones,s&&zT.rgba8888ToColor(o.color,i),o):null}case ST.Mesh:{let e=t.readStringRef();const r=t.readInt32(),i=t.readInt(!0),l=this.readFloatArray(t,i<<1,1),c=this.readShortArray(t),h=this.readVertices(t,i),u=t.readInt(!0),d=this.readSequence(t);let p=[],f=0,m=0;s&&(p=this.readShortArray(t),f=t.readFloat(),m=t.readFloat()),e||(e=a);const g=this.attachmentLoader.newMeshAttachment(n,a,e,d);return g?(g.path=e,zT.rgba8888ToColor(g.color,r),g.bones=h.bones,g.vertices=h.vertices,g.worldVerticesLength=i<<1,g.triangles=c,g.regionUVs=new Float32Array(l),g.hullLength=u<<1,g.sequence=d,s&&(g.edges=p,g.width=f*o,g.height=m*o),g):null}case ST.LinkedMesh:{let e=t.readStringRef();const i=t.readInt32(),l=t.readStringRef(),c=t.readStringRef(),h=t.readBoolean(),u=this.readSequence(t);let d=0,p=0;s&&(d=t.readFloat(),p=t.readFloat()),e||(e=a);const f=this.attachmentLoader.newMeshAttachment(n,a,e,u);return f?(f.path=e,zT.rgba8888ToColor(f.color,i),f.sequence=u,s&&(f.width=d*o,f.height=p*o),this.linkedMeshes.push(new OE(f,l,r,c,h)),f):null}case ST.Path:{const e=t.readBoolean(),r=t.readBoolean(),i=t.readInt(!0),l=this.readVertices(t,i),c=YT.newArray(i/3,0);for(let e=0,n=c.length;e<n;e++)c[e]=t.readFloat()*o;const h=s?t.readInt32():0,u=this.attachmentLoader.newPathAttachment(n,a);return u?(u.closed=e,u.constantSpeed=r,u.worldVerticesLength=i<<1,u.vertices=l.vertices,u.bones=l.bones,u.lengths=c,s&&zT.rgba8888ToColor(u.color,h),u):null}case ST.Point:{const e=t.readFloat(),r=t.readFloat(),i=t.readFloat(),l=s?t.readInt32():0,c=this.attachmentLoader.newPointAttachment(n,a);return c?(c.x=r*o,c.y=i*o,c.rotation=e,s&&zT.rgba8888ToColor(c.color,l),c):null}case ST.Clipping:{const r=t.readInt(!0),i=t.readInt(!0),o=this.readVertices(t,i),l=s?t.readInt32():0,c=this.attachmentLoader.newClippingAttachment(n,a);return c?(c.endSlot=e.slots[r],c.worldVerticesLength=i<<1,c.vertices=o.vertices,c.bones=o.bones,s&&zT.rgba8888ToColor(c.color,l),c):null}}return null}readSequence(t){if(this.ver40||!t.readBoolean())return null;const e=new gS(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readDeformTimelineType(t){return this.ver40?tk:t.readByte()}readVertices(t,e){const n=this.scale,r=e<<1,i=new DE;if(!t.readBoolean())return i.vertices=this.readFloatArray(t,r,n),i;const s=new Array,o=new Array;for(let r=0;r<e;r++){const e=t.readInt(!0);o.push(e);for(let r=0;r<e;r++)o.push(t.readInt(!0)),s.push(t.readFloat()*n),s.push(t.readFloat()*n),s.push(t.readFloat())}return i.vertices=YT.toFloatArray(s),i.bones=o,i}readFloatArray(t,e,n){const r=new Array(e);if(1==n)for(let n=0;n<e;n++)r[n]=t.readFloat();else for(let i=0;i<e;i++)r[i]=t.readFloat()*n;return r}readShortArray(t){const e=t.readInt(!0),n=new Array(e);for(let r=0;r<e;r++)n[r]=t.readShort();return n}readAnimation(t,e,n){t.readInt(!0);const r=new Array,i=this.scale;for(let e=0,n=t.readInt(!0);e<n;e++){const e=t.readInt(!0);for(let n=0,i=t.readInt(!0);n<i;n++){const n=t.readByte(),i=t.readInt(!0),s=i-1;switch(n){case $E:{const n=new WS(i,e);for(let e=0;e<i;e++)n.setFrame(e,t.readFloat(),t.readStringRef());r.push(n);break}case qE:{const n=t.readInt(!0),o=new DS(i,n,e);let a=t.readFloat(),l=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255;for(let e=0,n=0;o.setFrame(e,a,l,c,h,u),e!=s;e++){const r=t.readFloat(),i=t.readUnsignedByte()/255,s=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255;switch(t.readByte()){case sk:o.setStepped(e);break;case ok:BE(t,o,n++,e,0,a,r,l,i,1),BE(t,o,n++,e,1,a,r,c,s,1),BE(t,o,n++,e,2,a,r,h,d,1),BE(t,o,n++,e,3,a,r,u,p,1)}a=r,l=i,c=s,h=d,u=p}r.push(o);break}case KE:{const n=t.readInt(!0),o=new LS(i,n,e);let a=t.readFloat(),l=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255;for(let e=0,n=0;o.setFrame(e,a,l,c,h),e!=s;e++){const r=t.readFloat(),i=t.readUnsignedByte()/255,s=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255;switch(t.readByte()){case sk:o.setStepped(e);break;case ok:BE(t,o,n++,e,0,a,r,l,i,1),BE(t,o,n++,e,1,a,r,c,s,1),BE(t,o,n++,e,2,a,r,h,u,1)}a=r,l=i,c=s,h=u}r.push(o);break}case ZE:{const n=t.readInt(!0),o=new BS(i,n,e);let a=t.readFloat(),l=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255;for(let e=0,n=0;o.setFrame(e,a,l,c,h,u,d,p,f),e!=s;e++){const r=t.readFloat(),i=t.readUnsignedByte()/255,s=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,y=t.readUnsignedByte()/255,x=t.readUnsignedByte()/255;switch(t.readByte()){case sk:o.setStepped(e);break;case ok:BE(t,o,n++,e,0,a,r,l,i,1),BE(t,o,n++,e,1,a,r,c,s,1),BE(t,o,n++,e,2,a,r,h,m,1),BE(t,o,n++,e,3,a,r,u,g,1),BE(t,o,n++,e,4,a,r,d,v,1),BE(t,o,n++,e,5,a,r,p,y,1),BE(t,o,n++,e,6,a,r,f,x,1)}a=r,l=i,c=s,h=m,u=g,d=v,p=y,f=x}r.push(o);break}case QE:{const n=t.readInt(!0),o=new NS(i,n,e);let a=t.readFloat(),l=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255;for(let e=0,n=0;o.setFrame(e,a,l,c,h,u,d,p),e!=s;e++){const r=t.readFloat(),i=t.readUnsignedByte()/255,s=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255;switch(t.readByte()){case sk:o.setStepped(e);break;case ok:BE(t,o,n++,e,0,a,r,l,i,1),BE(t,o,n++,e,1,a,r,c,s,1),BE(t,o,n++,e,2,a,r,h,f,1),BE(t,o,n++,e,3,a,r,u,m,1),BE(t,o,n++,e,4,a,r,d,g,1),BE(t,o,n++,e,5,a,r,p,v,1)}a=r,l=i,c=s,h=f,u=m,d=g,p=v}r.push(o);break}case JE:{const n=new FS(i,t.readInt(!0),e);let o=t.readFloat(),a=t.readUnsignedByte()/255;for(let e=0,r=0;n.setFrame(e,o,a),e!=s;e++){const i=t.readFloat(),s=t.readUnsignedByte()/255;switch(t.readByte()){case sk:n.setStepped(e);break;case ok:BE(t,n,r++,e,0,o,i,a,s,1)}o=i,a=s}r.push(n)}}}}for(let e=0,n=t.readInt(!0);e<n;e++){const e=t.readInt(!0);for(let n=0,s=t.readInt(!0);n<s;n++){const n=t.readByte(),s=t.readInt(!0),o=t.readInt(!0);switch(n){case NE:r.push(LE(t,new TS(s,o,e),1));break;case WE:r.push(FE(t,new SS(s,o,e),i));break;case UE:r.push(LE(t,new ES(s,o,e),i));break;case jE:r.push(LE(t,new kS(s,o,e),i));break;case HE:r.push(FE(t,new MS(s,o,e),1));break;case zE:r.push(LE(t,new CS(s,o,e),1));break;case GE:r.push(LE(t,new PS(s,o,e),1));break;case XE:r.push(FE(t,new IS(s,o,e),1));break;case VE:r.push(LE(t,new RS(s,o,e),1));break;case YE:r.push(LE(t,new OS(s,o,e),1))}}}for(let e=0,n=t.readInt(!0);e<n;e++){const e=t.readInt(!0),n=t.readInt(!0),s=n-1,o=new XS(n,t.readInt(!0),e);let a=t.readFloat(),l=t.readFloat(),c=t.readFloat()*i;for(let e=0,n=0;o.setFrame(e,a,l,c,t.readByte(),t.readBoolean(),t.readBoolean()),e!=s;e++){const r=t.readFloat(),s=t.readFloat(),h=t.readFloat()*i;switch(t.readByte()){case sk:o.setStepped(e);break;case ok:BE(t,o,n++,e,0,a,r,l,s,1),BE(t,o,n++,e,1,a,r,c,h,i)}a=r,l=s,c=h}r.push(o)}for(let e=0,n=t.readInt(!0);e<n;e++){const e=t.readInt(!0),n=t.readInt(!0),i=n-1,s=new VS(n,t.readInt(!0),e);let o=t.readFloat(),a=t.readFloat(),l=t.readFloat(),c=t.readFloat(),h=t.readFloat(),u=t.readFloat(),d=t.readFloat();for(let e=0,n=0;s.setFrame(e,o,a,l,c,h,u,d),e!=i;e++){const r=t.readFloat(),i=t.readFloat(),p=t.readFloat(),f=t.readFloat(),m=t.readFloat(),g=t.readFloat(),v=t.readFloat();switch(t.readByte()){case sk:s.setStepped(e);break;case ok:BE(t,s,n++,e,0,o,r,a,i,1),BE(t,s,n++,e,1,o,r,l,p,1),BE(t,s,n++,e,2,o,r,c,f,1),BE(t,s,n++,e,3,o,r,h,m,1),BE(t,s,n++,e,4,o,r,u,g,1),BE(t,s,n++,e,5,o,r,d,v,1)}o=r,a=i,l=p,c=f,h=m,u=g,d=v}r.push(s)}for(let e=0,s=t.readInt(!0);e<s;e++){const e=t.readInt(!0),s=n.pathConstraints[e];for(let n=0,o=t.readInt(!0);n<o;n++)switch(t.readByte()){case nk:r.push(LE(t,new YS(t.readInt(!0),t.readInt(!0),e),s.positionMode==CT.Fixed?i:1));break;case rk:r.push(LE(t,new $S(t.readInt(!0),t.readInt(!0),e),s.spacingMode==yE.Length||s.spacingMode==yE.Fixed?i:1));break;case ik:const n=new qS(t.readInt(!0),t.readInt(!0),e);let o=t.readFloat(),a=t.readFloat(),l=t.readFloat(),c=t.readFloat();for(let e=0,r=0,i=n.getFrameCount()-1;n.setFrame(e,o,a,l,c),e!=i;e++){const i=t.readFloat(),s=t.readFloat(),h=t.readFloat(),u=t.readFloat();switch(t.readByte()){case sk:n.setStepped(e);break;case ok:BE(t,n,r++,e,0,o,i,a,s,1),BE(t,n,r++,e,1,o,i,l,h,1),BE(t,n,r++,e,2,o,i,c,u,1)}o=i,a=s,l=h,c=u}r.push(n)}}for(let e=0,s=t.readInt(!0);e<s;e++){const e=n.skins[t.readInt(!0)];for(let n=0,s=t.readInt(!0);n<s;n++){const n=t.readInt(!0);for(let s=0,o=t.readInt(!0);s<o;s++){const s=t.readStringRef();if(!s)throw new Error("attachmentName must not be null.");const o=e.getAttachment(n,s),a=this.readDeformTimelineType(t),l=t.readInt(!0),c=l-1;switch(a){case tk:{const e=o,s=e.bones,a=e.vertices,h=s?a.length/3*2:a.length,u=t.readInt(!0),d=new US(l,u,n,e);let p=t.readFloat();for(let e=0,n=0;;e++){let r,o=t.readInt(!0);if(0==o)r=s?YT.newFloatArray(h):a;else{r=YT.newFloatArray(h);const e=t.readInt(!0);if(o+=e,1==i)for(let n=e;n<o;n++)r[n]=t.readFloat();else for(let n=e;n<o;n++)r[n]=t.readFloat()*i;if(!s)for(let t=0,e=r.length;t<e;t++)r[t]+=a[t]}if(d.setFrame(e,p,r),e==c)break;const l=t.readFloat();switch(t.readByte()){case sk:d.setStepped(e);break;case ok:BE(t,d,n++,e,0,p,l,0,1,1)}p=l}r.push(d);break}case ek:{const e=new ZS(l,n,o);for(let n=0;n<l;n++){const r=t.readFloat(),i=t.readInt32();e.setFrame(n,r,yS[15&i],i>>4,t.readFloat())}r.push(e);break}}}}}const s=t.readInt(!0);if(s>0){const e=new GS(s),i=n.slots.length;for(let n=0;n<s;n++){const r=t.readFloat(),s=t.readInt(!0),o=YT.newArray(i,0);for(let t=i-1;t>=0;t--)o[t]=-1;const a=YT.newArray(i-s,0);let l=0,c=0;for(let e=0;e<s;e++){const e=t.readInt(!0);for(;l!=e;)a[c++]=l++;o[l+t.readInt(!0)]=l++}for(;l<i;)a[c++]=l++;for(let t=i-1;t>=0;t--)-1==o[t]&&(o[t]=a[--c]);e.setFrame(n,r,o)}r.push(e)}const o=t.readInt(!0);if(o>0){const e=new HS(o);for(let r=0;r<o;r++){const i=t.readFloat(),s=n.events[t.readInt(!0)],o=new SE(i,s);o.intValue=t.readInt(!1),o.floatValue=t.readFloat(),o.stringValue=t.readBoolean()?t.readString():s.stringValue,o.data.audioPath&&(o.volume=t.readFloat(),o.balance=t.readFloat()),e.setFrame(r,o)}r.push(e)}let a=0;for(let t=0,e=r.length;t<e;t++)a=Math.max(a,r[t].getDuration());return new xS(e,r,a)}}RE.BlendModeValues=[C.NORMAL,C.ADD,C.MULTIPLY,C.SCREEN];class OE{constructor(t,e,n,r,i){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=r,this.inheritTimeline=i}}class DE{constructor(t=null,e=null){this.bones=t,this.vertices=e}}function LE(t,e,n){let r=t.readFloat(),i=t.readFloat()*n;for(let s=0,o=0,a=e.getFrameCount()-1;e.setFrame(s,r,i),s!=a;s++){const a=t.readFloat(),l=t.readFloat()*n;switch(t.readByte()){case sk:e.setStepped(s);break;case ok:BE(t,e,o++,s,0,r,a,i,l,n)}r=a,i=l}return e}function FE(t,e,n){let r=t.readFloat(),i=t.readFloat()*n,s=t.readFloat()*n;for(let o=0,a=0,l=e.getFrameCount()-1;e.setFrame(o,r,i,s),o!=l;o++){const l=t.readFloat(),c=t.readFloat()*n,h=t.readFloat()*n;switch(t.readByte()){case sk:e.setStepped(o);break;case ok:BE(t,e,a++,o,0,r,l,i,c,n),BE(t,e,a++,o,1,r,l,s,h,n)}r=l,i=c,s=h}return e}function BE(t,e,n,r,i,s,o,a,l,c){e.setBezier(n,r,i,s,a,t.readFloat(),t.readFloat()*c,t.readFloat(),t.readFloat()*c,o,l)}const NE=0,WE=1,UE=2,jE=3,HE=4,zE=5,GE=6,XE=7,VE=8,YE=9,$E=0,qE=1,KE=2,ZE=3,QE=4,JE=5,tk=0,ek=1,nk=0,rk=1,ik=2,sk=1,ok=2;class ak{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new EE,r="string"==typeof t?JSON.parse(t):t,i=r.skeleton;if(i){n.hash=i.hash,n.version=i.spine;const t=n.version.substr(0,3);if("4.0"!==t&&"4.1"!==t){const t=`Spine 4.1 loader cant load version ${i.spine}. Please configure your pixi-spine bundle`;console.error(t)}n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height,n.fps=i.fps,n.imagesPath=i.images}if(r.bones)for(let t=0;t<r.bones.length;t++){const i=r.bones[t];let s=null;const o=dk(i,"parent",null);if(null!=o&&(s=n.findBone(o),null==s))throw new Error(`Parent bone not found: ${o}`);const a=new pE(n.bones.length,i.name,s);a.length=dk(i,"length",0)*e,a.x=dk(i,"x",0)*e,a.y=dk(i,"y",0)*e,a.rotation=dk(i,"rotation",0),a.scaleX=dk(i,"scaleX",1),a.scaleY=dk(i,"scaleY",1),a.shearX=dk(i,"shearX",0),a.shearY=dk(i,"shearY",0),a.transformMode=YT.enumValue(IT,dk(i,"transform","Normal")),a.skinRequired=dk(i,"skin",!1);const l=dk(i,"color",null);l&&a.color.setFromString(l),n.bones.push(a)}if(r.slots)for(let t=0;t<r.slots.length;t++){const e=r.slots[t],i=n.findBone(e.bone);if(!i)throw new Error(`Couldn't find bone ${e.bone} for slot ${e.name}`);const s=new kE(n.slots.length,e.name,i),o=dk(e,"color",null);o&&s.color.setFromString(o);const a=dk(e,"dark",null);a&&(s.darkColor=zT.fromString(a)),s.attachmentName=dk(e,"attachment",null),s.blendMode=ak.blendModeFromString(dk(e,"blend","normal")),n.slots.push(s)}if(r.ik)for(let t=0;t<r.ik.length;t++){const i=r.ik[t],s=new gE(i.name);s.order=dk(i,"order",0),s.skinRequired=dk(i,"skin",!1);for(let t=0;t<i.bones.length;t++){const e=i.bones[t],r=n.findBone(e);if(null==r)throw new Error(`IK bone not found: ${e}`);s.bones.push(r)}s.target=n.findBone(i.target),s.mix=dk(i,"mix",1),s.softness=dk(i,"softness",0)*e,s.bendDirection=dk(i,"bendPositive",!0)?1:-1,s.compress=dk(i,"compress",!1),s.stretch=dk(i,"stretch",!1),s.uniform=dk(i,"uniform",!1),n.ikConstraints.push(s)}if(r.transform)for(let t=0;t<r.transform.length;t++){const i=r.transform[t],s=new ME(i.name);s.order=dk(i,"order",0),s.skinRequired=dk(i,"skin",!1);for(let t=0;t<i.bones.length;t++){const e=i.bones[t],r=n.findBone(e);if(!r)throw new Error(`Couldn't find bone ${e} for transform constraint ${i.name}.`);s.bones.push(r)}const o=i.target,a=n.findBone(o);if(!a)throw new Error(`Couldn't find target bone ${o} for transform constraint ${i.name}.`);s.target=a,s.local=dk(i,"local",!1),s.relative=dk(i,"relative",!1),s.offsetRotation=dk(i,"rotation",0),s.offsetX=dk(i,"x",0)*e,s.offsetY=dk(i,"y",0)*e,s.offsetScaleX=dk(i,"scaleX",0),s.offsetScaleY=dk(i,"scaleY",0),s.offsetShearY=dk(i,"shearY",0),s.mixRotate=dk(i,"mixRotate",1),s.mixX=dk(i,"mixX",1),s.mixY=dk(i,"mixY",s.mixX),s.mixScaleX=dk(i,"mixScaleX",1),s.mixScaleY=dk(i,"mixScaleY",s.mixScaleX),s.mixShearY=dk(i,"mixShearY",1),n.transformConstraints.push(s)}if(r.path)for(let t=0;t<r.path.length;t++){const i=r.path[t],s=new vE(i.name);s.order=dk(i,"order",0),s.skinRequired=dk(i,"skin",!1);for(let t=0;t<i.bones.length;t++){const e=i.bones[t],r=n.findBone(e);if(!r)throw new Error(`Couldn't find bone ${e} for path constraint ${i.name}.`);s.bones.push(r)}const o=i.target,a=n.findSlot(o);if(!a)throw new Error(`Couldn't find target slot ${o} for path constraint ${i.name}.`);s.target=a,s.positionMode=YT.enumValue(CT,dk(i,"positionMode","Percent")),s.spacingMode=YT.enumValue(yE,dk(i,"spacingMode","Length")),s.rotateMode=YT.enumValue(PT,dk(i,"rotateMode","Tangent")),s.offsetRotation=dk(i,"rotation",0),s.position=dk(i,"position",0),s.positionMode==CT.Fixed&&(s.position*=e),s.spacing=dk(i,"spacing",0),s.spacingMode!=yE.Length&&s.spacingMode!=yE.Fixed||(s.spacing*=e),s.mixRotate=dk(i,"mixRotate",1),s.mixX=dk(i,"mixX",1),s.mixY=dk(i,"mixY",s.mixX),n.pathConstraints.push(s)}if(r.skins)for(let t=0;t<r.skins.length;t++){const e=r.skins[t],i=new PE(e.name);if(e.bones)for(let t=0;t<e.bones.length;t++){const r=e.bones[t],s=n.findBone(r);if(!s)throw new Error(`Couldn't find bone ${r} for skin ${e.name}.`);i.bones.push(s)}if(e.ik)for(let t=0;t<e.ik.length;t++){const r=e.ik[t],s=n.findIkConstraint(r);if(!s)throw new Error(`Couldn't find IK constraint ${r} for skin ${e.name}.`);i.constraints.push(s)}if(e.transform)for(let t=0;t<e.transform.length;t++){const r=e.transform[t],s=n.findTransformConstraint(r);if(!s)throw new Error(`Couldn't find transform constraint ${r} for skin ${e.name}.`);i.constraints.push(s)}if(e.path)for(let t=0;t<e.path.length;t++){const r=e.path[t],s=n.findPathConstraint(r);if(!s)throw new Error(`Couldn't find path constraint ${r} for skin ${e.name}.`);i.constraints.push(s)}for(const t in e.attachments){const r=n.findSlot(t);if(!r)throw new Error(`Couldn't find slot ${t} for skin ${e.name}.`);const s=e.attachments[t];for(const t in s){const e=this.readAttachment(s[t],i,r.index,t,n);e&&i.setAttachment(r.index,t,e)}}n.skins.push(i),"default"==i.name&&(n.defaultSkin=i)}for(let t=0,e=this.linkedMeshes.length;t<e;t++){const e=this.linkedMeshes[t],r=e.skin?n.findSkin(e.skin):n.defaultSkin;if(!r)throw new Error(`Skin not found: ${e.skin}`);const i=r.getAttachment(e.slotIndex,e.parent);if(!i)throw new Error(`Parent mesh not found: ${e.parent}`);e.mesh.timelineAttachment=e.inheritTimeline?i:e.mesh,e.mesh.setParentMesh(i)}if(this.linkedMeshes.length=0,r.events)for(const t in r.events){const e=r.events[t],i=new IE(t);i.intValue=dk(e,"int",0),i.floatValue=dk(e,"float",0),i.stringValue=dk(e,"string",""),i.audioPath=dk(e,"audio",null),i.audioPath&&(i.volume=dk(e,"volume",1),i.balance=dk(e,"balance",0)),n.events.push(i)}if(r.animations)for(const t in r.animations){const e=r.animations[t];this.readAnimation(e,t,n)}return n}readAttachment(t,e,n,r,i){const s=this.scale;switch(r=dk(t,"name",r),dk(t,"type","region")){case"region":{const n=dk(t,"path",r),i=this.readSequence(dk(t,"sequence",null)),o=this.attachmentLoader.newRegionAttachment(e,r,n,i);if(!o)return null;o.path=n,o.x=dk(t,"x",0)*s,o.y=dk(t,"y",0)*s,o.scaleX=dk(t,"scaleX",1),o.scaleY=dk(t,"scaleY",1),o.rotation=dk(t,"rotation",0),o.width=t.width*s,o.height=t.height*s,o.sequence=i;const a=dk(t,"color",null);return a&&o.color.setFromString(a),o}case"boundingbox":{const n=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(!n)return null;this.readVertices(t,n,t.vertexCount<<1);const i=dk(t,"color",null);return i&&n.color.setFromString(i),n}case"mesh":case"linkedmesh":{const i=dk(t,"path",r),o=this.readSequence(dk(t,"sequence",null)),a=this.attachmentLoader.newMeshAttachment(e,r,i,o);if(!a)return null;a.path=i;const l=dk(t,"color",null);l&&a.color.setFromString(l),a.width=dk(t,"width",0)*s,a.height=dk(t,"height",0)*s,a.sequence=o;const c=dk(t,"parent",null);if(c)return this.linkedMeshes.push(new lk(a,dk(t,"skin",null),n,c,dk(t,"timelines",!0))),a;const h=t.uvs;return this.readVertices(t,a,h.length),a.triangles=t.triangles,a.regionUVs=new Float32Array(h),a.edges=dk(t,"edges",null),a.hullLength=2*dk(t,"hull",0),a}case"path":{const n=this.attachmentLoader.newPathAttachment(e,r);if(!n)return null;n.closed=dk(t,"closed",!1),n.constantSpeed=dk(t,"constantSpeed",!0);const i=t.vertexCount;this.readVertices(t,n,i<<1);const o=YT.newArray(i/3,0);for(let e=0;e<t.lengths.length;e++)o[e]=t.lengths[e]*s;n.lengths=o;const a=dk(t,"color",null);return a&&n.color.setFromString(a),n}case"point":{const n=this.attachmentLoader.newPointAttachment(e,r);if(!n)return null;n.x=dk(t,"x",0)*s,n.y=dk(t,"y",0)*s,n.rotation=dk(t,"rotation",0);const i=dk(t,"color",null);return i&&n.color.setFromString(i),n}case"clipping":{const n=this.attachmentLoader.newClippingAttachment(e,r);if(!n)return null;const s=dk(t,"end",null);if(null!=s){const t=i.findSlot(s);if(null==t)throw new Error(`Clipping end slot not found: ${s}`);n.endSlot=t}const o=t.vertexCount;this.readVertices(t,n,o<<1);const a=dk(t,"color",null);return a&&n.color.setFromString(a),n}}return null}readSequence(t){if(null==t)return null;const e=new gS(dk(t,"count",0));return e.start=dk(t,"start",1),e.digits=dk(t,"digits",0),e.setupIndex=dk(t,"setup",0),e}readVertices(t,e,n){const r=this.scale;e.worldVerticesLength=n;const i=t.vertices;if(n==i.length){const t=YT.toFloatArray(i);if(1!=r)for(let e=0,n=i.length;e<n;e++)t[e]*=r;return void(e.vertices=t)}const s=new Array,o=new Array;for(let t=0,e=i.length;t<e;){const e=i[t++];o.push(e);for(let n=t+4*e;t<n;t+=4)o.push(i[t]),s.push(i[t+1]*r),s.push(i[t+2]*r),s.push(i[t+3])}e.bones=o,e.vertices=YT.toFloatArray(s)}readAnimation(t,e,n){const r=this.scale,i=new Array;if(t.slots)for(const e in t.slots){const r=t.slots[e],s=n.findSlot(e);if(!s)throw new Error(`Slot not found: ${e}`);const o=s.index;for(const t in r){const e=r[t];if(!e)continue;const n=e.length;if("attachment"==t){const t=new WS(n,o);for(let r=0;r<n;r++){const n=e[r];t.setFrame(r,dk(n,"time",0),dk(n,"name",null))}i.push(t)}else if("rgba"==t){const t=new DS(n,n<<2,o);let r=e[0],s=dk(r,"time",0),a=zT.fromString(r.color);for(let n=0,i=0;;n++){t.setFrame(n,s,a.r,a.g,a.b,a.a);const o=e[n+1];if(!o){t.shrink(i);break}const l=dk(o,"time",0),c=zT.fromString(o.color),h=r.curve;h&&(i=uk(h,t,i,n,0,s,l,a.r,c.r,1),i=uk(h,t,i,n,1,s,l,a.g,c.g,1),i=uk(h,t,i,n,2,s,l,a.b,c.b,1),i=uk(h,t,i,n,3,s,l,a.a,c.a,1)),s=l,a=c,r=o}i.push(t)}else if("rgb"==t){const t=new LS(n,3*n,o);let r=e[0],s=dk(r,"time",0),a=zT.fromString(r.color);for(let n=0,i=0;;n++){t.setFrame(n,s,a.r,a.g,a.b);const o=e[n+1];if(!o){t.shrink(i);break}const l=dk(o,"time",0),c=zT.fromString(o.color),h=r.curve;h&&(i=uk(h,t,i,n,0,s,l,a.r,c.r,1),i=uk(h,t,i,n,1,s,l,a.g,c.g,1),i=uk(h,t,i,n,2,s,l,a.b,c.b,1)),s=l,a=c,r=o}i.push(t)}else if("alpha"==t)i.push(ck(e,new FS(n,n,o),0,1));else if("rgba2"==t){const t=new BS(n,7*n,o);let r=e[0],s=dk(r,"time",0),a=zT.fromString(r.light),l=zT.fromString(r.dark);for(let n=0,i=0;;n++){t.setFrame(n,s,a.r,a.g,a.b,a.a,l.r,l.g,l.b);const o=e[n+1];if(!o){t.shrink(i);break}const c=dk(o,"time",0),h=zT.fromString(o.light),u=zT.fromString(o.dark),d=r.curve;d&&(i=uk(d,t,i,n,0,s,c,a.r,h.r,1),i=uk(d,t,i,n,1,s,c,a.g,h.g,1),i=uk(d,t,i,n,2,s,c,a.b,h.b,1),i=uk(d,t,i,n,3,s,c,a.a,h.a,1),i=uk(d,t,i,n,4,s,c,l.r,u.r,1),i=uk(d,t,i,n,5,s,c,l.g,u.g,1),i=uk(d,t,i,n,6,s,c,l.b,u.b,1)),s=c,a=h,l=u,r=o}i.push(t)}else if("rgb2"==t){const t=new NS(n,6*n,o);let r=e[0],s=dk(r,"time",0),a=zT.fromString(r.light),l=zT.fromString(r.dark);for(let n=0,i=0;;n++){t.setFrame(n,s,a.r,a.g,a.b,l.r,l.g,l.b);const o=e[n+1];if(!o){t.shrink(i);break}const c=dk(o,"time",0),h=zT.fromString(o.light),u=zT.fromString(o.dark),d=r.curve;d&&(i=uk(d,t,i,n,0,s,c,a.r,h.r,1),i=uk(d,t,i,n,1,s,c,a.g,h.g,1),i=uk(d,t,i,n,2,s,c,a.b,h.b,1),i=uk(d,t,i,n,3,s,c,l.r,u.r,1),i=uk(d,t,i,n,4,s,c,l.g,u.g,1),i=uk(d,t,i,n,5,s,c,l.b,u.b,1)),s=c,a=h,l=u,r=o}i.push(t)}}}if(t.bones)for(const e in t.bones){const s=t.bones[e],o=n.findBone(e);if(!o)throw new Error(`Bone not found: ${e}`);const a=o.index;for(const t in s){const e=s[t],n=e.length;if(0!=n)if("rotate"===t)i.push(ck(e,new TS(n,n,a),0,1));else if("translate"===t){const t=new SS(n,n<<1,a);i.push(hk(e,t,"x","y",0,r))}else if("translatex"===t){const t=new ES(n,n,a);i.push(ck(e,t,0,r))}else if("translatey"===t){const t=new kS(n,n,a);i.push(ck(e,t,0,r))}else if("scale"===t){const t=new MS(n,n<<1,a);i.push(hk(e,t,"x","y",1,1))}else if("scalex"===t){const t=new CS(n,n,a);i.push(ck(e,t,1,1))}else if("scaley"===t){const t=new PS(n,n,a);i.push(ck(e,t,1,1))}else if("shear"===t){const t=new IS(n,n<<1,a);i.push(hk(e,t,"x","y",0,1))}else if("shearx"===t){const t=new RS(n,n,a);i.push(ck(e,t,0,1))}else if("sheary"===t){const t=new OS(n,n,a);i.push(ck(e,t,0,1))}}}if(t.ik)for(const e in t.ik){const s=t.ik[e];let o=s[0];if(!o)continue;const a=n.findIkConstraint(e);if(!a)throw new Error(`IK Constraint not found: ${e}`);const l=n.ikConstraints.indexOf(a),c=new XS(s.length,s.length<<1,l);let h=dk(o,"time",0),u=dk(o,"mix",1),d=dk(o,"softness",0)*r;for(let t=0,e=0;;t++){c.setFrame(t,h,u,d,dk(o,"bendPositive",!0)?1:-1,dk(o,"compress",!1),dk(o,"stretch",!1));const n=s[t+1];if(!n){c.shrink(e);break}const i=dk(n,"time",0),a=dk(n,"mix",1),l=dk(n,"softness",0)*r,p=o.curve;p&&(e=uk(p,c,e,t,0,h,i,u,a,1),e=uk(p,c,e,t,1,h,i,d,l,r)),h=i,u=a,d=l,o=n}i.push(c)}if(t.transform)for(const e in t.transform){const r=t.transform[e];let s=r[0];if(!s)continue;const o=n.findTransformConstraint(e);if(!o)throw new Error(`Transform constraint not found: ${e}`);const a=n.transformConstraints.indexOf(o),l=new VS(r.length,6*r.length,a);let c=dk(s,"time",0),h=dk(s,"mixRotate",1),u=dk(s,"mixX",1),d=dk(s,"mixY",u),p=dk(s,"mixScaleX",1),f=dk(s,"mixScaleY",p);const m=dk(s,"mixShearY",1);for(let t=0,e=0;;t++){l.setFrame(t,c,h,u,d,p,f,m);const n=r[t+1];if(!n){l.shrink(e);break}const i=dk(n,"time",0),o=dk(n,"mixRotate",1),a=dk(n,"mixX",1),g=dk(n,"mixY",a),v=dk(n,"mixScaleX",1),y=dk(n,"mixScaleY",v),x=dk(n,"mixShearY",1),w=s.curve;w&&(e=uk(w,l,e,t,0,c,i,h,o,1),e=uk(w,l,e,t,1,c,i,u,a,1),e=uk(w,l,e,t,2,c,i,d,g,1),e=uk(w,l,e,t,3,c,i,p,v,1),e=uk(w,l,e,t,4,c,i,f,y,1),e=uk(w,l,e,t,5,c,i,m,x,1)),c=i,h=o,u=a,d=g,p=v,f=y,p=v,s=n}i.push(l)}if(t.path)for(const e in t.path){const s=t.path[e],o=n.findPathConstraint(e);if(!o)throw new Error(`Path constraint not found: ${e}`);const a=n.pathConstraints.indexOf(o);for(const t in s){const e=s[t];let n=e[0];if(!n)continue;const l=e.length;if("position"===t){const t=new YS(l,l,a);i.push(ck(e,t,0,o.positionMode==CT.Fixed?r:1))}else if("spacing"===t){const t=new $S(l,l,a);i.push(ck(e,t,0,o.spacingMode==yE.Length||o.spacingMode==yE.Fixed?r:1))}else if("mix"===t){const t=new qS(l,3*l,a);let r=dk(n,"time",0),s=dk(n,"mixRotate",1),o=dk(n,"mixX",1),c=dk(n,"mixY",o);for(let i=0,a=0;;i++){t.setFrame(i,r,s,o,c);const l=e[i+1];if(!l){t.shrink(a);break}const h=dk(l,"time",0),u=dk(l,"mixRotate",1),d=dk(l,"mixX",1),p=dk(l,"mixY",d),f=n.curve;f&&(a=uk(f,t,a,i,0,r,h,s,u,1),a=uk(f,t,a,i,1,r,h,o,d,1),a=uk(f,t,a,i,2,r,h,c,p,1)),r=h,s=u,o=d,c=p,n=l}i.push(t)}}}if(t.deform){t.attachments={};for(const e in t.deform){const n=t.deform[e],r=t.attachments[e]={};for(const t in n){const e=n[t],i=r[t]={};for(const t in e)i[t]={deform:e[t]}}}}if(t.attachments)for(const e in t.attachments){const s=t.attachments[e],o=n.findSkin(e);if(null!=o)for(const t in s){const e=s[t],a=n.findSlot(t);if(!a)throw new Error(`Slot not found: ${t}`);const l=a.index;for(const t in e){const n=e[t],s=o.getAttachment(l,t);for(const t in n){const e=n[t];let o=e[0];if(o)if("deform"==t){const t=s.bones,n=s.vertices,a=t?n.length/3*2:n.length,c=new US(e.length,e.length,l,s);let h=dk(o,"time",0);for(let i=0,s=0;;i++){let l;const u=dk(o,"vertices",null);if(u){l=YT.newFloatArray(a);const e=dk(o,"offset",0);if(YT.arrayCopy(u,0,l,e,u.length),1!=r)for(let t=e,n=t+u.length;t<n;t++)l[t]*=r;if(!t)for(let t=0;t<a;t++)l[t]+=n[t]}else l=t?YT.newFloatArray(a):n;c.setFrame(i,h,l);const d=e[i+1];if(!d){c.shrink(s);break}const p=dk(d,"time",0),f=o.curve;f&&(s=uk(f,c,s,i,0,h,p,0,1,1)),h=p,o=d}i.push(c)}else if("sequence"==t){const t=new ZS(e.length,l,s);let n=0;for(let r=0;r<e.length;r++){const i=dk(o,"delay",n),s=dk(o,"time",0),a=vS[dk(o,"mode","hold")],l=dk(o,"index",0);t.setFrame(r,s,a,l,i),n=i,o=e[r+1]}i.push(t)}}}}}if(t.drawOrder){const e=new GS(t.drawOrder.length),r=n.slots.length;let s=0;for(let i=0;i<t.drawOrder.length;i++,s++){const o=t.drawOrder[i];let a=null;const l=dk(o,"offsets",null);if(l){a=YT.newArray(r,-1);const t=YT.newArray(r-l.length,0);let e=0,i=0;for(let r=0;r<l.length;r++){const s=l[r],o=n.findSlot(s.slot);if(!o)throw new Error(`Slot not found: ${o}`);const c=o.index;for(;e!=c;)t[i++]=e++;a[e+s.offset]=e++}for(;e<r;)t[i++]=e++;for(let e=r-1;e>=0;e--)-1==a[e]&&(a[e]=t[--i])}e.setFrame(s,dk(o,"time",0),a)}i.push(e)}if(t.events){const e=new HS(t.events.length);let r=0;for(let i=0;i<t.events.length;i++,r++){const s=t.events[i],o=n.findEvent(s.name);if(!o)throw new Error(`Event not found: ${s.name}`);const a=new SE(YT.toSinglePrecision(dk(s,"time",0)),o);a.intValue=dk(s,"int",o.intValue),a.floatValue=dk(s,"float",o.floatValue),a.stringValue=dk(s,"string",o.stringValue),a.data.audioPath&&(a.volume=dk(s,"volume",1),a.balance=dk(s,"balance",0)),e.setFrame(r,a)}i.push(e)}let s=0;for(let t=0,e=i.length;t<e;t++)s=Math.max(s,i[t].getDuration());if(isNaN(s))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new xS(e,i,s))}static blendModeFromString(t){if("normal"==(t=t.toLowerCase()))return C.NORMAL;if("additive"==t)return C.ADD;if("multiply"==t)return C.MULTIPLY;if("screen"==t)return C.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}}class lk{constructor(t,e,n,r,i){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=r,this.inheritTimeline=i}}function ck(t,e,n,r){let i=t[0],s=dk(i,"time",0),o=dk(i,"value",n)*r,a=0;for(let l=0;;l++){e.setFrame(l,s,o);const c=t[l+1];if(!c)return e.shrink(a),e;const h=dk(c,"time",0),u=dk(c,"value",n)*r;i.curve&&(a=uk(i.curve,e,a,l,0,s,h,o,u,r)),s=h,o=u,i=c}}function hk(t,e,n,r,i,s){let o=t[0],a=dk(o,"time",0),l=dk(o,n,i)*s,c=dk(o,r,i)*s,h=0;for(let u=0;;u++){e.setFrame(u,a,l,c);const d=t[u+1];if(!d)return e.shrink(h),e;const p=dk(d,"time",0),f=dk(d,n,i)*s,m=dk(d,r,i)*s,g=o.curve;g&&(h=uk(g,e,h,u,0,a,p,l,f,s),h=uk(g,e,h,u,1,a,p,c,m,s)),a=p,l=f,c=m,o=d}}function uk(t,e,n,r,i,s,o,a,l,c){if("stepped"==t)return e.setStepped(r),n;const h=i<<2,u=t[h],d=t[h+1]*c,p=t[h+2],f=t[h+3]*c;return e.setBezier(n,r,i,s,a,u,d,p,f,o,l),n+1}function dk(t,e,n){return void 0!==t[e]?t[e]:n}class pk{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,n){const r=this.skeletonData.findAnimation(t);if(!r)throw new Error(`Animation not found: ${t}`);const i=this.skeletonData.findAnimation(e);if(!i)throw new Error(`Animation not found: ${e}`);this.setMixWith(r,i,n)}setMixWith(t,e,n){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");const r=`${t.name}.${e.name}`;this.animationToMixTime[r]=n}getMix(t,e){const n=`${t.name}.${e.name}`,r=this.animationToMixTime[n];return void 0===r?this.defaultMix:r}}class fk extends tS{createSkeleton(t){this.skeleton=new TE(t),this.skeleton.updateWorldTransform(),this.stateData=new pk(t),this.state=new JS(this.stateData)}}var mk;(new class extends iS{createBinaryParser(){return new RE(null)}createJsonParser(){return new ak(null)}parseData(t,e,n){const r=t;return r.attachmentLoader=new uE(e),{spineData:r.readSkeletonData(n),spineAtlas:e}}}).installLoader();var gk=w(function t(){g(this,t)});function vk(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return yk(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yk(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function yk(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xk(t,e){return t.get(_k(t,e))}function wk(t,e,n){return t.set(_k(t,e),n),n}function _k(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}mk=gk,S(gk,"getSlotsRecursively",function(t,e){if(null==t||!t.skeleton)return console.error("[SpineUtils getSlotsRecursively]    spineLevelComponent"),[];var n=t.skeleton.findBone(e);if(!n)return"idle"===e||console.warn("[SpineUtils getSlotsRecursively]    ".concat(e,"  ")),[];var r=function(t){var e;if(!t)return console.warn("[SpineUtils getSlotsRecursively]     "),[];var n,i=(null===(e=t.skeleton)||void 0===e?void 0:e.slots.filter(function(e){return e.bone===t}))||[],s=t.children||[];return Array.isArray(s)||console.warn("[SpineUtils collectSlots]   ".concat(null===(n=t.data)||void 0===n?void 0:n.name,"    ")),s.forEach(function(t){i.push.apply(i,Gc(r(t)))}),i};return r(n).filter(function(t){return t.data.name,null!==t.attachment})}),S(gk,"findSlots",function(t,e){var n=e.spineName,r=e.currentSkinName,i=t.skeleton.findBone(e.hogItemsBone);if(i)return i.skeleton.slots.filter(function(t){return t.bone===i}).filter(function(t){var e,i;if(null!==(e=t.attachment)&&void 0!==e&&e.name){if(null!==(i=t.attachment)&&void 0!==i&&i.name)return t}else{var s;if("level0"===n&&"mode1/skin_mode1_v1"===r)return;console.error("[SpineUtils findSlots]\n              :\n          spineName:".concat(n,"\n          skin: ").concat(r,"\n          slot: ").concat(null==t||null===(s=t.data)||void 0===s?void 0:s.name))}});console.log("[SpineUtils findSlots] hogItemsBone: ".concat(e.hogItemsBone,"  \n          spineName:").concat(n,"\n          skin: ").concat(r))}),S(gk,"findBone",function(t,e){return t.skeleton.findBone(e)}),S(gk,"createSpine",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.spineName,n=t.scale,r=void 0===n?1:n,i=t.speed,s=void 0===i?1:i,o=t.duration,a=void 0===o?1:o,l=t.loop,c=void 0!==l&&l,h=t.skinName,u=void 0===h?"default":h,d=t.animationName,p=void 0===d?"animation":d,f=t.autorun,m=void 0!==f&&f,g=t.freeze,v=void 0!==g&&g,y=Ds.get("".concat(e,".spineData"));if(y){var x=new fk(y);if(x.scale.set(r),x.state.timeScale=s,x.skeleton.setSkinByName(u),m){var w=x.state.setAnimation(0,p,c);w.animationEnd=w.animationEnd*a}return v&&(x.state.clearTracks(),x.skeleton.updateWorldTransform=function(){},x.state.timeScale=0,setTimeout(function(){x.update=function(){},x.autoUpdate=!1},500)),x}console.error("Spine data for ".concat(e," not found"))}),S(gk,"spineParserLogs",function(t,e){console.groupCollapsed("added spine: %c%s","color: #3AE2CE;",t.name,"imageName:",e,"animName",t.json.animations),console.log("skins:",t.json.skins),console.groupEnd()}),S(gk,"spineParser",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"webp";Gc(t).forEach(function(t){try{var n=t.name,r=t.atlas,i=t.json,s=r.split("\n").find(function(t){return t.includes(".".concat(e))}),o=s?s.replace(".".concat(e),"").trim():"",a=new BT(r,function(t,e){var n;e(null===(n=Ds.get(o))||void 0===n?void 0:n.baseTexture)}),l=new uE(a),c=new ak(l);Ds.cache._cache.set("".concat(n,".spineData"),c.readSkeletonData(i))}catch(t){console.warn("[spineParser]",t)}})}),S(gk,"getSlotSpritePosition",function(t){var e=t.sprite;if(t.isMesh){var n=e.getLocalBounds(),r=n.x,i=n.y;return{x:r+n.width/2,y:i+n.height/2}}return{x:e.x,y:Math.abs(e.y)}}),S(gk,"positionLog",function(t){var e=t.sprite,n=e.getLocalBounds();console.log("isMesh",t.isMesh),console.warn("target",t.width,"/",t.height,"pos",t.position.x,"*",t.position.y),console.warn("sprite",e.width,"/",e.height,"pos",e.position.x,"*",e.position.y),console.warn("bounds",n.width,"/",n.width,"pos",n.x,"*",n.y)}),S(gk,"loadAndParseSpineAsset",function(){var t=Kl(Jl().mark(function t(e){var n,r,i,s,o,a,l,c,h,u,d,p,f;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.spineName,r=e.folderPath,i=void 0===r?"spines":r,s=e.exists,o=void 0===s?"webp":s,a=e.basePath,c="".concat(l=void 0===a?ml.remote:a,"assets/").concat(i,"/").concat(n,".json"),h="".concat(l,"assets/").concat(i,"/").concat(n,".atlas"),u="".concat(l,"assets/").concat(i,"/").concat(n,".").concat(o),t.next=1,by.loadJson(c);case 1:return d=t.sent,t.next=2,by.loadAtlas(h);case 2:return p=t.sent,t.next=3,Ds.load({alias:n,src:u});case 3:f={name:"".concat(n),json:d,atlas:p},mk.spineParser([f],o);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),S(gk,"createTestSpine",function(){var t=Kl(Jl().mark(function t(e){var n,r,i,s,o,a,l,c;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.spineName,r=e.folderPath,i=e.loop,s=void 0===i||i,o=e.parent,a=e.exists,l=void 0===a?"png":a,t.next=1,mk.loadAndParseSpineAsset({spineName:n,folderPath:r,exists:l});case 1:if((c=mk.createSpine({spineName:n,autorun:!0,loop:s})).position.set(ol.HALF_W,ol.HALF_H),!o){t.next=2;break}return o.addChild(c),t.abrupt("return");case 2:Gf.game.refs.wrapper.addChild(c);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),S(gk,"destroySpine",function(t,e){t.state.setEmptyAnimations(0),t.state.clearListeners(),t.state.clearTracks(),t.destroy(),e&&Ds.cache._cache.delete("".concat(e,".spineData"))});var bk=new WeakMap,Ak=function(){return w(function t(){g(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,void 0)}(this,bk)},[{key:"run",value:(e=Kl(Jl().mark(function t(){var e,n,r,i,s,o,a,l,c,h,u;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("--- start test: LevelSlotTester ---"),wk(bk,this,hv.getFilteredLevels()),e=Object.keys(hv.getFilteredLevels()).length-1,n=Object.values(xk(bk,this)).map(function(t){return{spineName:t.spineName,isRemote:t.isRemote}}),r=0,i=vk(n),t.prev=1,i.s();case 2:if((s=i.n()).done){t.next=5;break}return o=s.value,a=o.spineName,l=o.isRemote,h={spineName:a,levelAtlas:"".concat(c=l?ml.remote:ml.local,"assets/gameLevels/").concat(a,".atlas"),levelJson:"".concat(c,"assets/gameLevels/").concat(a,".json"),levelSpriteSheet:{alias:a,src:"".concat(c,"assets/gameLevels/").concat(a,".webp")}},t.next=3,this.levelSpineParse(h);case 3:r++,console.log(a,"checked");case 4:t.next=2;break;case 5:t.next=7;break;case 6:t.prev=6,u=t.catch(1),i.e(u);case 7:return t.prev=7,i.f(),t.finish(7);case 8:r>=e&&console.log("--- end test: LevelSlotTester ---");case 9:case"end":return t.stop()}},t,this,[[1,6,7,8]])})),function(){return e.apply(this,arguments)})},{key:"levelSpineParse",value:(t=Kl(Jl().mark(function t(e){var n,r,i,s,o,a,l,c,h;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.spineName,r=e.levelAtlas,i=e.levelJson,s=e.levelSpriteSheet,o=S({},s.alias,s.src),Ds.addBundle(n,o),t.next=1,Ds.loadBundle(n);case 1:return t.next=2,by.loadAtlas(r);case 2:return a=t.sent,t.next=3,by.loadJson(i);case 3:for(l=t.sent,c={name:n,json:l,atlas:a},gk.spineParser([c],"webp"),h=1;h<=5;h++)this.createLevelSpineAndFindSlots(n,"mode1/skin_mode1_v".concat(h));case 4:case"end":return t.stop()}},t,this)})),function(e){return t.apply(this,arguments)})},{key:"createLevelSpineAndFindSlots",value:function(t,e){var n=gk.createSpine({spineName:t,skinName:e,autorun:!1,loop:!1,freeze:!0}),r={spineName:t,currentSkinName:e,hogItemsBone:"hogItems"};gk.findSlots(n,r)}}]);var t,e}();function Tk(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Sk(t,e){return t.get(kk(t,e))}function Ek(t,e,n){return t.set(kk(t,e),n),n}function kk(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mk=new WeakMap,Ck=new WeakMap,Pk=new WeakMap,Ik=new WeakMap,Rk=new WeakMap,Ok=new WeakMap,Dk=new WeakMap,Lk=new WeakMap,Fk=new WeakMap,Bk=new WeakMap,Nk=new WeakMap,Wk=new WeakMap,Uk=new WeakMap,jk=w(function t(e){var n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];g(this,t),Tk(this,Mk,void 0),Tk(this,Ck,void 0),Tk(this,Pk,void 0),Tk(this,Ik,void 0),Tk(this,Rk,void 0),S(this,"execute",function(){var t=Kl(Jl().mark(function t(e){var r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=0,i=10;case 1:if(!(r<i)){t.next=6;break}return t.prev=2,Ek(Ck,n,Sk(Wk,n).call(n,e)),t.next=3,Sk(Ok,n).call(n);case 3:return Sk(Uk,n).call(n,100),t.abrupt("continue",6);case 4:return t.prev=4,t.catch(2),r++,t.next=5,_g.showTextPreloadAttempts(Sk(Pk,n),r,i);case 5:t.next=1;break;case 6:case"end":return t.stop()}},t,null,[[2,4]])}));return function(e){return t.apply(this,arguments)}}()),Tk(this,Ok,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ag(Sk(Pk,n));case 1:return t.next=2,Sk(Dk,n).call(n);case 2:return t.next=3,Sk(Lk,n).call(n);case 3:return t.next=4,Sk(Fk,n).call(n);case 4:return t.next=5,Sk(Bk,n).call(n);case 5:return t.next=6,Sk(Nk,n).call(n);case 6:case"end":return t.stop()}},t)}))),Tk(this,Dk,Kl(Jl().mark(function t(){var e,r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ag(Sk(Pk,n));case 1:return e=Sk(Ck,n),r=e.levelList,i="levelBundle",Sk(Uk,n).call(n,0),t.next=2,Ds.addBundle(i,r);case 2:return Sk(Uk,n).call(n,20),t.next=3,Ds.loadBundle(i);case 3:case"end":return t.stop()}},t)}))),Tk(this,Lk,Kl(Jl().mark(function t(){var e,r,i,s;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ag(Sk(Pk,n));case 1:return e=Sk(Ck,n),r=e.spineLevelData,i=r.spineName,s=r.hybridPath,Ek(Ik,n,i),Sk(Uk,n).call(n,40),t.next=2,gk.loadAndParseSpineAsset({spineName:Sk(Ik,n),folderPath:"gameLevels",basePath:s});case 2:Ol.log(Cl.LevelPreload,"loadAndParseLevel is loaded");case 3:case"end":return t.stop()}},t)}))),Tk(this,Fk,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ag(Sk(Pk,n));case 1:if(0!==Sk(Mk,n).playerData.levelIndex){t.next=3;break}return Sk(Uk,n).call(n,44),t.next=2,gk.loadAndParseSpineAsset({spineName:"pinch",folderPath:"spines/pinch"});case 2:Ol.log(Cl.LevelPreload,"pinch is loaded");case 3:case"end":return t.stop()}},t)}))),Tk(this,Bk,Kl(Jl().mark(function t(){var e,r,i,s,o,a,l;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ag(Sk(Pk,n));case 1:return t.prev=1,e=Sk(Ck,n),r=e.spineLevelData,i=r.hudJson,s=r.hudDataName,o=Ds.get(s),Sk(Uk,n).call(n,60),t.next=2,by.loadJson(i);case 2:return a=t.sent,t.next=3,_g.createSpriteSheet(o,a,!0);case 3:Ol.log(Cl.LevelPreload,"createHudSpriteSheet is loaded"),t.next=5;break;case 4:t.prev=4,l=t.catch(1),console.error("[createHudSpriteSheet]",l);case 5:case"end":return t.stop()}},t,null,[[1,4]])}))),Tk(this,Nk,Kl(Jl().mark(function t(){var e,r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ag(Sk(Pk,n));case 1:return Ol.log(Cl.LevelPreload,"loadSpeech start"),(e=Gf.soundManager).clearSoundList(e.speechList),r=Sk(Ck,n),i=r.speechList,Sk(Uk,n).call(n,80),t.next=2,e.preload(e.speechList,i,!0);case 2:Ol.log(Cl.LevelPreload,"speech is loaded");case 3:case"end":return t.stop()}},t)}))),Tk(this,Wk,function(t){return function(t,e,n){var r=_v.getGameLevelData(n),i=_v.getSpeechAndTextData(t,e),s=i.introSpeech,o=i.outroSpeech,a=r.hudSpriteSheet,l=r.background,c=Gf.game.locale;return{spineLevelData:r,levelList:[a,l],onceLoadList:[],speechList:[{alias:s,src:"".concat(ml.remote,"assets/audio/speech/intro/").concat(c,"/").concat(s,".mp3")},{alias:o,src:"".concat(ml.remote,"assets/audio/speech/outro/").concat(c,"/").concat(o,".mp3")}]}}(Sk(Mk,n).game,Sk(Mk,n).storage,t)}),Tk(this,Uk,function(t){if(Sk(Rk,n)&&Sk(Pk,n)){var e=Sk(Mk,n).textPreloadData,r=e.textLevel,i=e.userLevel,s=e.textPart,o=e.partIndex,a=e.textLoading;Sk(Pk,n).text="".concat(r," ").concat(i,"\n").concat(s," ").concat(o,"\n").concat(a," ").concat(t,"%")}}),Ek(Mk,this,e),Ek(Pk,this,e.view.refs.preloadText),Ek(Rk,this,r)},[{key:"spineName",get:function(){return Sk(Ik,this)}}]),Hk=function(t,e){var n=e.spineName,r=e.isRemote,i=r?"tomato":"white",s=t.replace(/\d/," $&");console.log("level: ".concat(s," \nspineName ").concat(n," | isRemote %c").concat(r,"\n"),"color: ".concat(i,"; font-weight: bold"))},zk=w(function t(){g(this,t)});function Gk(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Xk(t,e){return t.get(Yk(t,e))}function Vk(t,e,n){return t.set(Yk(t,e),n),n}function Yk(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}S(zk,"getFilteredLevels",function(){var t=hv.getFilteredLevels(),e=Object.keys(t).length;Ol.log("","Total levels: ".concat(e),t)}),S(zk,"testLevelSlots",Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Ak,t.next=1,e.run();case 1:case"end":return t.stop()}},t)}))),S(zk,"testLoadingAllLevels",function(){var t=Kl(Jl().mark(function t(e){var n,r,i,s,o,a,l,c,h,u,d,p,f,m,g,v,y,x,w;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=Object.entries(hv.getFilteredLevels()),r=0,i=performance.now(),s=new jk(e,!1),t.prev=1,o=0,a=n;case 2:if(!(o<a.length)){t.next=6;break}return l=lv(a[o],2),c=l[0],h=l[1],u=performance.now(),Hk(c,h),t.next=3,s.execute(r);case 3:return d=s.spineName,t.next=4,e.clearLevelCache(d);case 4:r++,p=performance.now(),f=Math.trunc(p-u),console.log("Loading time:",f);case 5:o++,t.next=2;break;case 6:t.next=8;break;case 7:t.prev=7,w=t.catch(1),console.log("[LazyLoading]",w);case 8:m=performance.now(),g=Math.trunc(m-i),v=Tg(g),y=v.minutes,x=v.seconds,console.log("    ".concat(y," : ").concat(x));case 9:case"end":return t.stop()}},t,null,[[1,7]])}));return function(e){return t.apply(this,arguments)}}());var $k=new WeakMap,qk=new WeakMap,Kk=new WeakMap,Zk=new WeakMap,Qk=new WeakMap,Jk=new WeakMap,tM=w(function t(e){var n=this;g(this,t),Gk(this,$k,void 0),Gk(this,qk,void 0),Gk(this,Kk,void 0),Gk(this,Zk,void 0),S(this,"initView",function(){Vk($k,n,new Sg(Xk(qk,n))),Xk(qk,n).viewport.addChild(Xk($k,n)),Vk(Kk,n,Xk($k,n).refs.preloadText),new dT(Xk(qk,n),Xk($k,n)).init()}),S(this,"execute",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ag(Xk(Kk,n));case 1:return t.next=2,Xk(Qk,n).call(n);case 2:case"end":return t.stop()}},t)}))),Gk(this,Qk,Kl(Jl().mark(function t(){var e,r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!Xk(Zk,n)){t.next=1;break}return t.abrupt("return");case 1:e=Gf.gameConfig,r=0,i=10;case 2:if(!(r<i)){t.next=13;break}return t.prev=3,t.next=4,Ag(Xk(Kk,n));case 4:return Xk(Kk,n).text=Uc.t("textLoading.init")+" \n0%",t.next=5,e.loadStoryTexts();case 5:return t.next=6,Ag(Xk(Kk,n));case 6:return t.next=7,e.loadLocalesHud();case 7:return Xk(Kk,n).text=Uc.t("textLoading.init")+" \n25%",t.next=8,gk.loadAndParseSpineAsset({spineName:"character",folderPath:"spines/character"});case 8:return Xk(Kk,n).text=Uc.t("textLoading.init")+" \n50%",t.next=9,gk.loadAndParseSpineAsset({spineName:"smoke",folderPath:"spines/smoke"});case 9:return Xk(Kk,n).text=Uc.t("textLoading.init")+" \n75%",t.next=10,Xk(Jk,n).call(n);case 10:return Xk(Kk,n).text=Uc.t("textLoading.init")+" \n100%",Vk(Zk,n,!0),t.abrupt("continue",13);case 11:return t.prev=11,t.catch(3),r++,t.next=12,_g.showTextPreloadAttempts(Xk(Kk,n),r,i);case 12:t.next=2;break;case 13:case"end":return t.stop()}},t,null,[[3,11]])}))),Gk(this,Jk,Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,by.loadSpriteSheet({spriteSheetName:"levelUi",folderPath:"ui"});case 1:t.next=3;break;case 2:t.prev=2,e=t.catch(0),Ol.warn(Cl.GamePreload,e);case 3:case"end":return t.stop()}},t,null,[[0,2]])}))),Vk(qk,this,e.game)},[{key:"view",get:function(){return Xk($k,this)}}]);function eM(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function nM(t,e){return t.get(iM(t,e))}function rM(t,e,n){return t.set(iM(t,e),n),n}function iM(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sM=new WeakMap,oM=new WeakMap,aM=new WeakMap,lM=new WeakMap,cM=new WeakMap,hM=new WeakMap,uM=w(function t(e){var n=this;g(this,t),eM(this,sM,void 0),eM(this,oM,void 0),eM(this,aM,void 0),eM(this,lM,void 0),S(this,"execute",function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,nM(cM,n).call(n,e);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),eM(this,cM,function(){var t=Uc.t("level"),e=nM(aM,n).userLevel,r=Uc.t("textLoadingSkinPart"),i=nM(hM,n).call(n),s=Uc.t("textLoading");rM(lM,n,{textLevel:t,userLevel:e,textPart:r,partIndex:i,textLoading:s})}),eM(this,hM,function(){var t=nM(sM,n).playerData,e=t.skinIndex;return t.partIndex<5&&(nM(sM,n).playerData.partIndex=e),nM(sM,n).playerData.partIndex}),rM(sM,this,e),rM(oM,this,e.game),rM(aM,this,e.storage)},[{key:"textPreloadData",get:function(){return nM(lM,this)}}]);function dM(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function pM(t,e){return t.get(mM(t,e))}function fM(t,e,n){return t.set(mM(t,e),n),n}function mM(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gM=new WeakMap,vM=new WeakMap,yM=new WeakMap,xM=new WeakMap,wM=w(function t(e){var n=this;g(this,t),dM(this,gM,void 0),dM(this,vM,void 0),dM(this,yM,void 0),S(this,"startGame",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,pM(xM,n).call(n);case 1:return t.next=2,pM(gM,n).terminate();case 2:pM(yM,n).emit(cl);case 3:case"end":return t.stop()}},t)}))),dM(this,xM,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ff.timeline().to(pM(vM,n),{alpha:0,delay:0});case 1:case"end":return t.stop()}},t)}))),fM(gM,this,e),fM(yM,this,e.game),fM(vM,this,e.view)});function _M(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_M=function(){return!!t})()}function bM(t,e,n,r){var i=Zl(b(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function AM(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function TM(t,e,n){return t.set(EM(t,e),n),n}function SM(t,e){return t.get(EM(t,e))}function EM(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kM=new WeakMap,MM=new WeakMap,CM=new WeakMap,PM=new WeakMap,IM=new WeakMap,RM=new WeakMap,OM=new WeakMap,DM=new WeakMap,LM=function(t){function e(){var t;g(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=function(t,e,n){return e=b(e),_(t,_M()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[].concat(r)),S(t,"view",void 0),S(t,"storage",void 0),S(t,"playerData",void 0),S(t,"levelIndex",void 0),S(t,"textPreloadData",void 0),AM(t,kM,void 0),AM(t,MM,!1),AM(t,CM,Kl(Jl().mark(function e(){var n;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new tM(t)).initView(),t.view=n.view,e.next=1,n.execute();case 1:t.isInitialized=!0;case 2:case"end":return e.stop()}},e)}))),AM(t,PM,Kl(Jl().mark(function e(){var n;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new uM(t),e.next=1,n.execute(t.levelIndex);case 1:t.textPreloadData=n.textPreloadData;case 2:case"end":return e.stop()}},e)}))),AM(t,IM,function(){var e=Kl(Jl().mark(function e(n){var r;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new jk(t,!0),e.next=1,r.execute(n);case 1:TM(kM,t,r.spineName);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),AM(t,RM,Kl(Jl().mark(function e(){var n;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new wM(t),e.next=1,n.startGame();case 1:case"end":return e.stop()}},e)}))),S(t,"clearLevelCache",function(){var e=Kl(Jl().mark(function e(n){var r,i,s;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n||SM(kM,t)){e.next=1;break}return e.abrupt("return");case 1:return e.prev=1,e.next=2,Ds.unloadBundle("levelBundle");case 2:return Ol.log(Cl.LevelPreload," levelBundle"),e.next=3,Ds.unload(r);case 3:return e.next=4,Ds.cache._cache.delete("".concat(r,".spineData"));case 4:(i=Gf.soundManager).clearSoundList(i.speechList),e.next=6;break;case 5:e.prev=5,s=e.catch(1),console.error(s);case 6:case"end":return e.stop()}},e,null,[[1,5]])}));return function(t){return e.apply(this,arguments)}}()),AM(t,OM,Kl(Jl().mark(function e(){return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!SM(MM,t)){e.next=1;break}return e.abrupt("return");case 1:return e.next=2,Gf.soundManager.preloadSFXFLevel();case 2:TM(MM,t,!0);case 3:case"end":return e.stop()}},e)}))),AM(t,DM,Kl(Jl().mark(function e(){return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,zk.testLoadingAllLevels(t);case 1:case"end":return e.stop()}},e)}))),t}return T(e,t),w(e,[{key:"initEventName",get:function(){return hl}},{key:"initialize",value:(n=Kl(Jl().mark(function t(){var n;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return bM(e,"initialize",this,3)([]),this.storage=Gf.storage,this.levelIndex=this.storage.playerData.levelIndex,this.playerData=this.storage.playerData,this.game.clearLevelCache=this.clearLevelCache,n=_g.maybeShowAd(this.storage,this.levelIndex),this.clearLevelCache(),t.next=1,SM(CM,this).call(this);case 1:return t.next=2,SM(PM,this).call(this);case 2:return t.next=3,SM(IM,this).call(this,this.levelIndex);case 3:return SM(OM,this).call(this),t.next=4,n;case 4:return t.next=5,SM(RM,this).call(this);case 5:case"end":return t.stop()}},t,this)})),function(){return n.apply(this,arguments)})},{key:"resize",value:function(){this.view.resize()}},{key:"terminate",value:function(){this.game.emit(zg),this.isInitialized=!1,this.view.destroy({children:!0}),this.game.uiInner.removeChildren(),this.view=null,this.storage=null,this.playerData=null,this.levelIndex=null,this.textPreloadData=null}}]);var n}(jc);function FM(){return FM=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},FM.apply(null,arguments)}function BM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function NM(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?BM(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BM(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function WM(){var t={},e={cursor:"pointer",eventMode:"static"},n=function(){var t,n=null!==(t=gg.flags)&&void 0!==t&&null!==(t=t.platform)&&void 0!==t&&t.noStore?0:104;return Xc(Ti,FM({name:"btnPlayReward",x:n,y:80,texture:"btn-bronze",anchor:{x:.5,y:.5}},e),Xc(ki,{texture:"btn-gold",anchor:{x:.5,y:.5},scale:{x:.66,y:.66}}),Xc(Ti,{name:"btnTopContainer"},Xc(ki,{texture:"icon-play",x:-54,anchor:{x:.5,y:.5}}),Xc(ma,{text:"+".concat(yx.store.free.hints),name:"textPlay1",x:-6,style:NM(NM({},Yy),{},{fontSize:32}),anchor:{x:.5,y:.5}}),Xc(ki,{texture:"icon-loupe",x:45,anchor:{x:.5,y:.5},scale:{x:.4,y:.4}})),Xc(Ti,{name:"btnTimerContainer",visible:!1},Xc(ma,{text:"00:60",name:"priceText",y:-2,style:NM(NM({},Yy),{},{fontSize:32}),anchor:{x:.5,y:.5}})))};return Xc(ux,{ref:function(e){return t.root=e},eventMode:"static",visible:!1,zIndex:9,size:{w:430,h:260}},Xc(function(){var t,e=!(null!==(t=gg.flags)&&void 0!==t&&null!==(t=t.platform)&&void 0!==t&&t.noStore);return Xc(Ti,{name:"innerContainer"},Xc(ma,{text:"".concat(Uc.t("notEnoughHints")),y:-88,anchor:{x:.5,y:.5},style:NM(NM({},Yy),{},{fontSize:30})}),Xc(ki,{texture:"icon-loupe-plus",y:-20,anchor:{x:.5,y:.5}}),Xc(rx,{name:"btnStore",visible:e,texture:"btn-bronze",text:"".concat(Uc.t("store")),x:-104,y:80,scaleValue:.66,style:NM(NM({},Yy),{},{fontSize:28})}),Xc(n,null))},null))}function UM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function jM(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?UM(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UM(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function HM(){var t={},e={fade:{texture:Kn.WHITE,width:ol.WIDTH,height:ol.HEIGHT,tint:0,alpha:.65},popUp:Xy({x:ol.HALF_W,y:ol.HALF_H,"(orientation: landscape)":{}}),btnClose:{x:210,y:-70,anchor:{x:.5,y:.5},scale:{x:.8,y:.8},cursor:"pointer",eventMode:"static"},btnRhomb:jM(jM({},Yy),{},{fontSize:21})};return Xc(ux,{ref:function(e){return t.root=e}},Xc(function(){return Xc(Ti,{name:"innerContainer"},function(){for(var t=[],e=0,n=0;n<5;n++){var r=new ki(Kn.from("icon-star"));r.anchor.set(.5),e||(e=r.width);var i=(n-2)*e;r.position.set(i,-110),t.push(r)}return t}(),Xc(ma,{text:"".concat(Uc.t("rateUs")),y:-40,anchor:{x:.5,y:.5},style:jM(jM({},Yy),{},{fontSize:26,align:"center"})}),Xc(Ti,{y:30},Xc(ma,{x:-30,text:"+5",anchor:{x:.5,y:.5},style:jM(jM({},Yy),{},{fontSize:40})}),Xc(ki,{x:24,y:-6,texture:"icon-loupe",scale:{x:.42,y:.42},anchor:{x:.5,y:.5}})),Xc(rx,{x:-104,y:100,name:"btnLater",texture:"btn-silver",scaleValue:.65,text:"".concat(Uc.t("rateUsBtnLater")),style:e.btnRhomb}),Xc(rx,{x:104,y:100,name:"btnEnter",texture:"btn-gold",scaleValue:.65,text:"".concat(Uc.t("rateUsBtnGive")),style:e.btnRhomb}))},null))}var zM=function(t){var e,n=t.refs;return yg({w:640,h:120}).alpha=.2,Xc(Ti,{name:"hudView",y:ol.HEIGHT-120},((e=new Vo).beginFill(0),e.drawRect(0,-10,ol.WIDTH,140),e.endFill(),e.alpha=.75,e),Xc(Ti,{name:"hudInner",ref:function(t){return n.hudInner=t},x:ol.HALF_W,y:60,pivot:{x:320,y:60}}))};function GM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function XM(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?GM(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):GM(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var VM=XM(XM({},Yy),{},{fill:16046212,fontSize:24}),YM=function(){return Xc(ma,{style:VM,anchor:{x:1,y:.5},x:-10,y:0})};function $M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function qM(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$M(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$M(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var KM=function(t){var e=t.refs;return Xc(ki,{texture:"speech-bubble",ref:function(t){return e.speechBubble=t},angle:10,anchor:{x:.5,y:.5},y:500},Xc(ki,{texture:"speech-bubble-center",anchor:{x:.5,y:.5},x:-12,y:22},Xc(ma,{style:qM(qM({},Yy),{fontFamily:"Pacifico",wordWrap:!0,wordWrapWidth:320,align:"center",fontSize:26,lineHeight:24,fontWeight:"normal"}),ref:function(t){return e.speechBubbleText=t},anchor:{x:.5,y:.5}})))},ZM=function(t){var e=t.refs,n=gk.createSpine({spineName:"character",autorun:!1});return e.character=n,n.scale.set(.7),n.position.set(-250,0),Xc(Ti,{x:ol.HALF_W,y:0},n,Xc(KM,{refs:e}))};function QM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function JM(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?QM(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QM(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var tC={view:Xy({x:ol.HALF_W,y:ol.HALF_H+40,zIndex:1,"(orientation: landscape)":{}}),btnNextStyle:JM(JM({},Yy),{},{fontSize:36})},eC=ol.HALF_W,nC=function(t){var e,n=t.refs,r=!(null!==(e=gg.flags)&&void 0!==e&&null!==(e=e.platform)&&void 0!==e&&e.noStore);return Xc(Ti,{ref:function(t){return n.completeLevelView=t},style:tC.view},Xc(ZM,{refs:n}),Xc(Ti,{name:"btnsContainer",x:eC,y:800},Xc(nx,{name:"btnNext",texture:"btn-gold",text:"".concat(Uc.t("level")),textStyle:tC.btnNextStyle}),Xc(tx,{name:"btnBuyLoupe",texture:"icon-loupe-plus",x:-155,y:195,iconScale:.6,visible:r}),Xc(Jy,{name:"btnHome",texture:"icon-home",y:199,scale:{x:.83,y:.83}}),Xc(tx,{name:"btnByeAd",texture:"icon-noAd",x:155,y:195,iconScale:1.22,visible:r})))},rC=function(t){var e=t.refs;return Xc(ki,{ref:function(t){return e.errorCross=t},name:"errorCross",texture:"error-cross",zIndex:1,anchor:{x:.5,y:.5},visible:!1})};function iC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function sC(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?iC(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):iC(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function oC(t){var e={},n=function(){return Xc(Ti,{ref:function(t){return e.levelContainer=t},name:"levelContainer",sortableChildren:!0},function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.color,n=void 0===e?0:e,r=t.alpha,i=void 0===r?.5:r,s=new Vo;return s.beginFill(n),s.drawRect(0,0,ol.WIDTH,ol.HEIGHT),s.endFill(),s.alpha=i,s}(),Xc(rC,{refs:e}),Xc(ki,{ref:function(t){return e.hintStars=t},anchor:{x:.5,y:.5},texture:"hint-stars",name:"hintStars",zIndex:1,visible:!1,eventMode:"none"}))};return t.uiInner.addChild(Xc(ix,{refs:e,game:t}),Xc(function(t){var e=t.game,n=t.refs;return Xc(Ti,{ref:function(t){return n.btnHint=t},name:"btnHint",classes:$y(e).btnHint,visible:!1},Xc(ex,{texture:"btn-hint"}),Xc(YM,{ref:function(t){return n.textHintsAmount=t}}))},{refs:e,game:t}),Xc(function(t){var e=t.refs,n=t.game;return Xc(ki,{ref:function(t){return e.introSpeechBubble=t},name:"introSpeechBubble",classes:$y(n).introSpeechBubble},Xc(ma,{name:"speechBubbleText",style:sC(sC({},Yy),{fontFamily:"Pacifico",wordWrap:!0,wordWrapWidth:330,align:"center",fontSize:26,fill:16046212,fontWeight:"normal"}),anchor:{x:.5,y:.5},y:10,text:'"  ,  ,    .     ."'}))},{refs:e,game:t})),Xc(Ti,{refs:e,resize:function(){return bg(e)},sortableChildren:!0,name:"levelView"},Xc(ki,{ref:function(t){return e.fade=t},name:"fade",visible:!0,alpha:0,classes:qy.fade}),Xc(function(){return Xc(Ti,{ref:function(t){return e.wrapper=t},name:"wrapper",sortableChildren:!0},Xc(n,null),Xc(zM,{ref:function(t){return e.hudView=t},refs:e,visible:!1}),Xc(nC,{game:t,refs:e,visible:!1}),Xc(Ex,{ref:function(t){return e.storeView=t}}),Xc(fx,{ref:function(t){return e.purchaseErrorView=t},visible:!1}),Xc(WM,{ref:function(t){return e.noHintsPopupView=t}}),Xc(HM,{ref:function(t){return e.rateUsView=t},visible:!1}))},null),Xc(ki,{ref:function(t){return e.mainFade=t},visible:!1,alpha:0,classes:qy.fade}),Xc(sx,{ref:function(t){return e.optionsView=t},visible:!1}))}r(6033);var aC=w(function t(e){g(this,t),this.id=e,this.components=new Map},[{key:"addComponent",value:function(t){this.components.set(t.constructor.name,t)}},{key:"getComponent",value:function(t){return this.components.get(t.name)}},{key:"hasComponent",value:function(t){return this.components.has(t.name)}}]);function lC(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(lC=function(){return!!t})()}var cC=new WeakMap,hC=function(t){function e(t,n){var r;return g(this,e),r=function(t,e,n){return e=b(e),_(t,lC()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[Kn.from(n)]),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(r,cC,r),r.view.name="background",r}return T(e,t),w(e,[{key:"view",get:function(){return function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(cC,this)}}])}(ki);function uC(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function dC(t,e){return t.get(pC(t,e))}function pC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fC=new WeakMap,mC=new WeakMap,gC=w(function t(e){var n=this,r=e.spineName,i=e.currentSkinName;g(this,t),uC(this,fC,null),uC(this,mC,function(){!function(t,e,n){t.set(pC(t,e),n)}(fC,n,gk.createSpine({spineName:n.spineName,skinName:n.currentSkinName,autorun:!1,loop:!1})),dC(fC,n).spineData.animations.some(function(t){return"idle"===t.name})&&dC(fC,n).state.setAnimation(0,"idle",!0),n.spine.eventMode="static"}),this.spineName=r,this.currentSkinName=i,dC(mC,this).call(this)},[{key:"spine",get:function(){return dC(fC,this)}}]);function vC(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(vC=function(){return!!t})()}function yC(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function xC(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var wC=new WeakMap,_C=new WeakMap,bC=new WeakMap,AC=new WeakMap,TC=new WeakMap,SC=new WeakMap,EC=new WeakMap,kC=new WeakMap,MC=new WeakMap,CC=new WeakMap,PC=function(t){function e(){var t;return g(this,e),t=function(t,e){return e=b(e),_(t,vC()?Reflect.construct(e,[],b(t).constructor):e.apply(t,void 0))}(this,e),yC(t,wC,window.game),yC(t,_C,xC(wC,t).refs),S(t,"slotContainer",null),S(t,"sprite",null),S(t,"isMesh",!1),S(t,"isAlive",!0),S(t,"debugRect",null),S(t,"eventMode","static"),S(t,"onHandlerUp",function(){t.view.eventMode="auto",Xm(t.hintTimeline,!0,1),xC(wC,t).emit(Bg,t),Ff.timeline().to(t.sprite,{alpha:1}).to(t.view,{alpha:0,duration:.5},"<").eventCallback("onComplete",xC(kC,t))}),S(t,"init",function(){var e=Kl(Jl().mark(function e(n,r){var i;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.skeleton.findSlotIndex(n.data.name),t.slotContainer=r.slotContainers[i],e.next=1,xC(AC,t).call(t);case 1:xC(TC,t).call(t),xC(SC,t).call(t),xC(EC,t).call(t),xC(CC,t).call(t);case 2:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),yC(t,bC,function(){}),yC(t,AC,function(){return new Promise(function(e){var n=function(){t.slotContainer&&t.slotContainer.children.length>0?e():Ff.delayedCall(.1,n)};Ff.delayedCall(.1,n)})}),yC(t,TC,function(){t.sprite=t.slotContainer.children.find(function(e){return e instanceof QT&&(t.isMesh=!0),e instanceof ZT||e instanceof QT}),t.sprite.initAlpha=t.sprite.alpha,t.view.addChild(t.sprite)}),yC(t,SC,function(){var e=t.sprite.attachment.name;t.name=e.split("/").pop()}),yC(t,EC,function(){t.view.pivot.set(t.sprite.x,t.sprite.y),t.view.position.set(t.sprite.x,t.sprite.y),t.slotContainer.addChild(t.view)}),yC(t,kC,function(){t.slotContainer.removeChild(t.view),t.isAlive=!1,t.sprite.filters=[],t.view.eventMode="none",xC(wC,t).off(Fg,xC(MC,t)),xC(wC,t).off(Bg,t)}),yC(t,MC,function(e){t.debugRect.visible=e}),yC(t,CC,function(){var e=t.sprite.getLocalBounds(),n=new Vo;n.lineStyle(4,582144),n.drawRect(e.x,e.y,e.width,e.height),n.visible=t.storage.playerData.option_isDebug,t.debugRect=n,t.sprite.addChild(n)}),t.view=t,t.typeName="hogItemContainer",t.storage=Gf.storage,xC(wC,t).on(Fg,xC(MC,t)),t}return T(e,t),w(e)}(Ti);function IC(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function RC(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var OC=new WeakMap,DC=new WeakMap,LC=w(function t(){var e=this;g(this,t),S(this,"slotContainer",null),S(this,"init",function(){var t=Kl(Jl().mark(function t(n,r){var i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.skeleton.findSlotIndex(n.data.name),e.slotContainer=r.slotContainers[i],t.next=1,RC(OC,e).call(e);case 1:RC(DC,e).call(e);case 2:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),IC(this,OC,function(){return new Promise(function(t){var n=function(){e.slotContainer&&e.slotContainer.children.length>0?t():Ff.delayedCall(.1,n)};Ff.delayedCall(.1,n)})}),IC(this,DC,function(){e.slotContainer.children.find(function(t){return t.eventMode="none"})}),this.view=this});function FC(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function BC(t,e){return t.get(NC(t,e))}function NC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var WC=new WeakMap,UC=new WeakMap,jC=new WeakMap,HC=new WeakMap,zC=new WeakMap,GC=new WeakMap,XC=w(function t(e){var n=this;g(this,t),FC(this,WC,void 0),FC(this,UC,[]),FC(this,jC,new Map),S(this,"createEntities",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,BC(HC,n).call(n);case 1:return t.next=2,BC(zC,n).call(n);case 2:return n.disableIdleInteractive(["decorItems","idle","hogItems2"]),t.abrupt("return",Promise.resolve());case 3:case"end":return t.stop()}},t)}))),S(this,"disableIdleInteractive",function(t){Array.isArray(t)||(t=[t]),t.forEach(function(t){gk.getSlotsRecursively(n.spineLevelComponent,t).forEach(function(t){(new LC).init(t,n.spineLevelComponent)})})}),S(this,"enableIdleInteractive",function(t){Array.isArray(t)||(t=[t]),t.forEach(function(t){gk.getSlotsRecursively(n.spineLevelComponent,t).forEach(function(t){var e=n.spineLevelComponent.skeleton.findSlotIndex(t.data.name),r=n.spineLevelComponent.slotContainers[e];r&&r.children.forEach(function(t){t.eventMode="auto"})})})}),FC(this,HC,Kl(Jl().mark(function t(){var e,r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=BC(WC,n).bgTexture,r=new aC(e),(i=new hC(r,e)).view.alpha=1,r.addComponent(i),BC(jC,n).set(r.id,r),t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}},t)}))),FC(this,zC,Kl(Jl().mark(function t(){var e,r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=BC(WC,n).spineName,r=new aC(e),i=new gC(BC(WC,n)),r.addComponent(i),BC(jC,n).set(r.id,r);case 1:case"end":return t.stop()}},t)}))),FC(this,GC,function(t){return BC(jC,n).get(t)}),S(this,"createHogItems",function(t){t.forEach(function(t){var e=new PC;BC(UC,n).push(e),e.init(t,n.spineLevelComponent).then(function(){return window.game.emit(Gg,e)})})}),function(t,e,n){t.set(NC(t,e),n)}(WC,this,e)},[{key:"entities",get:function(){return BC(jC,this)}},{key:"initialHogItems",get:function(){return BC(UC,this)}},{key:"spineLevelComponent",get:function(){var t=BC(GC,this).call(this,BC(WC,this).spineName);return t?t.getComponent(gC).spine:(console.warn("spineEntityLevel is not created"),!1)}},{key:"interactiveSlots",get:function(){return gk.findSlots(this.spineLevelComponent,BC(WC,this))}}]),VC=w(function t(){g(this,t),this.entities=new Set},[{key:"addEntity",value:function(t){this.entities.add(t)}},{key:"removeEntity",value:function(t){this.entities.delete(t)}},{key:"init",value:function(){throw new Error("System update method not implemented")}}]);function YC(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(YC=function(){return!!t})()}function $C(t,e,n){qC(t,e),e.set(t,n)}function qC(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KC(t,e){return t.get(ZC(t,e))}function ZC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var QC=new WeakMap,JC=new WeakMap,tP=new WeakMap,eP=new WeakSet,nP=function(t){function e(){var t;return g(this,e),t=function(t,e){return e=b(e),_(t,YC()?Reflect.construct(e,[],b(t).constructor):e.apply(t,void 0))}(this,e),function(t,e){qC(t,e),e.add(t)}(t,eP),$C(t,QC,window.game),$C(t,JC,KC(QC,t).refs),$C(t,tP,KC(JC,t).levelContainer),t}return T(e,t),w(e,[{key:"init",value:function(){var t=this;this.entities.forEach(function(e){ZC(eP,t,rP).call(t,e),ZC(eP,t,iP).call(t,e)})}}])}(VC);function rP(t){var e=t.getComponent(hC);if(e){var n=e.view;KC(tP,this).children.includes(n)||KC(tP,this).addChild(n)}}function iP(t){var e=t.getComponent(gC);if(e){var n=e.spine;KC(tP,this).children.includes(n)||KC(tP,this).addChild(n)}}function sP(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function oP(t,e,n){return t.set(lP(t,e),n),n}function aP(t,e){return t.get(lP(t,e))}function lP(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cP=new WeakMap,hP=new WeakMap,uP=new WeakMap,dP=new WeakMap,pP=w(function t(e){var n=this;g(this,t),sP(this,cP,null),sP(this,hP,null),sP(this,uP,function(t){var e=t.data;oP(cP,n,Object.assign({},e.global))}),sP(this,dP,function(t){var e,r,i,s,o=t.target;if("hogItemContainer"===o.typeName&&aP(cP,n)){oP(hP,n,t.data.global);var a=(null===(e=aP(cP,n))||void 0===e?void 0:e.x)-(null===(r=aP(hP,n))||void 0===r?void 0:r.x),l=(null===(i=aP(cP,n))||void 0===i?void 0:i.y)-(null===(s=aP(hP,n))||void 0===s?void 0:s.y);Math.sqrt(a*a+l*l)>20||(o.isAlive=!1,o.onHandlerUp())}}),this.spineContainer=e.spineLevelComponent},[{key:"init",value:function(){this.spineContainer.eventMode="static",this.spineContainer.on("pointerdown",aP(uP,this)),this.spineContainer.on("pointerup",aP(dP,this))}},{key:"destroy",value:function(){this.spineContainer.eventMode="none",this.spineContainer.off("pointerdown",aP(uP,this)),this.spineContainer.off("pointerup",aP(dP,this)),Ol.log(Cl.DestroyMessage,"[ClickSystem] destroy")}}]);function fP(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function mP(t,e,n){return t.set(vP(t,e),n),n}function gP(t,e){return t.get(vP(t,e))}function vP(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yP=new WeakMap,xP=new WeakMap,wP=new WeakMap,_P=new WeakMap,bP=new WeakMap,AP=new WeakMap,TP=new WeakMap,SP=new WeakMap,EP=new WeakMap,kP=new WeakMap,MP=new WeakMap,CP=new WeakMap,PP=new WeakMap,IP=new WeakMap,RP=new WeakMap,OP=new WeakMap,DP=new WeakMap,LP=w(function t(e){var n=this;g(this,t),fP(this,yP,window.game),fP(this,xP,gP(yP,this).refs),fP(this,wP,""),fP(this,_P,void 0),fP(this,bP,void 0),fP(this,AP,null),fP(this,TP,40),fP(this,SP,!1),fP(this,EP,void 0),fP(this,kP,function(t){var e=t?"on":"off";gP(yP,n)[e](Bg,gP(IP,n)),gP(yP,n)[e](Vg,gP(CP,n)),gP(yP,n)[e](Ug,gP(MP,n))}),fP(this,MP,function(){mP(SP,n,!1)}),fP(this,CP,function(t){var e=t.maxItems;t.itemsFound+1>=e&&mP(SP,n,!0)}),fP(this,PP,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=gP(EP,n),i=r.introSpeech,s=r.outroSpeech;Ff.delayedCall(e,function(){var e=t?i:s;gP(bP,n).play(e),mP(wP,n,e)})}),fP(this,IP,function(t){var e;if(!gP(bP,n).isPlaying(gP(wP,n))&&!gP(SP,n)){var r=Math.ceil(null===(e=gP(AP,n))||void 0===e?void 0:e.remainingTime);if(gP(AP,n)&&r>0)return _g.hasWord(t.name,"cat")?void gP(DP,n).call(n,"meow",4):void gP(DP,n).call(n,"sfx_click",9);r<=0&&(gP(AP,n).kill(),mP(AP,n,null)),gP(OP,n).call(n),gP(RP,n).call(n)}}),fP(this,RP,function(){mP(AP,n,new ww({game:gP(yP,n),duration:gP(TP,n),label:gP(wP,n)})),gP(AP,n).start()}),fP(this,OP,function(){gP(bP,n).playRandomSpeech({maxCount:60,nameTemplate:"sfx_{locale}_clickItem{i}"})}),fP(this,DP,function(t,e){var r=Gm.getRandomNumber(0,e,0),i="".concat(t).concat(r);mP(wP,n,i),gP(bP,n).play(i)}),this.level=e},[{key:"init",value:function(){mP(_P,this,Gf.storage),mP(bP,this,Gf.soundManager),mP(EP,this,_v.getSpeechAndTextData(gP(yP,this),gP(_P,this))),gP(kP,this).call(this,!0),gP(PP,this).call(this,!0,.1)}},{key:"destroy",value:function(){gP(kP,this).call(this,!1),Ol.log(Cl.DestroyMessage,"[ClickSoundSystem] destroy")}}]);function FP(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function BP(t,e){return t.get(WP(t,e))}function NP(t,e,n){return t.set(WP(t,e),n),n}function WP(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var UP=new WeakMap,jP=new WeakMap,HP=new WeakMap,zP=new WeakMap,GP=new WeakMap,XP=new WeakMap,VP=new WeakMap,YP=new WeakMap,$P=new WeakMap,qP=new WeakMap,KP=new WeakMap,ZP=w(function t(e){var n=this;g(this,t),FP(this,UP,window.game),FP(this,jP,void 0),FP(this,HP,void 0),FP(this,zP,null),FP(this,GP,hv.levelAdDelay),FP(this,XP,!1),FP(this,VP,function(){NP(zP,n,new ww({game:BP(UP,n),duration:BP(GP,n),label:"AdLvlTimer",log:!1})),BP(zP,n).start()}),FP(this,YP,function(t){var e=t?"on":"off";BP(UP,n)[e](Bg,BP(KP,n)),BP(UP,n)[e](Vg,BP(qP,n)),BP(UP,n)[e](Ug,BP($P,n))}),FP(this,$P,function(){NP(XP,n,!1)}),FP(this,qP,function(t){var e=t.maxItems;t.itemsFound+1>=e&&NP(XP,n,!0)}),FP(this,KP,Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!BP(XP,n)){t.next=1;break}return t.abrupt("return");case 1:if(!(Math.ceil(null===(e=BP(zP,n))||void 0===e?void 0:e.remainingTime)>0)){t.next=2;break}return t.abrupt("return");case 2:return t.next=3,gg.showInterstitial();case 3:BP(VP,n).call(n);case 4:case"end":return t.stop()}},t)}))),this.level=e},[{key:"init",value:function(){NP(jP,this,Gf.storage);var t=BP(jP,this).playerData.levelIndex;_g.shouldSkipPrerollOnFirstLevel(t)?Ol.log("","[AdLvlTimer] The first level does not show a timer!"):BP(jP,this).playerData.hasAdPass||(NP(HP,this,Gf.soundManager),BP(YP,this).call(this,!0),BP(VP,this).call(this))}},{key:"destroy",value:function(){BP(YP,this).call(this,!1),Ol.log(Cl.DestroyMessage,"[AdLvlTimer] destroy")}}]);function QP(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function JP(t,e,n){return t.set(eI(t,e),n),n}function tI(t,e){return t.get(eI(t,e))}function eI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nI=new WeakMap,rI=new WeakMap,iI=new WeakMap,sI=new WeakMap,oI=new WeakMap,aI=new WeakMap,lI=new WeakMap,cI=w(function t(){var e=this;g(this,t),QP(this,nI,window.game),QP(this,rI,0),QP(this,iI,0),S(this,"init",function(){tI(sI,e).call(e,!0)}),S(this,"destroy",function(){tI(sI,e).call(e,!1),JP(rI,e,0),JP(iI,e,0)}),QP(this,sI,function(t){var n=t?"on":"off";tI(nI,e)[n](jg,tI(oI,e)),tI(nI,e)[n](Wg,tI(aI,e)),tI(nI,e)[n](Ng,tI(lI,e))}),QP(this,oI,function(){ag.hintCounter(Gf.storage,tI(rI,e)),ag.missClickCounter(Gf.storage,tI(iI,e))}),QP(this,aI,function(){var t;JP(rI,e,(t=tI(rI,e),++t))}),QP(this,lI,function(){var t;JP(iI,e,(t=tI(iI,e),++t))})});function hI(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function uI(t,e){return t.get(dI(t,e))}function dI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pI=new WeakMap,fI=new WeakMap,mI=w(function t(e){var n=this;g(this,t),hI(this,pI,{}),hI(this,fI,function(){uI(pI,n).hintCounter=new cI,Object.values(uI(pI,n)).forEach(function(t){return t.init()})}),this.level=e},[{key:"init",value:function(){uI(fI,this).call(this)}},{key:"destroy",value:function(){Object.values(uI(pI,this)).forEach(function(t){return t.destroy()}),function(t,e){t.set(dI(t,e),{})}(pI,this),Ol.log(Cl.DestroyMessage,"[MetrikaSystem] destroy")}}]);function gI(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function vI(t,e){return t.get(xI(t,e))}function yI(t,e,n){return t.set(xI(t,e),n),n}function xI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wI=new WeakMap,_I=new WeakMap,bI=new WeakMap,AI=new WeakMap,TI=new WeakMap,SI=new WeakMap,EI=new WeakMap,kI=w(function t(e){var n=this;g(this,t),gI(this,wI,void 0),gI(this,_I,[]),gI(this,bI,void 0),gI(this,AI,0),gI(this,TI,function(t){var e=t?"on":"off";Gf.game[e](Xg,vI(EI,n))}),S(this,"checkAvailableParts",function(t,e){var r=e.spineLevelComponent;t.levelParts.forEach(function(t){var e=r.skeleton.findBone(t);e&&vI(_I,n).push({boneName:t,bone:e})})}),gI(this,SI,function(t){vI(_I,n).forEach(function(e){var n=e.bone;e.i>=1&&t.disableIdleInteractive(n)})}),gI(this,EI,function(){var t;if(yI(AI,n,(t=vI(AI,n),++t)),vI(AI,n)>=vI(bI,n))return console.group("---------------"),console.log("COMPLETE GAME!"),console.log("---------------"),console.groupEnd(),void Gf.game.emit(Hg);var e=vI(wI,n).config;e.hogItemsBone=vI(_I,n)[vI(AI,n)].boneName,Gf.game.emit(Ug),console.warn("hogItemsBone",e.hogItemsBone),console.warn("partsCounter",vI(AI,n))}),yI(wI,this,e)},[{key:"init",value:function(){var t=vI(wI,this),e=t.config,n=t.entityManager;this.checkAvailableParts(e,n),vI(SI,this).call(this,n),e.hogItemsBone=vI(_I,this)[0].boneName,yI(bI,this,vI(_I,this).length),console.warn("",vI(bI,this)," "),vI(TI,this).call(this,!0)}},{key:"destroy",value:function(){vI(TI,this).call(this,!1)}}]);function MI(t,e){return t.get(CI(t,e))}function CI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var PI,II=new WeakMap,RI=w(function t(e){g(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,void 0)}(this,II),S(this,"systems",new Map),S(this,"entityManager",void 0),function(t,e,n){t.set(CI(t,e),n)}(II,this,e),this.entityManager=e.entityManager},[{key:"initSystems",value:function(){this.entityManager.spineLevelComponent&&(this.systems.set("clickSystem",new pP(this.entityManager)),this.systems.set("clickSoundSystem",new LP(MI(II,this))),this.systems.set("adLvlTimer",new ZP(MI(II,this))),this.systems.set("metrikaSystem",new mI(MI(II,this))),this.systems.set("levelPartSystem",new kI(MI(II,this))));var t=new nP;this.systems.set("renderSystem",t),this.entityManager.entities.forEach(function(e){t.addEntity(e)}),this.systems.forEach(function(t){return t.init()})}},{key:"removeSystem",value:function(t){var e=this.systems.get(t);e&&e.destroy&&(e.destroy(),this.systems.delete(t))}},{key:"removeAllSystems",value:function(){var t=this;this.systems.forEach(function(e,n){return t.removeSystem(n)}),this.systems.clear()}}]);function OI(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(OI=function(){return!!t})()}function DI(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function LI(t,e){return t.get(FI(t,e))}function FI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var BI=new WeakMap,NI=new WeakMap,WI=new WeakMap,UI=new WeakMap,jI=new WeakMap,HI=new WeakMap,zI=new WeakMap,GI=new WeakMap,XI=new WeakMap,VI=new WeakMap,YI=new WeakMap,$I=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,OI()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),DI(n,BI,window.game),DI(n,NI,LI(BI,n).refs),DI(n,WI,LI(NI,n).rateUsView),DI(n,UI,LI(WI,n).getChildByName("innerModal",1)),DI(n,jI,LI(WI,n).getChildByName("innerContainer")),DI(n,HI,LI(jI,n).getChildByName("btnLater",1)),DI(n,zI,LI(jI,n).getChildByName("btnEnter")),DI(n,GI,null),S(n,"waitForCompletion",function(){return n.completePromise}),DI(n,XI,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:ag.userReviewClickOk(),LI(zI,n).off("pointerup",LI(VI,n)),n.uiManager.closeModule(e.moduleName),LI(GI,n).call(n);case 1:case"end":return t.stop()}},t)}))),DI(n,VI,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return ag.userReviewClickLater(),LI(HI,n).off("pointerup",LI(XI,n)),t.next=1,n.makeReview();case 1:n.uiManager.closeModule(e.moduleName);case 2:case"end":return t.stop()}},t)}))),S(n,"testAct",function(){return new Promise(function(t,e){console.log("setTimeout start"),setTimeout(function(){Math.random()>.5?t({status:""}):e(new Error(" "))},1e3)})}),S(n,"makeReview",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,gg.makeReview.act().then(LI(YI,n)).catch(function(t){return console.error("----- [rejectReview]",t)}).finally(LI(GI,n));case 1:case"end":return t.stop()}},t)}))),DI(n,YI,function(t){console.warn("----- [giveReward] data: ",t),Gf.storage.addHints(yx.rateUsHints),console.warn("----- [ ]",yx.rateUsHints)}),n.btnClose.visible=!1,$m.initOverHandler([LI(HI,n),LI(zI,n)]),LI(UI,n).addChild(LI(jI,n)),n.completePromise=new Promise(function(t){!function(t,e,n){t.set(FI(t,e),n)}(GI,n,t)}),n}return T(e,t),w(e,[{key:"show",value:function(){!function(t,e,n){var r=Zl(b(t.prototype),"show",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]),LI(HI,this).once("pointerup",LI(XI,this)),LI(zI,this).once("pointerup",LI(VI,this))}}],[{key:"checkAvailable",get:function(){return gg.makeReview.isAvailable()}},{key:"userHasRated",get:function(){return gg.makeReview.getStatus()}},{key:"shouldAct",get:function(){return gg.makeReview.shouldAct()}}])}(vw);function qI(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function KI(t,e,n){return t.set(QI(t,e),n),n}function ZI(t,e){return t.get(QI(t,e))}function QI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}PI=$I,S($I,"viewName","rateUsView"),S($I,"moduleName",mw),S($I,"checkAndShowRateUs",function(){var t=Kl(Jl().mark(function t(e,n){var r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(4===e.playerData.levelIndex){t.next=1;break}return t.abrupt("return");case 1:if(PI.shouldAct){t.next=2;break}return t.abrupt("return");case 2:return r=n.uiManager,t.next=3,r.showModule(mw,!0);case 3:return i=r.getModule(mw),t.next=4,i.waitForCompletion();case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}());var JI=new WeakMap,tR=new WeakMap,eR=new WeakMap,nR=new WeakMap,rR=new WeakMap,iR=new WeakMap,sR=new WeakMap,oR=new WeakMap,aR=w(function t(e){var n=this;g(this,t),qI(this,JI,window.game),qI(this,tR,ZI(JI,this).refs),qI(this,eR,void 0),qI(this,nR,void 0),qI(this,rR,void 0),qI(this,iR,void 0),S(this,"getModule",function(t){return ZI(rR,n)[t]}),S(this,"showModule",function(){var t=Kl(Jl().mark(function t(e){var r=arguments;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return KI(iR,n,r.length>1&&void 0!==r[1]&&r[1]),ZI(oR,n).call(n),t.next=1,ZI(rR,n)[e].show();case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),S(this,"closeModule",function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return ZI(sR,n).call(n),t.next=1,ZI(rR,n)[e].hide();case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),qI(this,sR,Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=ZI(JI,n).refs.noHintsPopupView,t.next=1,Ff.timeline().to(e,{alpha:0,duration:.2,visible:!1});case 1:if(!ZI(iR,n)){t.next=2;break}return t.abrupt("return");case 2:Ym(ZI(JI,n),{showAll:!0});case 3:case"end":return t.stop()}},t)}))),qI(this,oR,function(){Object.keys(ZI(rR,n)).forEach(function(t){ZI(rR,n)[t].visible=!1})}),KI(eR,this,e),KI(nR,this,ZI(tR,this).startScreenView),KI(rR,this,S(S({},dw,new O_(this)),mw,new $I(this)))});function lR(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function cR(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var hR=new WeakMap,uR=new WeakMap,dR=new WeakMap,pR=new WeakMap,fR=new WeakMap,mR=new WeakMap,gR=w(function t(e){var n=this;g(this,t),lR(this,hR,window.game),lR(this,uR,cR(hR,this).refs),lR(this,dR,cR(uR,this).levelContainer),S(this,"clear",function(t,e){cR(hR,n).emit(zg),cR(pR,n).call(n,t),cR(fR,n).call(n,t,e),cR(mR,n).call(n)}),lR(this,pR,function(t){t.forEach(function(t){var e=t.getComponent(hC),r=t.getComponent(gC);e&&cR(dR,n).removeChild(e.view),r&&cR(dR,n).removeChild(r.spine)})}),lR(this,fR,function(t,e){t.clear(),e.clear()}),lR(this,mR,function(){var t=n.level;t.entityManager=null,t.levelContainer=null,t.clearLevel=null}),this.level=e}),vR=Object.defineProperty,yR=(t,e,n)=>(((t,e,n)=>{e in t?vR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class xR{constructor(t){yR(this,"parent"),yR(this,"paused"),this.parent=t,this.paused=!1}destroy(){}down(t){return!1}move(t){return!1}up(t){return!1}wheel(t){return!1}update(t){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}var wR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof t.g<"u"?t.g:typeof self<"u"?self:{},_R={exports:{}};!function(t){(function(){var e,n;n=function(e){return t.exports=e},e={linear:function(t,e,n,r){return n*t/r+e},easeInQuad:function(t,e,n,r){return n*(t/=r)*t+e},easeOutQuad:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){return n*(t/=r)*t*t+e},easeOutCubic:function(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,r){return n*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,r){return n*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,n,r){return 0===t?e:n*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,n,r){return t===r?e+n:n*(1-Math.pow(2,-10*t/r))+e},easeInOutExpo:function(t,e,n,r){return(t/=r/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,n,r){return(t/=r/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,r){var i,s,o;return o=1.70158,0===t||(t/=r),(s=0)||(s=.3*r),(i=n)<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),-i*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/s)+e},easeOutElastic:function(t,e,n,r){var i,s,o;return o=1.70158,0===t||(t/=r),(s=0)||(s=.3*r),(i=n)<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),i*Math.pow(2,-10*t)*Math.sin((t*r-o)*(2*Math.PI)/s)+n+e},easeInOutElastic:function(t,e,n,r){var i,s,o;return o=1.70158,0===t||(t/=r/2),(s=0)||(s=r*(.3*1.5)),(i=n)<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),t<1?i*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/s)*-.5+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/s)*.5+n+e},easeInBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),n*(t/=r)*t*((i+1)*t-i)+e},easeOutBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e},easeInOutBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),(t/=r/2)<1?n/2*(t*t*((1+(i*=1.525))*t-i))+e:n/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e},easeInBounce:function(t,n,r,i){return r-e.easeOutBounce(i-t,0,r,i)+n},easeOutBounce:function(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,n,r,i){return t<i/2?.5*e.easeInBounce(2*t,0,r,i)+n:.5*e.easeOutBounce(2*t-i,0,r,i)+.5*r+n}},n(e)}).call(wR)}(_R);const bR=_R.exports;function AR(t,e){return t?"function"==typeof t?t:"string"==typeof t?bR[t]:void 0:bR[e]}const TR={removeOnInterrupt:!1,ease:"linear",time:1e3};class SR extends xR{constructor(t,e={}){super(t),yR(this,"options"),yR(this,"startX"),yR(this,"startY"),yR(this,"deltaX"),yR(this,"deltaY"),yR(this,"keepCenter"),yR(this,"startWidth",null),yR(this,"startHeight",null),yR(this,"deltaWidth",null),yR(this,"deltaHeight",null),yR(this,"width",null),yR(this,"height",null),yR(this,"time",0),this.options=Object.assign({},TR,e),this.options.ease=AR(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),null!==this.width&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),null!==this.height&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),null!==this.width&&this.parent.fitWidth(this.width,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.height,this.keepCenter,null===this.width),!this.keepCenter&&this.options.position&&this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(this.paused)return;this.time+=t;const e=new Ye(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){const t=this.parent.width,n=this.parent.height;this.complete(),(t!==this.parent.width||n!==this.parent.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}else{const t=this.options.ease(this.time,0,1,this.options.time);if(null!==this.width){const e=this.startWidth,n=this.deltaWidth;this.parent.fitWidth(e+n*t,this.keepCenter,null===this.height)}if(null!==this.height){const e=this.startHeight,n=this.deltaHeight;this.parent.fitHeight(e+n*t,this.keepCenter,null===this.width)}if(null===this.width?this.parent.scale.x=this.parent.scale.y:null===this.height&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const e=this.startX,n=this.startY,r=this.deltaX,i=this.deltaY,s=new Ye(this.parent.x,this.parent.y);this.parent.moveCenter(e+r*t,n+i*t),this.parent.emit("moved",{viewport:this.parent,original:s,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}}}const ER={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class kR extends xR{constructor(t,e={}){super(t),yR(this,"options"),yR(this,"left"),yR(this,"top"),yR(this,"right"),yR(this,"bottom"),yR(this,"underflowX"),yR(this,"underflowY"),yR(this,"ease"),yR(this,"toX"),yR(this,"toY"),this.options=Object.assign({},ER,e),this.ease=AR(this.options.ease,"easeInOutSine"),this.options.sides?"all"===this.options.sides?this.top=this.bottom=this.left=this.right=!0:"horizontal"===this.options.sides?(this.right=this.left=!0,this.top=this.bottom=!1):"vertical"===this.options.sides?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=-1!==this.options.sides.indexOf("top"),this.bottom=-1!==this.options.sides.indexOf("bottom"),this.left=-1!==this.options.sides.indexOf("left"),this.right=-1!==this.options.sides.indexOf("right")):this.left=this.top=this.right=this.bottom=!1;const n=this.options.underflow.toLowerCase();"center"===n?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==n.indexOf("left")?-1:-1!==n.indexOf("right")?1:0,this.underflowY=-1!==n.indexOf("top")?-1:-1!==n.indexOf("bottom")?1:0),this.reset()}isActive(){return null!==this.toX||null!==this.toY}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(t){if(!this.paused){if(this.bounce(),this.toX){const e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){const e=this.toY;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),e.time>=this.options.time?(this.parent.y=e.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(e.time,e.start,e.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}oob(){const t=this.options.bounceBox;if(t){const e=typeof t.x>"u"?0:t.x,n=typeof t.y>"u"?0:t.y,r=typeof t.width>"u"?this.parent.worldWidth:t.width,i=typeof t.height>"u"?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>r,top:this.parent.top<n,bottom:this.parent.bottom>i,topLeft:new Ye(e*this.parent.scale.x,n*this.parent.scale.y),bottomRight:new Ye(r*this.parent.scale.x-this.parent.screenWidth,i*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new Ye(0,0),bottomRight:new Ye(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){var t,e;if(this.paused)return;let n,r=this.parent.plugins.get("decelerate",!0);r&&(r.x||r.y)&&(r.x&&r.percentChangeX===(null==(t=r.options)?void 0:t.friction)||r.y&&r.percentChangeY===(null==(e=r.options)?void 0:e.friction))&&(n=this.oob(),(n.left&&this.left||n.right&&this.right)&&(r.percentChangeX=this.options.friction),(n.top&&this.top||n.bottom&&this.bottom)&&(r.percentChangeY=this.options.friction));const i=this.parent.plugins.get("drag",!0)||{},s=this.parent.plugins.get("pinch",!0)||{};if(r=r||{},!(null!=i&&i.active||null!=s&&s.active||this.toX&&this.toY||r.x&&r.y)){n=n||this.oob();const t=n.topLeft,e=n.bottomRight;if(!this.toX&&!r.x){let r=null;n.left&&this.left?r=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-t.x:n.right&&this.right&&(r=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-e.x),null!==r&&this.parent.x!==r&&(this.toX={time:0,start:this.parent.x,delta:r-this.parent.x,end:r},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!r.y){let r=null;n.top&&this.top?r=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-t.y:n.bottom&&this.bottom&&(r=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-e.y),null!==r&&this.parent.y!==r&&(this.toY={time:0,start:this.parent.y,delta:r-this.parent.y,end:r},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const MR={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class CR extends xR{constructor(t,e={}){super(t),yR(this,"options"),yR(this,"last"),yR(this,"noUnderflow"),yR(this,"underflowX"),yR(this,"underflowY"),this.options=Object.assign({},MR,e),this.options.direction&&(this.options.left="x"===this.options.direction||"all"===this.options.direction||null,this.options.right="x"===this.options.direction||"all"===this.options.direction||null,this.options.top="y"===this.options.direction||"all"===this.options.direction||null,this.options.bottom="y"===this.options.direction||"all"===this.options.direction||null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();"none"===t?this.noUnderflow=!0:"center"===t?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t=new Ye(this.parent.x,this.parent.y),e=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==this.options.right){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:0!==this.parent.x&&(this.parent.x=0,n=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,n=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,n=!0)}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,e.x=0,n=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:0!==this.parent.y&&(this.parent.y=0,n=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,n=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,n=!0)}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,e.y=0,n=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const PR={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class IR extends xR{constructor(t,e={}){super(t),yR(this,"options"),this.options=Object.assign({},PR,e),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused)if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(null!==this.options.minWidth&&t<this.options.minWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxWidth&&t>this.options.maxWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.minHeight&&e<this.options.minHeight){const n=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxHeight&&e>this.options.maxHeight){const t=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/t,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const t={x:null,y:null},e={x:null,y:null};if("number"==typeof this.options.minScale)t.x=this.options.minScale,t.y=this.options.minScale;else if(null!==this.options.minScale){const e=this.options.minScale;t.x=typeof e.x>"u"?null:e.x,t.y=typeof e.y>"u"?null:e.y}if("number"==typeof this.options.maxScale)e.x=this.options.maxScale,e.y=this.options.maxScale;else if(null!==this.options.maxScale){const t=this.options.maxScale;e.x=typeof t.x>"u"?null:t.x,e.y=typeof t.y>"u"?null:t.y}let n=this.parent.scale.x,r=this.parent.scale.y;null!==t.x&&n<t.x&&(n=t.x),null!==e.x&&n>e.x&&(n=e.x),null!==t.y&&r<t.y&&(r=t.y),null!==e.y&&r>e.y&&(r=e.y),(n!==this.parent.scale.x||r!==this.parent.scale.y)&&(this.parent.scale.set(n,r),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}reset(){this.clamp()}}const RR={friction:.98,bounce:.8,minSpeed:.01},OR=16;class DR extends xR{constructor(t,e={}){super(t),yR(this,"options"),yR(this,"x"),yR(this,"y"),yR(this,"percentChangeX"),yR(this,"percentChangeY"),yR(this,"saved"),yR(this,"timeSinceRelease"),this.options=Object.assign({},RR,e),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",t=>this.handleMoved(t))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!(!this.x&&!this.y)}move(){if(this.paused)return!1;const t=this.parent.input.count();return(1===t||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}handleMoved(t){if(this.saved.length){const e=this.saved[this.saved.length-1];"clamp-x"===t.type&&t.original?e.x===t.original.x&&(e.x=this.parent.x):"clamp-y"===t.type&&t.original&&e.y===t.original.y&&(e.y=this.parent.y)}}up(){if(0===this.parent.input.count()&&this.saved.length){const t=performance.now();for(const e of this.saved)if(e.time>=t-100){const n=t-e.time;this.x=(this.parent.x-e.x)/n,this.y=(this.parent.y-e.y)/n,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(t){typeof(t=t||{}).x<"u"&&(this.x=t.x,this.percentChangeX=this.options.friction),typeof t.y<"u"&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const e=this.x||this.y,n=this.timeSinceRelease,r=this.timeSinceRelease+t;if(this.x){const e=this.percentChangeX,i=Math.log(e);this.parent.x+=this.x*OR/i*(Math.pow(e,r/OR)-Math.pow(e,n/OR)),this.x*=Math.pow(this.percentChangeX,t/OR)}if(this.y){const e=this.percentChangeY,i=Math.log(e);this.parent.y+=this.y*OR/i*(Math.pow(e,r/OR)-Math.pow(e,n/OR)),this.y*=Math.pow(this.percentChangeY,t/OR)}this.timeSinceRelease+=t,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const LR={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1};class FR extends xR{constructor(t,e={}){super(t),yR(this,"options"),yR(this,"moved"),yR(this,"reverse"),yR(this,"xDirection"),yR(this,"yDirection"),yR(this,"keyIsPressed"),yR(this,"mouse"),yR(this,"underflowX"),yR(this,"underflowY"),yR(this,"last"),yR(this,"current"),yR(this,"windowEventHandlers",[]),this.options=Object.assign({},LR,e),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||"all"===this.options.direction||"x"===this.options.direction,this.yDirection=!this.options.direction||"all"===this.options.direction||"y"===this.options.direction,this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){this.addWindowEventHandler("keyup",e=>{t.includes(e.code)&&(this.keyIsPressed=!1)}),this.addWindowEventHandler("keydown",e=>{t.includes(e.code)&&(this.keyIsPressed=!0)})}addWindowEventHandler(t,e){window.addEventListener(t,e),this.windowEventHandlers.push({event:t,handler:e})}destroy(){this.windowEventHandlers.forEach(({event:t,handler:e})=>{window.removeEventListener(t,e)})}mouseButtons(t){this.mouse=t&&"all"!==t?[-1!==t.indexOf("left"),-1!==t.indexOf("middle"),-1!==t.indexOf("right")]:[!0,!0,!0]}parseUnderflow(){const t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(t.includes("left")?this.underflowX=-1:t.includes("right")?this.underflowX=1:this.underflowX=0,t.includes("top")?this.underflowY=-1:t.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(t){const e="mouse"===t.pointerType,n=this.parent.input.count();return!(!(1===n||n>1&&!this.parent.plugins.get("pinch",!0))||e&&!this.mouse[t.button])}checkKeyPress(t){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===t.data.pointerType}down(t){return!(this.paused||!this.options.pressDrag||(this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.global.x,y:t.global.y},this.current=t.pointerId,0):(this.last=null,1)))}get active(){return this.moved}move(t){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===t.data.pointerId){const e=t.global.x,n=t.global.y,r=this.parent.input.count();if(1===r||r>1&&!this.parent.plugins.get("pinch",!0)){const r=e-this.last.x,i=n-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(r)||this.yDirection&&this.parent.input.checkThreshold(i)){const r={x:e,y:n};return this.xDirection&&(this.parent.x+=(r.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(r.y-this.last.y)*this.options.factor),this.last=r,this.moved||this.parent.emit("drag-start",{event:t,screen:new Ye(this.last.x,this.last.y),world:this.parent.toWorld(new Ye(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up(t){if(this.paused)return!1;const e=this.parent.input.touches;if(1===e.length){const t=e[0];return t.last&&(this.last={x:t.last.x,y:t.last.y},this.current=t.id),this.moved=!1,!0}if(this.last&&this.moved){const e=new Ye(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:e,world:this.parent.toWorld(e),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(t){if(this.paused)return!1;if(this.options.wheel){const e=this.parent.plugins.get("wheel",!0);if(!e||!e.options.wheelZoom&&!t.ctrlKey){const e=t.deltaMode?this.options.lineHeight:1,n=[t.deltaX,t.deltaY],[r,i]=this.options.wheelSwapAxes?n.reverse():n;return this.xDirection&&(this.parent.x+=r*e*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=i*e*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),this.parent.options.stopPropagation&&t.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const BR={speed:0,acceleration:null,radius:null};class NR extends xR{constructor(t,e,n={}){super(t),yR(this,"options"),yR(this,"target"),yR(this,"velocity"),this.target=e,this.options=Object.assign({},BR,n),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const e=this.parent.center;let n=this.target.x,r=this.target.y;if(this.options.radius){if(!(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius))return;{const t=Math.atan2(this.target.y-e.y,this.target.x-e.x);n=this.target.x-Math.cos(t)*this.options.radius,r=this.target.y-Math.sin(t)*this.options.radius}}const i=n-e.x,s=r-e.y;if(i||s)if(this.options.speed)if(this.options.acceleration){const t=Math.atan2(r-e.y,n-e.x),o=Math.sqrt(Math.pow(i,2)+Math.pow(s,2));if(o){const a=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);this.velocity=o>a?{x:Math.min(this.velocity.x+(this.options.acceleration,this.options.speed)),y:Math.min(this.velocity.y+(this.options.acceleration,this.options.speed))}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const l=Math.cos(t)*this.velocity.x,c=Math.sin(t)*this.velocity.y,h=Math.abs(l)>Math.abs(i)?n:e.x+l,u=Math.abs(c)>Math.abs(s)?r:e.y+c;this.parent.moveCenter(h,u),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const t=Math.atan2(r-e.y,n-e.x),o=Math.cos(t)*this.options.speed,a=Math.sin(t)*this.options.speed,l=Math.abs(o)>Math.abs(i)?n:e.x+o,c=Math.abs(a)>Math.abs(s)?r:e.y+a;this.parent.moveCenter(l,c),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(n,r),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const WR={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class UR extends xR{constructor(t,e={}){super(t),yR(this,"options"),yR(this,"reverse"),yR(this,"radiusSquared"),yR(this,"left"),yR(this,"top"),yR(this,"right"),yR(this,"bottom"),yR(this,"horizontal"),yR(this,"vertical"),this.options=Object.assign({},WR,e),this.reverse=this.options.reverse?1:-1,this.radiusSquared="number"==typeof this.options.radius?Math.pow(this.options.radius,2):null,this.resize()}resize(){const t=this.options.distance;null!==t?(this.left=t,this.top=t,this.right=this.parent.screenWidth-t,this.bottom=this.parent.screenHeight-t):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.screenWidth-this.options.right,this.bottom=null===this.options.bottom?null:this.parent.screenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(t){if(this.paused||"mouse"!==t.pointerType&&1!==t.pointerId||!this.options.allowButtons&&0!==t.buttons)return!1;const e=t.global.x,n=t.global.y;if(this.radiusSquared){const t=this.parent.toScreen(this.parent.center);if(Math.pow(t.x-e,2)+Math.pow(t.y-n,2)>=this.radiusSquared){const r=Math.atan2(t.y-n,t.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(r))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(r))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(r)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(r)*this.options.speed*this.reverse*.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else null!==this.left&&e<this.left?this.horizontal=Number(this.reverse)*this.options.speed*.06:null!==this.right&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&n<this.top?this.vertical=Number(this.reverse)*this.options.speed*.06:null!==this.bottom&&n>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const jR={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class HR extends xR{constructor(t,e={}){super(t),yR(this,"options"),yR(this,"active",!1),yR(this,"pinching",!1),yR(this,"moved",!1),yR(this,"lastCenter"),this.options=Object.assign({},jR,e)}down(){return this.parent.input.count()>=2&&(this.active=!0,!0)}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(t){if(this.paused||!this.active)return!1;const e=t.global.x,n=t.global.y,r=this.parent.input.touches;if(r.length>=2){const i=r[0],s=r[1],o=i.last&&s.last?Math.sqrt(Math.pow(s.last.x-i.last.x,2)+Math.pow(s.last.y-i.last.y,2)):null;if(i.id===t.pointerId?i.last={x:e,y:n,data:t}:s.id===t.pointerId&&(s.last={x:e,y:n,data:t}),o){let t;const e=new Ye(i.last.x+(s.last.x-i.last.x)/2,i.last.y+(s.last.y-i.last.y)/2);this.options.center||(t=this.parent.toLocal(e));let n=Math.sqrt(Math.pow(s.last.x-i.last.x,2)+Math.pow(s.last.y-i.last.y,2));n=0===n?n=1e-10:n;const r=(1-o/n)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=r),this.isAxisY()&&(this.parent.scale.y+=r),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:e});const a=this.parent.plugins.get("clamp-zoom",!0);if(a&&a.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const n=this.parent.toGlobal(t);this.parent.x+=(e.x-n.x)*this.options.factor,this.parent.y+=(e.y-n.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(e.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(e.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=e,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return!!(this.pinching&&this.parent.input.touches.length<=1)&&(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0)}}const zR={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class GR extends xR{constructor(t,e,n,r={}){super(t),yR(this,"options"),yR(this,"ease"),yR(this,"x"),yR(this,"y"),yR(this,"percent"),yR(this,"snapping"),yR(this,"deltaX"),yR(this,"deltaY"),yR(this,"startX"),yR(this,"startY"),this.options=Object.assign({},zR,r),this.ease=AR(r.ease,"easeInOutSine"),this.x=e,this.y=n,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(0===this.parent.input.count()){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}return!1}update(t){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){const e=this.snapping;let n,r,i;e.time+=t;const s=this.startX,o=this.startY,a=this.deltaX,l=this.deltaY;if(e.time>this.options.time)n=!0,r=s+a,i=o+l;else{const t=this.ease(e.time,0,1,this.options.time);r=s+a*t,i=o+l*t}this.options.topLeft?this.parent.moveCorner(r,i):this.parent.moveCenter(r,i),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),n&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const t=this.options.topLeft?this.parent.corner:this.parent.center;(t.x!==this.x||t.y!==this.y)&&this.snapStart()}}}const XR={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class VR extends xR{constructor(t,e={}){super(t),yR(this,"options"),yR(this,"ease"),yR(this,"xScale"),yR(this,"yScale"),yR(this,"xIndependent"),yR(this,"yIndependent"),yR(this,"snapping"),this.options=Object.assign({},XR,e),this.ease=AR(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=t.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,0===this.options.time?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):e.forceStart&&this.createSnapping()}createSnapping(){const t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,n=this.parent.screenWidth/this.xScale,r=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:n-t,deltaY:r-e},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(t){if(this.paused||this.options.interrupt&&0!==this.parent.input.count())return;let e;if(!this.options.center&&!this.options.noMove&&(e=this.parent.center),this.snapping){if(this.snapping){const n=this.snapping;if(n.time+=t,n.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const t=this.snapping,e=this.ease(t.time,t.startX,t.deltaX,this.options.time),n=this.ease(t.time,t.startY,t.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/e,this.parent.scale.y=this.parent.screenHeight/n}const r=this.parent.plugins.get("clamp-zoom",!0);r&&r.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}else(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping()}resume(){this.snapping=null,super.resume()}}const YR={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class $R extends xR{constructor(t,e={}){super(t),yR(this,"options"),yR(this,"smoothing"),yR(this,"smoothingCenter"),yR(this,"smoothingCount"),yR(this,"keyIsPressed"),this.options=Object.assign({},YR,e),this.keyIsPressed=!1,this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){window.addEventListener("keydown",e=>{t.includes(e.code)&&(this.keyIsPressed=!0)}),window.addEventListener("keyup",e=>{t.includes(e.code)&&(this.keyIsPressed=!1)})}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const t=this.smoothingCenter,e=this.smoothing;let n;this.options.center||(n=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x+=e.x),this.isAxisY()&&(this.parent.scale.y+=e.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const r=this.parent.plugins.get("clamp-zoom",!0);if(r&&r.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const e=this.parent.toGlobal(n);this.parent.x+=t.x-e.x,this.parent.y+=t.y-e.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch(t){if(this.paused)return;const e=this.parent.input.getPointerPosition(t),n=-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/200,r=Math.pow(2,(1+this.options.percent)*n);let i;this.options.center||(i=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=r),this.isAxisY()&&(this.parent.scale.y*=r),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const s=this.parent.plugins.get("clamp-zoom",!0);if(s&&s.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const t=this.parent.toGlobal(i);this.parent.x+=e.x-t.x,this.parent.y+=e.y-t.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}wheel(t){if(this.paused||!this.checkKeyPress())return!1;if(t.ctrlKey&&this.options.trackpadPinch)this.pinch(t);else if(this.options.wheelZoom){const e=this.parent.input.getPointerPosition(t),n=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,r=Math.pow(2,(1+this.options.percent)*n);if(this.options.smooth){const t={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+t.x)*r-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+t.y)*r-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{let t;this.options.center||(t=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=r),this.isAxisY()&&(this.parent.scale.y*=r),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const n=this.parent.plugins.get("clamp-zoom",!0);if(n&&n.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const n=this.parent.toGlobal(t);this.parent.x+=e.x-n.x,this.parent.y+=e.y-n.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}return!this.parent.options.passiveWheel}}class qR{constructor(t){yR(this,"viewport"),yR(this,"clickedAvailable"),yR(this,"isMouseDown"),yR(this,"last"),yR(this,"wheelFunction"),yR(this,"touches"),this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.eventMode="static",this.viewport.forceHitArea||(this.viewport.hitArea=new qe(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.options.allowPreserveDragOutside?this.viewport.on("globalpointermove",this.move,this):this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.options.allowPreserveDragOutside||this.viewport.on("pointerleave",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.events.domElement.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.events.domElement.removeEventListener("wheel",this.wheelFunction)}down(t){if(!this.viewport.pause&&this.viewport.worldVisible){if("mouse"===t.pointerType?this.isMouseDown=!0:this.get(t.pointerId)||this.touches.push({id:t.pointerId,last:null}),1===this.count()){this.last=t.global.clone();const e=this.viewport.plugins.get("decelerate",!0),n=this.viewport.plugins.get("bounce",!0);e&&e.isActive()||n&&n.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.plugins.move(t);if(this.clickedAvailable&&this.last){const e=t.global.x-this.last.x,n=t.global.y-this.last.y;(this.checkThreshold(e)||this.checkThreshold(n))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.worldVisible)return;"mouse"===t.pointerType&&(this.isMouseDown=!1),"mouse"!==t.pointerType&&this.remove(t.pointerId);const e=this.viewport.plugins.up(t);this.clickedAvailable&&0===this.count()&&this.last&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this.viewport}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){const e=new Ye;return this.viewport.options.events.mapPositionToPoint(e,t.clientX,t.clientY),e}handleWheel(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.toLocal(this.getPointerPosition(t));this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom&&this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(const e of this.touches)if(e.id===t)return e;return null}remove(t){for(let e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return void this.touches.splice(e,1)}count(){return(this.isMouseDown?1:0)+this.touches.length}}const KR=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class ZR{constructor(t){yR(this,"plugins"),yR(this,"list"),yR(this,"viewport"),this.viewport=t,this.list=[],this.plugins={}}add(t,e,n=KR.length){const r=this.plugins[t];r&&r.destroy(),this.plugins[t]=e;const i=KR.indexOf(t);-1!==i&&KR.splice(i,1),KR.splice(n,0,t),this.sort()}get(t,e){var n;return e&&null!=(n=this.plugins[t])&&n.paused?null:this.plugins[t]}update(t){for(const e of this.list)e.update(t)}resize(){for(const t of this.list)t.resize()}reset(){for(const t of this.list)t.reset()}removeAll(){this.list.forEach(t=>{t.destroy()}),this.plugins={},this.sort()}remove(t){var e;this.plugins[t]&&(null==(e=this.plugins[t])||e.destroy(),delete this.plugins[t],this.viewport.emit("plugin-remove",t),this.sort())}pause(t){var e;null==(e=this.plugins[t])||e.pause()}resume(t){var e;null==(e=this.plugins[t])||e.resume()}sort(){this.list=[];for(const t of KR)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let e=!1;for(const n of this.list)n.down(t)&&(e=!0);return e}move(t){let e=!1;for(const n of this.viewport.plugins.list)n.move(t)&&(e=!0);return e}up(t){let e=!1;for(const n of this.list)n.up(t)&&(e=!0);return e}wheel(t){let e=!1;for(const n of this.list)n.wheel(t)&&(e=!0);return e}}const QR={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,disableOnContextMenu:!1,ticker:ti.shared,allowPreserveDragOutside:!1};function JR(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(JR=function(){return!!t})()}function tO(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function eO(t,e){return t.get(nO(t,e))}function nO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rO=new WeakMap,iO=new WeakMap,sO=new WeakMap,oO=new WeakMap,aO=new WeakMap,lO=new WeakMap,cO=new WeakMap,hO=new WeakMap,uO=function(t){function e(t,n){var r;return g(this,e),r=function(t,e,n){return e=b(e),_(t,JR()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[{screenWidth:ol.WIDTH,screenHeight:ol.HEIGHT,worldWidth:ol.WIDTH,worldHeight:ol.HEIGHT,passiveWheel:!1,stopPropagation:!0,events:t.app.renderer.events}]),S(r,"camera",r),tO(r,rO,.9),tO(r,iO,2),S(r,"init",function(){eO(lO,r).call(r,!0),eO(oO,r).call(r),eO(cO,r).call(r),eO(sO,r).call(r)}),S(r,"setPause",function(t){r.camera.pause=t}),S(r,"getTargetCenter",function(t){var e=t.sprite,n=t.isMesh,i=t.x,s=t.y,o=r.camera.center,a=o.x,l=o.y,c=e.getLocalBounds(),h=c.x,u=c.y;return{x:a+(e.width/2+(n?h:i)-a),y:l+(e.height/2+(n?u:s)-l)}}),tO(r,sO,function(){var t=r.game.resizeData.scaleFactor,e={value:2*t};r.plugins.remove("clamp-zoom"),r.setZoom(e.value,!0),Ff.to(e,{value:t,duration:2.5,ease:"linear",onUpdate:function(){r.setZoom(e.value,!0)},onComplete:function(){eO(cO,r).call(r)}})}),tO(r,oO,function(){r.camera.drag({wheel:!1}).decelerate({friction:.95}).pinch({noDrag:!1}).wheel({percent:1.5,smooth:100}).clamp({left:!1,right:!1,top:!1,bottom:!1,direction:"all",underflow:"center"}).mouseEdges({radius:null,top:50,bottom:120,left:50,right:50,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1})}),tO(r,aO,function(){eO(lO,r).call(r,!1),eO(hO,r).call(r),function(t,e){t.set(nO(t,e),.5)}(rO,r),r.game.app.stage.removeChild(r.camera),r.camera.destroy({children:!0})}),tO(r,lO,function(t){var e=t?"on":"off";r.game[e](jg,r.setPause.bind(r,!0)),r.game[e](zg,eO(aO,r)),r.game[e](Lg,eO(cO,r))}),tO(r,cO,function(){var t=r.game.resizeData.scaleFactor,e=r.camera.scale;r.camera.resize(window.innerWidth,window.innerHeight,ol.WIDTH,ol.HEIGHT),r.camera.scale.set(t),r.camera.scale.set(Math.max(t,e.x),Math.max(t,e.y)),r.camera.clampZoom({minScale:t,maxScale:t+eO(rO,r),damping:1}),r.camera.moveCenter(ol.HALF_W,ol.HALF_H),r.camera.mouseEdges({radius:null,top:50*t,bottom:120*t,left:50*t,right:50*t,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1})}),S(r,"disabledUserMove",function(){r.setPause(!1),r.plugins.pause("drag"),r.plugins.pause("wheel"),r.plugins.pause("pinch"),r.plugins.remove("mouse-edges")}),S(r,"unDisabledUserMove",function(){r.setPause(!1),r.plugins.resume("drag"),r.plugins.resume("wheel"),r.plugins.resume("pinch"),r.camera.mouseEdges({radius:null,top:50,bottom:120,left:50,right:50,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1})}),tO(r,hO,function(){r.camera.plugins.remove("clamp"),r.camera.plugins.remove("decelerate"),r.camera.plugins.remove("drag"),r.camera.plugins.remove("pinch"),r.camera.plugins.remove("wheel"),r.camera.plugins.remove("clamp-zoom"),r.camera.plugins.remove("mouseEdges")}),r.game=t,r.game.camera=r,r.refs=r.game.refs,r.refs.camera=r,r.levelContainer=n,r.levelContainer.visible=!0,r.camera.addChild(n),r.game.app.stage.addChildAt(r.camera,0),r.camera.interactiveChildren=!0,r.setPause(!0),eO(cO,r).call(r),r.setZoom(eO(iO,r),!0),r}return T(e,t),w(e)}(class extends Ti{constructor(t){super(),yR(this,"moving"),yR(this,"screenWidth"),yR(this,"screenHeight"),yR(this,"threshold"),yR(this,"input"),yR(this,"plugins"),yR(this,"zooming"),yR(this,"lastViewport"),yR(this,"options"),yR(this,"_dirty"),yR(this,"_forceHitArea"),yR(this,"_hitAreaDefault"),yR(this,"_pause"),yR(this,"tickerFunction"),yR(this,"_worldWidth"),yR(this,"_worldHeight"),yR(this,"_disableOnContextMenu",t=>t.preventDefault()),this.options={...QR,...t},this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.disableOnContextMenu&&this.options.events.domElement.addEventListener("contextmenu",this._disableOnContextMenu),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new qR(this),this.plugins=new ZR(this)}destroy(t){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&this.options.events.domElement.removeEventListener("contextmenu",this._disableOnContextMenu),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new qe(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=window.innerWidth,e=window.innerHeight,n,r){this.screenWidth=t,this.screenHeight=e,typeof n<"u"&&(this._worldWidth=n),typeof r<"u"&&(this._worldHeight=r),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new qe(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,e){return 2===arguments.length?this.toLocal(new Ye(t,e)):this.toLocal(t)}toScreen(t,e){return 2===arguments.length?this.toGlobal(new Ye(t,e)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new Ye(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(...t){let e,n;"number"==typeof t[0]?(e=t[0],n=t[1]):(e=t[0].x,n=t[0].y);const r=(this.worldScreenWidth/2-e)*this.scale.x,i=(this.worldScreenHeight/2-n)*this.scale.y;return(this.x!==r||this.y!==i)&&(this.position.set(r,i),this.plugins.reset(),this.dirty=!0),this}get corner(){return new Ye(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(...t){let e,n;return 1===t.length?(e=-t[0].x*this.scale.x,n=-t[0].y*this.scale.y):(e=-t[0]*this.scale.x,n=-t[1]*this.scale.y),(e!==this.x||n!==this.y)&&(this.position.set(e,n),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,e){const n=this.screenWidth/t,r=this.screenHeight/e;return Math.min(n,r)}findCover(t,e){const n=this.screenWidth/t,r=this.screenHeight/e;return Math.max(n,r)}fitWidth(t=this.worldWidth,e,n=!0,r){let i;e&&(i=this.center),this.scale.x=this.screenWidth/t,n&&(this.scale.y=this.scale.x);const s=this.plugins.get("clamp-zoom",!0);return!r&&s&&s.clamp(),e&&i&&this.moveCenter(i),this}fitHeight(t=this.worldHeight,e,n=!0,r){let i;e&&(i=this.center),this.scale.y=this.screenHeight/t,n&&(this.scale.x=this.scale.y);const s=this.plugins.get("clamp-zoom",!0);return!r&&s&&s.clamp(),e&&i&&this.moveCenter(i),this}fitWorld(t){let e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),t&&e&&this.moveCenter(e),this}fit(t,e=this.worldWidth,n=this.worldHeight){let r;t&&(r=this.center),this.scale.x=this.screenWidth/e,this.scale.y=this.screenHeight/n,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),t&&r&&this.moveCenter(r),this}setZoom(t,e){let n;e&&(n=this.center),this.scale.set(t);const r=this.plugins.get("clamp-zoom",!0);return r&&r.clamp(),e&&n&&this.moveCenter(n),this}zoomPercent(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}zoom(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}get scaled(){return this.scale.x}set scaled(t){this.setZoom(t,!0)}snapZoom(t){return this.plugins.add("snap-zoom",new VR(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new Ye(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new qe(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new FR(this,t)),this}clamp(t){return this.plugins.add("clamp",new CR(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new DR(this,t)),this}bounce(t){return this.plugins.add("bounce",new kR(this,t)),this}pinch(t){return this.plugins.add("pinch",new HR(this,t)),this}snap(t,e,n){return this.plugins.add("snap",new GR(this,t,e,n)),this}follow(t,e){return this.plugins.add("follow",new NR(this,t,e)),this}wheel(t){return this.plugins.add("wheel",new $R(this,t)),this}animate(t){return this.plugins.add("animate",new SR(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new IR(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new UR(this,t)),this}get pause(){return!!this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,e,n,r,i){i&&(n>this.worldScreenWidth||r>this.worldScreenHeight)&&(this.fit(!0,n,r),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let s=!1;t<this.left?(this.left=t,s=!0):t+n>this.right&&(this.right=t+n,s=!0),e<this.top?(this.top=e,s=!0):e+r>this.bottom&&(this.bottom=e+r,s=!0),s&&this.emit("moved",{viewport:this,type:"ensureVisible"})}});function dO(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(dO=function(){return!!t})()}function pO(t,e,n,r){var i=Zl(b(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function fO(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function mO(t,e){return t.get(vO(t,e))}function gO(t,e,n){return t.set(vO(t,e),n),n}function vO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yO=new WeakMap,xO=new WeakMap,wO=new WeakMap,_O=new WeakMap,bO=new WeakMap,AO=new WeakMap,TO=new WeakMap,SO=new WeakMap,EO=new WeakMap,kO=function(t){function e(){var t;return g(this,e),t=function(t,e){return e=b(e),_(t,dO()?Reflect.construct(e,[],b(t).constructor):e.apply(t,void 0))}(this,e),fO(t,yO,window.game),fO(t,xO,void 0),fO(t,wO,void 0),fO(t,_O,void 0),fO(t,bO,void 0),S(t,"btn",void 0),fO(t,AO,Kl(Jl().mark(function e(){var n;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,t.findServerTime();case 1:(n=e.sent)&&n>0&&mO(EO,t).call(t,n);case 2:case"end":return e.stop()}},e)}))),fO(t,TO,function(){gO(xO,t,t.btn.getChildByName("btnTopContainer")),gO(wO,t,t.btn.getChildByName("btnTimerContainer")),gO(_O,t,t.btn.getChildByName("priceText",1)),mO(_O,t).initText=mO(_O,t).text}),fO(t,SO,function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(mO(xO,t).visible=!0,mO(wO,t).visible=!1):(mO(xO,t).visible=!1,mO(wO,t).visible=!0)}),fO(t,EO,function(e){mO(SO,t).call(t,!1);var n=Math.floor(e/60),r=e%60,i=String(n).padStart(2,"0"),s=String(r).padStart(2,"0");mO(_O,t).text="".concat(i," : ").concat(s)}),"object"===v(e.instance)||(e.instance=t),_(t,e.instance)}return T(e,t),w(e,[{key:"init",value:function(t,n){pO(e,"init",this,3)([t,"btnHintRewardTimer",ug]),gO(bO,this,n),mO(TO,this).call(this),mO(AO,this).call(this)}},{key:"onTimerTick",value:function(t){mO(EO,this).call(this,t)}},{key:"onTimerEnd",value:function(){pO(e,"onTimerEnd",this,3)([]),mO(SO,this).call(this,!0)}},{key:"onError",value:function(t){_g.showError(t)}}])}(Vw);function MO(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(MO=function(){return!!t})()}function CO(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function PO(t,e,n){return t.set(RO(t,e),n),n}function IO(t,e){return t.get(RO(t,e))}function RO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var OO=new WeakMap,DO=new WeakMap,LO=new WeakMap,FO=new WeakMap,BO=new WeakMap,NO=new WeakMap,WO=new WeakMap,UO=new WeakMap,jO=new WeakMap,HO=new WeakMap,zO=new WeakMap,GO=new WeakMap,XO=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,MO()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),CO(n,OO,window.game),CO(n,DO,IO(OO,n).refs),CO(n,LO,new kO),CO(n,FO,void 0),CO(n,BO,void 0),CO(n,NO,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:PO(FO,n,n.view.getChildByName("btnStore",1)),PO(BO,n,n.view.getChildByName("btnPlayReward",1)),n.purchaseError=new ig(IO(DO,n).purchaseErrorView),$m.initOverHandler([IO(FO,n),IO(BO,n)]),IO(UO,n).call(n,!0);case 1:case"end":return t.stop()}},t)}))),CO(n,WO,function(){IO(LO,n).init(IO(BO,n),n)}),CO(n,UO,function(t){var e=t?"on":"off";IO(FO,n)[e]("pointerdown",IO(zO,n)),IO(BO,n)[e]("pointerdown",IO(GO,n)),IO(OO,n)[e](zg,IO(jO,n)),IO(OO,n)[e]($g,IO(HO,n))}),CO(n,jO,function(){IO(LO,n).destroy(),IO(UO,n).call(n,!1)}),CO(n,HO,function(t){t!==yw&&n.hide()}),CO(n,zO,function(){Gf.soundManager.play("sfx_btnClick"),n.innerModal.visible=!1,IO(OO,n).LEVEL.uiManager.showModule(dw),ag.noHintsClickBtnStore()}),CO(n,GO,function(){ag.noHintsClickBtnReward()}),IO(NO,n).call(n),n}return T(e,t),w(e,[{key:"showCallback",value:function(){IO(WO,this).call(this),Ym(IO(OO,this),{hide:!0})}},{key:"hideCallback",value:function(){IO(LO,this).destroy(),Ym(IO(OO,this),{showAll:!0})}}])}(tg);function VO(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function YO(t,e,n){return t.set(qO(t,e),n),n}function $O(t,e){return t.get(qO(t,e))}function qO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var KO=new WeakMap,ZO=new WeakMap,QO=new WeakMap,JO=new WeakMap,tD=new WeakMap,eD=new WeakMap,nD=new WeakMap,rD=new WeakMap,iD=w(function t(){var e=this;g(this,t),VO(this,KO,window.game),VO(this,ZO,$O(KO,this).refs),VO(this,QO,void 0),VO(this,JO,void 0),S(this,"init",function(){$O(tD,e).call(e),$O(eD,e).call(e),$O(nD,e).call(e,!0)}),VO(this,tD,function(){YO(QO,e,Gf.storage),YO(JO,e,$O(ZO,e).textHintsAmount)}),VO(this,eD,function(){$O(JO,e).text=$O(QO,e).playerData.hints}),VO(this,nD,function(t){var n=t?"on":"off";$O(KO,e)[n](ev,$O(eD,e)),$O(KO,e)[n](zg,$O(rD,e))}),VO(this,rD,function(){$O(nD,e).call(e,!1)}),this.init()});function sD(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function oD(t,e,n){return t.set(lD(t,e),n),n}function aD(t,e){return t.get(lD(t,e))}function lD(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cD=new WeakMap,hD=new WeakMap,uD=new WeakMap,dD=new WeakMap,pD=new WeakMap,fD=new WeakMap,mD=new WeakMap,gD=new WeakMap,vD=new WeakMap,yD=new WeakMap,xD=new WeakMap,wD=new WeakMap,_D=new WeakMap,bD=new WeakMap,AD=new WeakMap,TD=new WeakMap,SD=new WeakMap,ED=new WeakMap,kD=new WeakMap,MD=new WeakMap,CD=new WeakMap,PD=new WeakMap,ID=w(function t(e){var n=this;g(this,t),sD(this,cD,window.game),sD(this,hD,aD(cD,this).refs),sD(this,uD,aD(hD,this).btnHint),sD(this,dD,Gf.storage),sD(this,pD,void 0),sD(this,fD,null),sD(this,mD,void 0),sD(this,gD,void 0),sD(this,vD,void 0),sD(this,yD,15519854),S(this,"init",function(){oD(vD,n,new iD),oD(pD,n,new XO(aD(hD,n).noHintsPopupView)),n.colorMatrix=new Oi,n.colorMatrix.brightness(.5,!1),aD(_D,n).call(n,!0),aD(bD,n).call(n,!0),aD(AD,n).call(n)}),sD(this,xD,function(t){n.activeTargets.push(t)}),sD(this,wD,function(){aD(bD,n).call(n,!1),n.activeTargets=[],n.camera.eventMode="static",aD(uD,n).eventMode="static",aD(uD,n).visible=!1,Xm(aD(mD,n)),aD(_D,n).call(n,!1)}),sD(this,_D,function(t){var e=t?"on":"off";aD(cD,n)[e](jg,aD(wD,n)),aD(cD,n)[e](Gg,aD(xD,n)),aD(uD,n)[e]("pointerup",aD(TD,n))}),sD(this,bD,function(t){var e=t?"static":"none";aD(uD,n).eventMode=e}),sD(this,AD,function(){var t=aD(uD,n).scale;oD(gD,n,Ff.timeline({repeat:-1,repeatDelay:5}).to(aD(uD,n).scale,{x:t.x,y:t.y,duration:.5,ease:"linear"}).to(aD(uD,n).scale,{x:t.x+.1,y:t.y+.1,yoyo:!0,repeat:1,duration:.5,ease:"linear"}))}),sD(this,TD,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(Gf.soundManager.play("sfx_btnClick"),!(aD(dD,n).playerData.hints<=0)){t.next=2;break}return aD(uD,n).off("pointerup",aD(TD,n)),t.next=1,aD(pD,n).show();case 1:return aD(uD,n).on("pointerup",aD(TD,n)),t.abrupt("return");case 2:aD(SD,n).call(n);case 3:case"end":return t.stop()}},t)}))),sD(this,SD,function(){aD(cD,n).emit(Wg,!0);var t=n.activeTargets.filter(function(t){return t.isAlive})[0];oD(fD,n,t),aD(bD,n).call(n,!1),aD(ED,n).call(n),aD(kD,n).call(n,t),ag.useHint(n.level.config,t)}),sD(this,ED,function(){aD(uD,n).filters=[n.colorMatrix],Xm(aD(mD,n),!0),Xm(aD(gD,n),!0),oD(mD,n,Ff.timeline().fromTo(aD(uD,n).scale,{x:aD(uD,n).scale.x,y:aD(uD,n).scale.y},{x:aD(uD,n).scale.x+.2,y:aD(uD,n).scale.y+.2,yoyo:!0,repeat:1,ease:"back.in(2.5)"}))}),sD(this,kD,function(t){if(t&&null!=t&&t.sprite){n.camera.eventMode="none",n.camera.plugins.pause("drag"),n.camera.plugins.pause("wheel"),n.camera.plugins.pause("pinch");var e=n.camera.getTargetCenter(t),r=e.x,i=e.y;n.camera.animate({scale:aD(cD,n).scaleFactor,position:new Ye(r,i),time:1e3,ease:"easeInOutQuad",callbackOnComplete:function(){aD(MD,n).call(n,t)}})}}),sD(this,MD,function(t){var e=t.sprite,r=aD(hD,n).hintStars;aD(CD,n).call(n,t),n.camera.eventMode="static";var i=new Rm(2,aD(yD,n));e.filters=[i],e.filterName="OutlineFilter",t.hintTimeline=Ff.timeline().set(r,{visible:!0}).fromTo(r.scale,{x:0,y:0},{x:2,y:2,repeat:2}).fromTo(r,{alpha:1},{alpha:0,repeat:2,delay:.2},"<").add(function(){return Gf.soundManager.play("sfx_hintFlash")},"<").to(e,{alpha:1},"<").fromTo(i,{thickness:0},{thickness:3,repeat:5,duration:.22,yoyo:!0,ease:"linear"},"<").to(e,{alpha:e.initAlpha},"<").eventCallback("onComplete",function(){n.camera.plugins.resume("drag"),n.camera.plugins.resume("wheel"),n.camera.plugins.resume("pinch"),e.filters=[],aD(uD,n).filters=[],t.hintTimeline=null,r.visible=!1,aD(AD,n).call(n),aD(PD,n).call(n,t)})}),sD(this,CD,function(t){var e=t.sprite,r=aD(hD,n).hintStars;if(t.isMesh){var i=e.getLocalBounds(),s=i.x,o=i.y,a=i.width,l=i.height;r.position.set(s+a/2,o+l/2)}else r.position.set(e.x,Math.abs(e.y))}),sD(this,PD,function(t){aD(fD,n)&&aD(fD,n).name===t.name&&(oD(fD,n,null),aD(uD,n).filters=[],aD(bD,n).call(n,!0))}),this.level=e,this.camera=e.camera,this.activeTargets=[]});function RD(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function OD(t,e,n){return t.set(LD(t,e),n),n}function DD(t,e){return t.get(LD(t,e))}function LD(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var FD=new WeakMap,BD=new WeakMap,ND=new WeakMap,WD=new WeakMap,UD=new WeakMap,jD=new WeakMap,HD=new WeakMap,zD=new WeakMap,GD=new WeakMap,XD=new WeakMap,VD=new WeakMap,YD=new WeakMap,$D=new WeakMap,qD=new WeakMap,KD=new WeakMap,ZD=w(function t(e){var n=this;g(this,t),RD(this,FD,window.game),RD(this,BD,DD(FD,this).refs),RD(this,ND,null),RD(this,WD,null),RD(this,UD,{x:0,y:0}),RD(this,jD,0),RD(this,HD,DD(BD,this).errorCross),RD(this,zD,null),RD(this,GD,function(t){var e=t?"on":"off";DD(FD,n)[e](Bg,DD(XD,n)),DD(FD,n)[e](jg,DD(GD,n).bind(n,!1)),DD(ND,n)[e]("pointerdown",DD(VD,n)),DD(ND,n)[e]("pointerup",DD(YD,n))}),S(this,"clear",function(t){t&&Ol.log(Cl.DestroyMessage,"[ErrorCross] module clear"),DD(XD,n).call(n),DD(FD,n).off(Bg,DD(XD,n)),DD(ND,n).off("pointerdown",DD(VD,n)),DD(ND,n).off("pointerup",DD(YD,n)),DD(HD,n).visible=!1,DD(HD,n).eventMode="auto"}),RD(this,XD,function(){DD(zD,n)&&(DD(zD,n).kill(),DD(zD,n).clear(),DD(HD,n).visible=!1)}),RD(this,VD,function(t){var e=t.data;OD(UD,n,DD(ND,n).toLocal(e.global)),OD(WD,n,{x:n.camera.left,y:n.camera.top}),n.disabledClick=!1}),RD(this,YD,function(t){var e=t.target;if(!n.disabledClick&&"errorCross"!==e.name&&DD(WD,n)){var r=DD(ND,n).toLocal(t.data.global),i=n.camera.left-DD(WD,n).x,s=n.camera.top-DD(WD,n).y,o=DD(UD,n).x-r.x+i,a=DD(UD,n).y-r.y+s;Math.sqrt(o*o+a*a)>2||null!=e&&e.isAlive||!1===(null==e?void 0:e.isAlive)&&e.visible||(DD(XD,n).call(n),Gf.soundManager.play("sfx_missClick"),DD($D,n).call(n,r),DD(FD,n).emit(Ng,!0))}}),RD(this,$D,function(t){var e=1/n.camera.scale.x;OD(zD,n,Ff.timeline({duration:.1,yoyo:!0,repeat:0}).set([DD(HD,n)],{x:t.x,y:t.y},"<").set([DD(HD,n)],{visible:!0},"<").set([DD(HD,n)],{alpha:1,duration:.3},"<").fromTo([DD(HD,n).scale],{x:0,y:0},{x:.6*e,y:.6*e},"<").to([DD(HD,n)],{alpha:0,delay:.5,duration:.2},"<").eventCallback("onComplete",function(){DD(HD,n).visible=!1}))}),RD(this,qD,function(t){var e;"hogItemContainer"!==t.typeName?OD(jD,n,(e=DD(jD,n),++e)):OD(jD,n,0),console.log(DD(jD,n))}),RD(this,KD,function(t){var e=new Hi(DD(FD,n).uiInner).hitTest(t.data.global.x,t.data.global.y);return(null==e?void 0:e.name)===DD(BD,n).btnHint.name&&(console.warn(" ,     UI :",e.name),!0)}),OD(ND,this,e),this.camera=DD(ND,this).parent,DD(ND,this).eventMode="static",DD(HD,this).eventMode="static",DD(HD,this).setEvents=DD(GD,this),DD(GD,this).call(this,!0)});function QD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function JD(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?QD(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QD(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function tL(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function eL(t,e,n){return t.set(rL(t,e),n),n}function nL(t,e){return t.get(rL(t,e))}function rL(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var iL=new WeakMap,sL=new WeakMap,oL=new WeakMap,aL=new WeakMap,lL=new WeakMap,cL=new WeakMap,hL=new WeakMap,uL=new WeakMap,dL=new WeakMap,pL=new WeakMap,fL=new WeakMap,mL=new WeakMap,gL=new WeakMap,vL=new WeakMap,yL=new WeakMap,xL=new WeakMap,wL=new WeakMap,_L=new WeakMap,bL=w(function t(e){var n=this;g(this,t),tL(this,iL,window.game),tL(this,sL,nL(iL,this).refs),tL(this,oL,void 0),tL(this,aL,0),tL(this,lL,null),tL(this,cL,void 0),tL(this,hL,void 0),tL(this,uL,void 0),tL(this,dL,function(){nL(gL,n).call(n,!0),nL(pL,n).call(n)}),tL(this,pL,function(){if(gg.adapter.options.flags){var t,e=nL(sL,n).hudInner;eL(hL,n,((i=new Vo).beginFill(0),i.drawRoundedRect(-62,0,124,80,30),i.endFill(),i.alpha=.75,Xc(Ti,{name:"foundItemsCounterView",x:60,y:-100,visible:!1},i,Xc(ma,{text:"0/10",name:"counterText",x:0,y:-0,anchor:{x:.5,y:0},style:JD(JD({},Yy),{},{fill:16046212,fontSize:50,fontFamily:"Pacifico"})})))),e.addChild(nL(hL,n)),eL(uL,n,nL(hL,n).getChildByName("counterText",1));var r=null===(t=gg.adapter.options.flags)||void 0===t?void 0:t.useCounterFlag;nL(hL,n).visible="true"===r||!0===r,nL(uL,n).text=nL(mL,n).call(n,0)}var i}),S(this,"clear",function(t){t&&Ol.log(Cl.DestroyMessage,"[LevelCounter] module clear"),nL(gL,n).call(n,!1),nL(iL,n).off(Vg,nL(wL,n)),eL(cL,n,0),eL(lL,n,0),eL(aL,n,0),nL(fL,n).call(n)}),tL(this,fL,function(){nL(hL,n)&&(nL(hL,n).visible=!1,nL(uL,n).text="")}),tL(this,mL,function(t){return t+"/".concat(nL(cL,n))}),tL(this,gL,function(){var t=arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?"off":"on";nL(iL,n)[t](Bg,nL(yL,n)),nL(iL,n)[t](Ug,nL(vL,n))}),tL(this,vL,function(){eL(aL,n,0),eL(cL,n,nL(oL,n).getMaxItems()),eL(lL,n,nL(cL,n)),nL(xL,n).call(n)}),tL(this,yL,function(){var t,e;eL(lL,n,(t=nL(lL,n),--t)),eL(aL,n,(e=nL(aL,n),++e)),nL(xL,n).call(n),nL(_L,n).call(n),nL(iL,n).emit(Vg,nL(wL,n).call(n))}),tL(this,xL,function(){nL(hL,n)&&(nL(uL,n).text=nL(mL,n).call(n,nL(aL,n)))}),tL(this,wL,function(){return{maxItems:nL(oL,n).getMaxItems(),itemsFound:nL(aL,n)}}),tL(this,_L,function(){nL(aL,n)>=nL(cL,n)&&nL(iL,n).emit(Xg)}),eL(oL,this,e),this.config=e.config,eL(cL,this,nL(oL,this).getMaxItems()),eL(lL,this,nL(cL,this)),nL(dL,this).call(this)}),AL=new WeakMap,TL=w(function t(e){var n=this;g(this,t),S(this,"hud",null),S(this,"hudIcon",void 0),S(this,"iconSize",{w:120,h:120,offsetX:10}),S(this,"showItems",function(){var t=n.hud,e=t.view,r=t.hudChildren;Ff.fromTo(e,{alpha:0},{alpha:1,visible:!0}),r.forEach(function(t,e){Ff.to(t.scale,{x:.8,y:.8,yoyo:!0,repeat:1,delay:.1*e})})}),S(this,"showNewIcon",function(){var t=Kl(Jl().mark(function t(e){var r,i,s,o,a;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=n.hud.hudChildren.find(function(t){return t.name===e.name}),i=null==r?void 0:r.getChildByName("innerSprite"),t.next=1,n.animationDead(i);case 1:n.hud.itemsQueue.length>0&&(s=n.hud.itemsQueue.shift(),o=s.attachment.name.split("/").pop(),i.texture=ue["hud-icon-".concat(o)]?Kn.from("hud-icon-".concat(o)):Kn.WHITE,r.name=o,Ff.to(i,{alpha:1}),n.hud.entityManager.createHogItems([s])),t.next=3;break;case 2:t.prev=2,a=t.catch(0),console.error("[HudStrategy] showNewIcon",a);case 3:case"end":return t.stop()}},t,null,[[0,2]])}));return function(e){return t.apply(this,arguments)}}()),S(this,"animationDead",function(){}),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,AL,function(t){var e=ue["hud-icon-".concat(t)]?Kn.from("hud-icon-".concat(t)):Kn.WHITE,r=new ki(e);return r.anchor.set(.5),r.width=n.iconSize.w,r.height=n.iconSize.h,r.name="innerSprite",r}),this.hud=e},[{key:"createHudIcon",value:function(t,e,n){try{var r=xg({w:this.iconSize.w,h:this.iconSize.h,center:!0,color:16777215});r.alpha=1,r.visible=n;var i=function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(AL,this).call(this,t),s=new Ti;return s.name=t,s.addChild(i,r),s.position.set(e*(i.width+this.iconSize.offsetX)+i.width/2,i.height/2),this.hudIcon=s,s}catch(t){console.error("[HUD] createItem",t)}}}]);function SL(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(SL=function(){return!!t})()}var EL=new WeakMap,kL=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,SL()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),S(n,"maxItems",5),S(n,"name",ul),S(n,"animationDead",function(){var t=Kl(Jl().mark(function t(e){var n;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.filters.find(function(t){return"colorOverlay"===t.name}),t.next=1,Ff.timeline().to(n,{alpha:0,duration:.3}).to(e,{alpha:0,delay:.3}).set(n,{alpha:1});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),S(n,"createHudIcon",function(t,r,i){var s=function(t,e,n){var r=Zl(b(t.prototype),"createHudIcon",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,n)([t,r,i]);return s.getChildByName("innerSprite").filters=function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(EL,n).call(n),s}),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,function(){return[bw(16777215)]})}(n,EL),n}return T(e,t),w(e)}(TL);function ML(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function CL(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ML(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ML(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function PL(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(PL=function(){return!!t})()}function IL(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function RL(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var OL=new WeakMap,DL=new WeakMap,LL=new WeakMap,FL=new WeakMap,BL=new WeakMap,NL=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,PL()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),IL(n,OL,window.game),S(n,"maxItems",4),S(n,"name",dl),S(n,"showItems",function(){var t=n.hud,e=t.view,r=t.hudChildren;Ff.fromTo(e,{alpha:0},{alpha:1,visible:!0}),r.forEach(function(t,e){Ff.from(t,{alpha:0,delay:.3*e})})}),S(n,"animationDead",function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ff.to(e,{alpha:0});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),S(n,"createHudIcon",function(t,e){try{var r=RL(FL,n).call(n,t);return RL(LL,n).call(n,r,t,e)}catch(t){console.error("[HUD] createHudIcon",t)}}),IL(n,DL,function(t,e){return xg({w:640/t.columns,h:120/t.rows,lineWidth:e,center:!0,color:16046212})}),IL(n,LL,function(t,e,r){var i={columns:2,rows:2},s=RL(DL,n).call(n,i,2),o=new Ti;o.name=e,o.addChild(s,t);var a=s.width,l=s.height,c=a/2+r%i.columns*(a+0),h=l/2+Math.floor(r/i.columns)*(l-2)-2;return o.position.set(c,h),o}),IL(n,FL,function(t){try{var e=RL(BL,n).call(n,t),r=new ma(e,CL(CL({},Yy),{},{fill:16046212}));return r.anchor.set(.5),r.name="innerSprite",r}catch(t){console.error("[HUD] createWord",t)}}),IL(n,BL,function(t){try{Ol.log(Cl.Hud,"---------------"),Ol.log(Cl.Hud,"name",t);var e=t.includes("_")?t.split("_")[0]:t;Ol.log(Cl.Hud,"hogItemName",e);var r=RL(OL,n).locale,i=Gf.gameConfig.localesHud,s=Object.keys(i).find(function(t){return t.toLowerCase()===e.toLowerCase()}),o=s?i[s][r]:e;return Ol.log(Cl.Hud," :",t),Ol.log(Cl.Hud,":",o),Ol.log(Cl.Hud,"-------------    -------------"),o.charAt(0).toLocaleUpperCase(r)+o.slice(1)}catch(t){Ol.log(Cl.Hud,"getTranslateWord",t)}}),S(n,"showNewIcon",function(){var t=Kl(Jl().mark(function t(e){var r,i,s,o,a,l,c,h,u;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:try{r=e.name.match(/\d+_(\w+)/),i=(null==r?void 0:r[1])||e.name,s=n.hud.hudChildren.find(function(t){return i===t.name}),o=null==s?void 0:s.getChildByName("innerSprite"),n.hud.itemsQueue.length>0?(a=n.hud.itemsQueue.shift(),l=a.attachment.name,c=l.match(/\/lvl_\d+_(\w+)$/),h=null==c?void 0:c[1].split("_")[0],s.name=h,u=RL(BL,n).call(n,h),Ff.timeline().to(o,{alpha:0}).set(o,{text:u}).to(o,{alpha:1}),n.hud.entityManager.createHogItems([a])):Ff.to(o,{alpha:0})}catch(t){console.log("[showNewIcon]",t)}case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),n}return T(e,t),w(e)}(TL);function WL(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(WL=function(){return!!t})()}var UL=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,WL()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),S(n,"maxItems",5),S(n,"name","default"),S(n,"animationDead",function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ff.timeline().to(e,{alpha:0});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),n}return T(e,t),w(e)}(TL);function jL(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function HL(t,e,n){return t.set(GL(t,e),n),n}function zL(t,e){return t.get(GL(t,e))}function GL(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var XL=new WeakMap,VL=new WeakMap,YL=new WeakMap,$L=new WeakMap,qL=new WeakMap,KL=new WeakMap,ZL=new WeakMap,QL=new WeakMap,JL=new WeakMap,tF=new WeakMap,eF=new WeakMap,nF=new WeakMap,rF=new WeakMap,iF=new WeakMap,sF=new WeakMap,oF=new WeakMap,aF=new WeakMap,lF=w(function t(e){var n=this;g(this,t),jL(this,XL,Gf.game),jL(this,VL,zL(XL,this).refs),jL(this,YL,void 0),jL(this,$L,void 0),jL(this,qL,void 0),jL(this,KL,[]),jL(this,ZL,[]),jL(this,QL,[]),jL(this,JL,void 0),S(this,"view",zL(VL,this).hudView),S(this,"entityManager",void 0),S(this,"itemsQueue",[]),S(this,"hudChildren",void 0),S(this,"isDebug",!1),S(this,"init",function(){zL(tF,n).call(n),HL(qL,n,zL(JL,n).maxItems),zL(eF,n).call(n),zL(nF,n).call(n),zL(rF,n).call(n),zL(sF,n).call(n),n.entityManager.createHogItems(zL(ZL,n)),zL(iF,n).call(n,!0)}),jL(this,tF,function(){var t=zL($L,n).spineName,e=_g.extractSuffix(t),r=S(S({},ul,_g.isStringTrue(gg.adapter.options.flags.useHudShadow)?new kL(n):new UL(n)),dl,_g.isStringTrue(gg.adapter.options.flags.useHudWords)?new NL(n):new UL(n));HL(JL,n,r[e]||new UL(n)),Ol.log(Cl.Hud,"[HUD strategy]",zL(JL,n).name)}),S(this,"showItems",function(){zL(JL,n).showItems()}),S(this,"clear",function(t){t&&Ol.log(Cl.DestroyMessage,"[Hud] module clear"),zL(iF,n).call(n,!1),n.view.destroy({children:!0}),HL(KL,n,[]),n.itemsQueue=[],HL(ZL,n,[]),HL(QL,n,[]),n.entityManager=null,HL(JL,n,null)}),jL(this,eF,function(){HL(QL,n,[]);var t=gk.findSlots(zL(YL,n).spineLevel,zL($L,n));HL(QL,n,function(t){for(var e=t.slice(),n=e.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),i=[e[r],e[n]];e[n]=i[0],e[r]=i[1]}return e}(t))}),jL(this,nF,function(){Ol.log(Cl.Hud,"==========      =========="),zL(QL,n).forEach(function(t,e){var r=t.attachment.name.split("/").pop();if(Ol.log(Cl.Hud,e+1,r),"words"!==zL(JL,n).name)zL(KL,n).push(r);else{var i=r.match(/\d+_(\w+)/),s=i?i[1]:r;zL(KL,n).push(s)}}),Ol.log(Cl.Hud,"========== attachmentName end ==========")}),jL(this,rF,function(){zL(QL,n).slice(0,zL(qL,n)).forEach(function(t,e){if("words"!==zL(JL,n).name){var r="hud-icon-".concat(zL(KL,n)[e]);ue[r]||console.error("[HUD createItems]:  ".concat(r,"  .   "))}var i=zL(JL,n).createHudIcon(zL(KL,n)[e],e,n.isDebug);n.view.hudInner.addChild(i),zL(ZL,n).push(t)}),n.itemsQueue=zL(QL,n).slice(zL(qL,n))}),jL(this,iF,function(t){var e=t?"on":"off";zL(XL,n)[e](Bg,zL(JL,n).showNewIcon),zL(XL,n)[e](Lg,zL(sF,n)),zL(XL,n)[e](Ug,n.reset)}),jL(this,sF,function(){var t=n.view,e=n.view.hudInner,r=zL(XL,n).uiRect.width-40;if(t.scale.set(1),t.y=ol.HEIGHT-120,zL(oF,n).call(n,t),ol.isPortrait&&e.width>r){var i=r/e.width;t.scale.set(i),t.y=ol.HEIGHT-10*i}}),jL(this,oF,function(t){var e=t.width,n=t.height;t.pivot.set(e/2,n/2),t.x=e/2,t.y=ol.HEIGHT-10}),jL(this,aF,function(){Gc(n.hudChildren).forEach(function(t){"foundItemsCounterView"!==t.name&&t.destroy()})}),S(this,"reset",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Ff.to({},{delay:1});case 1:zL(aF,n).call(n),HL(KL,n,[]),HL(ZL,n,[]),n.itemsQueue=[],zL($L,n).hogItemsBone="hogItems2",zL(eF,n).call(n),zL(nF,n).call(n),zL(rF,n).call(n),n.entityManager.createHogItems(zL(ZL,n)),n.entityManager.enableIdleInteractive(zL($L,n).hogItemsBone);case 2:case"end":return t.stop()}},t)}))),HL(YL,this,e),HL($L,this,e.config),this.entityManager=e.entityManager,this.view.hudInner=this.view.getChildByName("hudInner"),this.hudChildren=this.view.hudInner.children});function cF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function hF(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var uF=new WeakMap,dF=new WeakMap,pF=w(function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.game,i=n.label,s=void 0===i?"defaultStopwatch":i;g(this,t),S(this,"start",function(){hF(uF,e).call(e,!0);var t=Math.ceil(e.remainingTime);e.timerTween=Ff.to(e,{elapsedTime:e.duration,duration:e.duration,ease:"none",onUpdate:function(){var n=Math.floor(e.elapsedTime);n!==t&&(t=n,hF(dF,e).call(e,n))},onComplete:function(){e.clear()}})}),cF(this,uF,function(t){var n=t?"on":"off";e.game[n](jg,e.clear),e.game[n](zg,e.clear)}),cF(this,dF,function(t){e.game.emit("stopwatch:tick",{label:e.label,currentTime:t,currentTimeWithZero:t>9?t:"0".concat(t)})}),S(this,"clear",function(t){t&&Ol.log(Cl.DestroyMessage,"[Stopwatch] module clear"),e.timerTween&&(e.timerTween.kill(),e.timerTween=null,e.game.emit("stopwatch:kill",{label:e.label})),hF(uF,e).call(e,!1)}),this.game=r,this.duration=Math.floor(9999),this.label=s,this.remainingTime=this.duration,this.timerTween=null,this.elapsedTime=0},[{key:"fullDataTime",get:function(){var t=Math.floor(this.elapsedTime);return{h:Math.floor(t/3600),m:Math.floor(t%3600/60),s:t%60}}},{key:"seconds",get:function(){return Math.floor(this.elapsedTime)}}]);function fF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function mF(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var gF=new WeakMap,vF=new WeakMap,yF=w(function t(){var e=this;g(this,t),fF(this,gF,window.game),S(this,"modules",{}),fF(this,vF,function(){Object.values(e.modules).forEach(function(t){null!=t&&t.clear&&t.clear(!0)}),mF(gF,e).off(zg,mF(vF,e)),e.modules={}}),this.modules={},mF(gF,this).on(zg,mF(vF,this))},[{key:"getMod",value:function(t){return this.modules[t]}},{key:"init",value:function(t){if(t.errorCross&&(this.modules.errorCross=new ZD(t.errorCross)),t.stopwatch&&(this.modules.stopwatch=new pF(t.stopwatch),this.modules.stopwatch.start()),t.levelCounter&&(this.modules.levelCounter=new bL(t.levelCounter)),t.hud)return this.modules.hud=new lF(t.hud),this.modules.hud.init()}}]);function xF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(xF=function(){return!!t})()}function wF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function _F(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var bF=new WeakMap,AF=new WeakMap,TF=new WeakMap,SF=new WeakMap,EF=new WeakMap,kF=new WeakMap,MF=new WeakMap,CF=new WeakMap,PF=new WeakMap,IF=new WeakMap,RF=function(t){function e(){var t;return g(this,e),t=function(t,e){return e=b(e),_(t,xF()?Reflect.construct(e,[],b(t).constructor):e.apply(t,void 0))}(this,e),wF(t,bF,window.game),wF(t,AF,_F(bF,t).refs),S(t,"view",t),S(t,"popUp",void 0),S(t,"fade",void 0),S(t,"btnClose",void 0),S(t,"name","baseModal"),S(t,"eventMode","static"),S(t,"x",0),S(t,"y",0),S(t,"w",430),S(t,"h",500),S(t,"pivotCenter",!0),S(t,"text",""),S(t,"beginFill",16445894),S(t,"borderFill",9142607),S(t,"lineWidth",10),wF(t,TF,Kl(Jl().mark(function e(){return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _F(MF,t).call(t),e.next=1,t.show();case 1:$m.initOverHandler([t.btnClose]);case 2:case"end":return e.stop()}},e)}))),S(t,"show",Kl(Jl().mark(function e(){return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.view.visible=!0,e.next=1,Ff.fromTo(t,{alpha:0},{alpha:1});case 1:_F(SF,t).call(t,!0);case 2:case"end":return e.stop()}},e)}))),S(t,"destroy",function(){t.removeChildren(),_F(AF,t).wrapper.removeChild(t),t.view=null}),wF(t,SF,function(e){var n=e?"on":"off",r=e?"addEventListener":"removeEventListener";t.view[n]("pointerup",_F(EF,t)),document[r]("keydown",_F(kF,t))}),wF(t,EF,function(e){if(e.target.name===t.btnClose.name)return t.hide()}),wF(t,kF,function(e){if("escape"===e.key.toLowerCase()&&t.visible)return t.hide()}),wF(t,MF,function(){_F(CF,t).call(t),_F(PF,t).call(t),t.position.copyFrom(ol.CENTER)}),wF(t,CF,function(){var e=t,n=e.x,r=e.y,i=e.lineWidth,s=e.beginFill,o=e.borderFill,a=new Vo;a.name="viewPopUp",t.popUp=a,a.beginFill(s),a.lineStyle(i,o,1),a.drawRect(n+i/2,r+i/2,t.w,t.h),a.endFill(),a.eventMode="static",t.pivotCenter&&a.position.set(-a.width/2+n+i/2,-a.height/2+r+i/2),t.addChild(a)}),wF(t,PF,function(){var e=t,n=e.w,r=e.h,i=e.lineWidth,s=new ki(Kn.from("icon-close"));s.name="btnClose",s.anchor.set(.5),s.position.set(n/2+i/2,-r/2+i/2),s.type="button",s.cursor="pointer",s.eventMode="static",t.btnClose=s,t.addChild(s)}),wF(t,IF,function(){var e=new Vo;e.name="fade",e.beginFill(0),e.drawRect(-ol.HALF_W,-ol.HALF_H,ol.WIDTH,ol.HEIGHT),e.endFill(),e.alpha=.5,e.eventMode="static",t.fade=e,t.addChild(e)}),_F(TF,t).call(t),t}return T(e,t),w(e,[{key:"hide",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Gf.soundManager.play("sfx_btnClick"),_F(SF,this).call(this,!1),t.next=1,Ff.to(this,{alpha:0,visible:!1});case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}(Ti);function OF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function DF(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?OF(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OF(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function LF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(LF=function(){return!!t})()}function FF(t,e,n,r){var i=Zl(b(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function BF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function NF(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var WF=new WeakMap,UF=new WeakMap,jF=new WeakMap,HF=new WeakMap,zF=new WeakMap,GF=new WeakMap,XF=new WeakMap,VF=new WeakMap,YF=new WeakMap,$F=function(t){function e(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).promoData;return g(this,e),t=function(t,e){return e=b(e),_(t,LF()?Reflect.construct(e,[],b(t).constructor):e.apply(t,void 0))}(this,e),BF(t,WF,window.game),S(t,"promoData",void 0),S(t,"btnBye",void 0),S(t,"id",void 0),S(t,"textStyle",DF(DF({},Yy),{},{fontWeight:"bold"})),BF(t,UF,function(){NF(jF,t).call(t),NF(HF,t).call(t),NF(zF,t).call(t),NF(GF,t).call(t),NF(VF,t).call(t),$m.initOverHandler([t.btnBye])}),BF(t,jF,function(){var e=new ma(t.promoData.header,DF(DF({},Yy),{},{fontSize:28,fontWeight:"bold"}));e.anchor.set(.5),e.position.set(t.view.lineWidth/2,-t.view.h/2+50),t.view.addChild(e)}),BF(t,HF,function(){var e=new ki(Kn.from(t.promoData.texture));e.anchor.set(.5),e.position.set(0,-50),t.view.addChild(e)}),BF(t,zF,function(){var e=new ma(t.promoData.description,DF(DF({},Yy),{},{fontSize:28,align:"center"}));e.anchor.set(.5),e.position.set(t.view.lineWidth/2,110),t.view.addChild(e)}),BF(t,GF,function(){var e=new ki(Kn.from("btn-gold"));e.name="btnBye",e.anchor.set(.5),e.scale.set(.7),e.y=t.view.h/2-55,e.type="button",e.cursor="pointer",e.eventMode="static",t.btnBye=e,t.btnBye.once("pointerdown",NF(YF,t)),t.addChild(e)}),BF(t,XF,Kl(Jl().mark(function e(){var n,r;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,gg.purchase.getCatalog();case 1:if(n=e.sent,r=n[t.promoData.id]){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",{price:r.price,currency:gg.purchase.getCurrency()});case 3:case"end":return e.stop()}},e)}))),BF(t,VF,Kl(Jl().mark(function e(){var n,r,i,s,o,a;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,NF(XF,t).call(t);case 1:r=e.sent,i=r.price,s=r.currency,console.warn(i,s),o=null,(o="vk"===(null===(n=gg.flags)||void 0===n||null===(n=n.platform)||void 0===n?void 0:n.id)?new ma("".concat(i," \n ").concat(s),DF(DF({},Yy),{},{fontSize:42,lineHeight:39,fontWeight:"bold",align:"center"})):new ma("".concat(i," ").concat(s),DF(DF({},Yy),{},{fontSize:48,fontWeight:"bold",align:"center"}))).anchor.set(.5),t.btnBye.addChild(o),e.next=3;break;case 2:e.prev=2,a=e.catch(0),console.log("[setPricesToCards]",a);case 3:case"end":return e.stop()}},e,null,[[0,2]])}))),BF(t,YF,function(){NF(WF,t).emit(iv,t.promoData.id)}),t.promoData=n,t.id=n.id,NF(UF,t).call(t),t}return T(e,t),w(e,[{key:"hide",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,FF(e,"hide",this,3)([]);case 1:console.log("PromoCard   "),NF(WF,this).emit(sv);case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}])}(RF);function qF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function KF(t,e){return t.get(QF(t,e))}function ZF(t,e,n){return t.set(QF(t,e),n),n}function QF(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var JF={STARTED_PACK:{id:yx.promo.promoStartedPack.id,texture:"special-card-2",get header(){return"".concat(Uc.t("promoStartedPack.header"))},get description(){return"".concat(Uc.t("promoStartedPack.description"))}},REMOVE_AD_PACK:{id:yx.promo.promoRemoveAdPack.id,texture:"special-card-3",get header(){return"".concat(Uc.t("promoRemoveAdPack.header"))},get description(){return"".concat(Uc.t("promoRemoveAdPack.description"))}},MEGA_HINTS_PACK:{id:yx.promo.promoMegaHintsPack.id,texture:"special-card-1",get header(){return"".concat(Uc.t("promoMegaHintsPack.header"))},get description(){return"".concat(Uc.t("promoMegaHintsPack.description"))}}},tB=new WeakMap,eB=new WeakMap,nB=new WeakMap,rB=new WeakMap,iB=new WeakMap,sB=new WeakMap,oB=new WeakMap,aB=new WeakMap,lB=new WeakMap,cB=w(function t(e,n){var r=this;g(this,t),qF(this,tB,void 0),qF(this,eB,void 0),qF(this,nB,void 0),qF(this,rB,null),qF(this,iB,void 0),qF(this,sB,void 0),S(this,"createPromoCard",function(t){return new Promise(function(e){ZF(sB,r,e),ZF(rB,r,new $F({promoData:t})),KF(nB,r).addChild(KF(rB,r).view)})}),qF(this,oB,function(t){var e=t?"on":"off";KF(tB,r)[e](iv,KF(lB,r)),KF(tB,r)[e](jg,KF(aB,r)),KF(tB,r)[e](sv,function(){return KF(sB,r).call(r)})}),qF(this,aB,function(){KF(oB,r).call(r,!1),KF(nB,r).removeChild(KF(rB,r))}),qF(this,lB,function(){var e=Kl(Jl().mark(function e(n){return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Gf.soundManager.mute(),t.promoPacksId.includes(n)&&Gf.paymentManager.onPurchase(n),KF(oB,r).call(r,!1),e.next=1,KF(rB,r).hide(parent);case 1:KF(nB,r).removeChild(KF(rB,r));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),ZF(tB,this,e),ZF(eB,this,n),ZF(nB,this,window.game.view),ZF(iB,this,new ig(KF(tB,this).refs.purchaseErrorView)),KF(oB,this).call(this,!0)},null,[{key:"promoPacksId",get:function(){return Object.values(yx.promo).map(function(t){return t.id})}}]);function hB(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function uB(t,e,n){return t.set(pB(t,e),n),n}function dB(t,e){return t.get(pB(t,e))}function pB(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}S(cB,"getPromoDataForLevel",function(t){var e=t.playerData.hasAdPass,n=t.levelIndex;if(!e){if(2===n)return JF.STARTED_PACK;if(5===n)return JF.MEGA_HINTS_PACK;if(10===n)return JF.REMOVE_AD_PACK}return e&&20===n?JF.MEGA_HINTS_PACK:null});var fB=new WeakMap,mB=new WeakMap,gB=new WeakMap,vB=new WeakMap,yB=new WeakMap,xB=new WeakMap,wB=new WeakMap,_B=new WeakMap,bB=new WeakMap,AB=new WeakMap,TB=new WeakMap,SB=new WeakMap,EB=new WeakMap,kB=new WeakMap,MB=new WeakMap,CB=new WeakMap,PB=new WeakMap,IB=new WeakMap,RB=new WeakMap,OB=new WeakMap,DB=new WeakMap,LB=new WeakMap,FB=new WeakMap,BB=new WeakMap,NB=w(function t(e){var n=this;g(this,t),hB(this,fB,window.game),hB(this,mB,dB(fB,this).refs),hB(this,gB,void 0),hB(this,vB,void 0),hB(this,yB,void 0),hB(this,xB,void 0),hB(this,wB,void 0),hB(this,_B,!0),S(this,"init",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return uB(vB,n,Gf.storage),uB(yB,n,Gf.soundManager),dB(bB,n).call(n),dB(AB,n).call(n,!0),dB(fB,n).emit(nv),dB(BB,n).call(n),t.next=1,dB(TB,n).call(n);case 1:return t.next=2,dB(SB,n).call(n);case 2:gg.gamePlayStop();case 3:case"end":return t.stop()}},t)}))),hB(this,bB,function(){uB(gB,n,dB(mB,n).completeLevelView),uB(xB,n,dB(gB,n).getChildByName("btnNext",1)),n.btnNextInnerText=dB(xB,n).getChildByName("innerText",2),n.btnBuyLoupe=dB(gB,n).getChildByName("btnBuyLoupe",1),n.btnHome=dB(gB,n).getChildByName("btnHome",1),n.btnByeAd=dB(gB,n).getChildByName("btnByeAd",1),n.btns=[dB(xB,n),n.btnBuyLoupe,n.btnHome,n.btnByeAd],$m.initOverHandler(n.btns),n.purchaseError=new ig(dB(mB,n).purchaseErrorView,.65)}),hB(this,AB,function(t){var e=t?"on":"off",r=t?"once":"off";dB(xB,n)[r]("pointerdown",dB(RB,n)),n.btnHome[r]("pointerdown",dB(OB,n)),n.btnBuyLoupe[e]("pointerdown",dB(DB,n)),n.btnByeAd[e]("pointerdown",dB(LB,n)),dB(fB,n)[e](zg,dB(AB,n).bind(n,!1)),dB(fB,n)[e](rv,dB(IB,n)),dB(fB,n)[e](Yg,dB(FB,n))}),hB(this,TB,Kl(Jl().mark(function t(){var e,r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(gg.adapter.purchase.isAvailable()){t.next=1;break}return console.error("SdkManager.adapter.purchase.isAvailable() not found"),t.abrupt("return");case 1:if(null===(e=gg.flags)||void 0===e||null===(e=e.platform)||void 0===e||!e.noStore){t.next=2;break}return t.abrupt("return");case 2:if(r=cB.getPromoDataForLevel(dB(vB,n))){t.next=3;break}return t.abrupt("return");case 3:return i=new cB(dB(fB,n),dB(vB,n)),t.next=4,i.createPromoCard(r);case 4:case"end":return t.stop()}},t)}))),hB(this,SB,Kl(Jl().mark(function t(){var e,r,i,s,o;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return dB(EB,n).call(n),e=dB(vB,n).userLevel,n.btnNextInnerText.text="".concat(Uc.t("level")," ").concat(e),dB(FB,n).call(n),t.next=1,$I.checkAndShowRateUs(dB(vB,n),n.levelEntity);case 1:return dB(kB,n).call(n),dB(MB,n).call(n),r=uB,i=wB,s=n,t.next=2,Ff.timeline().call(Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,dB(yB,n).stopAll();case 1:return t.next=2,dB(yB,n).play("sfx_victory");case 2:return t.next=3,dB(yB,n).play("m_victory");case 3:case"end":return t.stop()}},t)}))).set([dB(gB,n)],{visible:!0}).fromTo(dB(gB,n),{alpha:0},{alpha:1},"<").fromTo(dB(mB,n).speechBubble.scale,{x:0,y:0},{x:1,y:1,ease:"back.out(2.5)"},"<").add(dB(CB,n),"".concat(dB(vB,n).playerData.option_isPlayMusic?"+=1.8":"0.6"));case 2:o=t.sent,r(i,s,o);case 3:case"end":return t.stop()}},t)}))),hB(this,EB,function(){var t=_v.getGameLevelData(dB(vB,n).playerData.levelIndex),e=_g.extractSuffix(t.spineName);if(e){var r=_g.isStringTrue(gg.adapter.options.flags.useHudWords),i=_g.isStringTrue(gg.adapter.options.flags.useHudShadow),s=_g.isStringTrue(gg.adapter.options.flags.useLevelTypeGeneration),o=function(){var t=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type,e=JM(JM({},Yy),{},{fontSize:23,fill:16777215}),n=16777215,r="";return t===ul&&(n=16753920,r="".concat(Uc.t("difficultyLevels.".concat("hard")))),t===dl&&(n=16722750,r="".concat(Uc.t("difficultyLevels.".concat("veryHard")))),t===pl&&(n=3092271,r="".concat(Uc.t("difficultyLevels.".concat("extreme")))),Xc(Ti,{x:90,y:46},Xc(ki,{texture:"btn-badge",anchor:{x:.5,y:.5},tint:n}),Xc(ma,{text:r,anchor:{x:.5,y:.5},angle:-10,style:JM({},e)}))}({type:e});dB(xB,n).addChild(t)};e===ul&&i&&o(),e===dl&&r&&o(),e===pl&&s&&o()}}),hB(this,kB,function(){var t=dB(mB,n).character,e=t.spineData.animations.map(function(t){return t.name}),r=Gm.getRandomNumber(0,e.length-1,0);t.state.setAnimation(0,e[r],!0)}),hB(this,MB,function(){try{var t=n.levelEntity.storyTextData.outroText;dB(mB,n).speechBubbleText.text=t}catch(t){console.warn("speechBubbleText error",t)}}),hB(this,CB,function(){if(dB(_B,n))try{var t=n.levelEntity.storyTextData.outroSpeech;dB(yB,n).play(t)}catch(t){console.warn("playSpeech error",t)}}),hB(this,PB,function(){return dB(gB,n).interactiveChildren=!1,Ff.timeline().to(dB(gB,n),{alpha:0,visible:!1})}),hB(this,IB,function(){return dB(gB,n).interactiveChildren=!0,Ff.timeline().to(dB(gB,n),{alpha:1,visible:!0})}),hB(this,RB,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:uB(_B,n,!1),ag.finalScreenBtnNext(),dB(AB,n).call(n,!1),Xm(dB(wB,n),!0,1),dB(yB,n).stopAll(),n.state.runNextLevel();case 1:case"end":return t.stop()}},t)}))),hB(this,OB,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return ag.finalScreenBtnHome(),dB(AB,n).call(n,!1),dB(yB,n).play("sfx_btnClick"),t.next=1,$m.click(n.btnHome);case 1:n.state.checkoutState(ll);case 2:case"end":return t.stop()}},t)}))),hB(this,DB,function(){ag.finalScreenBtnStore(),dB(yB,n).play("sfx_btnClick"),dB(PB,n).call(n),dB(fB,n).LEVEL.uiManager.showModule(dw,!0)}),hB(this,LB,function(){ag.finalScreenBtnDisableAd();var t=yx.store.noAdPack.id;Gf.paymentManager.onPurchase(t)}),hB(this,FB,function(){if(dB(vB,n).playerData.hasAdPass){var t=n.btnByeAd;t.eventMode="none";var e=new Oi;e.brightness(.6,!0),e.greyscale(.6,!0),t.filters=[e]}}),hB(this,BB,function(){var t=n.levelEntity.modulesInitializer.getMod("stopwatch").seconds;ag.completeLevel(n.levelEntity.config,dB(vB,n),t)}),this.levelEntity=e,this.state=e.state});function WB(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function UB(t,e,n){return t.set(HB(t,e),n),n}function jB(t,e){return t.get(HB(t,e))}function HB(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zB=new WeakMap,GB=new WeakMap,XB=new WeakMap,VB=new WeakMap,YB=new WeakMap,$B=new WeakMap,qB=new WeakMap,KB=new WeakMap,ZB=new WeakMap,QB=new WeakMap,JB=new WeakMap,tN=new WeakMap,eN=new WeakMap,nN=new WeakMap,rN=new WeakMap,iN=new WeakMap,sN=new WeakMap,oN=new WeakMap,aN=new WeakMap,lN=new WeakMap,cN=new WeakMap,hN=new WeakMap,uN=new WeakMap,dN=new WeakMap,pN=new WeakMap,fN=new WeakMap,mN=new WeakMap,gN=new WeakMap,vN=new WeakMap,yN=new WeakMap,xN=new WeakMap,wN=new WeakMap,_N=new WeakMap,bN=w(function t(e){var n=this;g(this,t),WB(this,zB,Gf.game),WB(this,GB,jB(zB,this).refs),WB(this,XB,null),WB(this,VB,null),WB(this,YB,null),WB(this,$B,.65),WB(this,qB,new Vo),WB(this,KB,null),WB(this,ZB,null),WB(this,QB,null),WB(this,JB,!1),WB(this,tN,0),WB(this,eN,void 0),S(this,"init",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!jB(JB,n)){t.next=1;break}return t.abrupt("return");case 1:return jB(rN,n).call(n,!0),jB(sN,n).call(n,!0),jB(iN,n).call(n),t.next=2,jB(aN,n).call(n);case 2:return t.next=3,jB(uN,n).call(n);case 3:jB(zB,n).app.stage.interactiveChildren=!0,jB(fN,n).call(n);case 4:case"end":return t.stop()}},t)}))),WB(this,nN,function(){jB(zB,n).uiInner.addChild(Xc(function(t){var e=t.game,n=t.refs;return Xc(Ti,{visible:!1,ref:function(t){return n.learningView=t},name:"learningView",classes:$y(e).learningView})},{refs:jB(zB,n).refs,game:jB(zB,n)}))}),S(this,"waitForCompletion",function(){return jB(XB,n)}),WB(this,rN,function(t){var e=t?"on":"off";jB(zB,n)[e](jg,jB(pN,n)),jB(zB,n)[e](Bg,jB(mN,n))}),WB(this,iN,function(){var t=new mm;t.color=0,t.name="colorOverlayFilter",t.alpha=jB($B,n),jB(zB,n).uiInner.children.forEach(function(e){"learningView"!==e.name&&(e.filters=[t])})}),WB(this,sN,function(t){var e=t?"pause":"resume",r=t?"none":"static",i=jB(GB,n),s=i.btnHint,o=i.optionsWheel;s.eventMode=r,o.eventMode=r;var a=n.level.camera;a.setPause(r),a.plugins[e]("drag"),a.plugins[e]("wheel"),a.plugins[e]("pinch")}),WB(this,oN,function(){jB(qB,n).clear(),jB(qB,n).beginFill(16777215),jB(qB,n).drawRect(0,0,ol.WIDTH,ol.HEIGHT),jB(qB,n).endFill()}),WB(this,aN,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return jB(lN,n).call(n),jB(cN,n).call(n),t.next=1,Ff.timeline().fromTo(jB(YB,n),{alpha:0},{alpha:jB($B,n),delay:jB(tN,n),duration:1});case 1:case"end":return t.stop()}},t)}))),WB(this,lN,Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(e=yg({w:ol.WIDTH,h:ol.HEIGHT,color:0,alpha:0})).zIndex=1,jB(GB,n).levelContainer.addChild(e),UB(YB,n,e);case 1:case"end":return t.stop()}},t)}))),WB(this,cN,function(){jB(YB,n).mask=jB(qB,n),jB(hN,n).call(n,ol.HALF_W,ol.HALF_H,1),jB(qB,n).zIndex=3,jB(GB,n).levelContainer.addChild(jB(qB,n))}),WB(this,hN,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;jB(qB,n).clear(),jB(qB,n).beginFill(16777215),jB(qB,n).drawRect(0,0,ol.WIDTH,ol.HEIGHT),jB(qB,n).endFill(),jB(qB,n).beginHole(),jB(qB,n).drawCircle(t,e,r),jB(qB,n).endHole()}),WB(this,uN,function(){var t={circleX:ol.HALF_W,circleY:ol.HALF_H,radius:1},e=ol.HALF_W-40,r=ol.HALF_H-30;return Ff.fromTo(t,{circleX:ol.HALF_W+200,circleY:ol.HALF_H,radius:1},{circleX:e,circleY:r,radius:100,duration:1.5,ease:"back.out(2.5)",onUpdate:function(){jB(hN,n).call(n,t.circleX,t.circleY,t.radius)}})}),WB(this,dN,function(){var t=new ki(Kn.from("learning-arrow"));t.zIndex=1,t.anchor.set(.5);var e=ol.HALF_W-40,r=ol.HALF_H-30-t.height;return t.position.set(e,r),jB(GB,n).levelContainer.addChild(t),t}),WB(this,pN,function(){jB(JB,n)||(UB(JB,n,!0),console.warn("destroy learning"),jB(rN,n).call(n,!1),Ff.timeline().set([jB(KB,n)],{alpha:0,visible:!1}).call(function(){return Xm(jB(ZB,n),!0)}).call(function(){return jB(oN,n).call(n)}).set([jB(YB,n)],{alpha:0,visible:!1}))}),WB(this,fN,function(){UB(KB,n,jB(dN,n).call(n)),UB(ZB,n,Ff.timeline().from(jB(KB,n),{y:0,yoyo:!0}).to(jB(KB,n),{y:"-=70",repeat:-1,yoyo:!0}))}),WB(this,mN,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return jB(vN,n).call(n),t.next=1,jB(gN,n).call(n);case 1:return t.next=2,jB(yN,n).call(n);case 2:return t.next=3,jB(xN,n).call(n);case 3:return t.next=4,jB(wN,n).call(n);case 4:case"end":return t.stop()}},t)}))),WB(this,gN,function(){var t=jB(GB,n).learningView,e=gk.createSpine({spineName:"pinch",animationName:"idle",speed:1,autorun:!1,loop:!0});e.zIndex=10,e.position.set(-100,-230),t.addChild(e),UB(eN,n,e)}),WB(this,vN,function(){var t=jB(GB,n).learningView;return UB(QB,n,Ff.timeline().set(jB(KB,n),{alpha:0,visible:!1}).call(function(){return Xm(jB(ZB,n),!0)}).call(function(){return jB(oN,n).call(n)}).set(t,{visible:!0}).from(t,{alpha:0}))}),WB(this,yN,Kl(Jl().mark(function t(){var e,r;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.level.camera,r=jB(zB,n).scaleFactor+.25,jB(eN,n).state.setAnimation(0,"idle",!1),t.next=1,Ff.timeline({repeat:1,yoyo:!0}).to(e.scale,{x:r,y:r,duration:.8,ease:"sine.inOut",onUpdate:function(){return e.moveCenter(ol.HALF_W,ol.HALF_H)}});case 1:case"end":return t.stop()}},t)}))),WB(this,xN,Kl(Jl().mark(function t(){var e,r;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.level.camera,n.level.camera.setPause(!1),r=function(t){return new Promise(function(r){e.animate({scale:jB(zB,n).scaleFactor,position:new Ye(t,ol.HALF_H),time:500,ease:"easeInOutQuad",callbackOnComplete:function(){return r(!0)}})})},t.next=1,r(ol.HALF_W-300);case 1:return t.next=2,r(ol.HALF_W);case 2:return t.next=3,r(ol.HALF_W+300);case 3:return t.next=4,r(ol.HALF_W);case 4:case"end":return t.stop()}},t)}))),WB(this,wN,function(){jB(rN,n).call(n,!1),Xm(jB(QB,n),!0);var t=jB(GB,n).learningView;return Ff.timeline().to([jB(eN,n),t],{alpha:0,duration:.3}).to(jB(YB,n),{alpha:0},"<").call(Kl(Jl().mark(function e(){return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:jB(eN,n).state.clearTracks(),jB(zB,n).uiInner.children.forEach(function(t){return t.filters=[]}),jB(sN,n).call(n,!1),t.destroy({children:!0}),jB(zB,n).uiInner.removeChild(t),t.removeChild(!0),jB(GB,n).levelContainer.removeChild(jB(YB,n)),jB(_N,n).call(n);case 1:case"end":return e.stop()}},e)}))).call(jB(VB,n))}),WB(this,_N,function(){for(var t,e,n=0,r=["pinch","assets/spines/pinch/pinch.png"];n<r.length;n++){var i,s,o,a,l=r[n],c=(null===(i=(s=Ds.cache._cache).get)||void 0===i?void 0:i.call(s,l))||Ds.cache._cache[l];c&&"function"==typeof c.destroy&&(c.textureCacheIds&&c.textureCacheIds.forEach(function(t){delete ue[t]}),c.destroy(!0)),null===(o=(a=Ds.cache._cache).delete)||void 0===o||o.call(a,l),delete Ds.cache._cache[l]}null===(t=(e=Ds.cache._cache).delete)||void 0===t||t.call(e,"pinch.spineData"),delete Ds.cache._cache["pinch.spineData"]}),this.level=e,jB(nN,this).call(this),UB(XB,this,new Promise(function(t){UB(VB,n,t)}))});function AN(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function TN(t,e,n){return t.set(EN(t,e),n),n}function SN(t,e){return t.get(EN(t,e))}function EN(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kN=new WeakMap,MN=new WeakMap,CN=new WeakMap,PN=new WeakMap,IN=new WeakMap,RN=new WeakMap,ON=new WeakMap,DN=new WeakMap,LN=new WeakMap,FN=w(function t(e){var n=this;g(this,t),AN(this,kN,window.game),AN(this,MN,SN(kN,this).refs),AN(this,CN,new Vo),AN(this,PN,void 0),AN(this,IN,void 0),AN(this,RN,void 0),S(this,"initHole",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,SN(ON,n).call(n);case 1:SN(DN,n).call(n);case 2:case"end":return t.stop()}},t)}))),AN(this,ON,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return TN(PN,n,yg({w:ol.WIDTH,h:ol.HEIGHT,color:0,alpha:0})),SN(MN,n).levelContainer.addChild(SN(PN,n)),t.next=1,Ff.timeline().fromTo(SN(PN,n),{alpha:0},{alpha:SN(RN,n).maxFadeAlpha,delay:SN(IN,n),duration:1});case 1:case"end":return t.stop()}},t)}))),AN(this,DN,function(){SN(PN,n).mask=SN(CN,n),SN(LN,n).call(n,ol.HALF_W,ol.HALF_H,1),SN(MN,n).levelContainer.addChild(SN(CN,n))}),S(this,"animateHole",function(){var t=SN(RN,n).getTarget(),e=t.target,r=t.position;SN(RN,n).animateCamera(e),SN(RN,n).animationStars(e);var i={circleX:ol.HALF_W,circleY:ol.HALF_H,radius:1};return Ff.fromTo(i,{circleX:r.x,circleY:r.y,radius:1},{circleX:r.x,circleY:r.y,radius:100,duration:1.5,ease:"back.out(2.5)",onUpdate:function(){SN(LN,n).call(n,i.circleX,i.circleY,i.radius)}})}),AN(this,LN,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;SN(CN,n).clear(),SN(CN,n).beginFill(16777215),SN(CN,n).drawRect(0,0,ol.WIDTH,ol.HEIGHT),SN(CN,n).endFill(),SN(CN,n).beginHole(),SN(CN,n).drawCircle(t,e,r),SN(CN,n).endHole()}),S(this,"hideHole",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return SN(CN,n).clear(),SN(CN,n).beginFill(16777215),SN(CN,n).drawRect(0,0,ol.WIDTH,ol.HEIGHT),SN(CN,n).endFill(),t.next=1,Ff.to(SN(PN,n),{alpha:0,visible:!1});case 1:SN(MN,n).levelContainer.removeChild(SN(PN,n)),SN(MN,n).levelContainer.removeChild(SN(CN,n));case 2:case"end":return t.stop()}},t)}))),TN(RN,this,e)});function BN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function NN(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?BN(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BN(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function WN(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function UN(t,e,n){return t.set(HN(t,e),n),n}function jN(t,e){return t.get(HN(t,e))}function HN(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zN=new WeakMap,GN=new WeakMap,XN=new WeakMap,VN=new WeakMap,YN=new WeakMap,$N=new WeakMap,qN=new WeakMap,KN=new WeakMap,ZN=new WeakMap,QN=new WeakMap,JN=new WeakMap,tW=new WeakMap,eW=new WeakMap,nW=w(function t(e,n){var r=this;g(this,t),WN(this,zN,window.game),WN(this,GN,jN(zN,this).refs),WN(this,XN,void 0),WN(this,VN,null),WN(this,YN,null),WN(this,$N,void 0),WN(this,qN,void 0),S(this,"maxFadeAlpha",.65),WN(this,KN,void 0),S(this,"level",void 0),S(this,"textMessage",void 0),S(this,"init",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return jN(KN,r).disabledUserMove(),t.next=1,jN(XN,r).initHole();case 1:return jN(ZN,r).call(r,!0),t.next=2,jN(QN,r).call(r);case 2:jN(XN,r).animateHole();case 3:case"end":return t.stop()}},t)}))),WN(this,ZN,function(t){var e=t?"on":"off";jN(zN,r)[e](jg,jN(JN,r)),jN(zN,r)[e](Bg,jN(eW,r))}),WN(this,QN,function(){return new Promise(function(t){var e=function(){var t={},e={fade:{texture:Kn.WHITE,width:ol.WIDTH,height:ol.HEIGHT,tint:0,alpha:.5},view:Xy({x:ol.HALF_W,y:ol.HALF_H,pivot:function(){return{x:t.view.width/2,y:t.view.height/2}},"(orientation: landscape)":{}})},n=new Vo;return n.lineStyle(10,9142607,1),n.beginFill(16445894),n.drawRect(0,0,430,300),n.endFill(),Xc(Ti,{ref:function(e){return t.root=e},eventMode:"static",name:"optionView",zIndex:10,resize:function(){t.view.classes=e.view}},Xc(Ti,{classes:e.view,name:"view",ref:function(e){return t.view=e},eventMode:"static"},n,Xc(ma,{text:"testing text",name:"innerText",x:215,y:100,anchor:{x:.5,y:.5},style:NN(NN({},Yy),{},{wordWrap:!0,wordWrapWidth:410,align:"center",fontSize:26,fill:0,fontWeight:"normal"})}),Xc(rx,{texture:"btn-silver",name:"btnInner",text:"OK",x:215,y:250,scaleValue:.5})))}();e.refs=e,jN(GN,r).wrapper.addChild(e),e.getChildByName("innerText",1).text=r.textMessage,Ff.from(e,{alpha:0}),e.getChildByName("btnInner",1).once("pointerdown",Kl(Jl().mark(function n(){return Jl().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Gf.soundManager.play("sfx_btnClick"),n.next=1,Ff.to(e,{alpha:0});case 1:Gf.soundManager.play("sfx_hintFlash"),jN(GN,r).wrapper.removeChild(e),t();case 2:case"end":return n.stop()}},n)})))})}),S(this,"getTarget",function(){var t,e=(t=r.level.entityManager.initialHogItems,Array.isArray(t)&&0!==t.length?t[Math.floor(Math.random()*t.length)]:null);return{target:e,position:gk.getSlotSpritePosition(e)}}),S(this,"animationStars",function(t){var e=jN(GN,r).hintStars,n=gk.getSlotSpritePosition(t),i=n.x,s=n.y;UN($N,r,Ff.timeline().set(e,{x:i,y:s,visible:!0,zIndex:2}).fromTo(e.scale,{x:1.5,y:1.5},{x:2.2,y:2.2,yoyo:!0,duration:1,repeat:-1}).to(e,{angle:360,duration:2,ease:"power1.inOut",repeat:-1},"<"))}),S(this,"animateCamera",function(t){var e=jN(KN,r).getTargetCenter(t);jN(KN,r).follow(e,{speed:8,acceleration:.5})}),S(this,"waitForCompletion",function(){return jN(VN,r)}),WN(this,JN,function(){console.warn("------------- destroy learning"),jN(ZN,r).call(r,!1),Ff.timeline().call(function(){return Xm(jN($N,r),!0)}).call(function(){return jN(XN,r).hideHole()})}),WN(this,tW,function(){jN(KN,r).animate({scale:jN(zN,r).scaleFactor,position:new Ye(ol.HALF_W,ol.HALF_H),time:1e3,ease:"easeInOutSine",callbackOnComplete:function(){}})}),WN(this,eW,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return jN(ZN,r).call(r,!1),jN(KN,r).plugins.remove("follow"),Xm(jN($N,r),!0),Xm(jN(qN,r),!0),Ff.timeline().to(jN(GN,r).hintStars,{alpha:0,visible:!1}),jN(XN,r).hideHole(),jN(KN,r).unDisabledUserMove(),jN(tW,r).call(r),t.abrupt("return",Ff.timeline().call(jN(YN,r)));case 1:case"end":return t.stop()}},t)}))),this.level=e,this.textMessage=n,UN(KN,this,e.camera),UN(XN,this,new FN(this)),UN(VN,this,new Promise(function(t){UN(YN,r,t)}))});function rW(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function iW(t,e){return t.get(oW(t,e))}function sW(t,e,n){return t.set(oW(t,e),n),n}function oW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var aW=new WeakMap,lW=new WeakMap,cW=new WeakMap,hW=new WeakMap,uW=new WeakMap,dW=new WeakMap,pW=new WeakMap,fW=w(function t(e){var n=this;g(this,t),rW(this,aW,null),rW(this,lW,void 0),rW(this,cW,void 0),S(this,"checkIsLearning",function(){var t=Kl(Jl().mark(function t(e){var r,i,s;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(sW(cW,n,Gf.storage),r=Gf.storage.playerData,i=r.levelIndex,s=r.skinIndex,0!==i||1!==s){t.next=2;break}return t.next=1,iW(hW,n).call(n);case 1:return t.abrupt("return");case 2:return t.next=3,iW(uW,n).call(n,e);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),rW(this,hW,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sW(aW,n,new bN(iW(lW,n))),t.next=1,iW(aW,n).init();case 1:return t.next=2,iW(aW,n).waitForCompletion();case 2:case"end":return t.stop()}},t)}))),rW(this,uW,function(){var t=Kl(Jl().mark(function t(e){var r,i,s,o;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=_g.detectLevelType(iW(lW,n).config.spineName),i=r.leveTypeName,s=r.isEnabled,(o=iW(dW,n).call(n,i))&&!1!==o.isEnabled){t.next=1;break}return t.abrupt("return");case 1:if(!iW(cW,n).playerData[o.flagName]){t.next=2;break}return t.abrupt("return");case 2:Ol.log("","   ".concat(i,",   : ").concat(s)),iW(pW,n).call(n,e,o);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),rW(this,dW,function(t){return S(S(S({},ul,{textMessage:Uc.t("learning.shadows"),flagName:dg}),dl,{textMessage:Uc.t("learning.words"),flagName:pg}),pl,{textMessage:Uc.t("learning.generator"),flagName:fg})[t]}),rW(this,pW,function(){var t=Kl(Jl().mark(function t(e,r){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sW(aW,n,new nW(e,r.textMessage)),t.next=1,iW(aW,n).init();case 1:return t.next=2,iW(aW,n).waitForCompletion();case 2:iW(cW,n).playerData[r.flagName]=!0,iW(cW,n).save();case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),sW(lW,this,e)});function mW(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function gW(t,e,n){return t.set(yW(t,e),n),n}function vW(t,e){return t.get(yW(t,e))}function yW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xW=new WeakMap,wW=new WeakMap,_W=new WeakMap,bW=new WeakMap,AW=new WeakMap,TW=new WeakMap,SW=new WeakMap,EW=new WeakMap,kW=new WeakMap,MW=new WeakMap,CW=new WeakMap,PW=new WeakMap,IW=new WeakMap,RW=new WeakMap,OW=new WeakMap,DW=new WeakMap,LW=new WeakMap,FW=new WeakMap,BW=new WeakMap,NW=new WeakMap,WW=new WeakMap,UW=new WeakMap,jW=new WeakMap,HW=new WeakMap,zW=new WeakMap,GW=new WeakMap,XW=w(function t(e){var n=this;g(this,t),mW(this,xW,window.game),mW(this,wW,vW(xW,this).refs),mW(this,_W,vW(xW,this).app.stage),S(this,"entityManager",null),mW(this,bW,null),mW(this,AW,null),S(this,"camera",null),mW(this,TW,null),S(this,"modulesInitializer",null),mW(this,SW,null),mW(this,EW,null),mW(this,kW,null),S(this,"levelConfig",null),S(this,"uiManager",null),mW(this,MW,void 0),mW(this,CW,!1),mW(this,PW,!1),mW(this,IW,!1),S(this,"storyTextData",void 0),S(this,"config",null),S(this,"initializeComponents",function(){gW(AW,n,Gf.storage),n.camera=new uO(vW(xW,n),vW(wW,n).levelContainer),gW(TW,n,new ID(n)),n.modulesInitializer=new yF,gW(EW,n,new gR(n)),n.uiManager=new aR(n),gW(MW,n,new uw(n.state)),gW(SW,n,new fW(n)),gW(kW,n,new NB(n)),n.levelConfig=new _v,n.storyTextData=_v.getSpeechAndTextData(vW(xW,n),vW(AW,n))}),mW(this,RW,function(t){var e=t?"on":"off";vW(xW,n)[e](Ug,vW(jW,n)),vW(xW,n)[e](Hg,vW(HW,n))}),mW(this,OW,function(){var t=n.config.amb;if(t){var e="".concat(ml.remote,"assets/audio/ambience/").concat(t,".mp3");Gf.soundManager.loadAndPlayAmbient(t,e,{loop:!0})}}),mW(this,DW,function(){var t=vW(wW,n).levelContainer,e=gk.createSpine({spineName:"smoke",autorun:!0,animationName:"idle"});e.zIndex=1,t.addChild(e),Ff.timeline().to(e,{alpha:0,duration:1,delay:3}).eventCallback("onComplete",function(){!function(){try{e.visible=!1,t.removeChild(e),e.destroy()}catch(t){console.log(t)}}()})}),mW(this,LW,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return vW(FW,n).call(n),t.next=1,Ff.timeline().set(vW(wW,n).introSpeechBubble,{alpha:1}).to({},{delay:3}).to(vW(wW,n).introSpeechBubble,{alpha:0});case 1:case"end":return t.stop()}},t)}))),S(this,"unlockScene",function(){vW(_W,n).interactiveChildren=!0,n.camera.eventMode="static",n.camera.interactiveChildren=!0,n.camera.setPause(!1);var t=vW(wW,n),e=t.optionsWheel,r=t.btnHint;Ff.fromTo([e,r],{alpha:0},{alpha:1,visible:!0})}),mW(this,FW,function(){var t=vW(wW,n).introSpeechBubble.getChildByName("speechBubbleText"),e=n.storyTextData.introText;try{t.text=e}catch(t){console.log("setStoryText",t)}}),mW(this,BW,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.entityManager=new XC(n.config),t.next=1,n.entityManager.createEntities();case 1:case"end":return t.stop()}},t)}))),mW(this,NW,function(){gW(bW,n,new RI(n)),vW(bW,n).initSystems()}),mW(this,WW,function(){n.camera.init(),vW(TW,n).init()}),mW(this,UW,function(){n.modulesInitializer.init({errorCross:vW(wW,n).levelContainer,levelCounter:n,hud:n})}),mW(this,jW,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,Gf.uiController.hide([vW(wW,n).hudView]);case 1:return vW(_W,n).interactiveChildren=!1,n.camera.setPause(!0),Gf.soundManager.playRandomSpeech({maxCount:20,nameTemplate:"speech_{locale}_partscene{i}"}),t.next=2,Ff.to({},{delay:1});case 2:return n.camera.setPause(!1),vW(_W,n).interactiveChildren=!0,t.next=3,Gf.uiController.show([vW(wW,n).hudView]);case 3:case"end":return t.stop()}},t)}))),mW(this,HW,Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!vW(IW,n)){t.next=1;break}return t.abrupt("return");case 1:return gW(PW,n,!0),gW(CW,n,!0),gg.gamePlayStop(),vW(xW,n).emit(jg),vW(bW,n).removeAllSystems(),t.next=2,Gf.uiController.hide([vW(wW,n).hudView]);case 2:return t.next=3,vW(zW,n).call(n);case 3:vW(kW,n).init(),n.levelConfig.updateSavedLevel();case 4:case"end":return t.stop()}},t)}))),mW(this,zW,Kl(Jl().mark(function t(){var e,r,i;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r="vk"===(null===(e=gg.flags)||void 0===e||null===(e=e.platform)||void 0===e?void 0:e.id),i=vW(AW,n).levelIndex,!(r&&i>0)){t.next=1;break}return t.next=1,gg.showInterstitial();case 1:case"end":return t.stop()}},t)}))),S(this,"exit",function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(gg.gamePlayStop(),vW(xW,n).clearLevelCache(),vW(_W,n).interactiveChildren=!1,vW(xW,n).emit(jg,e),vW(RW,n).call(n,!1),!vW(CW,n)){var r=n.modulesInitializer.getMod("stopwatch").seconds;ag.earlyExit(n.config,vW(AW,n),r)}n.camera=null,null===(t=vW(wW,n))||void 0===t||null===(t=t.character)||void 0===t||t.destroy(),vW(bW,n).removeAllSystems(),vW(EW,n).clear(n.entityManager.entities,vW(bW,n).systems)}),mW(this,GW,function(){}),this.state=e,vW(_W,this).interactiveChildren=!1,vW(xW,this).uiInner.visible=!1,vW(xW,this).LEVEL=this},[{key:"init",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.initializeComponents(),vW(DW,this).call(this),this.config=this.levelConfig.getConfig(),vW(OW,this).call(this),t.next=1,vW(BW,this).call(this);case 1:return vW(NW,this).call(this),vW(UW,this).call(this),vW(WW,this).call(this),gg.gameplayStart(),Gf.uiController.show(),t.next=2,vW(LW,this).call(this);case 2:return this.modulesInitializer.getMod("hud").showItems(),t.next=3,vW(SW,this).checkIsLearning(this);case 3:this.unlockScene(),this.modulesInitializer.init({stopwatch:{game:vW(xW,this),label:"level"}}),vW(RW,this).call(this,!0),vW(GW,this).call(this);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"spineLevel",get:function(){return this.entityManager.spineLevelComponent}},{key:"getMaxItems",value:function(){var t=this.entityManager.spineLevelComponent,e=this.config.hogItemsBone,n=t.skeleton.findBone(e);return n.skeleton.slots.filter(function(t){return t.bone===n}).filter(function(t){var e;return null===(e=t.attachment)||void 0===e?void 0:e.name}).length}}]);function VW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(VW=function(){return!!t})()}function YW(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function $W(t,e){return t.get(KW(t,e))}function qW(t,e,n){return t.set(KW(t,e),n),n}function KW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ZW=new WeakMap,QW=new WeakMap,JW=new WeakMap,tU=new WeakMap,eU=new WeakMap,nU=function(t){function e(t){var n;return g(this,e),n=function(t,e,n){return e=b(e),_(t,VW()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e,[t]),YW(n,ZW,null),YW(n,QW,null),YW(n,JW,null),YW(n,tU,null),YW(n,eU,null),S(n,"restart",Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,null===(e=n.level)||void 0===e?void 0:e.exit();case 1:n.terminate(),$W(ZW,n).emit(cl);case 2:case"end":return t.stop()}},t)}))),S(n,"runNextLevel",Kl(Jl().mark(function t(){var e;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null===(e=n.level)||void 0===e||e.exit(),n.terminate(),$W(ZW,n).emit(hl);case 1:case"end":return t.stop()}},t)}))),S(n,"checkoutState",function(){var t=Kl(Jl().mark(function t(e){var r;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,null===(r=n.level)||void 0===r?void 0:r.exit();case 1:n.terminate(),$W(ZW,n).emit(e);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),qW(ZW,n,t),qW(eU,n,$W(ZW,n).ui),n}return T(e,t),w(e,[{key:"initEventName",get:function(){return cl}},{key:"initialize",value:function(){!function(t,e,n){var r=Zl(b(t.prototype),"initialize",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]),qW(QW,this,new oC($W(ZW,this))),$W(QW,this).addChild($W(eU,this)),$W(ZW,this).viewport.addChild($W(QW,this)),$W(ZW,this).view=$W(QW,this),$W(ZW,this).refs=$W(QW,this).refs,qW(JW,this,$W(QW,this).refs),this.game.stateName=this.initEventName,this.game.stateEntity=this,this.isInitialized=!0,this.game.resize=this.resize.bind(this),this.start()}},{key:"start",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.level=new XW(this),this.level.init(),t.next=1,this.resize();case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"resize",value:function(){var t=Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Vy(this.game,$y),t.next=1,$W(QW,this).resize();case 1:$W(ZW,this).emit(Lg,!0);case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"terminate",value:function(){$W(ZW,this).off(Lg,!0),Ff.killTweensOf("*"),Ff.globalTimeline.clear(),this.isInitialized=!1,$W(JW,this).camera&&$W(JW,this).camera.destroy({children:!0}),this.game.viewport.addChild($W(eU,this)),this.game.uiInner.removeChildren(),$W(QW,this).destroy({children:!0}),qW(QW,this,null),qW(tU,this,null),Gf.soundManager.stopAll()}}])}(jc);function rU(t,e){return t.get(iU(t,e))}function iU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sU=new WeakMap,oU=w(function t(e){var n=this;g(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,void 0)}(this,sU),S(this,"toggleMusic",function(){rU(sU,n).playerData.option_isPlayMusic=!rU(sU,n).playerData.option_isPlayMusic,rU(sU,n).save()}),S(this,"toggleSFX",function(){rU(sU,n).playerData.option_isPlaySFX=!rU(sU,n).playerData.option_isPlaySFX,rU(sU,n).save()}),S(this,"toggleLightMode",function(){rU(sU,n).playerData.option_isLight=!rU(sU,n).playerData.option_isLight,rU(sU,n).save()}),S(this,"toggleDebug",function(){rU(sU,n).playerData.option_isDebug=!rU(sU,n).playerData.option_isDebug,rU(sU,n).save()}),function(t,e,n){t.set(iU(t,e),n)}(sU,this,e)});function aU(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function lU(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?aU(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aU(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function cU(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function hU(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}r(2712),r(739),r(3110),r(8872);var uU=new WeakMap,dU=new WeakMap,pU=new WeakMap,fU=new WeakMap,mU=new WeakMap,gU=new WeakMap,vU=new WeakMap,yU=w(function t(){var e=this;g(this,t),S(this,"getData",function(t){!function(t){var e=Object.keys(mg),n=Object.keys(t),r=!0;e.forEach(function(t){n.includes(t)||(r=!1,console.error("[FlatData]  Required field is missing in serverData: ".concat(t)))}),n.forEach(function(t){e.includes(t)||(r=!1,console.error("[FlatData]  Unknown or extra field found in serverData: ".concat(t)))}),r&&console.log("[FlatData]  ServerData structure is valid, all keys are present")}(t);var n={};return hU(uU,e).call(e,n,t),hU(dU,e).call(e,n,t),hU(pU,e).call(e,n,t),hU(mU,e).call(e,n,t),hU(fU,e).call(e,n,t),n.version="version"in t?t.version:hg,"savedAt"in t&&t.savedAt&&(n.savedAt=t.savedAt),n.playerId=gg.getPlayerId(),hU(vU,e).call(e,n),lU(lU({},mg),n)}),cU(this,uU,function(t,e){"version"in e&&(t.version=e.version),"userLevel"in e&&(t.userLevel=e.userLevel),"hints"in e&&(t.hints=e.hints),"hasAdPass"in e&&(t.hasAdPass=e.hasAdPass)}),cU(this,dU,function(t,n){n.options&&(t.option_isPlayMusic=hU(gU,e).call(e,n.options,"isPlayMusic"),t.option_isPlaySFX=hU(gU,e).call(e,n.options,"isPlaySfx"),t.option_isLight=hU(gU,e).call(e,n.options,"isLight"),t.option_isDebug=hU(gU,e).call(e,n.options,"isDebug")),"isPlayMusic"in n&&(t.option_isPlayMusic=n.isPlayMusic),"isPlaySfx"in n&&(t.option_isPlaySFX=n.isPlaySfx),"isLight"in n&&(t.option_isLight=n.isLight),"isDebug"in n&&(t.option_isDebug=n.isDebug),"option_isPlayMusic"in n&&(t.option_isPlayMusic=n.option_isPlayMusic),"option_isPlaySFX"in n&&(t.option_isPlaySFX=n.option_isPlaySFX),"option_isLight"in n&&(t.option_isLight=n.option_isLight),"option_isDebug"in n&&(t.option_isDebug=n.option_isDebug)}),cU(this,pU,function(t,n){if(n.savedLevel){var r=n.savedLevel;if("string"==typeof r)try{r=JSON.parse(r)}catch(t){console.error("[FlatData] savedLevel parse error:",t,n.savedLevel),r={}}"object"===v(r)&&null!==r&&(t.levelIndex=hU(gU,e).call(e,r,"levelIndex"),t.skinIndex=hU(gU,e).call(e,r,"skinIndex"),t.partIndex=hU(gU,e).call(e,r,"partIndex"))}"levelIndex"in n&&(t.levelIndex=n.levelIndex),"skinIndex"in n&&(t.skinIndex=n.skinIndex),"partIndex"in n&&(t.partIndex=n.partIndex),"savedLevel_levelIndex"in n&&(t.levelIndex=n.savedLevel_levelIndex),"savedLevel_skinIndex"in n&&(t.skinIndex=n.savedLevel_skinIndex),"savedLevel_partIndex"in n&&(t.partIndex=n.savedLevel_partIndex),n.config&&(t.partIndex=n.config.partIndex)}),cU(this,fU,function(t,e){if(e.timers)return"btnFree"in e.timers&&(t.timer_StoreBtnReward=e.timers.btnFree),void("btnHint"in e.timers&&(t.timer_NoHintsPupUpBtnReward=e.timers.btnHint));"btnFree"in e&&(t.timer_StoreBtnReward=e.btnFree),"btnHint"in e&&(t.timer_NoHintsPupUpBtnReward=e.btnHint),"timer_StoreBtnReward"in e&&(t.timer_StoreBtnReward=e.timer_StoreBtnReward),"timer_NoHintsPupUpBtnReward"in e&&(t.timer_NoHintsPupUpBtnReward=e.timer_NoHintsPupUpBtnReward)}),cU(this,mU,function(t,e){var n;return e.isTutorialCompleted?("generator"in e.isTutorialCompleted&&(t.isTutorial_generator=e.isTutorialCompleted.generator),"shadows"in e.isTutorialCompleted&&(t.isTutorial_shadows=e.isTutorialCompleted.shadows),void("words"in e.isTutorialCompleted&&(t.isTutorial_words=e.isTutorialCompleted.words))):null!==(n=e.config)&&void 0!==n&&n.isTutorialCompleted?("generator"in e.config.isTutorialCompleted&&(t.isTutorial_generator=e.config.isTutorialCompleted.generator),"shadows"in e.config.isTutorialCompleted&&(t.isTutorial_shadows=e.config.isTutorialCompleted.shadows),void("words"in e.config.isTutorialCompleted&&(t.isTutorial_words=e.config.isTutorialCompleted.words))):("isTutorial_generator"in e&&(t.isTutorial_generator=e.isTutorial_generator),"isTutorial_shadows"in e&&(t.isTutorial_shadows=e.isTutorial_shadows),void("isTutorial_words"in e&&(t.isTutorial_words=e.isTutorial_words)))}),cU(this,gU,function(t,e){return null!==t&&"object"===v(t)&&e in t?t[e]:void 0}),cU(this,vU,function(t){for(var e in mg)e in t&&void 0!==t[e]||(t[e]=mg[e])})});function xU(t,e,n){wU(t,e),e.set(t,n)}function wU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _U(t,e){return t.get(AU(t,e))}function bU(t,e,n){return t.set(AU(t,e),n),n}function AU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var TU=new WeakMap,SU=new WeakMap,EU=new WeakMap,kU=new WeakMap,MU=new WeakMap,CU=new WeakSet,PU=new WeakMap,IU=new WeakMap,RU=new WeakMap,OU=function(){return w(function t(e){var n=this;g(this,t),function(t,e){wU(t,e),e.add(t)}(this,CU),xU(this,TU,void 0),xU(this,SU,void 0),xU(this,EU,"playerData"),xU(this,kU,"dra.detective"),xU(this,MU,void 0),xU(this,PU,Kl(Jl().mark(function t(){var e,r,i,s,o;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Ol.log(Cl.STORAGE," ".concat(e,"  "),JSON.parse(t)),JSON.parse(t)},t.prev=1,t.next=2,gg.getLocalStorage();case 2:if(!(r=t.sent)){t.next=5;break}if(!(i=r[_U(kU,n)])){t.next=3;break}return t.abrupt("return",e(i,"new server 777"));case 3:if(!(i=r(_U(EU,n)))){t.next=4;break}return t.abrupt("return",e(i,"new server"));case 4:return t.abrupt("return");case 5:if(!(s=localStorage.getItem(_U(kU,n)))){t.next=6;break}return t.abrupt("return",e(s,"new"));case 6:if(!(s=localStorage.getItem(_U(EU,n)))){t.next=7;break}return t.abrupt("return",e(s,"new"));case 7:t.next=9;break;case 8:t.prev=8,o=t.catch(1),console.error("   localStorage (load)",o);case 9:case"end":return t.stop()}},t,null,[[1,8]])}))),xU(this,IU,function(){try{localStorage.setItem(_U(kU,n),JSON.stringify(_U(SU,n)))}catch(t){console.error(Cl.STORAGE,"   localStorage (save)",t)}}),xU(this,RU,function(t){var e=_U(TU,n).getData(t);bU(SU,n,e),_U(MU,n).playerData=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GameData";return new Proxy(t,{get:function(t,n){return n in t||console.error("[".concat(e,"]  Access to unknown key: ").concat(String(n))),t[n]},set:function(t,n,r){return n in t||console.warn("[".concat(e,"]  Setting unknown key: ").concat(String(n))),t[n]=r,!0}})}(e,"PlayerProfile"),Ol.log(Cl.STORAGE,"ProxyData",e)}),bU(MU,this,e),bU(TU,this,new yU)},[{key:"load",value:(t=Kl(Jl().mark(function t(){var e,n,r,i,s,o=this;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!_g.isCrazyGames||gg.player.isAuth()){t.next=1;break}return _U(RU,this).call(this,mg),t.abrupt("return");case 1:return t.next=2,gg.getStorage();case 2:return e=t.sent,t.next=3,_U(PU,this).call(this);case 3:if(n=t.sent,r=Array.isArray(e)?e:e?[e]:[],n&&r.push(n),0!==r.length){t.next=4;break}return Ol.warn(Cl.STORAGE,"      localStorage,  defaultData"),_U(RU,this).call(this,mg),t.abrupt("return");case 4:i=r.map(function(t){return _U(TU,o).getData(t)}),s=AU(CU,this,DU).call(this,i),_U(RU,this).call(this,s);case 5:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"save",value:function(t){!_g.isCrazyGames||gg.player.isAuth()?(_U(SU,this).savedAt=(new Date).toISOString(),_U(IU,this).call(this),gg.adapter.storage.set(_U(SU,this),t).catch(function(t){console.error("[save]",t)})):console.error("save cancel")}}]);var t}();function DU(t){var e=t.filter(function(t){if(!t.savedAt)return!1;var e=new Date(t.savedAt).getTime();return!isNaN(e)});return e.length>0?AU(CU,this,LU).call(this,e):t.length>0?AU(CU,this,FU).call(this,t):mg}function LU(t){return t.reduce(function(t,e){var n=new Date(t.savedAt).getTime(),r=new Date(e.savedAt).getTime();return r>n?e:r<n?t:(e.userLevel||0)>(t.userLevel||0)?e:(e.userLevel||0)<(t.userLevel||0)?t:(e.version||0)>(t.version||0)?e:t})}function FU(t){return t.reduce(function(t,e){return(e.version||0)>(t.version||0)?e:(e.version||0)<(t.version||0)?t:(e.userLevel||0)>(t.userLevel||0)?e:t},t[0])}function BU(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function NU(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function WU(t,e){return t.get(UU(t,e))}function UU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jU=new WeakMap,HU=new WeakMap,zU=new WeakMap,GU=new WeakMap,XU=w(function t(e){var n=this;return g(this,t),NU(this,jU,new OU(this)),S(this,"gameSettings",new oU(this)),NU(this,HU,void 0),S(this,"playerData",void 0),S(this,"addHints",function(){var t=Kl(Jl().mark(function t(e){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(Gm.isNumber(e)){t.next=1;break}return console.error("    hint:",e),t.abrupt("return");case 1:n.playerData.hints+=e,WU(HU,n).emit(ev,n.playerData.hints),n.save(!0);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),S(this,"spendHints",function(){n.playerData.hints-=1,WU(HU,n).emit(ev,n.playerData.hints),n.save()}),S(this,"save",function(t){WU(jU,n).save(t)}),S(this,"load",Kl(Jl().mark(function t(){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,WU(jU,n).load();case 1:case"end":return t.stop()}},t)}))),S(this,"resetAllData",function(){localStorage.clear(),n.playerData=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?BU(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BU(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},mg),gg.leaderboard.setScore(n.playerData.userLevel).catch(function(t){console.log("[leaderboard.setScore]",t)}),n.save(),Gf.game.app.stage.visible=!1,setTimeout(function(){return location.reload()},1e3)}),NU(this,zU,function(){n.playerData.userLevel+=1,gg.leaderboard.setScore(n.playerData.userLevel).catch(function(t){console.log("[leaderboard.setScore]",t)})}),NU(this,GU,function(){WU(HU,n).on(nv,WU(zU,n)),WU(HU,n).on(Wg,n.spendHints)}),"object"===v(t.instance)||(function(t,e,n){t.set(UU(t,e),n)}(HU,this,e),WU(GU,this).call(this),t.instance=this),t.instance},[{key:"userLevel",get:function(){return this.playerData.userLevel}},{key:"levelIndex",get:function(){return this.playerData.levelIndex}},{key:"hints",get:function(){return this.playerData.hints}}]);function VU(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var YU=new WeakMap,$U=w(function t(){var e=this;return g(this,t),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,YU,ml.remote),S(this,"localesHud",void 0),S(this,"storyText",void 0),S(this,"levels",void 0),S(this,"locales",void 0),S(this,"loadLevelsJson",Kl(Jl().mark(function t(){var n;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(VU(YU,e),"assets/gameConfig/levels.json"),t.next=1,by.loadJson(n);case 1:e.levels=t.sent;case 2:case"end":return t.stop()}},t)}))),S(this,"loadLocalesJson",Kl(Jl().mark(function t(){var n;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(VU(YU,e),"assets/gameConfig/locales/locales.json"),t.next=1,by.loadJson(n);case 1:e.locales=t.sent;case 2:case"end":return t.stop()}},t)}))),S(this,"loadLocalesHud",Kl(Jl().mark(function t(){var n;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(VU(YU,e),"assets/gameConfig/locales/localesHud.json"),t.next=1,by.loadJson(n);case 1:e.localesHud=t.sent;case 2:case"end":return t.stop()}},t)}))),S(this,"loadStoryTexts",Kl(Jl().mark(function t(){var n,r;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Gf.game.locale,r="".concat(VU(YU,e),"assets/gameConfig/locales/storyTexts_").concat(n,".json"),t.next=1,by.loadJson(r);case 1:e.storyText=t.sent;case 2:case"end":return t.stop()}},t)}))),"object"===v(t.instance)?t.instance:t.instance=this});function qU(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function KU(t,e){return t.get(ZU(t,e))}function ZU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var QU=new WeakMap,JU=new WeakMap,tj=new WeakMap,ej=w(function t(e){var n=this;return g(this,t),qU(this,QU,void 0),S(this,"consumePendingPayments",Kl(Jl().mark(function t(){var e,r,i,s;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,gg.sdk.purchase;case 1:return e=t.sent,t.next=2,e.getPurchases();case 2:return r=t.sent,t.next=3,e.getCatalog();case 3:i=t.sent,r.forEach(function(t){var e=t.productID,r=t.purchaseToken;i[e]&&(console.log("%c   :%c\n productID: ".concat(e,",\n ").concat(r),"color: tomato; font-weight: bold;","color: inherit;"),n.consumePurchase(e,r))}),t.next=5;break;case 4:t.prev=4,s=t.catch(0),console.error("[consumePendingPayments]",s);case 5:case"end":return t.stop()}},t,null,[[0,4]])}))),S(this,"onPurchase",function(t){Ol.log("","[onPurchase]: ".concat(t)),Gf.soundManager.mute(),gg.purchase.buy(t).then(function(){var e=Kl(Jl().mark(function e(r){var i;return Jl().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=r.purchaseToken,n.consumePurchase(t,i);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(_g.showError).finally(function(){Gf.soundManager.unmute(),Gf.soundManager.visibilityStateHandler()})}),S(this,"consumePurchase",function(){var t=Kl(Jl().mark(function t(e,r){return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:Ol.log("","[consumePurchase]: ".concat(e)),gg.purchase.consumePurchase(r).then(function(){n.giveReward(e),Gf.soundManager.unmute(),Gf.soundManager.visibilityStateHandler(),Gf.soundManager.play("sfx_store")}).catch(function(t){return console.log("[consumePurchase]",t)}),ag.purchase(e);case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),S(this,"giveReward",function(t){Ol.log("","giveReward",t);var e=yx.store,r=yx.promo;KU(JU,n).call(n,e,t),KU(tj,n).call(n,r,t)}),qU(this,JU,function(t,e){var r=yx.store[e];if(!r)return!1;var i=Gf.storage;e===t.noAdPack.id&&(Ol.log("","grants ad-free access"),i.playerData.hasAdPass=t[e].hasAdPass,i.save(!0),KU(QU,n).emit(Yg,e)),r.hints&&(Ol.log("","grants hints",e,"-",r.hints),i.addHints(r.hints))}),qU(this,tj,function(t,e){var r=Gf.storage;console.log("catalog",t),console.log("promoPacks",e),cB.promoPacksId.includes(e)&&(e===t.promoStartedPack.id&&(r.playerData.hasAdPass=!0,r.addHints(30),Ol.log("","Disabled Ads and received 30 hints"),KU(QU,n).emit(Yg,e)),e===t.promoRemoveAdPack.id&&(r.playerData.hasAdPass=!0,r.save(!0),console.warn("Ads disabled with discount"),KU(QU,n).emit(Yg,e)),e===t.promoMegaHintsPack.id&&(r.addHints(50),console.warn("Grants 50 hints at a discount")))}),"object"===v(t.instance)?t.instance:(function(t,e,n){t.set(ZU(t,e),n)}(QU,this,e),t.instance=this)}),nj=r(4196),rj=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.count,n=t.path,r=t.alias;return Array.from({length:e},function(t,e){var i="".concat(r).concat(e);return{alias:i,src:"".concat(n).concat(i,".mp3")}})};function ij(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function sj(t,e){return t.get(aj(t,e))}function oj(t,e,n){return t.set(aj(t,e),n),n}function aj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lj=new WeakMap,cj=new WeakMap,hj=new WeakMap,uj=new WeakMap,dj=new WeakMap,pj=w(function t(e,n){var r=this;g(this,t),ij(this,lj,void 0),ij(this,cj,void 0),ij(this,hj,void 0),S(this,"unmute",void 0),S(this,"init",function(){sj(uj,r).call(r),sj(dj,r).call(r)}),S(this,"visibilityStateHandler",function(){"visible"===document.visibilityState||"visible"===document.webkitVisibilityState?(r.unmute(),gg.gameplayStart()):(gg.gamePlayStop(),sj(hj,r).call(r))}),ij(this,uj,function(){document.addEventListener("visibilitychange",r.visibilityStateHandler),window.addEventListener("blur",sj(hj,r)),window.addEventListener("focus",r.unmute),window.addEventListener("ad-event-pause",sj(hj,r)),window.addEventListener("ad-event-resume",r.unmute),window.addEventListener("pagehide",sj(hj,r)),window.addEventListener("pageshow",r.unmute),navigator.userAgent.match(/iPhone|iPad|iPod/i)&&document.addEventListener("webkitvisibilitychange",r.visibilityStateHandler)}),ij(this,dj,function(){sj(lj,r).on(Zg,sj(cj,r).muteMusic),sj(lj,r).on(Qg,sj(cj,r).unmuteMusic),sj(lj,r).on(qg,sj(cj,r).muteSFX),sj(lj,r).on(Kg,sj(cj,r).unmuteSFX)}),oj(lj,this,e),oj(cj,this,n),oj(hj,this,n.mute),this.unmute=n.unmute});function fj(t,e,n){mj(t,e),e.set(t,n)}function mj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gj(t,e){return t.get(yj(t,e))}function vj(t,e,n){return t.set(yj(t,e),n),n}function yj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xj=new WeakMap,wj=new WeakMap,_j=new WeakMap,bj=new WeakMap,Aj=new WeakMap,Tj=new WeakSet,Sj=new WeakMap,Ej=new WeakMap,kj=w(function t(e){var n=this;g(this,t),function(t,e){mj(t,e),e.add(t)}(this,Tj),fj(this,xj,void 0),fj(this,wj,void 0),fj(this,_j,void 0),fj(this,bj,!1),fj(this,Aj,function(t){var e=t?"on":"off";gj(xj,n)[e]("checkoutState",gj(Ej,n)),gj(xj,n)[e](Dg,gj(Sj,n))}),fj(this,Sj,function(){vj(bj,n,!0),gj(Ej,n).call(n),gj(xj,n).on(Qg,gj(Ej,n))}),fj(this,Ej,function(){if(gj(bj,n)){var t=gj(xj,n).currentStateName;Ol.log(Cl.SOUND_MANAGER,"[MusicManager state]: ".concat(t));var e=S(S({},ll,{nameStart:"m_start-screen",nameEnd:"m_ost"}),cl,{nameStart:"m_ost",nameEnd:"m_start-screen"})[t];if(e)try{if(gj(_j,n).stop(e.nameEnd),gj(_j,n).isPlaying(e.nameStart))return;var r=gj(_j,n).musicList[e.nameStart];"loaded"===r.state()?gj(_j,n).play(e.nameStart,{loop:!0}):r.on("load",function(){return gj(_j,n).play(e.nameStart,{loop:!0})})}catch(t){console.log("MusicManager play",t)}}}),vj(xj,this,Gf.game),vj(_j,this,e)},[{key:"init",value:function(){vj(wj,this,Gf.storage),gj(Aj,this).call(this,!0),yj(Tj,this,Mj).call(this)}}]);function Mj(){return Cj.apply(this,arguments)}function Cj(){return Cj=Kl(Jl().mark(function t(){var e,n,r;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=gj(_j,this).preloadAudioList,n=e.START_MUSIC,r=e.LEVEL_MUSIC,t.next=1,gj(_j,this).preload(gj(_j,this).musicList,n);case 1:return Ol.log(Cl.SOUND_MANAGER,"[START_MUSIC] loaded"),t.next=2,gj(_j,this).preload(gj(_j,this).musicList,r);case 2:Ol.log(Cl.SOUND_MANAGER,"[LEVEL_MUSIC] loaded");case 3:case"end":return t.stop()}},t,this)})),Cj.apply(this,arguments)}function Pj(t,e,n){Ij(t,e),e.set(t,n)}function Ij(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rj(t,e){return t.get(Dj(t,e))}function Oj(t,e,n){return t.set(Dj(t,e),n),n}function Dj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lj=function(){nj.Howler.mute("visible"!==document.visibilityState)};document.addEventListener("visibilitychange",function(){Lj()}),Lj();var Fj=new WeakMap,Bj=new WeakMap,Nj=new WeakMap,Wj=new WeakMap,Uj=new WeakSet,jj=new WeakMap,Hj=w(function t(e){var n=this;return g(this,t),function(t,e){Ij(t,e),e.add(t)}(this,Uj),Pj(this,Fj,void 0),Pj(this,Bj,void 0),S(this,"musicList",[]),S(this,"sfxList",[]),S(this,"speechList",[]),S(this,"isInit",!1),S(this,"visibilityStateHandler",void 0),S(this,"isGlobalPaused",!1),S(this,"preloadAudioList",void 0),Pj(this,Nj,void 0),S(this,"init",function(){var t,e;n.preloadAudioList=(t=ml.remote,e=Gf.game.locale,{START_MUSIC:[{alias:"m_start-screen",src:"".concat(t,"assets/audio/music/m_start-screen.mp3")},{alias:"silence",src:"".concat(t,"assets/audio/silence.mp3")}],LEVEL_MUSIC:[{alias:"m_ost",src:"".concat(t,"assets/audio/music/m_ost.mp3")},{alias:"m_victory",src:"".concat(t,"assets/audio/music/m_victory.mp3")}],CLICK_ITEMS_SPEECH:Gc(rj({count:60,path:"".concat(t,"assets/audio/sfx/click-item/speech/").concat(e,"/"),alias:"sfx_".concat(e,"_clickItem")})),PARTS_SPEECH:[],CLICK_ITEMS:Gc(rj({count:10,path:"".concat(t,"assets/audio/sfx/click-item/"),alias:"sfx_click"})),SFX:[{alias:"sfx_btnClick",src:"".concat(t,"assets/audio/sfx/sfx_btnClick.mp3")},{alias:"sfx_hintFlash",src:"".concat(t,"assets/audio/sfx/sfx_hintFlash.mp3")},{alias:"sfx_hintModal",src:"".concat(t,"assets/audio/sfx/sfx_hintModal.mp3")},{alias:"sfx_missClick",src:"".concat(t,"assets/audio/sfx/sfx_missClick.mp3")},{alias:"sfx_store",src:"".concat(t,"assets/audio/sfx/sfx_store.mp3")},{alias:"sfx_victory",src:"".concat(t,"assets/audio/sfx/sfx_victory.mp3")}]}),Oj(Bj,n,new pj(Rj(Fj,n),n)),Oj(Nj,n,new kj(n)),n.visibilityStateHandler=Rj(Bj,n).visibilityStateHandler,document.addEventListener("click",n.firstInit,{once:!0})}),S(this,"firstInit",function(){n.isInit||Rj(Wj,n).call(n)}),S(this,"playRandomSpeech",function(){var t=Kl(Jl().mark(function t(e){var r,i,s,o,a;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.maxCount,i=e.nameTemplate,s=Rj(Fj,n).locale,o=Gm.getRandomNumber(0,r,0),a=i.replace("{locale}",s).replace("{i}",o),t.next=1,n.play(a);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),Pj(this,Wj,function(){try{!function(t){var e=new Audio;function n(){e.volume=0,e.loop=!0,e.pause();var t=e.play();t&&"function"==typeof t.catch&&t.catch(function(t){console.error(t)})}e.src=t,document.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&n()}),document.addEventListener("touchstart",n)}("".concat(ml.remote,"assets/audio/silence.mp3"))}catch(t){console.log("initAction",t)}finally{n.isInit=!0,Rj(Bj,n).init(),Rj(Nj,n).init(),Rj(Fj,n).emit(Dg),Ol.log(Cl.SOUND_MANAGER,"catch first click")}}),S(this,"loadAndPlayAmbient",function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.loop,s=void 0===i||i,o=r.volume,a=void 0===o?1:o;if(n.sfxList[t])Dj(Uj,n,Gj).call(n,n.sfxList[t],{loop:s,volume:a});else{var l=new nj.Howl({src:[e],loop:s,volume:a,preload:!0});n.sfxList[t]=l,l.once("load",function(){Dj(Uj,n,Gj).call(n,l,{loop:s,volume:a})}),l.once("loaderror",function(e,n){Ol.warn(Cl.SOUND_MANAGER,"[loadAndPlayAmbient] Load error: ".concat(t),n)})}}),S(this,"clearSoundList",function(t){Object.entries(t).forEach(function(e){var n,r=lv(e,2),i=r[0],s=r[1];null==s||null===(n=s.unload)||void 0===n||n.call(s),delete t[i]}),t.length=0}),S(this,"preload",function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,s=e.map(function(e){return new Promise(function(s){try{if(t[e.alias])return void s();var o=Array.isArray(e.src)?e.src:[e.src],a=new nj.Howl({src:o,preload:r});t[e.alias]=a,a.once("load",function(){try{i&&i(),Ol.log(Cl.SOUND_MANAGER,"sound is loaded:  ".concat(e.alias)),s()}catch(e){var t;ag.preloadError(null==og||null===(t=og.SOUND_PRELOAD)||void 0===t?void 0:t.loading,e),s()}}),a.once("loaderror",function(o,a){if("m_start-screen"===e.alias){var l="".concat("","assets/audio/music/m_start-screen.mp3"),c=new nj.Howl({src:[l],preload:r});return c.once("load",function(){t[e.alias]=c,Ol.log(Cl.SOUND_MANAGER,"sound is loaded from fallback: ".concat(e.alias)),i&&i(),Rj(Fj,n).emit(Dg),s()}),void c.once("loaderror",function(t,n){console.warn("[fallback] Failed to load backup for ".concat(e.alias,":"),n),ag.soundLoadErr(e,n),s()})}ag.soundLoadErr(e,a),s()})}catch(t){var l;console.error("[preload] Error during sound setup",t),ag.preloadError(null==og||null===(l=og.SOUND_PRELOAD)||void 0===l?void 0:l.loading,t),s()}})});return Promise.all(s).catch(function(t){console.error("[preload] Error in Promise.all",t)})}),S(this,"preloadSFXFMain",Kl(Jl().mark(function t(){var e,r;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=n.preloadAudioList.SFX,t.next=1,n.preload(n.sfxList,e,!0);case 1:Ol.log(Cl.SOUND_MANAGER,"soundManager loaded: sfx"),t.next=3;break;case 2:t.prev=2,r=t.catch(0),Ol.warn("","[SoundManager firstLoadAndInit error]: ".concat(r));case 3:case"end":return t.stop()}},t,null,[[0,2]])}))),S(this,"preloadSFXFLevel",Kl(Jl().mark(function t(){var e,r,i,s,o,a,l;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=n.preloadAudioList,r=e.CLICK_ITEMS_SPEECH,i=e.CLICK_ITEMS,s=e.PARTS_SPEECH,o=performance.now(),t.next=1,n.preload(n.sfxList,r,!0);case 1:return t.next=2,n.preload(n.sfxList,i,!0);case 2:return t.next=3,n.preload(n.sfxList,s,!0);case 3:a=performance.now(),console.log("  SFX: ".concat(((a-o)/1e3).toFixed(2)," ")),Ol.log(Cl.SOUND_MANAGER,"----------- soundManager loaded: sfx"),t.next=5;break;case 4:t.prev=4,l=t.catch(0),Ol.warn("","[SoundManager firstLoadAndInit error]: ".concat(l));case 5:case"end":return t.stop()}},t,null,[[0,4]])}))),Pj(this,jj,function(t,e){t.forEach(function(t){Object.values(t).forEach(function(t){return t.mute(e)})})}),S(this,"muteSFX",function(){Rj(jj,n).call(n,[n.sfxList,n.speechList],!0)}),S(this,"unmuteSFX",function(){Rj(jj,n).call(n,[n.sfxList,n.speechList],!1)}),S(this,"muteMusic",function(){Rj(jj,n).call(n,[n.musicList],!0)}),S(this,"unmuteMusic",function(){Rj(jj,n).call(n,[n.musicList],!1)}),S(this,"mute",function(){nj.Howler.mute(!0)}),S(this,"unmute",Kl(Jl().mark(function t(){var e,r;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("suspended"!==(e=nj.Howler.ctx).state&&"interrupted"!==e.state){t.next=4;break}return t.prev=1,t.next=2,e.resume();case 2:n.unmute(),t.next=4;break;case 3:t.prev=3,r=t.catch(1),console.warn("Failed to resume AudioContext",r);case 4:nj.Howler.mute(!1);case 5:case"end":return t.stop()}},t,null,[[1,3]])}))),"object"===v(t.instance)||(Oj(Fj,this,e),t.instance=this),t.instance},[{key:"play",value:function(){var t=Kl(Jl().mark(function t(e){var n,r,i,s,o,a,l,c=arguments;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(n=c.length>1&&void 0!==c[1]?c[1]:{}).loop,i=void 0!==r&&r,s=n.volume,o=void 0===s?1:s,t.prev=1,this.isInit&&!this.isGlobalPaused){t.next=2;break}return t.abrupt("return",Promise.resolve(!1));case 2:if(!(a=Dj(Uj,this,zj).call(this,e))){t.next=3;break}return this.musicList[e]?Dj(Uj,this,Gj).call(this,a,{loop:i,volume:o,isMusic:!0}):this.sfxList[e]?Dj(Uj,this,Gj).call(this,a,{loop:i,volume:o}):this.speechList[e]&&Dj(Uj,this,Gj).call(this,a,{loop:i,volume:o,isSpeech:!0}),t.abrupt("return",new Promise(function(t){a.once("end",t)}));case 3:return console.warn("No found sound",e),t.abrupt("return",Promise.resolve());case 4:t.next=6;break;case 5:t.prev=5,l=t.catch(1),console.warn("[play]",l);case 6:case"end":return t.stop()}},t,this,[[1,5]])}));return function(e){return t.apply(this,arguments)}}()},{key:"pauseAll",value:function(){this.isGlobalPaused=!0,[this.musicList,this.sfxList,this.speechList].forEach(function(t){Object.values(t).forEach(function(t){t.playing()&&(t.pause(),t.isPaused=!0)})})}},{key:"unPauseAll",value:function(){this.isGlobalPaused=!1,[this.musicList,this.sfxList,this.speechList].forEach(function(t){Object.values(t).forEach(function(t){(function(t){return t.isPaused&&"loaded"===t.state()})(t)&&(t.play(),t.isPaused=!1)})})}},{key:"stop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Dj(Uj,this,zj).call(this,t);n&&n.playing()&&(n.fade(n.volume(),0,e),setTimeout(function(){return n.stop()},e))}},{key:"stopAll",value:function(){[this.musicList,this.sfxList,this.speechList].forEach(function(t){Object.values(t).forEach(function(t){t.playing()&&t.stop()})})}},{key:"isPlaying",value:function(t){var e=Dj(Uj,this,zj).call(this,t);return!!e&&e.playing()}}]);function zj(t){return this.musicList[t]||this.sfxList[t]||this.speechList[t]}function Gj(t,e){var n=e.loop,r=void 0!==n&&n,i=e.volume,s=void 0===i?1:i,o=e.isMusic,a=void 0!==o&&o;if(e.isSpeech,!this.isGlobalPaused){var l=Gf.storage.playerData;a&&Object.values(this.musicList).forEach(function(e){e!==t&&e.playing()&&e.stop()}),t.loop(r),t.volume(s),t.play(),a&&!l.option_isPlayMusic?t.mute(!0):a||l.option_isPlaySFX||t.mute(!0)}}function Xj(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Vj(t,e){return t.get($j(t,e))}function Yj(t,e,n){return t.set($j(t,e),n),n}function $j(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qj=new WeakMap,Kj=new WeakMap,Zj=new WeakMap,Qj=new WeakMap,Jj=w(function t(e){var n=this;g(this,t),Xj(this,qj,void 0),Xj(this,Kj,void 0),Xj(this,Zj,void 0),Xj(this,Qj,void 0),S(this,"show",Kl(Jl().mark(function t(){var e,r,i,s,o=arguments;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.length>0&&void 0!==o[0]?o[0]:[],i=[Vj(Qj,n)].concat(Gc(r)),s=null===(e=Vj(qj,n))||void 0===e||null===(e=e.refs)||void 0===e?void 0:e.fade,t.next=1,Ff.timeline().to(s,{alpha:0}).fromTo([i],{alpha:0},{alpha:1,visible:!0},"<").set(s,{visible:!1});case 1:case"end":return t.stop()}},t)}))),S(this,"hide",Kl(Jl().mark(function t(){var e,r,i,s,o=arguments;return Jl().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.length>0&&void 0!==o[0]?o[0]:[],i=[Vj(Qj,n)].concat(Gc(r)),s=null===(e=Vj(qj,n))||void 0===e||null===(e=e.refs)||void 0===e?void 0:e.fade,t.next=1,Ff.timeline().set(i,{interactive:!1}).to(s,{alpha:.65,visible:!0}).to(i,{alpha:0},"<");case 1:case"end":return t.stop()}},t)}))),Yj(qj,this,e),Yj(Kj,this,e.refs),Yj(Zj,this,e.ui),Yj(Qj,this,e.uiInner)});function tH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(tH=function(){return!!t})()}function eH(t,e,n){nH(t,e),e.set(t,n)}function nH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rH(t,e){return t.get(iH(t,e))}function iH(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sH=new WeakSet,oH=new WeakMap,aH=new WeakMap,lH=function(t){function e(t){var n;return g(this,e),n=function(t,e){return e=b(e),_(t,tH()?Reflect.construct(e,[],b(t).constructor):e.apply(t,void 0))}(this,e),function(t,e){nH(t,e),e.add(t)}(n,sH),S(n,"app",void 0),S(n,"states",[]),S(n,"stateAfterPreload",ll),S(n,"viewport",void 0),S(n,"locale",void 0),S(n,"currentStateName",void 0),eH(n,oH,function(){var t=Math.max(1.5,Math.min(window.devicePixelRatio,2));n.app=new Ki({resizeTo:window,resolution:t,autoDensity:!0,antialias:!0,backgroundAlpha:1,backgroundColor:0}),n.app.view.className="pixi-view",document.body.querySelector("#canvas-wrapper").appendChild(n.app.view),n.viewport=new Ml(n),n.app.stage.addChild(n.viewport)}),eH(n,aH,function(t){Gf.register(Bf,n),Gf.register(Wf,new XU(n)),Gf.register(Nf,t),Gf.register(jf,new $U),Gf.register(Hf,new ej(n)),Gf.register(Uf,new Hj(n)),Gf.register(zf,new Jj(n))}),iH(sH,n,cH).call(n),rH(aH,n).call(n,t),n}return T(e,t),w(e,[{key:"start",value:function(){this.emit(al)}}])}(ut);function cH(){rH(oH,this).call(this),this.states=[new Gy(this),new TT(this),new LM(this),new nU(this)],new $l(this)}console.log("%cBuild: ".concat("2025-07-19 08:25:30","\nVersion: ").concat(hg),"color: #A31E29"),window.createGame=function(t,e){var n=new lH(t);window.game=n,n.start(),e&&(window.__PIXI_DEVTOOLS__={app:n.app});var r=n.app.view;r.addEventListener("pointerup",function(t){return t.preventDefault()}),r.addEventListener("pointermove",function(t){return t.preventDefault()}),r.addEventListener("dblclick",function(t){return t.preventDefault()}),r.addEventListener("contextmenu",function(t){return t.preventDefault()}),r.addEventListener("gesturestart",function(t){return t.preventDefault()}),r.addEventListener("gesturechange",function(t){return t.preventDefault()}),r.addEventListener("gestureend",function(t){return t.preventDefault()})}}()}()}();
