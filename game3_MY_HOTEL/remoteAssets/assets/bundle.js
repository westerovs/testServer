!function(){"use strict";window.localeAssets=[]}();!function(){"use strict";class e{id="ServiceBase";sdk=null;flags={useLevelTypeGeneration:!0,useCounterFlag:!0,useHudShadow:!0,useHudWords:!0,useTimerRewardDuration:60};player=null;payments=null;leaderTableName=null;initLocale="ru";isTestLocalUrl=!1;get id(){return this.id}loadJson=async e=>{try{const r=await fetch(e);return r.ok||console.error(`Ошибка загрузки JSON: ${r.status}`),await r.json()}catch(e){return console.error("Ошибка при загрузке JSON:",e),Promise.resolve(!1)}};sayHello(e=""){console.log(`Service hello: %c${this.id} ${e}`,"color: yellow")}initSdk=()=>Promise.resolve(!1);initMainSdkServices=()=>Promise.resolve(!1);initPlayer=()=>Promise.resolve(!1);loadingAPIisReady=()=>Promise.resolve(!1);checkAuth=()=>Promise.resolve(!1);setData=e=>Promise.resolve(!1);loadData=()=>Promise.resolve(!1);getPlayerData=()=>Promise.resolve(!1);checkPayments=()=>Promise.resolve(!1);getStoreCatalog=()=>Promise.resolve(!1);preloadRewardedAd=()=>Promise.resolve(!1);showFullscreenAdv=(e={})=>Promise.resolve(!1);showRewardedVideo=(e={})=>Promise.resolve(!1);leaderboardData=()=>Promise.resolve(!1);submitRecord=e=>Promise.resolve(!1);canReview=()=>Promise.resolve(!1);serverTime=()=>Date.now();getLocale=()=>Promise.resolve(this.initLocale)}const r=3,a=5,t=15,o=50,n=100,s={free:{id:"free",textInCard:`x${r}`,amount:r,texture:"icon-loupe"},smallPack:{id:"smallPack",textInCard:`x${a}`,amount:a,texture:"icon-loupe"},mediumPack:{id:"mediumPack",textInCard:`x${t}`,amount:t,texture:"icon-loupe"},largePack:{id:"largePack",textInCard:`x${o}`,amount:o,texture:"icon-loupe"},extraLargePack:{id:"extraLargePack",textInCard:`x${n}`,amount:n,texture:"icon-loupe"},noAdPack:{id:"noAdPack",textInCard:"",amount:0,texture:"icon-noAd"}},i={SDK:"SDK",Player:"Player",Metrika:"Metrika",GamePreload:"GamePreload",StateGame:"StateGame",LevelPreload:"LevelPreload",DestroyMessage:"DestroyMessage",Config:"config",SOUND_MANAGER:"SOUND_MANAGER",Hud:"Hud"},l={default:"#00A5FE",sdk:"#28FF5A",player:"#00DEFE",metrika:"#BBFE64",gamePreload:"yellow",lvlPreload:"orange",config:"#FEE000",destroy:"#D764FE",warning:"tomato",error:"red",green:"#08FE00"},c=e=>{const r=Object.keys(l).find((r=>r.toLowerCase()===e.toLowerCase()));return r?l[r]:l.default},d=new Set;d.add(i.Config);class m{static log(e,r,...a){if(d.has(e))console.log(`%c[${e}]`,`color: ${c(e)}`,r,...a);else{if(Object.values(i).includes(e))return;console.log("%c[Logger]",`color: ${c(e)}`,e,r,...a)}}static warn(e,r,...a){if(d.has(e))console.warn(`[${e}]`,r,...a);else{if(Object.values(i).includes(e))return;console.log("%c[Logger]",`color: ${l.warning}`,r,...a)}}static error(e,r,...a){if(d.has(e))console.error(`%c[${e}]`,`color: ${c(e)}`,"❌"+r,...a);else{if(Object.values(i).includes(e))return;console.error("%c[Logger]",`color: ${c(e)}`,e,"❌"+r,...a)}}}const u=99603095,y="GAME_PRELOAD:initialize",h="GAME_PRELOAD:loadPlayerData",g="GAME_PRELOAD:showAd",f="LEVEL_PRELOAD:loading",S="LEVEL_PRELOAD:loadBundle",p="SOUND_PRELOAD:preload";class k{static btnStart=()=>{"function"==typeof ym&&ym(u,"reachGoal","clickBtnStart")};static mainScreenBtnStore=()=>{"function"==typeof ym&&ym(u,"reachGoal","mainScreenBtnStore")};static btnLeaders=()=>{"function"==typeof ym&&ym(u,"reachGoal","clickBtnLeaders")};static userReviewClickOk=()=>{"function"==typeof ym&&ym(u,"reachGoal","userReviewClickOk")};static userReviewClickLater=()=>{"function"==typeof ym&&ym(u,"reachGoal","userReviewClickLater")};static finalScreenBtnNext=()=>{"function"==typeof ym&&ym(u,"reachGoal","finalScreenBtnNext")};static finalScreenBtnHome=()=>{"function"==typeof ym&&ym(u,"reachGoal","finalScreenBtnHome")};static finalScreenBtnDisableAd=()=>{"function"==typeof ym&&ym(u,"reachGoal","finalScreenBtnDisableAd")};static finalScreenBtnStore=()=>{"function"==typeof ym&&ym(u,"reachGoal","finalScreenBtnStore")};static noHintsClickBtnStore=()=>{"function"==typeof ym&&ym(u,"reachGoal","noHintsClickBtnStore")};static noHintsClickBtnReward=()=>{"function"==typeof ym&&ym(u,"reachGoal","noHintsClickBtnReward")};static completeGame=()=>{"function"==typeof ym&&ym(u,"reachGoal","completeGame")};static gameTimeTracker=()=>{"function"==typeof ym&&ym(u,"reachGoal","gameTimeTracker")};static rewardedAdWatched=()=>{"function"==typeof ym&&ym(u,"reachGoal","rewardedAdWatched")};static interstitialWatched=()=>{"function"==typeof ym&&ym(u,"reachGoal","interstitialWatched")};static forceReload=()=>{"function"==typeof ym&&ym(u,"reachGoal","forceReload")};static startLevel=(e,r)=>{if("function"!=typeof ym)return;const{spineName:a,currentSkinName:t}=e,{userLevel:o}=r;ym(u,"params",{startLevel:{spineName:a,currentSkinName:t,userLevel:o}})};static completeLevel=(e,r,a)=>{if("function"!=typeof ym)return;const{spineName:t,currentSkinName:o}=e,{userLevel:n}=r;ym(u,"params",{completeLevel:{spineName:t,currentSkinName:o,userLevel:{[n]:{levelPlayTime:a}}}})};static earlyExit=(e,r,a)=>{if("function"!=typeof ym)return;const{spineName:t,currentSkinName:o}=e,{userLevel:n}=r;ym(u,"params",{earlyExit:{spineName:t,currentSkinName:o,userLevel:{[n]:{levelPlayTime:a}}}})};static useHint=(e,r)=>{if("function"!=typeof ym)return;const{spineName:a,currentSkinName:t}=e;ym(u,"params",{useHint:{spineName:a,currentSkinName:t,spriteName:r.name}})};static hintCounter=(e,r)=>{if("function"!=typeof ym)return;const a=e.userLevel+1,{levelIndex:t,skinIndex:o}=e.savedLevel;ym(u,"params",{hintCounter:{spineName:t,currentSkinName:o,userLevel:{[a]:{counter:r}}}})};static missClickCounter=(e,r)=>{if("function"!=typeof ym)return;const a=e.userLevel+1,{levelIndex:t,skinIndex:o}=e.savedLevel;ym(u,"params",{missClickCounter:{counter:r,userLevel:a,spineName:t,currentSkinName:o}})};static purchase=e=>{"function"==typeof ym&&ym(u,"params",{purchase:{id:e}})};static soundLoadErr=(e,r)=>{"function"==typeof ym&&ym(u,"params",{soundLoadErr:{src:e,err:r}})};static preloadError=(e,r)=>{if("function"==typeof ym)try{const a=r?.message||"Unknown error",t=r?.stack||"No stack available";ym(u,"params",{[`error_${e}`]:{error:{message:a,stack:t}}})}catch(e){console.warn("metrika preloadError",e)}};static testingErrors=()=>{const e=new Error("Это тестовая ошибка");k.preloadError(y,e),k.preloadError(h,e),k.preloadError(g,e),k.preloadError(f,e),k.preloadError(S,e),k.preloadError(p,e)};static loadDuration=e=>{"function"==typeof ym&&ym(u,"params",{gameLoadTime:e})}}window._SERVICE=new class extends e{#e;id="ServiceYandex";leaderTableName="MainLeaders";sdk;player;initSdk=async()=>{try{this.sdk=await YaGames.init(),this.#e=game,await this.#r(),m.log(i.SDK,"init YandexSdk")}catch(e){return console.error("[SDK] Ошибка при инициализации Yandex SDK:",e),Promise.resolve(!1)}};#r=async()=>{if(!this.sdk)return;const e=await(this.sdk?.getFlags());e&&Object.keys(e).length>0?(this.flags=e,console.log("flags server:",this.flags)):(console.error("Ошибка загрузки flags с сервера, используем дефолтные из ServiceBase"),console.group("↓------- flags --------↓"),console.log(this.flags),console.groupEnd())};initMainSdkServices=async()=>{try{await this.#a(),await this.initPlayer(),await this.#t(),m.log(i.SDK,"init initMainSdkServices")}catch(e){return console.error("[SDK] initMainSdkServices Ошибка при инициализации Yandex SDK:",e),Promise.resolve(!1)}};#a=async()=>{try{const e=await this.sdk.getStorage();Object.defineProperty(window,"localStorage",{get:()=>e}),m.log(i.SDK,"init SafeStorage")}catch(e){return console.error("[SDK] Ошибка при настройке безопасного хранилища:",e),Promise.resolve(!1)}};initPlayer=async()=>{try{this.player=await this.sdk.getPlayer(),m.log(i.SDK,"init Player")}catch(e){return console.error("[SDK] Ошибка при инициализации объекта Player:",e),Promise.resolve(!1)}};getPlayer=async()=>{try{return await this.sdk.getPlayer()}catch(e){return console.error("[getPlayer] Ошибка при получении объекта Player:",e),Promise.resolve(!1)}};loadingAPIisReady=()=>{if(this.sdk)try{this.sdk.features.LoadingAPI.ready(),m.log(i.SDK,"LoadingAPI ready")}catch(e){return console.error("[SDK] Ошибка при вызове loadingAPIisReady:",e),Promise.resolve(!1)}else console.error("[SDK] loadingAPIisReady: YSDK не инициализирован")};checkAuth=async()=>{if(this.player)if("lite"===this.player.getMode()){m.log(i.SDK,"check Auth: Игрок не авторизован, открываю диалог авторизации");try{await this.sdk.auth.openAuthDialog(),await this.initPlayer(),m.log(i.SDK,"this.initPlayer")}catch(e){if(!e||"AuthError"!==e.name)return console.error("check Auth: Ошибка при авторизации:",e),Promise.resolve(!1);m.warn("check Auth: Пользователь отменил авторизацию")}}else m.log(i.SDK,"check Auth: Игрок уже авторизован");else console.error("[SDK ] checkAuth: Игрок не инициализирован")};setData=e=>{if(this.player)return this.player.setData(e);console.error("[SDK] setData: Игрок не инициализирован")};loadData=async()=>{if(this.player)return this.player.getData();console.error("[SDK] loadData: Игрок не инициализирован")};getPlayerData=async()=>{const e=(await this.leaderboardData(1)).entries.find((e=>e.player.uniqueID===this.player.getUniqueID()));return{name:this.player.getName(),photo:this.player.getPhoto("small"),getPayingStatus:this.player.getPayingStatus(),uniqueID:this.player.getUniqueID(),rank:e?.rank,score:e?.score}};#t=async()=>{await this.sdk.getPayments({signed:!0}).then((async e=>{this.payments=e,m.log(i.SDK,"Покупки доступны")})).catch((e=>(m.error(i.SDK,"[init payments]",e),Promise.resolve(!1))))};checkPayments=async e=>{const r=(await _SERVICE.getStoreCatalog()).map((e=>e.id)),a=async a=>{for(const t of r)if(a.productID===t){console.warn(`обнаружена неоплаченная покупка: id', ${t}`,a.purchaseToken),await this.payments.consumePurchase(a.purchaseToken),console.log(`Успешно оплачено id:', ${t}`);const r={STARTED_PACK:{id:"promoStartedPack"},REMOVE_AD_PACK:{id:"promoRemoveAdPack"},MEGA_HINTS_PACK:{id:"promoMegaHintsPack"}};if(t===r.STARTED_PACK.id&&(e.hasAdPass=!0,e.addHints(30),console.warn("Отключил рекламу и получил 30 подсказок")),t===r.REMOVE_AD_PACK.id&&(e.hasAdPass=!0,e.saveData(),console.warn("Отключил рекламу со скидкой")),t===r.MEGA_HINTS_PACK.id&&(e.addHints(50),console.warn("50 подсказок со скидкой")),!s[t]?.id)return;t===s.noAdPack.id&&(e.hasAdPass=!0,e.saveData()),t===s[t].id&&(console.log("else начисляем hints",s[t]),await e.addHints(s[t].amount))}};this.payments.getPurchases().then((e=>e.forEach(a)))};getStoreCatalog=async()=>await _SERVICE.payments.getCatalog();showFullscreenAdv=async(e={})=>{try{await this.sdk.adv.showFullscreenAdv({callbacks:{onOpen:()=>{e.onOpen&&(m.log(i.SDK,"showFullscreenAdv: onOpen"),e.onOpen(),k.interstitialWatched())},onClose:()=>{e.onClose&&(m.log(i.SDK,"showFullscreenAdv: onClose"),e.onClose())},onOffline:()=>{e.onOffline&&(m.log(i.SDK,"showFullscreenAdv: onOffline"),e.onOffline())},onError:r=>{e.onError&&e.onError(r)}}})}catch(e){return k.preloadError(g,e),m.warn(i.SDK,`showFullscreenAdv: ${e}`),Promise.resolve(!1)}};showRewardedVideo=async(e={})=>{try{await this.sdk.adv.showRewardedVideo({callbacks:{onOpen:()=>{e.onOpen&&(m.log(i.SDK,"showRewardedVideo: onOpen"),e.onOpen())},onClose:()=>{e.onClose&&(m.log(i.SDK,"showRewardedVideo: onClose"),e.onClose())},onRewarded:()=>{e.onRewarded&&(m.log(i.SDK,"showRewardedVideo: onRewarded"),e.onRewarded(),k.rewardedAdWatched())},onError:r=>{e.onError&&(m.log(i.SDK,"showRewardedVideo: onError"),e.onError(r))}}})}catch(e){return console.error("Ошибка при показе reward рекламы:",e),Promise.resolve(!1)}};leaderboardData=async()=>{if(!this.sdk)return;const e=await this.sdk.isAvailableMethod("leaderboards.getLeaderboardPlayerEntry"),r=await this.sdk.getLeaderboards();return e?(m.log(i.SDK,"[SDK leaderboard Available]",e),await r.getLeaderboardEntries(this.leaderTableName,{includeUser:!0,quantityAround:7,quantityTop:3})):(m.log(i.SDK,"[SDK leaderboard Available]",e),await r.getLeaderboardEntries(this.leaderTableName,{quantityTop:8}))};submitRecord=async e=>{this.sdk&&this.sdk.isAvailableMethod("leaderboards.setLeaderboardScore").then((async r=>{if(r){const r=await this.sdk.getLeaderboards();await r.setLeaderboardScore(this.leaderTableName,e)}else m.log(i.SDK,"leaderboards.setLeaderboardScore - пользователь не авторизован",r)}))};canReview=async()=>{if(this.sdk)return await this.sdk.feedback.canReview();console.error("[this.sdk] rateGame: Ошибка при инициализации Yandex SDK")};serverTime=async()=>this.sdk?this.sdk.serverTime():(console.error("[SDK] serverTime: YSDK не инициализирован"),super.serverTime());#o=async()=>{if(!this.sdk)return m.error(i.SDK,"getEnvironment: YSDK не инициализирован"),null;try{return this.sdk.environment}catch(e){return m.error(i.SDK,"Ошибка при получении объекта Environment:",e),null}};getLocale=async()=>{const e=await this.#o();return e?e.i18n.lang:(console.warn("[SDK] Локаль: Ошибка при получении окружения"),"ru")}},window._SERVICE.sayHello(),window.addEventListener("load",(()=>{window.createGame&&window.createGame()}))}();!function(){var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){var e={34:function(t,e,n){"use strict";var r=n(4901);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},76:function(t){"use strict";t.exports=Function.prototype.call},81:function(t,e,n){"use strict";var r=n(9565),i=n(9306),s=n(8551),o=n(6823),a=n(851),l=TypeError;t.exports=function(t,e){var n=arguments.length<2?a(t):e;if(i(n))return s(r(n,t));throw new l(o(t)+" is not iterable")}},113:function(t,e,n){"use strict";var r=n(6518),i=n(9213).find,s=n(6469),o="find",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r({target:"Array",proto:!0,forced:a},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),s(o)},116:function(t,e,n){"use strict";var r=n(6518),i=n(2652),s=n(9306),o=n(8551),a=n(1767);r({target:"Iterator",proto:!0,real:!0},{find:function(t){o(this),s(t);var e=a(this),n=0;return i(e,(function(e,r){if(t(e,n++))return r(e)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})},228:function(t){"use strict";var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,r,s,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,s||t,o),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,i,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var l,h,c=this._events[a],u=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,r),!0;case 4:return c.fn.call(c.context,e,r,i),!0;case 5:return c.fn.call(c.context,e,r,i,s),!0;case 6:return c.fn.call(c.context,e,r,i,s,o),!0}for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var d,f=c.length;for(h=0;h<f;h++)switch(c[h].once&&this.removeListener(t,c[h].fn,void 0,!0),u){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,e);break;case 3:c[h].fn.call(c[h].context,e,r);break;case 4:c[h].fn.call(c[h].context,e,r,i);break;default:if(!l)for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c[h].fn.apply(c[h].context,l)}}return!0},a.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,i){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||i&&!a.once||r&&a.context!==r||o(this,s);else{for(var l=0,h=[],c=a.length;l<c;l++)(a[l].fn!==e||i&&!a[l].once||r&&a[l].context!==r)&&h.push(a[l]);h.length?this._events[s]=1===h.length?h[0]:h:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a},235:function(t,e,n){"use strict";var r=n(9213).forEach,i=n(4598)("forEach");t.exports=i?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},280:function(t,e,n){"use strict";var r=n(6518),i=n(7751),s=n(6395),o=n(550),a=n(916).CONSTRUCTOR,l=n(3438),h=i("Promise"),c=s&&!a;r({target:"Promise",stat:!0,forced:s||a},{resolve:function(t){return l(c&&this===h?o:this,t)}})},283:function(t,e,n){"use strict";var r=n(9504),i=n(9039),s=n(4901),o=n(9297),a=n(3724),l=n(350).CONFIGURABLE,h=n(3706),c=n(1181),u=c.enforce,d=c.get,f=String,p=Object.defineProperty,m=r("".slice),g=r("".replace),v=r([].join),y=a&&!i((function(){return 8!==p((function(){}),"length",{value:8}).length})),x=String(String).split("String"),w=t.exports=function(t,e,n){"Symbol("===m(f(e),0,7)&&(e="["+g(f(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!o(t,"name")||l&&t.name!==e)&&(a?p(t,"name",{value:e,configurable:!0}):t.name=e),y&&n&&o(n,"arity")&&t.length!==n.arity&&p(t,"length",{value:n.arity});try{n&&o(n,"constructor")&&n.constructor?a&&p(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=u(t);return o(r,"source")||(r.source=v(x,"string"==typeof e?e:"")),t};Function.prototype.toString=w((function(){return s(this)&&d(this).source||h(this)}),"toString")},298:function(t,e,n){"use strict";var r=n(2195),i=n(5397),s=n(8480).f,o=n(7680),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"Window"===r(t)?function(t){try{return s(t)}catch(t){return o(a)}}(t):s(i(t))}},350:function(t,e,n){"use strict";var r=n(3724),i=n(9297),s=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=i(s,"name"),l=a&&"something"===function(){}.name,h=a&&(!r||r&&o(s,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:h}},397:function(t,e,n){"use strict";var r=n(7751);t.exports=r("document","documentElement")},414:function(t){"use strict";t.exports=Math.round},421:function(t){"use strict";t.exports={}},436:function(t,e,n){"use strict";var r,i,s,o=n(6518),a=n(6395),l=n(8574),h=n(4576),c=n(9565),u=n(6840),d=n(2967),f=n(687),p=n(7633),m=n(9306),g=n(4901),v=n(34),y=n(679),x=n(2293),w=n(9225).set,_=n(1955),b=n(3138),T=n(1103),S=n(8265),A=n(1181),E=n(550),C=n(916),k=n(6043),M="Promise",P=C.CONSTRUCTOR,I=C.REJECTION_EVENT,R=C.SUBCLASSING,O=A.getterFor(M),L=A.set,D=E&&E.prototype,F=E,N=D,B=h.TypeError,W=h.document,U=h.process,j=k.f,H=j,z=!!(W&&W.createEvent&&h.dispatchEvent),G="unhandledrejection",V=function(t){var e;return!(!v(t)||!g(e=t.then))&&e},X=function(t,e){var n,r,i,s=e.value,o=1===e.state,a=o?t.ok:t.fail,l=t.resolve,h=t.reject,u=t.domain;try{a?(o||(2===e.rejection&&Z(e),e.rejection=1),!0===a?n=s:(u&&u.enter(),n=a(s),u&&(u.exit(),i=!0)),n===t.promise?h(new B("Promise-chain cycle")):(r=V(n))?c(r,n,l,h):l(n)):h(s)}catch(t){u&&!i&&u.exit(),h(t)}},Y=function(t,e){t.notified||(t.notified=!0,_((function(){for(var n,r=t.reactions;n=r.get();)X(n,t);t.notified=!1,e&&!t.rejection&&q(t)})))},$=function(t,e,n){var r,i;z?((r=W.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),h.dispatchEvent(r)):r={promise:e,reason:n},!I&&(i=h["on"+t])?i(r):t===G&&b("Unhandled promise rejection",n)},q=function(t){c(w,h,(function(){var e,n=t.facade,r=t.value;if(K(t)&&(e=T((function(){l?U.emit("unhandledRejection",r,n):$(G,n,r)})),t.rejection=l||K(t)?2:1,e.error))throw e.value}))},K=function(t){return 1!==t.rejection&&!t.parent},Z=function(t){c(w,h,(function(){var e=t.facade;l?U.emit("rejectionHandled",e):$("rejectionhandled",e,t.value)}))},Q=function(t,e,n){return function(r){t(e,r,n)}},J=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,Y(t,!0))},tt=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw new B("Promise can't be resolved itself");var r=V(e);r?_((function(){var n={done:!1};try{c(r,e,Q(tt,n,t),Q(J,n,t))}catch(e){J(n,e,t)}})):(t.value=e,t.state=1,Y(t,!1))}catch(e){J({done:!1},e,t)}}};if(P&&(N=(F=function(t){y(this,N),m(t),c(r,this);var e=O(this);try{t(Q(tt,e),Q(J,e))}catch(t){J(e,t)}}).prototype,(r=function(t){L(this,{type:M,done:!1,notified:!1,parent:!1,reactions:new S,rejection:!1,state:0,value:null})}).prototype=u(N,"then",(function(t,e){var n=O(this),r=j(x(this,F));return n.parent=!0,r.ok=!g(t)||t,r.fail=g(e)&&e,r.domain=l?U.domain:void 0,0===n.state?n.reactions.add(r):_((function(){X(r,n)})),r.promise})),i=function(){var t=new r,e=O(t);this.promise=t,this.resolve=Q(tt,e),this.reject=Q(J,e)},k.f=j=function(t){return t===F||void 0===t?new i(t):H(t)},!a&&g(E)&&D!==Object.prototype)){s=D.then,R||u(D,"then",(function(t,e){var n=this;return new F((function(t,e){c(s,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete D.constructor}catch(t){}d&&d(D,N)}o({global:!0,constructor:!0,wrap:!0,forced:P},{Promise:F}),f(F,M,!1,!0),p(M)},453:function(t,e,n){"use strict";var r,i=n(9612),s=n(9383),o=n(1237),a=n(9290),l=n(9538),h=n(8068),c=n(9675),u=n(5345),d=n(1514),f=n(8968),p=n(6188),m=n(8002),g=n(5880),v=n(414),y=n(3093),x=Function,w=function(t){try{return x('"use strict"; return ('+t+").constructor;")()}catch(t){}},_=n(5795),b=n(3036),T=function(){throw new c},S=_?function(){try{return T}catch(t){try{return _(arguments,"callee").get}catch(t){return T}}}():T,A=n(4039)(),E=n(3628),C=n(1064),k=n(8648),M=n(1002),P=n(76),I={},R="undefined"!=typeof Uint8Array&&E?E(Uint8Array):r,O={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":A&&E?E([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":I,"%AsyncGenerator%":I,"%AsyncGeneratorFunction%":I,"%AsyncIteratorPrototype%":I,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":s,"%eval%":eval,"%EvalError%":o,"%Float16Array%":"undefined"==typeof Float16Array?r:Float16Array,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":x,"%GeneratorFunction%":I,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":A&&E?E(E([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&A&&E?E((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":i,"%Object.getOwnPropertyDescriptor%":_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":a,"%ReferenceError%":l,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&A&&E?E((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":A&&E?E(""[Symbol.iterator]()):r,"%Symbol%":A?Symbol:r,"%SyntaxError%":h,"%ThrowTypeError%":S,"%TypedArray%":R,"%TypeError%":c,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":u,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet,"%Function.prototype.call%":P,"%Function.prototype.apply%":M,"%Object.defineProperty%":b,"%Object.getPrototypeOf%":C,"%Math.abs%":d,"%Math.floor%":f,"%Math.max%":p,"%Math.min%":m,"%Math.pow%":g,"%Math.round%":v,"%Math.sign%":y,"%Reflect.getPrototypeOf%":k};if(E)try{null.error}catch(t){var L=E(E(t));O["%Error.prototype%"]=L}var D=function t(e){var n;if("%AsyncFunction%"===e)n=w("async function () {}");else if("%GeneratorFunction%"===e)n=w("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=w("async function* () {}");else if("%AsyncGenerator%"===e){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===e){var i=t("%AsyncGenerator%");i&&E&&(n=E(i.prototype))}return O[e]=n,n},F={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},N=n(6743),B=n(9957),W=N.call(P,Array.prototype.concat),U=N.call(M,Array.prototype.splice),j=N.call(P,String.prototype.replace),H=N.call(P,String.prototype.slice),z=N.call(P,RegExp.prototype.exec),G=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,V=/\\(\\)?/g,X=function(t,e){var n,r=t;if(B(F,r)&&(r="%"+(n=F[r])[0]+"%"),B(O,r)){var i=O[r];if(i===I&&(i=D(r)),void 0===i&&!e)throw new c("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:i}}throw new h("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new c("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new c('"allowMissing" argument must be a boolean');if(null===z(/^%?[^%]*%?$/,t))throw new h("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(t){var e=H(t,0,1),n=H(t,-1);if("%"===e&&"%"!==n)throw new h("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new h("invalid intrinsic syntax, expected opening `%`");var r=[];return j(t,G,(function(t,e,n,i){r[r.length]=n?j(i,V,"$1"):e||t})),r}(t),r=n.length>0?n[0]:"",i=X("%"+r+"%",e),s=i.name,o=i.value,a=!1,l=i.alias;l&&(r=l[0],U(n,W([0,1],l)));for(var u=1,d=!0;u<n.length;u+=1){var f=n[u],p=H(f,0,1),m=H(f,-1);if(('"'===p||"'"===p||"`"===p||'"'===m||"'"===m||"`"===m)&&p!==m)throw new h("property names with quotes must have matching quotes");if("constructor"!==f&&d||(a=!0),B(O,s="%"+(r+="."+f)+"%"))o=O[s];else if(null!=o){if(!(f in o)){if(!e)throw new c("base intrinsic for "+t+" exists, but the property is not available.");return}if(_&&u+1>=n.length){var g=_(o,f);o=(d=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:o[f]}else d=B(o,f),o=o[f];d&&!a&&(O[s]=o)}}return o}},507:function(t,e,n){"use strict";var r=n(453),i=n(6556),s=n(8859),o=n(9675),a=r("%Map%",!0),l=i("Map.prototype.get",!0),h=i("Map.prototype.set",!0),c=i("Map.prototype.has",!0),u=i("Map.prototype.delete",!0),d=i("Map.prototype.size",!0);t.exports=!!a&&function(){var t,e={assert:function(t){if(!e.has(t))throw new o("Side channel does not contain "+s(t))},delete:function(e){if(t){var n=u(t,e);return 0===d(t)&&(t=void 0),n}return!1},get:function(e){if(t)return l(t,e)},has:function(e){return!!t&&c(t,e)},set:function(e,n){t||(t=new a),h(t,e,n)}};return e}},511:function(t,e,n){"use strict";var r=n(9167),i=n(9297),s=n(1951),o=n(4913).f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});i(e,t)||o(e,t,{value:s.f(t)})}},533:function(t,e,n){"use strict";var r=n(9504),i=n(8014),s=n(655),o=n(2333),a=n(7750),l=r(o),h=r("".slice),c=Math.ceil,u=function(t){return function(e,n,r){var o,u,d=s(a(e)),f=i(n),p=d.length,m=void 0===r?" ":s(r);return f<=p||""===m?d:((u=l(m,c((o=f-p)/m.length))).length>o&&(u=h(u,0,o)),t?d+u:u+d)}};t.exports={start:u(!1),end:u(!0)}},537:function(t,e,n){"use strict";var r=n(550),i=n(4428),s=n(916).CONSTRUCTOR;t.exports=s||!i((function(t){r.all(t).then(void 0,(function(){}))}))},540:function(t){"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},550:function(t,e,n){"use strict";var r=n(4576);t.exports=r.Promise},566:function(t,e,n){"use strict";var r=n(9504),i=n(9306),s=n(34),o=n(9297),a=n(7680),l=n(616),h=Function,c=r([].concat),u=r([].join),d={};t.exports=l?h.bind:function(t){var e=i(this),n=e.prototype,r=a(arguments,1),l=function(){var n=c(r,a(arguments));return this instanceof l?function(t,e,n){if(!o(d,e)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";d[e]=h("C,a","return new C("+u(r,",")+")")}return d[e](t,n)}(e,n.length,n):e.apply(t,n)};return s(n)&&(l.prototype=n),l}},597:function(t,e,n){"use strict";var r=n(9039),i=n(8227),s=n(9519),o=i("species");t.exports=function(t){return s>=51||!r((function(){var e=[];return(e.constructor={})[o]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},616:function(t,e,n){"use strict";var r=n(9039);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},655:function(t,e,n){"use strict";var r=n(6955),i=String;t.exports=function(t){if("Symbol"===r(t))throw new TypeError("Cannot convert a Symbol value to a string");return i(t)}},679:function(t,e,n){"use strict";var r=n(1625),i=TypeError;t.exports=function(t,e){if(r(e,t))return t;throw new i("Incorrect invocation")}},687:function(t,e,n){"use strict";var r=n(4913).f,i=n(9297),s=n(8227)("toStringTag");t.exports=function(t,e,n){t&&!n&&(t=t.prototype),t&&!i(t,s)&&r(t,s,{configurable:!0,value:e})}},706:function(t,e,n){"use strict";var r=n(350).PROPER,i=n(9039),s=n(7452);t.exports=function(t){return i((function(){return!!s[t]()||"​᠎"!=="​᠎"[t]()||r&&s[t].name!==t}))}},713:function(t,e,n){"use strict";var r=n(9565),i=n(9306),s=n(8551),o=n(1767),a=n(9462),l=n(6319),h=a((function(){var t=this.iterator,e=s(r(this.next,t));if(!(this.done=!!e.done))return l(t,this.mapper,[e.value,this.counter++],!0)}));t.exports=function(t){return s(this),i(t),new h(o(this),{mapper:t})}},739:function(t,e,n){"use strict";var r=n(6518),i=n(9039),s=n(8981),o=n(2777);r({target:"Date",proto:!0,arity:1,forced:i((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function(t){var e=s(this),n=o(e,"number");return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},741:function(t){"use strict";var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},747:function(t,e,n){"use strict";var r=n(6699),i=n(6193),s=n(6249),o=Error.captureStackTrace;t.exports=function(t,e,n,a){s&&(o?o(t,e):r(t,"stack",i(n,a)))}},757:function(t,e,n){"use strict";var r=n(7751),i=n(4901),s=n(1625),o=n(7040),a=Object;t.exports=o?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return i(e)&&s(e.prototype,a(t))}},788:function(t,e,n){"use strict";var r=n(34),i=n(2195),s=n(8227)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[s])?!!e:"RegExp"===i(t))}},825:function(t,e,n){"use strict";var r=n(6518),i=n(7751),s=n(8745),o=n(566),a=n(5548),l=n(8551),h=n(34),c=n(2360),u=n(9039),d=i("Reflect","construct"),f=Object.prototype,p=[].push,m=u((function(){function t(){}return!(d((function(){}),[],t)instanceof t)})),g=!u((function(){d((function(){}))})),v=m||g;r({target:"Reflect",stat:!0,forced:v,sham:v},{construct:function(t,e){a(t),l(e);var n=arguments.length<3?t:a(arguments[2]);if(g&&!m)return d(t,e,n);if(t===n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return s(p,r,e),new(s(o,t,r))}var i=n.prototype,u=c(h(i)?i:f),v=s(t,u,e);return h(v)?v:u}})},851:function(t,e,n){"use strict";var r=n(6955),i=n(5966),s=n(4117),o=n(6269),a=n(8227)("iterator");t.exports=function(t){if(!s(t))return i(t,a)||i(t,"@@iterator")||o[r(t)]}},906:function(t,e,n){"use strict";n(7495);var r,i,s=n(6518),o=n(9565),a=n(4901),l=n(8551),h=n(655),c=(r=!1,(i=/[ac]/).exec=function(){return r=!0,/./.exec.apply(this,arguments)},!0===i.test("abc")&&r),u=/./.test;s({target:"RegExp",proto:!0,forced:!c},{test:function(t){var e=l(this),n=h(t),r=e.exec;if(!a(r))return o(u,e,n);var i=o(r,e,n);return null!==i&&(l(i),!0)}})},916:function(t,e,n){"use strict";var r=n(4576),i=n(550),s=n(4901),o=n(2796),a=n(3706),l=n(8227),h=n(4215),c=n(6395),u=n(9519),d=i&&i.prototype,f=l("species"),p=!1,m=s(r.PromiseRejectionEvent),g=o("Promise",(function(){var t=a(i),e=t!==String(i);if(!e&&66===u)return!0;if(c&&(!d.catch||!d.finally))return!0;if(!u||u<51||!/native code/.test(t)){var n=new i((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((n.constructor={})[f]=r,!(p=n.then((function(){}))instanceof r))return!0}return!(e||"BROWSER"!==h&&"DENO"!==h||m)}));t.exports={CONSTRUCTOR:g,REJECTION_EVENT:m,SUBCLASSING:p}},920:function(t,e,n){"use strict";var r=n(9675),i=n(8859),s=n(4803),o=n(507),a=n(2271)||o||s;t.exports=function(){var t,e={assert:function(t){if(!e.has(t))throw new r("Side channel does not contain "+i(t))},delete:function(e){return!!t&&t.delete(e)},get:function(e){return t&&t.get(e)},has:function(e){return!!t&&t.has(e)},set:function(e,n){t||(t=a()),t.set(e,n)}};return e}},958:function(t,e,n){"use strict";n(5240)},1002:function(t){"use strict";t.exports=Function.prototype.apply},1034:function(t,e,n){"use strict";var r=n(9565),i=n(9297),s=n(1625),o=n(7979),a=RegExp.prototype;t.exports=function(t){var e=t.flags;return void 0!==e||"flags"in a||i(t,"flags")||!s(a,t)?e:r(o,t)}},1056:function(t,e,n){"use strict";var r=n(4913).f;t.exports=function(t,e,n){n in t||r(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})}},1064:function(t,e,n){"use strict";var r=n(9612);t.exports=r.getPrototypeOf||null},1072:function(t,e,n){"use strict";var r=n(1828),i=n(8727);t.exports=Object.keys||function(t){return r(t,i)}},1088:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(6395),o=n(350),a=n(4901),l=n(3994),h=n(2787),c=n(2967),u=n(687),d=n(6699),f=n(6840),p=n(8227),m=n(6269),g=n(7657),v=o.PROPER,y=o.CONFIGURABLE,x=g.IteratorPrototype,w=g.BUGGY_SAFARI_ITERATORS,_=p("iterator"),b="keys",T="values",S="entries",A=function(){return this};t.exports=function(t,e,n,o,p,g,E){l(n,e,o);var C,k,M,P=function(t){if(t===p&&D)return D;if(!w&&t&&t in O)return O[t];switch(t){case b:case T:case S:return function(){return new n(this,t)}}return function(){return new n(this)}},I=e+" Iterator",R=!1,O=t.prototype,L=O[_]||O["@@iterator"]||p&&O[p],D=!w&&L||P(p),F="Array"===e&&O.entries||L;if(F&&(C=h(F.call(new t)))!==Object.prototype&&C.next&&(s||h(C)===x||(c?c(C,x):a(C[_])||f(C,_,A)),u(C,I,!0,!0),s&&(m[I]=A)),v&&p===T&&L&&L.name!==T&&(!s&&y?d(O,"name",T):(R=!0,D=function(){return i(L,this)})),p)if(k={values:P(T),keys:g?D:P(b),entries:P(S)},E)for(M in k)(w||R||!(M in O))&&f(O,M,k[M]);else r({target:e,proto:!0,forced:w||R},k);return s&&!E||O[_]===D||f(O,_,D,{name:p}),m[e]=D,k}},1103:function(t){"use strict";t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},1113:function(t){"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},1181:function(t,e,n){"use strict";var r,i,s,o=n(8622),a=n(4576),l=n(34),h=n(6699),c=n(9297),u=n(7629),d=n(6119),f=n(421),p="Object already initialized",m=a.TypeError,g=a.WeakMap;if(o||u.state){var v=u.state||(u.state=new g);v.get=v.get,v.has=v.has,v.set=v.set,r=function(t,e){if(v.has(t))throw new m(p);return e.facade=t,v.set(t,e),e},i=function(t){return v.get(t)||{}},s=function(t){return v.has(t)}}else{var y=d("state");f[y]=!0,r=function(t,e){if(c(t,y))throw new m(p);return e.facade=t,h(t,y,e),e},i=function(t){return c(t,y)?t[y]:{}},s=function(t){return c(t,y)}}t.exports={set:r,get:i,has:s,enforce:function(t){return s(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!l(e)||(n=i(e)).type!==t)throw new m("Incompatible receiver, "+t+" required");return n}}}},1208:function(t,e,n){"use strict";var r=n(1354),i=n.n(r),s=n(6314),o=n.n(s),a=n(4453),l=o()(i());l.i(a.A),l.push([t.id,"* {\r\n    margin: 0;\r\n    padding: 0;\r\n    user-select: none;\r\n    -webkit-touch-callout: none; /* iOS Safari */\r\n    -webkit-user-select: none; /* Safari */\r\n    -khtml-user-select: none; /* Konqueror HTML */\r\n    -moz-user-select: none; /* Old versions of Firefox */\r\n    -ms-user-select: none; /* Internet Explorer/Edge */\r\n    user-select: none; /* Non-prefixed version, currently supported by Chrome, Edge, Opera and Firefox */\r\n}\r\n\r\nhtml, body {\r\n    position: fixed;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #000000;\r\n    display: flex;\r\n    touch-action: none;\r\n\r\n    /* Отключаем скролл и лонгтап на IOS */\r\n    overflow: hidden;\r\n    -webkit-touch-callout: none;\r\n    -webkit-user-select: none;\r\n    -khtml-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    -webkit-tap-highlight-color: rgba(0,0,0,0);\r\n}\r\n\r\n#canvas-wrapper {\r\n    display: block;\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    touch-action: none;\r\n    /*outline: 4px dashed blue;*/\r\n    /*outline-offset: -4px;*/\r\n}\r\n\r\n#canvas-wrapper canvas {\r\n    display: block;\r\n    touch-action: none;\r\n    /*outline: 8px dashed red;*/\r\n    /*outline-offset: -8px;*/\r\n}\r\n\r\n.icon-light-on {\r\n    filter: brightness(1.2) contrast(1.1);\r\n}\r\n","",{version:3,sources:["webpack://./src/style.css"],names:[],mappings:"AAEA;IACI,SAAS;IACT,UAAU;IACV,iBAAiB;IACjB,2BAA2B,EAAE,eAAe;IAC5C,yBAAyB,EAAE,WAAW;IACtC,wBAAwB,EAAE,mBAAmB;IAC7C,sBAAsB,EAAE,4BAA4B;IACpD,qBAAqB,EAAE,2BAA2B;IAClD,iBAAiB,EAAE,iFAAiF;AACxG;;AAEA;IACI,eAAe;IACf,WAAW;IACX,YAAY;IACZ,yBAAyB;IACzB,aAAa;IACb,kBAAkB;;IAElB,sCAAsC;IACtC,gBAAgB;IAChB,2BAA2B;IAC3B,yBAAyB;IACzB,wBAAwB;IACxB,sBAAsB;IACtB,qBAAqB;IACrB,iBAAiB;IACjB,0CAA0C;AAC9C;;AAEA;IACI,cAAc;IACd,kBAAkB;IAClB,QAAQ;IACR,SAAS;IACT,gCAAgC;IAChC,kBAAkB;IAClB,4BAA4B;IAC5B,wBAAwB;AAC5B;;AAEA;IACI,cAAc;IACd,kBAAkB;IAClB,2BAA2B;IAC3B,wBAAwB;AAC5B;;AAEA;IACI,qCAAqC;AACzC",sourcesContent:["@import './fonts.css';\r\n\r\n* {\r\n    margin: 0;\r\n    padding: 0;\r\n    user-select: none;\r\n    -webkit-touch-callout: none; /* iOS Safari */\r\n    -webkit-user-select: none; /* Safari */\r\n    -khtml-user-select: none; /* Konqueror HTML */\r\n    -moz-user-select: none; /* Old versions of Firefox */\r\n    -ms-user-select: none; /* Internet Explorer/Edge */\r\n    user-select: none; /* Non-prefixed version, currently supported by Chrome, Edge, Opera and Firefox */\r\n}\r\n\r\nhtml, body {\r\n    position: fixed;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #000000;\r\n    display: flex;\r\n    touch-action: none;\r\n\r\n    /* Отключаем скролл и лонгтап на IOS */\r\n    overflow: hidden;\r\n    -webkit-touch-callout: none;\r\n    -webkit-user-select: none;\r\n    -khtml-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    -webkit-tap-highlight-color: rgba(0,0,0,0);\r\n}\r\n\r\n#canvas-wrapper {\r\n    display: block;\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    touch-action: none;\r\n    /*outline: 4px dashed blue;*/\r\n    /*outline-offset: -4px;*/\r\n}\r\n\r\n#canvas-wrapper canvas {\r\n    display: block;\r\n    touch-action: none;\r\n    /*outline: 8px dashed red;*/\r\n    /*outline-offset: -8px;*/\r\n}\r\n\r\n.icon-light-on {\r\n    filter: brightness(1.2) contrast(1.1);\r\n}\r\n"],sourceRoot:""}]),e.A=l},1237:function(t){"use strict";t.exports=EvalError},1240:function(t,e,n){"use strict";var r=n(9504);t.exports=r(1..valueOf)},1270:function(t,e,n){var r;t=n.nmd(t),function(){e&&e.nodeType,t&&t.nodeType;var i="object"==typeof n.g&&n.g;i.global!==i&&i.window!==i&&i.self;var s,o=2147483647,a=36,l=/^xn--/,h=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,u={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,f=String.fromCharCode;function p(t){throw new RangeError(u[t])}function m(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function g(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+m((t=t.replace(c,".")).split("."),e).join(".")}function v(t){for(var e,n,r=[],i=0,s=t.length;i<s;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<s?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function y(t){return m(t,(function(t){var e="";return t>65535&&(e+=f((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+f(t)})).join("")}function x(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function w(t,e,n){var r=0;for(t=n?d(t/700):t>>1,t+=d(t/e);t>455;r+=a)t=d(t/35);return d(r+36*t/(t+38))}function _(t){var e,n,r,i,s,l,h,c,u,f,m,g=[],v=t.length,x=0,_=128,b=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&p("not-basic"),g.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<v;){for(s=x,l=1,h=a;i>=v&&p("invalid-input"),((c=(m=t.charCodeAt(i++))-48<10?m-22:m-65<26?m-65:m-97<26?m-97:a)>=a||c>d((o-x)/l))&&p("overflow"),x+=c*l,!(c<(u=h<=b?1:h>=b+26?26:h-b));h+=a)l>d(o/(f=a-u))&&p("overflow"),l*=f;b=w(x-s,e=g.length+1,0==s),d(x/e)>o-_&&p("overflow"),_+=d(x/e),x%=e,g.splice(x++,0,_)}return y(g)}function b(t){var e,n,r,i,s,l,h,c,u,m,g,y,_,b,T,S=[];for(y=(t=v(t)).length,e=128,n=0,s=72,l=0;l<y;++l)(g=t[l])<128&&S.push(f(g));for(r=i=S.length,i&&S.push("-");r<y;){for(h=o,l=0;l<y;++l)(g=t[l])>=e&&g<h&&(h=g);for(h-e>d((o-n)/(_=r+1))&&p("overflow"),n+=(h-e)*_,e=h,l=0;l<y;++l)if((g=t[l])<e&&++n>o&&p("overflow"),g==e){for(c=n,u=a;!(c<(m=u<=s?1:u>=s+26?26:u-s));u+=a)T=c-m,b=a-m,S.push(f(x(m+T%b,0))),c=d(T/b);S.push(f(x(c,0))),s=w(n,_,r==i),n=0,++r}++n,++e}return S.join("")}s={version:"1.4.1",ucs2:{decode:v,encode:y},decode:_,encode:b,toASCII:function(t){return g(t,(function(t){return h.test(t)?"xn--"+b(t):t}))},toUnicode:function(t){return g(t,(function(t){return l.test(t)?_(t.slice(4).toLowerCase()):t}))}},void 0===(r=function(){return s}.call(e,n,e,t))||(t.exports=r)}()},1278:function(t,e,n){"use strict";var r=n(6518),i=n(3724),s=n(5031),o=n(5397),a=n(7347),l=n(4659);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),i=a.f,h=s(r),c={},u=0;h.length>u;)void 0!==(n=i(r,e=h[u++]))&&l(c,e,n);return c}})},1291:function(t,e,n){"use strict";var r=n(741);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},1296:function(t,e,n){"use strict";var r=n(4495);t.exports=r&&!!Symbol.for&&!!Symbol.keyFor},1333:function(t){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(var r in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var i=Object.getOwnPropertySymbols(t);if(1!==i.length||i[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(t,e);if(42!==s.value||!0!==s.enumerable)return!1}return!0}},1354:function(t){"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),s="/*# ".concat(i," */");return[e].concat([s]).join("\n")}return[e].join("\n")}},1415:function(t,e,n){"use strict";n(2405)},1436:function(t,e,n){"use strict";var r=n(8227)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,"/./"[t](e)}catch(t){}}return!1}},1454:function(t,e,n){"use strict";n(1701)},1469:function(t,e,n){"use strict";var r=n(7433);t.exports=function(t,e){return new(r(t))(0===e?0:e)}},1481:function(t,e,n){"use strict";var r=n(6518),i=n(6043);r({target:"Promise",stat:!0,forced:n(916).CONSTRUCTOR},{reject:function(t){var e=i.f(this);return(0,e.reject)(t),e.promise}})},1510:function(t,e,n){"use strict";var r=n(6518),i=n(7751),s=n(9297),o=n(655),a=n(5745),l=n(1296),h=a("string-to-symbol-registry"),c=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!l},{for:function(t){var e=o(t);if(s(h,e))return h[e];var n=i("Symbol")(e);return h[e]=n,c[n]=e,n}})},1514:function(t){"use strict";t.exports=Math.abs},1625:function(t,e,n){"use strict";var r=n(9504);t.exports=r({}.isPrototypeOf)},1699:function(t,e,n){"use strict";var r=n(6518),i=n(9504),s=n(2892),o=n(7750),a=n(655),l=n(1436),h=i("".indexOf);r({target:"String",proto:!0,forced:!l("includes")},{includes:function(t){return!!~h(a(o(this)),a(s(t)),arguments.length>1?arguments[1]:void 0)}})},1701:function(t,e,n){"use strict";var r=n(6518),i=n(713);r({target:"Iterator",proto:!0,real:!0,forced:n(6395)},{map:i})},1761:function(t,e,n){"use strict";var r=n(9565),i=n(9228),s=n(8551),o=n(4117),a=n(8014),l=n(655),h=n(7750),c=n(5966),u=n(7829),d=n(6682);i("match",(function(t,e,n){return[function(e){var n=h(this),i=o(e)?void 0:c(e,t);return i?r(i,e,n):new RegExp(e)[t](l(n))},function(t){var r=s(this),i=l(t),o=n(e,r,i);if(o.done)return o.value;if(!r.global)return d(r,i);var h=r.unicode;r.lastIndex=0;for(var c,f=[],p=0;null!==(c=d(r,i));){var m=l(c[0]);f[p]=m,""===m&&(r.lastIndex=u(i,a(r.lastIndex),h)),p++}return 0===p?null:f}]}))},1767:function(t){"use strict";t.exports=function(t){return{iterator:t,next:t.next,done:!1}}},1828:function(t,e,n){"use strict";var r=n(9504),i=n(9297),s=n(5397),o=n(9617).indexOf,a=n(421),l=r([].push);t.exports=function(t,e){var n,r=s(t),h=0,c=[];for(n in r)!i(a,n)&&i(r,n)&&l(c,n);for(;e.length>h;)i(r,n=e[h++])&&(~o(c,n)||l(c,n));return c}},1951:function(t,e,n){"use strict";var r=n(8227);e.f=r},1955:function(t,e,n){"use strict";var r,i,s,o,a,l=n(4576),h=n(3389),c=n(6080),u=n(9225).set,d=n(8265),f=n(9544),p=n(4265),m=n(7860),g=n(8574),v=l.MutationObserver||l.WebKitMutationObserver,y=l.document,x=l.process,w=l.Promise,_=h("queueMicrotask");if(!_){var b=new d,T=function(){var t,e;for(g&&(t=x.domain)&&t.exit();e=b.get();)try{e()}catch(t){throw b.head&&r(),t}t&&t.enter()};f||g||m||!v||!y?!p&&w&&w.resolve?((o=w.resolve(void 0)).constructor=w,a=c(o.then,o),r=function(){a(T)}):g?r=function(){x.nextTick(T)}:(u=c(u,l),r=function(){u(T)}):(i=!0,s=y.createTextNode(""),new v(T).observe(s,{characterData:!0}),r=function(){s.data=i=!i}),_=function(t){b.head||r(),b.add(t)}}t.exports=_},2003:function(t,e,n){"use strict";var r=n(6518),i=n(6395),s=n(916).CONSTRUCTOR,o=n(550),a=n(7751),l=n(4901),h=n(6840),c=o&&o.prototype;if(r({target:"Promise",proto:!0,forced:s,real:!0},{catch:function(t){return this.then(void 0,t)}}),!i&&l(o)){var u=a("Promise").prototype.catch;c.catch!==u&&h(c,"catch",u,{unsafe:!0})}},2008:function(t,e,n){"use strict";var r=n(6518),i=n(9213).filter;r({target:"Array",proto:!0,forced:!n(597)("filter")},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},2062:function(t,e,n){"use strict";var r=n(6518),i=n(9213).map;r({target:"Array",proto:!0,forced:!n(597)("map")},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},2106:function(t,e,n){"use strict";var r=n(283),i=n(4913);t.exports=function(t,e,n){return n.get&&r(n.get,e,{getter:!0}),n.set&&r(n.set,e,{setter:!0}),i.f(t,e,n)}},2140:function(t,e,n){"use strict";var r={};r[n(8227)("toStringTag")]="z",t.exports="[object z]"===String(r)},2195:function(t,e,n){"use strict";var r=n(9504),i=r({}.toString),s=r("".slice);t.exports=function(t){return s(i(t),8,-1)}},2211:function(t,e,n){"use strict";var r=n(9039);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},2259:function(t,e,n){"use strict";n(511)("iterator")},2271:function(t,e,n){"use strict";var r=n(453),i=n(6556),s=n(8859),o=n(507),a=n(9675),l=r("%WeakMap%",!0),h=i("WeakMap.prototype.get",!0),c=i("WeakMap.prototype.set",!0),u=i("WeakMap.prototype.has",!0),d=i("WeakMap.prototype.delete",!0);t.exports=l?function(){var t,e,n={assert:function(t){if(!n.has(t))throw new a("Side channel does not contain "+s(t))},delete:function(n){if(l&&n&&("object"==typeof n||"function"==typeof n)){if(t)return d(t,n)}else if(o&&e)return e.delete(n);return!1},get:function(n){return l&&n&&("object"==typeof n||"function"==typeof n)&&t?h(t,n):e&&e.get(n)},has:function(n){return l&&n&&("object"==typeof n||"function"==typeof n)&&t?u(t,n):!!e&&e.has(n)},set:function(n,r){l&&n&&("object"==typeof n||"function"==typeof n)?(t||(t=new l),c(t,n,r)):o&&(e||(e=o()),e.set(n,r))}};return n}:o},2293:function(t,e,n){"use strict";var r=n(8551),i=n(5548),s=n(4117),o=n(8227)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||s(n=r(a)[o])?e:i(n)}},2333:function(t,e,n){"use strict";var r=n(1291),i=n(655),s=n(7750),o=RangeError;t.exports=function(t){var e=i(s(this)),n="",a=r(t);if(a<0||a===1/0)throw new o("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(n+=e);return n}},2357:function(t,e,n){"use strict";var r=n(3724),i=n(9039),s=n(9504),o=n(2787),a=n(1072),l=n(5397),h=s(n(8773).f),c=s([].push),u=r&&i((function(){var t=Object.create(null);return t[2]=2,!h(t,2)})),d=function(t){return function(e){for(var n,i=l(e),s=a(i),d=u&&null===o(i),f=s.length,p=0,m=[];f>p;)n=s[p++],r&&!(d?n in i:h(i,n))||c(m,t?[n,i[n]]:i[n]);return m}};t.exports={entries:d(!0),values:d(!1)}},2360:function(t,e,n){"use strict";var r,i=n(8551),s=n(6801),o=n(8727),a=n(421),l=n(397),h=n(4055),c=n(6119),u="prototype",d="script",f=c("IE_PROTO"),p=function(){},m=function(t){return"<"+d+">"+t+"</"+d+">"},g=function(t){t.write(m("")),t.close();var e=t.parentWindow.Object;return t=null,e},v=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}var t,e,n;v="undefined"!=typeof document?document.domain&&r?g(r):(e=h("iframe"),n="java"+d+":",e.style.display="none",l.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(m("document.F=Object")),t.close(),t.F):g(r);for(var i=o.length;i--;)delete v[u][o[i]];return v()};a[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(p[u]=i(t),n=new p,p[u]=null,n[f]=t):n=v(),void 0===e?n:s.f(n,e)}},2405:function(t,e,n){"use strict";n(6468)("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n(6938))},2478:function(t,e,n){"use strict";var r=n(9504),i=n(8981),s=Math.floor,o=r("".charAt),a=r("".replace),l=r("".slice),h=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,r,u,d){var f=n+t.length,p=r.length,m=c;return void 0!==u&&(u=i(u),m=h),a(d,m,(function(i,a){var h;switch(o(a,0)){case"$":return"$";case"&":return t;case"`":return l(e,0,n);case"'":return l(e,f);case"<":h=u[l(a,1,-1)];break;default:var c=+a;if(0===c)return i;if(c>p){var d=s(c/10);return 0===d?i:d<=p?void 0===r[d-1]?o(a,1):r[d-1]+o(a,1):i}h=r[c-1]}return void 0===h?"":h}))}},2489:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(9306),o=n(8551),a=n(1767),l=n(9462),h=n(6319),c=n(6395),u=l((function(){for(var t,e,n=this.iterator,r=this.predicate,s=this.next;;){if(t=o(i(s,n)),this.done=!!t.done)return;if(e=t.value,h(n,r,[e,this.counter++],!0))return e}}));r({target:"Iterator",proto:!0,real:!0,forced:c},{filter:function(t){return o(this),s(t),new u(a(this),{predicate:t})}})},2529:function(t){"use strict";t.exports=function(t,e){return{value:t,done:e}}},2577:function(t,e,n){"use strict";n(116)},2603:function(t,e,n){"use strict";var r=n(655);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:r(t)}},2634:function(){},2642:function(t,e,n){"use strict";var r=n(7720),i=Object.prototype.hasOwnProperty,s=Array.isArray,o={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:r.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},a=function(t){return t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e,10))}))},l=function(t,e,n){if(t&&"string"==typeof t&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&n>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(1===e.arrayLimit?"":"s")+" allowed in an array.");return t},h=function(t,e,n,s){if(t){var o=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,a=/(\[[^[\]]*])/g,h=n.depth>0&&/(\[[^[\]]*])/.exec(o),c=h?o.slice(0,h.index):o,u=[];if(c){if(!n.plainObjects&&i.call(Object.prototype,c)&&!n.allowPrototypes)return;u.push(c)}for(var d=0;n.depth>0&&null!==(h=a.exec(o))&&d<n.depth;){if(d+=1,!n.plainObjects&&i.call(Object.prototype,h[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(h[1])}if(h){if(!0===n.strictDepth)throw new RangeError("Input depth exceeded depth option of "+n.depth+" and strictDepth is true");u.push("["+o.slice(h.index)+"]")}return function(t,e,n,i){var s=0;if(t.length>0&&"[]"===t[t.length-1]){var o=t.slice(0,-1).join("");s=Array.isArray(e)&&e[o]?e[o].length:0}for(var a=i?e:l(e,n,s),h=t.length-1;h>=0;--h){var c,u=t[h];if("[]"===u&&n.parseArrays)c=n.allowEmptyArrays&&(""===a||n.strictNullHandling&&null===a)?[]:r.combine([],a);else{c=n.plainObjects?{__proto__:null}:{};var d="["===u.charAt(0)&&"]"===u.charAt(u.length-1)?u.slice(1,-1):u,f=n.decodeDotInKeys?d.replace(/%2E/g,"."):d,p=parseInt(f,10);n.parseArrays||""!==f?!isNaN(p)&&u!==f&&String(p)===f&&p>=0&&n.parseArrays&&p<=n.arrayLimit?(c=[])[p]=a:"__proto__"!==f&&(c[f]=a):c={0:a}}a=c}return a}(u,e,n,s)}};t.exports=function(t,e){var n=function(t){if(!t)return o;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.decodeDotInKeys&&"boolean"!=typeof t.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(void 0!==t.throwOnLimitExceeded&&"boolean"!=typeof t.throwOnLimitExceeded)throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var e=void 0===t.charset?o.charset:t.charset,n=void 0===t.duplicates?o.duplicates:t.duplicates;if("combine"!==n&&"first"!==n&&"last"!==n)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===t.allowDots?!0===t.decodeDotInKeys||o.allowDots:!!t.allowDots,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:o.allowEmptyArrays,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:o.allowPrototypes,allowSparse:"boolean"==typeof t.allowSparse?t.allowSparse:o.allowSparse,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:o.arrayLimit,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:o.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:o.comma,decodeDotInKeys:"boolean"==typeof t.decodeDotInKeys?t.decodeDotInKeys:o.decodeDotInKeys,decoder:"function"==typeof t.decoder?t.decoder:o.decoder,delimiter:"string"==typeof t.delimiter||r.isRegExp(t.delimiter)?t.delimiter:o.delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:o.depth,duplicates:n,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:o.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:o.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:o.plainObjects,strictDepth:"boolean"==typeof t.strictDepth?!!t.strictDepth:o.strictDepth,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:o.strictNullHandling,throwOnLimitExceeded:"boolean"==typeof t.throwOnLimitExceeded&&t.throwOnLimitExceeded}}(e);if(""===t||null==t)return n.plainObjects?{__proto__:null}:{};for(var c="string"==typeof t?function(t,e){var n={__proto__:null},h=e.ignoreQueryPrefix?t.replace(/^\?/,""):t;h=h.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var c=e.parameterLimit===1/0?void 0:e.parameterLimit,u=h.split(e.delimiter,e.throwOnLimitExceeded?c+1:c);if(e.throwOnLimitExceeded&&u.length>c)throw new RangeError("Parameter limit exceeded. Only "+c+" parameter"+(1===c?"":"s")+" allowed.");var d,f=-1,p=e.charset;if(e.charsetSentinel)for(d=0;d<u.length;++d)0===u[d].indexOf("utf8=")&&("utf8=%E2%9C%93"===u[d]?p="utf-8":"utf8=%26%2310003%3B"===u[d]&&(p="iso-8859-1"),f=d,d=u.length);for(d=0;d<u.length;++d)if(d!==f){var m,g,v=u[d],y=v.indexOf("]="),x=-1===y?v.indexOf("="):y+1;-1===x?(m=e.decoder(v,o.decoder,p,"key"),g=e.strictNullHandling?null:""):(m=e.decoder(v.slice(0,x),o.decoder,p,"key"),g=r.maybeMap(l(v.slice(x+1),e,s(n[m])?n[m].length:0),(function(t){return e.decoder(t,o.decoder,p,"value")}))),g&&e.interpretNumericEntities&&"iso-8859-1"===p&&(g=a(String(g))),v.indexOf("[]=")>-1&&(g=s(g)?[g]:g);var w=i.call(n,m);w&&"combine"===e.duplicates?n[m]=r.combine(n[m],g):w&&"last"!==e.duplicates||(n[m]=g)}return n}(t,n):t,u=n.plainObjects?{__proto__:null}:{},d=Object.keys(c),f=0;f<d.length;++f){var p=d[f],m=h(p,c[p],n,"string"==typeof t);u=r.merge(u,m,n)}return!0===n.allowSparse?u:r.compact(u)}},2652:function(t,e,n){"use strict";var r=n(6080),i=n(9565),s=n(8551),o=n(6823),a=n(4209),l=n(6198),h=n(1625),c=n(81),u=n(851),d=n(9539),f=TypeError,p=function(t,e){this.stopped=t,this.result=e},m=p.prototype;t.exports=function(t,e,n){var g,v,y,x,w,_,b,T=n&&n.that,S=!(!n||!n.AS_ENTRIES),A=!(!n||!n.IS_RECORD),E=!(!n||!n.IS_ITERATOR),C=!(!n||!n.INTERRUPTED),k=r(e,T),M=function(t){return g&&d(g,"normal",t),new p(!0,t)},P=function(t){return S?(s(t),C?k(t[0],t[1],M):k(t[0],t[1])):C?k(t,M):k(t)};if(A)g=t.iterator;else if(E)g=t;else{if(!(v=u(t)))throw new f(o(t)+" is not iterable");if(a(v)){for(y=0,x=l(t);x>y;y++)if((w=P(t[y]))&&h(m,w))return w;return new p(!1)}g=c(t,v)}for(_=A?t.next:g.next;!(b=i(_,g)).done;){try{w=P(b.value)}catch(t){d(g,"throw",t)}if("object"==typeof w&&w&&h(m,w))return w}return new p(!1)}},2675:function(t,e,n){"use strict";n(6761),n(1510),n(7812),n(3110),n(9773)},2703:function(t,e,n){"use strict";var r=n(4576),i=n(9039),s=n(9504),o=n(655),a=n(3802).trim,l=n(7452),h=r.parseInt,c=r.Symbol,u=c&&c.iterator,d=/^[+-]?0x/i,f=s(d.exec),p=8!==h(l+"08")||22!==h(l+"0x16")||u&&!i((function(){h(Object(u))}));t.exports=p?function(t,e){var n=a(o(t));return h(n,e>>>0||(f(d,n)?16:10))}:h},2744:function(t,e,n){"use strict";var r=n(9039);t.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},2762:function(t,e,n){"use strict";var r=n(6518),i=n(3802).trim;r({target:"String",proto:!0,forced:n(706)("trim")},{trim:function(){return i(this)}})},2777:function(t,e,n){"use strict";var r=n(9565),i=n(34),s=n(757),o=n(5966),a=n(4270),l=n(8227),h=TypeError,c=l("toPrimitive");t.exports=function(t,e){if(!i(t)||s(t))return t;var n,l=o(t,c);if(l){if(void 0===e&&(e="default"),n=r(l,t,e),!i(n)||s(n))return n;throw new h("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},2787:function(t,e,n){"use strict";var r=n(9297),i=n(4901),s=n(8981),o=n(6119),a=n(2211),l=o("IE_PROTO"),h=Object,c=h.prototype;t.exports=a?h.getPrototypeOf:function(t){var e=s(t);if(r(e,l))return e[l];var n=e.constructor;return i(n)&&e instanceof n?n.prototype:e instanceof h?c:null}},2796:function(t,e,n){"use strict";var r=n(9039),i=n(4901),s=/#|\.prototype\./,o=function(t,e){var n=l[a(t)];return n===c||n!==h&&(i(e)?r(e):!!e)},a=o.normalize=function(t){return String(t).replace(s,".").toLowerCase()},l=o.data={},h=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},2812:function(t){"use strict";var e=TypeError;t.exports=function(t,n){if(t<n)throw new e("Not enough arguments");return t}},2839:function(t,e,n){"use strict";var r=n(4576).navigator,i=r&&r.userAgent;t.exports=i?String(i):""},2892:function(t,e,n){"use strict";var r=n(788),i=TypeError;t.exports=function(t){if(r(t))throw new i("The method doesn't accept regular expressions");return t}},2953:function(t,e,n){"use strict";var r=n(4576),i=n(7400),s=n(9296),o=n(3792),a=n(6699),l=n(687),h=n(8227)("iterator"),c=o.values,u=function(t,e){if(t){if(t[h]!==c)try{a(t,h,c)}catch(e){t[h]=c}if(l(t,e,!0),i[e])for(var n in o)if(t[n]!==o[n])try{a(t,n,o[n])}catch(e){t[n]=o[n]}}};for(var d in i)u(r[d]&&r[d].prototype,d);u(s,"DOMTokenList")},2967:function(t,e,n){"use strict";var r=n(6706),i=n(34),s=n(7750),o=n(3506);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=r(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return s(n),o(r),i(n)?(e?t(n,r):n.__proto__=r,n):n}}():void 0)},3036:function(t){"use strict";var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch(t){e=!1}t.exports=e},3063:function(t,e,n){"use strict";var r=n(2839);t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},3093:function(t,e,n){"use strict";var r=n(4459);t.exports=function(t){return r(t)||0===t?t:t<0?-1:1}},3110:function(t,e,n){"use strict";var r=n(6518),i=n(7751),s=n(8745),o=n(9565),a=n(9504),l=n(9039),h=n(4901),c=n(757),u=n(7680),d=n(6933),f=n(4495),p=String,m=i("JSON","stringify"),g=a(/./.exec),v=a("".charAt),y=a("".charCodeAt),x=a("".replace),w=a(1..toString),_=/[\uD800-\uDFFF]/g,b=/^[\uD800-\uDBFF]$/,T=/^[\uDC00-\uDFFF]$/,S=!f||l((function(){var t=i("Symbol")("stringify detection");return"[null]"!==m([t])||"{}"!==m({a:t})||"{}"!==m(Object(t))})),A=l((function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")})),E=function(t,e){var n=u(arguments),r=d(e);if(h(r)||void 0!==t&&!c(t))return n[1]=function(t,e){if(h(r)&&(e=o(r,this,p(t),e)),!c(e))return e},s(m,null,n)},C=function(t,e,n){var r=v(n,e-1),i=v(n,e+1);return g(b,t)&&!g(T,i)||g(T,t)&&!g(b,r)?"\\u"+w(y(t,0),16):t};m&&r({target:"JSON",stat:!0,arity:3,forced:S||A},{stringify:function(t,e,n){var r=u(arguments),i=s(S?E:m,null,r);return A&&"string"==typeof i?x(i,_,C):i}})},3126:function(t,e,n){"use strict";var r=n(6743),i=n(9675),s=n(76),o=n(3144);t.exports=function(t){if(t.length<1||"function"!=typeof t[0])throw new i("a function is required");return o(r,s,t)}},3138:function(t){"use strict";t.exports=function(t,e){try{1===arguments.length?console.error(t):console.error(t,e)}catch(t){}}},3144:function(t,e,n){"use strict";var r=n(6743),i=n(1002),s=n(76),o=n(7119);t.exports=o||r.call(s,i)},3167:function(t,e,n){"use strict";var r=n(4901),i=n(34),s=n(2967);t.exports=function(t,e,n){var o,a;return s&&r(o=e.constructor)&&o!==n&&i(a=o.prototype)&&a!==n.prototype&&s(t,a),t}},3179:function(t,e,n){"use strict";var r=n(2140),i=n(6955);t.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},3296:function(t,e,n){"use strict";n(5806)},3362:function(t,e,n){"use strict";n(436),n(6499),n(2003),n(7743),n(1481),n(280)},3365:function(t,e,n){"use strict";var r=n(9565),i=n(9228),s=n(8551),o=n(4117),a=n(7750),l=n(3470),h=n(655),c=n(5966),u=n(6682);i("search",(function(t,e,n){return[function(e){var n=a(this),i=o(e)?void 0:c(e,t);return i?r(i,e,n):new RegExp(e)[t](h(n))},function(t){var r=s(this),i=h(t),o=n(e,r,i);if(o.done)return o.value;var a=r.lastIndex;l(a,0)||(r.lastIndex=0);var c=u(r,i);return l(r.lastIndex,a)||(r.lastIndex=a),null===c?-1:c.index}]}))},3389:function(t,e,n){"use strict";var r=n(4576),i=n(3724),s=Object.getOwnPropertyDescriptor;t.exports=function(t){if(!i)return r[t];var e=s(r,t);return e&&e.value}},3392:function(t,e,n){"use strict";var r=n(9504),i=0,s=Math.random(),o=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+o(++i+s,36)}},3418:function(t,e,n){"use strict";var r=n(6518),i=n(7916);r({target:"Array",stat:!0,forced:!n(4428)((function(t){Array.from(t)}))},{from:i})},3438:function(t,e,n){"use strict";var r=n(8551),i=n(34),s=n(6043);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=s.f(t);return(0,n.resolve)(e),n.promise}},3451:function(t,e,n){"use strict";var r=n(6518),i=n(9504),s=n(421),o=n(34),a=n(9297),l=n(4913).f,h=n(8480),c=n(298),u=n(4124),d=n(3392),f=n(2744),p=!1,m=d("meta"),g=0,v=function(t){l(t,m,{value:{objectID:"O"+g++,weakData:{}}})},y=t.exports={enable:function(){y.enable=function(){},p=!0;var t=h.f,e=i([].splice),n={};n[m]=1,t(n).length&&(h.f=function(n){for(var r=t(n),i=0,s=r.length;i<s;i++)if(r[i]===m){e(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:c.f}))},fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,m)){if(!u(t))return"F";if(!e)return"E";v(t)}return t[m].objectID},getWeakData:function(t,e){if(!a(t,m)){if(!u(t))return!0;if(!e)return!1;v(t)}return t[m].weakData},onFreeze:function(t){return f&&p&&u(t)&&!a(t,m)&&v(t),t}};s[m]=!0},3470:function(t){"use strict";t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},3500:function(t,e,n){"use strict";var r=n(4576),i=n(7400),s=n(9296),o=n(235),a=n(6699),l=function(t){if(t&&t.forEach!==o)try{a(t,"forEach",o)}catch(e){t.forEach=o}};for(var h in i)i[h]&&l(r[h]&&r[h].prototype);l(s)},3506:function(t,e,n){"use strict";var r=n(3925),i=String,s=TypeError;t.exports=function(t){if(r(t))return t;throw new s("Can't set "+i(t)+" as a prototype")}},3517:function(t,e,n){"use strict";var r=n(9504),i=n(9039),s=n(4901),o=n(6955),a=n(7751),l=n(3706),h=function(){},c=a("Reflect","construct"),u=/^\s*(?:class|function)\b/,d=r(u.exec),f=!u.test(h),p=function(t){if(!s(t))return!1;try{return c(h,[],t),!0}catch(t){return!1}},m=function(t){if(!s(t))return!1;switch(o(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!d(u,l(t))}catch(t){return!0}};m.sham=!0,t.exports=!c||i((function(){var t;return p(p.call)||!p(Object)||!p((function(){t=!0}))||t}))?m:p},3579:function(t,e,n){"use strict";var r=n(6518),i=n(2652),s=n(9306),o=n(8551),a=n(1767);r({target:"Iterator",proto:!0,real:!0},{some:function(t){o(this),s(t);var e=a(this),n=0;return i(e,(function(e,r){if(t(e,n++))return r()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3628:function(t,e,n){"use strict";var r=n(8648),i=n(1064),s=n(7176);t.exports=r?function(t){return r(t)}:i?function(t){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("getProto: not an object");return i(t)}:s?function(t){return s(t)}:null},3635:function(t,e,n){"use strict";var r=n(9039),i=n(4576).RegExp;t.exports=r((function(){var t=i(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)}))},3706:function(t,e,n){"use strict";var r=n(9504),i=n(4901),s=n(7629),o=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(t){return o(t)}),t.exports=s.inspectSource},3717:function(t,e){"use strict";e.f=Object.getOwnPropertySymbols},3724:function(t,e,n){"use strict";var r=n(9039);t.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},3738:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},3771:function(t,e,n){"use strict";var r=n(6518),i=n(4373),s=n(6469);r({target:"Array",proto:!0},{fill:i}),s("fill")},3772:function(t,e,n){"use strict";n(5746)},3792:function(t,e,n){"use strict";var r=n(5397),i=n(6469),s=n(6269),o=n(1181),a=n(4913).f,l=n(1088),h=n(2529),c=n(6395),u=n(3724),d="Array Iterator",f=o.set,p=o.getterFor(d);t.exports=l(Array,"Array",(function(t,e){f(this,{type:d,target:r(t),index:0,kind:e})}),(function(){var t=p(this),e=t.target,n=t.index++;if(!e||n>=e.length)return t.target=null,h(void 0,!0);switch(t.kind){case"keys":return h(n,!1);case"values":return h(e[n],!1)}return h([n,e[n]],!1)}),"values");var m=s.Arguments=s.Array;if(i("keys"),i("values"),i("entries"),!c&&u&&"values"!==m.name)try{a(m,"name",{value:"values"})}catch(t){}},3802:function(t,e,n){"use strict";var r=n(9504),i=n(7750),s=n(655),o=n(7452),a=r("".replace),l=RegExp("^["+o+"]+"),h=RegExp("(^|[^"+o+"])["+o+"]+$"),c=function(t){return function(e){var n=s(i(e));return 1&t&&(n=a(n,l,"")),2&t&&(n=a(n,h,"$1")),n}};t.exports={start:c(1),end:c(2),trim:c(3)}},3851:function(t,e,n){"use strict";var r=n(6518),i=n(9039),s=n(5397),o=n(7347).f,a=n(3724);r({target:"Object",stat:!0,forced:!a||i((function(){o(1)})),sham:!a},{getOwnPropertyDescriptor:function(t,e){return o(s(t),e)}})},3921:function(t,e,n){"use strict";var r=n(6518),i=n(2652),s=n(4659);r({target:"Object",stat:!0},{fromEntries:function(t){var e={};return i(t,(function(t,n){s(e,t,n)}),{AS_ENTRIES:!0}),e}})},3925:function(t,e,n){"use strict";var r=n(34);t.exports=function(t){return r(t)||null===t}},3949:function(t,e,n){"use strict";n(7588)},3994:function(t,e,n){"use strict";var r=n(7657).IteratorPrototype,i=n(2360),s=n(6980),o=n(687),a=n(6269),l=function(){return this};t.exports=function(t,e,n,h){var c=e+" Iterator";return t.prototype=i(r,{next:s(+!h,n)}),o(t,c,!1,!0),a[c]=l,t}},4006:function(t,e,n){"use strict";var r=n(9504),i=n(6279),s=n(3451).getWeakData,o=n(679),a=n(8551),l=n(4117),h=n(34),c=n(2652),u=n(9213),d=n(9297),f=n(1181),p=f.set,m=f.getterFor,g=u.find,v=u.findIndex,y=r([].splice),x=0,w=function(t){return t.frozen||(t.frozen=new _)},_=function(){this.entries=[]},b=function(t,e){return g(t.entries,(function(t){return t[0]===e}))};_.prototype={get:function(t){var e=b(this,t);if(e)return e[1]},has:function(t){return!!b(this,t)},set:function(t,e){var n=b(this,t);n?n[1]=e:this.entries.push([t,e])},delete:function(t){var e=v(this.entries,(function(e){return e[0]===t}));return~e&&y(this.entries,e,1),!!~e}},t.exports={getConstructor:function(t,e,n,r){var u=t((function(t,i){o(t,f),p(t,{type:e,id:x++,frozen:null}),l(i)||c(i,t[r],{that:t,AS_ENTRIES:n})})),f=u.prototype,g=m(e),v=function(t,e,n){var r=g(t),i=s(a(e),!0);return!0===i?w(r).set(e,n):i[r.id]=n,t};return i(f,{delete:function(t){var e=g(this);if(!h(t))return!1;var n=s(t);return!0===n?w(e).delete(t):n&&d(n,e.id)&&delete n[e.id]},has:function(t){var e=g(this);if(!h(t))return!1;var n=s(t);return!0===n?w(e).has(t):n&&d(n,e.id)}}),i(f,n?{get:function(t){var e=g(this);if(h(t)){var n=s(t);if(!0===n)return w(e).get(t);if(n)return n[e.id]}},set:function(t,e){return v(this,t,e)}}:{add:function(t){return v(this,t,!0)}}),u}}},4039:function(t,e,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,i=n(1333);t.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&i()}},4055:function(t,e,n){"use strict";var r=n(4576),i=n(34),s=r.document,o=i(s)&&i(s.createElement);t.exports=function(t){return o?s.createElement(t):{}}},4117:function(t){"use strict";t.exports=function(t){return null==t}},4124:function(t,e,n){"use strict";var r=n(9039),i=n(34),s=n(2195),o=n(5652),a=Object.isExtensible,l=r((function(){a(1)}));t.exports=l||o?function(t){return!!i(t)&&(!o||"ArrayBuffer"!==s(t))&&(!a||a(t))}:a},4196:function(t,e,n){var r;!function(){"use strict";var i=function(){this.init()};i.prototype={init:function(){var t=this||s;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||s;if(t=parseFloat(t),e.ctx||f(),void 0!==t&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,s.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var r=e._howls[n]._getSoundIds(),i=0;i<r.length;i++){var o=e._howls[n]._soundById(r[i]);o&&o._node&&(o._node.volume=o._volume*t)}return e}return e._volume},mute:function(t){var e=this||s;e.ctx||f(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,s.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var r=e._howls[n]._getSoundIds(),i=0;i<r.length;i++){var o=e._howls[n]._soundById(r[i]);o&&o._node&&(o._node.muted=!!t||o._muted)}return e},stop:function(){for(var t=this||s,e=0;e<t._howls.length;e++)t._howls[e].stop();return t},unload:function(){for(var t=this||s,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,f()),t},codecs:function(t){return(this||s)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||s;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||s,e=null;try{e="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!e||"function"!=typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),r=t._navigator?t._navigator.userAgent:"",i=r.match(/OPR\/(\d+)/g),o=i&&parseInt(i[0].split("/")[1],10)<33,a=-1!==r.indexOf("Safari")&&-1===r.indexOf("Chrome"),l=r.match(/Version\/(.*?) /),h=a&&l&&parseInt(l[1],10)<15;return t._codecs={mp3:!(o||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(e.canPlayType('audio/wav; codecs="1"')||e.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(e.canPlayType("audio/x-m4b;")||e.canPlayType("audio/m4b;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(h||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(h||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||s;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var e=function(n){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,t._releaseHtml5Audio(r)}catch(n){t.noAudio=!0;break}for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var s=t._howls[i]._getSoundIds(),o=0;o<s.length;o++){var a=t._howls[i]._soundById(s[o]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}t._autoResume();var l=t.ctx.createBufferSource();l.buffer=t._scratchBuffer,l.connect(t.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),l.onended=function(){l.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0),document.removeEventListener("keydown",e,!0);for(var n=0;n<t._howls.length;n++)t._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),document.addEventListener("keydown",e,!0),t}},_obtainHtml5Audio:function(){var t=this||s;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(new Audio).play();return e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var e=this||s;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&s.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&s.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var s=new i,o=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};o.prototype={init:function(t){var e=this;return s.ctx||f(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=s.usingWebAudio&&!e._html5,void 0!==s.ctx&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&"none"!==e._preload&&e.load(),e},load:function(){var t=this,e=null;if(s.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var n=0;n<t._src.length;n++){var r,i;if(t._format&&t._format[n])r=t._format[n];else{if("string"!=typeof(i=t._src[n])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(i))||(r=/\.([^.]+)$/.exec(i.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&s.codecs(r)){e=t._src[n];break}}if(e)return t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new a(t),t._webAudio&&h(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,e){var n=this,r=null;if("number"==typeof t)r=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(void 0===t&&(t="__default",!n._playLock)){for(var i=0,o=0;o<n._sounds.length;o++)n._sounds[o]._paused&&!n._sounds[o]._ended&&(i++,r=n._sounds[o]._id);1===i?t=null:r=null}}var a=r?n._soundById(r):n._inactiveSound();if(!a)return null;if(r&&!t&&(t=a._sprite||"__default"),"loaded"!==n._state){a._sprite=t,a._ended=!1;var l=a._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(r&&!a._paused)return e||n._loadQueue("play"),a._id;n._webAudio&&s._autoResume();var h=Math.max(0,a._seek>0?a._seek:n._sprite[t][0]/1e3),c=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-h),u=1e3*c/Math.abs(a._rate),d=n._sprite[t][0]/1e3,f=(n._sprite[t][0]+n._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;var p=function(){a._paused=!1,a._seek=h,a._start=d,a._stop=f,a._loop=!(!a._loop&&!n._sprite[t][2])};if(!(h>=f)){var m=a._node;if(n._webAudio){var g=function(){n._playLock=!1,p(),n._refreshBuffer(a);var t=a._muted||n._muted?0:a._volume;m.gain.setValueAtTime(t,s.ctx.currentTime),a._playStart=s.ctx.currentTime,void 0===m.bufferSource.start?a._loop?m.bufferSource.noteGrainOn(0,h,86400):m.bufferSource.noteGrainOn(0,h,c):a._loop?m.bufferSource.start(0,h,86400):m.bufferSource.start(0,h,c),u!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),u)),e||setTimeout((function(){n._emit("play",a._id),n._loadQueue()}),0)};"running"===s.state&&"interrupted"!==s.ctx.state?g():(n._playLock=!0,n.once("resume",g),n._clearTimer(a._id))}else{var v=function(){m.currentTime=h,m.muted=a._muted||n._muted||s._muted||m.muted,m.volume=a._volume*s.volume(),m.playbackRate=a._rate;try{var r=m.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(n._playLock=!0,p(),r.then((function(){n._playLock=!1,m._unlocked=!0,e?n._loadQueue():n._emit("play",a._id)})).catch((function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):e||(n._playLock=!1,p(),n._emit("play",a._id)),m.playbackRate=a._rate,m.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),u):(n._endTimers[a._id]=function(){n._ended(a),m.removeEventListener("ended",n._endTimers[a._id],!1)},m.addEventListener("ended",n._endTimers[a._id],!1))}catch(t){n._emit("playerror",a._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=n._src,m.load());var y=window&&window.ejecta||!m.readyState&&s._navigator.isCocoonJS;if(m.readyState>=3||y)v();else{n._playLock=!0,n._state="loading";var x=function(){n._state="loaded",v(),m.removeEventListener(s._canPlayEvent,x,!1)};m.addEventListener(s._canPlayEvent,x,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),r=0;r<n.length;r++){e._clearTimer(n[r]);var i=e._soundById(n[r]);if(i&&!i._paused&&(i._seek=e.seek(n[r]),i._rateSeek=0,i._paused=!0,e._stopFade(n[r]),i._node))if(e._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),e._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||e._emit("pause",i?i._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var r=n._getSoundIds(t),i=0;i<r.length;i++){n._clearTimer(r[i]);var s=n._soundById(r[i]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,n._stopFade(r[i]),s._node&&(n._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),n._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&n._clearSound(s._node))),e||n._emit("stop",s._id))}return n},mute:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,e)}}),n;if(void 0===e){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var r=n._getSoundIds(e),i=0;i<r.length;i++){var o=n._soundById(r[i]);o&&(o._muted=t,o._interval&&n._stopFade(o._id),n._webAudio&&o._node?o._node.gain.setValueAtTime(t?0:o._volume,s.ctx.currentTime):o._node&&(o._node.muted=!!s._muted||t),n._emit("mute",o._id))}return n},volume:function(){var t,e,n,r=this,i=arguments;if(0===i.length)return r._volume;if(1===i.length||2===i.length&&void 0===i[1]?r._getSoundIds().indexOf(i[0])>=0?e=parseInt(i[0],10):t=parseFloat(i[0]):i.length>=2&&(t=parseFloat(i[0]),e=parseInt(i[1],10)),!(void 0!==t&&t>=0&&t<=1))return(n=e?r._soundById(e):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,i)}}),r;void 0===e&&(r._volume=t),e=r._getSoundIds(e);for(var o=0;o<e.length;o++)(n=r._soundById(e[o]))&&(n._volume=t,i[2]||r._stopFade(e[o]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,s.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*s.volume()),r._emit("volume",n._id));return r},fade:function(t,e,n,r){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"fade",action:function(){i.fade(t,e,n,r)}}),i;t=Math.min(Math.max(0,parseFloat(t)),1),e=Math.min(Math.max(0,parseFloat(e)),1),n=parseFloat(n),i.volume(t,r);for(var o=i._getSoundIds(r),a=0;a<o.length;a++){var l=i._soundById(o[a]);if(l){if(r||i._stopFade(o[a]),i._webAudio&&!l._muted){var h=s.ctx.currentTime,c=h+n/1e3;l._volume=t,l._node.gain.setValueAtTime(t,h),l._node.gain.linearRampToValueAtTime(e,c)}i._startFadeInterval(l,t,e,n,o[a],void 0===r)}}return i},_startFadeInterval:function(t,e,n,r,i,s){var o=this,a=e,l=n-e,h=Math.abs(l/.01),c=Math.max(4,h>0?r/h:r),u=Date.now();t._fadeTo=n,t._interval=setInterval((function(){var i=(Date.now()-u)/r;u=Date.now(),a+=l*i,a=Math.round(100*a)/100,a=l<0?Math.max(n,a):Math.min(n,a),o._webAudio?t._volume=a:o.volume(a,t._id,!0),s&&(o._volume=a),(n<e&&a<=n||n>e&&a>=n)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,o.volume(n,t._id),o._emit("fade",t._id))}),c)},_stopFade:function(t){var e=this,n=e._soundById(t);return n&&n._interval&&(e._webAudio&&n._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(n._interval),n._interval=null,e.volume(n._fadeTo,t),n._fadeTo=null,e._emit("fade",t)),e},loop:function(){var t,e,n,r=this,i=arguments;if(0===i.length)return r._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(n=r._soundById(parseInt(i[0],10)))&&n._loop;t=i[0],r._loop=t}else 2===i.length&&(t=i[0],e=parseInt(i[1],10));for(var s=r._getSoundIds(e),o=0;o<s.length;o++)(n=r._soundById(s[o]))&&(n._loop=t,r._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,r.playing(s[o])&&(r.pause(s[o],!0),r.play(s[o],!0)))));return r},rate:function(){var t,e,n,r=this,i=arguments;if(0===i.length?e=r._sounds[0]._id:1===i.length?r._getSoundIds().indexOf(i[0])>=0?e=parseInt(i[0],10):t=parseFloat(i[0]):2===i.length&&(t=parseFloat(i[0]),e=parseInt(i[1],10)),"number"!=typeof t)return(n=r._soundById(e))?n._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,i)}}),r;void 0===e&&(r._rate=t),e=r._getSoundIds(e);for(var o=0;o<e.length;o++)if(n=r._soundById(e[o])){r.playing(e[o])&&(n._rateSeek=r.seek(e[o]),n._playStart=r._webAudio?s.ctx.currentTime:n._playStart),n._rate=t,r._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,s.ctx.currentTime):n._node&&(n._node.playbackRate=t);var a=r.seek(e[o]),l=1e3*((r._sprite[n._sprite][0]+r._sprite[n._sprite][1])/1e3-a)/Math.abs(n._rate);!r._endTimers[e[o]]&&n._paused||(r._clearTimer(e[o]),r._endTimers[e[o]]=setTimeout(r._ended.bind(r,n),l)),r._emit("rate",n._id)}return r},seek:function(){var t,e,n=this,r=arguments;if(0===r.length?n._sounds.length&&(e=n._sounds[0]._id):1===r.length?n._getSoundIds().indexOf(r[0])>=0?e=parseInt(r[0],10):n._sounds.length&&(e=n._sounds[0]._id,t=parseFloat(r[0])):2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10)),void 0===e)return 0;if("number"==typeof t&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}}),n;var i=n._soundById(e);if(i){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var o=n.playing(e)?s.ctx.currentTime-i._playStart:0,a=i._rateSeek?i._rateSeek-i._seek:0;return i._seek+(a+o*Math.abs(i._rate))}return i._node.currentTime}var l=n.playing(e);l&&n.pause(e,!0),i._seek=t,i._ended=!1,n._clearTimer(e),n._webAudio||!i._node||isNaN(i._node.duration)||(i._node.currentTime=t);var h=function(){l&&n.play(e,!0),n._emit("seek",e)};if(l&&!n._webAudio){var c=function(){n._playLock?setTimeout(c,0):h()};setTimeout(c,0)}else h()}return n},playing:function(t){var e=this;if("number"==typeof t){var n=e._soundById(t);return!!n&&!n._paused}for(var r=0;r<e._sounds.length;r++)if(!e._sounds[r]._paused)return!0;return!1},duration:function(t){var e=this,n=e._duration,r=e._soundById(t);return r&&(n=e._sprite[r._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,n=0;n<e.length;n++)e[n]._paused||t.stop(e[n]._id),t._webAudio||(t._clearSound(e[n]._node),e[n]._node.removeEventListener("error",e[n]._errorFn,!1),e[n]._node.removeEventListener(s._canPlayEvent,e[n]._loadFn,!1),e[n]._node.removeEventListener("ended",e[n]._endFn,!1),s._releaseHtml5Audio(e[n]._node)),delete e[n]._node,t._clearTimer(e[n]._id);var r=s._howls.indexOf(t);r>=0&&s._howls.splice(r,1);var i=!0;for(n=0;n<s._howls.length;n++)if(s._howls[n]._src===t._src||t._src.indexOf(s._howls[n]._src)>=0){i=!1;break}return l&&i&&delete l[t._src],s.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,r){var i=this["_on"+t];return"function"==typeof e&&i.push(r?{id:n,fn:e,once:r}:{id:n,fn:e}),this},off:function(t,e,n){var r=this,i=r["_on"+t],s=0;if("number"==typeof e&&(n=e,e=null),e||n)for(s=0;s<i.length;s++){var o=n===i[s].id;if(e===i[s].fn&&o||!e&&o){i.splice(s,1);break}}else if(t)r["_on"+t]=[];else{var a=Object.keys(r);for(s=0;s<a.length;s++)0===a[s].indexOf("_on")&&Array.isArray(r[a[s]])&&(r[a[s]]=[])}return r},once:function(t,e,n){return this.on(t,e,n,1),this},_emit:function(t,e,n){for(var r=this,i=r["_on"+t],s=i.length-1;s>=0;s--)i[s].id&&i[s].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(r,i[s].fn),0),i[s].once&&r.off(t,i[s].fn,i[s].id));return r._loadQueue(t),r},_loadQueue:function(t){var e=this;if(e._queue.length>0){var n=e._queue[0];n.event===t&&(e._queue.shift(),e._loadQueue()),t||n.action()}return e},_ended:function(t){var e=this,n=t._sprite;if(!e._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(e._ended.bind(e,t),100),e;var r=!(!t._loop&&!e._sprite[n][2]);if(e._emit("end",t._id),!e._webAudio&&r&&e.stop(t._id,!0).play(t._id),e._webAudio&&r){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=s.ctx.currentTime;var i=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),i)}return e._webAudio&&!r&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),s._autoSuspend()),e._webAudio||r||e.stop(t._id,!0),e},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var n=e._soundById(t);n&&n._node&&n._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,n=0;n<e._sounds.length;n++)if(t===e._sounds[n]._id)return e._sounds[n];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new a(t)},_drain:function(){var t=this,e=t._pool,n=0,r=0;if(!(t._sounds.length<e)){for(r=0;r<t._sounds.length;r++)t._sounds[r]._ended&&n++;for(r=t._sounds.length-1;r>=0;r--){if(n<=e)return;t._sounds[r]._ended&&(t._webAudio&&t._sounds[r]._node&&t._sounds[r]._node.disconnect(0),t._sounds.splice(r,1),n--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],n=0;n<this._sounds.length;n++)e.push(this._sounds[n]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=s.ctx.createBufferSource(),t._node.bufferSource.buffer=l[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,s.ctx.currentTime),this},_cleanBuffer:function(t){var e=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(!t.bufferSource)return this;if(s._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=s._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(t){this._parent=t,this.init()};a.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++s._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,n=s._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),t._node.gain.setValueAtTime(n,s.ctx.currentTime),t._node.paused=!0,t._node.connect(s.masterGain)):s.noAudio||(t._node=s._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(s._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=e._src,t._node.preload=!0===e._preload?"auto":e._preload,t._node.volume=n*s.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++s._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,e=t._parent;e._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),t._node.removeEventListener(s._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,e=t._parent;e._duration===1/0&&(e._duration=Math.ceil(10*t._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var l={},h=function(t){var e=t._src;if(l[e])return t._duration=l[e].duration,void d(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);u(r.buffer,t)}else{var s=new XMLHttpRequest;s.open(t._xhr.method,e,!0),s.withCredentials=t._xhr.withCredentials,s.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach((function(e){s.setRequestHeader(e,t._xhr.headers[e])})),s.onload=function(){var e=(s.status+"")[0];"0"===e||"2"===e||"3"===e?u(s.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete l[e],t.load())},c(s)}},c=function(t){try{t.send()}catch(e){t.onerror()}},u=function(t,e){var n=function(){e._emit("loaderror",null,"Decoding audio data failed.")},r=function(t){t&&e._sounds.length>0?(l[e._src]=t,d(e,t)):n()};"undefined"!=typeof Promise&&1===s.ctx.decodeAudioData.length?s.ctx.decodeAudioData(t).then(r).catch(n):s.ctx.decodeAudioData(t,r,n)},d=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},f=function(){if(s.usingWebAudio){try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(t){s.usingWebAudio=!1}s.ctx||(s.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),e=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=e?parseInt(e[1],10):null;if(t&&n&&n<9){var r=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!r&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}};void 0===(r=function(){return{Howler:s,Howl:o}}.apply(e,[]))||(t.exports=r),e.Howler=s,e.Howl=o,void 0!==n.g?(n.g.HowlerGlobal=i,n.g.Howler=s,n.g.Howl=o,n.g.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=i,window.Howler=s,window.Howl=o,window.Sound=a)}(),function(){"use strict";var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var n=e._howls.length-1;n>=0;n--)e._howls[n].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,n){var r=this;return r.ctx&&r.ctx.listener?(e="number"!=typeof e?r._pos[1]:e,n="number"!=typeof n?r._pos[2]:n,"number"!=typeof t?r._pos:(r._pos=[t,e,n],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(t,e,n,r,i,s){var o=this;if(!o.ctx||!o.ctx.listener)return o;var a=o._orientation;return e="number"!=typeof e?a[1]:e,n="number"!=typeof n?a[2]:n,r="number"!=typeof r?a[3]:r,i="number"!=typeof i?a[4]:i,s="number"!=typeof s?a[5]:s,"number"!=typeof t?a:(o._orientation=[t,e,n,r,i,s],void 0!==o.ctx.listener.forwardX?(o.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):o.ctx.listener.setOrientation(t,e,n,r,i,s),o)},Howl.prototype.init=(t=Howl.prototype.init,function(e){var n=this;return n._orientation=e.orientation||[1,0,0],n._stereo=e.stereo||null,n._pos=e.pos||null,n._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},n._onstereo=e.onstereo?[{fn:e.onstereo}]:[],n._onpos=e.onpos?[{fn:e.onpos}]:[],n._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,n){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(t,n)}}),r;var i=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return r._stereo;r._stereo=t,r._pos=[t,0,0]}for(var s=r._getSoundIds(n),o=0;o<s.length;o++){var a=r._soundById(s[o]);if(a){if("number"!=typeof t)return a._stereo;a._stereo=t,a._pos=[t,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||e(a,i),"spatial"===i?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(t,0,0):a._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit("stereo",a._id)}}return r},Howl.prototype.pos=function(t,n,r,i){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"pos",action:function(){s.pos(t,n,r,i)}}),s;if(n="number"!=typeof n?0:n,r="number"!=typeof r?-.5:r,void 0===i){if("number"!=typeof t)return s._pos;s._pos=[t,n,r]}for(var o=s._getSoundIds(i),a=0;a<o.length;a++){var l=s._soundById(o[a]);if(l){if("number"!=typeof t)return l._pos;l._pos=[t,n,r],l._node&&(l._panner&&!l._panner.pan||e(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setPosition(t,n,r)),s._emit("pos",l._id)}}return s},Howl.prototype.orientation=function(t,n,r,i){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"orientation",action:function(){s.orientation(t,n,r,i)}}),s;if(n="number"!=typeof n?s._orientation[1]:n,r="number"!=typeof r?s._orientation[2]:r,void 0===i){if("number"!=typeof t)return s._orientation;s._orientation=[t,n,r]}for(var o=s._getSoundIds(i),a=0;a<o.length;a++){var l=s._soundById(o[a]);if(l){if("number"!=typeof t)return l._orientation;l._orientation=[t,n,r],l._node&&(l._panner||(l._pos||(l._pos=s._pos||[0,0,-.5]),e(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setOrientation(t,n,r)),s._emit("orientation",l._id)}}return s},Howl.prototype.pannerAttr=function(){var t,n,r,i=this,s=arguments;if(!i._webAudio)return i;if(0===s.length)return i._pannerAttr;if(1===s.length){if("object"!=typeof s[0])return(r=i._soundById(parseInt(s[0],10)))?r._pannerAttr:i._pannerAttr;t=s[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),i._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:i._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:i._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:i._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:i._panningModel})}else 2===s.length&&(t=s[0],n=parseInt(s[1],10));for(var o=i._getSoundIds(n),a=0;a<o.length;a++)if(r=i._soundById(o[a])){var l=r._pannerAttr;l={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:l.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:l.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:l.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:l.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:l.panningModel};var h=r._panner;h||(r._pos||(r._pos=i._pos||[0,0,-.5]),e(r,"spatial"),h=r._panner),h.coneInnerAngle=l.coneInnerAngle,h.coneOuterAngle=l.coneOuterAngle,h.coneOuterGain=l.coneOuterGain,h.distanceModel=l.distanceModel,h.maxDistance=l.maxDistance,h.refDistance=l.refDistance,h.rolloffFactor=l.rolloffFactor,h.panningModel=l.panningModel}return i},Sound.prototype.init=function(t){return function(){var e=this,n=e._parent;e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this),e._stereo?n.stereo(e._stereo):e._pos&&n.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,n=e._parent;return e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,e._stereo?n.stereo(e._stereo):e._pos?n.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,n._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}()},4209:function(t,e,n){"use strict";var r=n(8227),i=n(6269),s=r("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[s]===t)}},4213:function(t,e,n){"use strict";var r=n(3724),i=n(9504),s=n(9565),o=n(9039),a=n(1072),l=n(3717),h=n(8773),c=n(8981),u=n(7055),d=Object.assign,f=Object.defineProperty,p=i([].concat);t.exports=!d||o((function(){if(r&&1!==d({b:1},d(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol("assign detection"),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach((function(t){e[t]=t})),7!==d({},t)[n]||a(d({},e)).join("")!==i}))?function(t,e){for(var n=c(t),i=arguments.length,o=1,d=l.f,f=h.f;i>o;)for(var m,g=u(arguments[o++]),v=d?p(a(g),d(g)):a(g),y=v.length,x=0;y>x;)m=v[x++],r&&!s(f,g,m)||(n[m]=g[m]);return n}:d},4215:function(t,e,n){"use strict";var r=n(4576),i=n(2839),s=n(2195),o=function(t){return i.slice(0,t.length)===t};t.exports=o("Bun/")?"BUN":o("Cloudflare-Workers")?"CLOUDFLARE":o("Deno/")?"DENO":o("Node.js/")?"NODE":r.Bun&&"string"==typeof Bun.version?"BUN":r.Deno&&"object"==typeof Deno.version?"DENO":"process"===s(r.process)?"NODE":r.window&&r.document?"BROWSER":"REST"},4265:function(t,e,n){"use strict";var r=n(2839);t.exports=/ipad|iphone|ipod/i.test(r)&&"undefined"!=typeof Pebble},4270:function(t,e,n){"use strict";var r=n(9565),i=n(4901),s=n(34),o=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&i(n=t.toString)&&!s(a=r(n,t)))return a;if(i(n=t.valueOf)&&!s(a=r(n,t)))return a;if("string"!==e&&i(n=t.toString)&&!s(a=r(n,t)))return a;throw new o("Can't convert object to primitive value")}},4373:function(t,e,n){"use strict";var r=n(8981),i=n(5610),s=n(6198);t.exports=function(t){for(var e=r(this),n=s(e),o=arguments.length,a=i(o>1?arguments[1]:void 0,n),l=o>2?arguments[2]:void 0,h=void 0===l?n:i(l,n);h>a;)e[a++]=t;return e}},4376:function(t,e,n){"use strict";var r=n(2195);t.exports=Array.isArray||function(t){return"Array"===r(t)}},4423:function(t,e,n){"use strict";var r=n(6518),i=n(9617).includes,s=n(9039),o=n(6469);r({target:"Array",proto:!0,forced:s((function(){return!Array(1).includes()}))},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},4428:function(t,e,n){"use strict";var r=n(8227)("iterator"),i=!1;try{var s=0,o={next:function(){return{done:!!s++}},return:function(){i=!0}};o[r]=function(){return this},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){try{if(!e&&!i)return!1}catch(t){return!1}var n=!1;try{var s={};s[r]=function(){return{next:function(){return{done:n=!0}}}},t(s)}catch(t){}return n}},4453:function(t,e,n){"use strict";var r=n(1354),i=n.n(r),s=n(6314),o=n.n(s)()(i());o.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]),e.A=o},4459:function(t){"use strict";t.exports=Number.isNaN||function(t){return t!=t}},4488:function(t,e,n){"use strict";var r=n(7680),i=Math.floor,s=function(t,e){var n=t.length;if(n<8)for(var o,a,l=1;l<n;){for(a=l,o=t[l];a&&e(t[a-1],o)>0;)t[a]=t[--a];a!==l++&&(t[a]=o)}else for(var h=i(n/2),c=s(r(t,0,h),e),u=s(r(t,h),e),d=c.length,f=u.length,p=0,m=0;p<d||m<f;)t[p+m]=p<d&&m<f?e(c[p],u[m])<=0?c[p++]:u[m++]:p<d?c[p++]:u[m++];return t};t.exports=s},4495:function(t,e,n){"use strict";var r=n(9519),i=n(9039),s=n(4576).String;t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol("symbol detection");return!s(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},4520:function(t,e,n){"use strict";n(2489)},4576:function(t,e,n){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4598:function(t,e,n){"use strict";var r=n(9039);t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){return 1},1)}))}},4601:function(t,e,n){"use strict";var r=n(7751),i=n(9297),s=n(6699),o=n(1625),a=n(2967),l=n(7740),h=n(1056),c=n(3167),u=n(2603),d=n(7584),f=n(747),p=n(3724),m=n(6395);t.exports=function(t,e,n,g){var v="stackTraceLimit",y=g?2:1,x=t.split("."),w=x[x.length-1],_=r.apply(null,x);if(_){var b=_.prototype;if(!m&&i(b,"cause")&&delete b.cause,!n)return _;var T=r("Error"),S=e((function(t,e){var n=u(g?e:t,void 0),r=g?new _(t):new _;return void 0!==n&&s(r,"message",n),f(r,S,r.stack,2),this&&o(b,this)&&c(r,this,S),arguments.length>y&&d(r,arguments[y]),r}));if(S.prototype=b,"Error"!==w?a?a(S,T):l(S,T,{name:!0}):p&&v in _&&(h(S,_,v),h(S,_,"prepareStackTrace")),l(S,_),!m)try{b.name!==w&&s(b,"name",w),b.constructor=S}catch(t){}return S}}},4633:function(t,e,n){var r=n(3738).default;function i(){"use strict";t.exports=i=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var e,n={},s=Object.prototype,o=s.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},l="function"==typeof Symbol?Symbol:{},h=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",u=l.toStringTag||"@@toStringTag";function d(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(e){d=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,s=Object.create(i.prototype),o=new O(r||[]);return a(s,"_invoke",{value:M(t,n,o)}),s}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=f;var m="suspendedStart",g="suspendedYield",v="executing",y="completed",x={};function w(){}function _(){}function b(){}var T={};d(T,h,(function(){return this}));var S=Object.getPrototypeOf,A=S&&S(S(L([])));A&&A!==s&&o.call(A,h)&&(T=A);var E=b.prototype=w.prototype=Object.create(T);function C(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,s,a,l){var h=p(t[i],t,s);if("throw"!==h.type){var c=h.arg,u=c.value;return u&&"object"==r(u)&&o.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,l)}),(function(t){n("throw",t,a,l)})):e.resolve(u).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,l)}))}l(h.arg)}var i;a(this,"_invoke",{value:function(t,r){function s(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(s,s):s()}})}function M(t,n,r){var i=m;return function(s,o){if(i===v)throw Error("Generator is already running");if(i===y){if("throw"===s)throw o;return{value:e,done:!0}}for(r.method=s,r.arg=o;;){var a=r.delegate;if(a){var l=P(a,r);if(l){if(l===x)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===m)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var h=p(t,n,r);if("normal"===h.type){if(i=r.done?y:g,h.arg===x)continue;return{value:h.arg,done:r.done}}"throw"===h.type&&(i=y,r.method="throw",r.arg=h.arg)}}}function P(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),x;var s=p(i,t.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,x;var o=s.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,x):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,x)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[h];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function n(){for(;++i<t.length;)if(o.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw new TypeError(r(t)+" is not iterable")}return _.prototype=b,a(E,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:_,configurable:!0}),_.displayName=d(b,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,d(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},n.awrap=function(t){return{__await:t}},C(k.prototype),d(k.prototype,c,(function(){return this})),n.AsyncIterator=k,n.async=function(t,e,r,i,s){void 0===s&&(s=Promise);var o=new k(f(t,e,r,i),s);return n.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},C(E),d(E,u,"Generator"),d(E,h,(function(){return this})),d(E,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=L,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=o.call(s,"catchLoc"),h=o.call(s,"finallyLoc");if(l&&h){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!h)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=t,s.arg=e,i?(this.method="next",this.next=i.finallyLoc,x):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),x},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),x}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),x}},n}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},4659:function(t,e,n){"use strict";var r=n(3724),i=n(4913),s=n(6980);t.exports=function(t,e,n){r?i.f(t,e,s(0,n)):t[e]=n}},4756:function(t,e,n){var r=n(4633)();t.exports=r;try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},4765:function(t){"use strict";var e=String.prototype.replace,n=/%20/g,r="RFC3986";t.exports={default:r,formatters:{RFC1738:function(t){return e.call(t,n,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:r}},4782:function(t,e,n){"use strict";var r=n(6518),i=n(4376),s=n(3517),o=n(34),a=n(5610),l=n(6198),h=n(5397),c=n(4659),u=n(8227),d=n(597),f=n(7680),p=d("slice"),m=u("species"),g=Array,v=Math.max;r({target:"Array",proto:!0,forced:!p},{slice:function(t,e){var n,r,u,d=h(this),p=l(d),y=a(t,p),x=a(void 0===e?p:e,p);if(i(d)&&(n=d.constructor,(s(n)&&(n===g||i(n.prototype))||o(n)&&null===(n=n[m]))&&(n=void 0),n===g||void 0===n))return f(d,y,x);for(r=new(void 0===n?g:n)(v(x-y,0)),u=0;y<x;y++,u++)y in d&&c(r,u,d[y]);return r.length=u,r}})},4803:function(t,e,n){"use strict";var r=n(8859),i=n(9675),s=function(t,e,n){for(var r,i=t;null!=(r=i.next);i=r)if(r.key===e)return i.next=r.next,n||(r.next=t.next,t.next=r),r};t.exports=function(){var t,e={assert:function(t){if(!e.has(t))throw new i("Side channel does not contain "+r(t))},delete:function(e){var n=t&&t.next,r=function(t,e){if(t)return s(t,e,!0)}(t,e);return r&&n&&n===r&&(t=void 0),!!r},get:function(e){return function(t,e){if(t){var n=s(t,e);return n&&n.value}}(t,e)},has:function(e){return function(t,e){return!!t&&!!s(t,e)}(t,e)},set:function(e,n){t||(t={next:void 0}),function(t,e,n){var r=s(t,e);r?r.value=n:t.next={key:e,next:t.next,value:n}}(t,e,n)}};return e}},4864:function(t,e,n){"use strict";var r=n(3724),i=n(4576),s=n(9504),o=n(2796),a=n(3167),l=n(6699),h=n(2360),c=n(8480).f,u=n(1625),d=n(788),f=n(655),p=n(1034),m=n(8429),g=n(1056),v=n(6840),y=n(9039),x=n(9297),w=n(1181).enforce,_=n(7633),b=n(8227),T=n(3635),S=n(8814),A=b("match"),E=i.RegExp,C=E.prototype,k=i.SyntaxError,M=s(C.exec),P=s("".charAt),I=s("".replace),R=s("".indexOf),O=s("".slice),L=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,D=/a/g,F=/a/g,N=new E(D)!==D,B=m.MISSED_STICKY,W=m.UNSUPPORTED_Y;if(o("RegExp",r&&(!N||B||T||S||y((function(){return F[A]=!1,E(D)!==D||E(F)===F||"/a/i"!==String(E(D,"i"))}))))){for(var U=function(t,e){var n,r,i,s,o,c,m=u(C,this),g=d(t),v=void 0===e,y=[],_=t;if(!m&&g&&v&&t.constructor===U)return t;if((g||u(C,t))&&(t=t.source,v&&(e=p(_))),t=void 0===t?"":f(t),e=void 0===e?"":f(e),_=t,T&&"dotAll"in D&&(r=!!e&&R(e,"s")>-1)&&(e=I(e,/s/g,"")),n=e,B&&"sticky"in D&&(i=!!e&&R(e,"y")>-1)&&W&&(e=I(e,/y/g,"")),S&&(s=function(t){for(var e,n=t.length,r=0,i="",s=[],o=h(null),a=!1,l=!1,c=0,u="";r<=n;r++){if("\\"===(e=P(t,r)))e+=P(t,++r);else if("]"===e)a=!1;else if(!a)switch(!0){case"["===e:a=!0;break;case"("===e:if(i+=e,"?:"===O(t,r+1,r+3))continue;M(L,O(t,r+1))&&(r+=2,l=!0),c++;continue;case">"===e&&l:if(""===u||x(o,u))throw new k("Invalid capture group name");o[u]=!0,s[s.length]=[u,c],l=!1,u="";continue}l?u+=e:i+=e}return[i,s]}(t),t=s[0],y=s[1]),o=a(E(t,e),m?this:C,U),(r||i||y.length)&&(c=w(o),r&&(c.dotAll=!0,c.raw=U(function(t){for(var e,n=t.length,r=0,i="",s=!1;r<=n;r++)"\\"!==(e=P(t,r))?s||"."!==e?("["===e?s=!0:"]"===e&&(s=!1),i+=e):i+="[\\s\\S]":i+=e+P(t,++r);return i}(t),n)),i&&(c.sticky=!0),y.length&&(c.groups=y)),t!==_)try{l(o,"source",""===_?"(?:)":_)}catch(t){}return o},j=c(E),H=0;j.length>H;)g(U,E,j[H++]);C.constructor=U,U.prototype=C,v(i,"RegExp",U,{constructor:!0})}_("RegExp")},4901:function(t){"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},4913:function(t,e,n){"use strict";var r=n(3724),i=n(5917),s=n(8686),o=n(8551),a=n(6969),l=TypeError,h=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u="enumerable",d="configurable",f="writable";e.f=r?s?function(t,e,n){if(o(t),e=a(e),o(n),"function"==typeof t&&"prototype"===e&&"value"in n&&f in n&&!n[f]){var r=c(t,e);r&&r[f]&&(t[e]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:u in n?n[u]:r[u],writable:!1})}return h(t,e,n)}:h:function(t,e,n){if(o(t),e=a(e),o(n),i)try{return h(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new l("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},5031:function(t,e,n){"use strict";var r=n(7751),i=n(9504),s=n(8480),o=n(3717),a=n(8551),l=i([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=s.f(a(t)),n=o.f;return n?l(e,n(t)):e}},5056:function(t,e,n){"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},5072:function(t){"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var s={},o=[],a=0;a<t.length;a++){var l=t[a],h=r.base?l[0]+r.base:l[0],c=s[h]||0,u="".concat(h," ").concat(c);s[h]=c+1;var d=n(u),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var p=i(f,r);r.byIndex=a,e.splice(a,0,{identifier:u,updater:p,references:1})}o.push(u)}return o}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var s=r(t=t||[],i=i||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--}for(var l=r(t,i),h=0;h<s.length;h++){var c=n(s[h]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}s=l}}},5240:function(t,e,n){"use strict";n(6468)("WeakSet",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n(4006))},5276:function(t,e,n){"use strict";var r=n(6518),i=n(7476),s=n(9617).indexOf,o=n(4598),a=i([].indexOf),l=!!a&&1/a([1],1,-0)<0;r({target:"Array",proto:!0,forced:l||!o("indexOf")},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return l?a(this,t,e)||0:s(this,t,e)}})},5345:function(t){"use strict";t.exports=URIError},5373:function(t,e,n){"use strict";var r=n(8636),i=n(2642),s=n(4765);t.exports={formats:s,parse:i,stringify:r}},5397:function(t,e,n){"use strict";var r=n(7055),i=n(7750);t.exports=function(t){return r(i(t))}},5440:function(t,e,n){"use strict";var r=n(8745),i=n(9565),s=n(9504),o=n(9228),a=n(9039),l=n(8551),h=n(4901),c=n(4117),u=n(1291),d=n(8014),f=n(655),p=n(7750),m=n(7829),g=n(5966),v=n(2478),y=n(6682),x=n(8227)("replace"),w=Math.max,_=Math.min,b=s([].concat),T=s([].push),S=s("".indexOf),A=s("".slice),E="$0"==="a".replace(/./,"$0"),C=!!/./[x]&&""===/./[x]("a","$0");o("replace",(function(t,e,n){var s=C?"$":"$0";return[function(t,n){var r=p(this),s=c(t)?void 0:g(t,x);return s?i(s,t,r,n):i(e,f(r),t,n)},function(t,i){var o=l(this),a=f(t);if("string"==typeof i&&-1===S(i,s)&&-1===S(i,"$<")){var c=n(e,o,a,i);if(c.done)return c.value}var p=h(i);p||(i=f(i));var g,x=o.global;x&&(g=o.unicode,o.lastIndex=0);for(var E,C=[];null!==(E=y(o,a))&&(T(C,E),x);)""===f(E[0])&&(o.lastIndex=m(a,d(o.lastIndex),g));for(var k,M="",P=0,I=0;I<C.length;I++){for(var R,O=f((E=C[I])[0]),L=w(_(u(E.index),a.length),0),D=[],F=1;F<E.length;F++)T(D,void 0===(k=E[F])?k:String(k));var N=E.groups;if(p){var B=b([O],D,L,a);void 0!==N&&T(B,N),R=f(r(i,void 0,B))}else R=v(O,a,L,D,N,i);L>=P&&(M+=A(a,P,L)+R,P=L+O.length)}return M+A(a,P)}]}),!!a((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!E||C)},5506:function(t,e,n){"use strict";var r=n(6518),i=n(2357).entries;r({target:"Object",stat:!0},{entries:function(t){return i(t)}})},5548:function(t,e,n){"use strict";var r=n(3517),i=n(6823),s=TypeError;t.exports=function(t){if(r(t))return t;throw new s(i(t)+" is not a constructor")}},5610:function(t,e,n){"use strict";var r=n(1291),i=Math.max,s=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):s(n,e)}},5652:function(t,e,n){"use strict";var r=n(9039);t.exports=r((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}))},5745:function(t,e,n){"use strict";var r=n(7629);t.exports=function(t,e){return r[t]||(r[t]=e||{})}},5746:function(t,e,n){"use strict";var r,i=n(2744),s=n(4576),o=n(9504),a=n(6279),l=n(3451),h=n(6468),c=n(4006),u=n(34),d=n(1181).enforce,f=n(9039),p=n(8622),m=Object,g=Array.isArray,v=m.isExtensible,y=m.isFrozen,x=m.isSealed,w=m.freeze,_=m.seal,b=!s.ActiveXObject&&"ActiveXObject"in s,T=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},S=h("WeakMap",T,c),A=S.prototype,E=o(A.set);if(p)if(b){r=c.getConstructor(T,"WeakMap",!0),l.enable();var C=o(A.delete),k=o(A.has),M=o(A.get);a(A,{delete:function(t){if(u(t)&&!v(t)){var e=d(this);return e.frozen||(e.frozen=new r),C(this,t)||e.frozen.delete(t)}return C(this,t)},has:function(t){if(u(t)&&!v(t)){var e=d(this);return e.frozen||(e.frozen=new r),k(this,t)||e.frozen.has(t)}return k(this,t)},get:function(t){if(u(t)&&!v(t)){var e=d(this);return e.frozen||(e.frozen=new r),k(this,t)?M(this,t):e.frozen.get(t)}return M(this,t)},set:function(t,e){if(u(t)&&!v(t)){var n=d(this);n.frozen||(n.frozen=new r),k(this,t)?E(this,t,e):n.frozen.set(t,e)}else E(this,t,e);return this}})}else i&&f((function(){var t=w([]);return E(new S,t,1),!y(t)}))&&a(A,{set:function(t,e){var n;return g(t)&&(y(t)?n=w:x(t)&&(n=_)),E(this,t,e),n&&n(t),this}})},5795:function(t,e,n){"use strict";var r=n(6549);if(r)try{r([],"length")}catch(t){r=null}t.exports=r},5806:function(t,e,n){"use strict";n(7764);var r,i=n(6518),s=n(3724),o=n(7416),a=n(4576),l=n(6080),h=n(9504),c=n(6840),u=n(2106),d=n(679),f=n(9297),p=n(4213),m=n(7916),g=n(7680),v=n(8183).codeAt,y=n(6098),x=n(655),w=n(687),_=n(2812),b=n(8406),T=n(1181),S=T.set,A=T.getterFor("URL"),E=b.URLSearchParams,C=b.getState,k=a.URL,M=a.TypeError,P=a.parseInt,I=Math.floor,R=Math.pow,O=h("".charAt),L=h(/./.exec),D=h([].join),F=h(1..toString),N=h([].pop),B=h([].push),W=h("".replace),U=h([].shift),j=h("".split),H=h("".slice),z=h("".toLowerCase),G=h([].unshift),V="Invalid scheme",X="Invalid host",Y="Invalid port",$=/[a-z]/i,q=/[\d+-.a-z]/i,K=/\d/,Z=/^0x/i,Q=/^[0-7]+$/,J=/^\d+$/,tt=/^[\da-f]+$/i,et=/[\0\t\n\r #%/:<>?@[\\\]^|]/,nt=/[\0\t\n\r #/:<>?@[\\\]^|]/,rt=/^[\u0000-\u0020]+/,it=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,st=/[\t\n\r]/g,ot=function(t){var e,n,r,i;if("number"==typeof t){for(e=[],n=0;n<4;n++)G(e,t%256),t=I(t/256);return D(e,".")}if("object"==typeof t){for(e="",r=function(t){for(var e=null,n=1,r=null,i=0,s=0;s<8;s++)0!==t[s]?(i>n&&(e=r,n=i),r=null,i=0):(null===r&&(r=s),++i);return i>n?r:e}(t),n=0;n<8;n++)i&&0===t[n]||(i&&(i=!1),r===n?(e+=n?":":"::",i=!0):(e+=F(t[n],16),n<7&&(e+=":")));return"["+e+"]"}return t},at={},lt=p({},at,{" ":1,'"':1,"<":1,">":1,"`":1}),ht=p({},lt,{"#":1,"?":1,"{":1,"}":1}),ct=p({},ht,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ut=function(t,e){var n=v(t,0);return n>32&&n<127&&!f(e,t)?t:encodeURIComponent(t)},dt={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ft=function(t,e){var n;return 2===t.length&&L($,O(t,0))&&(":"===(n=O(t,1))||!e&&"|"===n)},pt=function(t){var e;return t.length>1&&ft(H(t,0,2))&&(2===t.length||"/"===(e=O(t,2))||"\\"===e||"?"===e||"#"===e)},mt=function(t){return"."===t||"%2e"===z(t)},gt={},vt={},yt={},xt={},wt={},_t={},bt={},Tt={},St={},At={},Et={},Ct={},kt={},Mt={},Pt={},It={},Rt={},Ot={},Lt={},Dt={},Ft={},Nt=function(t,e,n){var r,i,s,o=x(t);if(e){if(i=this.parse(o))throw new M(i);this.searchParams=null}else{if(void 0!==n&&(r=new Nt(n,!0)),i=this.parse(o,null,r))throw new M(i);(s=C(new E)).bindURL(this),this.searchParams=s}};Nt.prototype={type:"URL",parse:function(t,e,n){var i,s,o,a,l,h=this,c=e||gt,u=0,d="",p=!1,v=!1,y=!1;for(t=x(t),e||(h.scheme="",h.username="",h.password="",h.host=null,h.port=null,h.path=[],h.query=null,h.fragment=null,h.cannotBeABaseURL=!1,t=W(t,rt,""),t=W(t,it,"$1")),t=W(t,st,""),i=m(t);u<=i.length;){switch(s=i[u],c){case gt:if(!s||!L($,s)){if(e)return V;c=yt;continue}d+=z(s),c=vt;break;case vt:if(s&&(L(q,s)||"+"===s||"-"===s||"."===s))d+=z(s);else{if(":"!==s){if(e)return V;d="",c=yt,u=0;continue}if(e&&(h.isSpecial()!==f(dt,d)||"file"===d&&(h.includesCredentials()||null!==h.port)||"file"===h.scheme&&!h.host))return;if(h.scheme=d,e)return void(h.isSpecial()&&dt[h.scheme]===h.port&&(h.port=null));d="","file"===h.scheme?c=Mt:h.isSpecial()&&n&&n.scheme===h.scheme?c=xt:h.isSpecial()?c=Tt:"/"===i[u+1]?(c=wt,u++):(h.cannotBeABaseURL=!0,B(h.path,""),c=Lt)}break;case yt:if(!n||n.cannotBeABaseURL&&"#"!==s)return V;if(n.cannotBeABaseURL&&"#"===s){h.scheme=n.scheme,h.path=g(n.path),h.query=n.query,h.fragment="",h.cannotBeABaseURL=!0,c=Ft;break}c="file"===n.scheme?Mt:_t;continue;case xt:if("/"!==s||"/"!==i[u+1]){c=_t;continue}c=St,u++;break;case wt:if("/"===s){c=At;break}c=Ot;continue;case _t:if(h.scheme=n.scheme,s===r)h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,h.path=g(n.path),h.query=n.query;else if("/"===s||"\\"===s&&h.isSpecial())c=bt;else if("?"===s)h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,h.path=g(n.path),h.query="",c=Dt;else{if("#"!==s){h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,h.path=g(n.path),h.path.length--,c=Ot;continue}h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,h.path=g(n.path),h.query=n.query,h.fragment="",c=Ft}break;case bt:if(!h.isSpecial()||"/"!==s&&"\\"!==s){if("/"!==s){h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,c=Ot;continue}c=At}else c=St;break;case Tt:if(c=St,"/"!==s||"/"!==O(d,u+1))continue;u++;break;case St:if("/"!==s&&"\\"!==s){c=At;continue}break;case At:if("@"===s){p&&(d="%40"+d),p=!0,o=m(d);for(var w=0;w<o.length;w++){var _=o[w];if(":"!==_||y){var b=ut(_,ct);y?h.password+=b:h.username+=b}else y=!0}d=""}else if(s===r||"/"===s||"?"===s||"#"===s||"\\"===s&&h.isSpecial()){if(p&&""===d)return"Invalid authority";u-=m(d).length+1,d="",c=Et}else d+=s;break;case Et:case Ct:if(e&&"file"===h.scheme){c=It;continue}if(":"!==s||v){if(s===r||"/"===s||"?"===s||"#"===s||"\\"===s&&h.isSpecial()){if(h.isSpecial()&&""===d)return X;if(e&&""===d&&(h.includesCredentials()||null!==h.port))return;if(a=h.parseHost(d))return a;if(d="",c=Rt,e)return;continue}"["===s?v=!0:"]"===s&&(v=!1),d+=s}else{if(""===d)return X;if(a=h.parseHost(d))return a;if(d="",c=kt,e===Ct)return}break;case kt:if(!L(K,s)){if(s===r||"/"===s||"?"===s||"#"===s||"\\"===s&&h.isSpecial()||e){if(""!==d){var T=P(d,10);if(T>65535)return Y;h.port=h.isSpecial()&&T===dt[h.scheme]?null:T,d=""}if(e)return;c=Rt;continue}return Y}d+=s;break;case Mt:if(h.scheme="file","/"===s||"\\"===s)c=Pt;else{if(!n||"file"!==n.scheme){c=Ot;continue}switch(s){case r:h.host=n.host,h.path=g(n.path),h.query=n.query;break;case"?":h.host=n.host,h.path=g(n.path),h.query="",c=Dt;break;case"#":h.host=n.host,h.path=g(n.path),h.query=n.query,h.fragment="",c=Ft;break;default:pt(D(g(i,u),""))||(h.host=n.host,h.path=g(n.path),h.shortenPath()),c=Ot;continue}}break;case Pt:if("/"===s||"\\"===s){c=It;break}n&&"file"===n.scheme&&!pt(D(g(i,u),""))&&(ft(n.path[0],!0)?B(h.path,n.path[0]):h.host=n.host),c=Ot;continue;case It:if(s===r||"/"===s||"\\"===s||"?"===s||"#"===s){if(!e&&ft(d))c=Ot;else if(""===d){if(h.host="",e)return;c=Rt}else{if(a=h.parseHost(d))return a;if("localhost"===h.host&&(h.host=""),e)return;d="",c=Rt}continue}d+=s;break;case Rt:if(h.isSpecial()){if(c=Ot,"/"!==s&&"\\"!==s)continue}else if(e||"?"!==s)if(e||"#"!==s){if(s!==r&&(c=Ot,"/"!==s))continue}else h.fragment="",c=Ft;else h.query="",c=Dt;break;case Ot:if(s===r||"/"===s||"\\"===s&&h.isSpecial()||!e&&("?"===s||"#"===s)){if(".."===(l=z(l=d))||"%2e."===l||".%2e"===l||"%2e%2e"===l?(h.shortenPath(),"/"===s||"\\"===s&&h.isSpecial()||B(h.path,"")):mt(d)?"/"===s||"\\"===s&&h.isSpecial()||B(h.path,""):("file"===h.scheme&&!h.path.length&&ft(d)&&(h.host&&(h.host=""),d=O(d,0)+":"),B(h.path,d)),d="","file"===h.scheme&&(s===r||"?"===s||"#"===s))for(;h.path.length>1&&""===h.path[0];)U(h.path);"?"===s?(h.query="",c=Dt):"#"===s&&(h.fragment="",c=Ft)}else d+=ut(s,ht);break;case Lt:"?"===s?(h.query="",c=Dt):"#"===s?(h.fragment="",c=Ft):s!==r&&(h.path[0]+=ut(s,at));break;case Dt:e||"#"!==s?s!==r&&("'"===s&&h.isSpecial()?h.query+="%27":h.query+="#"===s?"%23":ut(s,at)):(h.fragment="",c=Ft);break;case Ft:s!==r&&(h.fragment+=ut(s,lt))}u++}},parseHost:function(t){var e,n,r;if("["===O(t,0)){if("]"!==O(t,t.length-1))return X;if(e=function(t){var e,n,r,i,s,o,a,l=[0,0,0,0,0,0,0,0],h=0,c=null,u=0,d=function(){return O(t,u)};if(":"===d()){if(":"!==O(t,1))return;u+=2,c=++h}for(;d();){if(8===h)return;if(":"!==d()){for(e=n=0;n<4&&L(tt,d());)e=16*e+P(d(),16),u++,n++;if("."===d()){if(0===n)return;if(u-=n,h>6)return;for(r=0;d();){if(i=null,r>0){if(!("."===d()&&r<4))return;u++}if(!L(K,d()))return;for(;L(K,d());){if(s=P(d(),10),null===i)i=s;else{if(0===i)return;i=10*i+s}if(i>255)return;u++}l[h]=256*l[h]+i,2!=++r&&4!==r||h++}if(4!==r)return;break}if(":"===d()){if(u++,!d())return}else if(d())return;l[h++]=e}else{if(null!==c)return;u++,c=++h}}if(null!==c)for(o=h-c,h=7;0!==h&&o>0;)a=l[h],l[h--]=l[c+o-1],l[c+--o]=a;else if(8!==h)return;return l}(H(t,1,-1)),!e)return X;this.host=e}else if(this.isSpecial()){if(t=y(t),L(et,t))return X;if(e=function(t){var e,n,r,i,s,o,a,l=j(t,".");if(l.length&&""===l[l.length-1]&&l.length--,(e=l.length)>4)return t;for(n=[],r=0;r<e;r++){if(""===(i=l[r]))return t;if(s=10,i.length>1&&"0"===O(i,0)&&(s=L(Z,i)?16:8,i=H(i,8===s?1:2)),""===i)o=0;else{if(!L(10===s?J:8===s?Q:tt,i))return t;o=P(i,s)}B(n,o)}for(r=0;r<e;r++)if(o=n[r],r===e-1){if(o>=R(256,5-e))return null}else if(o>255)return null;for(a=N(n),r=0;r<n.length;r++)a+=n[r]*R(256,3-r);return a}(t),null===e)return X;this.host=e}else{if(L(nt,t))return X;for(e="",n=m(t),r=0;r<n.length;r++)e+=ut(n[r],at);this.host=e}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return f(dt,this.scheme)},shortenPath:function(){var t=this.path,e=t.length;!e||"file"===this.scheme&&1===e&&ft(t[0],!0)||t.length--},serialize:function(){var t=this,e=t.scheme,n=t.username,r=t.password,i=t.host,s=t.port,o=t.path,a=t.query,l=t.fragment,h=e+":";return null!==i?(h+="//",t.includesCredentials()&&(h+=n+(r?":"+r:"")+"@"),h+=ot(i),null!==s&&(h+=":"+s)):"file"===e&&(h+="//"),h+=t.cannotBeABaseURL?o[0]:o.length?"/"+D(o,"/"):"",null!==a&&(h+="?"+a),null!==l&&(h+="#"+l),h},setHref:function(t){var e=this.parse(t);if(e)throw new M(e);this.searchParams.update()},getOrigin:function(){var t=this.scheme,e=this.port;if("blob"===t)try{return new Bt(t.path[0]).origin}catch(t){return"null"}return"file"!==t&&this.isSpecial()?t+"://"+ot(this.host)+(null!==e?":"+e:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(t){this.parse(x(t)+":",gt)},getUsername:function(){return this.username},setUsername:function(t){var e=m(x(t));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<e.length;n++)this.username+=ut(e[n],ct)}},getPassword:function(){return this.password},setPassword:function(t){var e=m(x(t));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<e.length;n++)this.password+=ut(e[n],ct)}},getHost:function(){var t=this.host,e=this.port;return null===t?"":null===e?ot(t):ot(t)+":"+e},setHost:function(t){this.cannotBeABaseURL||this.parse(t,Et)},getHostname:function(){var t=this.host;return null===t?"":ot(t)},setHostname:function(t){this.cannotBeABaseURL||this.parse(t,Ct)},getPort:function(){var t=this.port;return null===t?"":x(t)},setPort:function(t){this.cannotHaveUsernamePasswordPort()||(""===(t=x(t))?this.port=null:this.parse(t,kt))},getPathname:function(){var t=this.path;return this.cannotBeABaseURL?t[0]:t.length?"/"+D(t,"/"):""},setPathname:function(t){this.cannotBeABaseURL||(this.path=[],this.parse(t,Rt))},getSearch:function(){var t=this.query;return t?"?"+t:""},setSearch:function(t){""===(t=x(t))?this.query=null:("?"===O(t,0)&&(t=H(t,1)),this.query="",this.parse(t,Dt)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var t=this.fragment;return t?"#"+t:""},setHash:function(t){""!==(t=x(t))?("#"===O(t,0)&&(t=H(t,1)),this.fragment="",this.parse(t,Ft)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Bt=function(t){var e=d(this,Wt),n=_(arguments.length,1)>1?arguments[1]:void 0,r=S(e,new Nt(t,!1,n));s||(e.href=r.serialize(),e.origin=r.getOrigin(),e.protocol=r.getProtocol(),e.username=r.getUsername(),e.password=r.getPassword(),e.host=r.getHost(),e.hostname=r.getHostname(),e.port=r.getPort(),e.pathname=r.getPathname(),e.search=r.getSearch(),e.searchParams=r.getSearchParams(),e.hash=r.getHash())},Wt=Bt.prototype,Ut=function(t,e){return{get:function(){return A(this)[t]()},set:e&&function(t){return A(this)[e](t)},configurable:!0,enumerable:!0}};if(s&&(u(Wt,"href",Ut("serialize","setHref")),u(Wt,"origin",Ut("getOrigin")),u(Wt,"protocol",Ut("getProtocol","setProtocol")),u(Wt,"username",Ut("getUsername","setUsername")),u(Wt,"password",Ut("getPassword","setPassword")),u(Wt,"host",Ut("getHost","setHost")),u(Wt,"hostname",Ut("getHostname","setHostname")),u(Wt,"port",Ut("getPort","setPort")),u(Wt,"pathname",Ut("getPathname","setPathname")),u(Wt,"search",Ut("getSearch","setSearch")),u(Wt,"searchParams",Ut("getSearchParams")),u(Wt,"hash",Ut("getHash","setHash"))),c(Wt,"toJSON",(function(){return A(this).serialize()}),{enumerable:!0}),c(Wt,"toString",(function(){return A(this).serialize()}),{enumerable:!0}),k){var jt=k.createObjectURL,Ht=k.revokeObjectURL;jt&&c(Bt,"createObjectURL",l(jt,k)),Ht&&c(Bt,"revokeObjectURL",l(Ht,k))}w(Bt,"URL"),i({global:!0,constructor:!0,forced:!o,sham:!s},{URL:Bt})},5880:function(t){"use strict";t.exports=Math.pow},5917:function(t,e,n){"use strict";var r=n(3724),i=n(9039),s=n(4055);t.exports=!r&&!i((function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},5966:function(t,e,n){"use strict";var r=n(9306),i=n(4117);t.exports=function(t,e){var n=t[e];return i(n)?void 0:r(n)}},6033:function(t,e,n){"use strict";n(8523)},6034:function(t,e,n){"use strict";var r=n(6518),i=n(2357).values;r({target:"Object",stat:!0},{values:function(t){return i(t)}})},6043:function(t,e,n){"use strict";var r=n(9306),i=TypeError,s=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw new i("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)};t.exports.f=function(t){return new s(t)}},6080:function(t,e,n){"use strict";var r=n(7476),i=n(9306),s=n(616),o=r(r.bind);t.exports=function(t,e){return i(t),void 0===e?t:s?o(t,e):function(){return t.apply(e,arguments)}}},6098:function(t,e,n){"use strict";var r=n(9504),i=2147483647,s=/[^\0-\u007E]/,o=/[.\u3002\uFF0E\uFF61]/g,a="Overflow: input needs wider integers to process",l=RangeError,h=r(o.exec),c=Math.floor,u=String.fromCharCode,d=r("".charCodeAt),f=r([].join),p=r([].push),m=r("".replace),g=r("".split),v=r("".toLowerCase),y=function(t){return t+22+75*(t<26)},x=function(t,e,n){var r=0;for(t=n?c(t/700):t>>1,t+=c(t/e);t>455;)t=c(t/35),r+=36;return c(r+36*t/(t+38))},w=function(t){var e=[];t=function(t){for(var e=[],n=0,r=t.length;n<r;){var i=d(t,n++);if(i>=55296&&i<=56319&&n<r){var s=d(t,n++);56320==(64512&s)?p(e,((1023&i)<<10)+(1023&s)+65536):(p(e,i),n--)}else p(e,i)}return e}(t);var n,r,s=t.length,o=128,h=0,m=72;for(n=0;n<t.length;n++)(r=t[n])<128&&p(e,u(r));var g=e.length,v=g;for(g&&p(e,"-");v<s;){var w=i;for(n=0;n<t.length;n++)(r=t[n])>=o&&r<w&&(w=r);var _=v+1;if(w-o>c((i-h)/_))throw new l(a);for(h+=(w-o)*_,o=w,n=0;n<t.length;n++){if((r=t[n])<o&&++h>i)throw new l(a);if(r===o){for(var b=h,T=36;;){var S=T<=m?1:T>=m+26?26:T-m;if(b<S)break;var A=b-S,E=36-S;p(e,u(y(S+A%E))),b=c(A/E),T+=36}p(e,u(y(b))),m=x(h,_,v===g),h=0,v++}}h++,o++}return f(e,"")};t.exports=function(t){var e,n,r=[],i=g(m(v(t),o,"."),".");for(e=0;e<i.length;e++)n=i[e],p(r,h(s,n)?"xn--"+w(n):n);return f(r,".")}},6099:function(t,e,n){"use strict";var r=n(2140),i=n(6840),s=n(3179);r||i(Object.prototype,"toString",s,{unsafe:!0})},6119:function(t,e,n){"use strict";var r=n(5745),i=n(3392),s=r("keys");t.exports=function(t){return s[t]||(s[t]=i(t))}},6188:function(t){"use strict";t.exports=Math.max},6193:function(t,e,n){"use strict";var r=n(9504),i=Error,s=r("".replace),o=String(new i("zxcasd").stack),a=/\n\s*at [^:]*:[^\n]*/,l=a.test(o);t.exports=function(t,e){if(l&&"string"==typeof t&&!i.prepareStackTrace)for(;e--;)t=s(t,a,"");return t}},6198:function(t,e,n){"use strict";var r=n(8014);t.exports=function(t){return r(t.length)}},6249:function(t,e,n){"use strict";var r=n(9039),i=n(6980);t.exports=!r((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",i(1,7)),7!==t.stack)}))},6269:function(t){"use strict";t.exports={}},6279:function(t,e,n){"use strict";var r=n(6840);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},6280:function(t,e,n){"use strict";var r=n(6518),i=n(4576),s=n(8745),o=n(4601),a="WebAssembly",l=i[a],h=7!==new Error("e",{cause:7}).cause,c=function(t,e){var n={};n[t]=o(t,e,h),r({global:!0,constructor:!0,arity:1,forced:h},n)},u=function(t,e){if(l&&l[t]){var n={};n[t]=o(a+"."+t,e,h),r({target:a,stat:!0,constructor:!0,arity:1,forced:h},n)}};c("Error",(function(t){return function(e){return s(t,this,arguments)}})),c("EvalError",(function(t){return function(e){return s(t,this,arguments)}})),c("RangeError",(function(t){return function(e){return s(t,this,arguments)}})),c("ReferenceError",(function(t){return function(e){return s(t,this,arguments)}})),c("SyntaxError",(function(t){return function(e){return s(t,this,arguments)}})),c("TypeError",(function(t){return function(e){return s(t,this,arguments)}})),c("URIError",(function(t){return function(e){return s(t,this,arguments)}})),u("CompileError",(function(t){return function(e){return s(t,this,arguments)}})),u("LinkError",(function(t){return function(e){return s(t,this,arguments)}})),u("RuntimeError",(function(t){return function(e){return s(t,this,arguments)}}))},6314:function(t){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);r&&o[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),e.push(c))}},e}},6319:function(t,e,n){"use strict";var r=n(8551),i=n(9539);t.exports=function(t,e,n,s){try{return s?e(r(n)[0],n[1]):e(n)}catch(e){i(t,"throw",e)}}},6395:function(t){"use strict";t.exports=!1},6468:function(t,e,n){"use strict";var r=n(6518),i=n(4576),s=n(9504),o=n(2796),a=n(6840),l=n(3451),h=n(2652),c=n(679),u=n(4901),d=n(4117),f=n(34),p=n(9039),m=n(4428),g=n(687),v=n(3167);t.exports=function(t,e,n){var y=-1!==t.indexOf("Map"),x=-1!==t.indexOf("Weak"),w=y?"set":"add",_=i[t],b=_&&_.prototype,T=_,S={},A=function(t){var e=s(b[t]);a(b,t,"add"===t?function(t){return e(this,0===t?0:t),this}:"delete"===t?function(t){return!(x&&!f(t))&&e(this,0===t?0:t)}:"get"===t?function(t){return x&&!f(t)?void 0:e(this,0===t?0:t)}:"has"===t?function(t){return!(x&&!f(t))&&e(this,0===t?0:t)}:function(t,n){return e(this,0===t?0:t,n),this})};if(o(t,!u(_)||!(x||b.forEach&&!p((function(){(new _).entries().next()})))))T=n.getConstructor(e,t,y,w),l.enable();else if(o(t,!0)){var E=new T,C=E[w](x?{}:-0,1)!==E,k=p((function(){E.has(1)})),M=m((function(t){new _(t)})),P=!x&&p((function(){for(var t=new _,e=5;e--;)t[w](e,e);return!t.has(-0)}));M||((T=e((function(t,e){c(t,b);var n=v(new _,t,T);return d(e)||h(e,n[w],{that:n,AS_ENTRIES:y}),n}))).prototype=b,b.constructor=T),(k||P)&&(A("delete"),A("has"),y&&A("get")),(P||C)&&A(w),x&&b.clear&&delete b.clear}return S[t]=T,r({global:!0,constructor:!0,forced:T!==_},S),g(T,t),x||n.setStrong(T,t,y),T}},6469:function(t,e,n){"use strict";var r=n(8227),i=n(2360),s=n(4913).f,o=r("unscopables"),a=Array.prototype;void 0===a[o]&&s(a,o,{configurable:!0,value:i(null)}),t.exports=function(t){a[o][t]=!0}},6499:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(9306),o=n(6043),a=n(1103),l=n(2652);r({target:"Promise",stat:!0,forced:n(537)},{all:function(t){var e=this,n=o.f(e),r=n.resolve,h=n.reject,c=a((function(){var n=s(e.resolve),o=[],a=0,c=1;l(t,(function(t){var s=a++,l=!1;c++,i(n,e,t).then((function(t){l||(l=!0,o[s]=t,--c||r(o))}),h)})),--c||r(o)}));return c.error&&h(c.value),n.promise}})},6518:function(t,e,n){"use strict";var r=n(4576),i=n(7347).f,s=n(6699),o=n(6840),a=n(9433),l=n(7740),h=n(2796);t.exports=function(t,e){var n,c,u,d,f,p=t.target,m=t.global,g=t.stat;if(n=m?r:g?r[p]||a(p,{}):r[p]&&r[p].prototype)for(c in e){if(d=e[c],u=t.dontCallGetSet?(f=i(n,c))&&f.value:n[c],!h(m?c:p+(g?".":"#")+c,t.forced)&&void 0!==u){if(typeof d==typeof u)continue;l(d,u)}(t.sham||u&&u.sham)&&s(d,"sham",!0),o(n,c,d,t)}}},6549:function(t){"use strict";t.exports=Object.getOwnPropertyDescriptor},6556:function(t,e,n){"use strict";var r=n(453),i=n(3126),s=i([r("%String.prototype.indexOf%")]);t.exports=function(t,e){var n=r(t,!!e);return"function"==typeof n&&s(t,".prototype.")>-1?i([n]):n}},6570:function(t){"use strict";function e(t,e,r){r=r||2;var s,o,a,l,u,d,p,m=e&&e.length,g=m?e[0]*r:t.length,v=n(t,0,g,r,!0),y=[];if(!v||v.next===v.prev)return y;if(m&&(v=function(t,e,r,i){var s,o,a,l=[];for(s=0,o=e.length;s<o;s++)(a=n(t,e[s]*i,s<o-1?e[s+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),l.push(f(a));for(l.sort(h),s=0;s<l.length;s++)r=c(l[s],r);return r}(t,e,v,r)),t.length>80*r){s=a=t[0],o=l=t[1];for(var x=r;x<g;x+=r)(u=t[x])<s&&(s=u),(d=t[x+1])<o&&(o=d),u>a&&(a=u),d>l&&(l=d);p=0!==(p=Math.max(a-s,l-o))?32767/p:0}return i(v,y,r,s,o,p,0),y}function n(t,e,n,r,i){var s,o;if(i===E(t,e,n,r)>0)for(s=e;s<n;s+=r)o=T(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=T(s,t[s],t[s+1],o);return o&&v(o,o.next)&&(S(o),o=o.next),o}function r(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!v(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(S(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,h,c,u,f){if(t){!f&&u&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=d(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,s,o,a,l,h=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<h&&(a++,r=r.nextZ);e++);for(l=h;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,h*=2}while(o>1)}(i)}(t,h,c,u);for(var p,m,g=t;t.prev!==t.next;)if(p=t.prev,m=t.next,u?o(t,h,c,u):s(t))e.push(p.i/n|0),e.push(t.i/n|0),e.push(m.i/n|0),S(t),t=m.next,g=m.next;else if((t=m)===g){f?1===f?i(t=a(r(t),e,n),e,n,h,c,u,2):2===f&&l(t,e,n,h,c,u):i(r(t),e,n,h,c,u,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(g(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,l=n.y,h=r.y,c=i<s?i<o?i:o:s<o?s:o,u=a<l?a<h?a:h:l<h?l:h,d=i>s?i>o?i:o:s>o?s:o,f=a>l?a>h?a:h:l>h?l:h,m=r.next;m!==e;){if(m.x>=c&&m.x<=d&&m.y>=u&&m.y<=f&&p(i,a,s,l,o,h,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function o(t,e,n,r){var i=t.prev,s=t,o=t.next;if(g(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,h=o.x,c=i.y,u=s.y,f=o.y,m=a<l?a<h?a:h:l<h?l:h,v=c<u?c<f?c:f:u<f?u:f,y=a>l?a>h?a:h:l>h?l:h,x=c>u?c>f?c:f:u>f?u:f,w=d(m,v,e,n,r),_=d(y,x,e,n,r),b=t.prevZ,T=t.nextZ;b&&b.z>=w&&T&&T.z<=_;){if(b.x>=m&&b.x<=y&&b.y>=v&&b.y<=x&&b!==i&&b!==o&&p(a,c,l,u,h,f,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,T.x>=m&&T.x<=y&&T.y>=v&&T.y<=x&&T!==i&&T!==o&&p(a,c,l,u,h,f,T.x,T.y)&&g(T.prev,T,T.next)>=0)return!1;T=T.nextZ}for(;b&&b.z>=w;){if(b.x>=m&&b.x<=y&&b.y>=v&&b.y<=x&&b!==i&&b!==o&&p(a,c,l,u,h,f,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;T&&T.z<=_;){if(T.x>=m&&T.x<=y&&T.y>=v&&T.y<=x&&T!==i&&T!==o&&p(a,c,l,u,h,f,T.x,T.y)&&g(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function a(t,e,n){var i=t;do{var s=i.prev,o=i.next.next;!v(s,o)&&y(s,i,i.next,o)&&_(s,o)&&_(o,s)&&(e.push(s.i/n|0),e.push(i.i/n|0),e.push(o.i/n|0),S(i),S(i.next),i=t=o),i=i.next}while(i!==t);return r(i)}function l(t,e,n,s,o,a){var l=t;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&m(l,h)){var c=b(l,h);return l=r(l,l.next),c=r(c,c.next),i(l,e,n,s,o,a,0),void i(c,e,n,s,o,a,0)}h=h.next}l=l.next}while(l!==t)}function h(t,e){return t.x-e.x}function c(t,e){var n=function(t,e){var n,r=e,i=t.x,s=t.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>o&&(o=a,n=r.x<r.next.x?r:r.next,a===i))return n}r=r.next}while(r!==e);if(!n)return null;var l,h=n,c=n.x,d=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&p(s<d?i:o,s,c,d,s<d?o:i,s,r.x,r.y)&&(l=Math.abs(s-r.y)/(i-r.x),_(r,t)&&(l<f||l===f&&(r.x>n.x||r.x===n.x&&u(n,r)))&&(n=r,f=l)),r=r.next}while(r!==h);return n}(t,e);if(!n)return e;var i=b(n,t);return r(i,i.next),r(n,n.next)}function u(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function d(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(_(t,e)&&_(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||v(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,n,r){var i=w(g(t,e,n)),s=w(g(t,e,r)),o=w(g(n,r,t)),a=w(g(n,r,e));return i!==s&&o!==a||!(0!==i||!x(t,n,e))||!(0!==s||!x(t,r,e))||!(0!==o||!x(n,t,r))||!(0!==a||!x(n,e,r))}function x(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function w(t){return t>0?1:t<0?-1:0}function _(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function b(t,e){var n=new A(t.i,t.x,t.y),r=new A(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function T(t,e,n,r){var i=new A(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function A(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(E(t,0,s,n));if(i)for(var a=0,l=e.length;a<l;a++){var h=e[a]*n,c=a<l-1?e[a+1]*n:t.length;o-=Math.abs(E(t,h,c,n))}var u=0;for(a=0;a<r.length;a+=3){var d=r[a]*n,f=r[a+1]*n,p=r[a+2]*n;u+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===o&&0===u?0:Math.abs((u-o)/o)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},6682:function(t,e,n){"use strict";var r=n(9565),i=n(8551),s=n(4901),o=n(2195),a=n(7323),l=TypeError;t.exports=function(t,e){var n=t.exec;if(s(n)){var h=r(n,t,e);return null!==h&&i(h),h}if("RegExp"===o(t))return r(a,t,e);throw new l("RegExp#exec called on incompatible receiver")}},6699:function(t,e,n){"use strict";var r=n(3724),i=n(4913),s=n(6980);t.exports=r?function(t,e,n){return i.f(t,e,s(1,n))}:function(t,e,n){return t[e]=n,t}},6706:function(t,e,n){"use strict";var r=n(9504),i=n(9306);t.exports=function(t,e,n){try{return r(i(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}}},6743:function(t,e,n){"use strict";var r=n(9353);t.exports=Function.prototype.bind||r},6761:function(t,e,n){"use strict";var r=n(6518),i=n(4576),s=n(9565),o=n(9504),a=n(6395),l=n(3724),h=n(4495),c=n(9039),u=n(9297),d=n(1625),f=n(8551),p=n(5397),m=n(6969),g=n(655),v=n(6980),y=n(2360),x=n(1072),w=n(8480),_=n(298),b=n(3717),T=n(7347),S=n(4913),A=n(6801),E=n(8773),C=n(6840),k=n(2106),M=n(5745),P=n(6119),I=n(421),R=n(3392),O=n(8227),L=n(1951),D=n(511),F=n(8242),N=n(687),B=n(1181),W=n(9213).forEach,U=P("hidden"),j="Symbol",H="prototype",z=B.set,G=B.getterFor(j),V=Object[H],X=i.Symbol,Y=X&&X[H],$=i.RangeError,q=i.TypeError,K=i.QObject,Z=T.f,Q=S.f,J=_.f,tt=E.f,et=o([].push),nt=M("symbols"),rt=M("op-symbols"),it=M("wks"),st=!K||!K[H]||!K[H].findChild,ot=function(t,e,n){var r=Z(V,e);r&&delete V[e],Q(t,e,n),r&&t!==V&&Q(V,e,r)},at=l&&c((function(){return 7!==y(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a}))?ot:Q,lt=function(t,e){var n=nt[t]=y(Y);return z(n,{type:j,tag:t,description:e}),l||(n.description=e),n},ht=function(t,e,n){t===V&&ht(rt,e,n),f(t);var r=m(e);return f(n),u(nt,r)?(n.enumerable?(u(t,U)&&t[U][r]&&(t[U][r]=!1),n=y(n,{enumerable:v(0,!1)})):(u(t,U)||Q(t,U,v(1,y(null))),t[U][r]=!0),at(t,r,n)):Q(t,r,n)},ct=function(t,e){f(t);var n=p(e),r=x(n).concat(pt(n));return W(r,(function(e){l&&!s(ut,n,e)||ht(t,e,n[e])})),t},ut=function(t){var e=m(t),n=s(tt,this,e);return!(this===V&&u(nt,e)&&!u(rt,e))&&(!(n||!u(this,e)||!u(nt,e)||u(this,U)&&this[U][e])||n)},dt=function(t,e){var n=p(t),r=m(e);if(n!==V||!u(nt,r)||u(rt,r)){var i=Z(n,r);return!i||!u(nt,r)||u(n,U)&&n[U][r]||(i.enumerable=!0),i}},ft=function(t){var e=J(p(t)),n=[];return W(e,(function(t){u(nt,t)||u(I,t)||et(n,t)})),n},pt=function(t){var e=t===V,n=J(e?rt:p(t)),r=[];return W(n,(function(t){!u(nt,t)||e&&!u(V,t)||et(r,nt[t])})),r};h||(X=function(){if(d(Y,this))throw new q("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?g(arguments[0]):void 0,e=R(t),n=function(t){var r=void 0===this?i:this;r===V&&s(n,rt,t),u(r,U)&&u(r[U],e)&&(r[U][e]=!1);var o=v(1,t);try{at(r,e,o)}catch(t){if(!(t instanceof $))throw t;ot(r,e,o)}};return l&&st&&at(V,e,{configurable:!0,set:n}),lt(e,t)},C(Y=X[H],"toString",(function(){return G(this).tag})),C(X,"withoutSetter",(function(t){return lt(R(t),t)})),E.f=ut,S.f=ht,A.f=ct,T.f=dt,w.f=_.f=ft,b.f=pt,L.f=function(t){return lt(O(t),t)},l&&(k(Y,"description",{configurable:!0,get:function(){return G(this).description}}),a||C(V,"propertyIsEnumerable",ut,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!h,sham:!h},{Symbol:X}),W(x(it),(function(t){D(t)})),r({target:j,stat:!0,forced:!h},{useSetter:function(){st=!0},useSimple:function(){st=!1}}),r({target:"Object",stat:!0,forced:!h,sham:!l},{create:function(t,e){return void 0===e?y(t):ct(y(t),e)},defineProperty:ht,defineProperties:ct,getOwnPropertyDescriptor:dt}),r({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:ft}),F(),N(X,j),I[U]=!0},6801:function(t,e,n){"use strict";var r=n(3724),i=n(8686),s=n(4913),o=n(8551),a=n(5397),l=n(1072);e.f=r&&!i?Object.defineProperties:function(t,e){o(t);for(var n,r=a(e),i=l(e),h=i.length,c=0;h>c;)s.f(t,n=i[c++],r[n]);return t}},6823:function(t){"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},6837:function(t){"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},6840:function(t,e,n){"use strict";var r=n(4901),i=n(4913),s=n(283),o=n(9433);t.exports=function(t,e,n,a){a||(a={});var l=a.enumerable,h=void 0!==a.name?a.name:e;if(r(n)&&s(n,h,a),a.global)l?t[e]=n:o(e,n);else{try{a.unsafe?t[e]&&(l=!0):delete t[e]}catch(t){}l?t[e]=n:i.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},6933:function(t,e,n){"use strict";var r=n(9504),i=n(4376),s=n(4901),o=n(2195),a=n(655),l=r([].push);t.exports=function(t){if(s(t))return t;if(i(t)){for(var e=t.length,n=[],r=0;r<e;r++){var h=t[r];"string"==typeof h?l(n,h):"number"!=typeof h&&"Number"!==o(h)&&"String"!==o(h)||l(n,a(h))}var c=n.length,u=!0;return function(t,e){if(u)return u=!1,e;if(i(this))return e;for(var r=0;r<c;r++)if(n[r]===t)return e}}}},6938:function(t,e,n){"use strict";var r=n(2360),i=n(2106),s=n(6279),o=n(6080),a=n(679),l=n(4117),h=n(2652),c=n(1088),u=n(2529),d=n(7633),f=n(3724),p=n(3451).fastKey,m=n(1181),g=m.set,v=m.getterFor;t.exports={getConstructor:function(t,e,n,c){var u=t((function(t,i){a(t,d),g(t,{type:e,index:r(null),first:null,last:null,size:0}),f||(t.size=0),l(i)||h(i,t[c],{that:t,AS_ENTRIES:n})})),d=u.prototype,m=v(e),y=function(t,e,n){var r,i,s=m(t),o=x(t,e);return o?o.value=n:(s.last=o={index:i=p(e,!0),key:e,value:n,previous:r=s.last,next:null,removed:!1},s.first||(s.first=o),r&&(r.next=o),f?s.size++:t.size++,"F"!==i&&(s.index[i]=o)),t},x=function(t,e){var n,r=m(t),i=p(e);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key===e)return n};return s(d,{clear:function(){for(var t=m(this),e=t.first;e;)e.removed=!0,e.previous&&(e.previous=e.previous.next=null),e=e.next;t.first=t.last=null,t.index=r(null),f?t.size=0:this.size=0},delete:function(t){var e=this,n=m(e),r=x(e,t);if(r){var i=r.next,s=r.previous;delete n.index[r.index],r.removed=!0,s&&(s.next=i),i&&(i.previous=s),n.first===r&&(n.first=i),n.last===r&&(n.last=s),f?n.size--:e.size--}return!!r},forEach:function(t){for(var e,n=m(this),r=o(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:n.first;)for(r(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!x(this,t)}}),s(d,n?{get:function(t){var e=x(this,t);return e&&e.value},set:function(t,e){return y(this,0===t?0:t,e)}}:{add:function(t){return y(this,t=0===t?0:t,t)}}),f&&i(d,"size",{configurable:!0,get:function(){return m(this).size}}),u},setStrong:function(t,e,n){var r=e+" Iterator",i=v(e),s=v(r);c(t,e,(function(t,e){g(this,{type:r,target:t,state:i(t),kind:e,last:null})}),(function(){for(var t=s(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?u("keys"===e?n.key:"values"===e?n.value:[n.key,n.value],!1):(t.target=null,u(void 0,!0))}),n?"entries":"values",!n,!0),d(e)}}},6955:function(t,e,n){"use strict";var r=n(2140),i=n(4901),s=n(2195),o=n(8227)("toStringTag"),a=Object,l="Arguments"===s(function(){return arguments}());t.exports=r?s:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=a(t),o))?n:l?s(e):"Object"===(r=s(e))&&i(e.callee)?"Arguments":r}},6969:function(t,e,n){"use strict";var r=n(2777),i=n(757);t.exports=function(t){var e=r(t,"string");return i(e)?e:e+""}},6980:function(t){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7040:function(t,e,n){"use strict";var r=n(4495);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7055:function(t,e,n){"use strict";var r=n(9504),i=n(9039),s=n(2195),o=Object,a=r("".split);t.exports=i((function(){return!o("z").propertyIsEnumerable(0)}))?function(t){return"String"===s(t)?a(t,""):o(t)}:o},7119:function(t){"use strict";t.exports="undefined"!=typeof Reflect&&Reflect&&Reflect.apply},7176:function(t,e,n){"use strict";var r,i=n(3126),s=n(5795);try{r=[].__proto__===Array.prototype}catch(t){if(!t||"object"!=typeof t||!("code"in t)||"ERR_PROTO_ACCESS"!==t.code)throw t}var o=!!r&&s&&s(Object.prototype,"__proto__"),a=Object,l=a.getPrototypeOf;t.exports=o&&"function"==typeof o.get?i([o.get]):"function"==typeof l&&function(t){return l(null==t?t:a(t))}},7208:function(t,e,n){"use strict";var r=n(6518),i=n(9565);r({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return i(URL.prototype.toString,this)}})},7323:function(t,e,n){"use strict";var r,i,s=n(9565),o=n(9504),a=n(655),l=n(7979),h=n(8429),c=n(5745),u=n(2360),d=n(1181).get,f=n(3635),p=n(8814),m=c("native-string-replace",String.prototype.replace),g=RegExp.prototype.exec,v=g,y=o("".charAt),x=o("".indexOf),w=o("".replace),_=o("".slice),b=(i=/b*/g,s(g,r=/a/,"a"),s(g,i,"a"),0!==r.lastIndex||0!==i.lastIndex),T=h.BROKEN_CARET,S=void 0!==/()??/.exec("")[1];(b||S||T||f||p)&&(v=function(t){var e,n,r,i,o,h,c,f=this,p=d(f),A=a(t),E=p.raw;if(E)return E.lastIndex=f.lastIndex,e=s(v,E,A),f.lastIndex=E.lastIndex,e;var C=p.groups,k=T&&f.sticky,M=s(l,f),P=f.source,I=0,R=A;if(k&&(M=w(M,"y",""),-1===x(M,"g")&&(M+="g"),R=_(A,f.lastIndex),f.lastIndex>0&&(!f.multiline||f.multiline&&"\n"!==y(A,f.lastIndex-1))&&(P="(?: "+P+")",R=" "+R,I++),n=new RegExp("^(?:"+P+")",M)),S&&(n=new RegExp("^"+P+"$(?!\\s)",M)),b&&(r=f.lastIndex),i=s(g,k?n:f,R),k?i?(i.input=_(i.input,I),i[0]=_(i[0],I),i.index=f.lastIndex,f.lastIndex+=i[0].length):f.lastIndex=0:b&&i&&(f.lastIndex=f.global?i.index+i[0].length:r),S&&i&&i.length>1&&s(m,i[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&C)for(i.groups=h=u(null),o=0;o<C.length;o++)h[(c=C[o])[0]]=i[c[1]];return i}),t.exports=v},7337:function(t,e,n){"use strict";var r=n(6518),i=n(9504),s=n(5610),o=RangeError,a=String.fromCharCode,l=String.fromCodePoint,h=i([].join);r({target:"String",stat:!0,arity:1,forced:!!l&&1!==l.length},{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,i=0;r>i;){if(e=+arguments[i++],s(e,1114111)!==e)throw new o(e+" is not a valid code point");n[i]=e<65536?a(e):a(55296+((e-=65536)>>10),e%1024+56320)}return h(n,"")}})},7347:function(t,e,n){"use strict";var r=n(3724),i=n(9565),s=n(8773),o=n(6980),a=n(5397),l=n(6969),h=n(9297),c=n(5917),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=a(t),e=l(e),c)try{return u(t,e)}catch(t){}if(h(t,e))return o(!i(s.f,t,e),t[e])}},7400:function(t){"use strict";t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},7416:function(t,e,n){"use strict";var r=n(9039),i=n(8227),s=n(3724),o=n(6395),a=i("iterator");t.exports=!r((function(){var t=new URL("b?a=1&b=2&c=3","https://a"),e=t.searchParams,n=new URLSearchParams("a=1&a=2&b=3"),r="";return t.pathname="c%20d",e.forEach((function(t,n){e.delete("b"),r+=n+t})),n.delete("a",2),n.delete("b",void 0),o&&(!t.toJSON||!n.has("a",1)||n.has("a",2)||!n.has("a",void 0)||n.has("b"))||!e.size&&(o||!s)||!e.sort||"https://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://тест").host||"#%D0%B1"!==new URL("https://a#б").hash||"a1c3"!==r||"x"!==new URL("https://x",void 0).host}))},7433:function(t,e,n){"use strict";var r=n(4376),i=n(3517),s=n(34),o=n(8227)("species"),a=Array;t.exports=function(t){var e;return r(t)&&(e=t.constructor,(i(e)&&(e===a||r(e.prototype))||s(e)&&null===(e=e[o]))&&(e=void 0)),void 0===e?a:e}},7452:function(t){"use strict";t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},7465:function(t,e,n){"use strict";var r=n(3724),i=n(3635),s=n(2195),o=n(2106),a=n(1181).get,l=RegExp.prototype,h=TypeError;r&&i&&o(l,"dotAll",{configurable:!0,get:function(){if(this!==l){if("RegExp"===s(this))return!!a(this).dotAll;throw new h("Incompatible receiver, RegExp required")}}})},7476:function(t,e,n){"use strict";var r=n(2195),i=n(9504);t.exports=function(t){if("Function"===r(t))return i(t)}},7495:function(t,e,n){"use strict";var r=n(6518),i=n(7323);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},7550:function(t,e,n){"use strict";n(3579)},7584:function(t,e,n){"use strict";var r=n(34),i=n(6699);t.exports=function(t,e){r(e)&&"cause"in e&&i(t,"cause",e.cause)}},7588:function(t,e,n){"use strict";var r=n(6518),i=n(2652),s=n(9306),o=n(8551),a=n(1767);r({target:"Iterator",proto:!0,real:!0},{forEach:function(t){o(this),s(t);var e=a(this),n=0;i(e,(function(e){t(e,n++)}),{IS_RECORD:!0})}})},7629:function(t,e,n){"use strict";var r=n(6395),i=n(4576),s=n(9433),o="__core-js_shared__",a=t.exports=i[o]||s(o,{});(a.versions||(a.versions=[])).push({version:"3.41.0",mode:r?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"})},7633:function(t,e,n){"use strict";var r=n(7751),i=n(2106),s=n(8227),o=n(3724),a=s("species");t.exports=function(t){var e=r(t);o&&e&&!e[a]&&i(e,a,{configurable:!0,get:function(){return this}})}},7657:function(t,e,n){"use strict";var r,i,s,o=n(9039),a=n(4901),l=n(34),h=n(2360),c=n(2787),u=n(6840),d=n(8227),f=n(6395),p=d("iterator"),m=!1;[].keys&&("next"in(s=[].keys())?(i=c(c(s)))!==Object.prototype&&(r=i):m=!0),!l(r)||o((function(){var t={};return r[p].call(t)!==t}))?r={}:f&&(r=h(r)),a(r[p])||u(r,p,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:m}},7659:function(t){"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},7680:function(t,e,n){"use strict";var r=n(9504);t.exports=r([].slice)},7720:function(t,e,n){"use strict";var r=n(4765),i=Object.prototype.hasOwnProperty,s=Array.isArray,o=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),a=function(t,e){for(var n=e&&e.plainObjects?{__proto__:null}:{},r=0;r<t.length;++r)void 0!==t[r]&&(n[r]=t[r]);return n},l=1024;t.exports={arrayToObject:a,assign:function(t,e){return Object.keys(e).reduce((function(t,n){return t[n]=e[n],t}),t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],r=0;r<e.length;++r)for(var i=e[r],o=i.obj[i.prop],a=Object.keys(o),l=0;l<a.length;++l){var h=a[l],c=o[h];"object"==typeof c&&null!==c&&-1===n.indexOf(c)&&(e.push({obj:o,prop:h}),n.push(c))}return function(t){for(;t.length>1;){var e=t.pop(),n=e.obj[e.prop];if(s(n)){for(var r=[],i=0;i<n.length;++i)void 0!==n[i]&&r.push(n[i]);e.obj[e.prop]=r}}}(e),t},decode:function(t,e,n){var r=t.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(t){return r}},encode:function(t,e,n,i,s){if(0===t.length)return t;var a=t;if("symbol"==typeof t?a=Symbol.prototype.toString.call(t):"string"!=typeof t&&(a=String(t)),"iso-8859-1"===n)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));for(var h="",c=0;c<a.length;c+=l){for(var u=a.length>=l?a.slice(c,c+l):a,d=[],f=0;f<u.length;++f){var p=u.charCodeAt(f);45===p||46===p||95===p||126===p||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||s===r.RFC1738&&(40===p||41===p)?d[d.length]=u.charAt(f):p<128?d[d.length]=o[p]:p<2048?d[d.length]=o[192|p>>6]+o[128|63&p]:p<55296||p>=57344?d[d.length]=o[224|p>>12]+o[128|p>>6&63]+o[128|63&p]:(f+=1,p=65536+((1023&p)<<10|1023&u.charCodeAt(f)),d[d.length]=o[240|p>>18]+o[128|p>>12&63]+o[128|p>>6&63]+o[128|63&p])}h+=d.join("")}return h},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(s(t)){for(var n=[],r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)},merge:function t(e,n,r){if(!n)return e;if("object"!=typeof n&&"function"!=typeof n){if(s(e))e.push(n);else{if(!e||"object"!=typeof e)return[e,n];(r&&(r.plainObjects||r.allowPrototypes)||!i.call(Object.prototype,n))&&(e[n]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(n);var o=e;return s(e)&&!s(n)&&(o=a(e,r)),s(e)&&s(n)?(n.forEach((function(n,s){if(i.call(e,s)){var o=e[s];o&&"object"==typeof o&&n&&"object"==typeof n?e[s]=t(o,n,r):e.push(n)}else e[s]=n})),e):Object.keys(n).reduce((function(e,s){var o=n[s];return i.call(e,s)?e[s]=t(e[s],o,r):e[s]=o,e}),o)}}},7740:function(t,e,n){"use strict";var r=n(9297),i=n(5031),s=n(7347),o=n(4913);t.exports=function(t,e,n){for(var a=i(e),l=o.f,h=s.f,c=0;c<a.length;c++){var u=a[c];r(t,u)||n&&r(n,u)||l(t,u,h(e,u))}}},7743:function(t,e,n){"use strict";var r=n(6518),i=n(9565),s=n(9306),o=n(6043),a=n(1103),l=n(2652);r({target:"Promise",stat:!0,forced:n(537)},{race:function(t){var e=this,n=o.f(e),r=n.reject,h=a((function(){var o=s(e.resolve);l(t,(function(t){i(o,e,t).then(n.resolve,r)}))}));return h.error&&r(h.value),n.promise}})},7745:function(t,e,n){"use strict";var r=n(3724),i=n(8429).MISSED_STICKY,s=n(2195),o=n(2106),a=n(1181).get,l=RegExp.prototype,h=TypeError;r&&i&&o(l,"sticky",{configurable:!0,get:function(){if(this!==l){if("RegExp"===s(this))return!!a(this).sticky;throw new h("Incompatible receiver, RegExp required")}}})},7750:function(t,e,n){"use strict";var r=n(4117),i=TypeError;t.exports=function(t){if(r(t))throw new i("Can't call method on "+t);return t}},7751:function(t,e,n){"use strict";var r=n(4576),i=n(4901);t.exports=function(t,e){return arguments.length<2?(n=r[t],i(n)?n:void 0):r[t]&&r[t][e];var n}},7764:function(t,e,n){"use strict";var r=n(8183).charAt,i=n(655),s=n(1181),o=n(1088),a=n(2529),l="String Iterator",h=s.set,c=s.getterFor(l);o(String,"String",(function(t){h(this,{type:l,string:i(t),index:0})}),(function(){var t,e=c(this),n=e.string,i=e.index;return i>=n.length?a(void 0,!0):(t=r(n,i),e.index+=t.length,a(t,!1))}))},7812:function(t,e,n){"use strict";var r=n(6518),i=n(9297),s=n(757),o=n(6823),a=n(5745),l=n(1296),h=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!l},{keyFor:function(t){if(!s(t))throw new TypeError(o(t)+" is not a symbol");if(i(h,t))return h[t]}})},7825:function(t){"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},7829:function(t,e,n){"use strict";var r=n(8183).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},7860:function(t,e,n){"use strict";var r=n(2839);t.exports=/web0s(?!.*chrome)/i.test(r)},7916:function(t,e,n){"use strict";var r=n(6080),i=n(9565),s=n(8981),o=n(6319),a=n(4209),l=n(3517),h=n(6198),c=n(4659),u=n(81),d=n(851),f=Array;t.exports=function(t){var e=s(t),n=l(this),p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m;g&&(m=r(m,p>2?arguments[2]:void 0));var v,y,x,w,_,b,T=d(e),S=0;if(!T||this===f&&a(T))for(v=h(e),y=n?new this(v):f(v);v>S;S++)b=g?m(e[S],S):e[S],c(y,S,b);else for(y=n?new this:[],_=(w=u(e,T)).next;!(x=i(_,w)).done;S++)b=g?o(w,m,[x.value,S],!0):x.value,c(y,S,b);return y.length=S,y}},7979:function(t,e,n){"use strict";var r=n(8551);t.exports=function(){var t=r(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},8002:function(t){"use strict";t.exports=Math.min},8014:function(t,e,n){"use strict";var r=n(1291),i=Math.min;t.exports=function(t){var e=r(t);return e>0?i(e,9007199254740991):0}},8068:function(t){"use strict";t.exports=SyntaxError},8111:function(t,e,n){"use strict";var r=n(6518),i=n(4576),s=n(679),o=n(8551),a=n(4901),l=n(2787),h=n(2106),c=n(4659),u=n(9039),d=n(9297),f=n(8227),p=n(7657).IteratorPrototype,m=n(3724),g=n(6395),v="constructor",y="Iterator",x=f("toStringTag"),w=TypeError,_=i[y],b=g||!a(_)||_.prototype!==p||!u((function(){_({})})),T=function(){if(s(this,p),l(this)===p)throw new w("Abstract class Iterator not directly constructable")},S=function(t,e){m?h(p,t,{configurable:!0,get:function(){return e},set:function(e){if(o(this),this===p)throw new w("You can't redefine this property");d(this,t)?this[t]=e:c(this,t,e)}}):p[t]=e};d(p,x)||S(x,y),!b&&d(p,v)&&p[v]!==Object||S(v,T),T.prototype=p,r({global:!0,constructor:!0,forced:b},{Iterator:T})},8130:function(t,e,n){"use strict";var r=n(6518),i=n(6395),s=n(3724),o=n(4576),a=n(9167),l=n(9504),h=n(2796),c=n(9297),u=n(3167),d=n(1625),f=n(757),p=n(2777),m=n(9039),g=n(8480).f,v=n(7347).f,y=n(4913).f,x=n(1240),w=n(3802).trim,_="Number",b=o[_],T=a[_],S=b.prototype,A=o.TypeError,E=l("".slice),C=l("".charCodeAt),k=h(_,!b(" 0o1")||!b("0b1")||b("+0x1")),M=function(t){var e,n=arguments.length<1?0:b(function(t){var e=p(t,"number");return"bigint"==typeof e?e:function(t){var e,n,r,i,s,o,a,l,h=p(t,"number");if(f(h))throw new A("Cannot convert a Symbol value to a number");if("string"==typeof h&&h.length>2)if(h=w(h),43===(e=C(h,0))||45===e){if(88===(n=C(h,2))||120===n)return NaN}else if(48===e){switch(C(h,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+h}for(o=(s=E(h,2)).length,a=0;a<o;a++)if((l=C(s,a))<48||l>i)return NaN;return parseInt(s,r)}return+h}(e)}(t));return d(S,e=this)&&m((function(){x(e)}))?u(Object(n),this,M):n};M.prototype=S,k&&!i&&(S.constructor=M),r({global:!0,constructor:!0,wrap:!0,forced:k},{Number:M});var P=function(t,e){for(var n,r=s?g(e):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),i=0;r.length>i;i++)c(e,n=r[i])&&!c(t,n)&&y(t,n,v(e,n))};i&&T&&P(a[_],T),(k||i)&&P(a[_],b)},8156:function(t,e,n){"use strict";var r=n(6518),i=n(533).start;r({target:"String",proto:!0,forced:n(3063)},{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},8183:function(t,e,n){"use strict";var r=n(9504),i=n(1291),s=n(655),o=n(7750),a=r("".charAt),l=r("".charCodeAt),h=r("".slice),c=function(t){return function(e,n){var r,c,u=s(o(e)),d=i(n),f=u.length;return d<0||d>=f?t?"":void 0:(r=l(u,d))<55296||r>56319||d+1===f||(c=l(u,d+1))<56320||c>57343?t?a(u,d):r:t?h(u,d,d+2):c-56320+(r-55296<<10)+65536}};t.exports={codeAt:c(!1),charAt:c(!0)}},8227:function(t,e,n){"use strict";var r=n(4576),i=n(5745),s=n(9297),o=n(3392),a=n(4495),l=n(7040),h=r.Symbol,c=i("wks"),u=l?h.for||h:h&&h.withoutSetter||o;t.exports=function(t){return s(c,t)||(c[t]=a&&s(h,t)?h[t]:u("Symbol."+t)),c[t]}},8242:function(t,e,n){"use strict";var r=n(9565),i=n(7751),s=n(8227),o=n(6840);t.exports=function(){var t=i("Symbol"),e=t&&t.prototype,n=e&&e.valueOf,a=s("toPrimitive");e&&!e[a]&&o(e,a,(function(t){return r(n,this)}),{arity:1})}},8265:function(t){"use strict";var e=function(){this.head=null,this.tail=null};e.prototype={add:function(t){var e={item:t,next:null},n=this.tail;n?n.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}},t.exports=e},8406:function(t,e,n){"use strict";n(3792),n(7337);var r=n(6518),i=n(4576),s=n(3389),o=n(7751),a=n(9565),l=n(9504),h=n(3724),c=n(7416),u=n(6840),d=n(2106),f=n(6279),p=n(687),m=n(3994),g=n(1181),v=n(679),y=n(4901),x=n(9297),w=n(6080),_=n(6955),b=n(8551),T=n(34),S=n(655),A=n(2360),E=n(6980),C=n(81),k=n(851),M=n(2529),P=n(2812),I=n(8227),R=n(4488),O=I("iterator"),L="URLSearchParams",D=L+"Iterator",F=g.set,N=g.getterFor(L),B=g.getterFor(D),W=s("fetch"),U=s("Request"),j=s("Headers"),H=U&&U.prototype,z=j&&j.prototype,G=i.TypeError,V=i.encodeURIComponent,X=String.fromCharCode,Y=o("String","fromCodePoint"),$=parseInt,q=l("".charAt),K=l([].join),Z=l([].push),Q=l("".replace),J=l([].shift),tt=l([].splice),et=l("".split),nt=l("".slice),rt=l(/./.exec),it=/\+/g,st=/^[0-9a-f]+$/i,ot=function(t,e){var n=nt(t,e,e+2);return rt(st,n)?$(n,16):NaN},at=function(t){for(var e=0,n=128;n>0&&t&n;n>>=1)e++;return e},lt=function(t){var e=null;switch(t.length){case 1:e=t[0];break;case 2:e=(31&t[0])<<6|63&t[1];break;case 3:e=(15&t[0])<<12|(63&t[1])<<6|63&t[2];break;case 4:e=(7&t[0])<<18|(63&t[1])<<12|(63&t[2])<<6|63&t[3]}return e>1114111?null:e},ht=function(t){for(var e=(t=Q(t,it," ")).length,n="",r=0;r<e;){var i=q(t,r);if("%"===i){if("%"===q(t,r+1)||r+3>e){n+="%",r++;continue}var s=ot(t,r+1);if(s!=s){n+=i,r++;continue}r+=2;var o=at(s);if(0===o)i=X(s);else{if(1===o||o>4){n+="�",r++;continue}for(var a=[s],l=1;l<o&&!(3+ ++r>e||"%"!==q(t,r));){var h=ot(t,r+1);if(h!=h){r+=3;break}if(h>191||h<128)break;Z(a,h),r+=2,l++}if(a.length!==o){n+="�";continue}var c=lt(a);null===c?n+="�":i=Y(c)}}n+=i,r++}return n},ct=/[!'()~]|%20/g,ut={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},dt=function(t){return ut[t]},ft=function(t){return Q(V(t),ct,dt)},pt=m((function(t,e){F(this,{type:D,target:N(t).entries,index:0,kind:e})}),L,(function(){var t=B(this),e=t.target,n=t.index++;if(!e||n>=e.length)return t.target=null,M(void 0,!0);var r=e[n];switch(t.kind){case"keys":return M(r.key,!1);case"values":return M(r.value,!1)}return M([r.key,r.value],!1)}),!0),mt=function(t){this.entries=[],this.url=null,void 0!==t&&(T(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===q(t,0)?nt(t,1):t:S(t)))};mt.prototype={type:L,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var e,n,r,i,s,o,l,h=this.entries,c=k(t);if(c)for(n=(e=C(t,c)).next;!(r=a(n,e)).done;){if(s=(i=C(b(r.value))).next,(o=a(s,i)).done||(l=a(s,i)).done||!a(s,i).done)throw new G("Expected sequence with length 2");Z(h,{key:S(o.value),value:S(l.value)})}else for(var u in t)x(t,u)&&Z(h,{key:u,value:S(t[u])})},parseQuery:function(t){if(t)for(var e,n,r=this.entries,i=et(t,"&"),s=0;s<i.length;)(e=i[s++]).length&&(n=et(e,"="),Z(r,{key:ht(J(n)),value:ht(K(n,"="))}))},serialize:function(){for(var t,e=this.entries,n=[],r=0;r<e.length;)t=e[r++],Z(n,ft(t.key)+"="+ft(t.value));return K(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var gt=function(){v(this,vt);var t=F(this,new mt(arguments.length>0?arguments[0]:void 0));h||(this.size=t.entries.length)},vt=gt.prototype;if(f(vt,{append:function(t,e){var n=N(this);P(arguments.length,2),Z(n.entries,{key:S(t),value:S(e)}),h||this.length++,n.updateURL()},delete:function(t){for(var e=N(this),n=P(arguments.length,1),r=e.entries,i=S(t),s=n<2?void 0:arguments[1],o=void 0===s?s:S(s),a=0;a<r.length;){var l=r[a];if(l.key!==i||void 0!==o&&l.value!==o)a++;else if(tt(r,a,1),void 0!==o)break}h||(this.size=r.length),e.updateURL()},get:function(t){var e=N(this).entries;P(arguments.length,1);for(var n=S(t),r=0;r<e.length;r++)if(e[r].key===n)return e[r].value;return null},getAll:function(t){var e=N(this).entries;P(arguments.length,1);for(var n=S(t),r=[],i=0;i<e.length;i++)e[i].key===n&&Z(r,e[i].value);return r},has:function(t){for(var e=N(this).entries,n=P(arguments.length,1),r=S(t),i=n<2?void 0:arguments[1],s=void 0===i?i:S(i),o=0;o<e.length;){var a=e[o++];if(a.key===r&&(void 0===s||a.value===s))return!0}return!1},set:function(t,e){var n=N(this);P(arguments.length,1);for(var r,i=n.entries,s=!1,o=S(t),a=S(e),l=0;l<i.length;l++)(r=i[l]).key===o&&(s?tt(i,l--,1):(s=!0,r.value=a));s||Z(i,{key:o,value:a}),h||(this.size=i.length),n.updateURL()},sort:function(){var t=N(this);R(t.entries,(function(t,e){return t.key>e.key?1:-1})),t.updateURL()},forEach:function(t){for(var e,n=N(this).entries,r=w(t,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((e=n[i++]).value,e.key,this)},keys:function(){return new pt(this,"keys")},values:function(){return new pt(this,"values")},entries:function(){return new pt(this,"entries")}},{enumerable:!0}),u(vt,O,vt.entries,{name:"entries"}),u(vt,"toString",(function(){return N(this).serialize()}),{enumerable:!0}),h&&d(vt,"size",{get:function(){return N(this).entries.length},configurable:!0,enumerable:!0}),p(gt,L),r({global:!0,constructor:!0,forced:!c},{URLSearchParams:gt}),!c&&y(j)){var yt=l(z.has),xt=l(z.set),wt=function(t){if(T(t)){var e,n=t.body;if(_(n)===L)return e=t.headers?new j(t.headers):new j,yt(e,"content-type")||xt(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),A(t,{body:E(0,S(n)),headers:E(0,e)})}return t};if(y(W)&&r({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return W(t,arguments.length>1?wt(arguments[1]):{})}}),y(U)){var _t=function(t){return v(this,H),new U(t,arguments.length>1?wt(arguments[1]):{})};H.constructor=_t,_t.prototype=H,r({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:_t})}}t.exports={URLSearchParams:gt,getState:N}},8408:function(t,e,n){"use strict";n(8406)},8429:function(t,e,n){"use strict";var r=n(9039),i=n(4576).RegExp,s=r((function(){var t=i("a","y");return t.lastIndex=2,null!==t.exec("abcd")})),o=s||r((function(){return!i("a","y").sticky})),a=s||r((function(){var t=i("^r","gy");return t.lastIndex=2,null!==t.exec("str")}));t.exports={BROKEN_CARET:a,MISSED_STICKY:o,UNSUPPORTED_Y:s}},8480:function(t,e,n){"use strict";var r=n(1828),i=n(8727).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},8523:function(t,e,n){"use strict";n(6468)("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n(6938))},8551:function(t,e,n){"use strict";var r=n(34),i=String,s=TypeError;t.exports=function(t){if(r(t))return t;throw new s(i(t)+" is not an object")}},8574:function(t,e,n){"use strict";var r=n(4215);t.exports="NODE"===r},8622:function(t,e,n){"use strict";var r=n(4576),i=n(4901),s=r.WeakMap;t.exports=i(s)&&/native code/.test(String(s))},8636:function(t,e,n){"use strict";var r=n(920),i=n(7720),s=n(4765),o=Object.prototype.hasOwnProperty,a={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},l=Array.isArray,h=Array.prototype.push,c=function(t,e){h.apply(t,l(e)?e:[e])},u=Date.prototype.toISOString,d=s.default,f={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:i.encode,encodeValuesOnly:!1,filter:void 0,format:d,formatter:s.formatters[d],indices:!1,serializeDate:function(t){return u.call(t)},skipNulls:!1,strictNullHandling:!1},p={},m=function t(e,n,s,o,a,h,u,d,m,g,v,y,x,w,_,b,T,S){for(var A,E=e,C=S,k=0,M=!1;void 0!==(C=C.get(p))&&!M;){var P=C.get(e);if(k+=1,void 0!==P){if(P===k)throw new RangeError("Cyclic object value");M=!0}void 0===C.get(p)&&(k=0)}if("function"==typeof g?E=g(n,E):E instanceof Date?E=x(E):"comma"===s&&l(E)&&(E=i.maybeMap(E,(function(t){return t instanceof Date?x(t):t}))),null===E){if(h)return m&&!b?m(n,f.encoder,T,"key",w):n;E=""}if("string"==typeof(A=E)||"number"==typeof A||"boolean"==typeof A||"symbol"==typeof A||"bigint"==typeof A||i.isBuffer(E))return m?[_(b?n:m(n,f.encoder,T,"key",w))+"="+_(m(E,f.encoder,T,"value",w))]:[_(n)+"="+_(String(E))];var I,R=[];if(void 0===E)return R;if("comma"===s&&l(E))b&&m&&(E=i.maybeMap(E,m)),I=[{value:E.length>0?E.join(",")||null:void 0}];else if(l(g))I=g;else{var O=Object.keys(E);I=v?O.sort(v):O}var L=d?String(n).replace(/\./g,"%2E"):String(n),D=o&&l(E)&&1===E.length?L+"[]":L;if(a&&l(E)&&0===E.length)return D+"[]";for(var F=0;F<I.length;++F){var N=I[F],B="object"==typeof N&&N&&void 0!==N.value?N.value:E[N];if(!u||null!==B){var W=y&&d?String(N).replace(/\./g,"%2E"):String(N),U=l(E)?"function"==typeof s?s(D,W):D:D+(y?"."+W:"["+W+"]");S.set(e,k);var j=r();j.set(p,S),c(R,t(B,U,s,o,a,h,u,d,"comma"===s&&b&&l(E)?null:m,g,v,y,x,w,_,b,T,j))}}return R};t.exports=function(t,e){var n,i=t,h=function(t){if(!t)return f;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.encodeDotInKeys&&"boolean"!=typeof t.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||f.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=s.default;if(void 0!==t.format){if(!o.call(s.formatters,t.format))throw new TypeError("Unknown format option provided.");n=t.format}var r,i=s.formatters[n],h=f.filter;if(("function"==typeof t.filter||l(t.filter))&&(h=t.filter),r=t.arrayFormat in a?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":f.arrayFormat,"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var c=void 0===t.allowDots?!0===t.encodeDotInKeys||f.allowDots:!!t.allowDots;return{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:f.addQueryPrefix,allowDots:c,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:f.allowEmptyArrays,arrayFormat:r,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:f.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:void 0===t.delimiter?f.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:f.encode,encodeDotInKeys:"boolean"==typeof t.encodeDotInKeys?t.encodeDotInKeys:f.encodeDotInKeys,encoder:"function"==typeof t.encoder?t.encoder:f.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:f.encodeValuesOnly,filter:h,format:n,formatter:i,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:f.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:f.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:f.strictNullHandling}}(e);"function"==typeof h.filter?i=(0,h.filter)("",i):l(h.filter)&&(n=h.filter);var u=[];if("object"!=typeof i||null===i)return"";var d=a[h.arrayFormat],p="comma"===d&&h.commaRoundTrip;n||(n=Object.keys(i)),h.sort&&n.sort(h.sort);for(var g=r(),v=0;v<n.length;++v){var y=n[v],x=i[y];h.skipNulls&&null===x||c(u,m(x,y,d,p,h.allowEmptyArrays,h.strictNullHandling,h.skipNulls,h.encodeDotInKeys,h.encode?h.encoder:null,h.filter,h.sort,h.allowDots,h.serializeDate,h.format,h.formatter,h.encodeValuesOnly,h.charset,g))}var w=u.join(h.delimiter),_=!0===h.addQueryPrefix?"?":"";return h.charsetSentinel&&("iso-8859-1"===h.charset?_+="utf8=%26%2310003%3B&":_+="utf8=%E2%9C%93&"),w.length>0?_+w:""}},8648:function(t){"use strict";t.exports="undefined"!=typeof Reflect&&Reflect.getPrototypeOf||null},8686:function(t,e,n){"use strict";var r=n(3724),i=n(9039);t.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8706:function(t,e,n){"use strict";var r=n(6518),i=n(9039),s=n(4376),o=n(34),a=n(8981),l=n(6198),h=n(6837),c=n(4659),u=n(1469),d=n(597),f=n(8227),p=n(9519),m=f("isConcatSpreadable"),g=p>=51||!i((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),v=function(t){if(!o(t))return!1;var e=t[m];return void 0!==e?!!e:s(t)};r({target:"Array",proto:!0,arity:1,forced:!g||!d("concat")},{concat:function(t){var e,n,r,i,s,o=a(this),d=u(o,0),f=0;for(e=-1,r=arguments.length;e<r;e++)if(v(s=-1===e?o:arguments[e]))for(i=l(s),h(f+i),n=0;n<i;n++,f++)n in s&&c(d,f,s[n]);else h(f+1),c(d,f++,s);return d.length=f,d}})},8727:function(t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8745:function(t,e,n){"use strict";var r=n(616),i=Function.prototype,s=i.apply,o=i.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?o.bind(s):function(){return o.apply(s,arguments)})},8773:function(t,e){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);e.f=i?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},8781:function(t,e,n){"use strict";var r=n(350).PROPER,i=n(6840),s=n(8551),o=n(655),a=n(9039),l=n(1034),h="toString",c=RegExp.prototype,u=c[h],d=a((function(){return"/a/b"!==u.call({source:"a",flags:"b"})})),f=r&&u.name!==h;(d||f)&&i(c,h,(function(){var t=s(this);return"/"+o(t.source)+"/"+o(l(t))}),{unsafe:!0})},8814:function(t,e,n){"use strict";var r=n(9039),i=n(4576).RegExp;t.exports=r((function(){var t=i("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},8835:function(t,e,n){"use strict";var r=n(1270);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var s=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(l),c=["%","/","?",";","#"].concat(h),u=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=n(5373);function y(t,e,n){if(t&&"object"==typeof t&&t instanceof i)return t;var r=new i;return r.parse(t,e,n),r}i.prototype.parse=function(t,e,n){if("string"!=typeof t)throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),o=-1!==i&&i<t.indexOf("#")?"?":"#",l=t.split(o);l[0]=l[0].replace(/\\/g,"/");var y=t=l.join(o);if(y=y.trim(),!n&&1===t.split("#").length){var x=a.exec(y);if(x)return this.path=y,this.href=y,this.pathname=x[1],x[2]?(this.search=x[2],this.query=e?v.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var w=s.exec(y);if(w){var _=(w=w[0]).toLowerCase();this.protocol=_,y=y.substr(w.length)}if(n||w||y.match(/^\/\/[^@/]+@[^@/]+/)){var b="//"===y.substr(0,2);!b||w&&m[w]||(y=y.substr(2),this.slashes=!0)}if(!m[w]&&(b||w&&!g[w])){for(var T,S,A=-1,E=0;E<u.length;E++)-1!==(C=y.indexOf(u[E]))&&(-1===A||C<A)&&(A=C);for(-1!==(S=-1===A?y.lastIndexOf("@"):y.lastIndexOf("@",A))&&(T=y.slice(0,S),y=y.slice(S+1),this.auth=decodeURIComponent(T)),A=-1,E=0;E<c.length;E++){var C;-1!==(C=y.indexOf(c[E]))&&(-1===A||C<A)&&(A=C)}-1===A&&(A=y.length),this.host=y.slice(0,A),y=y.slice(A),this.parseHost(),this.hostname=this.hostname||"";var k="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!k)for(var M=this.hostname.split(/\./),P=(E=0,M.length);E<P;E++){var I=M[E];if(I&&!I.match(d)){for(var R="",O=0,L=I.length;O<L;O++)I.charCodeAt(O)>127?R+="x":R+=I[O];if(!R.match(d)){var D=M.slice(0,E),F=M.slice(E+1),N=I.match(f);N&&(D.push(N[1]),F.unshift(N[2])),F.length&&(y="/"+F.join(".")+y),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),k||(this.hostname=r.toASCII(this.hostname));var B=this.port?":"+this.port:"",W=this.hostname||"";this.host=W+B,this.href+=this.host,k&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y))}if(!p[_])for(E=0,P=h.length;E<P;E++){var U=h[E];if(-1!==y.indexOf(U)){var j=encodeURIComponent(U);j===U&&(j=escape(U)),y=y.split(U).join(j)}}var H=y.indexOf("#");-1!==H&&(this.hash=y.substr(H),y=y.slice(0,H));var z=y.indexOf("?");if(-1!==z?(this.search=y.substr(z),this.query=y.substr(z+1),e&&(this.query=v.parse(this.query)),y=y.slice(0,z)):e&&(this.search="",this.query={}),y&&(this.pathname=y),g[_]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var G=this.search||"";this.path=B+G}return this.href=this.format(),this},i.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(s=v.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||g[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),e+i+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(o=o.replace("#","%23"))+r},i.prototype.resolve=function(t){return this.resolveObject(y(t,!1,!0)).format()},i.prototype.resolveObject=function(t){if("string"==typeof t){var e=new i;e.parse(t,!1,!0),t=e}for(var n=new i,r=Object.keys(this),s=0;s<r.length;s++){var o=r[s];n[o]=this[o]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),l=0;l<a.length;l++){var h=a[l];"protocol"!==h&&(n[h]=t[h])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.pathname="/",n.path=n.pathname),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!g[t.protocol]){for(var c=Object.keys(t),u=0;u<c.length;u++){var d=c[u];n[d]=t[d]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||m[t.protocol])n.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),n.pathname=f.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var p=n.pathname||"",v=n.search||"";n.path=p+v}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),x=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=x||y||n.host&&t.pathname,_=w,b=n.pathname&&n.pathname.split("/")||[],T=(f=t.pathname&&t.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(T&&(n.hostname="",n.port=null,n.host&&(""===b[0]?b[0]=n.host:b.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),w=w&&(""===f[0]||""===b[0])),x)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,b=f;else if(f.length)b||(b=[]),b.pop(),b=b.concat(f),n.search=t.search,n.query=t.query;else if(null!=t.search)return T&&(n.host=b.shift(),n.hostname=n.host,(k=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=k.shift(),n.hostname=k.shift(),n.host=n.hostname)),n.search=t.search,n.query=t.query,null===n.pathname&&null===n.search||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!b.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var S=b.slice(-1)[0],A=(n.host||t.host||b.length>1)&&("."===S||".."===S)||""===S,E=0,C=b.length;C>=0;C--)"."===(S=b[C])?b.splice(C,1):".."===S?(b.splice(C,1),E++):E&&(b.splice(C,1),E--);if(!w&&!_)for(;E--;E)b.unshift("..");!w||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),A&&"/"!==b.join("/").substr(-1)&&b.push("");var k,M=""===b[0]||b[0]&&"/"===b[0].charAt(0);return T&&(n.hostname=M?"":b.length?b.shift():"",n.host=n.hostname,(k=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=k.shift(),n.hostname=k.shift(),n.host=n.hostname)),(w=w||n.host&&b.length)&&!M&&b.unshift(""),b.length>0?n.pathname=b.join("/"):(n.pathname=null,n.path=null),null===n.pathname&&null===n.search||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var t=this.host,e=o.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)},e.qg=y,e.hd=function(t,e){return y(t,!1,!0).resolve(e)},e.GP=function(t){return"string"==typeof t&&(t=y(t)),t instanceof i?t.format():i.prototype.format.call(t)}},8859:function(t,e,n){var r="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,s=r&&i&&"function"==typeof i.get?i.get:null,o=r&&Map.prototype.forEach,a="function"==typeof Set&&Set.prototype,l=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,h=a&&l&&"function"==typeof l.get?l.get:null,c=a&&Set.prototype.forEach,u="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,d="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,f="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,m=Object.prototype.toString,g=Function.prototype.toString,v=String.prototype.match,y=String.prototype.slice,x=String.prototype.replace,w=String.prototype.toUpperCase,_=String.prototype.toLowerCase,b=RegExp.prototype.test,T=Array.prototype.concat,S=Array.prototype.join,A=Array.prototype.slice,E=Math.floor,C="function"==typeof BigInt?BigInt.prototype.valueOf:null,k=Object.getOwnPropertySymbols,M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,P="function"==typeof Symbol&&"object"==typeof Symbol.iterator,I="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,R=Object.prototype.propertyIsEnumerable,O=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function L(t,e){if(t===1/0||t===-1/0||t!=t||t&&t>-1e3&&t<1e3||b.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var r=t<0?-E(-t):E(t);if(r!==t){var i=String(r),s=y.call(e,i.length+1);return x.call(i,n,"$&_")+"."+x.call(x.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return x.call(e,n,"$&_")}var D=n(2634),F=D.custom,N=V(F)?F:null,B={__proto__:null,double:'"',single:"'"},W={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};function U(t,e,n){var r=n.quoteStyle||e,i=B[r];return i+t+i}function j(t){return x.call(String(t),/"/g,"&quot;")}function H(t){return!I||!("object"==typeof t&&(I in t||void 0!==t[I]))}function z(t){return"[object Array]"===$(t)&&H(t)}function G(t){return"[object RegExp]"===$(t)&&H(t)}function V(t){if(P)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return!0;if(!t||"object"!=typeof t||!M)return!1;try{return M.call(t),!0}catch(t){}return!1}t.exports=function t(e,r,i,a){var l=r||{};if(Y(l,"quoteStyle")&&!Y(B,l.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Y(l,"maxStringLength")&&("number"==typeof l.maxStringLength?l.maxStringLength<0&&l.maxStringLength!==1/0:null!==l.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var m=!Y(l,"customInspect")||l.customInspect;if("boolean"!=typeof m&&"symbol"!==m)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Y(l,"indent")&&null!==l.indent&&"\t"!==l.indent&&!(parseInt(l.indent,10)===l.indent&&l.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Y(l,"numericSeparator")&&"boolean"!=typeof l.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var w=l.numericSeparator;if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return K(e,l);if("number"==typeof e){if(0===e)return 1/0/e>0?"0":"-0";var b=String(e);return w?L(e,b):b}if("bigint"==typeof e){var E=String(e)+"n";return w?L(e,E):E}var k=void 0===l.depth?5:l.depth;if(void 0===i&&(i=0),i>=k&&k>0&&"object"==typeof e)return z(e)?"[Array]":"[Object]";var F,W=function(t,e){var n;if("\t"===t.indent)n="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;n=S.call(Array(t.indent+1)," ")}return{base:n,prev:S.call(Array(e+1),n)}}(l,i);if(void 0===a)a=[];else if(q(a,e)>=0)return"[Circular]";function X(e,n,r){if(n&&(a=A.call(a)).push(n),r){var s={depth:l.depth};return Y(l,"quoteStyle")&&(s.quoteStyle=l.quoteStyle),t(e,s,i+1,a)}return t(e,l,i+1,a)}if("function"==typeof e&&!G(e)){var Z=function(t){if(t.name)return t.name;var e=v.call(g.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}(e),rt=nt(e,X);return"[Function"+(Z?": "+Z:" (anonymous)")+"]"+(rt.length>0?" { "+S.call(rt,", ")+" }":"")}if(V(e)){var it=P?x.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):M.call(e);return"object"!=typeof e||P?it:Q(it)}if((F=e)&&"object"==typeof F&&("undefined"!=typeof HTMLElement&&F instanceof HTMLElement||"string"==typeof F.nodeName&&"function"==typeof F.getAttribute)){for(var st="<"+_.call(String(e.nodeName)),ot=e.attributes||[],at=0;at<ot.length;at++)st+=" "+ot[at].name+"="+U(j(ot[at].value),"double",l);return st+=">",e.childNodes&&e.childNodes.length&&(st+="..."),st+"</"+_.call(String(e.nodeName))+">"}if(z(e)){if(0===e.length)return"[]";var lt=nt(e,X);return W&&!function(t){for(var e=0;e<t.length;e++)if(q(t[e],"\n")>=0)return!1;return!0}(lt)?"["+et(lt,W)+"]":"[ "+S.call(lt,", ")+" ]"}if(function(t){return"[object Error]"===$(t)&&H(t)}(e)){var ht=nt(e,X);return"cause"in Error.prototype||!("cause"in e)||R.call(e,"cause")?0===ht.length?"["+String(e)+"]":"{ ["+String(e)+"] "+S.call(ht,", ")+" }":"{ ["+String(e)+"] "+S.call(T.call("[cause]: "+X(e.cause),ht),", ")+" }"}if("object"==typeof e&&m){if(N&&"function"==typeof e[N]&&D)return D(e,{depth:k-i});if("symbol"!==m&&"function"==typeof e.inspect)return e.inspect()}if(function(t){if(!s||!t||"object"!=typeof t)return!1;try{s.call(t);try{h.call(t)}catch(t){return!0}return t instanceof Map}catch(t){}return!1}(e)){var ct=[];return o&&o.call(e,(function(t,n){ct.push(X(n,e,!0)+" => "+X(t,e))})),tt("Map",s.call(e),ct,W)}if(function(t){if(!h||!t||"object"!=typeof t)return!1;try{h.call(t);try{s.call(t)}catch(t){return!0}return t instanceof Set}catch(t){}return!1}(e)){var ut=[];return c&&c.call(e,(function(t){ut.push(X(t,e))})),tt("Set",h.call(e),ut,W)}if(function(t){if(!u||!t||"object"!=typeof t)return!1;try{u.call(t,u);try{d.call(t,d)}catch(t){return!0}return t instanceof WeakMap}catch(t){}return!1}(e))return J("WeakMap");if(function(t){if(!d||!t||"object"!=typeof t)return!1;try{d.call(t,d);try{u.call(t,u)}catch(t){return!0}return t instanceof WeakSet}catch(t){}return!1}(e))return J("WeakSet");if(function(t){if(!f||!t||"object"!=typeof t)return!1;try{return f.call(t),!0}catch(t){}return!1}(e))return J("WeakRef");if(function(t){return"[object Number]"===$(t)&&H(t)}(e))return Q(X(Number(e)));if(function(t){if(!t||"object"!=typeof t||!C)return!1;try{return C.call(t),!0}catch(t){}return!1}(e))return Q(X(C.call(e)));if(function(t){return"[object Boolean]"===$(t)&&H(t)}(e))return Q(p.call(e));if(function(t){return"[object String]"===$(t)&&H(t)}(e))return Q(X(String(e)));if("undefined"!=typeof window&&e===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&e===globalThis||void 0!==n.g&&e===n.g)return"{ [object globalThis] }";if(!function(t){return"[object Date]"===$(t)&&H(t)}(e)&&!G(e)){var dt=nt(e,X),ft=O?O(e)===Object.prototype:e instanceof Object||e.constructor===Object,pt=e instanceof Object?"":"null prototype",mt=!ft&&I&&Object(e)===e&&I in e?y.call($(e),8,-1):pt?"Object":"",gt=(ft||"function"!=typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(mt||pt?"["+S.call(T.call([],mt||[],pt||[]),": ")+"] ":"");return 0===dt.length?gt+"{}":W?gt+"{"+et(dt,W)+"}":gt+"{ "+S.call(dt,", ")+" }"}return String(e)};var X=Object.prototype.hasOwnProperty||function(t){return t in this};function Y(t,e){return X.call(t,e)}function $(t){return m.call(t)}function q(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function K(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return K(y.call(t,0,e.maxStringLength),e)+r}var i=W[e.quoteStyle||"single"];return i.lastIndex=0,U(x.call(x.call(t,i,"\\$1"),/[\x00-\x1f]/g,Z),"single",e)}function Z(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+w.call(e.toString(16))}function Q(t){return"Object("+t+")"}function J(t){return t+" { ? }"}function tt(t,e,n,r){return t+" ("+e+") {"+(r?et(n,r):S.call(n,", "))+"}"}function et(t,e){if(0===t.length)return"";var n="\n"+e.prev+e.base;return n+S.call(t,","+n)+"\n"+e.prev}function nt(t,e){var n=z(t),r=[];if(n){r.length=t.length;for(var i=0;i<t.length;i++)r[i]=Y(t,i)?e(t[i],t):""}var s,o="function"==typeof k?k(t):[];if(P){s={};for(var a=0;a<o.length;a++)s["$"+o[a]]=o[a]}for(var l in t)Y(t,l)&&(n&&String(Number(l))===l&&l<t.length||P&&s["$"+l]instanceof Symbol||(b.call(/[^\w$]/,l)?r.push(e(l,t)+": "+e(t[l],t)):r.push(l+": "+e(t[l],t))));if("function"==typeof k)for(var h=0;h<o.length;h++)R.call(t,o[h])&&r.push("["+e(o[h])+"]: "+e(t[o[h]],t));return r}},8940:function(t,e,n){"use strict";var r=n(6518),i=n(2703);r({global:!0,forced:parseInt!==i},{parseInt:i})},8968:function(t){"use strict";t.exports=Math.floor},8981:function(t,e,n){"use strict";var r=n(7750),i=Object;t.exports=function(t){return i(r(t))}},8992:function(t,e,n){"use strict";n(8111)},9039:function(t){"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},9085:function(t,e,n){"use strict";var r=n(6518),i=n(4213);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==i},{assign:i})},9167:function(t,e,n){"use strict";var r=n(4576);t.exports=r},9213:function(t,e,n){"use strict";var r=n(6080),i=n(9504),s=n(7055),o=n(8981),a=n(6198),l=n(1469),h=i([].push),c=function(t){var e=1===t,n=2===t,i=3===t,c=4===t,u=6===t,d=7===t,f=5===t||u;return function(p,m,g,v){for(var y,x,w=o(p),_=s(w),b=a(_),T=r(m,g),S=0,A=v||l,E=e?A(p,b):n||d?A(p,0):void 0;b>S;S++)if((f||S in _)&&(x=T(y=_[S],S,w),t))if(e)E[S]=x;else if(x)switch(t){case 3:return!0;case 5:return y;case 6:return S;case 2:h(E,y)}else switch(t){case 4:return!1;case 7:h(E,y)}return u?-1:i||c?c:E}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterReject:c(7)}},9225:function(t,e,n){"use strict";var r,i,s,o,a=n(4576),l=n(8745),h=n(6080),c=n(4901),u=n(9297),d=n(9039),f=n(397),p=n(7680),m=n(4055),g=n(2812),v=n(9544),y=n(8574),x=a.setImmediate,w=a.clearImmediate,_=a.process,b=a.Dispatch,T=a.Function,S=a.MessageChannel,A=a.String,E=0,C={},k="onreadystatechange";d((function(){r=a.location}));var M=function(t){if(u(C,t)){var e=C[t];delete C[t],e()}},P=function(t){return function(){M(t)}},I=function(t){M(t.data)},R=function(t){a.postMessage(A(t),r.protocol+"//"+r.host)};x&&w||(x=function(t){g(arguments.length,1);var e=c(t)?t:T(t),n=p(arguments,1);return C[++E]=function(){l(e,void 0,n)},i(E),E},w=function(t){delete C[t]},y?i=function(t){_.nextTick(P(t))}:b&&b.now?i=function(t){b.now(P(t))}:S&&!v?(o=(s=new S).port2,s.port1.onmessage=I,i=h(o.postMessage,o)):a.addEventListener&&c(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!d(R)?(i=R,a.addEventListener("message",I,!1)):i=k in m("script")?function(t){f.appendChild(m("script"))[k]=function(){f.removeChild(this),M(t)}}:function(t){setTimeout(P(t),0)}),t.exports={set:x,clear:w}},9228:function(t,e,n){"use strict";n(7495);var r=n(9565),i=n(6840),s=n(7323),o=n(9039),a=n(8227),l=n(6699),h=a("species"),c=RegExp.prototype;t.exports=function(t,e,n,u){var d=a(t),f=!o((function(){var e={};return e[d]=function(){return 7},7!==""[t](e)})),p=f&&!o((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[h]=function(){return n},n.flags="",n[d]=/./[d]),n.exec=function(){return e=!0,null},n[d](""),!e}));if(!f||!p||n){var m=/./[d],g=e(d,""[t],(function(t,e,n,i,o){var a=e.exec;return a===s||a===c.exec?f&&!o?{done:!0,value:r(m,e,n,i)}:{done:!0,value:r(t,n,e,i)}:{done:!1}}));i(String.prototype,t,g[0]),i(c,d,g[1])}u&&l(c[d],"sham",!0)}},9290:function(t){"use strict";t.exports=RangeError},9296:function(t,e,n){"use strict";var r=n(4055)("span").classList,i=r&&r.constructor&&r.constructor.prototype;t.exports=i===Object.prototype?void 0:i},9297:function(t,e,n){"use strict";var r=n(9504),i=n(8981),s=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return s(i(t),e)}},9306:function(t,e,n){"use strict";var r=n(4901),i=n(6823),s=TypeError;t.exports=function(t){if(r(t))return t;throw new s(i(t)+" is not a function")}},9353:function(t){"use strict";var e=Object.prototype.toString,n=Math.max,r=function(t,e){for(var n=[],r=0;r<t.length;r+=1)n[r]=t[r];for(var i=0;i<e.length;i+=1)n[i+t.length]=e[i];return n};t.exports=function(t){var i=this;if("function"!=typeof i||"[object Function]"!==e.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var s,o=function(t){for(var e=[],n=1,r=0;n<t.length;n+=1,r+=1)e[r]=t[n];return e}(arguments),a=n(0,i.length-o.length),l=[],h=0;h<a;h++)l[h]="$"+h;if(s=Function("binder","return function ("+function(t){for(var e="",n=0;n<t.length;n+=1)e+=t[n],n+1<t.length&&(e+=",");return e}(l)+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof s){var e=i.apply(this,r(o,arguments));return Object(e)===e?e:this}return i.apply(t,r(o,arguments))})),i.prototype){var c=function(){};c.prototype=i.prototype,s.prototype=new c,c.prototype=null}return s}},9383:function(t){"use strict";t.exports=Error},9391:function(t,e,n){"use strict";var r=n(6518),i=n(6395),s=n(550),o=n(9039),a=n(7751),l=n(4901),h=n(2293),c=n(3438),u=n(6840),d=s&&s.prototype;if(r({target:"Promise",proto:!0,real:!0,forced:!!s&&o((function(){d.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=h(this,a("Promise")),n=l(t);return this.then(n?function(n){return c(e,t()).then((function(){return n}))}:t,n?function(n){return c(e,t()).then((function(){throw n}))}:t)}}),!i&&l(s)){var f=a("Promise").prototype.finally;d.finally!==f&&u(d,"finally",f,{unsafe:!0})}},9432:function(t,e,n){"use strict";var r=n(6518),i=n(8981),s=n(1072);r({target:"Object",stat:!0,forced:n(9039)((function(){s(1)}))},{keys:function(t){return s(i(t))}})},9433:function(t,e,n){"use strict";var r=n(4576),i=Object.defineProperty;t.exports=function(t,e){try{i(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},9462:function(t,e,n){"use strict";var r=n(9565),i=n(2360),s=n(6699),o=n(6279),a=n(8227),l=n(1181),h=n(5966),c=n(7657).IteratorPrototype,u=n(2529),d=n(9539),f=a("toStringTag"),p="IteratorHelper",m="WrapForValidIterator",g=l.set,v=function(t){var e=l.getterFor(t?m:p);return o(i(c),{next:function(){var n=e(this);if(t)return n.nextHandler();if(n.done)return u(void 0,!0);try{var r=n.nextHandler();return n.returnHandlerResult?r:u(r,n.done)}catch(t){throw n.done=!0,t}},return:function(){var n=e(this),i=n.iterator;if(n.done=!0,t){var s=h(i,"return");return s?r(s,i):u(void 0,!0)}if(n.inner)try{d(n.inner.iterator,"normal")}catch(t){return d(i,"throw",t)}return i&&d(i,"normal"),u(void 0,!0)}})},y=v(!0),x=v(!1);s(x,f,"Iterator Helper"),t.exports=function(t,e,n){var r=function(r,i){i?(i.iterator=r.iterator,i.next=r.next):i=r,i.type=e?m:p,i.returnHandlerResult=!!n,i.nextHandler=t,i.counter=0,i.done=!1,g(this,i)};return r.prototype=e?y:x,r}},9463:function(t,e,n){"use strict";var r=n(6518),i=n(3724),s=n(4576),o=n(9504),a=n(9297),l=n(4901),h=n(1625),c=n(655),u=n(2106),d=n(7740),f=s.Symbol,p=f&&f.prototype;if(i&&l(f)&&(!("description"in p)||void 0!==f().description)){var m={},g=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:c(arguments[0]),e=h(p,this)?new f(t):void 0===t?f():f(t);return""===t&&(m[e]=!0),e};d(g,f),g.prototype=p,p.constructor=g;var v="Symbol(description detection)"===String(f("description detection")),y=o(p.valueOf),x=o(p.toString),w=/^Symbol\((.*)\)[^)]+$/,_=o("".replace),b=o("".slice);u(p,"description",{configurable:!0,get:function(){var t=y(this);if(a(m,t))return"";var e=x(t),n=v?b(e,7,-1):_(e,w,"$1");return""===n?void 0:n}}),r({global:!0,constructor:!0,forced:!0},{Symbol:g})}},9479:function(t,e,n){"use strict";var r=n(4576),i=n(3724),s=n(2106),o=n(7979),a=n(9039),l=r.RegExp,h=l.prototype;i&&a((function(){var t=!0;try{l(".","d")}catch(e){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",i=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var o in t&&(s.hasIndices="d"),s)i(o,s[o]);return Object.getOwnPropertyDescriptor(h,"flags").get.call(e)!==r||n!==r}))&&s(h,"flags",{configurable:!0,get:o})},9504:function(t,e,n){"use strict";var r=n(616),i=Function.prototype,s=i.call,o=r&&i.bind.bind(s,s);t.exports=r?o:function(t){return function(){return s.apply(t,arguments)}}},9519:function(t,e,n){"use strict";var r,i,s=n(4576),o=n(2839),a=s.process,l=s.Deno,h=a&&a.versions||l&&l.version,c=h&&h.v8;c&&(i=(r=c.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(i=+r[1]),t.exports=i},9538:function(t){"use strict";t.exports=ReferenceError},9539:function(t,e,n){"use strict";var r=n(9565),i=n(8551),s=n(5966);t.exports=function(t,e,n){var o,a;i(t);try{if(!(o=s(t,"return"))){if("throw"===e)throw n;return n}o=r(o,t)}catch(t){a=!0,o=t}if("throw"===e)throw n;if(a)throw o;return i(o),n}},9544:function(t,e,n){"use strict";var r=n(2839);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},9565:function(t,e,n){"use strict";var r=n(616),i=Function.prototype.call;t.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},9612:function(t){"use strict";t.exports=Object},9617:function(t,e,n){"use strict";var r=n(5397),i=n(5610),s=n(6198),o=function(t){return function(e,n,o){var a=r(e),l=s(a);if(0===l)return!t&&-1;var h,c=i(o,l);if(t&&n!=n){for(;l>c;)if((h=a[c++])!=h)return!0}else for(;l>c;c++)if((t||c in a)&&a[c]===n)return t||c||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},9675:function(t){"use strict";t.exports=TypeError},9773:function(t,e,n){"use strict";var r=n(6518),i=n(4495),s=n(9039),o=n(3717),a=n(8981);r({target:"Object",stat:!0,forced:!i||s((function(){o.f(1)}))},{getOwnPropertySymbols:function(t){var e=o.f;return e?e(a(t)):[]}})},9868:function(t,e,n){"use strict";var r=n(6518),i=n(9504),s=n(1291),o=n(1240),a=n(2333),l=n(9039),h=RangeError,c=String,u=Math.floor,d=i(a),f=i("".slice),p=i(1..toFixed),m=function(t,e,n){return 0===e?n:e%2==1?m(t,e-1,n*t):m(t*t,e/2,n)},g=function(t,e,n){for(var r=-1,i=n;++r<6;)i+=e*t[r],t[r]=i%1e7,i=u(i/1e7)},v=function(t,e){for(var n=6,r=0;--n>=0;)r+=t[n],t[n]=u(r/e),r=r%e*1e7},y=function(t){for(var e=6,n="";--e>=0;)if(""!==n||0===e||0!==t[e]){var r=c(t[e]);n=""===n?r:n+d("0",7-r.length)+r}return n};r({target:"Number",proto:!0,forced:l((function(){return"0.000"!==p(8e-5,3)||"1"!==p(.9,0)||"1.25"!==p(1.255,2)||"1000000000000000128"!==p(0xde0b6b3a7640080,0)}))||!l((function(){p({})}))},{toFixed:function(t){var e,n,r,i,a=o(this),l=s(t),u=[0,0,0,0,0,0],p="",x="0";if(l<0||l>20)throw new h("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return c(a);if(a<0&&(p="-",a=-a),a>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(a*m(2,69,1))-69)<0?a*m(2,-e,1):a/m(2,e,1),n*=4503599627370496,(e=52-e)>0){for(g(u,0,n),r=l;r>=7;)g(u,1e7,0),r-=7;for(g(u,m(10,r,1),0),r=e-1;r>=23;)v(u,1<<23),r-=23;v(u,1<<r),g(u,1,1),v(u,2),x=y(u)}else g(u,0,n),g(u,1<<-e,0),x=y(u)+d("0",l);return l>0?p+((i=x.length)<=l?"0."+d("0",l-i)+x:f(x,0,i-l)+"."+f(x,i-l)):p+x}})},9957:function(t,e,n){"use strict";var r=Function.prototype.call,i=Object.prototype.hasOwnProperty,s=n(6743);t.exports=s.call(r,i)}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var s=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,{a:e}),e},r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},r.nc=void 0,function(){"use strict";var e={};r.r(e),r.d(e,{BaseTextureCache:function(){return Ce},BoundingBox:function(){return Se},CanvasRenderTarget:function(){return Pe},DATA_URI:function(){return ue},EventEmitter:function(){return dt},ProgramCache:function(){return Ae},TextureCache:function(){return Ee},clearTextureCache:function(){return Me},correctBlendMode:function(){return ae},createIndicesForQuads:function(){return de},decomposeDataUri:function(){return De},deprecation:function(){return gt},destroyTextureCache:function(){return ke},detectVideoAlphaMode:function(){return Tt},determineCrossOrigin:function(){return Fe},earcut:function(){return ft},getBufferType:function(){return fe},getCanvasBoundingBox:function(){return Oe},getResolutionOfUrl:function(){return Ne},hex2rgb:function(){return ne},hex2string:function(){return re},interleaveTypedArrays:function(){return me},isMobile:function(){return ut},isPow2:function(){return ve},isWebGLSupported:function(){return Et},log2:function(){return ye},nextPow2:function(){return ge},path:function(){return wt},premultiplyBlendMode:function(){return oe},premultiplyRgba:function(){return le},premultiplyTint:function(){return he},premultiplyTintToRgba:function(){return ce},removeItems:function(){return xe},rgb2hex:function(){return se},sayHello:function(){return At},sign:function(){return we},skipHello:function(){return St},string2hex:function(){return ie},trimCanvas:function(){return Le},uid:function(){return be},url:function(){return vt}});var n=r(5072),i=r.n(n),s=r(7825),o=r.n(s),a=r(7659),l=r.n(a),h=r(5056),c=r.n(h),u=r(540),d=r.n(u),f=r(1113),p=r.n(f),m=r(1208),g={};function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function x(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,x(r.key),r)}}function _(t,e,n){return e&&w(t.prototype,e),n&&w(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function b(t,e){if(e&&("object"==y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function S(t,e){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},S(t,e)}function A(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}function E(t,e,n){return(e=x(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}g.styleTagTransform=p(),g.setAttributes=c(),g.insert=l().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=d(),i()(m.A,g),m.A&&m.A.locals&&m.A.locals,r(825),r(6280),r(3792),r(6099),r(7764),r(3772),r(958),r(8992),r(3949),r(3500),r(2953);var C=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(C||{}),k=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(k||{}),M=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(M||{}),P=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(P||{}),I=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(I||{}),R=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(R||{}),O=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(O||{}),L=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(L||{}),D=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(D||{}),F=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(F||{}),N=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(N||{}),B=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(B||{}),W=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(W||{}),U=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(U||{}),j=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(j||{}),H=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(H||{}),z=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(z||{}),G=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(G||{}),V=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(V||{});const X={createCanvas:(t,e)=>{const n=document.createElement("canvas");return n.width=t,n.height=e,n},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")},Y={ADAPTER:X,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var $=/iPhone/i,q=/iPod/i,K=/iPad/i,Z=/\biOS-universal(?:.+)Mac\b/i,Q=/\bAndroid(?:.+)Mobile\b/i,J=/Android/i,tt=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,et=/Silk/i,nt=/Windows Phone/i,rt=/\bWindows(?:.+)ARM\b/i,it=/BlackBerry/i,st=/BB10/i,ot=/Opera Mini/i,at=/\b(CriOS|Chrome)(?:.+)Mobile/i,lt=/Mobile(?:.+)Firefox\b/i,ht=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};function ct(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,r=n.split("[FBAN");void 0!==r[1]&&(n=r[0]),void 0!==(r=n.split("Twitter"))[1]&&(n=r[0]);var i=function(t){return function(e){return e.test(t)}}(n),s={apple:{phone:i($)&&!i(nt),ipod:i(q),tablet:!i($)&&(i(K)||ht(e))&&!i(nt),universal:i(Z),device:(i($)||i(q)||i(K)||i(Z)||ht(e))&&!i(nt)},amazon:{phone:i(tt),tablet:!i(tt)&&i(et),device:i(tt)||i(et)},android:{phone:!i(nt)&&i(tt)||!i(nt)&&i(Q),tablet:!i(nt)&&!i(tt)&&!i(Q)&&(i(et)||i(J)),device:!i(nt)&&(i(tt)||i(et)||i(Q)||i(J))||i(/\bokhttp\b/i)},windows:{phone:i(nt),tablet:i(rt),device:i(nt)||i(rt)},other:{blackberry:i(it),blackberry10:i(st),opera:i(ot),firefox:i(lt),chrome:i(at),device:i(it)||i(st)||i(ot)||i(lt)||i(at)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const ut=(ct.default??ct)(globalThis.navigator);Y.RETINA_PREFIX=/@([0-9\.]+)x/,Y.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var dt=r(228),ft=r(6570),pt=r(8835);const mt={};function gt(t,e,n=3){if(mt[e])return;let r=(new Error).stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`):(r=r.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}\nDeprecated since v${t}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`),console.warn(r))),mt[e]=!0}const vt={get parse(){return gt("7.3.0","utils.url.parse is deprecated, use native URL API instead."),pt.qg},get format(){return gt("7.3.0","utils.url.format is deprecated, use native URL API instead."),pt.GP},get resolve(){return gt("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),pt.hd}};function yt(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function xt(t){return t.split("?")[0].split("#")[0]}const wt={toPosix(t){return t.replace(new RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},isBlobUrl(t){return t.startsWith("blob:")},hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){yt(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const n=/^[^/:]+:\/{0,2}/.exec(t);return n?n[0]:""},toAbsolute(t,e,n){if(yt(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const r=xt(this.toPosix(e??Y.ADAPTER.getBaseUrl())),i=xt(this.toPosix(n??this.rootname(r)));return(t=this.toPosix(t)).startsWith("/")?wt.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(r,t)},normalize(t){if(yt(t),0===t.length)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;let e="";const n=(t=this.toPosix(t)).startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const r=t.endsWith("/");return t=function(t){let e="",n=0,r=-1,i=0,s=-1;for(let o=0;o<=t.length;++o){if(o<t.length)s=t.charCodeAt(o);else{if(47===s)break;s=47}if(47===s){if(r!==o-1&&1!==i)if(r!==o-1&&2===i){if(e.length<2||2!==n||46!==e.charCodeAt(e.length-1)||46!==e.charCodeAt(e.length-2))if(e.length>2){const t=e.lastIndexOf("/");if(t!==e.length-1){-1===t?(e="",n=0):(e=e.slice(0,t),n=e.length-1-e.lastIndexOf("/")),r=o,i=0;continue}}else if(2===e.length||1===e.length){e="",n=0,r=o,i=0;continue}}else e.length>0?e+=`/${t.slice(r+1,o)}`:e=t.slice(r+1,o),n=o-r-1;r=o,i=0}else 46===s&&-1!==i?++i:i=-1}return e}(t),t.length>0&&r&&(t+="/"),n?`/${t}`:e+t},isAbsolute(t){return yt(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){if(0===t.length)return".";let e;for(let n=0;n<t.length;++n){const r=t[n];if(yt(r),r.length>0)if(void 0===e)e=r;else{const i=t[n-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?e+=`/../${r}`:e+=`/${r}`}}return void 0===e?".":this.normalize(e)},dirname(t){if(yt(t),0===t.length)return".";let e=(t=this.toPosix(t)).charCodeAt(0);const n=47===e;let r=-1,i=!0;const s=this.getProtocol(t),o=t;for(let n=(t=t.slice(s.length)).length-1;n>=1;--n)if(e=t.charCodeAt(n),47===e){if(!i){r=n;break}}else i=!1;return-1===r?n?"/":this.isUrl(o)?s+t:s:n&&1===r?"//":s+t.slice(0,r)},rootname(t){yt(t);let e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const n=t.indexOf("/",e.length);e=-1!==n?t.slice(0,n):t,e.endsWith("/")||(e+="/")}return e},basename(t,e){yt(t),e&&yt(e),t=xt(this.toPosix(t));let n,r=0,i=-1,s=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(n=t.length-1;n>=0;--n){const l=t.charCodeAt(n);if(47===l){if(!s){r=n+1;break}}else-1===a&&(s=!1,a=n+1),o>=0&&(l===e.charCodeAt(o)?-1==--o&&(i=n):(o=-1,i=a))}return r===i?i=a:-1===i&&(i=t.length),t.slice(r,i)}for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!s){r=n+1;break}}else-1===i&&(s=!1,i=n+1);return-1===i?"":t.slice(r,i)},extname(t){yt(t);let e=-1,n=0,r=-1,i=!0,s=0;for(let o=(t=xt(this.toPosix(t))).length-1;o>=0;--o){const a=t.charCodeAt(o);if(47!==a)-1===r&&(i=!1,r=o+1),46===a?-1===e?e=o:1!==s&&(s=1):-1!==e&&(s=-1);else if(!i){n=o+1;break}}return-1===e||-1===r||0===s||1===s&&e===r-1&&e===n+1?"":t.slice(e,r)},parse(t){yt(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;let n=(t=xt(this.toPosix(t))).charCodeAt(0);const r=this.isAbsolute(t);let i;e.root=this.rootname(t),i=r||this.hasProtocol(t)?1:0;let s=-1,o=0,a=-1,l=!0,h=t.length-1,c=0;for(;h>=i;--h)if(n=t.charCodeAt(h),47!==n)-1===a&&(l=!1,a=h+1),46===n?-1===s?s=h:1!==c&&(c=1):-1!==s&&(c=-1);else if(!l){o=h+1;break}return-1===s||-1===a||0===c||1===c&&s===a-1&&s===o+1?-1!==a&&(e.base=e.name=0===o&&r?t.slice(1,a):t.slice(o,a)):(0===o&&r?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(o,s),e.base=t.slice(o,a)),e.ext=t.slice(s,a)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let _t,bt;async function Tt(){return _t??(_t=(async()=>{const t=document.createElement("canvas").getContext("webgl");if(!t)return W.UNPACK;const e=await new Promise((t=>{const e=document.createElement("video");e.onloadeddata=()=>t(e),e.onerror=()=>t(null),e.autoplay=!1,e.crossOrigin="anonymous",e.preload="auto",e.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",e.load()}));if(!e)return W.UNPACK;const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(r),t.deleteTexture(n),t.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?W.PMA:W.UNPACK})()),_t}function St(){gt("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function At(){gt("7.0.0",'sayHello is deprecated, please use Renderer\'s "hello" option')}function Et(){return typeof bt>"u"&&(bt=function(){const t={stencil:!0,failIfMajorPerformanceCaveat:Y.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Y.ADAPTER.getWebGLRenderingContext())return!1;const e=Y.ADAPTER.createCanvas();let n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);const r=!!n?.getContextAttributes()?.stencil;if(n){const t=n.getExtension("WEBGL_lose_context");t&&t.loseContext()}return n=null,r}catch{return!1}}()),bt}var Ct={grad:.9,turn:360,rad:360/(2*Math.PI)},kt=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},Mt=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=Math.pow(10,e)),Math.round(n*t)/n+0},Pt=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),t>n?n:t>e?t:e},It=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},Rt=function(t){return{r:Pt(t.r,0,255),g:Pt(t.g,0,255),b:Pt(t.b,0,255),a:Pt(t.a)}},Ot=function(t){return{r:Mt(t.r),g:Mt(t.g),b:Mt(t.b),a:Mt(t.a,3)}},Lt=/^#([0-9a-f]{3,8})$/i,Dt=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Ft=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=Math.max(e,n,r),o=s-Math.min(e,n,r),a=o?s===e?(n-r)/o:s===n?2+(r-e)/o:4+(e-n)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},Nt=function(t){var e=t.h,n=t.s,r=t.v,i=t.a;e=e/360*6,n/=100,r/=100;var s=Math.floor(e),o=r*(1-n),a=r*(1-(e-s)*n),l=r*(1-(1-e+s)*n),h=s%6;return{r:255*[r,a,o,o,l,r][h],g:255*[l,r,r,a,o,o][h],b:255*[o,o,l,r,r,a][h],a:i}},Bt=function(t){return{h:It(t.h),s:Pt(t.s,0,100),l:Pt(t.l,0,100),a:Pt(t.a)}},Wt=function(t){return{h:Mt(t.h),s:Mt(t.s),l:Mt(t.l),a:Mt(t.a,3)}},Ut=function(t){return Nt((n=(e=t).s,{h:e.h,s:(n*=((r=e.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:e.a}));var e,n,r},jt=function(t){return{h:(e=Ft(t)).h,s:(i=(200-(n=e.s))*(r=e.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,n,r,i},Ht=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,zt=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Gt=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Vt=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Xt={string:[[function(t){var e=Lt.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?Mt(parseInt(t[3]+t[3],16)/255,2):1}:6===t.length||8===t.length?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8===t.length?Mt(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=Gt.exec(t)||Vt.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:Rt({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:void 0===e[7]?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=Ht.exec(t)||zt.exec(t);if(!e)return null;var n,r,i=Bt({h:(n=e[1],r=e[2],void 0===r&&(r="deg"),Number(n)*(Ct[r]||1)),s:Number(e[3]),l:Number(e[4]),a:void 0===e[5]?1:Number(e[5])/(e[6]?100:1)});return Ut(i)},"hsl"]],object:[[function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=void 0===i?1:i;return kt(e)&&kt(n)&&kt(r)?Rt({r:Number(e),g:Number(n),b:Number(r),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,n=t.s,r=t.l,i=t.a,s=void 0===i?1:i;if(!kt(e)||!kt(n)||!kt(r))return null;var o=Bt({h:Number(e),s:Number(n),l:Number(r),a:Number(s)});return Ut(o)},"hsl"],[function(t){var e=t.h,n=t.s,r=t.v,i=t.a,s=void 0===i?1:i;if(!kt(e)||!kt(n)||!kt(r))return null;var o=function(t){return{h:It(t.h),s:Pt(t.s,0,100),v:Pt(t.v,0,100),a:Pt(t.a)}}({h:Number(e),s:Number(n),v:Number(r),a:Number(s)});return Nt(o)},"hsv"]]},Yt=function(t,e){for(var n=0;n<e.length;n++){var r=e[n][0](t);if(r)return[r,e[n][1]]}return[null,void 0]},$t=function(t,e){var n=jt(t);return{h:n.h,s:Pt(n.s+100*e,0,100),l:n.l,a:n.a}},qt=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Kt=function(t,e){var n=jt(t);return{h:n.h,s:n.s,l:Pt(n.l+100*e,0,100),a:n.a}},Zt=function(){function t(t){this.parsed=function(t){return"string"==typeof t?Yt(t.trim(),Xt.string):"object"==typeof t&&null!==t?Yt(t,Xt.object):[null,void 0]}(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return null!==this.parsed},t.prototype.brightness=function(){return Mt(qt(this.rgba),2)},t.prototype.isDark=function(){return qt(this.rgba)<.5},t.prototype.isLight=function(){return qt(this.rgba)>=.5},t.prototype.toHex=function(){return e=(t=Ot(this.rgba)).r,n=t.g,r=t.b,s=(i=t.a)<1?Dt(Mt(255*i)):"","#"+Dt(e)+Dt(n)+Dt(r)+s;var t,e,n,r,i,s},t.prototype.toRgb=function(){return Ot(this.rgba)},t.prototype.toRgbString=function(){return e=(t=Ot(this.rgba)).r,n=t.g,r=t.b,(i=t.a)<1?"rgba("+e+", "+n+", "+r+", "+i+")":"rgb("+e+", "+n+", "+r+")";var t,e,n,r,i},t.prototype.toHsl=function(){return Wt(jt(this.rgba))},t.prototype.toHslString=function(){return e=(t=Wt(jt(this.rgba))).h,n=t.s,r=t.l,(i=t.a)<1?"hsla("+e+", "+n+"%, "+r+"%, "+i+")":"hsl("+e+", "+n+"%, "+r+"%)";var t,e,n,r,i},t.prototype.toHsv=function(){return t=Ft(this.rgba),{h:Mt(t.h),s:Mt(t.s),v:Mt(t.v),a:Mt(t.a,3)};var t},t.prototype.invert=function(){return Qt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},t.prototype.saturate=function(t){return void 0===t&&(t=.1),Qt($t(this.rgba,t))},t.prototype.desaturate=function(t){return void 0===t&&(t=.1),Qt($t(this.rgba,-t))},t.prototype.grayscale=function(){return Qt($t(this.rgba,-1))},t.prototype.lighten=function(t){return void 0===t&&(t=.1),Qt(Kt(this.rgba,t))},t.prototype.darken=function(t){return void 0===t&&(t=.1),Qt(Kt(this.rgba,-t))},t.prototype.rotate=function(t){return void 0===t&&(t=15),this.hue(this.hue()+t)},t.prototype.alpha=function(t){return"number"==typeof t?Qt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):Mt(this.rgba.a,3);var e},t.prototype.hue=function(t){var e=jt(this.rgba);return"number"==typeof t?Qt({h:t,s:e.s,l:e.l,a:e.a}):Mt(e.h)},t.prototype.isEqual=function(t){return this.toHex()===Qt(t).toHex()},t}(),Qt=function(t){return t instanceof Zt?t:new Zt(t)},Jt=[];!function(t){t.forEach((function(t){Jt.indexOf(t)<0&&(t(Zt,Xt),Jt.push(t))}))}([function(t,e){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in n)r[n[i]]=i;var s={};t.prototype.toName=function(e){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var i,o,a=r[this.toHex()];if(a)return a;if(null==e?void 0:e.closest){var l=this.toRgb(),h=1/0,c="black";if(!s.length)for(var u in n)s[u]=new t(n[u]).toRgb();for(var d in n){var f=(i=l,o=s[d],Math.pow(i.r-o.r,2)+Math.pow(i.g-o.g,2)+Math.pow(i.b-o.b,2));f<h&&(h=f,c=d)}return c}},e.string.push([function(e){var r=e.toLowerCase(),i="transparent"===r?"#0000":n[r];return i?new t(i).toRgb():null},"name"])}]);const te=class t{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(e){if(e instanceof t)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(null===e)throw new Error("Cannot set PIXI.Color#value to null");(null===this._value||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(t){return"string"==typeof t||"number"==typeof t||t instanceof Number||null===t?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):"object"==typeof t&&null!==t?{...t}:t}isSourceEqual(t,e){const n=typeof t;if(n!==typeof e)return!1;if("number"===n||"string"===n||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length===e.length&&t.every(((t,n)=>t===e[n]));if(null!==t&&null!==e){const n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every((n=>t[n]===e[n]))}return t===e}toRgba(){const[t,e,n,r]=this._components;return{r:t,g:e,b:n,a:r}}toRgb(){const[t,e,n]=this._components;return{r:t,g:e,b:n}}toRgbaString(){const[t,e,n]=this.toUint8RgbArray();return`rgba(${t},${e},${n},${this.alpha})`}toUint8RgbArray(t){const[e,n,r]=this._components;return(t=t??[])[0]=Math.round(255*e),t[1]=Math.round(255*n),t[2]=Math.round(255*r),t}toRgbArray(t){t=t??[];const[e,n,r]=this._components;return t[0]=e,t[1]=n,t[2]=r,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(e){const[n,r,i,s]=t.temp.setValue(e)._components;return this._components[0]*=n,this._components[1]*=r,this._components[2]*=i,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(1===t)return(255<<24)+this._int;if(0===t)return e?0:this._int;let n=this._int>>16&255,r=this._int>>8&255,i=255&this._int;return e&&(n=n*t+.5|0,r=r*t+.5|0,i=i*t+.5|0),(255*t<<24)+(n<<16)+(r<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,n,r]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(n*t)/t,this._components[2]=Math.round(r*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,n,r,i]=this._components;return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}normalize(e){let n,r,i,s;if(("number"==typeof e||e instanceof Number)&&e>=0&&e<=16777215)n=(e>>16&255)/255,r=(e>>8&255)/255,i=(255&e)/255,s=1;else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[n,r,i,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[n,r,i,s=255]=e,n/=255,r/=255,i/=255,s/=255;else if("string"==typeof e||"object"==typeof e){if("string"==typeof e){const n=t.HEX_PATTERN.exec(e);n&&(e=`#${n[2]}`)}const o=Qt(e);o.isValid()&&(({r:n,g:r,b:i,a:s}=o.rgba),n/=255,r/=255,i/=255)}if(void 0===n)throw new Error(`Unable to convert color ${e}`);this._components[0]=n,this._components[1]=r,this._components[2]=i,this._components[3]=s,this.refreshInt()}refreshInt(){this._clamp(this._components);const[t,e,n]=this._components;this._int=(255*t<<16)+(255*e<<8)+(255*n|0)}_clamp(t,e=0,n=1){return"number"==typeof t?Math.min(Math.max(t,e),n):(t.forEach(((r,i)=>{t[i]=Math.min(Math.max(r,e),n)})),t)}};te.shared=new te,te.temp=new te,te.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ee=te;function ne(t,e=[]){return gt("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),ee.shared.setValue(t).toRgbArray(e)}function re(t){return gt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),ee.shared.setValue(t).toHex()}function ie(t){return gt("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),ee.shared.setValue(t).toNumber()}function se(t){return gt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),ee.shared.setValue(t).toNumber()}const oe=function(){const t=[],e=[];for(let n=0;n<32;n++)t[n]=n,e[n]=n;t[P.NORMAL_NPM]=P.NORMAL,t[P.ADD_NPM]=P.ADD,t[P.SCREEN_NPM]=P.SCREEN,e[P.NORMAL]=P.NORMAL_NPM,e[P.ADD]=P.ADD_NPM,e[P.SCREEN]=P.SCREEN_NPM;const n=[];return n.push(e),n.push(t),n}();function ae(t,e){return oe[e?1:0][t]}function le(t,e,n,r=!0){return gt("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),ee.shared.setValue(t).premultiply(e,r).toArray(n??new Float32Array(4))}function he(t,e){return gt("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),ee.shared.setValue(t).toPremultiplied(e)}function ce(t,e,n,r=!0){return gt("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),ee.shared.setValue(t).premultiply(e,r).toArray(n??new Float32Array(4))}const ue=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function de(t,e=null){const n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${n}`);for(let t=0,r=0;t<n;t+=6,r+=4)e[t+0]=r+0,e[t+1]=r+1,e[t+2]=r+2,e[t+3]=r+0,e[t+4]=r+2,e[t+5]=r+3;return e}function fe(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}const pe={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function me(t,e){let n=0,r=0;const i={};for(let i=0;i<t.length;i++)r+=e[i],n+=t[i].length;const s=new ArrayBuffer(4*n);let o=null,a=0;for(let n=0;n<t.length;n++){const l=e[n],h=t[n],c=fe(h);i[c]||(i[c]=new pe[c](s)),o=i[c];for(let t=0;t<h.length;t++)o[(t/l|0)*r+a+t%l]=h[t];a+=l}return new Float32Array(s)}function ge(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,1+((t|=t>>>8)|t>>>16)}function ve(t){return!(t&t-1||!t)}function ye(t){let e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,n=((t>>>=n)>15?1:0)<<2,e|=n,n=((t>>>=n)>3?1:0)<<1,e|=n,e|(t>>>=n)>>1}function xe(t,e,n){const r=t.length;let i;if(e>=r||0===n)return;const s=r-(n=e+n>r?r-e:n);for(i=e;i<s;++i)t[i]=t[i+n];t.length=s}function we(t){return 0===t?0:t<0?-1:1}let _e=0;function be(){return++_e}const Te=class{constructor(t,e,n,r){this.left=t,this.top=e,this.right=n,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Te.EMPTY=new Te(0,0,0,0);let Se=Te;const Ae={},Ee=Object.create(null),Ce=Object.create(null);function ke(){let t;for(t in Ee)Ee[t].destroy();for(t in Ce)Ce[t].destroy()}function Me(){let t;for(t in Ee)delete Ee[t];for(t in Ce)delete Ce[t]}class Pe{constructor(t,e,n){this._canvas=Y.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||Y.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Ie(t,e,n){for(let r=0,i=4*n*e;r<e;++r,i+=4)if(0!==t[i+3])return!1;return!0}function Re(t,e,n,r,i){const s=4*e;for(let e=r,o=r*s+4*n;e<=i;++e,o+=s)if(0!==t[o+3])return!1;return!0}function Oe(t){const{width:e,height:n}=t,r=t.getContext("2d",{willReadFrequently:!0});if(null===r)throw new TypeError("Failed to get canvas 2D context");const i=r.getImageData(0,0,e,n).data;let s=0,o=0,a=e-1,l=n-1;for(;o<n&&Ie(i,e,o);)++o;if(o===n)return Se.EMPTY;for(;Ie(i,e,l);)--l;for(;Re(i,e,s,o,l);)++s;for(;Re(i,e,a,o,l);)--a;return++a,++l,new Se(s,o,a,l)}function Le(t){const e=Oe(t),{width:n,height:r}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(null===s)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,n,r)}return{width:n,height:r,data:i}}function De(t){const e=ue.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}function Fe(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location;const n=new URL(t,document.baseURI);return n.hostname!==e.hostname||n.port!==e.port||n.protocol!==e.protocol?"anonymous":""}function Ne(t,e=1){const n=Y.RETINA_PREFIX?.exec(t);return n?parseFloat(n[1]):e}var Be=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(Be||{});const We=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},Ue=(t,e)=>We(t).priority??e,je={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(We).forEach((t=>{t.type.forEach((e=>this._removeHandlers[e]?.(t)))})),this},add(...t){return t.map(We).forEach((t=>{t.type.forEach((e=>{const n=this._addHandlers,r=this._queue;n[e]?n[e]?.(t):(r[e]=r[e]||[],r[e]?.push(t))}))})),this},handle(t,e,n){const r=this._addHandlers,i=this._removeHandlers;if(r[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);r[t]=e,i[t]=n;const s=this._queue;return s[t]&&(s[t]?.forEach((t=>e(t))),delete s[t]),this},handleByMap(t,e){return this.handle(t,(t=>{t.name&&(e[t.name]=t.ref)}),(t=>{t.name&&delete e[t.name]}))},handleByList(t,e,n=-1){return this.handle(t,(t=>{e.includes(t.ref)||(e.push(t.ref),e.sort(((t,e)=>Ue(e,n)-Ue(t,n))))}),(t=>{const n=e.indexOf(t.ref);-1!==n&&e.splice(n,1)}))}};class He{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const ze=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Ge(t){let e="";for(let n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+=`if(test == ${n}.0){}`);return e}class Ve{constructor(){this.data=0,this.blendMode=P.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(t){!!(1&this.data)!==t&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(t){!!(2&this.data)!==t&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(t){!!(4&this.data)!==t&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(t){!!(8&this.data)!==t&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(t){!!(32&this.data)!==t&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(t){!!(16&this.data)!==t&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==P.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new Ve;return t.depthTest=!1,t.blend=!0,t}}Ve.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Xe=[];function Ye(t,e){if(!t)return null;let n="";if("string"==typeof t){const e=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);e&&(n=e[1].toLowerCase())}for(let r=Xe.length-1;r>=0;--r){const i=Xe[r];if(i.test&&i.test(t,n))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class $e{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,n,r,i,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:h}=this;this._aliasCount++;for(let c=0,u=h.length;c<u;c++)h[c][l](t,e,n,r,i,s,o,a);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties($e.prototype,{dispatch:{value:$e.prototype.emit},run:{value:$e.prototype.emit}});class qe{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new $e("setRealSize"),this.onUpdate=new $e("update"),this.onError=new $e("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Ke extends qe{constructor(t,e){const{width:n,height:r}=e||{};if(!n||!r)throw new Error("BufferResource width or height invalid");super(n,r),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,n){const r=t.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,this.unpackAlignment),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===W.UNPACK);const i=e.realWidth,s=e.realHeight;return n.width===i&&n.height===s?r.texSubImage2D(e.target,0,0,0,i,s,e.format,n.type,this.data):(n.width=i,n.height=s,r.texImage2D(e.target,0,n.internalFormat,i,s,0,e.format,n.type,this.data)),!0}dispose(){this.data=null}static test(t){return null===t||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const Ze={scaleMode:F.NEAREST,alphaMode:W.NPM},Qe=class t extends dt{constructor(e=null,n=null){super(),n=Object.assign({},t.defaultOptions,n);const{alphaMode:r,mipmap:i,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:h,format:c,type:u,target:d,resolution:f,resourceOptions:p}=n;e&&!(e instanceof qe)&&((e=Ye(e,p)).internal=!0),this.resolution=f||Y.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=s,this._wrapMode=h,this._scaleMode=o,this.format=c,this.type=u,this.target=d,this.alphaMode=r,this.uid=be(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this}setSize(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n)}setRealSize(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=ve(this.realWidth)&&ve(this.realHeight)}setResolution(t){const e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ce[this.cacheId],delete Ee[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,n,r=Y.STRICT_TEXTURE_CACHE){const i="string"==typeof e;let s=null;if(i)s=e;else{if(!e._pixiId){const t=n?.pixiIdPrefix||"pixiid";e._pixiId=`${t}_${be()}`}s=e._pixiId}let o=Ce[s];if(i&&r&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new t(e,n),o.cacheId=s,t.addToCache(o,s)),o}static fromBuffer(e,n,r,i){e=e||new Float32Array(n*r*4);const s=new Ke(e,{width:n,height:r,...i?.resourceOptions});let o,a;return e instanceof Float32Array?(o=R.RGBA,a=L.FLOAT):e instanceof Int32Array?(o=R.RGBA_INTEGER,a=L.INT):e instanceof Uint32Array?(o=R.RGBA_INTEGER,a=L.UNSIGNED_INT):e instanceof Int16Array?(o=R.RGBA_INTEGER,a=L.SHORT):e instanceof Uint16Array?(o=R.RGBA_INTEGER,a=L.UNSIGNED_SHORT):e instanceof Int8Array?(o=R.RGBA,a=L.BYTE):(o=R.RGBA,a=L.UNSIGNED_BYTE),s.internal=!0,new t(s,Object.assign({},Ze,{type:a,format:o},i))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Ce[e]&&Ce[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),Ce[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=Ce[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Ce[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete Ce[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};Qe.defaultOptions={mipmap:B.POW2,anisotropicLevel:0,scaleMode:F.LINEAR,wrapMode:N.CLAMP,alphaMode:W.UNPACK,target:O.TEXTURE_2D,format:R.RGBA,type:L.UNSIGNED_BYTE},Qe._globalBatch=0;let Je=Qe;class tn{constructor(){this.texArray=null,this.blend=0,this.type=I.TRIANGLES,this.start=0,this.size=0,this.data=null}}let en=0;class nn{constructor(t,e=!0,n=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=en++,this.disposeRunner=new $e("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?V.ELEMENT_ARRAY_BUFFER:V.ARRAY_BUFFER}get index(){return this.type===V.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new nn(t)}}class rn{constructor(t,e=0,n=!1,r=L.FLOAT,i,s,o,a=1){this.buffer=t,this.size=e,this.normalized=n,this.type=r,this.stride=i,this.start=s,this.instance=o,this.divisor=a}destroy(){this.buffer=null}static from(t,e,n,r,i){return new rn(t,e,n,r,i)}}const sn={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array},on={5126:4,5123:2,5121:1};let an=0;const ln={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};class hn{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=an++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new $e("disposeGeometry"),this.refCount=0}addAttribute(t,e,n=0,r=!1,i,s,o,a=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof nn||(e instanceof Array&&(e=new Float32Array(e)),e=new nn(e));const l=t.split("|");if(l.length>1){for(let t=0;t<l.length;t++)this.addAttribute(l[t],e,n,r,i);return this}let h=this.buffers.indexOf(e);return-1===h&&(this.buffers.push(e),h=this.buffers.length-1),this.attributes[t]=new rn(h,n,r,i,s,o,a),this.instanced=this.instanced||a,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof nn||(t instanceof Array&&(t=new Uint16Array(t)),t=new nn(t)),t.type=V.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const t=[],e=[],n=new nn;let r;for(r in this.attributes){const n=this.attributes[r],i=this.buffers[n.buffer];t.push(i.data),e.push(n.size*on[n.type]/4),n.buffer=0}for(n.data=function(t,e){let n=0,r=0;const i={};for(let i=0;i<t.length;i++)r+=e[i],n+=t[i].length;const s=new ArrayBuffer(4*n);let o=null,a=0;for(let n=0;n<t.length;n++){const l=e[n],h=t[n],c=fe(h);i[c]||(i[c]=new sn[c](s)),o=i[c];for(let t=0;t<h.length;t++)o[(t/l|0)*r+a+t%l]=h[t];a+=l}return new Float32Array(s)}(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new hn;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new nn(this.buffers[e].data.slice(0));for(const e in this.attributes){const n=this.attributes[e];t.attributes[e]=new rn(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=V.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new hn,n=[],r=[],i=[];let s;for(let e=0;e<t.length;e++){s=t[e];for(let t=0;t<s.buffers.length;t++)r[t]=r[t]||0,r[t]+=s.buffers[t].data.length,i[t]=0}for(let t=0;t<s.buffers.length;t++)n[t]=new(ln[fe(s.buffers[t].data)])(r[t]),e.buffers[t]=new nn(n[t]);for(let e=0;e<t.length;e++){s=t[e];for(let t=0;t<s.buffers.length;t++)n[t].set(s.buffers[t].data,i[t]),i[t]+=s.buffers[t].data.length}if(e.attributes=s.attributes,s.indexBuffer){e.indexBuffer=e.buffers[s.buffers.indexOf(s.indexBuffer)],e.indexBuffer.type=V.ELEMENT_ARRAY_BUFFER;let n=0,r=0,i=0,o=0;for(let t=0;t<s.buffers.length;t++)if(s.buffers[t]!==s.indexBuffer){o=t;break}for(const t in s.attributes){const e=s.attributes[t];(0|e.buffer)===o&&(r+=e.size*on[e.type]/4)}for(let s=0;s<t.length;s++){const a=t[s].indexBuffer.data;for(let t=0;t<a.length;t++)e.indexBuffer.data[t+i]+=n;n+=t[s].buffers[o].data.length/r,i+=a.length}}return e}}class cn extends hn{constructor(t=!1){super(),this._buffer=new nn(null,t,!1),this._indexBuffer=new nn(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,L.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,L.FLOAT).addAttribute("aColor",this._buffer,4,!0,L.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,L.FLOAT).addIndex(this._indexBuffer)}}const un=2*Math.PI,dn=180/Math.PI,fn=Math.PI/180;var pn=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(pn||{});class mn{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new mn(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}mn.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const gn=[new mn,new mn,new mn,new mn];class vn{constructor(t=0,e=0,n=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(r),this.type=pn.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new vn(0,0,0,0)}clone(){return new vn(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const e=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=e)return!1;const n=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>n}const n=this.left,r=this.right,i=this.top,s=this.bottom;if(r<=n||s<=i)return!1;const o=gn[0].set(t.left,t.top),a=gn[1].set(t.left,t.bottom),l=gn[2].set(t.right,t.top),h=gn[3].set(t.right,t.bottom);if(l.x<=o.x||a.y<=o.y)return!1;const c=Math.sign(e.a*e.d-e.b*e.c);if(0===c||(e.apply(o,o),e.apply(a,a),e.apply(l,l),e.apply(h,h),Math.max(o.x,a.x,l.x,h.x)<=n||Math.min(o.x,a.x,l.x,h.x)>=r||Math.max(o.y,a.y,l.y,h.y)<=i||Math.min(o.y,a.y,l.y,h.y)>=s))return!1;const u=c*(a.y-o.y),d=c*(o.x-a.x),f=u*n+d*i,p=u*r+d*i,m=u*n+d*s,g=u*r+d*s;if(Math.max(f,p,m,g)<=u*o.x+d*o.y||Math.min(f,p,m,g)>=u*h.x+d*h.y)return!1;const v=c*(o.y-l.y),y=c*(l.x-o.x),x=v*n+y*i,w=v*r+y*i,_=v*n+y*s,b=v*r+y*s;return!(Math.max(x,w,_,b)<=v*o.x+y*o.y||Math.min(x,w,_,b)>=v*h.x+y*h.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this}fit(t){const e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=r,this.height=Math.max(i-r,0),this}ceil(t=1,e=.001){const n=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=r,this.height=i-r,this}}vn.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class yn{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.radius=n,this.type=pn.CIRC}clone(){return new yn(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let r=this.x-t,i=this.y-e;return r*=r,i*=i,r+i<=n}getBounds(){return new vn(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}yn.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class xn{constructor(t=0,e=0,n=0,r=0){this.x=t,this.y=e,this.width=n,this.height=r,this.type=pn.ELIP}clone(){return new xn(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let n=(t-this.x)/this.width,r=(e-this.y)/this.height;return n*=n,r*=r,n+r<=1}getBounds(){return new vn(this.x-this.width,this.y-this.height,this.width,this.height)}}xn.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class wn{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if("number"!=typeof e[0]){const t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n].x,e[n].y);e=t}this.points=e,this.type=pn.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new wn(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let n=!1;const r=this.points.length/2;for(let i=0,s=r-1;i<r;s=i++){const r=this.points[2*i],o=this.points[2*i+1],a=this.points[2*s],l=this.points[2*s+1];o>e!=l>e&&t<(e-o)/(l-o)*(a-r)+r&&(n=!n)}return n}}wn.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce(((t,e)=>`${t}, ${e}`),"")}]`};class _n{constructor(t=0,e=0,n=0,r=0,i=20){this.x=t,this.y=e,this.width=n,this.height=r,this.radius=i,this.type=pn.RREC}clone(){return new _n(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let r=t-(this.x+n),i=e-(this.y+n);const s=n*n;if(r*r+i*i<=s||(r=t-(this.x+this.width-n),r*r+i*i<=s)||(i=e-(this.y+this.height-n),r*r+i*i<=s)||(r=t-(this.x+n),r*r+i*i<=s))return!0}return!1}}_n.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class bn{constructor(t=1,e=0,n=0,r=1,i=0,s=0){this.array=null,this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=s}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,n,r,i,s){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=s,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(t,e){e=e||new mn;const n=t.x,r=t.y;return e.x=this.a*n+this.c*r+this.tx,e.y=this.b*n+this.d*r+this.ty,e}applyInverse(t,e){e=e||new mn;const n=1/(this.a*this.d+this.c*-this.b),r=t.x,i=t.y;return e.x=this.d*n*r+-this.c*n*i+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*i+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.a,i=this.c,s=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=s*e-this.ty*n,this.ty=s*n+this.ty*e,this}append(t){const e=this.a,n=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this}setTransform(t,e,n,r,i,s,o,a,l){return this.a=Math.cos(o+l)*i,this.b=Math.sin(o+l)*i,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(n*this.a+r*this.c),this.ty=e-(n*this.b+r*this.d),this}prepend(t){const e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const e=this.a,n=this.c;this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,n=this.b,r=this.c,i=this.d,s=t.pivot,o=-Math.atan2(-r,i),a=Math.atan2(n,e),l=Math.abs(o+a);return l<1e-5||Math.abs(un-l)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=a),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(r*r+i*i),t.position.x=this.tx+(s.x*e+s.y*r),t.position.y=this.ty+(s.x*n+s.y*i),t}invert(){const t=this.a,e=this.b,n=this.c,r=this.d,i=this.tx,s=t*r-e*n;return this.a=r/s,this.b=-e/s,this.c=-n/s,this.d=t/s,this.tx=(n*this.ty-r*i)/s,this.ty=-(t*this.ty-e*i)/s,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new bn;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new bn}static get TEMP_MATRIX(){return new bn}}bn.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const Tn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Sn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],An=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],En=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Cn=[],kn=[],Mn=Math.sign;!function(){for(let t=0;t<16;t++){const e=[];Cn.push(e);for(let n=0;n<16;n++){const r=Mn(Tn[t]*Tn[n]+An[t]*Sn[n]),i=Mn(Sn[t]*Tn[n]+En[t]*Sn[n]),s=Mn(Tn[t]*An[n]+An[t]*En[n]),o=Mn(Sn[t]*An[n]+En[t]*En[n]);for(let t=0;t<16;t++)if(Tn[t]===r&&Sn[t]===i&&An[t]===s&&En[t]===o){e.push(t);break}}}for(let t=0;t<16;t++){const e=new bn;e.set(Tn[t],Sn[t],An[t],En[t],0,0),kn.push(e)}}();const Pn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>Tn[t],uY:t=>Sn[t],vX:t=>An[t],vY:t=>En[t],inv:t=>8&t?15&t:7&-t,add:(t,e)=>Cn[t][e],sub:(t,e)=>Cn[t][Pn.inv(e)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,e)=>2*Math.abs(t)<=Math.abs(e)?e>=0?Pn.S:Pn.N:2*Math.abs(e)<=Math.abs(t)?t>0?Pn.E:Pn.W:e>0?t>0?Pn.SE:Pn.SW:t>0?Pn.NE:Pn.NW,matrixAppendRotationInv:(t,e,n=0,r=0)=>{const i=kn[Pn.inv(e)];i.tx=n,i.ty=r,t.append(i)}};class In{constructor(t,e,n=0,r=0){this._x=n,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new In(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}In.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Rn=class{constructor(){this.worldTransform=new bn,this.localTransform=new bn,this.position=new In(this.onChange,this,0,0),this.scale=new In(this.onChange,this,1,1),this.pivot=new In(this.onChange,this,0,0),this.skew=new In(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const n=t.worldTransform,r=this.worldTransform;r.a=e.a*n.a+e.b*n.c,r.b=e.a*n.b+e.b*n.d,r.c=e.c*n.a+e.d*n.c,r.d=e.c*n.b+e.d*n.d,r.tx=e.tx*n.a+e.ty*n.c+n.tx,r.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};Rn.IDENTITY=new Rn;let On=Rn;On.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};const Ln=[{test:t=>"float"===t.type&&1===t.size&&!t.isArray,code:t=>`\n            if(uv["${t}"] !== ud["${t}"].value)\n            {\n                ud["${t}"].value = uv["${t}"]\n                gl.uniform1f(ud["${t}"].location, uv["${t}"])\n            }\n            `},{test:(t,e)=>!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=e&&void 0===e.castToBaseTexture),code:t=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${t}"], t);\n\n            if(ud["${t}"].value !== t)\n            {\n                ud["${t}"].value = t;\n                gl.uniform1i(ud["${t}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(t,e)=>"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a,code:t=>`\n            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));\n            `,codeUbo:t=>`\n                var ${t}_matrix = uv.${t}.toArray(true);\n\n                data[offset] = ${t}_matrix[0];\n                data[offset+1] = ${t}_matrix[1];\n                data[offset+2] = ${t}_matrix[2];\n        \n                data[offset + 4] = ${t}_matrix[3];\n                data[offset + 5] = ${t}_matrix[4];\n                data[offset + 6] = ${t}_matrix[5];\n        \n                data[offset + 8] = ${t}_matrix[6];\n                data[offset + 9] = ${t}_matrix[7];\n                data[offset + 10] = ${t}_matrix[8];\n            `},{test:(t,e)=>"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${t}"].location, v.x, v.y);\n                }`,codeUbo:t=>`\n                v = uv.${t};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:t=>"vec2"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);\n                }\n            `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                `},{test:(t,e)=>"vec3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                `},{test:t=>"vec4"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])\n                }`}],Dn={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},Fn={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},Nn={};let Bn,Wn=Nn;const Un={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function jn(t){return Un[t]}let Hn=null;const zn={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Gn(t,e){if(!Hn){const e=Object.keys(zn);Hn={};for(let n=0;n<e.length;++n){const r=e[n];Hn[t[r]]=zn[r]}}return Hn[e]}function Vn(t,e,n){if("precision"!==t.substring(0,9)){let r=e;return e===H.HIGH&&n!==H.HIGH&&(r=H.MEDIUM),`precision ${r} float;\n${t}`}return n!==H.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}let Xn=0;const Yn={},$n=class t{constructor(e,n,r="pixi-shader",i={}){this.extra={},this.id=Xn++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),Yn[r]?(Yn[r]++,r+=`-${Yn[r]}`):Yn[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}\n${this.fragmentSrc}`,this.vertexSrc=Vn(this.vertexSrc,t.defaultVertexPrecision,H.HIGH),this.fragmentSrc=Vn(this.fragmentSrc,t.defaultFragmentPrecision,function(){if(!Bn){Bn=H.MEDIUM;const t=function(){if(Wn===Nn||Wn?.isContextLost()){const t=Y.ADAPTER.createCanvas();let e;Y.PREFER_ENV>=C.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Wn=e}return Wn}();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e&&(Bn=e.precision?H.HIGH:H.MEDIUM)}}return Bn}())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}static from(e,n,r){const i=e+n;let s=Ae[i];return s||(Ae[i]=s=new t(e,n,r)),s}};$n.defaultVertexPrecision=H.HIGH,$n.defaultFragmentPrecision=ut.apple.device?H.HIGH:H.MEDIUM;let qn=$n,Kn=0;class Zn{constructor(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Kn++,this.static=!!e,this.ubo=!!n,t instanceof nn?(this.buffer=t,this.buffer.type=V.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new nn(new Float32Array(1)),this.buffer.type=V.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,n){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[t]=new Zn(e,n)}static from(t,e,n){return new Zn(t,e,n)}static uboFrom(t,e){return new Zn(t,e??!0,!0)}}class Qn{constructor(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof Zn?e:new Zn(e):new Zn({}),this.disposeRunner=new $e("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const n in e.uniforms){const r=e.uniforms[n];if(!0===r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,n){const r=qn.from(t,e);return new Qn(r,n)}}class Jn{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const e=new Int32Array(t);for(let n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=Zn.from({uSamplers:e},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new qn(this.vertexSrc,n)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new bn,default:this.defaultGroupCache[t]};return new Qn(this.programCache[t],e)}generateSampleSrc(t){let e="";e+="\n",e+="\n";for(let n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+=`if(vTextureId < ${n}.5)`),e+="\n{",e+=`\n\tcolor = texture2D(uSamplers[${n}], vTextureCoord);`,e+="\n}";return e+="\n",e+="\n",e}}class tr{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}class er{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}const nr=class t extends er{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=cn,this.vertexSize=6,this.state=Ve.for2d(),this.size=4*t.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??function(){let t=!0;const e=Y.ADAPTER.getNavigator();if(ut.tablet||ut.phone){if(ut.apple.device){const n=e.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(t=!1)}if(ut.android.device){const n=e.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(t=!1)}}return t?32:4}(),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??!ut.apple.device,this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return gt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}static get defaultFragmentTemplate(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}setShaderGenerator({vertex:e=t.defaultVertexSrc,fragment:n=t.defaultFragmentTemplate}={}){this.shaderGenerator=new Jn(e,n)}contextChange(){const e=this.renderer.gl;Y.PREFER_ENV===C.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),t.defaultMaxTextures),this.maxTextures=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const n=e.createShader(e.FRAGMENT_SHADER);for(;;){const r=ze.replace(/%forloop%/gi,Ge(t));if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:n}=t,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;for(;e.length<r;)e.push(new tn);for(;n.length<i;)n.push(new tr);for(let t=0;t<this.maxTextures;t++)this._tempBoundTextures[t]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:n}=this,r=t._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++Je._globalBatch,l=0,h=r[0],c=0;i.copyBoundTextures(s,n);for(let t=0;t<this._bufferSize;++t){const u=e[t];e[t]=null,u._batchEnabled!==a&&(h.count>=n&&(i.boundArray(h,s,a,n),this.buildDrawCalls(h,c,t),c=t,h=r[++l],++a),u._batchEnabled=a,u.touched=o,h.elements[h.count++]=u)}h.count>0&&(i.boundArray(h,s,a,n),this.buildDrawCalls(h,c,this._bufferSize),++l,++a);for(let t=0;t<s.length;t++)s[t]=null;Je._globalBatch=a}buildDrawCalls(e,n,r){const{_bufferedElements:i,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=t._drawCallPool;let h=this._dcIndex,c=this._aIndex,u=this._iIndex,d=l[h];d.start=this._iIndex,d.texArray=e;for(let t=n;t<r;++t){const r=i[t],f=r._texture.baseTexture,p=oe[f.alphaMode?1:0][r.blendMode];i[t]=null,n<t&&d.blend!==p&&(d.size=u-d.start,n=t,d=l[++h],d.texArray=e,d.start=u),this.packInterleavedGeometry(r,s,o,c,u),c+=r.vertexData.length/2*a,u+=r.indices.length,d.blend=p}n<r&&(d.size=u-d.start,++h),this._dcIndex=h,this._aIndex=c,this._iIndex=u}bindAndClearTexArray(t){const e=this.renderer.texture;for(let n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:n,_indexBuffer:r}=this;t.canUploadSameBuffer?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:n,state:r}=this.renderer,i=t._drawCallPool;let s=null;for(let t=0;t<e;t++){const{texArray:e,type:o,size:a,start:l,blend:h}=i[t];s!==e&&(s=e,this.bindAndClearTexArray(e)),this.state.blendMode=h,r.set(this.state),n.drawElements(o,a,n.UNSIGNED_SHORT,2*l)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),t.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=ge(Math.ceil(t/8)),n=ye(e),r=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new He(r*this.vertexSize*4)),i}getIndexBuffer(t){const e=ge(Math.ceil(t/12)),n=ye(e),r=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._iBuffers[n];return i||(this._iBuffers[n]=i=new Uint16Array(r)),i}packInterleavedGeometry(t,e,n,r,i){const{uint32View:s,float32View:o}=e,a=r/this.vertexSize,l=t.uvs,h=t.indices,c=t.vertexData,u=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),f=ee.shared.setValue(t._tintRGB).toPremultiplied(d,t._texture.baseTexture.alphaMode>0);for(let t=0;t<c.length;t+=2)o[r++]=c[t],o[r++]=c[t+1],o[r++]=l[t],o[r++]=l[t+1],s[r++]=f,o[r++]=u;for(let t=0;t<h.length;t++)n[i++]=a+h[t]}};nr.defaultBatchSize=4096,nr.extension={name:"batch",type:Be.RendererPlugin},nr._drawCallPool=[],nr._textureArrayPool=[];let rr=nr;je.add(rr);const ir=class t extends Qn{constructor(e,n,r){super(qn.from(e||t.defaultVertexSrc,n||t.defaultFragmentSrc),r),this.padding=0,this.resolution=t.defaultResolution,this.multisample=t.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Ve}apply(t,e,n,r,i){t.applyFilter(this,e,n,r)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}};ir.defaultResolution=1,ir.defaultMultisample=G.NONE;let sr=ir;class or{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new ee(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:n,backgroundAlpha:r}=t,i=n??e;void 0!==i&&(this.color=i),this.alpha=r}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}or.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},or.extension={type:[Be.RendererSystem,Be.CanvasRendererSystem],name:"background"},je.add(or);class ar{constructor(t){this.renderer=t,this.emptyRenderer=new er(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:n}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=n[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,n,r){const{elements:i,ids:s,count:o}=t;let a=0;for(let t=0;t<o;t++){const o=i[t],l=o._batchLocation;if(l>=0&&l<r&&e[l]===o)s[t]=l;else for(;a<r;){const r=e[a];if(!r||r._batchEnabled!==n||r._batchLocation!==a){s[t]=a,o._batchLocation=a,e[a]=o;break}a++}}}destroy(){this.renderer=null}}ar.extension={type:Be.RendererSystem,name:"batch"},je.add(ar);let lr=0;class hr{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=lr++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,n=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:n,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=lr++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;void 0!==e.addEventListener&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let n;if(Y.PREFER_ENV>=C.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc"),bptc:t.getExtension("EXT_texture_compression_bptc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout((()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()}),0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,void 0!==t.removeEventListener&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}hr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},hr.extension={type:Be.RendererSystem,name:"context"},je.add(hr);class cr{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new $e("disposeFramebuffer"),this.multisample=G.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new Je(null,{scaleMode:F.NEAREST,resolution:1,mipmap:B.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new Je(null,{scaleMode:F.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:B.OFF,format:R.DEPTH_COMPONENT,type:L.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const r=this.colorTextures[n],i=r.resolution;r.setSize(t/i,e/i)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class ur extends Je{constructor(t={}){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=G.NONE),super(null,t),this.mipmap=B.OFF,this.valid=!0,this._clear=new ee([0,0,0,0]),this.framebuffer=new cr(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class dr extends qe{constructor(t){const e=t;super(e.naturalWidth||e.videoWidth||e.displayWidth||e.width,e.naturalHeight||e.videoHeight||e.displayHeight||e.height),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,n){void 0!==n||e.startsWith("data:")?!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous"):t.crossOrigin=Fe(e)}upload(t,e,n,r){const i=t.gl,s=e.realWidth,o=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||0===r.naturalWidth)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===W.UNPACK),this.noSubImage||e.target!==i.TEXTURE_2D||n.width!==s||n.height!==o?(n.width=s,n.height=o,i.texImage2D(e.target,0,n.internalFormat,e.format,n.type,r)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,e.format,n.type,r),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(e,n),super.update()}dispose(){this.source=null}}class fr extends dr{constructor(t,e){if(e=e||{},"string"==typeof t){const n=new Image;dr.crossOrigin(n,t,e.crossorigin),n.src=t,t=n}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??Y.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}load(t){return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise(((t,e)=>{const n=this.source;this.url=n.src;const r=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.update(),this._load=null,this.createBitmap?t(this.process()):t(this))};n.complete&&n.src?r():(n.onload=r,n.onerror=t=>{e(t),this.onError.emit(t)})}))),this._load}process(){const t=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,n=!t.crossOrigin||"anonymous"===t.crossOrigin;return this._process=fetch(t.src,{mode:n?"cors":"no-cors"}).then((t=>t.blob())).then((n=>e(n,0,0,t.width,t.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===W.UNPACK?"premultiply":"none"}))).then((t=>this.destroyed?Promise.reject():(this.bitmap=t,this.update(),this._process=null,Promise.resolve(this)))),this._process}upload(t,e,n){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,n,this.bitmap),!this.preserveBitmap){let t=!0;const r=e._glTextures;for(const i in r){const s=r[i];if(s!==n&&s.dirtyId!==e.dirtyId){t=!1;break}}t&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&("string"==typeof t||t instanceof HTMLImageElement)}}class pr{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,n){const r=e.width,i=e.height;if(n){const e=t.width/2/r,s=t.height/2/i,o=t.x/r+e,a=t.y/i+s;n=Pn.add(n,Pn.NW),this.x0=o+e*Pn.uX(n),this.y0=a+s*Pn.uY(n),n=Pn.add(n,2),this.x1=o+e*Pn.uX(n),this.y1=a+s*Pn.uY(n),n=Pn.add(n,2),this.x2=o+e*Pn.uX(n),this.y2=a+s*Pn.uY(n),n=Pn.add(n,2),this.x3=o+e*Pn.uX(n),this.y3=a+s*Pn.uY(n)}else this.x0=t.x/r,this.y0=t.y/i,this.x1=(t.x+t.width)/r,this.y1=t.y/i,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/i,this.x3=t.x/r,this.y3=(t.y+t.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}pr.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const mr=new pr;function gr(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class vr extends dt{constructor(t,e,n,r,i,s,o){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new vn(0,0,1,1)),t instanceof vr&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this.destroyed=!1,this._uvs=mr,this.uvMatrix=null,this.orig=n||e,this._rotate=Number(i||0),!0===i)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new mn(s.x,s.y):new mn(0,0),this.defaultBorders=o,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:t}=this.baseTexture;t?.url&&Ee[t.url]&&vr.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,vr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),n=new vr(this.baseTexture,!this.noFrame&&t,e,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(n._frame=t),n}updateUvs(){this._uvs===mr&&(this._uvs=new pr),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},n=Y.STRICT_TEXTURE_CACHE){const r="string"==typeof t;let i=null;if(r)i=t;else if(t instanceof Je){if(!t.cacheId){const n=e?.pixiIdPrefix||"pixiid";t.cacheId=`${n}-${be()}`,Je.addToCache(t,t.cacheId)}i=t.cacheId}else{if(!t._pixiId){const n=e?.pixiIdPrefix||"pixiid";t._pixiId=`${n}_${be()}`}i=t._pixiId}let s=Ee[i];if(r&&n&&!s)throw new Error(`The cacheId "${i}" does not exist in TextureCache.`);return s||t instanceof Je?!s&&t instanceof Je&&(s=new vr(t),vr.addToCache(s,i)):(e.resolution||(e.resolution=Ne(t)),s=new vr(new Je(t,e)),s.baseTexture.cacheId=i,Je.addToCache(s.baseTexture,i),vr.addToCache(s,i)),s}static fromURL(t,e){const n=Object.assign({autoLoad:!1},e?.resourceOptions),r=vr.from(t,Object.assign({resourceOptions:n},e),!1),i=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):i.load().then((()=>Promise.resolve(r)))}static fromBuffer(t,e,n,r){return new vr(Je.fromBuffer(t,e,n,r))}static fromLoader(t,e,n,r){const i=new Je(t,Object.assign({scaleMode:Je.defaultOptions.scaleMode,resolution:Ne(e)},r)),{resource:s}=i;s instanceof fr&&(s.url=e);const o=new vr(i);return n||(n=e),Je.addToCache(o.baseTexture,n),vr.addToCache(o,n),n!==e&&(Je.addToCache(o.baseTexture,e),vr.addToCache(o,e)),o.baseTexture.valid?Promise.resolve(o):new Promise((t=>{o.baseTexture.once("loaded",(()=>t(o)))}))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Ee[e]&&Ee[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Ee[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=Ee[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Ee[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Ee[t.textureCacheIds[e]]===t&&delete Ee[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:n,width:r,height:i}=t,s=e+r>this.baseTexture.width,o=n+i>this.baseTexture.height;if(s||o){const t=s&&o?"and":"or",a=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,l=`Y: ${n} + ${i} = ${n+i} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${a} ${t} ${l}`)}this.valid=r&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return vr._EMPTY||(vr._EMPTY=new vr(new Je),gr(vr._EMPTY),gr(vr._EMPTY.baseTexture)),vr._EMPTY}static get WHITE(){if(!vr._WHITE){const t=Y.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),vr._WHITE=new vr(Je.from(t)),gr(vr._WHITE),gr(vr._WHITE.baseTexture)}return vr._WHITE}}class yr extends vr{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,n=!0){const r=this.baseTexture.resolution,i=Math.round(t*r)/r,s=Math.round(e*r)/r;this.valid=i>0&&s>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=s,n&&this.baseTexture.resize(i,s),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new yr(new ur(t))}}class xr{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,n=G.NONE){const r=new ur(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new yr(r)}getOptimalTexture(t,e,n=1,r=G.NONE){let i;t=Math.max(Math.ceil(t*n-1e-6),1),e=Math.max(Math.ceil(e*n-1e-6),1),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?i=r>1?-r:-1:(i=((65535&(t=ge(t)))<<16|65535&(e=ge(e)))>>>0,r>1&&(i+=4294967296*r)),this.texturePool[i]||(this.texturePool[i]=[]);let s=this.texturePool[i].pop();return s||(s=this.createTexture(t,e,r)),s.filterPoolKey=i,s.setResolution(n),s}getFilterTexture(t,e,n){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||G.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=!1!==t)for(const t in this.texturePool){const e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0)}this.texturePool={}}setScreenSize(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){this.enableFullScreen=t.width>0&&t.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}xr.SCREEN_KEY=-1;class wr extends hn{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class _r extends hn{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new nn(this.vertices),this.uvBuffer=new nn(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+e.width/t.width,this.uvs[3]=r,this.uvs[4]=n+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=n,this.uvs[7]=r+e.height/t.height,n=e.x,r=e.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+e.width,this.vertices[3]=r,this.vertices[4]=n+e.width,this.vertices[5]=r+e.height,this.vertices[6]=n,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class br{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=G.NONE,this.sourceFrame=new vn,this.destinationFrame=new vn,this.bindingSourceFrame=new vn,this.bindingDestinationFrame=new vn,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Tr=[new mn,new mn,new mn,new mn],Sr=new bn;class Ar{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new xr,this.statePool=[],this.quad=new wr,this.quadUv=new _r,this.tempRect=new vn,this.activeState={},this.globalUniforms=new Zn({outputFrame:new vn,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const n=this.renderer,r=this.defaultFilterStack,i=this.statePool.pop()||new br,s=n.renderTexture;let o,a;if(s.current){const t=s.current;o=t.resolution,a=t.multisample}else o=n.resolution,a=n.multisample;let l=e[0].resolution||o,h=e[0].multisample??a,c=e[0].padding,u=e[0].autoFit,d=e[0].legacy??!0;for(let t=1;t<e.length;t++){const n=e[t];l=Math.min(l,n.resolution||o),h=Math.min(h,n.multisample??a),c=this.useMaxPadding?Math.max(c,n.padding):c+n.padding,u=u&&n.autoFit,d=d||(n.legacy??!0)}1===r.length&&(this.defaultFilterStack[0].renderTexture=s.current),r.push(i),i.resolution=l,i.multisample=h,i.legacy=d,i.target=t,i.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),i.sourceFrame.pad(c);const f=this.tempRect.copyFrom(s.sourceFrame);n.projection.transform&&this.transformAABB(Sr.copyFrom(n.projection.transform).invert(),f),u?(i.sourceFrame.fit(f),(i.sourceFrame.width<=0||i.sourceFrame.height<=0)&&(i.sourceFrame.width=0,i.sourceFrame.height=0)):i.sourceFrame.intersects(f)||(i.sourceFrame.width=0,i.sourceFrame.height=0),this.roundFrame(i.sourceFrame,s.current?s.current.resolution:n.resolution,s.sourceFrame,s.destinationFrame,n.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,l,h),i.filters=e,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=i.sourceFrame.width,p.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(s.sourceFrame),i.bindingDestinationFrame.copyFrom(s.destinationFrame),i.transform=n.projection.transform,n.projection.transform=null,s.bind(i.renderTexture,i.sourceFrame,p),n.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const i=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(i[0]=e.destinationFrame.width,i[1]=e.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],s[0]=Math.round(i[0]*e.resolution),s[1]=Math.round(i[1]*e.resolution),s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*i[2]-.5*s[2],o[3]=e.sourceFrame.height*i[3]-.5*s[3],e.legacy){const t=r.filterArea;t[0]=e.destinationFrame.width,t[1]=e.destinationFrame.height,t[2]=e.sourceFrame.x,t[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const a=t[t.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,a.renderTexture,U.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let t=e.renderTexture,r=this.getOptimalFilterTexture(t.width,t.height,e.resolution);r.filterFrame=t.filterFrame;let i=0;for(i=0;i<n.length-1;++i){1===i&&e.multisample>1&&(r=this.getOptimalFilterTexture(t.width,t.height,e.resolution),r.filterFrame=t.filterFrame),n[i].apply(this,t,r,U.CLEAR,e);const s=t;t=r,r=s}n[i].apply(this,t,a.renderTexture,U.BLEND,e),i>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(t),this.returnFilterTexture(r)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=U.CLEAR){const{renderTexture:n,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){const e=this.tempRect;e.x=0,e.y=0,e.width=t.filterFrame.width,e.height=t.filterFrame.height,n.bind(t,t.filterFrame,e)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const i=1&r.stateId||this.forceClear;(e===U.CLEAR||e===U.BLIT&&i)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,n,r){const i=this.renderer;i.state.set(t.state),this.bindAndClear(n,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(I.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(I.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:n,destinationFrame:r}=this.activeState,{orig:i}=e._texture,s=t.set(r.width,0,0,r.height,n.x,n.y),o=e.worldTransform.copyTo(bn.TEMP_MATRIX);return o.invert(),s.prepend(o),s.scale(1/i.width,1/i.height),s.translate(e.anchor.x,e.anchor.y),s}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,n=1,r=G.NONE){return this.texturePool.getOptimalTexture(t,e,n,r)}getFilterTexture(t,e,n){if("number"==typeof t){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||G.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const n=Tr[0],r=Tr[1],i=Tr[2],s=Tr[3];n.set(e.left,e.top),r.set(e.left,e.bottom),i.set(e.right,e.top),s.set(e.right,e.bottom),t.apply(n,n),t.apply(r,r),t.apply(i,i),t.apply(s,s);const o=Math.min(n.x,r.x,i.x,s.x),a=Math.min(n.y,r.y,i.y,s.y),l=Math.max(n.x,r.x,i.x,s.x),h=Math.max(n.y,r.y,i.y,s.y);e.x=o,e.y=a,e.width=l-o,e.height=h-a}roundFrame(t,e,n,r,i){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(i){const{a:t,b:e,c:n,d:r}=i;if((Math.abs(e)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4))return}(i=i?Sr.copyFrom(i):Sr.identity()).translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.transformAABB(i,t),t.ceil(e),this.transformAABB(i.invert(),t)}}}Ar.extension={type:Be.RendererSystem,name:"filter"},je.add(Ar);class Er{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=G.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Cr=new vn;class kr{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new cr(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new vn,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;Y.PREFER_ENV===C.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=t=>e.drawBuffersWEBGL(t):(this.hasMRT=!1,t.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,n=0){const{gl:r}=this;if(t){const i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,i.mipLevel=n),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,i.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let e=0;e<t.colorTextures.length;e++){const n=t.colorTextures[e];this.renderer.texture.unbind(n.parentTextureArray||n)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const t=e.width>>n,r=e.height>>n,i=t/e.width;this.setViewport(e.x*i,e.y*i,t,r)}else{const e=t.width>>n,r=t.height>>n;this.setViewport(0,0,e,r)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,n,r){const i=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),r=Math.round(r),(i.width!==n||i.height!==r||i.x!==t||i.y!==e)&&(i.x=t,i.y=e,i.width=n,i.height=r,this.gl.viewport(t,e,n,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,n,r,i=M.COLOR|M.DEPTH){const{gl:s}=this;s.clearColor(t,e,n,r),s.clear(i)}initFramebuffer(t){const{gl:e}=this,n=new Er(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n}resizeFramebuffer(t){const{gl:e}=this,n=t.glFramebuffers[this.CONTEXT_UID];if(n.stencil){let r;e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),r=1===this.renderer.context.webGLVersion?e.DEPTH_STENCIL:t.depth&&t.stencil?e.DEPTH24_STENCIL8:t.depth?e.DEPTH_COMPONENT24:e.STENCIL_INDEX8,n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,r,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,r,t.width,t.height)}const r=t.colorTextures;let i=r.length;e.drawBuffers||(i=Math.min(i,1));for(let s=0;s<i;s++){const i=r[s],o=i.parentTextureArray||i;this.renderer.texture.bind(o,0),0===s&&n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,o._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:n}=this,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures;let s=i.length;n.drawBuffers||(s=Math.min(s,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||n.createRenderbuffer():r.msaaBuffer&&(n.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const o=[];for(let a=0;a<s;a++){const s=i[a],l=s.parentTextureArray||s;this.renderer.texture.bind(l,0),0===a&&r.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,r.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+a,s.target,l._glTextures[this.CONTEXT_UID].texture,e),o.push(n.COLOR_ATTACHMENT0+a))}if(o.length>1&&n.drawBuffers(o),t.depthTexture&&this.writeDepthTexture){const r=t.depthTexture;this.renderer.texture.bind(r,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,r._glTextures[this.CONTEXT_UID].texture,e)}if(!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture)r.stencil&&(n.deleteRenderbuffer(r.stencil),r.stencil=null);else{let e,i;r.stencil=r.stencil||n.createRenderbuffer(),1===this.renderer.context.webGLVersion?(e=n.DEPTH_STENCIL_ATTACHMENT,i=n.DEPTH_STENCIL):t.depth&&t.stencil?(e=n.DEPTH_STENCIL_ATTACHMENT,i=n.DEPTH24_STENCIL8):t.depth?(e=n.DEPTH_ATTACHMENT,i=n.DEPTH_COMPONENT24):(e=n.STENCIL_ATTACHMENT,i=n.STENCIL_INDEX8),n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,i,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,i,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,e,n.RENDERBUFFER,r.stencil)}}canMultisampleFramebuffer(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let n=G.NONE;if(t<=1||null===e)return n;for(let r=0;r<e.length;r++)if(e[r]<=t){n=e[r];break}return 1===n&&(n=G.NONE),n}blit(t,e,n){const{current:r,renderer:i,gl:s,CONTEXT_UID:o}=this;if(2!==i.context.webGLVersion||!r)return;const a=r.glFramebuffers[o];if(!a)return;if(!t){if(!a.msaaBuffer)return;const e=r.colorTextures[0];if(!e)return;a.blitFramebuffer||(a.blitFramebuffer=new cr(r.width,r.height),a.blitFramebuffer.addColorTexture(0,e)),(t=a.blitFramebuffer).colorTextures[0]!==e&&(t.colorTextures[0]=e,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||((e=Cr).width=r.width,e.height=r.height),n||(n=e);const l=e.width===n.width&&e.height===n.height;this.bind(t),s.bindFramebuffer(s.READ_FRAMEBUFFER,a.framebuffer),s.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,s.COLOR_BUFFER_BIT,l?s.NEAREST:s.LINEAR),s.bindFramebuffer(s.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const n=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!n)return;delete t.glFramebuffers[this.CONTEXT_UID];const i=this.managedFramebuffers.indexOf(t);i>=0&&this.managedFramebuffers.splice(i,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&r.deleteRenderbuffer(n.msaaBuffer),n.stencil&&r.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&this.disposeFramebuffer(n.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const n=t.width,r=t.height,i=this.gl,s=e.stencil=i.createRenderbuffer();let o,a;i.bindRenderbuffer(i.RENDERBUFFER,s),1===this.renderer.context.webGLVersion?(o=i.DEPTH_STENCIL_ATTACHMENT,a=i.DEPTH_STENCIL):t.depth?(o=i.DEPTH_STENCIL_ATTACHMENT,a=i.DEPTH24_STENCIL8):(o=i.STENCIL_ATTACHMENT,a=i.STENCIL_INDEX8),e.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,e.multisample,a,n,r):i.renderbufferStorage(i.RENDERBUFFER,a,n,r),i.framebufferRenderbuffer(i.FRAMEBUFFER,o,i.RENDERBUFFER,s)}reset(){this.current=this.unknownFramebuffer,this.viewport=new vn}destroy(){this.renderer=null}}kr.extension={type:Be.RendererSystem,name:"framebuffer"},je.add(kr);const Mr={5126:4,5123:2,5121:1};class Pr{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){let e=this.renderer.context.extensions.vertexArrayObject;Y.PREFER_ENV===C.WEBGL_LEGACY&&(e=null),e?(t.createVertexArray=()=>e.createVertexArrayOES(),t.bindVertexArray=t=>e.bindVertexArrayOES(t),t.deleteVertexArray=t=>e.deleteVertexArrayOES(t)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(2!==e.webGLVersion){const e=t.getExtension("ANGLE_instanced_arrays");e?(t.vertexAttribDivisor=(t,n)=>e.vertexAttribDivisorANGLE(t,n),t.drawElementsInstanced=(t,n,r,i,s)=>e.drawElementsInstancedANGLE(t,n,r,i,s),t.drawArraysInstanced=(t,n,r,i)=>e.drawArraysInstancedANGLE(t,n,r,i)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:n}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],i=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},i=!0);const s=r[e.program.id]||this.initGeometryVao(t,e,i);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?n.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let n=0;n<t.buffers.length;n++){const r=t.buffers[n];e.update(r)}}checkCompatibility(t,e){const n=t.attributes,r=e.attributeData;for(const t in r)if(!n[t])throw new Error(`shader and geometry incompatible, geometry missing the "${t}" attribute`)}getSignature(t,e){const n=t.attributes,r=e.attributeData,i=["g",t.id];for(const t in n)r[t]&&i.push(t,r[t].location);return i.join("-")}initGeometryVao(t,e,n=!0){const r=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.program;o.glPrograms[i]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);const a=this.getSignature(t,o),l=t.glVertexArrayObjects[this.CONTEXT_UID];let h=l[a];if(h)return l[o.id]=h,h;const c=t.buffers,u=t.attributes,d={},f={};for(const t in c)d[t]=0,f[t]=0;for(const t in u)!u[t].size&&o.attributeData[t]?u[t].size=o.attributeData[t].size:u[t].size||console.warn(`PIXI Geometry attribute '${t}' size cannot be determined (likely the bound shader does not have the attribute)`),d[u[t].buffer]+=u[t].size*Mr[u[t].type];for(const t in u){const e=u[t],n=e.size;void 0===e.stride&&(d[e.buffer]===n*Mr[e.type]?e.stride=0:e.stride=d[e.buffer]),void 0===e.start&&(e.start=f[e.buffer],f[e.buffer]+=n*Mr[e.type])}h=r.createVertexArray(),r.bindVertexArray(h);for(let t=0;t<c.length;t++){const e=c[t];s.bind(e),n&&e._glBuffers[i].refCount++}return this.activateVao(t,o),l[o.id]=h,l[a]=h,r.bindVertexArray(null),s.unbind(V.ARRAY_BUFFER),h}disposeGeometry(t,e){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const n=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,i=t.buffers,s=this.renderer?.buffer;if(t.disposeRunner.remove(this),n){if(s)for(let t=0;t<i.length;t++){const n=i[t]._glBuffers[this.CONTEXT_UID];n&&(n.refCount--,0===n.refCount&&!e&&s.dispose(i[t],e))}if(!e)for(const t in n)if("g"===t[0]){const e=n[t];this._activeVao===e&&this.unbind(),r.deleteVertexArray(e)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)}activateVao(t,e){const n=this.gl,r=this.CONTEXT_UID,i=this.renderer.buffer,s=t.buffers,o=t.attributes;t.indexBuffer&&i.bind(t.indexBuffer);let a=null;for(const t in o){const l=o[t],h=s[l.buffer],c=h._glBuffers[r];if(e.attributeData[t]){a!==c&&(i.bind(h),a=c);const r=e.attributeData[t].location;if(n.enableVertexAttribArray(r),n.vertexAttribPointer(r,l.size,l.type||n.FLOAT,l.normalized,l.stride,l.start),l.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(r,l.divisor)}}}}draw(t,e,n,r){const{gl:i}=this,s=this._activeGeometry;if(s.indexBuffer){const o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?i.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(n||0)*o,r||1):i.drawElements(t,e||s.indexBuffer.data.length,a,(n||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?i.drawArraysInstanced(t,n,e||s.getSize(),r||1):i.drawArrays(t,n,e||s.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Pr.extension={type:Be.RendererSystem,name:"geometry"},je.add(Pr);const Ir=new bn;class Rr{constructor(t,e){this._texture=t,this.mapCoord=new bn,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){void 0===e&&(e=t);const n=this.mapCoord;for(let r=0;r<t.length;r+=2){const i=t[r],s=t[r+1];e[r]=i*n.a+s*n.c+n.tx,e[r+1]=i*n.b+s*n.d+n.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const r=e.orig,i=e.trim;i&&(Ir.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(Ir));const s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,l=this.clampOffset;return o[0]=(e._frame.x+a+l)/s.width,o[1]=(e._frame.y+a+l)/s.height,o[2]=(e._frame.x+e._frame.width-a+l)/s.width,o[3]=(e._frame.y+e._frame.height-a+l)/s.height,this.uClampOffset[0]=l/s.realWidth,this.uClampOffset[1]=l/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0}}class Or extends sr{constructor(t,e,n){let r=null;"string"!=typeof t&&void 0===e&&void 0===n&&(r=t,t=void 0,e=void 0,n=void 0),super(t||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",e||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",n),this.maskSprite=r,this.maskMatrix=new bn}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,n,r){const i=this._maskSprite,s=i._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new Rr(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,t.applyFilter(this,e,n,r))}}class Lr{constructor(t=null){this.type=z.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=sr.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=z.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Dr{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let n=e;if(!n.isMaskData){const t=this.maskDataPool.pop()||new Lr;t.pooled=!0,t.maskObject=e,n=t}const r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(r),n._colorMask=r?r._colorMask:15,n.autoDetect&&this.detect(n),n._target=t,n.type!==z.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case z.SCISSOR:this.renderer.scissor.push(n);break;case z.STENCIL:this.renderer.stencil.push(n);break;case z.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case z.COLOR:this.pushColorMask(n)}n.type===z.SPRITE&&this.maskStack.push(n)}pop(t){const e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case z.SCISSOR:this.renderer.scissor.pop(e);break;case z.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case z.SPRITE:this.popSpriteMask(e);break;case z.COLOR:this.popColorMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){const t=this.maskStack[this.maskStack.length-1];t.type===z.SPRITE&&t._filters&&(t._filters[0].maskSprite=t.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=z.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=z.SCISSOR:t.type=z.STENCIL:t.type=z.COLOR}pushSpriteMask(t){const{maskObject:e}=t,n=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Or])),r[0].resolution=t.resolution,r[0].multisample=t.multisample,r[0].maskSprite=e;const i=n.filterArea;n.filterArea=e.getBounds(!0),this.renderer.filter.push(n,r),n.filterArea=i,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask(!!(1&n),!!(2&n),!!(4&n),!!(8&n))}popColorMask(t){const e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask(!!(1&n),!!(2&n),!!(4&n),!!(8&n))}destroy(){this.renderer=null}}Dr.extension={type:Be.RendererSystem,name:"mask"},je.add(Dr);class Fr{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,n=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==n&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Nr=new bn,Br=[],Wr=class t extends Fr{constructor(t){super(t),this.glConst=Y.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:n}=t,{renderer:r}=this,i=r.renderTexture,s=n.getBounds(!0,Br.pop()??new vn);this.roundFrameToPixels(s,i.current?i.current.resolution:r.resolution,i.sourceFrame,i.destinationFrame,r.projection.transform),e&&s.fit(e),t._scissorRectLocal=s}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:n,c:r,d:i}=t;return(Math.abs(n)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(i)>1e-4)}testScissor(e){const{maskObject:n}=e;if(!n.isFastRect||!n.isFastRect()||t.isMatrixRotated(n.worldTransform)||t.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const r=e._scissorRectLocal;return r.width>0&&r.height>0}roundFrameToPixels(e,n,r,i,s){t.isMatrixRotated(s)||((s=s?Nr.copyFrom(s):Nr.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,e),e.fit(i),e.x=Math.round(e.x*n),e.y=Math.round(e.y*n),e.width=Math.round(e.width*n),e.height=Math.round(e.height*n))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&Br.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;e=this.renderer.renderTexture.current?t.y:this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};Wr.extension={type:Be.RendererSystem,name:"scissor"};let Ur=Wr;je.add(Ur);class jr extends Fr{constructor(t){super(t),this.glConst=Y.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:n}=this.renderer,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;const i=t._colorMask;0!==i&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,r,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==i&&(t._colorMask=i,n.colorMask(!!(1&i),!!(2&i),!!(4&i),!!(8&i))),this._useCurrent()}pop(t){const e=this.renderer.gl;if(0===this.getStackLength())e.disable(e.STENCIL_TEST);else{const n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,r=n?n._colorMask:15;0!==r&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==r&&(n._colorMask=r,e.colorMask(!!(1&r),!!(2&r),!!(4&r),!!(8&r))),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}jr.extension={type:Be.RendererSystem,name:"stencil"},je.add(jr);class Hr{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return gt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return gt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return gt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Hr.extension={type:[Be.RendererSystem,Be.CanvasRendererSystem],name:"_plugin"},je.add(Hr);class zr{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new bn,this.transform=null}update(t,e,n,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);const i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)}calculateProjection(t,e,n,r){const i=this.projectionMatrix,s=r?-1:1;i.identity(),i.a=1/e.width*2,i.d=s*(1/e.height*2),i.tx=-1-e.x*i.a,i.ty=-s-e.y*i.d}setTransform(t){}destroy(){this.renderer=null}}zr.extension={type:Be.RendererSystem,name:"projection"},je.add(zr);const Gr=new On,Vr=new vn;class Xr{constructor(t){this.renderer=t,this._tempMatrix=new bn}generateTexture(t,e){const{region:n,...r}=e||{},i=n?.copyTo(Vr)||t.getLocalBounds(Vr,!0),s=r.resolution||this.renderer.resolution;i.width=Math.max(i.width,1/s),i.height=Math.max(i.height,1/s),r.width=i.width,r.height=i.height,r.resolution=s,r.multisample??(r.multisample=this.renderer.multisample);const o=yr.create(r);this._tempMatrix.tx=-i.x,this._tempMatrix.ty=-i.y;const a=t.transform;return t.transform=Gr,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}Xr.extension={type:[Be.RendererSystem,Be.CanvasRendererSystem],name:"textureGenerator"},je.add(Xr);const Yr=new vn,$r=new vn;class qr{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new vn,this.destinationFrame=new vn,this.viewportFrame=new vn}contextChange(){const t=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,n){const r=this.renderer;let i,s,o;this.current=t,t?(i=t.baseTexture,o=i.resolution,e||(Yr.width=t.frame.width,Yr.height=t.frame.height,e=Yr),n||($r.x=t.frame.x,$r.y=t.frame.y,$r.width=e.width,$r.height=e.height,n=$r),s=i.framebuffer):(o=r.resolution,e||(Yr.width=r._view.screen.width,Yr.height=r._view.screen.height,e=Yr),n||((n=Yr).width=e.width,n.height=e.height));const a=this.viewportFrame;a.x=n.x*o,a.y=n.y*o,a.width=n.width*o,a.height=n.height*o,t||(a.y=r.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(s,a),this.renderer.projection.update(n,e,o,!s),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)}clear(t,e){const n=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=ee.shared.setValue(t||n);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const i=this.destinationFrame,s=this.current?this.current.baseTexture:this.renderer._view.screen,o=i.width!==s.width||i.height!==s.height;if(o){let{x:t,y:e,width:n,height:r}=this.viewportFrame;t=Math.round(t),e=Math.round(e),n=Math.round(n),r=Math.round(r),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(t,e,n,r)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,e),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}qr.extension={type:Be.RendererSystem,name:"renderTexture"},je.add(qr);class Kr{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Zr(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function Qr(t){const e=new Array(t);for(let t=0;t<e.length;t++)e[t]=!1;return e}function Jr(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return Qr(2*e);case"bvec3":return Qr(3*e);case"bvec4":return Qr(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function ti(t,e){const n=t.getShaderSource(e).split("\n").map(((t,e)=>`${e}: ${t}`)),r=t.getShaderInfoLog(e),i=r.split("\n"),s={},o=i.map((t=>parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1")))).filter((t=>!(!t||s[t]||(s[t]=!0,0)))),a=[""];o.forEach((t=>{n[t-1]=`%c${n[t-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));const l=n.join("\n");a[0]=l,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function ei(t,e,n,r,i){n.buffer.update(i)}const ni={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},ri={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};let ii,si=0;const oi={textureCount:0,uboCount:0};class ai{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=si++}systemCheck(){if(!function(){if("boolean"==typeof ii)return ii;try{ii=!0===new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch{ii=!1}return ii}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const n=t.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),e||(oi.textureCount=0,oi.uboCount=0,this.syncUniformGroup(t.uniformGroup,oi)),r}setUniforms(t){const e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)}syncUniformGroup(t,e){const n=this.getGlProgram();(!t.static||t.dirtyId!==n.uniformDirtyGroups[t.id])&&(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))}syncUniforms(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){const n=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(const r in t.uniforms){const i=e[r];if(!i){!0===t.uniforms[r]?.group&&(t.uniforms[r].ubo?n.push(`\n                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');\n                    `):n.push(`\n                        renderer.shader.syncUniformGroup(uv.${r}, syncData);\n                    `));continue}const s=t.uniforms[r];let o=!1;for(let t=0;t<Ln.length;t++)if(Ln[t].test(i,s)){n.push(Ln[t].code(r,s)),o=!0;break}if(!o){const t=(1!==i.size||i.isArray?Fn:Dn)[i.type].replace("location",`ud["${r}"].location`);n.push(`\n            cu = ud["${r}"];\n            cv = cu.value;\n            v = uv["${r}"];\n            ${t};`)}}return new Function("ud","uv","renderer","syncData",n.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const n=this.getGlProgram();if(!t.static||0!==t.dirtyId||!n.uniformGroups[t.id]){t.dirtyId=0;const r=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),r(n.uniformData,t.uniforms,this.renderer,oi,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])}createSyncBufferGroup(t,e,n){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const i=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;const s=this.getSignature(t,this.shader.program.uniformData,"ubo");let o=this._uboCache[s];if(o||(o=this._uboCache[s]=function(t,e){if(!t.autoManage)return{size:0,syncFunc:ei};const n=function(t,e){const n=[];for(const r in t)e[r]&&n.push(e[r]);return n.sort(((t,e)=>t.index-e.index)),n}(t.uniforms,e),{uboElements:r,size:i}=function(t){const e=t.map((t=>({data:t,offset:0,dataLen:0,dirty:0})));let n=0,r=0,i=0;for(let t=0;t<e.length;t++){const s=e[t];if(n=ri[s.data.type],s.data.size>1&&(n=Math.max(n,16)*s.data.size),s.dataLen=n,r%n!=0&&r<16){const t=r%n%16;r+=t,i+=t}r+n>16?(i=16*Math.ceil(i/16),s.offset=i,i+=n,r=n):(s.offset=i,r+=n,i+=n)}return i=16*Math.ceil(i/16),{uboElements:e,size:i}}(n),s=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(let e=0;e<r.length;e++){const n=r[e],i=t.uniforms[n.data.name],o=n.data.name;let a=!1;for(let t=0;t<Ln.length;t++){const e=Ln[t];if(e.codeUbo&&e.test(n.data,i)){s.push(`offset = ${n.offset/4};`,Ln[t].codeUbo(n.data.name,i)),a=!0;break}}if(!a)if(n.data.size>1){const t=jn(n.data.type),e=Math.max(ri[n.data.type]/16,1),r=t/e,i=(4-r%4)%4;s.push(`\n                cv = ud.${o}.value;\n                v = uv.${o};\n                offset = ${n.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${n.data.size*e}; i++)\n                {\n                    for(var j = 0; j < ${r}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${i};\n                }\n\n                `)}else{const t=ni[n.data.type];s.push(`\n                cv = ud.${o}.value;\n                v = uv.${o};\n                offset = ${n.offset/4};\n                ${t};\n                `)}}return s.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join("\n"))}}(t,this.shader.program.uniformData)),t.autoManage){const e=new Float32Array(o.size/4);t.buffer.update(e)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,n){const r=t.uniforms,i=[`${n}-`];for(const t in r)i.push(t),e[t]&&i.push(e[t].type);return i.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,n=t.program,r=function(t,e){const n=Zr(t,t.VERTEX_SHADER,e.vertexSrc),r=Zr(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,n),t.attachShader(i,r);const s=e.extra?.transformFeedbackVaryings;if(s&&("function"!=typeof t.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,"separate"===s.bufferMode?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||function(t,e,n,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||ti(t,n),t.getShaderParameter(r,t.COMPILE_STATUS)||ti(t,r),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,i,n,r),e.attributeData=function(t,e){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i);if(r.name.startsWith("gl_"))continue;const s=Gn(e,r.type),o={type:s,name:r.name,size:jn(s),location:e.getAttribLocation(t,r.name)};n[r.name]=o}return n}(i,t),e.uniformData=function(t,e){const n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const r=e.getActiveUniform(t,i),s=r.name.replace(/\[.*?\]$/,""),o=!!r.name.match(/\[.*?\]$/),a=Gn(e,r.type);n[s]={name:s,index:i,type:a,size:r.size,isArray:o,value:Jr(a,r.size)}}return n}(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const n=Object.keys(e.attributeData);n.sort(((t,e)=>t>e?1:-1));for(let r=0;r<n.length;r++)e.attributeData[n[r]].location=r,t.bindAttribLocation(i,r,n[r]);t.linkProgram(i)}t.deleteShader(n),t.deleteShader(r);const o={};for(const n in e.uniformData){const r=e.uniformData[n];o[n]={location:t.getUniformLocation(i,n),value:Jr(r.type,r.size)}}return new Kr(i,o)}(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}ai.extension={type:Be.RendererSystem,name:"shader"},je.add(ai);class li{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.4.3 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}li.defaultOptions={hello:!1},li.extension={type:[Be.RendererSystem,Be.CanvasRendererSystem],name:"startup"},je.add(li);const hi=class t{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=P.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Ve,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=function(t,e=[]){return e[P.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.ADD]=[t.ONE,t.ONE],e[P.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.NONE]=[0,0],e[P.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[P.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[P.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[P.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[P.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[P.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[P.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[P.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[P.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[P.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[P.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,n=0;for(;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):!e&&-1!==n&&this.checks.splice(n,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};hi.extension={type:Be.RendererSystem,name:"state"};let ci=hi;je.add(ci);class ui extends dt{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter((e=>t.systems[e])),n=[...e,...Object.keys(t.systems).filter((t=>!e.includes(t)))];for(const e of n)this.addSystem(t.systems[e],e)}addRunners(...t){t.forEach((t=>{this.runners[t]=new $e(t)}))}addSystem(t,e){const n=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=n,this._systemsHash[e]=n;for(const t in this.runners)this.runners[t].add(n);return this}emitWithCustomOptions(t,e){const n=Object.keys(this._systemsHash);t.items.forEach((r=>{const i=n.find((t=>this._systemsHash[t]===r));r[t.name](e[i])}))}destroy(){Object.values(this.runners).forEach((t=>{t.destroy()})),this._systemsHash={}}}const di=class t{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=t.defaultMaxIdle,this.checkCountMax=t.defaultCheckCountMax,this.mode=t.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==j.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let n=!1;for(let r=0;r<e.length;r++){const i=e[r];i.resource&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[r]=null,n=!0)}if(n){let t=0;for(let n=0;n<e.length;n++)null!==e[n]&&(e[t++]=e[n]);e.length=t}}unload(t){const e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(let e=t.children.length-1;e>=0;e--)this.unload(t.children[e])}destroy(){this.renderer=null}};di.defaultMode=j.AUTO,di.defaultMaxIdle=3600,di.defaultCheckCountMax=600,di.extension={type:Be.RendererSystem,name:"textureGC"};let fi=di;je.add(fi);class pi{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=L.UNSIGNED_BYTE,this.internalFormat=R.RGBA,this.samplerType=0}}class mi{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Je,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){let e;return e="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[L.UNSIGNED_BYTE]:{[R.RGBA]:t.RGBA8,[R.RGB]:t.RGB8,[R.RG]:t.RG8,[R.RED]:t.R8,[R.RGBA_INTEGER]:t.RGBA8UI,[R.RGB_INTEGER]:t.RGB8UI,[R.RG_INTEGER]:t.RG8UI,[R.RED_INTEGER]:t.R8UI,[R.ALPHA]:t.ALPHA,[R.LUMINANCE]:t.LUMINANCE,[R.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[L.BYTE]:{[R.RGBA]:t.RGBA8_SNORM,[R.RGB]:t.RGB8_SNORM,[R.RG]:t.RG8_SNORM,[R.RED]:t.R8_SNORM,[R.RGBA_INTEGER]:t.RGBA8I,[R.RGB_INTEGER]:t.RGB8I,[R.RG_INTEGER]:t.RG8I,[R.RED_INTEGER]:t.R8I},[L.UNSIGNED_SHORT]:{[R.RGBA_INTEGER]:t.RGBA16UI,[R.RGB_INTEGER]:t.RGB16UI,[R.RG_INTEGER]:t.RG16UI,[R.RED_INTEGER]:t.R16UI,[R.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[L.SHORT]:{[R.RGBA_INTEGER]:t.RGBA16I,[R.RGB_INTEGER]:t.RGB16I,[R.RG_INTEGER]:t.RG16I,[R.RED_INTEGER]:t.R16I},[L.UNSIGNED_INT]:{[R.RGBA_INTEGER]:t.RGBA32UI,[R.RGB_INTEGER]:t.RGB32UI,[R.RG_INTEGER]:t.RG32UI,[R.RED_INTEGER]:t.R32UI,[R.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[L.INT]:{[R.RGBA_INTEGER]:t.RGBA32I,[R.RGB_INTEGER]:t.RGB32I,[R.RG_INTEGER]:t.RG32I,[R.RED_INTEGER]:t.R32I},[L.FLOAT]:{[R.RGBA]:t.RGBA32F,[R.RGB]:t.RGB32F,[R.RG]:t.RG32F,[R.RED]:t.R32F,[R.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[L.HALF_FLOAT]:{[R.RGBA]:t.RGBA16F,[R.RGB]:t.RGB16F,[R.RG]:t.RG16F,[R.RED]:t.R16F},[L.UNSIGNED_SHORT_5_6_5]:{[R.RGB]:t.RGB565},[L.UNSIGNED_SHORT_4_4_4_4]:{[R.RGBA]:t.RGBA4},[L.UNSIGNED_SHORT_5_5_5_1]:{[R.RGBA]:t.RGB5_A1},[L.UNSIGNED_INT_2_10_10_10_REV]:{[R.RGBA]:t.RGB10_A2,[R.RGBA_INTEGER]:t.RGB10_A2UI},[L.UNSIGNED_INT_10F_11F_11F_REV]:{[R.RGB]:t.R11F_G11F_B10F},[L.UNSIGNED_INT_5_9_9_9_REV]:{[R.RGB]:t.RGB9_E5},[L.UNSIGNED_INT_24_8]:{[R.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[L.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[R.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:{[L.UNSIGNED_BYTE]:{[R.RGBA]:t.RGBA,[R.RGB]:t.RGB,[R.ALPHA]:t.ALPHA,[R.LUMINANCE]:t.LUMINANCE,[R.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[L.UNSIGNED_SHORT_5_6_5]:{[R.RGB]:t.RGB},[L.UNSIGNED_SHORT_4_4_4_4]:{[R.RGBA]:t.RGBA},[L.UNSIGNED_SHORT_5_5_5_1]:{[R.RGBA]:t.RGBA}},e}(t),this.samplerTypes=function(t){let e;return e="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[t.RGB]:D.FLOAT,[t.RGBA]:D.FLOAT,[t.ALPHA]:D.FLOAT,[t.LUMINANCE]:D.FLOAT,[t.LUMINANCE_ALPHA]:D.FLOAT,[t.R8]:D.FLOAT,[t.R8_SNORM]:D.FLOAT,[t.RG8]:D.FLOAT,[t.RG8_SNORM]:D.FLOAT,[t.RGB8]:D.FLOAT,[t.RGB8_SNORM]:D.FLOAT,[t.RGB565]:D.FLOAT,[t.RGBA4]:D.FLOAT,[t.RGB5_A1]:D.FLOAT,[t.RGBA8]:D.FLOAT,[t.RGBA8_SNORM]:D.FLOAT,[t.RGB10_A2]:D.FLOAT,[t.RGB10_A2UI]:D.FLOAT,[t.SRGB8]:D.FLOAT,[t.SRGB8_ALPHA8]:D.FLOAT,[t.R16F]:D.FLOAT,[t.RG16F]:D.FLOAT,[t.RGB16F]:D.FLOAT,[t.RGBA16F]:D.FLOAT,[t.R32F]:D.FLOAT,[t.RG32F]:D.FLOAT,[t.RGB32F]:D.FLOAT,[t.RGBA32F]:D.FLOAT,[t.R11F_G11F_B10F]:D.FLOAT,[t.RGB9_E5]:D.FLOAT,[t.R8I]:D.INT,[t.R8UI]:D.UINT,[t.R16I]:D.INT,[t.R16UI]:D.UINT,[t.R32I]:D.INT,[t.R32UI]:D.UINT,[t.RG8I]:D.INT,[t.RG8UI]:D.UINT,[t.RG16I]:D.INT,[t.RG16UI]:D.UINT,[t.RG32I]:D.INT,[t.RG32UI]:D.UINT,[t.RGB8I]:D.INT,[t.RGB8UI]:D.UINT,[t.RGB16I]:D.INT,[t.RGB16UI]:D.UINT,[t.RGB32I]:D.INT,[t.RGB32UI]:D.UINT,[t.RGBA8I]:D.INT,[t.RGBA8UI]:D.UINT,[t.RGBA16I]:D.INT,[t.RGBA16UI]:D.UINT,[t.RGBA32I]:D.INT,[t.RGBA32UI]:D.UINT,[t.DEPTH_COMPONENT16]:D.FLOAT,[t.DEPTH_COMPONENT24]:D.FLOAT,[t.DEPTH_COMPONENT32F]:D.FLOAT,[t.DEPTH_STENCIL]:D.FLOAT,[t.DEPTH24_STENCIL8]:D.FLOAT,[t.DEPTH32F_STENCIL8]:D.FLOAT}:{[t.RGB]:D.FLOAT,[t.RGBA]:D.FLOAT,[t.ALPHA]:D.FLOAT,[t.LUMINANCE]:D.FLOAT,[t.LUMINANCE_ALPHA]:D.FLOAT,[t.DEPTH_STENCIL]:D.FLOAT},e}(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let t=0;t<e;t++)this.boundTextures[t]=null;this.emptyTextures={};const n=new pi(t.createTexture());t.bindTexture(t.TEXTURE_2D,n.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=n,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new pi(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let e=0;e<6;e++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let t=0;t<this.boundTextures.length;t++)this.bind(null,t)}bind(t,e=0){const{gl:n}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let t=0;t<n.length;t++)n[t]===this.unknownTexture&&this.bind(null,t)}for(let r=0;r<n.length;r++)n[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:n,CONTEXT_UID:r}=this;if(n)for(let n=t-1;n>=0;--n){const t=e[n];t&&t._glTextures[r].samplerType!==D.FLOAT&&this.renderer.texture.unbind(t)}}initTexture(t){const e=new pi(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){e.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??D.FLOAT,2===this.webGLVersion&&t.type===L.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const n=this.renderer;if(this.initTextureType(t,e),t.resource?.upload(n,t,e))e.samplerType!==D.FLOAT&&(this.hasIntegerTextures=!0);else{const r=t.realWidth,i=t.realHeight,s=n.gl;(e.width!==r||e.height!==i||e.dirtyId<0)&&(e.width=r,e.height=i,s.texImage2D(t.target,0,e.internalFormat,r,i,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:n}=this;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const e=this.managedTextures.indexOf(t);-1!==e&&xe(this.managedTextures,e,1)}}updateTextureStyle(t){const e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==B.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=N.CLAMP,t.resource?.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const n=this.gl;if(e.mipmap&&t.mipmap!==B.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===F.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const e=this.renderer.context.extensions.anisotropicFiltering;if(e&&t.anisotropicLevel>0&&t.scaleMode===F.LINEAR){const r=Math.min(t.anisotropicLevel,n.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,e.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===F.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===F.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}mi.extension={type:Be.RendererSystem,name:"texture"},je.add(mi);class gi{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,r=t._glTransformFeedbacks[n]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:n,renderer:r}=this;e&&r.shader.bind(e),n.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:n,CONTEXT_UID:r}=this,i=e.createTransformFeedback();t._glTransformFeedbacks[r]=i,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,i);for(let i=0;i<t.buffers.length;i++){const s=t.buffers[i];s&&(n.buffer.update(s),s._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,i,s._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),i}disposeTransformFeedback(t,e){const n=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const i=this.renderer.buffer;if(i)for(let n=0;n<t.buffers.length;n++){const r=t.buffers[n];if(!r)continue;const s=r._glBuffers[this.CONTEXT_UID];s&&(s.refCount--,0===s.refCount&&!e&&i.dispose(r,e))}n&&(e||r.deleteTransformFeedback(n),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}gi.extension={type:Be.RendererSystem,name:"transformFeedback"},je.add(gi);class vi{constructor(t){this.renderer=t}init(t){this.screen=new vn(0,0,t.width,t.height),this.element=t.view||Y.ADAPTER.createCanvas(),this.resolution=t.resolution||Y.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const n=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=n,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",n,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}vi.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},vi.extension={type:[Be.RendererSystem,Be.CanvasRendererSystem],name:"_view"},je.add(vi),Y.PREFER_ENV=C.WEBGL2,Y.STRICT_TEXTURE_CACHE=!1,Y.RENDER_OPTIONS={...hr.defaultOptions,...or.defaultOptions,...vi.defaultOptions,...li.defaultOptions},Object.defineProperties(Y,{WRAP_MODE:{get(){return Je.defaultOptions.wrapMode},set(t){gt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Je.defaultOptions.wrapMode=t}},SCALE_MODE:{get(){return Je.defaultOptions.scaleMode},set(t){gt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Je.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get(){return Je.defaultOptions.mipmap},set(t){gt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Je.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get(){return Je.defaultOptions.anisotropicLevel},set(t){gt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Je.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get(){return gt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),sr.defaultResolution},set(t){sr.defaultResolution=t}},FILTER_MULTISAMPLE:{get(){return gt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),sr.defaultMultisample},set(t){sr.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get(){return rr.defaultMaxTextures},set(t){gt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),rr.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get(){return rr.defaultBatchSize},set(t){gt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),rr.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get(){return rr.canUploadSameBuffer},set(t){gt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),rr.canUploadSameBuffer=t}},GC_MODE:{get(){return fi.defaultMode},set(t){gt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),fi.defaultMode=t}},GC_MAX_IDLE:{get(){return fi.defaultMaxIdle},set(t){gt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),fi.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get(){return fi.defaultCheckCountMax},set(t){gt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),fi.defaultCheckCountMax=t}},PRECISION_VERTEX:{get(){return qn.defaultVertexPrecision},set(t){gt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),qn.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get(){return qn.defaultFragmentPrecision},set(t){gt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),qn.defaultFragmentPrecision=t}}});var yi=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(yi||{});class xi{constructor(t,e=null,n=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const wi=class t{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new xi(null,null,1/0),this.deltaMS=1/t.targetFPMS,this.elapsedMS=1/t.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,n=yi.NORMAL){return this._addListener(new xi(t,e,n))}addOnce(t,e,n=yi.NORMAL){return this._addListener(new xi(t,e,n,!0))}_addListener(t){let e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this}remove(t,e){let n=this._head.next;for(;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let n;if(e>this.lastTime){if(n=this.elapsedMS=e-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),n*=this.speed,this._minElapsedMS){const t=e-this._lastFrame|0;if(t<this._minElapsedMS)return;this._lastFrame=e-t%this._minElapsedMS}this.deltaMS=n,this.deltaTime=this.deltaMS*t.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const n=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,n)/1e3,t.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!t._shared){const e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared}static get system(){if(!t._system){const e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system}};wi.targetFPMS=.06;let _i=wi;Object.defineProperties(Y,{TARGET_FPMS:{get(){return _i.targetFPMS},set(t){gt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),_i.targetFPMS=t}}});class bi{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,yi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?_i.shared:new _i,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}bi.extension=Be.Application,je.add(bi);const Ti=[];je.handleByList(Be.Renderer,Ti);const Si="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";class Ai{constructor(t){this.renderer=t}contextChange(t){let e;if(1===this.renderer.context.webGLVersion){const n=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,n)}else{const n=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,n)}e>=G.HIGH?this.multisample=G.HIGH:e>=G.MEDIUM?this.multisample=G.MEDIUM:e>=G.LOW?this.multisample=G.LOW:this.multisample=G.NONE}destroy(){}}Ai.extension={type:Be.RendererSystem,name:"_multisample"},je.add(Ai);class Ei{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Ci{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,r=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:n,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const i=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,i.buffer)}}bindBufferRange(t,e,n){const{gl:r,CONTEXT_UID:i}=this;n=n||0;const s=t._glBuffers[i]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,s.buffer,256*n,256)}update(t){const{gl:e,CONTEXT_UID:n}=this,r=t._glBuffers[n]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const n=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),n&&(e||r.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:n}=this;return t._glBuffers[e]=new Ei(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}Ci.extension={type:Be.RendererSystem,name:"buffer"},je.add(Ci);class ki{constructor(t){this.renderer=t}render(t,e){const n=this.renderer;let r,i,s,o;if(e&&(r=e.renderTexture,i=e.clear,s=e.transform,o=e.skipUpdateTransform),this.renderingToScreen=!r,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=s,!n.context.isLost){if(r||(this.lastObjectRendered=t),!o){const e=t.enableTempParent();t.updateTransform(),t.disableTempParent(e)}n.renderTexture.bind(r),n.batch.currentRenderer.start(),(i??n.background.clearBeforeRender)&&n.renderTexture.clear(),t.render(n),n.batch.currentRenderer.flush(),r&&(e.blit&&n.framebuffer.blit(),r.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ki.extension={type:Be.RendererSystem,name:"objectRenderer"},je.add(ki);const Mi=class t extends ui{constructor(e){super(),this.type=k.WEBGL,e=Object.assign({},Y.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Zn({projectionMatrix:new bn},!0);const n={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:t.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(n),"useContextAlpha"in e&&(gt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&"notMultiplied"!==e.useContextAlpha,e.backgroundAlpha=!1===e.useContextAlpha?1:e.backgroundAlpha),this._plugin.rendererPlugins=t.__plugins,this.options=e,this.startup.run(this.options)}static test(t){return!t?.forceCanvas&&Et()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return gt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return gt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return gt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return gt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){gt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return gt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){gt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return gt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};Mi.extension={type:Be.Renderer,priority:1},Mi.__plugins={},Mi.__systems={};let Pi=Mi;je.handleByMap(Be.RendererPlugin,Pi.__plugins),je.handleByMap(Be.RendererSystem,Pi.__systems),je.add(Pi);class Ii extends qe{constructor(t,e){const{width:n,height:r}=e||{};super(n,r),this.items=[],this.itemDirtyIds=[];for(let e=0;e<t;e++){const t=new Je;this.items.push(t),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof qe?this.addResourceAt(t[n],n):this.addResourceAt(Ye(t[n],e),n))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map((t=>t.resource)).filter((t=>t)).map((t=>t.load()));return this._load=Promise.all(t).then((()=>{const{realWidth:t,realHeight:e}=this.items[0];return this.resize(t,e),this.update(),Promise.resolve(this)})),this._load}}class Ri extends dr{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Oi=class t extends Ii{constructor(e,n){const{width:r,height:i,autoLoad:s,linkBaseTexture:o}=n||{};if(e&&e.length!==t.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let e=0;e<t.SIDES;e++)this.items[e].target=O.TEXTURE_CUBE_MAP_POSITIVE_X+e;this.linkBaseTexture=!1!==o,e&&this.initFromArray(e,n),!1!==s&&this.load()}bind(t){super.bind(t),t.target=O.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=O.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(e,n,r){const i=this.itemDirtyIds;for(let s=0;s<t.SIDES;s++){const t=this.items[s];(i[s]<t.dirtyId||r.dirtyId<n.dirtyId)&&(t.valid&&t.resource?(t.resource.upload(e,t,r),i[s]=t.dirtyId):i[s]<-1&&(e.gl.texImage2D(t.target,0,r.internalFormat,n.realWidth,n.realHeight,0,n.format,r.type,null),i[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===t.SIDES}};Oi.SIDES=6;let Li=Oi;class Di extends dr{constructor(t,e){let n,r,i;e=e||{},"string"==typeof t?(n=Di.EMPTY,r=t,i=!0):(n=t,r=null,i=!1),super(n),this.url=r,this.crossOrigin=e.crossOrigin??!0,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??i,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((async(t,e)=>{if(null!==this.url)try{const e=await Y.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const n=await e.blob();if(this.destroyed)return;const r=await createImageBitmap(n,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===W.UNPACK?"premultiply":"none"});if(this.destroyed)return void r.close();this.source=r,this.update(),t(this)}catch(t){if(this.destroyed)return;e(t),this.onError.emit(t)}else t(this)}))),this._load}upload(t,e,n){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),super.upload(t,e,n)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&("string"==typeof t||t instanceof ImageBitmap)}static get EMPTY(){return Di._EMPTY=Di._EMPTY??Y.ADAPTER.createCanvas(0,0),Di._EMPTY}}const Fi=class t extends dr{constructor(t,e){e=e||{},super(Y.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((e=>{if(this._resolve=()=>{this.update(),e(this)},t.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}))),this._load}_loadSvg(){const t=new Image;dr.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,n=t.height;if(!e||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=e*this.scale,i=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/n*e,i=this._overrideHeight||this._overrideWidth/e*n),r=Math.round(r),i=Math.round(i);const s=this.source;s.width=r,s.height=i,s._pixiId=`canvas_${be()}`,s.getContext("2d").drawImage(t,0,0,e,n,0,0,r,i),this._resolve(),this._resolve=null}}static getSize(e){const n=t.SVG_SIZE.exec(e),r={};return n&&(r[n[1]]=Math.round(parseFloat(n[3])),r[n[5]]=Math.round(parseFloat(n[7]))),r}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,n){return"svg"===n||"string"==typeof e&&e.startsWith("data:image/svg+xml")||"string"==typeof e&&t.SVG_XML.test(e)}};Fi.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Fi.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Ni=Fi;const Bi=class t extends dr{constructor(e,n){if(n=n||{},!(e instanceof HTMLVideoElement)){const r=document.createElement("video");!1!==n.autoLoad&&r.setAttribute("preload","auto"),!1!==n.playsinline&&(r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline","")),!0===n.muted&&(r.setAttribute("muted",""),r.muted=!0),!0===n.loop&&r.setAttribute("loop",""),!1!==n.autoPlay&&r.setAttribute("autoplay",""),"string"==typeof e&&(e=[e]);const i=e[0].src||e[0];dr.crossOrigin(r,i,n.crossorigin);for(let n=0;n<e.length;++n){const i=document.createElement("source");let{src:s,mime:o}=e[n];if(s=s||e[n],s.startsWith("data:"))o=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const e=s.split("?").shift().toLowerCase(),n=e.slice(e.lastIndexOf(".")+1);o=o||t.MIME_TYPES[n]||`video/${n}`}i.src=s,o&&(i.type=o),r.appendChild(i)}e=r}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=n.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==n.autoPlay,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==n.autoLoad&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const t=_i.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(((e,n)=>{this.valid?e(this):(this._resolve=e,this._reject=n,t.load())})),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(_i.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(_i.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(_i.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,n){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||t.TYPES.includes(n)}};Bi.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Bi.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Wi,Ui=Bi;function ji(t){const e=Y.ADAPTER.createCanvas(6,1),n=e.getContext("2d");return n.fillStyle=t,n.fillRect(0,0,6,1),e}function Hi(){if(typeof document>"u")return!1;if(void 0!==Wi)return Wi;const t=ji("#ff00ff"),e=ji("#ffff00"),n=Y.ADAPTER.createCanvas(6,1).getContext("2d");n.globalCompositeOperation="multiply",n.drawImage(t,0,0),n.drawImage(e,2,0);const r=n.getImageData(2,0,1,1);if(r){const t=r.data;Wi=255===t[0]&&0===t[1]&&0===t[2]}else Wi=!1;return Wi}Xe.push(Di,fr,Ri,Ui,class extends dr{constructor(t){super(t)}static test(t){return!!globalThis.VideoFrame&&t instanceof globalThis.VideoFrame}},Ni,Ke,Li,class extends Ii{constructor(t,e){const{width:n,height:r}=e||{};let i,s;Array.isArray(t)?(i=t,s=t.length):s=t,super(s,{width:n,height:r}),i&&this.initFromArray(i,e)}addBaseTextureAt(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this}bind(t){super.bind(t),t.target=O.TEXTURE_2D_ARRAY}upload(t,e,n){const{length:r,itemDirtyIds:i,items:s}=this,{gl:o}=t;n.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,e.format,n.type,null);for(let t=0;t<r;t++){const r=s[t];i[t]<r.dirtyId&&(i[t]=r.dirtyId,r.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,t,r.resource.width,r.resource.height,1,e.format,n.type,r.resource.source))}return!0}}),Je.prototype.getDrawableSource=function(){const t=this.resource;return t?t.bitmap||t.source:null},ur.prototype._canvasRenderTarget=null,vr.prototype.patternCache=null,vr.prototype.tintCache=null;const zi=new bn;class Gi{constructor(t){this.activeResolution=1,this.smoothProperty="imageSmoothingEnabled",this.blendModes=function(t=[]){return Hi()?(t[P.NORMAL]="source-over",t[P.ADD]="lighter",t[P.MULTIPLY]="multiply",t[P.SCREEN]="screen",t[P.OVERLAY]="overlay",t[P.DARKEN]="darken",t[P.LIGHTEN]="lighten",t[P.COLOR_DODGE]="color-dodge",t[P.COLOR_BURN]="color-burn",t[P.HARD_LIGHT]="hard-light",t[P.SOFT_LIGHT]="soft-light",t[P.DIFFERENCE]="difference",t[P.EXCLUSION]="exclusion",t[P.HUE]="hue",t[P.SATURATION]="saturation",t[P.COLOR]="color",t[P.LUMINOSITY]="luminosity"):(t[P.NORMAL]="source-over",t[P.ADD]="lighter",t[P.MULTIPLY]="source-over",t[P.SCREEN]="source-over",t[P.OVERLAY]="source-over",t[P.DARKEN]="source-over",t[P.LIGHTEN]="source-over",t[P.COLOR_DODGE]="source-over",t[P.COLOR_BURN]="source-over",t[P.HARD_LIGHT]="source-over",t[P.SOFT_LIGHT]="source-over",t[P.DIFFERENCE]="source-over",t[P.EXCLUSION]="source-over",t[P.HUE]="source-over",t[P.SATURATION]="source-over",t[P.COLOR]="source-over",t[P.LUMINOSITY]="source-over"),t[P.NORMAL_NPM]=t[P.NORMAL],t[P.ADD_NPM]=t[P.ADD],t[P.SCREEN_NPM]=t[P.SCREEN],t[P.SRC_IN]="source-in",t[P.SRC_OUT]="source-out",t[P.SRC_ATOP]="source-atop",t[P.DST_OVER]="destination-over",t[P.DST_IN]="destination-in",t[P.DST_OUT]="destination-out",t[P.DST_ATOP]="destination-atop",t[P.XOR]="xor",t[P.SUBTRACT]="source-over",t}(),this._activeBlendMode=null,this._projTransform=null,this._outerBlend=!1,this.renderer=t}init(){const t=this.renderer.background.alpha<1;if(this.rootContext=this.renderer.view.getContext("2d",{alpha:t}),this.activeContext=this.rootContext,!this.rootContext.imageSmoothingEnabled){const t=this.rootContext;t.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":t.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":t.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":t.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")}}setContextTransform(t,e,n){let r=t;const i=this._projTransform,s=this.activeResolution;n=n||s,i&&(r=zi,r.copyFrom(t),r.prepend(i)),e?this.activeContext.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*s|0,r.ty*s|0):this.activeContext.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*s,r.ty*s)}clear(t,e){const{activeContext:n,renderer:r}=this,i=t?ee.shared.setValue(t):this.renderer.background.backgroundColor;n.clearRect(0,0,r.width,r.height),t&&(n.globalAlpha=e??this.renderer.background.alpha,n.fillStyle=i.toHex(),n.fillRect(0,0,r.width,r.height),n.globalAlpha=1)}setBlendMode(t,e){const n=t===P.SRC_IN||t===P.SRC_OUT||t===P.DST_IN||t===P.DST_ATOP;!e&&n&&(t=P.NORMAL),this._activeBlendMode!==t&&(this._activeBlendMode=t,this._outerBlend=n,this.activeContext.globalCompositeOperation=this.blendModes[t])}resize(){this.smoothProperty&&(this.rootContext[this.smoothProperty]=Je.defaultOptions.scaleMode===F.LINEAR)}invalidateBlendMode(){this._activeBlendMode=this.blendModes.indexOf(this.activeContext.globalCompositeOperation)}destroy(){this.renderer=null,this.rootContext=null,this.activeContext=null,this.smoothProperty=null}}Gi.extension={type:Be.CanvasRendererSystem,name:"canvasContext"},je.add(Gi);class Vi{constructor(t){this._foundShapes=[],this.renderer=t}pushMask(t){const e=this.renderer,n=t.maskObject||t;e.canvasContext.activeContext.save();const r=this._foundShapes;if(this.recursiveFindShapes(n,r),r.length>0){const t=e.canvasContext.activeContext;t.beginPath();for(let t=0;t<r.length;t++){const e=r[t],n=e.transform.worldTransform;this.renderer.canvasContext.setContextTransform(n),this.renderGraphicsShape(e)}r.length=0,t.clip()}}recursiveFindShapes(t,e){t.geometry&&t.geometry.graphicsData&&e.push(t);const{children:n}=t;if(n)for(let t=0;t<n.length;t++)this.recursiveFindShapes(n[t],e)}renderGraphicsShape(t){t.finishPoly();const e=this.renderer.canvasContext.activeContext,n=t.geometry.graphicsData,r=n.length;if(0!==r)for(let t=0;t<r;t++){const r=n[t],i=r.shape;if(i.type===pn.POLY){let t=i.points;const n=r.holes;let s,o,a,l;e.moveTo(t[0],t[1]);for(let n=1;n<t.length/2;n++)e.lineTo(t[2*n],t[2*n+1]);if(n.length>0){s=0,a=t[0],l=t[1];for(let e=2;e+2<t.length;e+=2)s+=(t[e]-a)*(t[e+3]-l)-(t[e+2]-a)*(t[e+1]-l);for(let r=0;r<n.length;r++)if(t=n[r].shape.points,t){o=0,a=t[0],l=t[1];for(let e=2;e+2<t.length;e+=2)o+=(t[e]-a)*(t[e+3]-l)-(t[e+2]-a)*(t[e+1]-l);if(o*s<0){e.moveTo(t[0],t[1]);for(let n=2;n<t.length;n+=2)e.lineTo(t[n],t[n+1])}else{e.moveTo(t[t.length-2],t[t.length-1]);for(let n=t.length-4;n>=0;n-=2)e.lineTo(t[n],t[n+1])}n[r].shape.closeStroke&&e.closePath()}}t[0]===t[t.length-2]&&t[1]===t[t.length-1]&&e.closePath()}else if(i.type===pn.RECT)e.rect(i.x,i.y,i.width,i.height),e.closePath();else if(i.type===pn.CIRC)e.arc(i.x,i.y,i.radius,0,2*Math.PI),e.closePath();else if(i.type===pn.ELIP){const t=2*i.width,n=2*i.height,r=i.x-t/2,s=i.y-n/2,o=.5522848,a=t/2*o,l=n/2*o,h=r+t,c=s+n,u=r+t/2,d=s+n/2;e.moveTo(r,d),e.bezierCurveTo(r,d-l,u-a,s,u,s),e.bezierCurveTo(u+a,s,h,d-l,h,d),e.bezierCurveTo(h,d+l,u+a,c,u,c),e.bezierCurveTo(u-a,c,r,d+l,r,d),e.closePath()}else if(i.type===pn.RREC){const t=i.x,n=i.y,r=i.width,s=i.height;let o=i.radius;const a=Math.min(r,s)/2;o=o>a?a:o,e.moveTo(t,n+o),e.lineTo(t,n+s-o),e.quadraticCurveTo(t,n+s,t+o,n+s),e.lineTo(t+r-o,n+s),e.quadraticCurveTo(t+r,n+s,t+r,n+s-o),e.lineTo(t+r,n+o),e.quadraticCurveTo(t+r,n,t+r-o,n),e.lineTo(t+o,n),e.quadraticCurveTo(t,n,t,n+o),e.closePath()}}}popMask(t){t.canvasContext.activeContext.restore(),t.canvasContext.invalidateBlendMode()}destroy(){}}Vi.extension={type:Be.CanvasRendererSystem,name:"mask"},je.add(Vi);class Xi{constructor(t){this.renderer=t}render(t,e){const n=this.renderer;if(!n.view)return;const r=n.canvasContext;let i,s,o,a;e&&(i=e.renderTexture,s=e.clear,o=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!i,n.emit("prerender");const l=n.resolution;i?(i=i.castToBaseTexture(),i._canvasRenderTarget||(i._canvasRenderTarget=new Pe(i.width,i.height,i.resolution),i.resource=new Ri(i._canvasRenderTarget.canvas),i.valid=!0),r.activeContext=i._canvasRenderTarget.context,n.canvasContext.activeResolution=i._canvasRenderTarget.resolution):(r.activeContext=r.rootContext,r.activeResolution=l);const h=r.activeContext;if(r._projTransform=o||null,i||(this.lastObjectRendered=t),!a){const e=t.enableTempParent();t.updateTransform(),t.disableTempParent(e)}if(h.save(),h.setTransform(1,0,0,1,0,0),h.globalAlpha=1,r._activeBlendMode=P.NORMAL,r._outerBlend=!1,h.globalCompositeOperation=r.blendModes[P.NORMAL],s??n.background.clearBeforeRender)if(this.renderingToScreen){h.clearRect(0,0,n.width,n.height);const t=n.background;t.alpha>0&&(h.globalAlpha=t.backgroundColor.alpha,h.fillStyle=t.backgroundColor.toHex(),h.fillRect(0,0,n.width,n.height),h.globalAlpha=1)}else i._canvasRenderTarget.clear(),i.clear.alpha>0&&(h.globalAlpha=i.clear.alpha,h.fillStyle=i.clear.toHex(),h.fillRect(0,0,i.realWidth,i.realHeight),h.globalAlpha=1);const c=r.activeContext;r.activeContext=h,t.renderCanvas(n),r.activeContext=c,h.restore(),r.activeResolution=l,r._projTransform=null,n.emit("postrender")}destroy(){this.lastObjectRendered=null,this.render=null}}Xi.extension={type:Be.CanvasRendererSystem,name:"objectRenderer"},je.add(Xi);const{deprecation:Yi}=e,$i=class t extends ui{constructor(e){super(),this.type=k.CANVAS,this.rendererLogId="Canvas",e=Object.assign({},Y.RENDER_OPTIONS,e);const n={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:t.__systems,priority:["textureGenerator","background","_view","_plugin","startup","mask","canvasContext","objectRenderer"]};this.setup(n),"useContextAlpha"in e&&(Yi("7.0.0","options.useContextAlpha is deprecated, use options.backgroundAlpha instead"),e.backgroundAlpha=!1===e.useContextAlpha?1:e.backgroundAlpha),this._plugin.rendererPlugins=t.__plugins,this.options=e,this.startup.run(this.options)}static test(){return!0}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}reset(){}render(t,e){this.objectRenderer.render(t,e)}clear(){this.canvasContext.clear()}destroy(t){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}resize(t,e){this._view.resizeView(t,e)}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get clearBeforeRender(){return this.background.clearBeforeRender}get blendModes(){return Yi("7.0.0","renderer.blendModes has been deprecated, please use renderer.canvasContext.blendModes instead"),this.canvasContext.blendModes}get maskManager(){return Yi("7.0.0","renderer.maskManager has been deprecated, please use renderer.mask instead"),this.mask}get refresh(){return Yi("7.0.0","renderer.refresh has been deprecated"),!0}get rootContext(){return Yi("7.0.0","renderer.rootContext has been deprecated, please use renderer.canvasContext.rootContext instead"),this.canvasContext.rootContext}get context(){return Yi("7.0.0","renderer.context has been deprecated, please use renderer.canvasContext.activeContext instead"),this.canvasContext.activeContext}get smoothProperty(){return Yi("7.0.0","renderer.smoothProperty has been deprecated, please use renderer.canvasContext.smoothProperty instead"),this.canvasContext.smoothProperty}setBlendMode(t,e){Yi("7.0.0","renderer.setBlendMode has been deprecated, use renderer.canvasContext.setBlendMode instead"),this.canvasContext.setBlendMode(t,e)}invalidateBlendMode(){Yi("7.0.0","renderer.invalidateBlendMode has been deprecated, use renderer.canvasContext.invalidateBlendMode instead"),this.canvasContext.invalidateBlendMode()}setContextTransform(t,e,n){Yi("7.0.0","renderer.setContextTransform has been deprecated, use renderer.canvasContext.setContextTransform instead"),this.canvasContext.setContextTransform(t,e,n)}get backgroundColor(){return Yi("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){Yi("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return Yi("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){Yi("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get preserveDrawingBuffer(){return Yi("7.0.0","renderer.preserveDrawingBuffer has been deprecated"),!1}get useContextAlpha(){return Yi("7.0.0","renderer.useContextAlpha has been deprecated"),!1}};$i.extension={type:Be.Renderer,priority:0},$i.__plugins={},$i.__systems={};let qi=$i;je.handleByMap(Be.CanvasRendererPlugin,qi.__plugins),je.handleByMap(Be.CanvasRendererSystem,qi.__systems),je.add(qi);const Ki={canvas:null,getTintedCanvas:(t,e)=>{const n=t.texture,r=ee.shared.setValue(e).toHex();n.tintCache=n.tintCache||{};const i=n.tintCache[r];let s;if(i){if(i.tintId===n._updateID)return n.tintCache[r];s=n.tintCache[r]}else s=Y.ADAPTER.createCanvas();if(Ki.tintMethod(n,e,s),s.tintId=n._updateID,Ki.convertTintToImage&&void 0!==s.toDataURL){const t=new Image;t.src=s.toDataURL(),n.tintCache[r]=t}else n.tintCache[r]=s;return s},getTintedPattern:(t,e)=>{const n=ee.shared.setValue(e).toHex();t.patternCache=t.patternCache||{};let r=t.patternCache[n];return r?.tintId===t._updateID||(Ki.canvas||(Ki.canvas=Y.ADAPTER.createCanvas()),Ki.tintMethod(t,e,Ki.canvas),r=Ki.canvas.getContext("2d").createPattern(Ki.canvas,"repeat"),r.tintId=t._updateID,t.patternCache[n]=r),r},tintWithMultiply:(t,e,n)=>{const r=n.getContext("2d"),i=t._frame.clone(),s=t.baseTexture.resolution;i.x*=s,i.y*=s,i.width*=s,i.height*=s,n.width=Math.ceil(i.width),n.height=Math.ceil(i.height),r.save(),r.fillStyle=ee.shared.setValue(e).toHex(),r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="multiply";const o=t.baseTexture.getDrawableSource();r.drawImage(o,i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.globalCompositeOperation="destination-atop",r.drawImage(o,i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.restore()},tintWithOverlay:(t,e,n)=>{const r=n.getContext("2d"),i=t._frame.clone(),s=t.baseTexture.resolution;i.x*=s,i.y*=s,i.width*=s,i.height*=s,n.width=Math.ceil(i.width),n.height=Math.ceil(i.height),r.save(),r.globalCompositeOperation="copy",r.fillStyle=`#${`00000${(0|e).toString(16)}`.slice(-6)}`,r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="destination-atop",r.drawImage(t.baseTexture.getDrawableSource(),i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.restore()},tintWithPerPixel:(t,e,n)=>{const r=n.getContext("2d"),i=t._frame.clone(),s=t.baseTexture.resolution;i.x*=s,i.y*=s,i.width*=s,i.height*=s,n.width=Math.ceil(i.width),n.height=Math.ceil(i.height),r.save(),r.globalCompositeOperation="copy",r.drawImage(t.baseTexture.getDrawableSource(),i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.restore();const[o,a,l]=ee.shared.setValue(e).toArray(),h=r.getImageData(0,0,i.width,i.height),c=h.data;for(let t=0;t<c.length;t+=4)c[t+0]*=o,c[t+1]*=a,c[t+2]*=l;r.putImageData(h,0,0)},roundColor:t=>(gt("7.3.0","PIXI.canvasUtils.roundColor is deprecated"),ee.shared.setValue(t).round(Ki.cacheStepsPerColorChannel).toNumber()),cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:Hi(),tintMethod:null};Ki.tintMethod=Ki.canUseMultiply?Ki.tintWithMultiply:Ki.tintWithPerPixel;class Zi{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?vn.EMPTY:((t=t||new vn(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:n,b:r,c:i,d:s,tx:o,ty:a}=t,l=n*e.x+i*e.y+o,h=r*e.x+s*e.y+a;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}addQuad(t){let e=this.minX,n=this.minY,r=this.maxX,i=this.maxY,s=t[0],o=t[1];e=s<e?s:e,n=o<n?o:n,r=s>r?s:r,i=o>i?o:i,s=t[2],o=t[3],e=s<e?s:e,n=o<n?o:n,r=s>r?s:r,i=o>i?o:i,s=t[4],o=t[5],e=s<e?s:e,n=o<n?o:n,r=s>r?s:r,i=o>i?o:i,s=t[6],o=t[7],e=s<e?s:e,n=o<n?o:n,r=s>r?s:r,i=o>i?o:i,this.minX=e,this.minY=n,this.maxX=r,this.maxY=i}addFrame(t,e,n,r,i){this.addFrameMatrix(t.worldTransform,e,n,r,i)}addFrameMatrix(t,e,n,r,i){const s=t.a,o=t.b,a=t.c,l=t.d,h=t.tx,c=t.ty;let u=this.minX,d=this.minY,f=this.maxX,p=this.maxY,m=s*e+a*n+h,g=o*e+l*n+c;u=m<u?m:u,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,m=s*r+a*n+h,g=o*r+l*n+c,u=m<u?m:u,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,m=s*e+a*i+h,g=o*e+l*i+c,u=m<u?m:u,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,m=s*r+a*i+h,g=o*r+l*i+c,u=m<u?m:u,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,this.minX=u,this.minY=d,this.maxX=f,this.maxY=p}addVertexData(t,e,n){let r=this.minX,i=this.minY,s=this.maxX,o=this.maxY;for(let a=e;a<n;a+=2){const e=t[a],n=t[a+1];r=e<r?e:r,i=n<i?n:i,s=e>s?e:s,o=n>o?n:o}this.minX=r,this.minY=i,this.maxX=s,this.maxY=o}addVertices(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)}addVerticesMatrix(t,e,n,r,i=0,s=i){const o=t.a,a=t.b,l=t.c,h=t.d,c=t.tx,u=t.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY;for(let t=n;t<r;t+=2){const n=e[t],r=e[t+1],g=o*n+l*r+c,v=h*r+a*n+u;d=Math.min(d,g-i),p=Math.max(p,g+i),f=Math.min(f,v-s),m=Math.max(m,v+s)}this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addBounds(t){const e=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>i?t.maxY:i}addBoundsMask(t,e){const n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=i&&r<=s){const t=this.minX,e=this.minY,o=this.maxX,a=this.maxY;this.minX=n<t?n:t,this.minY=r<e?r:e,this.maxX=i>o?i:o,this.maxY=s>a?s:a}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=i&&r<=s){const t=this.minX,e=this.minY,o=this.maxX,a=this.maxY;this.minX=n<t?n:t,this.minY=r<e?r:e,this.maxX=i>o?i:o,this.maxY=s>a?s:a}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,n,r,i,s){t-=i,e-=s,n+=i,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}class Qi extends dt{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new On,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Zi,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let n=0;n<e.length;++n){const r=e[n];Object.defineProperty(Qi.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new vn),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new vn),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Zi);const e=this.transform,n=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=n?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,i=this._boundsID;this._bounds=this._localBounds;const s=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-i,s}toGlobal(t,e,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,n,r){return e&&(t=e.toGlobal(t,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,e=0,n=1,r=1,i=0,s=0,o=0,a=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Ji),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*dn}set angle(t){this.transform.rotation=t*fn}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,0===t._maskRefCount&&(t.renderable=!0,t.isMask=!1))}if(this._mask=t,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(0===t._maskRefCount&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class Ji extends Qi{constructor(){super(...arguments),this.sortDirty=null}}Qi.prototype.displayObjectUpdateTransform=Qi.prototype.updateTransform;const ts=new bn;function es(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const ns=class t extends Qi{constructor(){super(),this.children=[],this.sortableChildren=t.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const n=this.getChildIndex(t),r=this.getChildIndex(e);this.children[n]=e,this.children[r]=t,this.onChildrenChange(n<r?n:r)}getChildIndex(t){const e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(t);xe(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],n=this.children.indexOf(e);if(-1===n)return null;e.parent=null,e.transform._parentID=-1,xe(this.children,n,1),this._boundsID++,this.onChildrenChange(n),e.emit("removed",this),this.emit("childRemoved",e,this,n)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,xe(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const n=t,r=e-n;let i;if(r>0&&r<=e){i=this.children.splice(n,r);for(let t=0;t<i.length;++t)i[t].parent=null,i[t].transform&&(i[t].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let t=0;t<i.length;++t)i[t].emit("removed",this),this.emit("childRemoved",i[t],this,t);return i}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,n=this.children.length;e<n;++e){const n=this.children[e];n._lastSortedIndex=e,!t&&0!==n.zIndex&&(t=!0)}t&&this.children.length>1&&this.children.sort(es),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const e=this.children[t];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){const t=e._mask.isMaskData?e._mask.maskObject:e._mask;t?(t.calculateBounds(),this._bounds.addBoundsMask(e._bounds,t._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const n=super.getLocalBounds(t);if(!e)for(let t=0,e=this.children.length;t<e;++t){const e=this.children[t];e.visible&&e.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(e){const n=e.renderTexture.sourceFrame;if(!(n.width>0&&n.height>0))return;let r,i;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==t.prototype._render&&(r=this.getBounds(!0));const s=e.projection.transform;if(s&&(i?(i=ts.copyFrom(i),i.prepend(s)):i=s),r&&n.intersects(r,i))this._render(e);else if(this.cullArea)return;for(let t=0,n=this.children.length;t<n;++t){const n=this.children[t],r=n.cullable;n.cullable=r||!this.cullArea,n.render(e),n.cullable=r}}render(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters?.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}}renderAdvanced(t){const e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let t=0;t<e.length;t++)e[t].enabled&&this._enabledFilters.push(e[t])}const r=e&&this._enabledFilters?.length||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==z.NONE));if(r&&t.batch.flush(),e&&this._enabledFilters?.length&&t.filter.push(this,this._enabledFilters),n&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}r&&t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters?.length&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e="boolean"==typeof t?t:t?.children,n=this.removeChildren(0,this.children.length);if(e)for(let e=0;e<n.length;++e)n[e].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}};ns.defaultSortableChildren=!1;let rs=ns;rs.prototype.containerUpdateTransform=rs.prototype.updateTransform,Object.defineProperties(Y,{SORTABLE_CHILDREN:{get(){return rs.defaultSortableChildren},set(t){gt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),rs.defaultSortableChildren=t}}});const is=new mn,ss=new Uint16Array([0,1,2,0,2,3]);class os extends rs{constructor(t){super(),this._anchor=new In(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new ee(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=P.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||vr.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=ss,this.pluginName="batch",this.isSprite=!0,this._roundPixels=Y.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=we(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=we(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty,l=this.vertexData,h=t.trim,c=t.orig,u=this._anchor;let d=0,f=0,p=0,m=0;if(h?(f=h.x-u._x*c.width,d=f+h.width,m=h.y-u._y*c.height,p=m+h.height):(f=-u._x*c.width,d=f+c.width,m=-u._y*c.height,p=m+c.height),l[0]=n*f+i*m+o,l[1]=s*m+r*f+a,l[2]=n*d+i*m+o,l[3]=s*m+r*d+a,l[4]=n*d+i*p+o,l[5]=s*p+r*d+a,l[6]=n*f+i*p+o,l[7]=s*p+r*f+a,this._roundPixels){const t=Y.RESOLUTION;for(let e=0;e<l.length;++e)l[e]=Math.round(l[e]*t)/t}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,n=t.orig,r=this._anchor,i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,l=i.d,h=i.tx,c=i.ty,u=-r._x*n.width,d=u+n.width,f=-r._y*n.height,p=f+n.height;if(e[0]=s*u+a*f+h,e[1]=l*f+o*u+c,e[2]=s*d+a*f+h,e[3]=l*f+o*d+c,e[4]=s*d+a*p+h,e[5]=l*p+o*d+c,e[6]=s*u+a*p+h,e[7]=l*p+o*u+c,this._roundPixels){const t=Y.RESOLUTION;for(let n=0;n<e.length;++n)e[n]=Math.round(e[n]*t)/t}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return 0===this.children.length?(this._localBounds||(this._localBounds=new Zi),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new vn),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,is);const e=this._texture.orig.width,n=this._texture.orig.height,r=-e*this.anchor.x;let i=0;return is.x>=r&&is.x<r+e&&(i=-n*this.anchor.y,is.y>=i&&is.y<i+n)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const n=t instanceof vr?t:vr.from(t,e);return new os(n)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=we(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=we(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||vr.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const as=new mn;class ls extends os{constructor(t,e=100,n=100){super(t),this.tileTransform=new On,this._width=e,this._height=n,this.uvMatrix=this.texture.uvMatrix||new Rr(t),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(t){this.tileTransform.scale.copyFrom(t)}get tilePosition(){return this.tileTransform.position}set tilePosition(t){this.tileTransform.position.copyFrom(t)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(t){const e=this._texture;!e||!e.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))}_calculateBounds(){const t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,r)}getLocalBounds(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new vn),t=this._localBoundsRect),this._bounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,as);const e=this._width,n=this._height,r=-e*this.anchor._x;if(as.x>=r&&as.x<r+e){const t=-n*this.anchor._y;if(as.y>=t&&as.y<t+n)return!0}return!1}destroy(t){super.destroy(t),this.tileTransform=null,this.uvMatrix=null}static from(t,e){const n=t instanceof vr?t:vr.from(t,e);return new ls(n,e.width,e.height)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}}var hs="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";const cs=new bn;class us extends er{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new _r,this.state=Ve.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Qn.from(hs,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?Qn.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):Qn.from(hs,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e)}render(t){const e=this.renderer,n=this.quad;let r=n.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);const i=t.uvRespectAnchor?t.anchor.x:0,s=t.uvRespectAnchor?t.anchor.y:0;r=n.uvs,r[0]=r[6]=-i,r[1]=r[3]=-s,r[2]=r[4]=1-i,r[5]=r[7]=1-s,n.invalidate();const o=t._texture,a=o.baseTexture,l=a.alphaMode>0,h=t.tileTransform.localTransform,c=t.uvMatrix;let u=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;u&&(a._glTextures[e.CONTEXT_UID]?u=a.wrapMode!==N.CLAMP:a.wrapMode===N.CLAMP&&(a.wrapMode=N.REPEAT));const d=u?this.simpleShader:this.shader,f=o.width,p=o.height,m=t._width,g=t._height;cs.set(h.a*f/m,h.b*f/g,h.c*p/m,h.d*p/g,h.tx/m,h.ty/g),cs.invert(),u?cs.prepend(c.mapCoord):(d.uniforms.uMapCoord=c.mapCoord.toArray(!0),d.uniforms.uClampFrame=c.uClampFrame,d.uniforms.uClampOffset=c.uClampOffset),d.uniforms.uTransform=cs.toArray(!0),d.uniforms.uColor=ee.shared.setValue(t.tint).premultiply(t.worldAlpha,l).toArray(d.uniforms.uColor),d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=o,e.shader.bind(d),e.geometry.bind(n),this.state.blendMode=ae(t.blendMode,l),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}us.extension={name:"tilingSprite",type:Be.RendererPlugin},je.add(us);const ds=new bn,fs=new bn,ps=[new mn,new mn,new mn,new mn];ls.prototype._renderCanvas=function(t){const e=this._texture;if(!e.baseTexture.valid)return;const n=t.canvasContext.activeContext,r=this.worldTransform,i=e.baseTexture,s=i.getDrawableSource(),o=i.resolution;if(this._textureID!==this._texture._updateID||this._cachedTint!==this.tintValue){this._textureID=this._texture._updateID;const t=new Pe(e._frame.width,e._frame.height,o);16777215!==this.tintValue?(this._tintedCanvas=Ki.getTintedCanvas(this,this.tintValue),t.context.drawImage(this._tintedCanvas,0,0)):t.context.drawImage(s,-e._frame.x*o,-e._frame.y*o),this._cachedTint=this.tintValue,this._canvasPattern=t.context.createPattern(t.canvas,"repeat")}n.globalAlpha=this.worldAlpha,t.canvasContext.setBlendMode(this.blendMode),this.tileTransform.updateLocalTransform();const a=this.tileTransform.localTransform,l=this._width,h=this._height;ds.identity(),fs.copyFrom(a),this.uvRespectAnchor||fs.translate(-this.anchor.x*l,-this.anchor.y*h),fs.scale(1/o,1/o),ds.prepend(fs),ds.prepend(r),t.canvasContext.setContextTransform(ds),n.fillStyle=this._canvasPattern;const c=this.anchor.x*-l,u=this.anchor.y*-h;ps[0].set(c,u),ps[1].set(c+l,u),ps[2].set(c+l,u+h),ps[3].set(c,u+h);for(let t=0;t<4;t++)fs.applyInverse(ps[t],ps[t]);n.beginPath(),n.moveTo(ps[0].x,ps[0].y);for(let t=1;t<4;t++)n.lineTo(ps[t].x,ps[t].y);n.closePath(),n.fill()};class ms extends rs{constructor(t=1500,e,n=16384,r=!1){super(),n>16384&&(n=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=n,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=P.NORMAL,this.autoResize=r,this.roundPixels=!0,this.baseTexture=null,this.setProperties(e),this._tintColor=new ee(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintColor.toRgbArray(this.tintRgb)}render(t){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(()=>this.onChildrenChange(0)))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}onChildrenChange(t){const e=Math.floor(t/this._batchSize);for(;this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID}dispose(){if(this._buffers){for(let t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}destroy(t){super.destroy(t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class gs{constructor(t,e,n){this.geometry=new hn,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<t.length;++n){let r=t[n];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||L.FLOAT,offset:r.offset},e[n]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new nn(de(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let t=0;t<this.dynamicProperties.length;++t){const n=this.dynamicProperties[t];n.offset=e,e+=n.size,this.dynamicStride+=n.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new nn(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let t=0;t<this.staticProperties.length;++t){const e=this.staticProperties[t];e.offset=r,r+=e.size,this.staticStride+=e.size}const i=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(i),this.staticDataUint32=new Uint32Array(i),this.staticBuffer=new nn(this.staticData,!0,!1);for(let e=0;e<this.dynamicProperties.length;++e){const n=this.dynamicProperties[e];t.addAttribute(n.attributeName,this.dynamicBuffer,0,n.type===L.UNSIGNED_BYTE,n.type,4*this.dynamicStride,4*n.offset)}for(let e=0;e<this.staticProperties.length;++e){const n=this.staticProperties[e];t.addAttribute(n.attributeName,this.staticBuffer,0,n.type===L.UNSIGNED_BYTE,n.type,4*this.staticStride,4*n.offset)}}uploadDynamic(t,e,n){for(let r=0;r<this.dynamicProperties.length;r++){const i=this.dynamicProperties[r];i.uploadFunction(t,e,n,i.type===L.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,n){for(let r=0;r<this.staticProperties.length;r++){const i=this.staticProperties[r];i.uploadFunction(t,e,n,i.type===L.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}class vs extends er{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new bn,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:L.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Qn.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=Ve.for2d()}render(t){const e=t.children,n=t._maxSize,r=t._batchSize,i=this.renderer;let s=e.length;if(0===s)return;s>n&&!t.autoResize&&(s=n);let o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));const a=e[0]._texture.baseTexture,l=a.alphaMode>0;this.state.blendMode=ae(t.blendMode,l),i.state.set(this.state);const h=i.gl,c=t.worldTransform.copyTo(this.tempMatrix);c.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=ee.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);let u=!1;for(let n=0,a=0;n<s;n+=r,a+=1){let l=s-n;l>r&&(l=r),a>=o.length&&o.push(this._generateOneMoreBuffer(t));const c=o[a];c.uploadDynamic(e,n,l);const d=t._bufferUpdateIDs[a]||0;u=u||c._updateID<d,u&&(c._updateID=t._updateID,c.uploadStatic(e,n,l)),i.geometry.bind(c.geometry),h.drawElements(h.TRIANGLES,6*l,h.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],n=t._maxSize,r=t._batchSize,i=t._properties;for(let t=0;t<n;t+=r)e.push(new gs(this.properties,i,r));return e}_generateOneMoreBuffer(t){const e=t._batchSize,n=t._properties;return new gs(this.properties,n,e)}uploadVertices(t,e,n,r,i,s){let o=0,a=0,l=0,h=0;for(let c=0;c<n;++c){const n=t[e+c],u=n._texture,d=n.scale.x,f=n.scale.y,p=u.trim,m=u.orig;p?(a=p.x-n.anchor.x*m.width,o=a+p.width,h=p.y-n.anchor.y*m.height,l=h+p.height):(o=m.width*(1-n.anchor.x),a=m.width*-n.anchor.x,l=m.height*(1-n.anchor.y),h=m.height*-n.anchor.y),r[s]=a*d,r[s+1]=h*f,r[s+i]=o*d,r[s+i+1]=h*f,r[s+2*i]=o*d,r[s+2*i+1]=l*f,r[s+3*i]=a*d,r[s+3*i+1]=l*f,s+=4*i}}uploadPosition(t,e,n,r,i,s){for(let o=0;o<n;o++){const n=t[e+o].position;r[s]=n.x,r[s+1]=n.y,r[s+i]=n.x,r[s+i+1]=n.y,r[s+2*i]=n.x,r[s+2*i+1]=n.y,r[s+3*i]=n.x,r[s+3*i+1]=n.y,s+=4*i}}uploadRotation(t,e,n,r,i,s){for(let o=0;o<n;o++){const n=t[e+o].rotation;r[s]=n,r[s+i]=n,r[s+2*i]=n,r[s+3*i]=n,s+=4*i}}uploadUvs(t,e,n,r,i,s){for(let o=0;o<n;++o){const n=t[e+o]._texture._uvs;n?(r[s]=n.x0,r[s+1]=n.y0,r[s+i]=n.x1,r[s+i+1]=n.y1,r[s+2*i]=n.x2,r[s+2*i+1]=n.y2,r[s+3*i]=n.x3,r[s+3*i+1]=n.y3,s+=4*i):(r[s]=0,r[s+1]=0,r[s+i]=0,r[s+i+1]=0,r[s+2*i]=0,r[s+2*i+1]=0,r[s+3*i]=0,r[s+3*i+1]=0,s+=4*i)}}uploadTint(t,e,n,r,i,s){for(let o=0;o<n;++o){const n=t[e+o],a=ee.shared.setValue(n._tintRGB).toPremultiplied(n.alpha,n.texture.baseTexture.alphaMode>0);r[s]=a,r[s+i]=a,r[s+2*i]=a,r[s+3*i]=a,s+=4*i}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}vs.extension={name:"particle",type:Be.RendererPlugin},je.add(vs),ms.prototype.renderCanvas=function(t){if(!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable)return;const e=t.canvasContext.activeContext,n=this.worldTransform;let r=!0,i=0,s=0,o=0,a=0;t.canvasContext.setBlendMode(this.blendMode),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(let l=0;l<this.children.length;++l){const h=this.children[l];if(!h.visible||!h._texture.valid)continue;const c=h._texture.frame;if(e.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)r&&(t.canvasContext.setContextTransform(n,!1,1),r=!1),i=h.anchor.x*(-c.width*h.scale.x)+h.position.x+.5,s=h.anchor.y*(-c.height*h.scale.y)+h.position.y+.5,o=c.width*h.scale.x,a=c.height*h.scale.y;else{r||(r=!0),h.displayObjectUpdateTransform();const e=h.worldTransform;t.canvasContext.setContextTransform(e,this.roundPixels,1),i=h.anchor.x*-c.width+.5,s=h.anchor.y*-c.height+.5,o=c.width,a=c.height}const u=h._texture.baseTexture.resolution,d=t.canvasContext.activeResolution;e.drawImage(h._texture.baseTexture.getDrawableSource(),c.x*u,c.y*u,c.width*u,c.height*u,i*d,s*d,o*d,a*d)}},rs.prototype._renderCanvas=function(t){},rs.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.mask.pushMask(this._mask),this._renderCanvas(t);for(let e=0,n=this.children.length;e<n;++e)this.children[e].renderCanvas(t);this._mask&&t.mask.popMask(t)}},Qi.prototype.renderCanvas=function(t){};var ys=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(ys||{});const xs={willReadFrequently:!0},ws=class t{static get experimentalLetterSpacingSupported(){let e=t._experimentalLetterSpacingSupported;if(void 0!==e){const n=Y.ADAPTER.getCanvasRenderingContext2D().prototype;e=t._experimentalLetterSpacingSupported="letterSpacing"in n||"textLetterSpacing"in n}return e}constructor(t,e,n,r,i,s,o,a,l){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=i,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=l}static measureText(e,n,r,i=t._canvas){r=r??n.wordWrap;const s=n.toFontString(),o=t.measureFont(s);0===o.fontSize&&(o.fontSize=n.fontSize,o.ascent=n.fontSize);const a=i.getContext("2d",xs);a.font=s;const l=(r?t.wordWrap(e,n,i):e).split(/(?:\r\n|\r|\n)/),h=new Array(l.length);let c=0;for(let e=0;e<l.length;e++){const r=t._measureText(l[e],n.letterSpacing,a);h[e]=r,c=Math.max(c,r)}let u=c+n.strokeThickness;n.dropShadow&&(u+=n.dropShadowDistance);const d=n.lineHeight||o.fontSize+n.strokeThickness;let f=Math.max(d,o.fontSize+2*n.strokeThickness)+n.leading+(l.length-1)*(d+n.leading);return n.dropShadow&&(f+=n.dropShadowDistance),new t(e,n,u,f,l,h,d+n.leading,c,o)}static _measureText(e,n,r){let i=!1;t.experimentalLetterSpacingSupported&&(t.experimentalLetterSpacing?(r.letterSpacing=`${n}px`,r.textLetterSpacing=`${n}px`,i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let s=r.measureText(e).width;return s>0&&(i?s-=n:s+=(t.graphemeSegmenter(e).length-1)*n),s}static wordWrap(e,n,r=t._canvas){const i=r.getContext("2d",xs);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:h,whiteSpace:c}=n,u=t.collapseSpaces(c),d=t.collapseNewlines(c);let f=!u;const p=n.wordWrapWidth+h,m=t.tokenize(e);for(let e=0;e<m.length;e++){let r=m[e];if(t.isNewline(r)){if(!d){a+=t.addLine(o),f=!u,o="",s=0;continue}r=" "}if(u){const e=t.isBreakingSpace(r),n=t.isBreakingSpace(o[o.length-1]);if(e&&n)continue}const c=t.getFromCache(r,h,l,i);if(c>p)if(""!==o&&(a+=t.addLine(o),o="",s=0),t.canBreakWords(r,n.breakWords)){const e=t.wordWrapSplit(r);for(let c=0;c<e.length;c++){let u=e[c],d=u,m=1;for(;e[c+m];){const i=e[c+m];if(t.canBreakChars(d,i,r,c,n.breakWords))break;u+=i,d=i,m++}c+=m-1;const g=t.getFromCache(u,h,l,i);g+s>p&&(a+=t.addLine(o),f=!1,o="",s=0),o+=u,s+=g}}else{o.length>0&&(a+=t.addLine(o),o="",s=0);const n=e===m.length-1;a+=t.addLine(r,!n),f=!1,o="",s=0}else c+s>p&&(f=!1,a+=t.addLine(o),o="",s=0),(o.length>0||!t.isBreakingSpace(r)||f)&&(o+=r,s+=c)}return a+=t.addLine(o,!1),a}static addLine(e,n=!0){return e=t.trimRight(e),n?`${e}\n`:e}static getFromCache(e,n,r,i){let s=r[e];return"number"!=typeof s&&(s=t._measureText(e,n,i)+n,r[e]=s),s}static collapseSpaces(t){return"normal"===t||"pre-line"===t}static collapseNewlines(t){return"normal"===t}static trimRight(e){if("string"!=typeof e)return"";for(let n=e.length-1;n>=0;n--){const r=e[n];if(!t.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static isNewline(e){return"string"==typeof e&&t._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,n){return"string"==typeof e&&t._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const n=[];let r="";if("string"!=typeof e)return n;for(let i=0;i<e.length;i++){const s=e[i],o=e[i+1];t.isBreakingSpace(s,o)||t.isNewline(s)?(""!==r&&(n.push(r),r=""),n.push(s)):r+=s}return""!==r&&n.push(r),n}static canBreakWords(t,e){return e}static canBreakChars(t,e,n,r,i){return!0}static wordWrapSplit(e){return t.graphemeSegmenter(e)}static measureFont(e){if(t._fonts[e])return t._fonts[e];const n={ascent:0,descent:0,fontSize:0},r=t._canvas,i=t._context;i.font=e;const s=t.METRICS_STRING+t.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width);let a=Math.ceil(i.measureText(t.BASELINE_SYMBOL).width);const l=Math.ceil(t.HEIGHT_MULTIPLIER*a);if(a=a*t.BASELINE_MULTIPLIER|0,0===o||0===l)return t._fonts[e]=n,n;r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);const h=i.getImageData(0,0,o,l).data,c=h.length,u=4*o;let d=0,f=0,p=!1;for(d=0;d<a;++d){for(let t=0;t<u;t+=4)if(255!==h[f+t]){p=!0;break}if(p)break;f+=u}for(n.ascent=a-d,f=c-u,p=!1,d=l;d>a;--d){for(let t=0;t<u;t+=4)if(255!==h[f+t]){p=!0;break}if(p)break;f-=u}return n.descent=d-a,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n}static clearMetrics(e=""){e?delete t._fonts[e]:t._fonts={}}static get _canvas(){if(!t.__canvas){let e;try{const n=new OffscreenCanvas(0,0);if(n.getContext("2d",xs)?.measureText)return t.__canvas=n,n;e=Y.ADAPTER.createCanvas()}catch{e=Y.ADAPTER.createCanvas()}e.width=e.height=10,t.__canvas=e}return t.__canvas}static get _context(){return t.__context||(t.__context=t._canvas.getContext("2d",xs)),t.__context}};ws.METRICS_STRING="|ÉqÅ",ws.BASELINE_SYMBOL="M",ws.BASELINE_MULTIPLIER=1.4,ws.HEIGHT_MULTIPLIER=2,ws.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map((t=>t.segment))}return t=>[...t]})(),ws.experimentalLetterSpacing=!1,ws._fonts={},ws._newlines=[10,13],ws._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let _s=ws;const bs=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Ts=class t{constructor(t){this.styleID=0,this.reset(),Es(this,t,t)}clone(){const e={};return Es(e,this,t.defaultStyle),new t(e)}reset(){Es(this,t.defaultStyle,t.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=As(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=As(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=As(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let t=e.length-1;t>=0;t--){let n=e[t].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!bs.includes(n)&&(n=`"${n}"`),e[t]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};Ts.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:ys.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ss=Ts;function As(t){const e=ee.shared,n=t=>{const n=e.setValue(t);return 1===n.alpha?n.toHex():n.toRgbaString()};return Array.isArray(t)?t.map(n):n(t)}function Es(t,e,n){for(const r in n)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}const Cs={texture:!0,children:!1,baseTexture:!0},ks=class t extends os{constructor(e,n,r){let i=!1;r||(r=Y.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;const s=vr.from(r);s.orig=new vn,s.trim=new vn,super(s),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=t.defaultResolution??Y.RESOLUTION,this._autoResolution=t.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=n,this.localStyleID=-1}static get experimentalLetterSpacing(){return _s.experimentalLetterSpacing}static set experimentalLetterSpacing(t){gt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),_s.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const n=this.context,r=_s.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=r.width,s=r.height,o=r.lines,a=r.lineHeight,l=r.lineWidths,h=r.maxLineWidth,c=r.fontProperties;let u,d;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,s)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;const f=e.dropShadow?2:1;for(let t=0;t<f;++t){const i=e.dropShadow&&0===t,f=i?Math.ceil(Math.max(1,s)+2*e.padding):0,p=f*this._resolution;if(i){n.fillStyle="black",n.strokeStyle="black";const t=e.dropShadowColor,r=e.dropShadowBlur*this._resolution,i=e.dropShadowDistance*this._resolution;n.shadowColor=ee.shared.setValue(t).setAlpha(e.dropShadowAlpha).toRgbaString(),n.shadowBlur=r,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*i,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*i+p}else n.fillStyle=this._generateFillStyle(e,o,r),n.strokeStyle=e.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let m=(a-c.fontSize)/2;a-c.fontSize<0&&(m=0);for(let t=0;t<o.length;t++)u=e.strokeThickness/2,d=e.strokeThickness/2+t*a+c.ascent+m,"right"===e.align?u+=h-l[t]:"center"===e.align&&(u+=(h-l[t])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(o[t],u+e.padding,d+e.padding-f,!0),e.fill&&this.drawLetterSpacing(o[t],u+e.padding,d+e.padding-f)}this.updateTexture()}drawLetterSpacing(t,e,n,r=!1){const i=this._style.letterSpacing;let s=!1;if(_s.experimentalLetterSpacingSupported&&(_s.experimentalLetterSpacing?(this.context.letterSpacing=`${i}px`,this.context.textLetterSpacing=`${i}px`,s=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===i||s)return void(r?this.context.strokeText(t,e,n):this.context.fillText(t,e,n));let o=e;const a=_s.graphemeSegmenter(t);let l=this.context.measureText(t).width,h=0;for(let t=0;t<a.length;++t){const e=a[t];r?this.context.strokeText(e,o,n):this.context.fillText(e,o,n);let s="";for(let e=t+1;e<a.length;++e)s+=a[e];h=this.context.measureText(s).width,o+=l-h+i,l=h}}updateTexture(){const t=this.canvas;if(this._style.trim){const e=Le(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}const e=this._texture,n=this._style,r=n.trim?0:n.padding,i=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-r,e.trim.y=-r,e.orig.width=e._frame.width-2*r,e.orig.height=e._frame.height-2*r,this._onTextureUpdate(),i.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),-1===this._textureID&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,n){const r=t.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];let i;const s=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,a=this.canvas.width/this._resolution-s-2*o,l=this.canvas.height/this._resolution-s-2*o,h=r.slice(),c=t.fillGradientStops.slice();if(!c.length){const t=h.length+1;for(let e=1;e<t;++e)c.push(e/t)}if(h.unshift(r[0]),c.unshift(0),h.push(r[r.length-1]),c.push(1),t.fillGradientType===ys.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,o,a/2,l+o);const r=n.fontProperties.fontSize+t.strokeThickness;for(let t=0;t<e.length;t++){const s=n.lineHeight*(t-1)+r,o=n.lineHeight*t;let a=o;t>0&&s>o&&(a=(o+s)/2);const u=o+r,d=n.lineHeight*(t+1);let f=u;t+1<e.length&&d<u&&(f=(u+d)/2);const p=(f-a)/l;for(let t=0;t<h.length;t++){let e=0;e="number"==typeof c[t]?c[t]:t/h.length;let n=Math.min(1,Math.max(0,a/l+e*p));n=Number(n.toFixed(5)),i.addColorStop(n,h[t])}}}else{i=this.context.createLinearGradient(o,l/2,a+o,l/2);const t=h.length+1;let e=1;for(let n=0;n<h.length;n++){let r;r="number"==typeof c[n]?c[n]:e/t,i.addColorStop(r,h[n]),e++}}return i}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},Cs,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=we(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=we(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},this._style=t instanceof Ss?t:new Ss(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};ks.defaultAutoResolution=!0;let Ms=ks;Ms.prototype._renderCanvas=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),os.prototype._renderCanvas.call(this,t)};const Ps=new bn;Qi.prototype._cacheAsBitmap=!1,Qi.prototype._cacheData=null,Qi.prototype._cacheAsBitmapResolution=null,Qi.prototype._cacheAsBitmapMultisample=null;class Is{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Qi.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;let e;this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Is),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}),Qi.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},Qi.prototype._initCachedDisplayObject=function(t){if(this._cacheData?.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const n=this.getLocalBounds(new vn,!0);if(this.filters?.length){const t=this.filters[0].padding;n.pad(t)}const r=this.cacheAsBitmapResolution||t.resolution;n.ceil(r),n.width=Math.max(n.width,1/r),n.height=Math.max(n.height,1/r);const i=t.renderTexture.current,s=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,l=yr.create({width:n.width,height:n.height,resolution:r,multisample:this.cacheAsBitmapMultisample??t.multisample}),h=`cacheAsBitmap_${be()}`;this._cacheData.textureCacheId=h,Je.addToCache(l.baseTexture,h),vr.addToCache(l,h);const c=this.transform.localTransform.copyTo(Ps).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const u=new os(l);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-n.x/n.width,u.anchor.y=-n.y/n.height,u.alpha=e,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)},Qi.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},Qi.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cacheData?.sprite)return;const e=this.getLocalBounds(new vn,!0),n=this.alpha;this.alpha=1;const r=t.canvasContext.activeContext,i=t._projTransform,s=this.cacheAsBitmapResolution||t.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=yr.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${be()}`;this._cacheData.textureCacheId=a,Je.addToCache(o.baseTexture,a),vr.addToCache(o,a);const l=Ps;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=r,t._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const h=new os(o);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=n,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)},Qi.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Qi.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Qi.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Je.removeFromCache(this._cacheData.textureCacheId),vr.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Qi.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},Qi.prototype.name=null,rs.prototype.getChildByName=function(t,e){for(let e=0,n=this.children.length;e<n;e++)if(this.children[e].name===t)return this.children[e];if(e)for(let e=0,n=this.children.length;e<n;e++){const n=this.children[e];if(!n.getChildByName)continue;const r=n.getChildByName(t,!0);if(r)return r}return null},Qi.prototype.getGlobalPosition=function(t=new mn,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};const Rs={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Os=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");class Ls extends sr{constructor(t,e=8,n=4,r=sr.defaultResolution,i=5){const s=function(t,e){const n=Math.ceil(t/2);let r,i="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";r=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let e=0;e<t;e++){let t=r.replace("%index%",e.toString());t=t.replace("%sampleIndex%",e-(n-1)+".0"),s+=t,s+="\n"}return i=i.replace("%blur%",s),i=i.replace("%size%",t.toString()),i}(i,t),o=function(t){const e=Rs[t],n=e.length;let r,i=Os,s="";for(let i=0;i<t;i++){let o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",i.toString());r=i,i>=n&&(r=t-i-1),o=o.replace("%value%",e[r].toString()),s+=o,s+="\n"}return i=i.replace("%blur%",s),i=i.replace("%size%",t.toString()),i}(i);super(s,o),this.horizontal=t,this.resolution=r,this._quality=0,this.quality=n,this.blur=e}apply(t,e,n,r){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,r);else{const i=t.getFilterTexture(),s=t.renderer;let o=e,a=i;this.state.blend=!1,t.applyFilter(this,o,a,U.CLEAR);for(let e=1;e<this.passes-1;e++){t.bindAndClear(o,U.BLIT),this.uniforms.uSampler=a;const e=a;a=o,o=e,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,a,n,r),t.returnFilterTexture(i)}}get blur(){return this.strength}set blur(t){this.padding=1+2*Math.abs(t),this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class Ds extends sr{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Si,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",t),this.alpha=1}_loadMatrix(t,e=!1){let n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}tint(t,e){const[n,r,i]=ee.shared.setValue(t).toArray(),s=[n,0,0,0,0,0,r,0,0,0,0,0,i,0,0,0,0,0,1,0];this._loadMatrix(s,e)}greyscale(t,e){const n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}blackAndWhite(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)}hue(t,e){t=(t||0)/180*Math.PI;const n=Math.cos(t),r=Math.sin(t),i=1/3,s=(0,Math.sqrt)(i),o=[n+(1-n)*i,i*(1-n)-s*r,i*(1-n)+s*r,0,0,i*(1-n)+s*r,n+i*(1-n),i*(1-n)-s*r,0,0,i*(1-n)-s*r,i*(1-n)+s*r,n+i*(1-n),0,0,0,0,0,1,0];this._loadMatrix(o,e)}contrast(t,e){const n=(t||0)+1,r=-.5*(n-1),i=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(i,e)}saturate(t=0,e){const n=2*t/3+1,r=-.5*(n-1),i=[n,r,r,0,0,r,n,r,0,0,r,r,n,0,0,0,0,0,1,0];this._loadMatrix(i,e)}desaturate(){this.saturate(-1)}negative(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)}sepia(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)}technicolor(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)}polaroid(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)}toBGR(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)}kodachrome(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)}browni(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)}vintage(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)}colorTone(t,e,n,r,i){t=t||.2,e=e||.15,n=n||16770432,r=r||3375104;const s=ee.shared,[o,a,l]=s.setValue(n).toArray(),[h,c,u]=s.setValue(r).toArray(),d=[.3,.59,.11,0,0,o,a,l,t,0,h,c,u,e,0,o-h,a-c,l-u,0,0];this._loadMatrix(d,i)}night(t,e){const n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}predator(t,e){const n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)}lsd(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Ds.prototype.grayscale=Ds.prototype.greyscale;const Fs={AlphaFilter:class extends sr{constructor(t=1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}},BlurFilter:class extends sr{constructor(t=8,e=4,n=sr.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Ls(!0,t,e,n,r),this.blurYFilter=new Ls(!1,t,e,n,r),this.resolution=n,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,n,r){const i=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(i&&s){const i=t.getFilterTexture();this.blurXFilter.apply(t,e,i,U.CLEAR),this.blurYFilter.apply(t,i,n,r),t.returnFilterTexture(i)}else s?this.blurYFilter.apply(t,e,n,r):this.blurXFilter.apply(t,e,n,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}},BlurFilterPass:Ls,ColorMatrixFilter:Ds,DisplacementFilter:class extends sr{constructor(t,e){const n=new bn;t.renderable=!1,super("attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:t._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=n,null==e&&(e=20),this.scale=new mn(e,e)}apply(t,e,n,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const i=this.maskSprite.worldTransform,s=Math.sqrt(i.a*i.a+i.b*i.b),o=Math.sqrt(i.c*i.c+i.d*i.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=i.a/s,this.uniforms.rotation[1]=i.b/s,this.uniforms.rotation[2]=i.c/o,this.uniforms.rotation[3]=i.d/o),t.applyFilter(this,e,n,r)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}},FXAAFilter:class extends sr{constructor(){super("\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}},NoiseFilter:class extends sr{constructor(t=.5,e=Math.random()){super(Si,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}};Object.entries(Fs).forEach((([t,e])=>{Object.defineProperty(Fs,t,{get(){return gt("7.1.0",`filters.${t} has moved to ${t}`),e}})}));const Ns=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(_i.system.add(this.tickerUpdate,this,yi.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(_i.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===t.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}};class Bs{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Bs.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new mn,this.page=new mn,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,n,r,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Ws extends Bs{constructor(){super(...arguments),this.client=new mn,this.movement=new mn,this.offset=new mn,this.global=new mn,this.screen=new mn}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,n,r,i,s,o,a,l,h,c,u,d,f,p){throw new Error("Method not implemented.")}}class Us extends Ws{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class js extends Ws{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}js.DOM_DELTA_PIXEL=0,js.DOM_DELTA_LINE=1,js.DOM_DELTA_PAGE=2;const Hs=new mn,zs=new mn;class Gs{constructor(t){this.dispatch=new dt,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(((t,e)=>t.priority-e.priority))}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){Ns.pauseUpdate=!0;const n=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,Hs.set(t,e),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,e){if(!t.target)return;const n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,i=n.length-1;r<i;r++)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let r=n.length-2;r>=0;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,n=this._allInteractiveElements){if(0===n.length)return;t.eventPhase=t.BUBBLING_PHASE;const r=Array.isArray(e)?e:[e];for(let e=n.length-1;e>=0;e--)r.forEach((r=>{t.currentTarget=n[e],this.notifyTarget(t,r)}))}propagationPath(t){const e=[t];for(let n=0;n<2048&&t!==this.rootTarget;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,n,r,i,s=!1){let o=!1;if(this._interactivePrune(t))return null;if(("dynamic"===t.eventMode||"dynamic"===e)&&(Ns.pauseUpdate=!1),t.interactiveChildren&&t.children){const a=t.children;for(let l=a.length-1;l>=0;l--){const h=a[l],c=this.hitTestMoveRecursive(h,this._isInteractive(e)?e:h.eventMode,n,r,i,s||i(t,n));if(c){if(c.length>0&&!c[c.length-1].parent)continue;const e=t.isInteractive();(c.length>0||e)&&(e&&this._allInteractiveElements.push(t),c.push(t)),0===this._hitElements.length&&(this._hitElements=c),o=!0}}}const a=this._isInteractive(e),l=t.isInteractive();return a&&l&&this._allInteractiveElements.push(t),s||this._hitElements.length>0?null:o?this._hitElements:a&&!i(t,n)&&r(t,n)?l?[t]:[]:null}hitTestRecursive(t,e,n,r,i){if(this._interactivePrune(t)||i(t,n))return null;if(("dynamic"===t.eventMode||"dynamic"===e)&&(Ns.pauseUpdate=!1),t.interactiveChildren&&t.children){const s=t.children;for(let o=s.length-1;o>=0;o--){const a=s[o],l=this.hitTestRecursive(a,this._isInteractive(e)?e:a.eventMode,n,r,i);if(l){if(l.length>0&&!l[l.length-1].parent)continue;const e=t.isInteractive();return(l.length>0||e)&&l.push(t),l}}}const s=this._isInteractive(e),o=t.isInteractive();return s&&r(t,n)?o?[t]:[]:null}_isInteractive(t){return"static"===t||"dynamic"===t}_interactivePrune(t){return!(t&&!t.isMask&&t.visible&&t.renderable&&"none"!==t.eventMode&&("passive"!==t.eventMode||t.interactiveChildren)&&!t.isMask)}hitPruneFn(t,e){if(t.hitArea&&(t.worldTransform.applyInverse(e,zs),!t.hitArea.contains(zs.x,zs.y)))return!0;if(t._mask){const n=t._mask.isMaskData?t._mask.maskObject:t._mask;if(n&&!n.containsPoint?.(e))return!0}return!1}hitTestFn(t,e){return"passive"!==t.eventMode&&(!!t.hitArea||!!t.containsPoint&&t.containsPoint(e))}notifyTarget(t,e){const n=`on${e=e??t.type}`;t.currentTarget[n]?.(t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof Us))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)this.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){const t=2===e.button;this.dispatchEvent(e,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){if(!(t instanceof Us))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const n="mouse"===e.pointerType||"pen"===e.pointerType,r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.overTargets);if(r.overTargets?.length>0&&i!==e.target){const r="mousemove"===t.type?"mouseout":"pointerout",s=this.createPointerEvent(t,r,i);if(this.dispatchEvent(s,"pointerout"),n&&this.dispatchEvent(s,"mouseout"),!e.composedPath().includes(i)){const r=this.createPointerEvent(t,"pointerleave",i);for(r.eventPhase=r.AT_TARGET;r.target&&!e.composedPath().includes(r.target);)r.currentTarget=r.target,this.notifyTarget(r),n&&this.notifyTarget(r,"mouseleave"),r.target=r.target.parent;this.freeEvent(r)}this.freeEvent(s)}if(i!==e.target){const r="mousemove"===t.type?"mouseover":"pointerover",s=this.clonePointerEvent(e,r);this.dispatchEvent(s,"pointerover"),n&&this.dispatchEvent(s,"mouseover");let o=i?.parent;for(;o&&o!==this.rootTarget.parent&&o!==e.target;)o=o.parent;if(!o||o===this.rootTarget.parent){const t=this.clonePointerEvent(e,"pointerenter");for(t.eventPhase=t.AT_TARGET;t.target&&t.target!==i&&t.target!==this.rootTarget.parent;)t.currentTarget=t.target,this.notifyTarget(t),n&&this.notifyTarget(t,"mouseenter"),t.target=t.target.parent;this.freeEvent(t)}this.freeEvent(s)}const s=[],o=this.enableGlobalMoveEvents??!0;this.moveOnAll?s.push("pointermove"):this.dispatchEvent(e,"pointermove"),o&&s.push("globalpointermove"),"touch"===e.pointerType&&(this.moveOnAll?s.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),o&&s.push("globaltouchmove")),n&&(this.moveOnAll?s.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),o&&s.push("globalmousemove"),this.cursor=e.target?.cursor),s.length>0&&this.all(e,s),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){if(!(t instanceof Us))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId),n=this.createPointerEvent(t),r="mouse"===n.pointerType||"pen"===n.pointerType;this.dispatchEvent(n,"pointerover"),r&&this.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(this.cursor=n.target?.cursor);const i=this.clonePointerEvent(n,"pointerenter");for(i.eventPhase=i.AT_TARGET;i.target&&i.target!==this.rootTarget.parent;)i.currentTarget=i.target,this.notifyTarget(i),r&&this.notifyTarget(i,"mouseenter"),i.target=i.target.parent;e.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(i)}mapPointerOut(t){if(!(t instanceof Us))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId);if(e.overTargets){const n="mouse"===t.pointerType||"pen"===t.pointerType,r=this.findMountedTarget(e.overTargets),i=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(i),n&&this.dispatchEvent(i,"mouseout");const s=this.createPointerEvent(t,"pointerleave",r);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;e.overTargets=null,this.freeEvent(i),this.freeEvent(s)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Us))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=performance.now(),n=this.createPointerEvent(t);if(this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)this.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){const t=2===n.button;this.dispatchEvent(n,t?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]);let s=i;if(i&&!n.composedPath().includes(i)){let e=i;for(;e&&!n.composedPath().includes(e);){if(n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)this.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){const t=2===n.button;this.notifyTarget(n,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete r.pressTargetsByButton[t.button],s=e}if(s){const i=this.clonePointerEvent(n,"click");i.target=s,i.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:i.target,timeStamp:e});const o=r.clicksByButton[t.button];if(o.target===i.target&&e-o.timeStamp<200?++o.clickCount:o.clickCount=1,o.target=i.target,o.timeStamp=e,i.detail=o.clickCount,"mouse"===i.pointerType){const t=2===i.button;this.dispatchEvent(i,t?"rightclick":"click")}else"touch"===i.pointerType&&this.dispatchEvent(i,"tap");this.dispatchEvent(i,"pointertap"),this.freeEvent(i)}this.freeEvent(n)}mapPointerUpOutside(t){if(!(t instanceof Us))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(n){let i=n;for(;i;)r.currentTarget=i,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType?this.notifyTarget(r,"touchendoutside"):("mouse"===r.pointerType||"pen"===r.pointerType)&&this.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),i=i.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof js))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let n=1;n<t.length&&t[n].parent===e;n++)e=t[n];return e}createPointerEvent(t,e,n){const r=this.allocateEvent(Us);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=n??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],"string"==typeof e&&(r.type=e),r}createWheelEvent(t){const e=this.allocateEvent(js);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const n=this.allocateEvent(Us);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=e??n.type,n}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof Us&&e instanceof Us&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Ws&&e instanceof Ws&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const n=t.currentTarget._events[e];if(n&&t.currentTarget.isInteractive())if("fn"in n)n.once&&t.currentTarget.removeListener(e,n.fn,void 0,!0),n.fn.call(n.context,t);else for(let r=0,i=n.length;r<i&&!t.propagationImmediatelyStopped;r++)n[r].once&&t.currentTarget.removeListener(e,n[r].fn,void 0,!0),n[r].fn.call(n[r].context,t)}}const Vs={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Xs=class t{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new Gs(null),Ns.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Us(null),this.rootWheelEvent=new js(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...t.defaultEventFeatures},{set:(t,e,n)=>("globalMove"===e&&(this.rootBoundary.enableGlobalMoveEvents=n),t[e]=n,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:n,resolution:r}=this.renderer;this.setTargetElement(n),this.resolution=r,t._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.domElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.domElement.style,n)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let t=0,n=e.length;t<n;t++){const n=e[t],r=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Ns.pointerMoved();const e=this.normalizeToPointerData(t);for(let t=0,n=e.length;t<n;t++){const n=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const n=e!==this.domElement?"outside":"",r=this.normalizeToPointerData(t);for(let t=0,e=r.length;t<e;t++){const e=this.bootstrapEvent(this.rootPointerEvent,r[t]);e.type+=n,this.rootBoundary.mapEvent(e)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);for(let t=0,n=e.length;t<n;t++){const n=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,Ns.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Ns.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Ns.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,n){const r=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},i=1/this.resolution;t.x=(e-r.left)*(this.domElement.width/r.width)*i,t.y=(n-r.top)*(this.domElement.height/r.height)*i}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let n=0,r=t.changedTouches.length;n<r;n++){const r=t.changedTouches[n];typeof r.button>"u"&&(r.button=0),typeof r.buttons>"u"&&(r.buttons=1),typeof r.isPrimary>"u"&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),typeof r.width>"u"&&(r.width=r.radiusX||1),typeof r.height>"u"&&(r.height=r.radiusY||1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="touch"),typeof r.pointerId>"u"&&(r.pointerId=r.identifier||0),typeof r.pressure>"u"&&(r.pressure=r.force||.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),typeof r.layerX>"u"&&(r.layerX=r.offsetX=r.clientX),typeof r.layerY>"u"&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof globalThis.PointerEvent)){const n=t;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=1),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,e.push(n)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Vs[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};Xs.extension={name:"events",type:[Be.RendererSystem,Be.CanvasRendererSystem]},Xs.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Ys=Xs;function $s(t){return"dynamic"===t||"static"===t}je.add(Ys);const qs={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??$s(Ys.defaultEventMode)},set interactive(t){gt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Ys.defaultEventMode},set eventMode(t){this._internalInteractive=$s(t),this._internalEventMode=t},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(t,e,n){const r="boolean"==typeof n&&n||"object"==typeof n&&n.capture,i="object"==typeof n?n.signal:void 0,s="object"==typeof n&&!0===n.once,o="function"==typeof e?void 0:e;t=r?`${t}capture`:t;const a="function"==typeof e?e:e.handleEvent,l=this;i&&i.addEventListener("abort",(()=>{l.off(t,a,o)})),s?l.once(t,a,o):l.on(t,a,o)},removeEventListener(t,e,n){const r="function"==typeof e?void 0:e;t="boolean"==typeof n&&n||"object"==typeof n&&n.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,this.off(t,e,r)},dispatchEvent(t){if(!(t instanceof Bs))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};Qi.mixin(qs),Qi.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});class Ks{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(ut.tablet||ut.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2..toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",(()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()})),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let t=0;t<e.length;t++)this.updateAccessibleObjects(e[t])}update(){const t=performance.now();if(ut.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:n,width:r,height:i}=this.renderer.view.getBoundingClientRect(),{width:s,height:o,resolution:a}=this.renderer,l=r/s*a,h=i/o*a;let c=this.div;c.style.left=`${e}px`,c.style.top=`${n}px`,c.style.width=`${s}px`,c.style.height=`${o}px`;for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.renderId!==this.renderId)e._accessibleActive=!1,xe(this.children,t,1),this.div.removeChild(e._accessibleDiv),this.pool.push(e._accessibleDiv),e._accessibleDiv=null,t--;else{c=e._accessibleDiv;let t=e.hitArea;const n=e.worldTransform;e.hitArea?(c.style.left=(n.tx+t.x*n.a)*l+"px",c.style.top=(n.ty+t.y*n.d)*h+"px",c.style.width=t.width*n.a*l+"px",c.style.height=t.height*n.d*h+"px"):(t=e.getBounds(),this.capHitArea(t),c.style.left=t.x*l+"px",c.style.top=t.y*h+"px",c.style.width=t.width*l+"px",c.style.height=t.height*h+"px",c.title!==e.accessibleTitle&&null!==e.accessibleTitle&&(c.title=e.accessibleTitle),c.getAttribute("aria-label")!==e.accessibleHint&&null!==e.accessibleHint&&c.setAttribute("aria-label",e.accessibleHint)),(e.accessibleTitle!==c.title||e.tabIndex!==c.tabIndex)&&(c.title=e.accessibleTitle,c.tabIndex=e.tabIndex,this.debug&&this.updateDebugHTML(c))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:n}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>n&&(t.height=n-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:(!t.accessibleHint||null===t.accessibleHint)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:n}=t.target,r=this.renderer.events.rootBoundary,i=Object.assign(new Bs(r),{target:n});r.rootTarget=this.renderer.lastObjectRendered,e.forEach((t=>r.dispatchEvent(i,t)))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){9===t.keyCode&&this.activate()}_onMouseMove(t){0===t.movementX&&0===t.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Ks.extension={name:"accessibility",type:[Be.RendererPlugin,Be.CanvasRendererPlugin]},je.add(Ks);const Zs=class t{constructor(e){this.stage=new rs,e=Object.assign({forceCanvas:!1},e),this.renderer=function(t){for(const e of Ti)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}(e),t._plugins.forEach((t=>{t.init.call(this,e)}))}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(e,n){const r=t._plugins.slice(0);r.reverse(),r.forEach((t=>{t.destroy.call(this)})),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null}};Zs._plugins=[];let Qs=Zs;je.handleByList(Be.Application,Qs._plugins);class Js{static init(t){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame((()=>this.resize())))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let t,e;if(this.cancelResize(),this._resizeTo===globalThis.window)t=globalThis.innerWidth,e=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:r}=this._resizeTo;t=n,e=r}this.renderer.resize(t,e),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Js.extension=Be.Application,je.add(Js);const to={loader:Be.LoadParser,resolver:Be.ResolveParser,cache:Be.CacheParser,detection:Be.DetectionParser};je.handle(Be.Asset,(t=>{const e=t.ref;Object.entries(to).filter((([t])=>!!e[t])).forEach((([t,n])=>je.add(Object.assign(e[t],{extension:e[t].extension??n}))))}),(t=>{const e=t.ref;Object.keys(to).filter((t=>!!e[t])).forEach((t=>je.remove(e[t])))}));class eo{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach((t=>{this._assetList.push(t)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<e;n++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function no(t,e){const n=t.split("?")[0],r=wt.extname(n).toLowerCase();return Array.isArray(e)?e.includes(r):r===e}const ro=(t,e,n=!1)=>(Array.isArray(t)||(t=[t]),e?t.map((t=>"string"==typeof t||n?e(t):t)):t),io=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const n=ro(t);let r;for(let t=0;t<this.parsers.length;t++){const i=this.parsers[t];if(i.test(e)){r=i.getCacheableAssets(n,e);break}}r||(r={},n.forEach((t=>{r[t]=e})));const i=Object.keys(r),s={cacheKeys:i,keys:n};if(n.forEach((t=>{this._cacheMap.set(t,s)})),i.forEach((t=>{const n=r?r[t]:e;this._cache.has(t)&&this._cache.get(t)!==n&&console.warn("[Cache] already has key:",t),this._cache.set(t,r[t])})),e instanceof vr){const t=e;n.forEach((e=>{t.baseTexture!==vr.EMPTY.baseTexture&&Je.addToCache(t.baseTexture,e),vr.addToCache(t,e)}))}}remove(t){if(!this._cacheMap.has(t))return void console.warn(`[Assets] Asset id ${t} was not found in the Cache`);const e=this._cacheMap.get(t);e.cacheKeys.forEach((t=>{this._cache.delete(t)})),e.keys.forEach((t=>{this._cacheMap.delete(t)}))}get parsers(){return this._parsers}},so=t=>!Array.isArray(t);class oo{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,n)=>(this._parsersValidated=!1,t[e]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const n={promise:null,parser:null};return n.promise=(async()=>{let r=null,i=null;if(e.loadParser&&(i=this._parserHash[e.loadParser],i||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!i){for(let n=0;n<this.parsers.length;n++){const r=this.parsers[n];if(r.load&&r.test?.(t,e,this)){i=r;break}}if(!i)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await i.load(t,e,this),n.parser=i;for(let t=0;t<this.parsers.length;t++){const i=this.parsers[t];i.parse&&i.parse&&await(i.testParse?.(r,e,this))&&(r=await i.parse(r,e,this)||r,n.parser=i)}return r})(),n}async load(t,e){this._parsersValidated||this._validateParsers();let n=0;const r={},i=so(t),s=ro(t,(t=>({alias:[t],src:t}))),o=s.length,a=s.map((async t=>{const i=wt.toAbsolute(t.src);if(!r[t.src])try{this.promiseCache[i]||(this.promiseCache[i]=this._getLoadPromiseAndParser(i,t)),r[t.src]=await this.promiseCache[i].promise,e&&e(++n/o)}catch(e){throw delete this.promiseCache[i],delete r[t.src],new Error(`[Loader.load] Failed to load ${i}.\n${e}`)}}));return await Promise.all(a),i?r[s[0].src]:r}async unload(t){const e=ro(t,(t=>({alias:[t],src:t}))).map((async t=>{const e=wt.toAbsolute(t.src),n=this.promiseCache[e];if(n){const r=await n.promise;delete this.promiseCache[e],n.parser?.unload?.(r,t,this)}}));await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((t=>t.name)).reduce(((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e})),{})}}var ao=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(ao||{});function lo(t,e){if(Array.isArray(e)){for(const n of e)if(t.startsWith(`data:${n}`))return!0;return!1}return t.startsWith(`data:${e}`)}const ho={extension:{type:Be.LoadParser,priority:ao.Low},name:"loadJson",test(t){return lo(t,"application/json")||no(t,".json")},async load(t){return await(await Y.ADAPTER.fetch(t)).json()}};je.add(ho);const co={name:"loadTxt",extension:{type:Be.LoadParser,priority:ao.Low},test(t){return lo(t,"text/plain")||no(t,".txt")},async load(t){return await(await Y.ADAPTER.fetch(t)).text()}};je.add(co);const uo=["normal","bold","100","200","300","400","500","600","700","800","900"],fo=[".ttf",".otf",".woff",".woff2"],po=["font/ttf","font/otf","font/woff","font/woff2"],mo=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,go=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/,vo={extension:{type:Be.LoadParser,priority:ao.Low},name:"loadWebFont",test(t){return lo(t,po)||no(t,fo)},async load(t,e){const n=Y.ADAPTER.getFontFaceSet();if(n){const i=[],s=e.data?.family??function(t){const e=wt.extname(t),n=wt.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1)));let r=n.length>0;for(const t of n)if(!t.match(mo)){r=!1;break}let i=n.join(" ");return r||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}(t),o=e.data?.weights?.filter((t=>uo.includes(t)))??["normal"],a=e.data??{};for(let e=0;e<o.length;e++){const l=o[e],h=new FontFace(s,`url(${r=t,go.test(r)?r:encodeURI(r)})`,{...a,weight:l});await h.load(),n.add(h),i.push(h)}return 1===i.length?i[0]:i}var r;return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach((t=>Y.ADAPTER.getFontFaceSet().delete(t)))}};je.add(vo);let yo=null;class xo{constructor(){yo||(yo=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n  async function checkImageBitmap() {\n    try {\n      if (typeof createImageBitmap != "function")\n        return !1;\n      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);\n      return imageBitmap.width === 1 && imageBitmap.height === 1;\n    } catch {\n      return !1;\n    }\n  }\n  checkImageBitmap().then((result) => {\n    self.postMessage(result);\n  });\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(yo)}}xo.revokeObjectURL=function(){yo&&(URL.revokeObjectURL(yo),yo=null)};let wo=null;class _o{constructor(){wo||(wo=URL.createObjectURL(new Blob(['(function() {\n  "use strict";\n  async function loadImageBitmap(url) {\n    const response = await fetch(url);\n    if (!response.ok)\n      throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n    const imageBlob = await response.blob();\n    return await createImageBitmap(imageBlob);\n  }\n  self.onmessage = async (event) => {\n    try {\n      const imageBitmap = await loadImageBitmap(event.data.data[0]);\n      self.postMessage({\n        data: imageBitmap,\n        uuid: event.data.uuid,\n        id: event.data.id\n      }, [imageBitmap]);\n    } catch (e) {\n      self.postMessage({\n        error: e,\n        uuid: event.data.uuid,\n        id: event.data.id\n      });\n    }\n  };\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(wo)}}_o.revokeObjectURL=function(){wo&&(URL.revokeObjectURL(wo),wo=null)};let bo,To=0;const So=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((t=>{const{worker:e}=new xo;e.addEventListener("message",(n=>{e.terminate(),xo.revokeObjectURL(),t(n.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===bo&&(bo=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<bo&&(this._createdWorkers++,t=(new _o).worker,t.addEventListener("message",(t=>{this.complete(t.data),this.returnWorker(t.target),this.next()}))),t}returnWorker(t){this.workerPool.push(t)}complete(t){void 0!==t.error?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const n=new Promise(((n,r)=>{this.queue.push({id:t,arguments:e,resolve:n,reject:r})}));return this.next(),n}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),n=e.id;this.resolveHash[To]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:To++,id:n})}};function Ao(t,e,n){t.resource.internal=!0;const r=new vr(t),i=()=>{delete e.promiseCache[n],io.has(n)&&io.remove(n)};return r.baseTexture.once("destroyed",(()=>{n in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),i())})),r.once("destroyed",(()=>{t.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())})),r}const Eo=[".jpeg",".jpg",".png",".webp",".avif"],Co=["image/jpeg","image/png","image/webp","image/avif"],ko={name:"loadTextures",extension:{type:Be.LoadParser,priority:ao.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return lo(t,Co)||no(t,Eo)},async load(t,e,n){const r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let i;i=r?this.config.preferWorkers&&await So.isImageBitmapSupported()?await So.loadImageBitmap(t):await async function(t){const e=await Y.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const n=await e.blob();return await createImageBitmap(n)}(t):await new Promise(((e,n)=>{const r=new Image;r.crossOrigin=this.config.crossOrigin,r.src=t,r.complete?e(r):(r.onload=()=>e(r),r.onerror=t=>n(t))}));const s={...e.data};s.resolution??(s.resolution=Ne(t)),r&&void 0===s.resourceOptions?.ownsImageBitmap&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new Je(i,s);return o.resource.src=t,Ao(o,n,t)},unload(t){t.destroy(!0)}};je.add(ko);const Mo={extension:{type:Be.LoadParser,priority:ao.High},name:"loadSVG",test(t){return lo(t,"image/svg+xml")||no(t,".svg")},async testParse(t){return Ni.test(t)},async parse(t,e,n){const r=new Ni(t,e?.data?.resourceOptions);await r.load();const i=new Je(r,{resolution:Ne(t),...e?.data});return i.resource.src=e.src,Ao(i,n,e.src)},async load(t,e){return(await Y.ADAPTER.fetch(t)).text()},unload:ko.unload};je.add(Mo);const Po=[".mp4",".m4v",".webm",".ogv"],Io=["video/mp4","video/webm","video/ogg"],Ro={name:"loadVideo",extension:{type:Be.LoadParser,priority:ao.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(t){return lo(t,Io)||no(t,Po)},async load(t,e,n){let r;const i=await(await Y.ADAPTER.fetch(t)).blob(),s=URL.createObjectURL(i);try{const i={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...e?.data?.resourceOptions,autoLoad:!0},o=new Ui(s,i);await o.load();const a=new Je(o,{alphaMode:await Tt(),resolution:Ne(t),...e?.data});a.resource.src=t,r=Ao(a,n,t),r.baseTexture.once("destroyed",(()=>{URL.revokeObjectURL(s)}))}catch(t){throw URL.revokeObjectURL(s),t}return r},unload(t){t.destroy(!0)}};function Oo(t,e,n,r,i){const s=e[n];for(let o=0;o<s.length;o++){const a=s[o];n<e.length-1?Oo(t.replace(r[n],a),e,n+1,r,i):i.push(t.replace(r[n],a))}}function Lo(t){const e=t.match(/\{(.*?)\}/g),n=[];if(e){const r=[];e.forEach((t=>{const e=t.substring(1,t.length-1).split(",");r.push(e)})),Oo(t,r,0,e,n)}else n.push(t);return n}je.add(Ro);class Do{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach((t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))})),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if("string"==typeof t)this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&")}}getAlias(t){const{alias:e,name:n,src:r,srcs:i}=t;return ro(e||n||r||i,(t=>"string"==typeof t?t:Array.isArray(t)?t.map((t=>t?.src??t?.srcs??t)):t?.src||t?.srcs?t.src??t.srcs:t),!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach((t=>{this.addBundle(t.name,t.assets)}))}addBundle(t,e){const n=[];Array.isArray(e)?e.forEach((e=>{const r=e.src??e.srcs,i=e.alias??e.name;let s;if("string"==typeof i){const e=this._createBundleAssetId(t,i);n.push(e),s=[i,e]}else{const e=i.map((e=>this._createBundleAssetId(t,e)));n.push(...e),s=[...i,...e]}this.add({...e,alias:s,src:r})})):Object.keys(e).forEach((r=>{const i=[r,this._createBundleAssetId(t,r)];if("string"==typeof e[r])this.add({alias:i,src:e[r]});else if(Array.isArray(e[r]))this.add({alias:i,src:e[r]});else{const t=e[r],n=t.src??t.srcs;this.add({...t,alias:i,src:Array.isArray(n)?n:[n]})}n.push(...i)})),this._bundles[t]=n}add(t,e,n,r,i){const s=[];let o;"string"==typeof t||Array.isArray(t)&&"string"==typeof t[0]?(gt("7.2.0","Assets.add now uses an object instead of individual parameters.\nPlease use Assets.add({ alias, src, data, format, loadParser }) instead."),s.push({alias:t,src:e,data:n,format:r,loadParser:i})):Array.isArray(t)?s.push(...t):s.push(t),o=t=>{this.hasKey(t)&&console.warn(`[Resolver] already has key: ${t} overwriting`)},ro(s).forEach((t=>{const{src:e,srcs:n}=t;let{data:r,format:i,loadParser:s}=t;const a=ro(e||n).map((t=>"string"==typeof t?Lo(t):Array.isArray(t)?t:[t])),l=this.getAlias(t);Array.isArray(l)?l.forEach(o):o(l);const h=[];a.forEach((t=>{t.forEach((t=>{let e={};if("object"!=typeof t){e.src=t;for(let n=0;n<this._parsers.length;n++){const r=this._parsers[n];if(r.test(t)){e=r.parse(t);break}}}else r=t.data??r,i=t.format??i,s=t.loadParser??s,e={...e,...t};if(!l)throw new Error(`[Resolver] alias is undefined for this asset: ${e.src}`);e=this.buildResolvedAsset(e,{aliases:l,data:r,format:i,loadParser:s}),h.push(e)}))})),l.forEach((t=>{this._assetMap[t]=h}))}))}resolveBundle(t){const e=so(t);t=ro(t);const n={};return t.forEach((t=>{const e=this._bundles[t];if(e){const r=this.resolve(e),i={};for(const e in r){const n=r[e];i[this._extractAssetIdFromBundle(t,e)]=n}n[t]=i}})),e?n[t[0]]:n}resolveUrl(t){const e=this.resolve(t);if("string"!=typeof t){const t={};for(const n in e)t[n]=e[n].src;return t}return e.src}resolve(t){const e=so(t);t=ro(t);const n={};return t.forEach((t=>{if(!this._resolverHash[t])if(this._assetMap[t]){let e=this._assetMap[t];const n=e[0],r=this._getPreferredOrder(e);r?.priority.forEach((t=>{r.params[t].forEach((n=>{const r=e.filter((e=>!!e[t]&&e[t]===n));r.length&&(e=r)}))})),this._resolverHash[t]=e[0]??n}else this._resolverHash[t]=this.buildResolvedAsset({alias:[t],src:t},{});n[t]=this._resolverHash[t]})),e?n[t[0]]:n}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const e=t[0],n=this._preferredOrder.find((t=>t.params.format.includes(e.format)));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){return this._defaultSearchParams?`${t}${/\?/.test(t)?"&":"?"}${this._defaultSearchParams}`:t}buildResolvedAsset(t,e){const{aliases:n,data:r,loadParser:i,format:s}=e;return(this._basePath||this._rootPath)&&(t.src=wt.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=n??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=i??t.loadParser,t.format=s??t.format??wt.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}const Fo=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Do,this.loader=new oo,this.cache=io,this._backgroundLoader=new eo(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized)return void console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let e=t.manifest;"string"==typeof e&&(e=await this.load(e)),this.resolver.addManifest(e)}const e=t.texturePreference?.resolution??1,n="number"==typeof e?[e]:e,r=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:n}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,n,r,i){this.resolver.add(t,e,n,r,i)}async load(t,e){this._initialized||await this.init();const n=so(t),r=ro(t).map((t=>{if("string"!=typeof t){const e=this.resolver.getAlias(t);return e.some((t=>!this.resolver.hasKey(t)))&&this.add(t),Array.isArray(e)?e[0]:e}return this.resolver.hasKey(t)||this.add({alias:t,src:t}),t})),i=this.resolver.resolve(r),s=await this._mapLoadToResolve(i,e);return n?s[r[0]]:s}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let n=!1;"string"==typeof t&&(n=!0,t=[t]);const r=this.resolver.resolveBundle(t),i={},s=Object.keys(r);let o=0,a=0;const l=()=>{e?.(++o/a)},h=s.map((t=>{const e=r[t];return a+=Object.keys(e).length,this._mapLoadToResolve(e,l).then((e=>{i[t]=e}))}));return await Promise.all(h),n?i[t[0]]:i}async backgroundLoad(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach((t=>{this._backgroundLoader.add(Object.values(t))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return io.get(t);const e={};for(let n=0;n<t.length;n++)e[n]=io.get(t[n]);return e}async _mapLoadToResolve(t,e){const n=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const i=await this.loader.load(n,e);this._backgroundLoader.active=!0;const s={};return n.forEach(((t,e)=>{const n=i[t.src],o=[t.src];t.alias&&o.push(...t.alias),s[r[e]]=n,io.set(o,n)})),s}async unload(t){this._initialized||await this.init();const e=ro(t).map((t=>"string"!=typeof t?t.src:t)),n=this.resolver.resolve(e);await this._unloadFromResolved(n)}async unloadBundle(t){this._initialized||await this.init(),t=ro(t);const e=this.resolver.resolveBundle(t),n=Object.keys(e).map((t=>this._unloadFromResolved(e[t])));await Promise.all(n)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach((t=>{io.remove(t.src)})),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const n of t.detections)t.skipDetections||await n.test()?e=await n.add(e):t.skipDetections||(e=await n.remove(e));return e=e.filter(((t,n)=>e.indexOf(t)===n)),e}get detections(){return this._detections}get preferWorkers(){return ko.config.preferWorkers}set preferWorkers(t){gt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach((e=>{e.config&&Object.keys(e.config).filter((e=>e in t)).forEach((n=>{e.config[n]=t[n]}))}))}};je.handleByList(Be.LoadParser,Fo.loader.parsers).handleByList(Be.ResolveParser,Fo.resolver.parsers).handleByList(Be.CacheParser,Fo.cache.parsers).handleByList(Be.DetectionParser,Fo.detections);const No={extension:Be.CacheParser,test:t=>Array.isArray(t)&&t.every((t=>t instanceof vr)),getCacheableAssets:(t,e)=>{const n={};return t.forEach((t=>{e.forEach(((e,r)=>{n[t+(0===r?"":r+1)]=e}))})),n}};async function Bo(t){if("Image"in globalThis)return new Promise((e=>{const n=new Image;n.onload=()=>{e(!0)},n.onerror=()=>{e(!1)},n.src=t}));if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}je.add(No);const Wo={extension:{type:Be.DetectionParser,priority:1},test:async()=>Bo("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter((t=>"avif"!==t))};je.add(Wo);const Uo={extension:{type:Be.DetectionParser,priority:0},test:async()=>Bo("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter((t=>"webp"!==t))};je.add(Uo);const jo=["png","jpg","jpeg"],Ho={extension:{type:Be.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...jo],remove:async t=>t.filter((t=>!jo.includes(t)))};je.add(Ho);const zo="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Go(t){return!zo&&""!==document.createElement("video").canPlayType(t)}const Vo={extension:{type:Be.DetectionParser,priority:0},test:async()=>Go("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter((t=>"webm"!==t))};je.add(Vo);const Xo={extension:{type:Be.DetectionParser,priority:0},test:async()=>Go("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter((t=>"mp4"!==t&&"m4v"!==t))};je.add(Xo);const Yo={extension:{type:Be.DetectionParser,priority:0},test:async()=>Go("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter((t=>"ogv"!==t))};je.add(Yo);const $o={extension:Be.ResolveParser,test:ko.test,parse:t=>({resolution:parseFloat(Y.RETINA_PREFIX.exec(t)?.[1]??"1"),format:wt.extname(t).slice(1),src:t})};je.add($o);const qo=(t,e)=>{const n=e.split("?")[1];return n&&(t+=`?${n}`),t};var Ko=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t))(Ko||{});const Zo={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let Qo,Jo;function ta(){Jo={bptc:Qo.getExtension("EXT_texture_compression_bptc"),astc:Qo.getExtension("WEBGL_compressed_texture_astc"),etc:Qo.getExtension("WEBGL_compressed_texture_etc"),s3tc:Qo.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Qo.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:Qo.getExtension("WEBGL_compressed_texture_pvrtc")||Qo.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:Qo.getExtension("WEBGL_compressed_texture_etc1"),atc:Qo.getExtension("WEBGL_compressed_texture_atc")}}const ea={extension:{type:Be.DetectionParser,priority:2},test:async()=>{const t=Y.ADAPTER.createCanvas().getContext("webgl");return t?(Qo=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async t=>{Jo||ta();const e=[];for(const t in Jo)Jo[t]&&e.push(t);return[...e,...t]},remove:async t=>(Jo||ta(),t.filter((t=>!(t in Jo))))};je.add(ea);class na extends Ke{constructor(t,e={width:1,height:1,autoLoad:!0}){let n,r;"string"==typeof t?(n=t,r=new Uint8Array):(n=null,r=t),super(r,e),this.origin=n,this.buffer=r?new He(r):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==e.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load||(this._load=fetch(this.origin).then((t=>t.blob())).then((t=>t.arrayBuffer())).then((t=>(this.data=new Uint32Array(t),this.buffer=new He(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)))),this._load}}class ra extends na{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=ra._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||ra._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,n){const r=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;r.pixelStorei(r.UNPACK_ALIGNMENT,4);for(let t=0,e=this.levels;t<e;t++){const{levelID:e,levelWidth:n,levelHeight:i,levelBuffer:s}=this._levelBuffers[t];r.compressedTexImage2D(r.TEXTURE_2D,e,this.format,n,i,0,s)}return!0}onBlobLoaded(){this._levelBuffers=ra._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=35916&&t<=35919)return"s3tc_sRGB";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(36196===t)return"etc1";if(35986===t||35987===t||34798===t)return"atc";if(t>=36492&&t<=36495)return"bptc";if(37808===t)return"astc";throw new Error(`Invalid (compressed) texture format given: ${t}`)}static _createLevelBuffers(t,e,n,r,i,s,o){const a=new Array(n);let l=t.byteOffset,h=s,c=o,u=h+r-1&~(r-1),d=c+i-1&~(i-1),f=u*d*Zo[e];for(let s=0;s<n;s++)a[s]={levelID:s,levelWidth:n>1?h:u,levelHeight:n>1?c:d,levelBuffer:new Uint8Array(t.buffer,l,f)},l+=f,h=h>>1||1,c=c>>1||1,u=h+r-1&~(r-1),d=c+i-1&~(i-1),f=u*d*Zo[e];return a}}const ia=827611204,sa=861165636,oa=894720068,aa={[ia]:Ko.COMPRESSED_RGBA_S3TC_DXT1_EXT,[sa]:Ko.COMPRESSED_RGBA_S3TC_DXT3_EXT,[oa]:Ko.COMPRESSED_RGBA_S3TC_DXT5_EXT},la={70:Ko.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ko.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ko.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ko.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ko.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ko.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ko.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ko.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ko.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Ko.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Ko.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Ko.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Ko.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT},ha=[171,75,84,88,32,49,49,187,13,10,26,10],ca={[L.UNSIGNED_BYTE]:1,[L.UNSIGNED_SHORT]:2,[L.INT]:4,[L.UNSIGNED_INT]:4,[L.FLOAT]:4,[L.HALF_FLOAT]:8},ua={[R.RGBA]:4,[R.RGB]:3,[R.RG]:2,[R.RED]:1,[R.LUMINANCE]:1,[R.LUMINANCE_ALPHA]:2,[R.ALPHA]:1},da={[L.UNSIGNED_SHORT_4_4_4_4]:2,[L.UNSIGNED_SHORT_5_5_5_1]:2,[L.UNSIGNED_SHORT_5_6_5]:2};function fa(t){switch(t){case R.RGBA:return R.RGBA_INTEGER;case R.RGB:return R.RGB_INTEGER;case R.RG:return R.RG_INTEGER;case R.RED:return R.RED_INTEGER;default:return t}}const pa={extension:{type:Be.LoadParser,priority:ao.High},name:"loadDDS",test(t){return no(t,".dds")},async load(t,e,n){const r=function(t){const e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");const n=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),r=n[3],i=n[4],s=n[7],o=new Uint32Array(t,19*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),a=o[1];if(4&a){const n=o[2];if(808540228!==n){const e=aa[n],o=new Uint8Array(t,128);return[new ra(o,{format:e,width:i,height:r,levels:s})]}const a=128,l=new Uint32Array(e.buffer,a,20/Uint32Array.BYTES_PER_ELEMENT),h=l[0],c=l[1],u=l[2],d=l[3],f=la[h];if(void 0===f)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(4===u)throw new Error("DDSParser does not support cubemap textures");if(6===c)throw new Error("DDSParser does not supported 3D texture data");const p=new Array,m=148;if(1===d)p.push(new Uint8Array(t,m));else{const e=Zo[f];let n=0,o=i,a=r;for(let t=0;t<s;t++)n+=Math.max(1,o+3&-4)*Math.max(1,a+3&-4)*e,o>>>=1,a>>>=1;let l=m;for(let e=0;e<d;e++)p.push(new Uint8Array(t,l,n)),l+=n}return p.map((t=>new ra(t,{format:f,width:i,height:r,levels:s})))}throw 64&a?new Error("DDSParser does not support uncompressed texture data."):512&a?new Error("DDSParser does not supported YUV uncompressed texture data."):131072&a?new Error("DDSParser does not support single-channel (lumninance) texture data!"):2&a?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}(await(await Y.ADAPTER.fetch(t)).arrayBuffer()).map((r=>Ao(new Je(r,{mipmap:B.OFF,alphaMode:W.NO_PREMULTIPLIED_ALPHA,resolution:Ne(t),...e.data}),n,t)));return 1===r.length?r[0]:r},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};je.add(pa);const ma={extension:{type:Be.LoadParser,priority:ao.High},name:"loadKTX",test(t){return no(t,".ktx")},async load(t,e,n){const r=await(await Y.ADAPTER.fetch(t)).arrayBuffer(),{compressed:i,uncompressed:s,kvData:o}=function(t,e,n=!1){const r=new DataView(e);if(!function(t,e){for(let n=0;n<ha.length;n++)if(e.getUint8(n)!==ha[n])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}(t,r))return null;const i=67305985===r.getUint32(12,!0),s=r.getUint32(16,i),o=r.getUint32(24,i),a=r.getUint32(28,i),l=r.getUint32(36,i),h=r.getUint32(40,i)||1,c=r.getUint32(44,i)||1,u=r.getUint32(48,i)||1,d=r.getUint32(52,i),f=r.getUint32(56,i),p=r.getUint32(60,i);if(0===h||1!==c)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==u)throw new Error("WebGL does not support array textures");const m=l+3&-4,g=h+3&-4,v=new Array(u);let y,x=l*h;if(0===s&&(x=m*g),y=0!==s?ca[s]?ca[s]*ua[o]:da[s]:Zo[a],void 0===y)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const w=n?function(t,e,n){const r=new Map;let i=0;for(;i<e;){const s=t.getUint32(64+i,n),o=64+i+4,a=3-(s+3)%4;if(0===s||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&0!==t.getUint8(o+l);l++);if(-1===l){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=(new TextDecoder).decode(new Uint8Array(t.buffer,o,l)),c=new DataView(t.buffer,o+l+1,s-l-1);r.set(h,c),i+=4+s+a}return r}(r,p,i):null;let _=x*y,b=l,T=h,S=m,A=g,E=64+p;for(let t=0;t<f;t++){const n=r.getUint32(E,i);let o=E+4;for(let n=0;n<u;n++){let r=v[n];r||(r=v[n]=new Array(f)),r[t]={levelID:t,levelWidth:f>1||0!==s?b:S,levelHeight:f>1||0!==s?T:A,levelBuffer:new Uint8Array(e,o,_)},o+=_}E+=n+4,E=E%4!=0?E+4-E%4:E,b=b>>1||1,T=T>>1||1,S=b+4-1&-4,A=T+4-1&-4,_=S*A*y}return 0!==s?{uncompressed:v.map((t=>{let e=t[0].levelBuffer,n=!1;return s===L.FLOAT?e=new Float32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4):s===L.UNSIGNED_INT?(n=!0,e=new Uint32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)):s===L.INT&&(n=!0,e=new Int32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)),{resource:new Ke(e,{width:t[0].levelWidth,height:t[0].levelHeight}),type:s,format:n?fa(o):o}})),kvData:w}:{compressed:v.map((t=>new ra(null,{format:a,width:l,height:h,levels:f,levelBuffers:t}))),kvData:w}}(t,r),a=i??s,l={mipmap:B.OFF,alphaMode:W.NO_PREMULTIPLIED_ALPHA,resolution:Ne(t),...e.data},h=a.map((e=>{a===s&&Object.assign(l,{type:e.type,format:e.format});const r=e.resource??e,i=new Je(r,l);return i.ktxKeyValueData=o,Ao(i,n,t)}));return 1===h.length?h[0]:h},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};je.add(ma);const ga=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],va={extension:Be.ResolveParser,test:t=>{const e=wt.extname(t).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{const e=t.split("."),n=e.pop();if(["ktx","dds"].includes(n)){const n=e.pop();if(ga.includes(n))return{resolution:parseFloat(Y.RETINA_PREFIX.exec(t)?.[1]??"1"),format:n,src:t}}return{resolution:parseFloat(Y.RETINA_PREFIX.exec(t)?.[1]??"1"),format:n,src:t}}};je.add(va);const ya=new vn,xa=class t{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){const t=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}async image(t,e,n,r){const i=new Image;return i.src=await this.base64(t,e,n,r),i}async base64(t,e,n,r){const i=this.canvas(t,r);if(void 0!==i.toBlob)return new Promise(((t,r)=>{i.toBlob((e=>{if(!e)return void r(new Error("ICanvas.toBlob failed!"));const n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)}),e,n)}));if(void 0!==i.toDataURL)return i.toDataURL(e,n);if(void 0!==i.convertToBlob){const t=await i.convertToBlob({type:e,quality:n});return new Promise(((e,n)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=n,r.readAsDataURL(t)}))}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,n){const{pixels:r,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,n);o&&t._flipY(r,i,s),a&&t._unpremultiplyAlpha(r);const l=new Pe(i,s,1),h=new ImageData(new Uint8ClampedArray(r.buffer),i,s);return l.context.putImageData(h,0,0),l.canvas}pixels(e,n){const{pixels:r,width:i,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,n);return o&&t._flipY(r,i,s),a&&t._unpremultiplyAlpha(r),r}_rawPixels(t,e){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let r,i,s=!1,o=!1,a=!1;t&&(t instanceof yr?i=t:(i=n.generateTexture(t,{region:e,resolution:n.resolution,multisample:n.multisample}),a=!0,e&&(ya.width=e.width,ya.height=e.height,e=ya)));const l=n.gl;if(i){if(r=i.baseTexture.resolution,e=e??i.frame,s=!1,o=i.baseTexture.alphaMode>0&&i.baseTexture.format===R.RGBA,!a){n.renderTexture.bind(i);const t=i.framebuffer.glFramebuffers[n.CONTEXT_UID];t.blitFramebuffer&&n.framebuffer.bind(t.blitFramebuffer)}}else r=n.resolution,e||((e=ya).width=n.width/r,e.height=n.height/r),s=!0,o=this._rendererPremultipliedAlpha,n.renderTexture.bind();const h=Math.max(Math.round(e.width*r),1),c=Math.max(Math.round(e.height*r),1),u=new Uint8Array(4*h*c);return l.readPixels(Math.round(e.x*r),Math.round(e.y*r),h,c,l.RGBA,l.UNSIGNED_BYTE,u),a&&i?.destroy(!0),{pixels:u,width:h,height:c,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(t,e,n){const r=e<<2,i=n>>1,s=new Uint8Array(r);for(let e=0;e<i;e++){const i=e*r,o=(n-e-1)*r;s.set(t.subarray(i,i+r)),t.copyWithin(i,o,o+r),t.set(s,o)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let n=0;n<e;n+=4){const e=t[n+3];if(0!==e){const r=255.001/e;t[n]=t[n]*r+.5,t[n+1]=t[n+1]*r+.5,t[n+2]=t[n+2]*r+.5}}}};xa.extension={name:"extract",type:Be.RendererSystem};let wa=xa;je.add(wa);const _a={build(t){const e=t.points;let n,r,i,s,o,a;if(t.type===pn.CIRC){const e=t.shape;n=e.x,r=e.y,o=a=e.radius,i=s=0}else if(t.type===pn.ELIP){const e=t.shape;n=e.x,r=e.y,o=e.width,a=e.height,i=s=0}else{const e=t.shape,l=e.width/2,h=e.height/2;n=e.x+l,r=e.y+h,o=a=Math.max(0,Math.min(e.radius,Math.min(l,h))),i=l-o,s=h-a}if(!(o>=0&&a>=0&&i>=0&&s>=0))return void(e.length=0);const l=Math.ceil(2.3*Math.sqrt(o+a)),h=8*l+(i?4:0)+(s?4:0);if(e.length=h,0===h)return;if(0===l)return e.length=8,e[0]=e[6]=n+i,e[1]=e[3]=r+s,e[2]=e[4]=n-i,void(e[5]=e[7]=r-s);let c=0,u=4*l+(i?2:0)+2,d=u,f=h;{const t=i+o,a=s,l=n+t,h=n-t,p=r+a;if(e[c++]=l,e[c++]=p,e[--u]=p,e[--u]=h,s){const t=r-a;e[d++]=h,e[d++]=t,e[--f]=t,e[--f]=l}}for(let t=1;t<l;t++){const h=Math.PI/2*(t/l),p=i+Math.cos(h)*o,m=s+Math.sin(h)*a,g=n+p,v=n-p,y=r+m,x=r-m;e[c++]=g,e[c++]=y,e[--u]=y,e[--u]=v,e[d++]=v,e[d++]=x,e[--f]=x,e[--f]=g}{const t=s+a,o=n+i,l=n-i,h=r+t,u=r-t;e[c++]=o,e[c++]=h,e[--f]=u,e[--f]=o,i&&(e[c++]=l,e[c++]=h,e[--f]=u,e[--f]=l)}},triangulate(t,e){const n=t.points,r=e.points,i=e.indices;if(0===n.length)return;let s=r.length/2;const o=s;let a,l;if(t.type!==pn.RREC){const e=t.shape;a=e.x,l=e.y}else{const e=t.shape;a=e.x+e.width/2,l=e.y+e.height/2}const h=t.matrix;r.push(t.matrix?h.a*a+h.c*l+h.tx:a,t.matrix?h.b*a+h.d*l+h.ty:l),s++,r.push(n[0],n[1]);for(let t=2;t<n.length;t+=2)r.push(n[t],n[t+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function ba(t,e=!1){const n=t.length;if(n<6)return;let r=0;for(let e=0,i=t[n-2],s=t[n-1];e<n;e+=2){const n=t[e],o=t[e+1];r+=(n-i)*(o+s),i=n,s=o}if(!e&&r>0||e&&r<=0){const e=n/2;for(let r=e+e%2;r<n;r+=2){const e=n-r-2,i=n-r-1,s=r,o=r+1;[t[e],t[s]]=[t[s],t[e]],[t[i],t[o]]=[t[o],t[i]]}}}const Ta={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let n=t.points;const r=t.holes,i=e.points,s=e.indices;if(n.length>=6){ba(n,!1);const t=[];for(let e=0;e<r.length;e++){const i=r[e];ba(i.points,!0),t.push(n.length/2),n=n.concat(i.points)}const e=ft(n,t,2);if(!e)return;const o=i.length/2;for(let t=0;t<e.length;t+=3)s.push(e[t]+o),s.push(e[t+1]+o),s.push(e[t+2]+o);for(let t=0;t<n.length;t++)i.push(n[t])}}},Sa={build(t){const e=t.shape,n=e.x,r=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(n,r,n+i,r,n+i,r+s,n,r+s)},triangulate(t,e){const n=t.points,r=e.points;if(0===n.length)return;const i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},Aa={build(t){_a.build(t)},triangulate(t,e){_a.triangulate(t,e)}};var Ea=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(Ea||{}),Ca=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(Ca||{});const ka={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}};class Ma{static curveTo(t,e,n,r,i,s){const o=s[s.length-2],a=s[s.length-1]-e,l=o-t,h=r-e,c=n-t,u=Math.abs(a*c-l*h);if(u<1e-8||0===i)return(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e),null;const d=a*a+l*l,f=h*h+c*c,p=a*h+l*c,m=i*Math.sqrt(d)/u,g=i*Math.sqrt(f)/u,v=m*p/d,y=g*p/f,x=m*c+g*l,w=m*h+g*a,_=l*(g+v),b=a*(g+v),T=c*(m+y),S=h*(m+y);return{cx:x+t,cy:w+e,radius:i,startAngle:Math.atan2(b-w,_-x),endAngle:Math.atan2(S-w,T-x),anticlockwise:l*h>c*a}}static arc(t,e,n,r,i,s,o,a,l){const h=o-s,c=ka._segmentsCount(Math.abs(h)*i,40*Math.ceil(Math.abs(h)/un)),u=h/(2*c),d=2*u,f=Math.cos(u),p=Math.sin(u),m=c-1,g=m%1/m;for(let t=0;t<=m;++t){const e=u+s+d*(t+g*t),o=Math.cos(e),a=-Math.sin(e);l.push((f*o+p*a)*i+n,(f*-a+p*o)*i+r)}}}class Pa{static curveLength(t,e,n,r,i,s,o,a){let l=0,h=0,c=0,u=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0,x=t,w=e;for(let _=1;_<=10;++_)h=_/10,c=h*h,u=c*h,d=1-h,f=d*d,p=f*d,m=p*t+3*f*h*n+3*d*c*i+u*o,g=p*e+3*f*h*r+3*d*c*s+u*a,v=x-m,y=w-g,x=m,w=g,l+=Math.sqrt(v*v+y*y);return l}static curveTo(t,e,n,r,i,s,o){const a=o[o.length-2],l=o[o.length-1];o.length-=2;const h=ka._segmentsCount(Pa.curveLength(a,l,t,e,n,r,i,s));let c=0,u=0,d=0,f=0,p=0;o.push(a,l);for(let m=1,g=0;m<=h;++m)g=m/h,c=1-g,u=c*c,d=u*c,f=g*g,p=f*g,o.push(d*a+3*u*g*t+3*c*f*n+p*i,d*l+3*u*g*e+3*c*f*r+p*s)}}function Ia(t,e,n,r,i,s,o,a){let l,h;o?(l=r,h=-n):(l=-r,h=n);const c=t-n*i+l,u=e-r*i+h,d=t+n*s+l,f=e+r*s+h;return a.push(c,u,d,f),2}function Ra(t,e,n,r,i,s,o,a){const l=n-t,h=r-e;let c=Math.atan2(l,h),u=Math.atan2(i-t,s-e);a&&c<u?c+=2*Math.PI:!a&&c>u&&(u+=2*Math.PI);let d=c;const f=u-c,p=Math.abs(f),m=Math.sqrt(l*l+h*h),g=1+(15*p*Math.sqrt(m)/Math.PI|0),v=f/g;if(d+=v,a){o.push(t,e,n,r);for(let n=1,r=d;n<g;n++,r+=v)o.push(t,e,t+Math.sin(r)*m,e+Math.cos(r)*m);o.push(t,e,i,s)}else{o.push(n,r,t,e);for(let n=1,r=d;n<g;n++,r+=v)o.push(t+Math.sin(r)*m,e+Math.cos(r)*m,t,e);o.push(i,s,t,e)}return 2*g}function Oa(t,e){t.lineStyle.native?function(t,e){let n=0;const r=t.shape,i=t.points||r.points,s=r.type!==pn.POLY||r.closeStroke;if(0===i.length)return;const o=e.points,a=e.indices,l=i.length/2,h=o.length/2;let c=h;for(o.push(i[0],i[1]),n=1;n<l;n++)o.push(i[2*n],i[2*n+1]),a.push(c,c+1),c++;s&&a.push(c,h)}(t,e):function(t,e){const n=t.shape;let r=t.points||n.points.slice();const i=e.closePointEps;if(0===r.length)return;const s=t.lineStyle,o=new mn(r[0],r[1]),a=new mn(r[r.length-2],r[r.length-1]),l=n.type!==pn.POLY||n.closeStroke,h=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){r=r.slice(),h&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));const t=.5*(o.x+a.x),e=.5*(a.y+o.y);r.unshift(t,e),r.push(t,e)}const c=e.points,u=r.length/2;let d=r.length;const f=c.length/2,p=s.width/2,m=p*p,g=s.miterLimit*s.miterLimit;let v=r[0],y=r[1],x=r[2],w=r[3],_=0,b=0,T=-(y-w),S=v-x,A=0,E=0,C=Math.sqrt(T*T+S*S);T/=C,S/=C,T*=p,S*=p;const k=s.alignment,M=2*(1-k),P=2*k;l||(s.cap===Ca.ROUND?d+=Ra(v-T*(M-P)*.5,y-S*(M-P)*.5,v-T*M,y-S*M,v+T*P,y+S*P,c,!0)+2:s.cap===Ca.SQUARE&&(d+=Ia(v,y,T,S,M,P,!0,c))),c.push(v-T*M,y-S*M,v+T*P,y+S*P);for(let t=1;t<u-1;++t){v=r[2*(t-1)],y=r[2*(t-1)+1],x=r[2*t],w=r[2*t+1],_=r[2*(t+1)],b=r[2*(t+1)+1],T=-(y-w),S=v-x,C=Math.sqrt(T*T+S*S),T/=C,S/=C,T*=p,S*=p,A=-(w-b),E=x-_,C=Math.sqrt(A*A+E*E),A/=C,E/=C,A*=p,E*=p;const e=x-v,n=y-w,i=x-_,o=b-w,a=e*i+n*o,l=n*i-o*e,h=l<0;if(Math.abs(l)<.001*Math.abs(a)){c.push(x-T*M,w-S*M,x+T*P,w+S*P),a>=0&&(s.join===Ea.ROUND?d+=Ra(x,w,x-T*M,w-S*M,x-A*M,w-E*M,c,!1)+4:d+=2,c.push(x-A*P,w-E*P,x+A*M,w+E*M));continue}const u=(-T+v)*(-S+w)-(-T+x)*(-S+y),f=(-A+_)*(-E+w)-(-A+x)*(-E+b),k=(e*f-i*u)/l,I=(o*u-n*f)/l,R=(k-x)*(k-x)+(I-w)*(I-w),O=x+(k-x)*M,L=w+(I-w)*M,D=x-(k-x)*P,F=w-(I-w)*P,N=h?M:P,B=R<=Math.min(e*e+n*n,i*i+o*o)+N*N*m;let W=s.join;if(W===Ea.MITER&&R/m>g&&(W=Ea.BEVEL),B)switch(W){case Ea.MITER:c.push(O,L,D,F);break;case Ea.BEVEL:h?c.push(O,L,x+T*P,w+S*P,O,L,x+A*P,w+E*P):c.push(x-T*M,w-S*M,D,F,x-A*M,w-E*M,D,F),d+=2;break;case Ea.ROUND:h?(c.push(O,L,x+T*P,w+S*P),d+=Ra(x,w,x+T*P,w+S*P,x+A*P,w+E*P,c,!0)+4,c.push(O,L,x+A*P,w+E*P)):(c.push(x-T*M,w-S*M,D,F),d+=Ra(x,w,x-T*M,w-S*M,x-A*M,w-E*M,c,!1)+4,c.push(x-A*M,w-E*M,D,F))}else{switch(c.push(x-T*M,w-S*M,x+T*P,w+S*P),W){case Ea.MITER:h?c.push(D,F,D,F):c.push(O,L,O,L),d+=2;break;case Ea.ROUND:d+=h?Ra(x,w,x+T*P,w+S*P,x+A*P,w+E*P,c,!0)+2:Ra(x,w,x-T*M,w-S*M,x-A*M,w-E*M,c,!1)+2}c.push(x-A*M,w-E*M,x+A*P,w+E*P),d+=2}}v=r[2*(u-2)],y=r[2*(u-2)+1],x=r[2*(u-1)],w=r[2*(u-1)+1],T=-(y-w),S=v-x,C=Math.sqrt(T*T+S*S),T/=C,S/=C,T*=p,S*=p,c.push(x-T*M,w-S*M,x+T*P,w+S*P),l||(s.cap===Ca.ROUND?d+=Ra(x-T*(M-P)*.5,w-S*(M-P)*.5,x-T*M,w-S*M,x+T*P,w+S*P,c,!1)+2:s.cap===Ca.SQUARE&&(d+=Ia(x,w,T,S,M,P,!1,c)));const I=e.indices,R=ka.epsilon*ka.epsilon;for(let t=f;t<d+f-2;++t)v=c[2*t],y=c[2*t+1],x=c[2*(t+1)],w=c[2*(t+1)+1],_=c[2*(t+2)],b=c[2*(t+2)+1],!(Math.abs(v*(w-b)+x*(b-y)+_*(y-w))<R)&&I.push(t,t+1,t+2)}(t,e)}class La{static curveLength(t,e,n,r,i,s){const o=t-2*n+i,a=e-2*r+s,l=2*n-2*t,h=2*r-2*e,c=4*(o*o+a*a),u=4*(o*l+a*h),d=l*l+h*h,f=2*Math.sqrt(c+u+d),p=Math.sqrt(c),m=2*c*p,g=2*Math.sqrt(d),v=u/p;return(m*f+p*u*(f-g)+(4*d*c-u*u)*Math.log((2*p+v+f)/(v+g)))/(4*m)}static curveTo(t,e,n,r,i){const s=i[i.length-2],o=i[i.length-1],a=ka._segmentsCount(La.curveLength(s,o,t,e,n,r));let l=0,h=0;for(let c=1;c<=a;++c){const u=c/a;l=s+(t-s)*u,h=o+(e-o)*u,i.push(l+(t+(n-t)*u-l)*u,h+(e+(r-e)*u-h)*u)}}}const Da={[pn.POLY]:Ta,[pn.CIRC]:_a,[pn.ELIP]:_a,[pn.RECT]:Sa,[pn.RREC]:Aa},Fa=[],Na=[];class Ba{constructor(t,e=null,n=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new Ba(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}class Wa{constructor(){this.reset()}begin(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}const Ua=new mn,ja=class t extends cn{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Zi,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Na.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),Fa.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,n=null,r=null){const i=new Ba(t,e,n,r);return this.graphicsData.push(i),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const n=new Ba(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let n=0;n<e.length;++n){const r=e[n];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(t,Ua):Ua.copyFrom(t),r.shape.contains(Ua.x,Ua.y))){let t=!1;if(r.holes)for(let e=0;e<r.holes.length;e++)if(r.holes[e].shape.contains(Ua.x,Ua.y)){t=!0;break}if(!t)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let n=null,r=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],r=n.style);for(let i=this.shapeIndex;i<e.length;i++){this.shapeIndex++;const s=e[i],o=s.fillStyle,a=s.lineStyle;Da[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix),(o.visible||a.visible)&&this.processHoles(s.holes);for(let e=0;e<2;e++){const i=0===e?o:a;if(!i.visible)continue;const l=i.texture.baseTexture,h=this.indices.length,c=this.points.length/2;l.wrapMode=N.REPEAT,0===e?this.processFill(s):this.processLine(s);const u=this.points.length/2-c;0!==u&&(n&&!this._compareStyles(r,i)&&(n.end(h,c),n=null),n||(n=Fa.pop()||new Wa,n.begin(i,h,c),this.batches.push(n),r=i),this.addUvs(this.points,t,i.texture,c,u,i.matrix))}}const i=this.indices.length,s=this.points.length/2;if(n&&n.end(i,s),0===this.batches.length)return void(this.batchable=!0);const o=s>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const e=this.graphicsData[t],n=e.fillStyle,r=e.lineStyle;if(n&&!n.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,n=t.length;e<n;e++){const n=t[e];for(let t=0;t<n.size;t++){const e=n.start+t;this.indicesUint16[e]=this.indicesUint16[e]-n.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<2*t.BATCHABLE_SIZE}buildDrawCalls(){let t=++Je._globalBatch;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Na.push(this.drawCalls[t]);this.drawCalls.length=0;const e=this.colors,n=this.textureIds;let r=Na.pop();r||(r=new tn,r.texArray=new tr),r.texArray.count=0,r.start=0,r.size=0,r.type=I.TRIANGLES;let i=0,s=null,o=0,a=!1,l=I.TRIANGLES,h=0;this.drawCalls.push(r);for(let c=0;c<this.batches.length;c++){const u=this.batches[c],d=8,f=u.style,p=f.texture.baseTexture;a!==!!f.native&&(a=!!f.native,l=a?I.LINES:I.TRIANGLES,s=null,i=d,t++),s!==p&&(s=p,p._batchEnabled!==t&&(i===d&&(t++,i=0,r.size>0&&(r=Na.pop(),r||(r=new tn,r.texArray=new tr),this.drawCalls.push(r)),r.start=h,r.size=0,r.texArray.count=0,r.type=l),p.touched=1,p._batchEnabled=t,p._batchLocation=i,p.wrapMode=N.REPEAT,r.texArray.elements[r.texArray.count++]=p,i++)),r.size+=u.size,h+=u.size,o=p._batchLocation,this.addColors(e,f.color,f.alpha,u.attribSize,u.attribStart),this.addTextureIds(n,o,u.attribSize,u.attribStart)}Je._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(3*t.length*4),s=new Float32Array(i),o=new Uint32Array(i);let a=0;for(let i=0;i<t.length/2;i++)s[a++]=t[2*i],s[a++]=t[2*i+1],s[a++]=e[2*i],s[a++]=e[2*i+1],o[a++]=n[i],s[a++]=r[i];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?Ta.triangulate(t,this):Da[t.type].triangulate(t,this)}processLine(t){Oa(t,this);for(let e=0;e<t.holes.length;e++)Oa(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const n=t[e];Da[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let n=0;n<t.length/2;n++){const r=t[2*n],i=t[2*n+1];t[2*n]=e.a*r+e.c*i+e.tx,t[2*n+1]=e.b*r+e.d*i+e.ty}}addColors(t,e,n,r,i=0){const s=ee.shared.setValue(e).toLittleEndianNumber(),o=ee.shared.setValue(s).toPremultiplied(n);t.length=Math.max(t.length,i+r);for(let e=0;e<r;e++)t[i+e]=o}addTextureIds(t,e,n,r=0){t.length=Math.max(t.length,r+n);for(let i=0;i<n;i++)t[r+i]=e}addUvs(t,e,n,r,i,s=null){let o=0;const a=e.length,l=n.frame;for(;o<i;){let n=t[2*(r+o)],i=t[2*(r+o)+1];if(s){const t=s.a*n+s.c*i+s.tx;i=s.b*n+s.d*i+s.ty,n=t}o++,e.push(n/l.width,i/l.height)}const h=n.baseTexture;(l.width<h.width||l.height<h.height)&&this.adjustUvs(e,n,a,i)}adjustUvs(t,e,n,r){const i=e.baseTexture,s=1e-6,o=n+2*r,a=e.frame,l=a.width/i.width,h=a.height/i.height;let c=a.x/a.width,u=a.y/a.height,d=Math.floor(t[n]+s),f=Math.floor(t[n+1]+s);for(let e=n+2;e<o;e+=2)d=Math.min(d,Math.floor(t[e]+s)),f=Math.min(f,Math.floor(t[e+1]+s));c-=d,u-=f;for(let e=n;e<o;e+=2)t[e]=(t[e]+c)*l,t[e+1]=(t[e+1]+u)*h}};ja.BATCHABLE_SIZE=100;let Ha=ja;class za{constructor(){this.color=16777215,this.alpha=1,this.texture=vr.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new za;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=vr.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Ga extends za{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Ca.BUTT,this.join=Ea.MITER,this.miterLimit=10}clone(){const t=new Ga;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Ca.BUTT,this.join=Ea.MITER,this.miterLimit=10}}const Va={},Xa=class t extends rs{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new za,this._lineStyle=new Ga,this._matrix=null,this._holeMode=!1,this.state=Ve.for2d(),this._geometry=t||new Ha,this._geometry.refCount++,this._transformID=-1,this._tintColor=new ee(16777215),this.blendMode=P.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new t(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,n,r=.5,i=!1){return"number"==typeof t&&(t={width:t,color:e,alpha:n,alignment:r,native:i}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:vr.WHITE,color:t?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Ca.BUTT,join:Ea.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.width>0&&t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:n},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new wn,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new wn,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return(r!==t||i!==e)&&n.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,n,r){this._initCurve();const i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),La.curveTo(t,e,n,r,i),this}bezierCurveTo(t,e,n,r,i,s){return this._initCurve(),Pa.curveTo(t,e,n,r,i,s,this.currentPath.points),this}arcTo(t,e,n,r,i){this._initCurve(t,e);const s=this.currentPath.points,o=Ma.curveTo(t,e,n,r,i,s);if(o){const{cx:t,cy:e,radius:n,startAngle:r,endAngle:i,anticlockwise:s}=o;this.arc(t,e,n,r,i,s)}return this}arc(t,e,n,r,i,s=!1){if(r===i)return this;if(!s&&i<=r?i+=un:s&&r<=i&&(r+=un),i-r==0)return this;const o=t+Math.cos(r)*n,a=e+Math.sin(r)*n,l=this._geometry.closePointEps;let h=this.currentPath?this.currentPath.points:null;if(h){const t=Math.abs(h[h.length-2]-o),e=Math.abs(h[h.length-1]-a);t<l&&e<l||h.push(o,a)}else this.moveTo(o,a),h=this.currentPath.points;return Ma.arc(o,a,t,e,n,r,i,s,h),this}beginFill(t=0,e){return this.beginTextureFill({texture:vr.WHITE,color:t,alpha:e})}normalizeColor(t){const e=ee.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:vr.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:n},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,n,r){return this.drawShape(new vn(t,e,n,r))}drawRoundedRect(t,e,n,r,i){return this.drawShape(new _n(t,e,n,r,i))}drawCircle(t,e,n){return this.drawShape(new yn(t,e,n))}drawEllipse(t,e,n,r){return this.drawShape(new xn(t,e,n,r))}drawPolygon(...t){let e,n=!0;const r=t[0];r.points?(n=r.closeStroke,e=r.points):e=Array.isArray(t[0])?t[0]:t;const i=new wn(e);return i.closeStroke=n,this.drawShape(i),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==pn.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(let r=0;r<n;r++){const n=t.batches[r],i=n.style.color,s=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),o=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),a={vertexData:s,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:o,_batchRGB:ee.shared.setValue(i).toRgbArray(),_tintRGB:i,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=a}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,n=this.batches.length;e<n;e++){const n=this.batches[e];n.worldAlpha=this.worldAlpha*n.alpha,t.plugins[this.pluginName].render(n)}}}_renderDirect(t){const e=this._resolveDirectShader(t),n=this._geometry,r=this.worldAlpha,i=e.uniforms,s=n.drawCalls;i.translationMatrix=this.transform.worldTransform,ee.shared.setValue(this._tintColor).premultiply(r).toArray(i.tint),t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(let e=0,r=s.length;e<r;e++)this._renderDrawCallDirect(t,n.drawCalls[e])}_renderDrawCallDirect(t,e){const{texArray:n,type:r,size:i,start:s}=e,o=n.count;for(let e=0;e<o;e++)t.texture.bind(n.elements[e],e);t.geometry.draw(r,i,s)}_resolveDirectShader(t){let e=this.shader;const n=this.pluginName;if(!e){if(!Va[n]){const{maxTextures:e}=t.plugins[n],r=new Int32Array(e);for(let t=0;t<e;t++)r[t]=t;const i={tint:new Float32Array([1,1,1,1]),translationMatrix:new bn,default:Zn.from({uSamplers:r},!0)},s=t.plugins[n]._shader.program;Va[n]=new Qn(s,i)}e=Va[n]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:n,maxX:r,maxY:i}=t.bounds;this._bounds.addFrame(this.transform,e,n,r,i)}containsPoint(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=ee.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty,l=this._geometry.points,h=this.vertexData;let c=0;for(let t=0;t<l.length;t+=2){const e=l[t],u=l[t+1];h[c++]=n*e+i*u+o,h[c++]=s*u+r*e+a}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};Xa.curves=ka,Xa._TEMP_POINT=new mn;let Ya=Xa;class $a{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const qa=new mn,Ka=new wn,Za=class t extends rs{constructor(t,e,n,r=I.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=n||Ve.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=Y.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(e){const n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===I.TRIANGLES&&n.length<2*t.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const r=this.transform.worldTransform,i=r.a,s=r.b,o=r.c,a=r.d,l=r.tx,h=r.ty,c=this.vertexData;for(let t=0;t<c.length/2;t++){const n=e[2*t],r=e[2*t+1];c[2*t]=i*n+o*r+l,c[2*t+1]=s*n+a*r+h}if(this._roundPixels){const t=Y.RESOLUTION;for(let e=0;e<c.length;++e)c[e]=Math.round(c[e]*t)/t}this.vertexDirty=n}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new $a(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,qa);const e=this.geometry.getBuffer("aVertexPosition").data,n=Ka.points,r=this.geometry.getIndex().data,i=r.length,s=4===this.drawMode?3:1;for(let t=0;t+2<i;t+=s){const i=2*r[t],s=2*r[t+1],o=2*r[t+2];if(n[0]=e[i],n[1]=e[i+1],n[2]=e[s],n[3]=e[s+1],n[4]=e[o],n[5]=e[o+1],Ka.contains(qa.x,qa.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};Za.BATCHABLE_SIZE=100;let Qa=Za;class Ja extends hn{constructor(t,e,n){super();const r=new nn(t),i=new nn(e,!0),s=new nn(n,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,L.FLOAT).addAttribute("aTextureCoord",i,2,!1,L.FLOAT).addIndex(s),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}class tl extends Qn{constructor(t,e){const n={uSampler:t,alpha:1,uTextureMatrix:bn.IDENTITY,uColor:new Float32Array([1,1,1,1])};(e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e)).uniforms&&Object.assign(n,e.uniforms),super(e.program||qn.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),n),this._colorDirty=!1,this.uvMatrix=new Rr(t),this.batchable=void 0===e.program,this.pluginName=e.pluginName,this._tintColor=new ee(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;ee.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class el extends Ja{constructor(t=100,e=100,n=10,r=10){super(),this.segWidth=n,this.segHeight=r,this.width=t,this.height=e,this.build()}build(){const t=this.segWidth*this.segHeight,e=[],n=[],r=[],i=this.segWidth-1,s=this.segHeight-1,o=this.width/i,a=this.height/s;for(let r=0;r<t;r++){const t=r%this.segWidth,l=r/this.segWidth|0;e.push(t*o,l*a),n.push(t/i,l/s)}const l=i*s;for(let t=0;t<l;t++){const e=t%i,n=t/i|0,s=n*this.segWidth+e,o=n*this.segWidth+e+1,a=(n+1)*this.segWidth+e,l=(n+1)*this.segWidth+e+1;r.push(s,o,a,o,l,a)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class nl extends Ja{constructor(t=200,e,n=0){super(new Float32Array(4*e.length),new Float32Array(4*e.length),new Uint16Array(6*(e.length-1))),this.points=e,this._width=t,this.textureScale=n,this.build()}get width(){return this._width}build(){const t=this.points;if(!t)return;const e=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),r=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),n.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));const i=n.data,s=r.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;let o=0,a=t[0];const l=this._width*this.textureScale,h=t.length;for(let e=0;e<h;e++){const n=4*e;if(this.textureScale>0){const n=a.x-t[e].x,r=a.y-t[e].y,i=Math.sqrt(n*n+r*r);a=t[e],o+=i/l}else o=e/(h-1);i[n]=o,i[n+1]=0,i[n+2]=o,i[n+3]=1}let c=0;for(let t=0;t<h-1;t++){const e=2*t;s[c++]=e,s[c++]=e+1,s[c++]=e+2,s[c++]=e+2,s[c++]=e+1,s[c++]=e+3}n.update(),r.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let e,n=t[0],r=0,i=0;const s=this.buffers[0].data,o=t.length,a=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let l=0;l<o;l++){const h=t[l],c=4*l;e=l<t.length-1?t[l+1]:h,i=-(e.x-n.x),r=e.y-n.y;let u=10*(1-l/(o-1));u>1&&(u=1);const d=Math.sqrt(r*r+i*i);d<1e-6?(r=0,i=0):(r/=d,i/=d,r*=a,i*=a),s[c]=h.x+r,s[c+1]=h.y+i,s[c+2]=h.x-r,s[c+3]=h.y-i,n=h}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class rl extends Qa{constructor(t,e,n){super(new el(t.width,t.height,e,n),new tl(vr.WHITE)),this.texture=t,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const t=this.geometry,{width:e,height:n}=this.shader.texture;this.autoResize&&(t.width!==e||t.height!==n)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}set texture(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(t)}destroy(t){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(t)}}class il extends rl{constructor(t,e,n,r,i){super(vr.WHITE,4,4),this._origWidth=t.orig.width,this._origHeight=t.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=e??t.defaultBorders?.left??10,this._rightWidth=r??t.defaultBorders?.right??10,this._topHeight=n??t.defaultBorders?.top??10,this._bottomHeight=i??t.defaultBorders?.bottom??10,this.texture=t}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}updateHorizontalVertices(){const t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height}updateVerticalVertices(){const t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width}_getMinScale(){const t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,r=this._height>n?1:this._height/n;return Math.min(e,r)}get width(){return this._width}set width(t){this._width=t,this._refresh()}get height(){return this._height}set height(t){this._height=t,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this._refresh()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this._refresh()}_refresh(){const t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;const n=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class sl extends Qa{constructor(t=vr.EMPTY,e,n,r,i){const s=new Ja(e,n,r);s.getBuffer("aVertexPosition").static=!1,super(s,new tl(t),null,i),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class ol{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function al(t,e){let n=!1;if(t?._textures?.length)for(let r=0;r<t._textures.length;r++)if(t._textures[r]instanceof vr){const i=t._textures[r].baseTexture;e.includes(i)||(e.push(i),n=!0)}return n}function ll(t,e){if(t.baseTexture instanceof Je){const n=t.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function hl(t,e){if(t._texture&&t._texture instanceof vr){const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function cl(t,e){return e instanceof Ms&&(e.updateText(!0),!0)}function ul(t,e){if(e instanceof Ss){const t=e.toFontString();return _s.measureFont(t),!0}return!1}function dl(t,e){if(t instanceof Ms){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function fl(t,e){return t instanceof Ss&&(e.includes(t)||e.push(t),!0)}const pl=class t{constructor(e){this.limiter=new ol(t.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(dl),this.registerFindHook(fl),this.registerFindHook(al),this.registerFindHook(ll),this.registerFindHook(hl),this.registerUploadHook(cl),this.registerUploadHook(ul)}upload(t){return new Promise((e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,_i.system.addOnce(this.tick,this,yi.UTILITY))):e()}))}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed)for(let n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)_i.system.addOnce(this.tick,this,yi.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,n=t.length;e<n;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof rs)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&_i.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};pl.uploadsPerFrame=4;let ml=pl;function gl(t,e){return e instanceof Je&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function vl(t,e){if(!(e instanceof Ya))return!1;const{geometry:n}=e;e.finishPoly(),n.updateBatches();const{batches:r}=n;for(let e=0;e<r.length;e++){const{texture:n}=r[e].style;n&&gl(t,n.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function yl(t,e){return t instanceof Ya&&(e.push(t),!0)}Object.defineProperties(Y,{UPLOADS_PER_FRAME:{get(){return ml.uploadsPerFrame},set(t){gt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),ml.uploadsPerFrame=t}}});class xl extends ml{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(yl),this.registerUploadHook(gl),this.registerUploadHook(vl)}}xl.extension={name:"prepare",type:Be.RendererSystem},je.add(xl);class wl extends os{constructor(t,e=!0){super(t[0]instanceof vr?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(_i.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(_i.shared.add(this.update,this,yi.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){let n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];const r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let n=0;n<t.length;++n)e.push(vr.from(t[n]));return new wl(e)}static fromImages(t){const e=[];for(let n=0;n<t.length;++n)e.push(vr.from(t[n]));return new wl(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof vr)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(_i.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(_i.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const _l=class t{constructor(t,e,n){this.linkedSheets=[],(t instanceof Je||t instanceof vr)&&(t={texture:t,data:e,resolutionFilename:n});const{texture:r,data:i,resolutionFilename:s=null,cachePrefix:o=""}=t;this.cachePrefix=o,this._texture=r instanceof vr?r:null,this.baseTexture=r instanceof Je?r:this._texture.baseTexture,this.textures={},this.animations={},this.data=i;const a=this.baseTexture.resource;this.resolution=this._updateResolution(s||(a?a.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let n=Ne(t,null);return null===n&&(n="number"==typeof e?e:parseFloat(e??"1")),1!==n&&this.baseTexture.setResolution(n),n}parse(){return new Promise((e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(e){let n=e;const r=t.BATCH_SIZE;for(;n-e<r&&n<this._frameKeys.length;){const t=this._frameKeys[n],e=this._frames[t],r=e.frame;if(r){let n=null,i=null;const s=!1!==e.trimmed&&e.sourceSize?e.sourceSize:e.frame,o=new vn(0,0,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution);n=e.rotated?new vn(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.h)/this.resolution,Math.floor(r.w)/this.resolution):new vn(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution),!1!==e.trimmed&&e.spriteSourceSize&&(i=new vn(Math.floor(e.spriteSourceSize.x)/this.resolution,Math.floor(e.spriteSourceSize.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution)),this.textures[t]=new vr(this.baseTexture,n,o,i,e.rotated?2:0,e.anchor,e.borders),vr.addToCache(this.textures[t],this.cachePrefix+t.toString())}n++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let n=0;n<t[e].length;n++){const r=t[e][n];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*t.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(t=!1){for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};_l.BATCH_SIZE=1e3;let bl=_l;const Tl=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function Sl(t,e,n){const r={};if(t.forEach((t=>{r[t]=e})),Object.keys(e.textures).forEach((t=>{r[`${e.cachePrefix}${t}`]=e.textures[t]})),!n){const n=wt.dirname(t[0]);e.linkedSheets.forEach(((t,i)=>{Object.assign(r,Sl([`${n}/${e.data.meta.related_multi_packs[i]}`],t,!0))}))}return r}const Al={extension:Be.Asset,cache:{test:t=>t instanceof bl,getCacheableAssets:(t,e)=>Sl(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),n=e.pop(),r=e.pop();return"json"===n&&Tl.includes(r)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(Y.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:Be.LoadParser,priority:ao.Normal},async testParse(t,e){return".json"===wt.extname(e.src).toLowerCase()&&!!t.frames},async parse(t,e,n){const{texture:r,imageFilename:i,cachePrefix:s}=e?.data??{};let o,a=wt.dirname(e.src);if(a&&a.lastIndexOf("/")!==a.length-1&&(a+="/"),r&&r.baseTexture)o=r;else{const r=qo(a+(i??t.meta.image),e.src);o=(await n.load([r]))[r]}const l=new bl({texture:o.baseTexture,data:t,resolutionFilename:e.src,cachePrefix:s});await l.parse();const h=t?.meta?.related_multi_packs;if(Array.isArray(h)){const t=[];for(const r of h){if("string"!=typeof r)continue;let i=a+r;e.data?.ignoreMultiPack||(i=qo(i,e.src),t.push(n.load({src:i,data:{ignoreMultiPack:!0}})))}const r=await Promise.all(t);l.linkedSheets=r,r.forEach((t=>{t.linkedSheets=[l].concat(l.linkedSheets.filter((e=>e!==t)))}))}return l},unload(t){t.destroy(!0)}}};je.add(Al);class El{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Cl{static test(t){return"string"==typeof t&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const t in e){const r=e[t].match(/^[a-z]+/gm)[0],i=e[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(const t in i){const e=i[t].split("="),n=e[0],r=e[1].replace(/"/gm,""),o=parseFloat(r),a=isNaN(o)?r:o;s[n]=a}n[r].push(s)}const r=new El;return n.info.forEach((t=>r.info.push({face:t.face,size:parseInt(t.size,10)}))),n.common.forEach((t=>r.common.push({lineHeight:parseInt(t.lineHeight,10)}))),n.page.forEach((t=>r.page.push({id:parseInt(t.id,10),file:t.file}))),n.char.forEach((t=>r.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)}))),n.kerning.forEach((t=>r.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)}))),n.distanceField.forEach((t=>r.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType}))),r}}class kl{static test(t){const e=t;return"string"!=typeof t&&"getElementsByTagName"in t&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")}static parse(t){const e=new El,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),a=t.getElementsByTagName("distanceField");for(let t=0;t<n.length;t++)e.info.push({face:n[t].getAttribute("face"),size:parseInt(n[t].getAttribute("size"),10)});for(let t=0;t<r.length;t++)e.common.push({lineHeight:parseInt(r[t].getAttribute("lineHeight"),10)});for(let t=0;t<i.length;t++)e.page.push({id:parseInt(i[t].getAttribute("id"),10)||0,file:i[t].getAttribute("file")});for(let t=0;t<s.length;t++){const n=s[t];e.char.push({id:parseInt(n.getAttribute("id"),10),page:parseInt(n.getAttribute("page"),10)||0,x:parseInt(n.getAttribute("x"),10),y:parseInt(n.getAttribute("y"),10),width:parseInt(n.getAttribute("width"),10),height:parseInt(n.getAttribute("height"),10),xoffset:parseInt(n.getAttribute("xoffset"),10),yoffset:parseInt(n.getAttribute("yoffset"),10),xadvance:parseInt(n.getAttribute("xadvance"),10)})}for(let t=0;t<o.length;t++)e.kerning.push({first:parseInt(o[t].getAttribute("first"),10),second:parseInt(o[t].getAttribute("second"),10),amount:parseInt(o[t].getAttribute("amount"),10)});for(let t=0;t<a.length;t++)e.distanceField.push({fieldType:a[t].getAttribute("fieldType"),distanceRange:parseInt(a[t].getAttribute("distanceRange"),10)});return e}}class Ml{static test(t){return!("string"!=typeof t||!t.includes("<font>"))&&kl.test(Y.ADAPTER.parseXML(t))}static parse(t){return kl.parse(Y.ADAPTER.parseXML(t))}}const Pl=[Cl,kl,Ml];function Il(t,e,n,r,i,s,o){const a=n.text,l=n.fontProperties;e.translate(r,i),e.scale(s,s);const h=o.strokeThickness/2,c=-o.strokeThickness/2;if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=function(t,e,n,r,i,s){const o=n.fill;if(!Array.isArray(o))return o;if(1===o.length)return o[0];let a;const l=n.dropShadow?n.dropShadowDistance:0,h=n.padding||0,c=t.width/r-l-2*h,u=t.height/r-l-2*h,d=o.slice(),f=n.fillGradientStops.slice();if(!f.length){const t=d.length+1;for(let e=1;e<t;++e)f.push(e/t)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),n.fillGradientType===ys.LINEAR_VERTICAL){a=e.createLinearGradient(c/2,h,c/2,u+h);let t=0;const r=(s.fontProperties.fontSize+n.strokeThickness)/u;for(let e=0;e<i.length;e++){const n=s.lineHeight*e;for(let e=0;e<d.length;e++){let i=0;i="number"==typeof f[e]?f[e]:e/d.length;const s=n/u+i*r;let o=Math.max(t,s);o=Math.min(o,1),a.addColorStop(o,d[e]),t=o}}}else{a=e.createLinearGradient(h,u/2,c+h,u/2);const t=d.length+1;let n=1;for(let e=0;e<d.length;e++){let r;r="number"==typeof f[e]?f[e]:n/t,a.addColorStop(r,d[e]),n++}}return a}(t,e,o,s,[a],n),e.strokeStyle=o.stroke,o.dropShadow){const t=o.dropShadowColor,n=o.dropShadowBlur*s,r=o.dropShadowDistance*s;e.shadowColor=ee.shared.setValue(t).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=n,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*r,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*r}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,h,c+n.lineHeight-l.descent),o.fill&&e.fillText(a,h,c+n.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Rl(t){return Array.from?Array.from(t):t.split("")}function Ol(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}const Ll=class t{constructor(t,e,n){const[r]=t.info,[i]=t.common,[s]=t.page,[o]=t.distanceField,a=Ne(s.file),l={};this._ownsTextures=n,this.font=r.face,this.size=r.size,this.lineHeight=i.lineHeight/a,this.chars={},this.pageTextures=l;for(let n=0;n<t.page.length;n++){const{id:r,file:i}=t.page[n];l[r]=e instanceof Array?e[n]:e[i],o?.fieldType&&"none"!==o.fieldType&&(l[r].baseTexture.alphaMode=W.NO_PREMULTIPLIED_ALPHA,l[r].baseTexture.mipmap=B.OFF)}for(let e=0;e<t.char.length;e++){const{id:n,page:r}=t.char[e];let{x:i,y:s,width:o,height:h,xoffset:c,yoffset:u,xadvance:d}=t.char[e];i/=a,s/=a,o/=a,h/=a,c/=a,u/=a,d/=a;const f=new vn(i+l[r].frame.x/a,s+l[r].frame.y/a,o,h);this.chars[n]={xOffset:c,yOffset:u,xAdvance:d,kerning:{},texture:new vr(l[r].baseTexture,f),page:r}}for(let e=0;e<t.kerning.length;e++){let{first:n,second:r,amount:i}=t.kerning[e];n/=a,r/=a,i/=a,this.chars[r]&&(this.chars[r].kerning[n]=i)}this.distanceFieldRange=o?.distanceRange,this.distanceFieldType=o?.fieldType?.toLowerCase()??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(e,n,r){let i;if(e instanceof El)i=e;else{const t=function(t){for(let e=0;e<Pl.length;e++)if(Pl[e].test(t))return Pl[e];return null}(e);if(!t)throw new Error("Unrecognized data format for font.");i=t.parse(e)}n instanceof vr&&(n=[n]);const s=new t(i,n,r);return t.available[s.font]=s,s}static uninstall(e){const n=t.available[e];if(!n)throw new Error(`No font found named '${e}'`);n.destroy(),delete t.available[e]}static from(e,n,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:s,resolution:o,textureWidth:a,textureHeight:l,...h}=Object.assign({},t.defaultOptions,r),c=function(t){"string"==typeof t&&(t=[t]);const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];if(Array.isArray(r)){if(2!==r.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const t=r[0].charCodeAt(0),n=r[1].charCodeAt(0);if(n<t)throw new Error("[BitmapFont]: Invalid character range.");for(let r=t,i=n;r<=i;r++)e.push(String.fromCharCode(r))}else e.push(...Rl(r))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(i),u=n instanceof Ss?n:new Ss(n),d=a,f=new El;f.info[0]={face:u.fontFamily,size:u.fontSize},f.common[0]={lineHeight:u.fontSize};let p,m,g,v=0,y=0,x=0;const w=[],_=[];for(let t=0;t<c.length;t++){p||(p=Y.ADAPTER.createCanvas(),p.width=a,p.height=l,m=p.getContext("2d"),g=new Je(p,{resolution:o,...h}),w.push(g),_.push(new vr(g)),f.page.push({id:_.length-1,file:""}));const e=c[t],n=_s.measureText(e,u,!1,p),r=n.width,i=Math.ceil(n.height),b=Math.ceil(("italic"===u.fontStyle?2:1)*r);if(y>=l-i*o){if(0===y)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${e}')`);--t,p=null,m=null,g=null,y=0,v=0,x=0;continue}if(x=Math.max(i+n.fontProperties.descent,x),b*o+v>=d){if(0===v)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${e}')`);--t,y+=x*o,y=Math.ceil(y),v=0,x=0;continue}Il(p,m,n,v,y,o,u);const T=Ol(n.text);f.char.push({id:T,page:_.length-1,x:v/o,y:y/o,width:b,height:i,xoffset:0,yoffset:0,xadvance:r-(u.dropShadow?u.dropShadowDistance:0)-(u.stroke?u.strokeThickness:0)}),v+=(b+2*s)*o,v=Math.ceil(v)}if(!r?.skipKerning)for(let t=0,e=c.length;t<e;t++){const n=c[t];for(let t=0;t<e;t++){const e=c[t],r=m.measureText(n).width,i=m.measureText(e).width,s=m.measureText(n+e).width-(r+i);s&&f.kerning.push({first:Ol(n),second:Ol(e),amount:s})}}const b=new t(f,_,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=b,b}};Ll.ALPHA=[["a","z"],["A","Z"]," "],Ll.NUMERIC=[["0","9"]],Ll.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Ll.ASCII=[[" ","~"]],Ll.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Ll.ALPHANUMERIC},Ll.available={};let Dl=Ll;const Fl=[],Nl=[],Bl=[];(class t extends rs{constructor(e,n={}){super();const{align:r,tint:i,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},t.styleDefaults,n);if(!Dl.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=r,this._tintColor=new ee(i),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new In((()=>{this.dirty=!0}),this,0,0),this._roundPixels=Y.ROUND_PIXELS,this.dirty=!0,this._resolution=Y.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const t=Dl.available[this._fontName],e=this.fontSize,n=e/t.size,r=new mn,i=[],s=[],o=[],a=Rl(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),l=this._maxWidth*t.size/e,h="none"===t.distanceFieldType?Fl:Nl;let c=null,u=0,d=0,f=0,p=-1,m=0,g=0,v=0,y=0;for(let e=0;e<a.length;e++){const n=a[e],h=Ol(n);if(/(?:\s)/.test(n)&&(p=e,m=u,y++),"\r"===n||"\n"===n){s.push(u),o.push(-1),d=Math.max(d,u),++f,++g,r.x=0,r.y+=t.lineHeight,c=null,y=0;continue}const x=t.chars[h];if(!x)continue;c&&x.kerning[c]&&(r.x+=x.kerning[c]);const w=Bl.pop()||{texture:vr.EMPTY,line:0,charCode:0,prevSpaces:0,position:new mn};w.texture=x.texture,w.line=f,w.charCode=h,w.position.x=Math.round(r.x+x.xOffset+this._letterSpacing/2),w.position.y=Math.round(r.y+x.yOffset),w.prevSpaces=y,i.push(w),u=w.position.x+Math.max(x.xAdvance-x.xOffset,x.texture.orig.width),r.x+=x.xAdvance+this._letterSpacing,v=Math.max(v,x.yOffset+x.texture.height),c=h,-1!==p&&l>0&&r.x>l&&(++g,xe(i,1+p-g,1+e-p),e=p,p=-1,s.push(m),o.push(i.length>0?i[i.length-1].prevSpaces:0),d=Math.max(d,m),f++,r.x=0,r.y+=t.lineHeight,c=null,y=0)}const x=a[a.length-1];"\r"!==x&&"\n"!==x&&(/(?:\s)/.test(x)&&(u=m),s.push(u),d=Math.max(d,u),o.push(-1));const w=[];for(let t=0;t<=f;t++){let e=0;"right"===this._align?e=d-s[t]:"center"===this._align?e=(d-s[t])/2:"justify"===this._align&&(e=o[t]<0?0:(d-s[t])/o[t]),w.push(e)}const _=i.length,b={},T=[],S=this._activePagesMeshData;h.push(...S);for(let e=0;e<_;e++){const n=i[e].texture,r=n.baseTexture.uid;if(!b[r]){let e=h.pop();if(!e){const n=new Ja;let r,i;"none"===t.distanceFieldType?(r=new tl(vr.EMPTY),i=P.NORMAL):(r=new tl(vr.EMPTY,{program:qn.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n"),uniforms:{uFWidth:0}}),i=P.NORMAL_NPM);const s=new Qa(n,r);s.blendMode=i,e={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:s,vertices:null,uvs:null,indices:null}}e.index=0,e.indexCount=0,e.vertexCount=0,e.uvsCount=0,e.total=0;const{_textureCache:i}=this;i[r]=i[r]||new vr(n.baseTexture),e.mesh.texture=i[r],e.mesh.tint=this._tintColor.value,T.push(e),b[r]=e}b[r].total++}for(let t=0;t<S.length;t++)T.includes(S[t])||this.removeChild(S[t].mesh);for(let t=0;t<T.length;t++)T[t].mesh.parent!==this&&this.addChild(T[t].mesh);this._activePagesMeshData=T;for(const t in b){const e=b[t],n=e.total;if(!(e.indices?.length>6*n)||e.vertices.length<2*Qa.BATCHABLE_SIZE)e.vertices=new Float32Array(8*n),e.uvs=new Float32Array(8*n),e.indices=new Uint16Array(6*n);else{const t=e.total,n=e.vertices;for(let e=4*t*2;e<n.length;e++)n[e]=0}e.mesh.size=6*n}for(let t=0;t<_;t++){const e=i[t];let r=e.position.x+w[e.line]*("justify"===this._align?e.prevSpaces:1);this._roundPixels&&(r=Math.round(r));const s=r*n,o=e.position.y*n,a=e.texture,l=b[a.baseTexture.uid],h=a.frame,c=a._uvs,u=l.index++;l.indices[6*u+0]=0+4*u,l.indices[6*u+1]=1+4*u,l.indices[6*u+2]=2+4*u,l.indices[6*u+3]=0+4*u,l.indices[6*u+4]=2+4*u,l.indices[6*u+5]=3+4*u,l.vertices[8*u+0]=s,l.vertices[8*u+1]=o,l.vertices[8*u+2]=s+h.width*n,l.vertices[8*u+3]=o,l.vertices[8*u+4]=s+h.width*n,l.vertices[8*u+5]=o+h.height*n,l.vertices[8*u+6]=s,l.vertices[8*u+7]=o+h.height*n,l.uvs[8*u+0]=c.x0,l.uvs[8*u+1]=c.y0,l.uvs[8*u+2]=c.x1,l.uvs[8*u+3]=c.y1,l.uvs[8*u+4]=c.x2,l.uvs[8*u+5]=c.y2,l.uvs[8*u+6]=c.x3,l.uvs[8*u+7]=c.y3}this._textWidth=d*n,this._textHeight=(r.y+t.lineHeight)*n;for(const t in b){const e=b[t];if(0!==this.anchor.x||0!==this.anchor.y){let t=0;const n=this._textWidth*this.anchor.x,r=this._textHeight*this.anchor.y;for(let i=0;i<e.total;i++)e.vertices[t++]-=n,e.vertices[t++]-=r,e.vertices[t++]-=n,e.vertices[t++]-=r,e.vertices[t++]-=n,e.vertices[t++]-=r,e.vertices[t++]-=n,e.vertices[t++]-=r}this._maxLineHeight=v*n;const r=e.mesh.geometry.getBuffer("aVertexPosition"),i=e.mesh.geometry.getBuffer("aTextureCoord"),s=e.mesh.geometry.getIndex();r.data=e.vertices,i.data=e.uvs,s.data=e.indices,r.update(),i.update(),s.update()}for(let t=0;t<i.length;t++)Bl.push(i[t]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:n,size:r}=Dl.available[this._fontName];if("none"!==n){const{a:n,b:i,c:s,d:o}=this.worldTransform,a=Math.sqrt(n*n+i*i),l=Math.sqrt(s*s+o*o),h=(Math.abs(a)+Math.abs(l))/2,c=this.fontSize/r,u=t._view.resolution;for(const t of this._activePagesMeshData)t.mesh.shader.uniforms.uFWidth=h*e*c*u}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=Dl.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!Dl.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??Dl.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,n="none"===Dl.available[this._fontName].distanceFieldType?Fl:Nl;n.push(...this._activePagesMeshData);for(const t of this._activePagesMeshData)this.removeChild(t.mesh);this._activePagesMeshData=[],n.filter((t=>e[t.mesh.texture.baseTexture.uid])).forEach((t=>{t.mesh.texture=vr.EMPTY}));for(const t in e)e[t].destroy(),delete e[t];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}}).styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const Wl=[".xml",".fnt"],Ul={extension:{type:Be.LoadParser,priority:ao.Normal},name:"loadBitmapFont",test(t){return Wl.includes(wt.extname(t).toLowerCase())},async testParse(t){return Cl.test(t)||Ml.test(t)},async parse(t,e,n){const r=Cl.test(t)?Cl.parse(t):Ml.parse(t),{src:i}=e,{page:s}=r,o=[];for(let t=0;t<s.length;++t){const e=s[t].file;let n=wt.join(wt.dirname(i),e);n=qo(n,i),o.push(n)}const a=await n.load(o),l=o.map((t=>a[t]));return Dl.install(r,l,!0)},async load(t,e){return(await Y.ADAPTER.fetch(t)).text()},unload(t){t.destroy()}};je.add(Ul);const jl=class t extends Ss{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new t(Object.keys(t.defaultOptions).reduce(((t,n)=>({...t,[n]:e[n]})),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach((e=>{URL.revokeObjectURL(e.src),e.refs--,0===e.refs&&(e.fontFace&&document.fonts.delete(e.fontFace),delete t.availableFonts[e.originalUrl])})),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,n={}){const{availableFonts:r}=t;if(r[e]){const t=r[e];return this._fonts.push(t),t.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return Y.ADAPTER.fetch(e).then((t=>t.blob())).then((async t=>new Promise(((e,n)=>{const r=URL.createObjectURL(t),i=new FileReader;i.onload=()=>e([r,i.result]),i.onerror=n,i.readAsDataURL(t)})))).then((async([t,i])=>{const s=Object.assign({family:wt.basename(e,wt.extname(e)),weight:"normal",style:"normal",display:"auto",src:t,dataSrc:i,refs:1,originalUrl:e,fontFace:null},n);r[e]=s,this._fonts.push(s),this.styleID++;const o=new FontFace(s.family,`url(${s.src})`,{weight:s.weight,style:s.style,display:s.display});s.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0}))}addOverride(...t){const e=t.filter((t=>!this._overrides.includes(t)));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter((t=>this._overrides.includes(t)));e.length>0&&(this._overrides=this._overrides.filter((t=>!e.includes(t))),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce(((t,e)=>`${t}\n            @font-face {\n                font-family: "${e.family}";\n                src: url('${e.dataSrc}');\n                font-weight: ${e.weight};\n                font-style: ${e.style};\n                font-display: ${e.display};\n            }`),this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=se(t)),"number"==typeof t?re(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(255*e|0).toString(16).padStart(2,"0"));const i=`${n}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${i} ${t}`}reset(){Object.assign(this,t.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise((t=>setTimeout(t,100))):Promise.resolve()}get isSafari(){const{userAgent:t}=Y.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};jl.availableFonts={},jl.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Hl=jl;const zl=class t extends os{constructor(e="",n={}){super(vr.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const r=new Image,i=vr.from(r,{scaleMode:Y.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new vn,i.trim=new vn,this.texture=i;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),h=document.createElementNS(o,"div"),c=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=t.defaultMaxWidth,this.maxHeight=t.defaultMaxHeight,this._domElement=h,this._styleElement=c,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(c),this._foreignObject.appendChild(h),this._image=r,this._loadImage=new Image,this._autoResolution=t.defaultAutoResolution,this._resolution=t.defaultResolution??Y.RESOLUTION,this.text=e,this.style=n}measureText(t){const{text:e,style:n,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:n.toCSS(r)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const i=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:s,height:o}=i;(s>this.maxWidth||o>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const a=Math.min(this.maxWidth,Math.ceil(s)),l=Math.min(this.maxHeight,Math.ceil(o));return this._svgRoot.setAttribute("width",a.toString()),this._svgRoot.setAttribute("height",l.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(r)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:a+2*n.padding,height:l+2*n.padding}}async updateText(t=!0){const{style:e,_image:n,_loadImage:r}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:i,height:s}=this.measureText();n.width=r.width=Math.ceil(Math.max(1,i)),n.height=r.height=Math.ceil(Math.max(1,s)),this._updateID++;const o=this._updateID;await new Promise((t=>{r.onload=async()=>{o<this._updateID||(await e.onBeforeDraw(),n.src=r.src,r.onload=null,r.src="",this.updateTexture()),t()};const i=(new XMLSerializer).serializeToString(this._svgRoot);r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(i)}`}))}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:n,resolution:r}=this,{padding:i}=t,{baseTexture:s}=e;e.trim.width=e._frame.width=n.width/r,e.trim.height=e._frame.height=n.height/r,e.trim.x=-i,e.trim.y=-i,e.orig.width=e._frame.width-2*i,e.orig.height=e._frame.height-2*i,this._onTextureUpdate(),s.setRealSize(n.width,n.height,r),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},t.defaultDestroyOptions,e),super.destroy(e);const n=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=n,this._svgRoot?.remove(),this._svgRoot=n,this._domElement?.remove(),this._domElement=n,this._foreignObject?.remove(),this._foreignObject=n,this._styleElement?.remove(),this._styleElement=n,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=n,this._image.src="",this._image=n}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=we(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=we(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&((t=t||{})instanceof Hl?(this.ownsStyle=!1,this._style=t):t instanceof Ss?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Hl.from(t)):(this.ownsStyle=!0,this._style=new Hl(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(""===t||null==t?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};zl.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},zl.defaultMaxWidth=2024,zl.defaultMaxHeight=2024,zl.defaultAutoResolution=!0;const Gl=new vn;class Vl{constructor(t){this.renderer=t}async image(t,e,n,r){const i=new Image;return i.src=await this.base64(t,e,n,r),i}async base64(t,e,n,r){const i=this.canvas(t,r);if(void 0!==i.toBlob)return new Promise(((t,r)=>{i.toBlob((e=>{if(!e)return void r(new Error("ICanvas.toBlob failed!"));const n=new FileReader;n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)}),e,n)}));if(void 0!==i.toDataURL)return i.toDataURL(e,n);if(void 0!==i.convertToBlob){const t=await i.convertToBlob({type:e,quality:n});return new Promise(((e,n)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=n,r.readAsDataURL(t)}))}throw new Error("CanvasExtract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){const n=this.renderer;if(!n)throw new Error("The CanvasExtract has already been destroyed");let r,i,s;t&&(t instanceof yr?s=t:(s=n.generateTexture(t,{region:e,resolution:n.resolution}),e&&(Gl.width=e.width,Gl.height=e.height,e=Gl))),s?(r=s.baseTexture._canvasRenderTarget.context,i=s.baseTexture._canvasRenderTarget.resolution,e=e??s.frame):(r=n.canvasContext.rootContext,i=n._view.resolution,e||((e=Gl).width=n.width/i,e.height=n.height/i));const o=Math.round(e.x*i),a=Math.round(e.y*i),l=Math.max(Math.round(e.width*i),1),h=Math.max(Math.round(e.height*i),1),c=new Pe(l,h,1),u=r.getImageData(o,a,l,h);return c.context.putImageData(u,0,0),c.canvas}pixels(t,e){const n=this.renderer;if(!n)throw new Error("The CanvasExtract has already been destroyed");let r,i,s;t&&(t instanceof yr?s=t:(s=n.generateTexture(t,{region:e,resolution:n.resolution}),e&&(Gl.width=e.width,Gl.height=e.height,e=Gl))),s?(r=s.baseTexture._canvasRenderTarget.context,i=s.baseTexture._canvasRenderTarget.resolution,e=e??s.frame):(r=n.canvasContext.rootContext,i=n.resolution,e||((e=Gl).width=n.width/i,e.height=n.height/i));const o=Math.round(e.x*i),a=Math.round(e.y*i),l=Math.max(Math.round(e.width*i),1),h=Math.max(Math.round(e.height*i),1);return r.getImageData(o,a,l,h).data}destroy(){this.renderer=null}}let Xl;Vl.extension={name:"extract",type:Be.CanvasRendererSystem},je.add(Vl);const Yl=new bn;Ya.prototype.generateCanvasTexture=function(t,e=1){const n=this.getLocalBounds(new vn);n.width=Math.max(n.width,1/e),n.height=Math.max(n.height,1/e);const r=yr.create({width:n.width,height:n.height,scaleMode:t,resolution:e});Xl||(Xl=new qi),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(Yl),Yl.invert(),Yl.tx-=n.x,Yl.ty-=n.y,Xl.render(this,{renderTexture:r,clear:!0,transform:Yl});const i=vr.from(r.baseTexture._canvasRenderTarget.canvas,{scaleMode:t});return i.baseTexture.setResolution(e),i},Ya.prototype.cachedGraphicsData=[],Ya.prototype._renderCanvas=function(t){!0!==this.isMask&&(this.finishPoly(),t.plugins.graphics.render(this))};class $l{static offsetPolygon(t,e){const n=[],r=t.length;e=$l.isPolygonClockwise(t)?e:-1*e;for(let i=0;i<r;i+=2){let s=i-2;s<0&&(s+=r);const o=(i+2)%r;let a=t[i]-t[s],l=t[i+1]-t[s+1],h=Math.sqrt(a*a+l*l);a/=h,l/=h,a*=e,l*=e;const c=-l,u=a,d=[t[s]+c,t[s+1]+u],f=[t[i]+c,t[i+1]+u];let p=t[o]-t[i],m=t[o+1]-t[i+1];h=Math.sqrt(p*p+m*m),p/=h,m/=h,p*=e,m*=e;const g=-m,v=p,y=[t[i]+g,t[i+1]+v],x=[t[o]+g,t[o+1]+v],w=$l.findIntersection(d[0],d[1],f[0],f[1],y[0],y[1],x[0],x[1]);w&&n.push(...w)}return n}static findIntersection(t,e,n,r,i,s,o,a){const l=(a-s)*(n-t)-(o-i)*(r-e),h=(o-i)*(e-s)-(a-s)*(t-i);if(0===l)return 0===h&&0==(n-t)*(e-s)-(r-e)*(t-i)?[(t+n)/2,(e+r)/2]:null;const c=h/l;return[t+c*(n-t),e+c*(r-e)]}static isPolygonClockwise(t){let e=0;for(let n=0,r=t.length-2;n<t.length;r=n,n+=2)e+=(t[n]-t[r])*(t[n+1]+t[r+1]);return e>0}}class ql{constructor(t){this._svgMatrix=null,this._tempMatrix=new bn,this.renderer=t}_calcCanvasStyle(t,e){let n;return t.texture&&t.texture.baseTexture!==vr.WHITE.baseTexture?t.texture.valid?(n=Ki.getTintedPattern(t.texture,e),this.setPatternTransform(n,t.matrix||bn.IDENTITY)):n="#808080":n=`#${`00000${(0|e).toString(16)}`.slice(-6)}`,n}render(t){const e=this.renderer,n=e.canvasContext.activeContext,r=t.worldAlpha,i=t.transform.worldTransform;e.canvasContext.setContextTransform(i),e.canvasContext.setBlendMode(t.blendMode);const s=t.geometry.graphicsData;let o,a;const l=ee.shared.setValue(t.tint).toArray();for(let t=0;t<s.length;t++){const h=s[t],c=h.shape,u=h.fillStyle,d=h.lineStyle,f=0|h.fillStyle.color,p=0|h.lineStyle.color;if(h.matrix&&e.canvasContext.setContextTransform(i.copyTo(this._tempMatrix).append(h.matrix)),u.visible&&(o=this._calcCanvasStyle(u,ee.shared.setValue(f).multiply(l).toNumber())),d.visible&&(a=this._calcCanvasStyle(d,ee.shared.setValue(p).multiply(l).toNumber())),n.lineWidth=d.width,n.lineCap=d.cap,n.lineJoin=d.join,n.miterLimit=d.miterLimit,h.type===pn.POLY){n.beginPath();const t=c;let e=t.points;const i=h.holes;let s,l,f,p,m;n.moveTo(e[0],e[1]);for(let t=2;t<e.length;t+=2)n.lineTo(e[t],e[t+1]);if(t.closeStroke&&n.closePath(),i.length>0){m=[],s=0,f=e[0],p=e[1];for(let t=2;t+2<e.length;t+=2)s+=(e[t]-f)*(e[t+3]-p)-(e[t+2]-f)*(e[t+1]-p);for(let t=0;t<i.length;t++)if(e=i[t].shape.points,e){l=0,f=e[0],p=e[1];for(let t=2;t+2<e.length;t+=2)l+=(e[t]-f)*(e[t+3]-p)-(e[t+2]-f)*(e[t+1]-p);if(l*s<0){n.moveTo(e[0],e[1]);for(let t=2;t<e.length;t+=2)n.lineTo(e[t],e[t+1])}else{n.moveTo(e[e.length-2],e[e.length-1]);for(let t=e.length-4;t>=0;t-=2)n.lineTo(e[t],e[t+1])}i[t].shape.closeStroke&&n.closePath(),m[t]=l*s<0}}u.visible&&(n.globalAlpha=u.alpha*r,n.fillStyle=o,n.fill()),d.visible&&this.paintPolygonStroke(t,d,a,i,m,r,n)}else if(h.type===pn.RECT){const t=c;if(u.visible&&(n.globalAlpha=u.alpha*r,n.fillStyle=o,n.fillRect(t.x,t.y,t.width,t.height)),d.visible){const e=d.width*(.5-(1-d.alignment)),i=t.width+2*e,s=t.height+2*e;n.globalAlpha=d.alpha*r,n.strokeStyle=a,n.strokeRect(t.x-e,t.y-e,i,s)}}else if(h.type===pn.CIRC){const t=c;if(n.beginPath(),n.arc(t.x,t.y,t.radius,0,2*Math.PI),n.closePath(),u.visible&&(n.globalAlpha=u.alpha*r,n.fillStyle=o,n.fill()),d.visible){if(.5!==d.alignment){const e=d.width*(.5-(1-d.alignment));n.beginPath(),n.arc(t.x,t.y,t.radius+e,0,2*Math.PI),n.closePath()}n.globalAlpha=d.alpha*r,n.strokeStyle=a,n.stroke()}}else if(h.type===pn.ELIP){const t=c,e=1===d.alignment;if(e||this.paintEllipse(t,u,d,o,r,n),d.visible){if(.5!==d.alignment){const e=.5522848,r=d.width*(.5-(1-d.alignment)),i=2*(t.width+r),s=2*(t.height+r),o=t.x-i/2,a=t.y-s/2,l=i/2*e,h=s/2*e,c=o+i,u=a+s,f=o+i/2,p=a+s/2;n.beginPath(),n.moveTo(o,p),n.bezierCurveTo(o,p-h,f-l,a,f,a),n.bezierCurveTo(f+l,a,c,p-h,c,p),n.bezierCurveTo(c,p+h,f+l,u,f,u),n.bezierCurveTo(f-l,u,o,p+h,o,p),n.closePath()}n.globalAlpha=d.alpha*r,n.strokeStyle=a,n.stroke()}e&&this.paintEllipse(t,u,d,o,r,n)}else if(h.type===pn.RREC){const t=c,e=1===d.alignment;if(e||this.paintRoundedRectangle(t,u,d,o,r,n),d.visible){if(.5!==d.alignment){const e=t.width,r=t.height,i=d.width*(.5-(1-d.alignment)),s=t.x-i,o=t.y-i,a=t.width+2*i,l=t.height+2*i,h=i*(d.alignment>=1?Math.min(a/e,l/r):Math.min(e/a,r/l));let c=t.radius+h;const u=Math.min(a,l)/2;c=c>u?u:c,n.beginPath(),n.moveTo(s,o+c),n.lineTo(s,o+l-c),n.quadraticCurveTo(s,o+l,s+c,o+l),n.lineTo(s+a-c,o+l),n.quadraticCurveTo(s+a,o+l,s+a,o+l-c),n.lineTo(s+a,o+c),n.quadraticCurveTo(s+a,o,s+a-c,o),n.lineTo(s+c,o),n.quadraticCurveTo(s,o,s,o+c),n.closePath()}n.globalAlpha=d.alpha*r,n.strokeStyle=a,n.stroke()}e&&this.paintRoundedRectangle(t,u,d,o,r,n)}}}paintPolygonStroke(t,e,n,r,i,s,o){if(.5!==e.alignment){const n=e.width*(.5-(1-e.alignment));let s,a=$l.offsetPolygon(t.points,n);o.beginPath(),o.moveTo(a[0],a[1]);for(let t=2;t<a.length;t+=2)o.lineTo(a[t],a[t+1]);t.closeStroke&&o.closePath();for(let t=0;t<r.length;t++){if(s=r[t].shape.points,a=$l.offsetPolygon(s,n),i[t]){o.moveTo(a[0],a[1]);for(let t=2;t<a.length;t+=2)o.lineTo(a[t],a[t+1])}else{o.moveTo(a[a.length-2],a[a.length-1]);for(let t=a.length-4;t>=0;t-=2)o.lineTo(a[t],a[t+1])}r[t].shape.closeStroke&&o.closePath()}}o.globalAlpha=e.alpha*s,o.strokeStyle=n,o.stroke()}paintEllipse(t,e,n,r,i,s){const o=2*t.width,a=2*t.height,l=t.x-o/2,h=t.y-a/2,c=.5522848,u=o/2*c,d=a/2*c,f=l+o,p=h+a,m=l+o/2,g=h+a/2;0===n.alignment&&s.save(),s.beginPath(),s.moveTo(l,g),s.bezierCurveTo(l,g-d,m-u,h,m,h),s.bezierCurveTo(m+u,h,f,g-d,f,g),s.bezierCurveTo(f,g+d,m+u,p,m,p),s.bezierCurveTo(m-u,p,l,g+d,l,g),s.closePath(),0===n.alignment&&s.clip(),e.visible&&(s.globalAlpha=e.alpha*i,s.fillStyle=r,s.fill()),0===n.alignment&&s.restore()}paintRoundedRectangle(t,e,n,r,i,s){const o=t.x,a=t.y,l=t.width,h=t.height;let c=t.radius;const u=Math.min(l,h)/2;c=c>u?u:c,0===n.alignment&&s.save(),s.beginPath(),s.moveTo(o,a+c),s.lineTo(o,a+h-c),s.quadraticCurveTo(o,a+h,o+c,a+h),s.lineTo(o+l-c,a+h),s.quadraticCurveTo(o+l,a+h,o+l,a+h-c),s.lineTo(o+l,a+c),s.quadraticCurveTo(o+l,a,o+l-c,a),s.lineTo(o+c,a),s.quadraticCurveTo(o,a,o,a+c),s.closePath(),0===n.alignment&&s.clip(),e.visible&&(s.globalAlpha=e.alpha*i,s.fillStyle=r,s.fill()),0===n.alignment&&s.restore()}setPatternTransform(t,e){if(!1!==this._svgMatrix){if(!this._svgMatrix){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");if(e?.createSVGMatrix&&(this._svgMatrix=e.createSVGMatrix()),!this._svgMatrix||!t.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=e.a,this._svgMatrix.b=e.b,this._svgMatrix.c=e.c,this._svgMatrix.d=e.d,this._svgMatrix.e=e.tx,this._svgMatrix.f=e.ty,t.setTransform(this._svgMatrix.inverse())}}destroy(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null}}ql.extension={name:"graphics",type:Be.CanvasRendererPlugin},je.add(ql),Object.defineProperties(Y,{MESH_CANVAS_PADDING:{get(){return Qa.defaultCanvasPadding},set(t){gt("7.1.0","settings.MESH_CANVAS_PADDING is deprecated, use Mesh.defaultCanvasPadding"),Qa.defaultCanvasPadding=t}}}),tl.prototype._renderCanvas=function(t,e){t.plugins.mesh.render(e)},il.prototype._cachedTint=16777215,il.prototype._tintedCanvas=null,il.prototype._canvasUvs=null,il.prototype._renderCanvas=function(t){const e=t.canvasContext.activeContext,n=this.worldTransform,r=16777215!==this.tintValue,i=this.texture;if(!i.valid)return;r&&this._cachedTint!==this.tintValue&&(this._cachedTint=this.tintValue,this._tintedCanvas=Ki.getTintedCanvas(this,this.tintValue));const s=r?this._tintedCanvas:i.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);const o=this.vertices,a=this._canvasUvs,l=r?0:i.frame.x,h=r?0:i.frame.y,c=l+i.frame.width,u=h+i.frame.height;a[0]=l,a[1]=l+this._leftWidth,a[2]=c-this._rightWidth,a[3]=c,a[4]=h,a[5]=h+this._topHeight,a[6]=u-this._bottomHeight,a[7]=u;for(let t=0;t<8;t++)a[t]*=i.baseTexture.resolution;e.globalAlpha=this.worldAlpha,t.canvasContext.setBlendMode(this.blendMode),t.canvasContext.setContextTransform(n,this.roundPixels);for(let t=0;t<3;t++)for(let n=0;n<3;n++){const r=2*n+8*t,i=Math.max(1,a[n+1]-a[n]),l=Math.max(1,a[t+5]-a[t+4]),h=Math.max(1,o[r+10]-o[r]),c=Math.max(1,o[r+11]-o[r+1]);e.drawImage(s,a[n],a[t+4],i,l,o[r],o[r+1],h,c)}};let Kl=!1;Qa.prototype._cachedTint=16777215,Qa.prototype._tintedCanvas=null,Qa.prototype._cachedTexture=null,Qa.prototype._renderCanvas=function(t){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas?this.material._renderCanvas(t,this):Kl||(Kl=!0,globalThis.console.warn("Mesh with custom shaders are not supported in CanvasRenderer."))},Qa.prototype._canvasPadding=null,Qa.defaultCanvasPadding=0,Object.defineProperty(Qa.prototype,"canvasPadding",{get(){return this._canvasPadding??Qa.defaultCanvasPadding},set(t){this._canvasPadding=t}}),sl.prototype._renderCanvas=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(t,this)},class extends Qa{constructor(t,e,n=0){const r=new nl(t.height,e,n),i=new tl(t);n>0&&(t.baseTexture.wrapMode=N.REPEAT),super(r,i),this.autoUpdate=!0}_render(t){const e=this.geometry;(this.autoUpdate||e._width!==this.shader.texture.height)&&(e._width=this.shader.texture.height,e.update()),super._render(t)}}.prototype._renderCanvas=function(t){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(t,this)};class Zl{constructor(t){this.renderer=t}render(t){const e=this.renderer,n=t.worldTransform;e.canvasContext.activeContext.globalAlpha=t.worldAlpha,e.canvasContext.setBlendMode(t.blendMode),e.canvasContext.setContextTransform(n,t.roundPixels),t.drawMode!==I.TRIANGLES?this._renderTriangleMesh(t):this._renderTriangles(t)}_renderTriangleMesh(t){const e=t.geometry.buffers[0].data.length;for(let n=0;n<e-2;n++){const e=2*n;this._renderDrawTriangle(t,e,e+2,e+4)}}_renderTriangles(t){const e=t.geometry.getIndex().data,n=e.length;for(let r=0;r<n;r+=3){const n=2*e[r],i=2*e[r+1],s=2*e[r+2];this._renderDrawTriangle(t,n,i,s)}}_renderDrawTriangle(t,e,n,r){const i=this.renderer.canvasContext.activeContext,s=t.geometry.buffers[0].data,{uvs:o,texture:a}=t;if(!a.valid)return;const l=16777215!==t.tintValue,h=a.baseTexture,c=h.width,u=h.height;t._cachedTexture&&t._cachedTexture.baseTexture!==h&&(t._cachedTint=16777215,t._cachedTexture?.destroy(),t._cachedTexture=null,t._tintedCanvas=null),l&&t._cachedTint!==t.tintValue&&(t._cachedTint=t.tintValue,t._cachedTexture=t._cachedTexture||new vr(h),t._tintedCanvas=Ki.getTintedCanvas({texture:t._cachedTexture},t.tintValue));const d=l?t._tintedCanvas:h.getDrawableSource(),f=o[e]*h.width,p=o[n]*h.width,m=o[r]*h.width,g=o[e+1]*h.height,v=o[n+1]*h.height,y=o[r+1]*h.height;let x=s[e],w=s[n],_=s[r],b=s[e+1],T=s[n+1],S=s[r+1];const A=t.canvasPadding/this.renderer.canvasContext.activeResolution;if(A>0){const{a:e,b:n,c:r,d:i}=t.worldTransform,s=(x+w+_)/3,o=(b+T+S)/3;let a=x-s,l=b-o,h=e*a+r*l,c=n*a+i*l,u=Math.sqrt(h*h+c*c),d=1+A/u;x=s+a*d,b=o+l*d,a=w-s,l=T-o,h=e*a+r*l,c=n*a+i*l,u=Math.sqrt(h*h+c*c),d=1+A/u,w=s+a*d,T=o+l*d,a=_-s,l=S-o,h=e*a+r*l,c=n*a+i*l,u=Math.sqrt(h*h+c*c),d=1+A/u,_=s+a*d,S=o+l*d}i.save(),i.beginPath(),i.moveTo(x,b),i.lineTo(w,T),i.lineTo(_,S),i.closePath(),i.clip();const E=f*v+g*m+p*y-v*m-g*p-f*y,C=x*v+g*_+w*y-v*_-g*w-x*y,k=f*w+x*m+p*_-w*m-x*p-f*_,M=f*v*_+g*w*m+x*p*y-x*v*m-g*p*_-f*w*y,P=b*v+g*S+T*y-v*S-g*T-b*y,I=f*T+b*m+p*S-T*m-b*p-f*S,R=f*v*S+g*T*m+b*p*y-b*v*m-g*p*S-f*T*y;i.transform(C/E,P/E,k/E,I/E,M/E,R/E),i.drawImage(d,0,0,c*h.resolution,u*h.resolution,0,0,c,u),i.restore(),this.renderer.canvasContext.invalidateBlendMode()}renderMeshFlat(t){const e=this.renderer.canvasContext.activeContext,n=t.geometry.getBuffer("aVertexPosition").data,r=n.length/2;e.beginPath();for(let t=1;t<r-2;++t){const r=2*t,i=n[r],s=n[r+1],o=n[r+2],a=n[r+3],l=n[r+4],h=n[r+5];e.moveTo(i,s),e.lineTo(o,a),e.lineTo(l,h)}e.fillStyle="#FF0000",e.fill(),e.closePath()}destroy(){this.renderer=null}}function Ql(t,e){const n=t;if(e instanceof Je){const t=e.source,r=0===t.width?n.canvas.width:Math.min(n.canvas.width,t.width),i=0===t.height?n.canvas.height:Math.min(n.canvas.height,t.height);return n.ctx.drawImage(t,0,0,r,i,0,0,n.canvas.width,n.canvas.height),!0}return!1}Zl.extension={name:"mesh",type:Be.CanvasRendererPlugin},je.add(Zl);class Jl extends ml{constructor(t){super(t),this.uploadHookHelper=this,this.canvas=Y.ADAPTER.createCanvas(16,16),this.ctx=this.canvas.getContext("2d"),this.registerUploadHook(Ql)}destroy(){super.destroy(),this.ctx=null,this.canvas=null}}Jl.extension={name:"prepare",type:Be.CanvasRendererSystem},je.add(Jl),os.prototype._tintedCanvas=null,os.prototype._renderCanvas=function(t){t.plugins.sprite.render(this)};const th=new bn;class eh{constructor(t){this.renderer=t}render(t){const e=t._texture,n=this.renderer,r=n.canvasContext.activeContext,i=n.canvasContext.activeResolution;if(!e.valid)return;const s=e._frame.width,o=e._frame.height;let a=e._frame.width,l=e._frame.height;e.trim&&(Pn.isVertical(e.rotate)?(a=e.trim.height,l=e.trim.width):(a=e.trim.width,l=e.trim.height));let h=t.transform.worldTransform,c=0,u=0;const d=e.baseTexture.getDrawableSource();if(e.orig.width<=0||e.orig.height<=0||!e.valid||!d)return;n.canvasContext.setBlendMode(t.blendMode,!0),r.globalAlpha=t.worldAlpha;const f=e.baseTexture.scaleMode===F.LINEAR,p=n.canvasContext.smoothProperty;p&&r[p]!==f&&(r[p]=f),e.trim?(c=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,u=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(c=(.5-t.anchor.x)*e.orig.width,u=(.5-t.anchor.y)*e.orig.height),e.rotate&&(h.copyTo(th),h=th,Pn.matrixAppendRotationInv(h,e.rotate,c,u),c=0,u=0),c-=a/2,u-=l/2,n.canvasContext.setContextTransform(h,t.roundPixels,1),t.roundPixels&&(c|=0,u|=0);const m=e.baseTexture.resolution,g=n.canvasContext._outerBlend;g&&(r.save(),r.beginPath(),r.rect(c*i,u*i,a*i,l*i),r.clip()),16777215!==t.tint?((t._cachedTint!==t.tintValue||t._tintedCanvas.tintId!==t._texture._updateID)&&(t._cachedTint=t.tintValue,t._tintedCanvas=Ki.getTintedCanvas(t,t.tintValue)),r.drawImage(t._tintedCanvas,0,0,Math.floor(s*m),Math.floor(o*m),Math.floor(c*i),Math.floor(u*i),Math.floor(a*i),Math.floor(l*i))):r.drawImage(d,e._frame.x*m,e._frame.y*m,Math.floor(s*m),Math.floor(o*m),Math.floor(c*i),Math.floor(u*i),Math.floor(a*i),Math.floor(l*i)),g&&r.restore(),n.canvasContext.setBlendMode(P.NORMAL)}destroy(){this.renderer=null}}eh.extension={name:"sprite",type:Be.CanvasRendererPlugin},je.add(eh),r(9868);var nh="ServiceYandex",rh="ServiceOk",ih="preloadState",sh="gameState",oh="levelState",ah="levelPreload",lh="shadows",hh="words",ch="generator",uh="firstClick",dh="gameResize",fh="isDebug",ph="hit",mh="missClick",gh="usedHint",vh="completeLevel",yh="clearLevel",xh="updateTargets",wh="allItemsFound",_h="lvCounterStat",bh="options:muteSFX",Th="options:unmuteSFX",Sh="options:muteMusic",Ah="options:unmuteMusic",Eh="timer:timerTick",Ch="timer:kill",kh="stopwatch:tick",Mh="player:hintsUpdated",Ph="player:coinsUpdated",Ih="payment:completeLevel",Rh="store:hide",Oh="promoCardBue",Lh="hidePromoCard",Dh={WIDTH:2560,HEIGHT:1080,HALF_W:1280,HALF_H:540,get CENTER(){return{x:1280,y:540}},get isLandscape(){return matchMedia("(orientation: landscape)").matches},get isPortrait(){return matchMedia("(orientation: portrait)").matches}},Fh={free:{id:"free",textInCard:"x".concat(3),amount:3,texture:"icon-loupe"},smallPack:{id:"smallPack",textInCard:"x".concat(5),amount:5,texture:"icon-loupe"},mediumPack:{id:"mediumPack",textInCard:"x".concat(15),amount:15,texture:"icon-loupe"},largePack:{id:"largePack",textInCard:"x".concat(50),amount:50,texture:"icon-loupe"},extraLargePack:{id:"extraLargePack",textInCard:"x".concat(100),amount:100,texture:"icon-loupe"},noAdPack:{id:"noAdPack",textInCard:"",amount:0,texture:"icon-noAd"}},Nh="https://raw.githubusercontent.com/westerovs/testServer/refs/heads/testing/game2_HOPA_Simple/localeAssets/",Bh="https://raw.githubusercontent.com/westerovs/testServer/refs/heads/testing/game2_HOPA_Simple/remoteAssets/";function Wh(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Uh(t,e){return t.get(Hh(t,e))}function jh(t,e,n){return t.set(Hh(t,e),n),n}function Hh(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zh=new WeakMap,Gh=new WeakMap,Vh=new WeakMap,Xh=new WeakMap,Yh=new WeakMap,$h=_((function t(e,n){var r=this;v(this,t),Wh(this,zh,void 0),Wh(this,Gh,void 0),Wh(this,Vh,void 0),Wh(this,Xh,void 0),Wh(this,Yh,(function(){jh(Gh,r,new rs),Uh(Gh,r).zIndex=5,Uh(Gh,r).name="ui",r.viewport.addChild(Uh(Gh,r)),jh(Vh,r,new rs),Uh(Vh,r).name="uiInner",Uh(Vh,r).sortableChildren=!0,Uh(Gh,r).addChild(Uh(Vh,r)),jh(Xh,r,new Ya),Uh(Xh,r).name="uiRect",Uh(Xh,r).alpha=.5,Uh(Xh,r).visible=!1,Uh(Gh,r).addChild(Uh(Xh,r)),Uh(zh,r).uiRect=Uh(Xh,r),Uh(zh,r).uiInner=Uh(Vh,r),Uh(zh,r).ui=Uh(Gh,r)})),E(this,"resizeUi",(function(){var t=Math.min(Dh.WIDTH/window.innerWidth,Dh.HEIGHT/window.innerHeight),e=window.innerWidth*t,n=Dh.HEIGHT/window.innerHeight,i=window.innerHeight*n,s=Uh(Xh,r);s.clear(),s.lineStyle(8,65280),s.beginFill(255),s.drawRect(4,4,e-4,i-4),s.endFill(),Uh(Gh,r).pivot.set(s.width/2,s.height/2),Uh(Gh,r).position.set(Dh.HALF_W,Dh.HALF_H)})),jh(zh,this,e),this.viewport=n,Uh(Yh,this).call(this)}),[{key:"ui",get:function(){return Uh(Gh,this)}},{key:"uiInner",get:function(){return Uh(Vh,this)}},{key:"uiRect",get:function(){return Uh(Xh,this)}}]);function qh(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(qh=function(){return!!t})()}var Kh=new WeakMap,Zh=function(t){function e(t){var n;return v(this,e),n=function(t,e){return e=T(e),b(t,qh()?Reflect.construct(e,[],T(t).constructor):e.apply(t,void 0))}(this,e),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(n,Kh,(function(){var t=(new Ya).beginFill(16711680).drawRect(0,0,Dh.WIDTH,Dh.HEIGHT);t.visible=!1,n.addChild(t)})),E(n,"resize",(function(){var t=n.resizeData,e=t.scaleFactor,r=t.x,i=t.y;n.game.scaleFactor=e,n.game.resizeData=n.resizeData,n.scale.set(e),n.position.set(r,i),n.uiLayer.resizeUi()})),n.game=t,n.name="mainViewport",n.sortableChildren=!0,n.uiLayer=new $h(t,n),function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(Kh,n).call(n),n}return A(e,t),_(e,[{key:"scaleFactor",get:function(){return+(window.innerHeight/Dh.HEIGHT).toFixed(3)}},{key:"resizeData",get:function(){var t=this.scaleFactor;return{scaleFactor:t,x:+((window.innerWidth-Dh.WIDTH*t)/2).toFixed(3),y:+((window.innerHeight-Dh.HEIGHT*t)/2).toFixed(3),differentX:Math.abs((window.innerWidth-Dh.WIDTH)/2),differentY:Math.abs((window.innerHeight-Dh.HEIGHT)/2)}}},{key:"ui",get:function(){return this.uiLayer.ui}},{key:"uiInner",get:function(){return this.uiLayer.uiInner}},{key:"uiRect",get:function(){return this.uiLayer.uiRect}}])}(rs);function Qh(t,e,n,r,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Jh(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var s=t.apply(e,n);function o(t){Qh(s,r,i,o,a,"next",t)}function a(t){Qh(s,r,i,o,a,"throw",t)}o(void 0)}))}}function tc(){return tc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},tc.apply(null,arguments)}var ec=r(4756),nc=r.n(ec);r(8706);const rc=t=>"string"==typeof t,ic=()=>{let t,e;const n=new Promise(((n,r)=>{t=n,e=r}));return n.resolve=t,n.reject=e,n},sc=t=>null==t?"":""+t,oc=/###/g,ac=t=>t&&t.indexOf("###")>-1?t.replace(oc,"."):t,lc=t=>!t||rc(t),hc=(t,e,n)=>{const r=rc(e)?e.split("."):e;let i=0;for(;i<r.length-1;){if(lc(t))return{};const e=ac(r[i]);!t[e]&&n&&(t[e]=new n),t=Object.prototype.hasOwnProperty.call(t,e)?t[e]:{},++i}return lc(t)?{}:{obj:t,k:ac(r[i])}},cc=(t,e,n)=>{const{obj:r,k:i}=hc(t,e,Object);if(void 0!==r||1===e.length)return void(r[i]=n);let s=e[e.length-1],o=e.slice(0,e.length-1),a=hc(t,o,Object);for(;void 0===a.obj&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),a=hc(t,o,Object),a?.obj&&void 0!==a.obj[`${a.k}.${s}`]&&(a.obj=void 0);a.obj[`${a.k}.${s}`]=n},uc=(t,e)=>{const{obj:n,k:r}=hc(t,e);if(n&&Object.prototype.hasOwnProperty.call(n,r))return n[r]},dc=(t,e,n)=>{for(const r in e)"__proto__"!==r&&"constructor"!==r&&(r in t?rc(t[r])||t[r]instanceof String||rc(e[r])||e[r]instanceof String?n&&(t[r]=e[r]):dc(t[r],e[r],n):t[r]=e[r]);return t},fc=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var pc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const mc=t=>rc(t)?t.replace(/[&<>"'\/]/g,(t=>pc[t])):t,gc=[" ",",","?","!",";"],vc=new class{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const e=this.regExpMap.get(t);if(void 0!==e)return e;const n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}}(20),yc=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!t)return;if(t[e]){if(!Object.prototype.hasOwnProperty.call(t,e))return;return t[e]}const r=e.split(n);let i=t;for(let t=0;t<r.length;){if(!i||"object"!=typeof i)return;let e,s="";for(let o=t;o<r.length;++o)if(o!==t&&(s+=n),s+=r[o],e=i[s],void 0!==e){if(["string","number","boolean"].indexOf(typeof e)>-1&&o<r.length-1)continue;t+=o-t+1;break}i=e}return i},xc=t=>t?.replace("_","-"),wc={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console?.[t]?.apply?.(console,e)}};class _c{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(t,e)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||wc,this.options=e,this.debug=e.debug}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}deprecate(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,n,r){return r&&!this.debug?null:(rc(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new _c(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new _c(this.logger,t)}}var bc=new _c;class Tc{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach((t=>{this.observers[t]||(this.observers[t]=new Map);const n=this.observers[t].get(e)||0;this.observers[t].set(e,n+1)})),this}off(t,e){this.observers[t]&&(e?this.observers[t].delete(e):delete this.observers[t])}emit(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.observers[t]&&Array.from(this.observers[t].entries()).forEach((t=>{let[e,r]=t;for(let t=0;t<r;t++)e(...n)})),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach((e=>{let[r,i]=e;for(let e=0;e<i;e++)r.apply(r,[t,...n])}))}}class Sc extends Tc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,s=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;t.indexOf(".")>-1?o=t.split("."):(o=[t,e],n&&(Array.isArray(n)?o.push(...n):rc(n)&&i?o.push(...n.split(i)):o.push(n)));const a=uc(this.data,o);return!a&&!e&&!n&&t.indexOf(".")>-1&&(t=o[0],e=o[1],n=o.slice(2).join(".")),!a&&s&&rc(n)?yc(this.data?.[t]?.[e],n,i):a}addResource(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const s=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator;let o=[t,e];n&&(o=o.concat(s?n.split(s):n)),t.indexOf(".")>-1&&(o=t.split("."),r=e,e=o[1]),this.addNamespaces(e),cc(this.data,o,r),i.silent||this.emit("added",t,e,n,r)}addResources(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const r in n)(rc(n[r])||Array.isArray(n[r]))&&this.addResource(t,e,r,n[r],{silent:!0});r.silent||this.emit("added",t,e,n)}addResourceBundle(t,e,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},o=[t,e];t.indexOf(".")>-1&&(o=t.split("."),r=n,n=e,e=o[1]),this.addNamespaces(e);let a=uc(this.data,o)||{};s.skipCopy||(n=JSON.parse(JSON.stringify(n))),r?dc(a,n,i):a={...a,...n},cc(this.data,o,a),s.silent||this.emit("added",t,e,n)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return void 0!==this.getResource(t,e)}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find((t=>e[t]&&Object.keys(e[t]).length>0))}toJSON(){return this.data}}var Ac={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,i){return t.forEach((t=>{e=this.processors[t]?.process(e,n,r,i)??e})),e}};const Ec={},Cc=t=>!rc(t)&&"boolean"!=typeof t&&"number"!=typeof t;class kc extends Tc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),((t,e,n)=>{["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach((t=>{e[t]&&(n[t]=e[t])}))})(0,t,this),this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=bc.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==t)return!1;const n=this.resolve(t,e);return void 0!==n?.res}extractFromKey(t,e){let n=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");const r=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator;let i=e.ns||this.options.defaultNS||[];const s=n&&t.indexOf(n)>-1,o=!(this.options.userDefinedKeySeparator||e.keySeparator||this.options.userDefinedNsSeparator||e.nsSeparator||((t,e,n)=>{e=e||"",n=n||"";const r=gc.filter((t=>e.indexOf(t)<0&&n.indexOf(t)<0));if(0===r.length)return!0;const i=vc.getRegExp(`(${r.map((t=>"?"===t?"\\?":t)).join("|")})`);let s=!i.test(t);if(!s){const e=t.indexOf(n);e>0&&!i.test(t.substring(0,e))&&(s=!0)}return s})(t,n,r));if(s&&!o){const e=t.match(this.interpolator.nestingRegexp);if(e&&e.length>0)return{key:t,namespaces:rc(i)?[i]:i};const s=t.split(n);(n!==r||n===r&&this.options.ns.indexOf(s[0])>-1)&&(i=s.shift()),t=s.join(r)}return{key:t,namespaces:rc(i)?[i]:i}}translate(t,e,n){if("object"!=typeof e&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof e&&(e={...e}),e||(e={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);const r=void 0!==e.returnDetails?e.returnDetails:this.options.returnDetails,i=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,{key:s,namespaces:o}=this.extractFromKey(t[t.length-1],e),a=o[o.length-1],l=e.lng||this.language,h=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===l?.toLowerCase()){if(h){const t=e.nsSeparator||this.options.nsSeparator;return r?{res:`${a}${t}${s}`,usedKey:s,exactUsedKey:s,usedLng:l,usedNS:a,usedParams:this.getUsedParamsDetails(e)}:`${a}${t}${s}`}return r?{res:s,usedKey:s,exactUsedKey:s,usedLng:l,usedNS:a,usedParams:this.getUsedParamsDetails(e)}:s}const c=this.resolve(t,e);let u=c?.res;const d=c?.usedKey||s,f=c?.exactUsedKey||s,p=void 0!==e.joinArrays?e.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject,g=void 0!==e.count&&!rc(e.count),v=kc.hasDefaultValue(e),y=g?this.pluralResolver.getSuffix(l,e.count,e):"",x=e.ordinal&&g?this.pluralResolver.getSuffix(l,e.count,{ordinal:!1}):"",w=g&&!e.ordinal&&0===e.count,_=w&&e[`defaultValue${this.options.pluralSeparator}zero`]||e[`defaultValue${y}`]||e[`defaultValue${x}`]||e.defaultValue;let b=u;m&&!u&&v&&(b=_);const T=Cc(b),S=Object.prototype.toString.apply(b);if(!(m&&b&&T&&["[object Number]","[object Function]","[object RegExp]"].indexOf(S)<0)||rc(p)&&Array.isArray(b))if(m&&rc(p)&&Array.isArray(u))u=u.join(p),u&&(u=this.extendTranslation(u,t,e,n));else{let r=!1,o=!1;!this.isValidLookup(u)&&v&&(r=!0,u=_),this.isValidLookup(u)||(o=!0,u=s);const h=(e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&o?void 0:u,d=v&&_!==u&&this.options.updateMissing;if(o||r||d){if(this.logger.log(d?"updateKey":"missingKey",l,a,s,d?_:u),i){const t=this.resolve(s,{...e,keySeparator:!1});t&&t.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let t=[];const n=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if("fallback"===this.options.saveMissingTo&&n&&n[0])for(let e=0;e<n.length;e++)t.push(n[e]);else"all"===this.options.saveMissingTo?t=this.languageUtils.toResolveHierarchy(e.lng||this.language):t.push(e.lng||this.language);const r=(t,n,r)=>{const i=v&&r!==u?r:h;this.options.missingKeyHandler?this.options.missingKeyHandler(t,a,n,i,d,e):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(t,a,n,i,d,e),this.emit("missingKey",t,a,n,u)};this.options.saveMissing&&(this.options.saveMissingPlurals&&g?t.forEach((t=>{const n=this.pluralResolver.getSuffixes(t,e);w&&e[`defaultValue${this.options.pluralSeparator}zero`]&&n.indexOf(`${this.options.pluralSeparator}zero`)<0&&n.push(`${this.options.pluralSeparator}zero`),n.forEach((n=>{r([t],s+n,e[`defaultValue${n}`]||_)}))})):r(t,s,_))}u=this.extendTranslation(u,t,e,c,n),o&&u===s&&this.options.appendNamespaceToMissingKey&&(u=`${a}:${s}`),(o||r)&&this.options.parseMissingKeyHandler&&(u=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${a}:${s}`:s,r?u:void 0))}else{if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const t=this.options.returnedObjectHandler?this.options.returnedObjectHandler(d,b,{...e,ns:o}):`key '${s} (${this.language})' returned an object instead of string.`;return r?(c.res=t,c.usedParams=this.getUsedParamsDetails(e),c):t}if(i){const t=Array.isArray(b),n=t?[]:{},r=t?f:d;for(const t in b)if(Object.prototype.hasOwnProperty.call(b,t)){const s=`${r}${i}${t}`;n[t]=v&&!u?this.translate(s,{...e,defaultValue:Cc(_)?_[t]:void 0,joinArrays:!1,ns:o}):this.translate(s,{...e,joinArrays:!1,ns:o}),n[t]===s&&(n[t]=b[t])}u=n}}return r?(c.res=u,c.usedParams=this.getUsedParamsDetails(e),c):u}extendTranslation(t,e,n,r,i){var s=this;if(this.i18nFormat?.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const o=rc(t)&&(void 0!==n?.interpolation?.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let a;if(o){const e=t.match(this.interpolator.nestingRegexp);a=e&&e.length}let l=n.replace&&!rc(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),t=this.interpolator.interpolate(t,l,n.lng||this.language||r.usedLng,n),o){const e=t.match(this.interpolator.nestingRegexp);a<(e&&e.length)&&(n.nest=!1)}!n.lng&&r&&r.res&&(n.lng=this.language||r.usedLng),!1!==n.nest&&(t=this.interpolator.nest(t,(function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return i?.[0]!==r[0]||n.context?s.translate(...r,e):(s.logger.warn(`It seems you are nesting recursively key: ${r[0]} in key: ${e[0]}`),null)}),n)),n.interpolation&&this.interpolator.reset()}const o=n.postProcess||this.options.postProcess,a=rc(o)?[o]:o;return null!=t&&a?.length&&!1!==n.applyPostProcessor&&(t=Ac.handle(a,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let e,n,r,i,s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return rc(t)&&(t=[t]),t.forEach((t=>{if(this.isValidLookup(e))return;const a=this.extractFromKey(t,o),l=a.key;n=l;let h=a.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));const c=void 0!==o.count&&!rc(o.count),u=c&&!o.ordinal&&0===o.count,d=void 0!==o.context&&(rc(o.context)||"number"==typeof o.context)&&""!==o.context,f=o.lngs?o.lngs:this.languageUtils.toResolveHierarchy(o.lng||this.language,o.fallbackLng);h.forEach((t=>{this.isValidLookup(e)||(s=t,Ec[`${f[0]}-${t}`]||!this.utils?.hasLoadedNamespace||this.utils?.hasLoadedNamespace(s)||(Ec[`${f[0]}-${t}`]=!0,this.logger.warn(`key "${n}" for languages "${f.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((n=>{if(this.isValidLookup(e))return;i=n;const s=[l];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(s,l,n,t,o);else{let t;c&&(t=this.pluralResolver.getSuffix(n,o.count,o));const e=`${this.options.pluralSeparator}zero`,r=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(s.push(l+t),o.ordinal&&0===t.indexOf(r)&&s.push(l+t.replace(r,this.options.pluralSeparator)),u&&s.push(l+e)),d){const n=`${l}${this.options.contextSeparator}${o.context}`;s.push(n),c&&(s.push(n+t),o.ordinal&&0===t.indexOf(r)&&s.push(n+t.replace(r,this.options.pluralSeparator)),u&&s.push(n+e))}}let a;for(;a=s.pop();)this.isValidLookup(e)||(r=a,e=this.getResource(n,t,a,o))})))}))})),{res:e,usedKey:n,exactUsedKey:r,usedLng:i,usedNS:s}}isValidLookup(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}getResource(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat?.getResource?this.i18nFormat.getResource(t,e,n,r):this.resourceStore.getResource(t,e,n,r)}getUsedParamsDetails(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&!rc(t.replace);let r=n?t.replace:t;if(n&&void 0!==t.count&&(r.count=t.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!n){r={...r};for(const t of e)delete r[t]}return r}static hasDefaultValue(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&"defaultValue"===e.substring(0,12)&&void 0!==t[e])return!0;return!1}}class Mc{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=bc.create("languageUtils")}getScriptPartFromCode(t){if(!(t=xc(t))||t.indexOf("-")<0)return null;const e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}getLanguagePartFromCode(t){if(!(t=xc(t))||t.indexOf("-")<0)return t;const e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(rc(t)&&t.indexOf("-")>-1){let e;try{e=Intl.getCanonicalLocales(t)[0]}catch(t){}return e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach((t=>{if(e)return;const n=this.formatLanguageCode(t);this.options.supportedLngs&&!this.isSupportedCode(n)||(e=n)})),!e&&this.options.supportedLngs&&t.forEach((t=>{if(e)return;const n=this.getLanguagePartFromCode(t);if(this.isSupportedCode(n))return e=n;e=this.options.supportedLngs.find((t=>t===n?t:t.indexOf("-")<0&&n.indexOf("-")<0?void 0:t.indexOf("-")>0&&n.indexOf("-")<0&&t.substring(0,t.indexOf("-"))===n||0===t.indexOf(n)&&n.length>1?t:void 0))})),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),rc(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}toResolveHierarchy(t,e){const n=this.getFallbackCodes(e||this.options.fallbackLng||[],t),r=[],i=t=>{t&&(this.isSupportedCode(t)?r.push(t):this.logger.warn(`rejecting language code not found in supportedLngs: ${t}`))};return rc(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(t))):rc(t)&&i(this.formatLanguageCode(t)),n.forEach((t=>{r.indexOf(t)<0&&i(this.formatLanguageCode(t))})),r}}const Pc={zero:0,one:1,two:2,few:3,many:4,other:5},Ic={select:t=>1===t?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class Rc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=t,this.options=e,this.logger=bc.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=xc("dev"===t?"en":t),r=e.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:n,type:r});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let s;try{s=new Intl.PluralRules(n,{type:r})}catch(n){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Ic;if(!t.match(/-|_/))return Ic;const r=this.languageUtils.getLanguagePartFromCode(t);s=this.getRule(r,e)}return this.pluralRulesCache[i]=s,s}needsPlural(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),n?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(t,n).map((t=>`${e}${t}`))}getSuffixes(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),n?n.resolvedOptions().pluralCategories.sort(((t,e)=>Pc[t]-Pc[e])).map((t=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${t}`)):[]}getSuffix(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getRule(t,n);return r?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${r.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,n))}}const Oc=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=((t,e,n)=>{const r=uc(t,n);return void 0!==r?r:uc(e,n)})(t,e,n);return!s&&i&&rc(n)&&(s=yc(t,n,r),void 0===s&&(s=yc(e,n,r))),s},Lc=t=>t.replace(/\$/g,"$$$$");class Dc{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=bc.create("interpolator"),this.options=t,this.format=t?.interpolation?.format||(t=>t),this.init(t)}init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:e,escapeValue:n,useRawValueToEscape:r,prefix:i,prefixEscaped:s,suffix:o,suffixEscaped:a,formatSeparator:l,unescapeSuffix:h,unescapePrefix:c,nestingPrefix:u,nestingPrefixEscaped:d,nestingSuffix:f,nestingSuffixEscaped:p,nestingOptionsSeparator:m,maxReplaces:g,alwaysFormat:v}=t.interpolation;this.escape=void 0!==e?e:mc,this.escapeValue=void 0===n||n,this.useRawValueToEscape=void 0!==r&&r,this.prefix=i?fc(i):s||"{{",this.suffix=o?fc(o):a||"}}",this.formatSeparator=l||",",this.unescapePrefix=h?"":c||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=u?fc(u):d||fc("$t("),this.nestingSuffix=f?fc(f):p||fc(")"),this.nestingOptionsSeparator=m||",",this.maxReplaces=g||1e3,this.alwaysFormat=void 0!==v&&v,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(t,e)=>t?.source===e?(t.lastIndex=0,t):new RegExp(e,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,n,r){let i,s,o;const a=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},l=t=>{if(t.indexOf(this.formatSeparator)<0){const i=Oc(e,a,t,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(i,void 0,n,{...r,...e,interpolationkey:t}):i}const i=t.split(this.formatSeparator),s=i.shift().trim(),o=i.join(this.formatSeparator).trim();return this.format(Oc(e,a,s,this.options.keySeparator,this.options.ignoreJSONStructure),o,n,{...r,...e,interpolationkey:s})};this.resetRegExp();const h=r?.missingInterpolationHandler||this.options.missingInterpolationHandler,c=void 0!==r?.interpolation?.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:t=>Lc(t)},{regex:this.regexp,safeValue:t=>this.escapeValue?Lc(this.escape(t)):Lc(t)}].forEach((e=>{for(o=0;i=e.regex.exec(t);){const n=i[1].trim();if(s=l(n),void 0===s)if("function"==typeof h){const e=h(t,i,r);s=rc(e)?e:""}else if(r&&Object.prototype.hasOwnProperty.call(r,n))s="";else{if(c){s=i[0];continue}this.logger.warn(`missed to pass in variable ${n} for interpolating ${t}`),s=""}else rc(s)||this.useRawValueToEscape||(s=sc(s));const a=e.safeValue(s);if(t=t.replace(i[0],a),c?(e.regex.lastIndex+=s.length,e.regex.lastIndex-=i[0].length):e.regex.lastIndex=0,o++,o>=this.maxReplaces)break}})),t}nest(t,e){let n,r,i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=(t,e)=>{const n=this.nestingOptionsSeparator;if(t.indexOf(n)<0)return t;const r=t.split(new RegExp(`${n}[ ]*{`));let s=`{${r[1]}`;t=r[0],s=this.interpolate(s,i);const o=s.match(/'/g),a=s.match(/"/g);((o?.length??0)%2==0&&!a||a.length%2!=0)&&(s=s.replace(/'/g,'"'));try{i=JSON.parse(s),e&&(i={...e,...i})}catch(e){return this.logger.warn(`failed parsing options string in nesting for key ${t}`,e),`${t}${n}${s}`}return i.defaultValue&&i.defaultValue.indexOf(this.prefix)>-1&&delete i.defaultValue,t};for(;n=this.nestingRegexp.exec(t);){let a=[];i={...s},i=i.replace&&!rc(i.replace)?i.replace:i,i.applyPostProcessor=!1,delete i.defaultValue;let l=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){const t=n[1].split(this.formatSeparator).map((t=>t.trim()));n[1]=t.shift(),a=t,l=!0}if(r=e(o.call(this,n[1].trim(),i),i),r&&n[0]===t&&!rc(r))return r;rc(r)||(r=sc(r)),r||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${t}`),r=""),l&&(r=a.reduce(((t,e)=>this.format(t,e,s.lng,{...s,interpolationkey:n[1].trim()})),r.trim())),t=t.replace(n[0],r),this.regexp.lastIndex=0}return t}}const Fc=t=>{const e={};return(n,r,i)=>{let s=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(s={...s,[i.interpolationkey]:void 0});const o=r+JSON.stringify(s);let a=e[o];return a||(a=t(xc(r),i),e[o]=a),a(n)}};class Nc{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=bc.create("formatter"),this.options=t,this.formats={number:Fc(((t,e)=>{const n=new Intl.NumberFormat(t,{...e});return t=>n.format(t)})),currency:Fc(((t,e)=>{const n=new Intl.NumberFormat(t,{...e,style:"currency"});return t=>n.format(t)})),datetime:Fc(((t,e)=>{const n=new Intl.DateTimeFormat(t,{...e});return t=>n.format(t)})),relativetime:Fc(((t,e)=>{const n=new Intl.RelativeTimeFormat(t,{...e});return t=>n.format(t,e.range||"day")})),list:Fc(((t,e)=>{const n=new Intl.ListFormat(t,{...e});return t=>n.format(t)}))},this.init(t)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=e.interpolation.formatSeparator||","}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=Fc(e)}format(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=e.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find((t=>t.indexOf(")")>-1))){const t=i.findIndex((t=>t.indexOf(")")>-1));i[0]=[i[0],...i.splice(1,t)].join(this.formatSeparator)}const s=i.reduce(((t,e)=>{const{formatName:i,formatOptions:s}=(t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const i=r[1].substring(0,r[1].length-1);"currency"===e&&i.indexOf(":")<0?n.currency||(n.currency=i.trim()):"relativetime"===e&&i.indexOf(":")<0?n.range||(n.range=i.trim()):i.split(";").forEach((t=>{if(t){const[e,...r]=t.split(":"),i=r.join(":").trim().replace(/^'+|'+$/g,""),s=e.trim();n[s]||(n[s]=i),"false"===i&&(n[s]=!1),"true"===i&&(n[s]=!0),isNaN(i)||(n[s]=parseInt(i,10))}}))}return{formatName:e,formatOptions:n}})(e);if(this.formats[i]){let e=t;try{const o=r?.formatParams?.[r.interpolationkey]||{},a=o.locale||o.lng||r.locale||r.lng||n;e=this.formats[i](t,a,{...s,...r,...o})}catch(t){this.logger.warn(t)}return e}return this.logger.warn(`there was no format function for ${i}`),t}),t);return s}}class Bc extends Tc{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=t,this.store=e,this.services=n,this.languageUtils=n.languageUtils,this.options=r,this.logger=bc.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(n,r.backend,r)}queueLoad(t,e,n,r){const i={},s={},o={},a={};return t.forEach((t=>{let r=!0;e.forEach((e=>{const o=`${t}|${e}`;!n.reload&&this.store.hasResourceBundle(t,e)?this.state[o]=2:this.state[o]<0||(1===this.state[o]?void 0===s[o]&&(s[o]=!0):(this.state[o]=1,r=!1,void 0===s[o]&&(s[o]=!0),void 0===i[o]&&(i[o]=!0),void 0===a[e]&&(a[e]=!0)))})),r||(o[t]=!0)})),(Object.keys(i).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(i),pending:Object.keys(s),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(a)}}loaded(t,e,n){const r=t.split("|"),i=r[0],s=r[1];e&&this.emit("failedLoading",i,s,e),!e&&n&&this.store.addResourceBundle(i,s,n,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&n&&(this.state[t]=0);const o={};this.queue.forEach((n=>{((t,e,n)=>{const{obj:r,k:i}=hc(t,e,Object);r[i]=r[i]||[],r[i].push(n)})(n.loaded,[i],s),((t,e)=>{void 0!==t.pending[e]&&(delete t.pending[e],t.pendingCount--)})(n,t),e&&n.errors.push(e),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((t=>{o[t]||(o[t]={});const e=n.loaded[t];e.length&&e.forEach((e=>{void 0===o[t][e]&&(o[t][e]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",o),this.queue=this.queue.filter((t=>!t.done))}read(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!t.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:t,ns:e,fcName:n,tried:r,wait:i,callback:s});this.readingCalls++;const o=(o,a)=>{if(this.readingCalls--,this.waitingReads.length>0){const t=this.waitingReads.shift();this.read(t.lng,t.ns,t.fcName,t.tried,t.wait,t.callback)}o&&a&&r<this.maxRetries?setTimeout((()=>{this.read.call(this,t,e,n,r+1,2*i,s)}),i):s(o,a)},a=this.backend[n].bind(this.backend);if(2!==a.length)return a(t,e,o);try{const n=a(t,e);n&&"function"==typeof n.then?n.then((t=>o(null,t))).catch(o):o(null,n)}catch(t){o(t)}}prepareLoading(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();rc(t)&&(t=this.languageUtils.toResolveHierarchy(t)),rc(e)&&(e=[e]);const i=this.queueLoad(t,e,n,r);if(!i.toLoad.length)return i.pending.length||r(),null;i.toLoad.forEach((t=>{this.loadOne(t)}))}load(t,e,n){this.prepareLoading(t,e,{},n)}reload(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}loadOne(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=t.split("|"),r=n[0],i=n[1];this.read(r,i,"read",void 0,void 0,((n,s)=>{n&&this.logger.warn(`${e}loading namespace ${i} for language ${r} failed`,n),!n&&s&&this.logger.log(`${e}loaded namespace ${i} for language ${r}`,s),this.loaded(t,n,s)}))}saveMissing(t,e,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(!this.services?.utils?.hasLoadedNamespace||this.services?.utils?.hasLoadedNamespace(e)){if(null!=n&&""!==n){if(this.backend?.create){const a={...s,isUpdate:i},l=this.backend.create.bind(this.backend);if(l.length<6)try{let i;i=5===l.length?l(t,e,n,r,a):l(t,e,n,r),i&&"function"==typeof i.then?i.then((t=>o(null,t))).catch(o):o(null,i)}catch(t){o(t)}else l(t,e,n,r,o,a)}t&&t[0]&&this.store.addResource(t[0],e,n,r)}}else this.logger.warn(`did not save key "${n}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const Wc=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if("object"==typeof t[1]&&(e=t[1]),rc(t[1])&&(e.defaultValue=t[1]),rc(t[2])&&(e.tDescription=t[2]),"object"==typeof t[2]||"object"==typeof t[3]){const n=t[3]||t[2];Object.keys(n).forEach((t=>{e[t]=n[t]}))}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),Uc=t=>(rc(t.ns)&&(t.ns=[t.ns]),rc(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),rc(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs?.indexOf?.("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),"boolean"==typeof t.initImmediate&&(t.initAsync=t.initImmediate),t),jc=()=>{};class Hc extends Tc{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;var n;if(super(),this.options=Uc(t),this.services={},this.logger=bc,this.modules={external:[]},n=this,Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach((t=>{"function"==typeof n[t]&&(n[t]=n[t].bind(n))})),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout((()=>{this.init(t,e)}),0)}}init(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof e&&(n=e,e={}),null==e.defaultNS&&e.ns&&(rc(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const r=Wc();this.options={...r,...this.options,...Uc(e)},this.options.interpolation={...r.interpolation,...this.options.interpolation},void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);const i=t=>t?"function"==typeof t?new t:t:null;if(!this.options.isClone){let e;this.modules.logger?bc.init(i(this.modules.logger),this.options):bc.init(null,this.options),e=this.modules.formatter?this.modules.formatter:Nc;const n=new Mc(this.options);this.store=new Sc(this.options.resources,this.options);const s=this.services;s.logger=bc,s.resourceStore=this.store,s.languageUtils=n,s.pluralResolver=new Rc(n,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!e||this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format||(s.formatter=i(e),s.formatter.init(s,this.options),this.options.interpolation.format=s.formatter.format.bind(s.formatter)),s.interpolator=new Dc(this.options),s.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},s.backendConnector=new Bc(i(this.modules.backend),s.resourceStore,s,this.options),s.backendConnector.on("*",(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit(e,...r)})),this.modules.languageDetector&&(s.languageDetector=i(this.modules.languageDetector),s.languageDetector.init&&s.languageDetector.init(s,this.options.detection,this.options)),this.modules.i18nFormat&&(s.i18nFormat=i(this.modules.i18nFormat),s.i18nFormat.init&&s.i18nFormat.init(this)),this.translator=new kc(this.services,this.options),this.translator.on("*",(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit(e,...r)})),this.modules.external.forEach((t=>{t.init&&t.init(this)}))}if(this.format=this.options.interpolation.format,n||(n=jc),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const t=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);t.length>0&&"dev"!==t[0]&&(this.options.lng=t[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((e=>{this[e]=function(){return t.store[e](...arguments)}})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((e=>{this[e]=function(){return t.store[e](...arguments),t}}));const s=ic(),o=()=>{const t=(t,e)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),s.resolve(e),n(t,e)};if(this.languages&&!this.isInitialized)return t(null,this.t.bind(this));this.changeLanguage(this.options.lng,t)};return this.options.resources||!this.options.initAsync?o():setTimeout(o,0),s}loadResources(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jc;const n=rc(t)?t:this.language;if("function"==typeof t&&(e=t),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===n?.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return e();const t=[],r=e=>{e&&"cimode"!==e&&this.services.languageUtils.toResolveHierarchy(e).forEach((e=>{"cimode"!==e&&t.indexOf(e)<0&&t.push(e)}))};n?r(n):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((t=>r(t))),this.options.preload?.forEach?.((t=>r(t))),this.services.backendConnector.load(t,this.options.ns,(t=>{t||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),e(t)}))}else e(null)}reloadResources(t,e,n){const r=ic();return"function"==typeof t&&(n=t,t=void 0),"function"==typeof e&&(n=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),n||(n=jc),this.services.backendConnector.reload(t,e,(t=>{r.resolve(),n(t)})),r}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&Ac.addPostProcessor(t),"formatter"===t.type&&(this.modules.formatter=t),"3rdParty"===t.type&&this.modules.external.push(t),this}setResolvedLanguage(t){if(t&&this.languages&&!(["cimode","dev"].indexOf(t)>-1))for(let t=0;t<this.languages.length;t++){const e=this.languages[t];if(!(["cimode","dev"].indexOf(e)>-1)&&this.store.hasLanguageSomeTranslations(e)){this.resolvedLanguage=e;break}}}changeLanguage(t,e){var n=this;this.isLanguageChangingTo=t;const r=ic();this.emit("languageChanging",t);const i=t=>{this.language=t,this.languages=this.services.languageUtils.toResolveHierarchy(t),this.resolvedLanguage=void 0,this.setResolvedLanguage(t)},s=(t,s)=>{s?(i(s),this.translator.changeLanguage(s),this.isLanguageChangingTo=void 0,this.emit("languageChanged",s),this.logger.log("languageChanged",s)):this.isLanguageChangingTo=void 0,r.resolve((function(){return n.t(...arguments)})),e&&e(t,(function(){return n.t(...arguments)}))},o=e=>{t||e||!this.services.languageDetector||(e=[]);const n=rc(e)?e:this.services.languageUtils.getBestMatchFromCodes(e);n&&(this.language||i(n),this.translator.language||this.translator.changeLanguage(n),this.services.languageDetector?.cacheUserLanguage?.(n)),this.loadResources(n,(t=>{s(t,n)}))};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t):o(this.services.languageDetector.detect()),r}getFixedT(t,e,n){var r=this;const i=function(t,e){let s;if("object"!=typeof e){for(var o=arguments.length,a=new Array(o>2?o-2:0),l=2;l<o;l++)a[l-2]=arguments[l];s=r.options.overloadTranslationOptionHandler([t,e].concat(a))}else s={...e};s.lng=s.lng||i.lng,s.lngs=s.lngs||i.lngs,s.ns=s.ns||i.ns,""!==s.keyPrefix&&(s.keyPrefix=s.keyPrefix||n||i.keyPrefix);const h=r.options.keySeparator||".";let c;return c=s.keyPrefix&&Array.isArray(t)?t.map((t=>`${s.keyPrefix}${h}${t}`)):s.keyPrefix?`${s.keyPrefix}${h}${t}`:t,r.t(c,s)};return rc(t)?i.lng=t:i.lngs=t,i.ns=e,i.keyPrefix=n,i}t(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.translator?.translate(...e)}exists(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.translator?.exists(...e)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=e.lng||this.resolvedLanguage||this.languages[0],r=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;const s=(t,e)=>{const n=this.services.backendConnector.state[`${t}|${e}`];return-1===n||0===n||2===n};if(e.precheck){const t=e.precheck(this,s);if(void 0!==t)return t}return!(!this.hasResourceBundle(n,t)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!s(n,t)||r&&!s(i,t)))}loadNamespaces(t,e){const n=ic();return this.options.ns?(rc(t)&&(t=[t]),t.forEach((t=>{this.options.ns.indexOf(t)<0&&this.options.ns.push(t)})),this.loadResources((t=>{n.resolve(),e&&e(t)})),n):(e&&e(),Promise.resolve())}loadLanguages(t,e){const n=ic();rc(t)&&(t=[t]);const r=this.options.preload||[],i=t.filter((t=>r.indexOf(t)<0&&this.services.languageUtils.isSupportedCode(t)));return i.length?(this.options.preload=r.concat(i),this.loadResources((t=>{n.resolve(),e&&e(t)})),n):(e&&e(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!t)return"rtl";const e=this.services?.languageUtils||new Mc(Wc());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(e.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new Hc(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jc;const n=t.forkResourceStore;n&&delete t.forkResourceStore;const r={...this.options,...t,isClone:!0},i=new Hc(r);if(void 0===t.debug&&void 0===t.prefix||(i.logger=i.logger.clone(t)),["store","services","language"].forEach((t=>{i[t]=this[t]})),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},n){const t=Object.keys(this.store.data).reduce(((t,e)=>(t[e]={...this.store.data[e]},Object.keys(t[e]).reduce(((n,r)=>(n[r]={...t[e][r]},n)),{}))),{});i.store=new Sc(t,r),i.services.resourceStore=i.store}return i.translator=new kc(i.services,r),i.translator.on("*",(function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];i.emit(t,...n)})),i.init(r,e),i.translator.options=r,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const zc=Hc.createInstance();zc.createInstance=Hc.createInstance,zc.createInstance,zc.dir,zc.init,zc.loadResources,zc.reloadResources,zc.use,zc.changeLanguage,zc.getFixedT,zc.t,zc.exists,zc.setDefaultNamespace,zc.hasLoadedNamespace,zc.loadNamespaces,zc.loadLanguages;var Gc=JSON.parse('{"ru":{"langName":"Русский","textLoading":"Загрузка","textLoadingSkinPart":"этап","btnStart":"ИГРАТЬ","Leaders":"Лидеры","store":"Магазин","free":"БЕСПЛАТНО","purchased":"КУПЛЕНО","purchaseError":"К сожалению,\\nпокупка не удалась. Попробуйте позже!","level":"Уровень","notEnoughHints":"Недостаточно подсказок","loadErr":"Что-то пошло не так.\\nПовторная попытка","rateUs":"Поставьте игре 5 звезд\\nи получите 5 подсказок!","rateUsBtnLater":"ПОЗЖЕ","rateUsBtnGive":"ПОСТАВИТЬ","authorizationHeader":"АВТОРИЗАЦИЯ","authorizationText1":"• надежное сохранение прогресса","authorizationText2":"• доступ к таблице лидеров","authorizationBtn":"ВОЙТИ","difficultyLevels.hard":"сложный","difficultyLevels.veryHard":"очень сложный","difficultyLevels.extreme":"экстремальный","promoStartedPack.header":"Набор новичка","promoStartedPack.description":"Отключите рекламу\\nи получите 30 подсказок!","promoRemoveAdPack.header":"Разовое предложение","promoRemoveAdPack.description":"Отключение рекламы\\nсо скидкой!","promoMegaHintsPack.header":"Разовое предложение","promoMegaHintsPack.description":"50 подсказок со скидкой!","learning.shadows":"В этом режиме предметы отображаются в виде силуэтов.","learning.words":"В этом режиме предметы указаны словами, без изображений. Ищите их на уровне, опираясь только на названия.","learning.generator":"Добро пожаловать в бонусный уровень! Здесь вам предстоит найти нужные предметы среди множества похожих."},"en":{"langName":"English","textLoading":"Loading","textLoadingSkinPart":"Stage","btnStart":"PLAY","Leaders":"Leaders","store":"Shop","free":"FREE","purchased":"PURCHASED","purchaseError":"Sorry, your purchase\\nwas unsuccessful.\\nPlease try again\\nlater!","level":"Level","notEnoughHints":"Not enough hints","loadErr":"Something went wrong.\\nRepeat attempt","rateUs":"Give the game 5 stars\\nand get 5 hints!","rateUsBtnLater":"LATER","rateUsBtnGive":"RATE","authorizationHeader":"AUTHORIZATION","authorizationText1":"• secure progress saving","authorizationText2":"• access to the leaderboard","authorizationBtn":"LOGIN","difficultyLevels.hard":"hard","difficultyLevels.veryHard":"very hard","difficultyLevels.extreme":"extreme","promoStartedPack.header":"Starter Kit","promoStartedPack.description":"Turn off ads and get\\n30 hints!","promoRemoveAdPack.header":"One-Time Offer","promoRemoveAdPack.description":"Ad Removal – Discounted!","promoMegaHintsPack.header":"One-Time Offer","promoMegaHintsPack.description":"50 Hints Pack – Discounted!","learning.shadows":"In this mode, objects are displayed as silhouettes.","learning.words":"In this mode, objects are listed with words only, without images. Find them based solely on their names.","learning.generator":"Welcome to the bonus level! Here you need to find the required objects among many similar ones."}}'),Vc=(r(113),r(4423),r(9432),r(6034),r(1415),r(1699),r(2577),{SDK:"SDK",Player:"Player",Metrika:"Metrika",GamePreload:"GamePreload",StateGame:"StateGame",LevelPreload:"LevelPreload",DestroyMessage:"DestroyMessage",Config:"config",SOUND_MANAGER:"SOUND_MANAGER",Hud:"Hud"}),Xc={default:"#00A5FE",sdk:"#28FF5A",player:"#00DEFE",metrika:"#BBFE64",gamePreload:"yellow",lvlPreload:"orange",config:"#FEE000",destroy:"#D764FE",warning:"tomato",error:"red",green:"#08FE00"},Yc=function(t){var e=Object.keys(Xc).find((function(e){return e.toLowerCase()===t.toLowerCase()}));return e?Xc[e]:Xc.default},$c=new Set;$c.add(Vc.Config);var qc=_((function t(){v(this,t)}),null,[{key:"log",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if($c.has(t)){var s;(s=console).log.apply(s,["%c[".concat(t,"]"),"color: ".concat(Yc(t)),e].concat(r))}else{var o;if(Object.values(Vc).includes(t))return;(o=console).log.apply(o,["%c[Logger]","color: ".concat(Yc(t)),t,e].concat(r))}}},{key:"warn",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if($c.has(t)){var s;(s=console).warn.apply(s,["[".concat(t,"]"),e].concat(r))}else{var o;if(Object.values(Vc).includes(t))return;(o=console).log.apply(o,["%c[Logger]","color: ".concat(Xc.warning),e].concat(r))}}},{key:"error",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if($c.has(t)){var s;(s=console).error.apply(s,["%c[".concat(t,"]"),"color: ".concat(Yc(t)),"❌"+e].concat(r))}else{var o;if(Object.values(Vc).includes(t))return;(o=console).error.apply(o,["%c[Logger]","color: ".concat(Yc(t)),t,"❌"+e].concat(r))}}}]),Kc=_((function t(e){var n=this;v(this,t),E(this,"isInitialized",!1),E(this,"game",null),E(this,"view",null),E(this,"checkInitialize",(function(){n.isInitialized||n.initialize()})),this.game=e,this.game.on(this.initEventName,this.checkInitialize)}),[{key:"initEventName",get:function(){return"baseState"}},{key:"initialize",value:function(){this.game.currentStateName=this.initEventName,this.game.emit("checkoutState",this.initEventName)}},{key:"update",value:function(){}},{key:"resize",value:function(){}},{key:"terminate",value:function(){}}]);function Zc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Qc(t,e){if(t){if("string"==typeof t)return Zc(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zc(t,e):void 0}}function Jc(t){return function(t){if(Array.isArray(t))return Zc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Qc(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r(2062),r(9085),r(1454);var tu=function(t,e){try{var n=null;if(t.prototype instanceof Qi)if(t===wl)try{n=new t([vr.EMPTY])}catch(t){console.log(["createElement AnimatedSprite"],t)}else n=new t;else n=t(e);e&&e.ref&&e.ref(n);for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return i.forEach((function(t){return eu(n,t)})),n.once("added",(function(){e&&nu(n,e)})),n}catch(t){console.log(["createElement"],t)}},eu=function(t,e){Array.isArray(e)?e.forEach((function(e){eu(t,e)})):t.addChild(e)};function nu(t,e){Object.keys(e).forEach((function(n){var r;"texture"!==n?"textures"!==n?"classes"!==n?"position"!==n?t[n]=e[n]:(r=t.position).set.apply(r,Jc(e.position)):function(t,e){t.classes||Object.defineProperty(t,"classes",{get:function(){return t._classes},set:function(e){t._classes||(t._classes={}),Object.assign(t._classes,e);var n={};for(var r in t._classes)"function"==typeof t._classes[r]?n[r]=t._classes[r]():n[r]=t._classes[r];nu(t,n)}}),t.classes=e.classes}(t,e):t.textures=e.textures.map((function(t){return ru(t)})):t.texture=ru(e.texture)}))}function ru(t){try{if("string"==typeof t){var e=vr.from(t);return e!==vr.EMPTY?e:Fo.get(t)||vr.WHITE}return t instanceof vr?t:vr.WHITE}catch(e){return console.error("getTexture",t,e),vr.WHITE}}function iu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,s,o,a=[],l=!0,h=!1;try{if(s=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){h=!0,i=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(h)throw i}}return a}}(t,e)||Qc(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function su(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ou(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?su(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):su(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function au(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function lu(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function hu(t,e){return t.get(uu(t,e))}function cu(t,e,n){return t.set(uu(t,e),n),n}function uu(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}r(5276),r(3362),r(7495),r(9479),r(1761),r(8156),r(2675),r(9463),r(2259),r(2008),r(3418),r(4782),r(3851),r(1278),r(906),r(4520),r(739),r(3110),r(8940),r(8781),r(3365),r(3296),r(7208),r(8408);var du,fu=4e-4,pu="btnFree",mu="btnHint",gu={isTutorialCompleted:E(E(E({},lh,!1),hh,!1),ch,!1),partIndex:1},vu=new WeakMap,yu=new WeakMap,xu=new WeakMap,wu=new WeakMap,_u=new WeakMap,bu=new WeakMap,Tu=new WeakMap,Su=new WeakMap,Au=new WeakMap,Eu=new WeakMap,Cu=new WeakMap,ku=new WeakMap,Mu=new WeakMap,Pu=new WeakMap,Iu=new WeakMap,Ru=new WeakMap,Ou=new WeakMap,Lu=new WeakMap,Du=new WeakMap,Fu=new WeakMap,Nu=function(){return _((function t(e){var n=this;return v(this,t),lu(this,vu,null),lu(this,yu,void 0),lu(this,xu,void 0),lu(this,wu,void 0),lu(this,_u,void 0),lu(this,bu,void 0),lu(this,Tu,void 0),lu(this,Su,void 0),lu(this,Au,void 0),E(this,"isLight",void 0),lu(this,Eu,void 0),E(this,"hasAdPass",void 0),lu(this,Cu,gu),lu(this,ku,(function(){cu(yu,n,fu),cu(xu,n,{levelIndex:0,skinIndex:1}),cu(wu,n,1),cu(_u,n,3),cu(bu,n,777),cu(Tu,n,!0),cu(Su,n,!0),cu(Au,n,!1),n.isLight=!0,cu(Eu,n,E(E({},pu,null),mu,null)),n.hasAdPass=!1,cu(Cu,n,gu),qc.log(Vc.Player,"установлены default параметры")})),E(this,"addHints",function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(hu(Du,n).call(n,e)){t.next=3;break}return console.error("Игроку пытались добавить невалидный hint:",e),t.abrupt("return");case 3:return cu(_u,n,hu(_u,n)+e),hu(vu,n).emit(Mh,hu(_u,n)),t.next=7,n.saveData();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),E(this,"spendHints",(function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];cu(_u,n,hu(_u,n)-1),hu(vu,n).emit(Mh,hu(_u,n)),t&&n.saveData()})),lu(this,Mu,(function(){var t=localStorage.getItem("playerData");if(t)return qc.log(Vc.Player,"загружено из localStorage"),JSON.parse(t)})),lu(this,Pu,function(){var t=Jh(nc().mark((function t(e){var r,i,s=arguments;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=s.length>1&&void 0!==s[1]&&s[1],cu(yu,n,fu),r?(i={userLevel:e.userLevel,savedLevel:e.savedLevel,hints:e.hints,coins:e.coins,hasAdPass:e.hasAdPass,config:e.config},hu(ku,n).call(n),void 0!==i.userLevel&&cu(wu,n,i.userLevel),void 0!==i.savedLevel&&cu(xu,n,i.savedLevel),void 0!==i.hints&&cu(_u,n,i.hints),void 0!==i.coins&&cu(bu,n,i.coins),void 0!==i.hasAdPass&&(n.hasAdPass=i.hasAdPass),void 0!==i.config&&cu(Cu,n,i.config)):(void 0!==e.version&&cu(yu,n,e.version),void 0!==e.savedLevel&&cu(xu,n,e.savedLevel),void 0!==e.userLevel&&cu(wu,n,e.userLevel),void 0!==e.hints&&cu(_u,n,e.hints),void 0!==e.coins&&cu(bu,n,e.coins),void 0!==e.isPlayMusic&&cu(Tu,n,e.isPlayMusic),void 0!==e.isPlaySfx&&cu(Su,n,e.isPlaySfx),void 0!==e.isDebug&&cu(Au,n,e.isDebug),void 0!==e.isLight&&(n.isLight=e.isLight),void 0!==e.timers&&cu(Eu,n,e.timers),void 0!==e.hasAdPass&&(n.hasAdPass=e.hasAdPass),cu(Cu,n,hu(Fu,n).call(n,gu,e.config)));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),lu(this,Iu,(function(){localStorage.clear(),hu(ku,n).call(n),n.saveData(),console.warn("СБРОС ДАННЫХ! ТОЛЬКО ДЛЯ ТЕСТИРОВАНИЯ!")})),lu(this,Ru,(function(){n.addLevel=1,_SERVICE.submitRecord(n.userLevel)})),E(this,"setEvents",(function(){hu(vu,n).on(Ih,hu(Ru,n)),hu(vu,n).on(gh,n.spendHints)})),lu(this,Ou,(function(t){var e=hu(Lu,n).call(n);if(e){var r=e.levelIndex,i=e.skinIndex;t.savedLevel={levelIndex:r,skinIndex:i},cu(wu,n,r+1)}})),lu(this,Lu,(function(){var t,e=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,e){if(t){if("string"==typeof t)return au(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?au(t,e):void 0}}(t))){e&&(t=e);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,o=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){o=!0,i=t},f:function(){try{s||null==e.return||e.return()}finally{if(o)throw i}}}}(new URLSearchParams(location.search).entries());try{for(e.s();!(t=e.n()).done;){var n=iu(t.value,1)[0],r=n.match(/^level(\d+)(part(\d+))?$/i);if(r){var i,s=parseInt(r[1],10),o=parseInt(null!==(i=r[3])&&void 0!==i?i:"1",10),a=new URL(location.href);return a.searchParams.delete(n),history.replaceState(null,"",a.toString()),{levelIndex:s,skinIndex:o}}}}catch(t){e.e(t)}finally{e.f()}return null})),lu(this,Du,(function(t){return"number"==typeof t&&!isNaN(t)})),lu(this,Fu,(function(t,e){return ou(ou({},t),null!=e?e:{})})),"object"===y(t.instance)||(cu(vu,this,e),this.setEvents(),t.instance=this),t.instance}),[{key:"config",get:function(){return hu(Cu,this)}},{key:"savedLevel",get:function(){return hu(xu,this)},set:function(t){var e,n;cu(xu,this,{levelIndex:null!==(e=t.levelIndex)&&void 0!==e?e:0,skinIndex:null!==(n=t.skinIndex)&&void 0!==n?n:1}),this.saveData()}},{key:"userLevel",get:function(){return hu(wu,this)}},{key:"addLevel",set:function(t){cu(wu,this,hu(wu,this)+t)}},{key:"hints",get:function(){return hu(_u,this)}},{key:"addHintTest",value:function(t){return cu(_u,this,hu(_u,this)+t)}},{key:"coins",get:function(){return hu(bu,this)}},{key:"addCoins",value:function(t){return cu(bu,this,hu(bu,this)+t)}},{key:"addMoney",set:function(t){hu(Du,this).call(this,t)||(cu(bu,this,hu(bu,this)+t),hu(vu,this).emit(Ph,hu(bu,this)),this.saveData())}},{key:"spendMoney",set:function(t){cu(bu,this,hu(bu,this)-t),hu(vu,this).emit(Ph,hu(bu,this)),this.saveData()}},{key:"isPlayMusic",get:function(){return hu(Tu,this)},set:function(t){cu(Tu,this,t)}},{key:"isPlaySfx",get:function(){return hu(Su,this)},set:function(t){cu(Su,this,t)}},{key:"isDebug",get:function(){return hu(Au,this)},set:function(t){cu(Au,this,t)}},{key:"timers",get:function(){return hu(Eu,this)},set:function(t){cu(Eu,this,t),this.saveData()}},{key:"saveData",value:(e=Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={version:hu(yu,this),savedLevel:hu(xu,this),userLevel:hu(wu,this),hints:hu(_u,this),coins:hu(bu,this),isPlayMusic:hu(Tu,this),isPlaySfx:hu(Su,this),isDebug:hu(Au,this),isLight:this.isLight,timers:hu(Eu,this),hasAdPass:this.hasAdPass,config:hu(Cu,this)},localStorage.setItem("playerData",JSON.stringify(e)),qc.log(Vc.Player,"данные сохранены"),t.abrupt("return",_SERVICE.setData(e));case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"loadData",value:(t=Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,t.prev=1,t.next=4,_SERVICE.loadData();case 4:e=t.sent,hu(Ou,this).call(this,e),e&&0!==Object.keys(e).length||(qc.log(Vc.Player,"данные SDK не обнаружены, ищу в localStorage"),e=hu(Mu,this).call(this)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),qc.log(Vc.Player,"Ошибка при загрузке из SDK, загружаю из localStorage:",t.t0),e=hu(Mu,this).call(this);case 13:if(!e){t.next=28;break}if(e.version===fu){t.next=21;break}return qc.warn(Vc.Player,"data.version",e.version,"/","current.version",fu),qc.warn(Vc.Player,"Обнаружена устаревшая версия данных, актуализирую..."),t.next=19,hu(Pu,this).call(this,e,!0);case 19:t.next=24;break;case 21:return t.next=23,hu(Pu,this).call(this,e);case 23:qc.log(Vc.Player,"Данные успешно загружены");case 24:return t.next=26,this.saveData();case 26:t.next=30;break;case 28:qc.log(Vc.Player,"Данные отсутствуют как в Yandex SDK, так и в localStorage"),hu(ku,this).call(this);case 30:case"end":return t.stop()}}),t,this,[[1,9]])}))),function(){return t.apply(this,arguments)})}]);var t,e}(),Bu=_((function t(){v(this,t)}),null,[{key:"showFps",value:function(t,e){var n=new Ms("",{fontSize:30,fill:4909312,stroke:0,strokeThickness:2});n.position.set(10,120),e.ui.addChild(n),t.ticker.add((function(){n.text="v".concat(fu,"\nFPS: ").concat(Math.round(t.ticker.FPS))}))}}]);du=Bu,E(Bu,"sayHello",(function(){new Pi({hello:!0})})),E(Bu,"createSpriteSheet",function(){var t=Jh(nc().mark((function t(e,n){var r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new bl(e,n),t.next=3,r.parse();case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),E(Bu,"isStringTrue",(function(t){return!0===t||"true"===t})),E(Bu,"extractSuffix",(function(t){var e=t.match(/_(.+)$/);return e?e[1]:null})),E(Bu,"checkWebp",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"jpg";return"undefined"==typeof document?t:0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")?"webp":t})),E(Bu,"detectLevelType",(function(t){var e=du.extractSuffix(t),n=E(E(E({},lh,{statusFlag:du.isStringTrue(_SERVICE.flags.useHudShadow)}),hh,{statusFlag:du.isStringTrue(_SERVICE.flags.useHudWords)}),ch,{statusFlag:du.isStringTrue(_SERVICE.flags.useLevelTypeGeneration)})[e];return n?{leveTypelName:e,statusFlag:n.statusFlag}:(console.log("[detectLevelType]: тип специального уровня не обнаружен"),Promise.resolve(!1))}));var Wu=function(t){var e=Object.keys(t).map((function(e){return t[e].resize?Promise.resolve(t[e].resize()):Promise.resolve()}));return Promise.all(e)},Uu=function(t){return new Promise((function(e){navigator.onLine?e():(t.text="Вы оффлайн...",qc.warn(Vc.LevelPreload,"Ожидание восстановления сети..."),window.addEventListener("online",e,{once:!0}))}))},ju=function(){var t=Jh(nc().mark((function t(e){var n;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:return(n=t.sent).ok||console.error("Ошибка загрузки JSON: ".concat(n.status)),t.next=7,n.json();case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(0),console.error("Ошибка при загрузке JSON:",t.t0),t.abrupt("return",Promise.resolve(!1));case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),Hu=function(){var t=Jh(nc().mark((function t(e){var n;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:return(n=t.sent).ok||console.error("Ошибка загрузки .atlas: ".concat(n.status)),t.next=7,n.text();case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(0),console.error("Ошибка при загрузке ATLAS:",t.t0),t.abrupt("return",Promise.resolve(!1));case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),zu=function(t){var e=Math.floor(t/1e3),n=Math.floor(e/60),r=e%60;return{minutes:String(n).padStart(2,"0"),seconds:String(r).padStart(2,"0")}},Gu=(r(4864),r(7465),r(7745),function(t){return new Proxy(t,{get:function(t,e,n){var r=function(t){var e=Object.keys(t),n=new RegExp(/\(.*\)/);return e.filter((function(t){return n.test(t)}))}(t).filter((function(n){return!!t[n].hasOwnProperty(e)&&matchMedia(n).matches}));return 0===r.length?t[e]:t[r[r.length-1]][e]}})}),Vu=function(t,e){var n=t.uiInner,r=function(n){if(n.classes){if(!n.name)return void console.warn("".concat(n," нет имени!"));var i=e(t)[n.name];if(!i)return;n.classes=Gu(i)}n.children&&n.children.length>0&&n.children.forEach(r)};n.children.forEach(r)};class Xu extends sr{constructor(t=4,e=3,n=!1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",n?"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}\n":"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}"),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new mn,this.pixelSize=1,this._clamp=n,Array.isArray(t)?this.kernels=t:(this._blur=t,this.quality=e)}apply(t,e,n,r){const i=this._pixelSize.x/e._frame.width,s=this._pixelSize.y/e._frame.height;let o;if(1===this._quality||0===this._blur)o=this._kernels[0]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*s,t.applyFilter(this,e,n,r);else{const a=t.getFilterTexture();let l,h=e,c=a;const u=this._quality-1;for(let e=0;e<u;e++)o=this._kernels[e]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*s,t.applyFilter(this,h,c,1),l=h,h=c,c=l;o=this._kernels[u]+.5,this.uniforms.uOffset[0]=o*i,this.uniforms.uOffset[1]=o*s,t.applyFilter(this,h,n,r),t.returnFilterTexture(a)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce(((t,e)=>t+e+.5),0))}_generateKernels(){const t=this._blur,e=this._quality,n=[t];if(t>0){let r=t;const i=t/e;for(let t=1;t<e;t++)r-=i,n.push(r)}this._kernels=n,this._updatePadding()}get kernels(){return this._kernels}set kernels(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max(...t)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(t){"number"==typeof t?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof mn?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}get blur(){return this._blur}set blur(t){this._blur=t,this._generateKernels()}}var Yu="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}";class $u extends sr{constructor(t=.5){super(Yu,"\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform float threshold;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    // A simple & fast algorithm for getting brightness.\n    // It's inaccuracy , but good enought for this feature.\n    float _max = max(max(color.r, color.g), color.b);\n    float _min = min(min(color.r, color.g), color.b);\n    float brightness = (_max + _min) * 0.5;\n\n    if(brightness > threshold) {\n        gl_FragColor = color;\n    } else {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n}\n"),this.threshold=t}get threshold(){return this.uniforms.threshold}set threshold(t){this.uniforms.threshold=t}}const qu=class extends sr{constructor(t){super(Yu,"uniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D bloomTexture;\nuniform float bloomScale;\nuniform float brightness;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    color.rgb *= brightness;\n    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);\n    bloomColor.rgb *= bloomScale;\n    gl_FragColor = color + bloomColor;\n}\n"),this.bloomScale=1,this.brightness=1,this._resolution=Y.FILTER_RESOLUTION,"number"==typeof t&&(t={threshold:t});const e=Object.assign(qu.defaults,t);this.bloomScale=e.bloomScale,this.brightness=e.brightness;const{kernels:n,blur:r,quality:i,pixelSize:s,resolution:o}=e;this._extractFilter=new $u(e.threshold),this._extractFilter.resolution=o,this._blurFilter=n?new Xu(n):new Xu(r,i),this.pixelSize=s,this.resolution=o}apply(t,e,n,r,i){const s=t.getFilterTexture();this._extractFilter.apply(t,e,s,1,i);const o=t.getFilterTexture();this._blurFilter.apply(t,s,o,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=o,t.applyFilter(this,e,n,r),t.returnFilterTexture(o),t.returnFilterTexture(s)}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get threshold(){return this._extractFilter.threshold}set threshold(t){this._extractFilter.threshold=t}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};qu.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:Y.FILTER_RESOLUTION};const Ku=class extends sr{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","uniform float radius;\nuniform float strength;\nuniform vec2 center;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nvoid main()\n{\n    vec2 coord = vTextureCoord * filterArea.xy;\n    coord -= center * dimensions.xy;\n    float distance = length(coord);\n    if (distance < radius) {\n        float percent = distance / radius;\n        if (strength > 0.0) {\n            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n        } else {\n            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n        }\n    }\n    coord += center * dimensions.xy;\n    coord /= filterArea.xy;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    gl_FragColor = color;\n}\n"),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Ku.defaults,t)}apply(t,e,n,r){const{width:i,height:s}=e.filterFrame;this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=s,t.applyFilter(this,e,n,r)}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get strength(){return this.uniforms.strength}set strength(t){this.uniforms.strength=t}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}};var Zu;Ku.defaults={center:[.5,.5],radius:100,strength:1},(Zu=Zu||{}).stringify=function(){var t={"visit_linear-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return t.visit_gradient(e)},"visit_radial-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return t.visit_gradient(e)},visit_gradient:function(e){var n=t.visit(e.orientation);return n&&(n+=", "),e.type+"("+n+t.visit(e.colorStops)+")"},visit_shape:function(e){var n=e.value,r=t.visit(e.at),i=t.visit(e.style);return i&&(n+=" "+i),r&&(n+=" at "+r),n},"visit_default-radial":function(e){var n="",r=t.visit(e.at);return r&&(n+=r),n},"visit_extent-keyword":function(e){var n=e.value,r=t.visit(e.at);return r&&(n+=" at "+r),n},"visit_position-keyword":function(t){return t.value},visit_position:function(e){return t.visit(e.value.x)+" "+t.visit(e.value.y)},"visit_%":function(t){return t.value+"%"},visit_em:function(t){return t.value+"em"},visit_px:function(t){return t.value+"px"},visit_literal:function(e){return t.visit_color(e.value,e)},visit_hex:function(e){return t.visit_color("#"+e.value,e)},visit_rgb:function(e){return t.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return t.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,n){var r=e,i=t.visit(n.length);return i&&(r+=" "+i),r},visit_angular:function(t){return t.value+"deg"},visit_directional:function(t){return"to "+t.value},visit_array:function(e){var n="",r=e.length;return e.forEach((function(e,i){n+=t.visit(e),i<r-1&&(n+=", ")})),n},visit:function(e){if(!e)return"";if(e instanceof Array)return t.visit_array(e,"");if(e.type){var n=t["visit_"+e.type];if(n)return n(e);throw Error("Missing visitor visit_"+e.type)}throw Error("Invalid node.")}};return function(e){return t.visit(e)}}(),(Zu=Zu||{}).parse=function(){var t=/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,e=/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,n=/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,r=/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,i=/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,s=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,o=/^(left|center|right|top|bottom)/i,a=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,u=/^\(/,d=/^\)/,f=/^,/,p=/^\#([0-9a-fA-F]+)/,m=/^([a-zA-Z]+)/,g=/^rgb/i,v=/^rgba/i,y=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,x="";function w(t){var e=new Error(x+": "+t);throw e.source=x,e}function _(){return b("linear-gradient",t,S)||b("repeating-linear-gradient",e,S)||b("radial-gradient",n,A)||b("repeating-radial-gradient",r,A)}function b(t,e,n){return T(e,(function(e){var r=n();return r&&(F(f)||w("Missing comma before color stops")),{type:t,orientation:r,colorStops:P(I)}}))}function T(t,e){var n=F(t);if(n){F(u)||w("Missing (");var r=e(n);return F(d)||w("Missing )"),r}}function S(){return D("directional",i,1)||D("angular",c,1)}function A(){var t,e,n=E();return n&&((t=[]).push(n),e=x,F(f)&&((n=E())?t.push(n):x=e)),t}function E(){var t=function(){var t=D("shape",/^(circle)/i,0);return t&&(t.style=L()||C()),t}()||function(){var t=D("shape",/^(ellipse)/i,0);return t&&(t.style=O()||C()),t}();if(t)t.at=k();else{var e=C();if(e){t=e;var n=k();n&&(t.at=n)}else{var r=M();r&&(t={type:"default-radial",at:r})}}return t}function C(){return D("extent-keyword",s,1)}function k(){if(D("position",/^at/,0)){var t=M();return t||w("Missing positioning value"),t}}function M(){var t={x:O(),y:O()};if(t.x||t.y)return{type:"position",value:t}}function P(t){var e=t(),n=[];if(e)for(n.push(e);F(f);)(e=t())?n.push(e):w("One extra comma");return n}function I(){var t=D("hex",p,1)||T(v,(function(){return{type:"rgba",value:P(R)}}))||T(g,(function(){return{type:"rgb",value:P(R)}}))||D("literal",m,0);return t||w("Expected color definition"),t.length=O(),t}function R(){return F(y)[1]}function O(){return D("%",l,1)||D("position-keyword",o,1)||L()}function L(){return D("px",a,1)||D("em",h,1)}function D(t,e,n){var r=F(e);if(r)return{type:t,value:r[n]}}function F(t){var e,n;return(n=/^[\n\r\t\s]+/.exec(x))&&N(n[0].length),(e=t.exec(x))&&N(e[0].length),e}function N(t){x=x.substr(t)}return function(t){return x=t.toString(),function(){var t=P(_);return x.length>0&&w("Invalid input not EOF"),t}()}}();var Qu=Zu.parse;Zu.stringify;var Ju={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},td={red:0,orange:60,yellow:120,green:180,blue:240,purple:300},ed={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},nd={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,n,r,i,s,o=t[0]/360,a=t[1]/100,l=t[2]/100;if(0===a)return[s=255*l,s,s];e=2*l-(n=l<.5?l*(1+a):l+a-l*a),i=[0,0,0];for(var h=0;h<3;h++)(r=o+1/3*-(h-1))<0?r++:r>1&&r--,s=6*r<1?e+6*(n-e)*r:2*r<1?n:3*r<2?e+(n-e)*(2/3-r)*6:e,i[h]=255*s;return i}};function rd(t){switch(typeof t){case"string":return function(t){const e=function(t){Array.isArray(t)&&t.raw&&(t=String.raw(...arguments));var e,n=function(t){var e,n,r=[],i=1;if("string"==typeof t)if(Ju[t])r=Ju[t].slice(),n="rgb";else if("transparent"===t)i=0,n="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(t)){var s=t.slice(1);i=1,(l=s.length)<=4?(r=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===l&&(i=parseInt(s[3]+s[3],16)/255)):(r=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===l&&(i=parseInt(s[6]+s[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),n="rgb"}else if(e=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var o=e[1],a="rgb"===o;n=s=o.replace(/a$/,"");var l="cmyk"===s?4:"gray"===s?1:3;r=e[2].trim().split(/\s*[,\/]\s*|\s+/).map((function(t,e){if(/%$/.test(t))return e===l?parseFloat(t)/100:"rgb"===s?255*parseFloat(t)/100:parseFloat(t);if("h"===s[e]){if(/deg$/.test(t))return parseFloat(t);if(void 0!==td[t])return td[t]}return parseFloat(t)})),o===s&&r.push(1),i=a||void 0===r[l]?1:r[l],r=r.slice(0,l)}else t.length>10&&/[0-9](?:\s|\/)/.test(t)&&(r=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),n=t.match(/([a-z])/gi).join("").toLowerCase());else isNaN(t)?Array.isArray(t)||t.length?(r=[t[0],t[1],t[2]],n="rgb",i=4===t.length?t[3]:1):t instanceof Object&&(null!=t.r||null!=t.red||null!=t.R?(n="rgb",r=[t.r||t.red||t.R||0,t.g||t.green||t.G||0,t.b||t.blue||t.B||0]):(n="hsl",r=[t.h||t.hue||t.H||0,t.s||t.saturation||t.S||0,t.l||t.lightness||t.L||t.b||t.brightness]),i=t.a||t.alpha||t.opacity||1,null!=t.opacity&&(i/=100)):(n="rgb",r=[t>>>16,(65280&t)>>>8,255&t]);return{space:n,values:r,alpha:i}}(t);if(!n.space)return[];const r="h"===n.space[0]?nd.min:ed.min,i="h"===n.space[0]?nd.max:ed.max;return(e=Array(3))[0]=Math.min(Math.max(n.values[0],r[0]),i[0]),e[1]=Math.min(Math.max(n.values[1],r[1]),i[1]),e[2]=Math.min(Math.max(n.values[2],r[2]),i[2]),"h"===n.space[0]&&(e=nd.rgb(e)),e.push(Math.min(Math.max(n.alpha,0),1)),e}(t);if(!e)throw new Error(`Unable to parse color "${t}" as RGBA.`);return[e[0]/255,e[1]/255,e[2]/255,e[3]]}(t);case"number":return ne(t);default:return t}}function id(t){return rd(function(t){switch(t.type){case"hex":return`#${t.value}`;case"literal":return t.value;default:return`${t.type}(${t.value.join(",")})`}}(t))}function sd(t){return t.toString().length>6?parseFloat(t.toString().substring(0,6)):t}ed.hsl=function(t){var e,n,r=t[0]/255,i=t[1]/255,s=t[2]/255,o=Math.min(r,i,s),a=Math.max(r,i,s),l=a-o;return a===o?e=0:r===a?e=(i-s)/l:i===a?e=2+(s-r)/l:s===a&&(e=4+(r-i)/l),(e=Math.min(60*e,360))<0&&(e+=360),n=(o+a)/2,[e,100*(a===o?0:n<=.5?l/(a+o):l/(2-a-o)),100*n]};var od=Object.defineProperty,ad=Object.defineProperties,ld=Object.getOwnPropertyDescriptors,hd=Object.getOwnPropertySymbols,cd=Object.prototype.hasOwnProperty,ud=Object.prototype.propertyIsEnumerable,dd=(t,e,n)=>e in t?od(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fd=(t,e)=>{for(var n in e||(e={}))cd.call(e,n)&&dd(t,n,e[n]);if(hd)for(var n of hd(e))ud.call(e,n)&&dd(t,n,e[n]);return t};const pd=class extends sr{constructor(t){var e,n;let r;if(r=t&&"css"in t?((t,e)=>ad(t,ld(e)))(fd({},function(t){const e=Qu(function(t){let e=t.replace(/\s{2,}/gu," ");return e=e.replace(/;/g,""),e=e.replace(/ ,/g,","),e=e.replace(/\( /g,"("),e=e.replace(/ \)/g,")"),e.trim()}(t));if(0===e.length)throw new Error("Invalid CSS gradient.");if(1!==e.length)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const n=e[0],r=function(t){const e={"linear-gradient":0,"radial-gradient":1};if(!(t in e))throw new Error(`Unsupported gradient type "${t}"`);return e[t]}(n.type),i=function(t){const e=function(t){const e=[];for(let n=0;n<t.length;n++){const r=t[n];let i=-1;"literal"===r.type&&r.length&&"type"in r.length&&"%"===r.length.type&&"value"in r.length&&(i=parseFloat(r.length.value)/100),e.push(i)}const n=t=>{for(let n=t;n<e.length;n++)if(-1!==e[n])return{indexDelta:n-t,offset:e[n]};return{indexDelta:e.length-1-t,offset:1}};let r=0;for(let t=0;t<e.length;t++){const i=e[t];if(-1!==i)r=i;else if(0===t)e[t]=0;else if(t+1===e.length)e[t]=1;else{const i=n(t),s=(i.offset-r)/(1+i.indexDelta);for(let n=0;n<=i.indexDelta;n++)e[t+n]=r+(n+1)*s;t+=i.indexDelta,r=e[t]}}return e.map(sd)}(t),n=[];for(let r=0;r<t.length;r++){const i=id(t[r]);n.push({offset:e[r],color:i.slice(0,3),alpha:i[3]})}return n}(n.colorStops),s=function(t){if(void 0===t)return 0;if("type"in t&&"value"in t)switch(t.type){case"angular":return parseFloat(t.value);case"directional":return function(t){const e={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(t in e))throw new Error(`Unsupported directional value "${t}"`);return e[t]}(t.value)}return 0}(n.orientation);return{type:r,stops:i,angle:s}}(t.css||"")),{alpha:null!=(e=t.alpha)?e:pd.defaults.alpha,maxColors:null!=(n=t.maxColors)?n:pd.defaults.maxColors}):fd(fd({},pd.defaults),t),!r.stops||r.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;\n}\n","const float PI = 3.1415926538;\nconst float PI_2 = PI*2.;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nuniform sampler2D uSampler;\n\nconst int TYPE_LINEAR = 0;\nconst int TYPE_RADIAL = 1;\nconst int TYPE_CONIC = 2;\nconst int MAX_STOPS = 32;\n\nuniform int uNumStops;\nuniform float uAlphas[3*MAX_STOPS];\nuniform vec3 uColors[MAX_STOPS];\nuniform float uOffsets[MAX_STOPS];\nuniform int uType;\nuniform float uAngle;\nuniform float uAlpha;\nuniform int uMaxColors;\nuniform bool uReplace;\n\nstruct ColorStop {\n    float offset;\n    vec3 color;\n    float alpha;\n};\n\nmat2 rotate2d(float angle){\n    return mat2(cos(angle), -sin(angle),\n    sin(angle), cos(angle));\n}\n\nfloat projectLinearPosition(vec2 pos, float angle){\n    vec2 center = vec2(0.5);\n    vec2 result = pos - center;\n    result = rotate2d(angle) * result;\n    result = result + center;\n    return clamp(result.x, 0., 1.);\n}\n\nfloat projectRadialPosition(vec2 pos) {\n    float r = distance(vFilterCoord, vec2(0.5));\n    return clamp(2.*r, 0., 1.);\n}\n\nfloat projectAnglePosition(vec2 pos, float angle) {\n    vec2 center = pos - vec2(0.5);\n    float polarAngle=atan(-center.y, center.x);\n    return mod(polarAngle + angle, PI_2) / PI_2;\n}\n\nfloat projectPosition(vec2 pos, int type, float angle) {\n    if (type == TYPE_LINEAR) {\n        return projectLinearPosition(pos, angle);\n    } else if (type == TYPE_RADIAL) {\n        return projectRadialPosition(pos);\n    } else if (type == TYPE_CONIC) {\n        return projectAnglePosition(pos, angle);\n    }\n\n    return pos.y;\n}\n\nvoid main(void) {\n    // current/original color\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n\n    // skip calculations if gradient alpha is 0\n    if (0.0 == uAlpha) {\n        gl_FragColor = currentColor;\n        return;\n    }\n\n    // project position\n    float y = projectPosition(vFilterCoord, uType, radians(uAngle));\n\n    // check gradient bounds\n    float offsetMin = uOffsets[0];\n    float offsetMax = 0.0;\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (i == uNumStops-1){ // last index\n            offsetMax = uOffsets[i];\n        }\n    }\n\n    if (y  < offsetMin || y > offsetMax) {\n        gl_FragColor = currentColor;\n        return;\n    }\n\n    // limit colors\n    if (uMaxColors > 0) {\n        float stepSize = 1./float(uMaxColors);\n        float stepNumber = float(floor(y/stepSize));\n        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment\n    }\n\n    // find color stops\n    ColorStop from;\n    ColorStop to;\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (y >= uOffsets[i]) {\n            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);\n            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);\n        }\n\n        if (i == uNumStops-1){ // last index\n            break;\n        }\n    }\n\n    // mix colors from stops\n    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);\n    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);\n\n    float segmentHeight = to.offset - from.offset;\n    float relativePos = y - from.offset;// position from 0 to [segmentHeight]\n    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].\n\n    float gradientAlpha = uAlpha * currentColor.a;\n    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;\n\n    if (uReplace == false) {\n        // mix resulting color with current color\n        gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);\n    } else {\n        // replace with gradient color\n        gl_FragColor = gradientColor;\n    }\n}\n"),this._stops=[],this.autoFit=!1,Object.assign(this,r)}get stops(){return this._stops}set stops(t){const e=function(t){return[...t].sort(((t,e)=>t.offset-e.offset))}(t),n=new Float32Array(3*e.length);for(let t=0;t<e.length;t++){const r=rd(e[t].color),i=3*t;n[i+0]=r[0],n[i+1]=r[1],n[i+2]=r[2]}this.uniforms.uColors=n,this.uniforms.uOffsets=e.map((t=>t.offset)),this.uniforms.uAlphas=e.map((t=>t.alpha)),this.uniforms.uNumStops=e.length,this._stops=e}set type(t){this.uniforms.uType=t}get type(){return this.uniforms.uType}set angle(t){this.uniforms.uAngle=t-90}get angle(){return this.uniforms.uAngle+90}set alpha(t){this.uniforms.uAlpha=t}get alpha(){return this.uniforms.uAlpha}set maxColors(t){this.uniforms.uMaxColors=t}get maxColors(){return this.uniforms.uMaxColors}set replace(t){this.uniforms.uReplace=t}get replace(){return this.uniforms.uReplace}};let md=pd;md.LINEAR=0,md.RADIAL=1,md.CONIC=2,md.defaults={type:pd.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0,replace:!1};class gd extends sr{constructor(t=0,e=1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec3 color;\nuniform float alpha;\n\nvoid main(void) {\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = vec4(mix(currentColor.rgb, color.rgb, currentColor.a * alpha), currentColor.a);\n}\n"),this._color=0,this._alpha=1,this.uniforms.color=new Float32Array(3),this.color=t,this.alpha=e}set color(t){const e=this.uniforms.color;"number"==typeof t?(ne(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._color=se(e))}get color(){return this._color}set alpha(t){this.uniforms.alpha=t,this._alpha=t}get alpha(){return this._alpha}}const vd=class extends sr{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nconst float SQRT_2 = 1.414213;\n\nconst float light = 1.0;\n\nuniform float curvature;\nuniform float lineWidth;\nuniform float lineContrast;\nuniform bool verticalLine;\nuniform float noise;\nuniform float noiseSize;\n\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\n\nuniform float seed;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));\n    \n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 rgb = gl_FragColor.rgb;\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        rgb += _noise * noise;\n    }\n\n    if (lineWidth > 0.0)\n    {\n        float _c = curvature > 0. ? curvature : 1.;\n        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;\n        vec2 uv = dir * k;\n\n        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;\n        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;\n        rgb *= j;\n        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);\n        rgb *= 0.99 + ceil(segment) * 0.015;\n    }\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    gl_FragColor.rgb = rgb;\n}\n"),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,vd.defaults,t)}apply(t,e,n,r){const{width:i,height:s}=e.filterFrame;this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=s,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,e,n,r)}set curvature(t){this.uniforms.curvature=t}get curvature(){return this.uniforms.curvature}set lineWidth(t){this.uniforms.lineWidth=t}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(t){this.uniforms.lineContrast=t}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(t){this.uniforms.verticalLine=t}get verticalLine(){return this.uniforms.verticalLine}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};vd.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var yd=Object.defineProperty,xd=Object.getOwnPropertySymbols,wd=Object.prototype.hasOwnProperty,_d=Object.prototype.propertyIsEnumerable,bd=(t,e,n)=>e in t?yd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Td=(t,e)=>{for(var n in e||(e={}))wd.call(e,n)&&bd(t,n,e[n]);if(xd)for(var n of xd(e))_d.call(e,n)&&bd(t,n,e[n]);return t};const Sd=class extends sr{constructor(t){super(),this.angle=45,this._distance=5,this._resolution=Y.FILTER_RESOLUTION;const e=t?Td(Td({},Sd.defaults),t):Sd.defaults,{kernels:n,blur:r,quality:i,pixelSize:s,resolution:o}=e;this._offset=new In(this._updatePadding,this),this._tintFilter=new sr("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform vec3 color;\n\nuniform vec2 shift;\nuniform vec4 inputSize;\n\nvoid main(void){\n    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = color.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= alpha;\n\n    gl_FragColor = sample;\n}"),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=o,this._blurFilter=n?new Xu(n):new Xu(r,i),this.pixelSize=s,this.resolution=o;const{shadowOnly:a,rotation:l,distance:h,offset:c,alpha:u,color:d}=e;this.shadowOnly=a,void 0!==l&&void 0!==h?(this.rotation=l,this.distance=h):this.offset=c,this.alpha=u,this.color=d}apply(t,e,n,r){const i=t.getFilterTexture();this._tintFilter.apply(t,e,i,1),this._blurFilter.apply(t,i,n,r),!0!==this.shadowOnly&&t.applyFilter(this,e,n,0),t.returnFilterTexture(i)}_updatePadding(){const t=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=t+2*this.blur}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(t){this._offset.copyFrom(t),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get distance(){return this._distance}set distance(t){gt("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=t,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/fn}set rotation(t){gt("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=t*fn,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(t){this._tintFilter.uniforms.alpha=t}get color(){return se(this._tintFilter.uniforms.color)}set color(t){ne(t,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};Sd.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:Y.FILTER_RESOLUTION};const Ad=class extends sr{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","// precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\nuniform float aspect;\n\nuniform sampler2D displacementMap;\nuniform float offset;\nuniform float sinDir;\nuniform float cosDir;\nuniform int fillMode;\n\nuniform float seed;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nconst int TRANSPARENT = 0;\nconst int ORIGINAL = 1;\nconst int LOOP = 2;\nconst int CLAMP = 3;\nconst int MIRROR = 4;\n\nvoid main(void)\n{\n    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;\n\n    if (coord.x > 1.0 || coord.y > 1.0) {\n        return;\n    }\n\n    float cx = coord.x - 0.5;\n    float cy = (coord.y - 0.5) * aspect;\n    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;\n\n    // displacementMap: repeat\n    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);\n\n    // displacementMap: mirror\n    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);\n\n    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));\n\n    float displacement = (dc.r - dc.g) * (offset / filterArea.x);\n\n    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);\n\n    if (fillMode == CLAMP) {\n        coord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    } else {\n        if( coord.x > filterClamp.z ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x -= filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x = filterClamp.z * 2.0 - coord.x;\n            }\n        } else if( coord.x < filterClamp.x ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x += filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x *= -filterClamp.z;\n            }\n        }\n\n        if( coord.y > filterClamp.w ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y -= filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y = filterClamp.w * 2.0 - coord.y;\n            }\n        } else if( coord.y < filterClamp.y ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y += filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y *= -filterClamp.w;\n            }\n        }\n    }\n\n    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;\n    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;\n    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;\n    gl_FragColor.a = texture2D(uSampler, coord).a;\n}\n"),this.offset=100,this.fillMode=Ad.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=vr.from(this._canvas,{scaleMode:F.NEAREST}),Object.assign(this,Ad.defaults,t)}apply(t,e,n,r){const{width:i,height:s}=e.filterFrame;this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/i,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,e,n,r)}_randomizeSizes(){const t=this._sizes,e=this._slices-1,n=this.sampleSize,r=Math.min(this.minSize/n,.9/this._slices);if(this.average){const n=this._slices;let i=1;for(let s=0;s<e;s++){const e=i/(n-s),o=Math.max(e*(1-.6*Math.random()),r);t[s]=o,i-=o}t[e]=i}else{let n=1;const i=Math.sqrt(1/this._slices);for(let s=0;s<e;s++){const e=Math.max(i*n*Math.random(),r);t[s]=e,n-=e}t[e]=n}this.shuffle()}shuffle(){const t=this._sizes;for(let e=this._slices-1;e>0;e--){const n=Math.random()*e|0,r=t[e];t[e]=t[n],t[n]=r}}_randomizeOffsets(){for(let t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const t=this.sampleSize,e=this.texture,n=this._canvas.getContext("2d");n.clearRect(0,0,8,t);let r,i=0;for(let e=0;e<this._slices;e++){r=Math.floor(256*this._offsets[e]);const s=this._sizes[e]*t,o=r>0?r:0,a=r<0?-r:0;n.fillStyle=`rgba(${o}, ${a}, 0, 1)`,n.fillRect(0,0|i,t,s+1|0),i+=s}e.baseTexture.update(),this.uniforms.displacementMap=e}set sizes(t){const e=Math.min(this._slices,t.length);for(let n=0;n<e;n++)this._sizes[n]=t[n]}get sizes(){return this._sizes}set offsets(t){const e=Math.min(this._slices,t.length);for(let n=0;n<e;n++)this._offsets[n]=t[n]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())}get direction(){return this._direction}set direction(t){if(this._direction===t)return;this._direction=t;const e=t*fn;this.uniforms.sinDir=Math.sin(e),this.uniforms.cosDir=Math.cos(e)}get red(){return this.uniforms.red}set red(t){this.uniforms.red=t}get green(){return this.uniforms.green}set green(t){this.uniforms.green=t}get blue(){return this.uniforms.blue}set blue(t){this.uniforms.blue=t}destroy(){var t;null==(t=this.texture)||t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};let Ed=Ad;Ed.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},Ed.TRANSPARENT=0,Ed.ORIGINAL=1,Ed.LOOP=2,Ed.CLAMP=3,Ed.MIRROR=4;const Cd=class extends sr{constructor(t){const e=Object.assign({},Cd.defaults,t),{outerStrength:n,innerStrength:r,color:i,knockout:s,quality:o,alpha:a}=e,l=Math.round(e.distance);super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nuniform float outerStrength;\nuniform float innerStrength;\n\nuniform vec4 glowColor;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform bool knockout;\nuniform float alpha;\n\nconst float PI = 3.14159265358979323846264;\n\nconst float DIST = __DIST__;\nconst float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);\nconst float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);\n\nconst float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;\n\nvoid main(void) {\n    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);\n\n    float totalAlpha = 0.0;\n\n    vec2 direction;\n    vec2 displaced;\n    vec4 curColor;\n\n    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {\n       direction = vec2(cos(angle), sin(angle)) * px;\n\n       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {\n           displaced = clamp(vTextureCoord + direction * \n                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);\n\n           curColor = texture2D(uSampler, displaced);\n\n           totalAlpha += (DIST - curDistance) * curColor.a;\n       }\n    }\n    \n    curColor = texture2D(uSampler, vTextureCoord);\n\n    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);\n\n    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;\n    float innerGlowStrength = min(1.0, innerGlowAlpha);\n    \n    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);\n\n    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);\n    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);\n\n    if (knockout) {\n      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;\n      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);\n    }\n    else {\n      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;\n      gl_FragColor = innerColor + outerGlowColor;\n    }\n}\n".replace(/__ANGLE_STEP_SIZE__/gi,`${(1/o/l).toFixed(7)}`).replace(/__DIST__/gi,`${l.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:i,outerStrength:n,innerStrength:r,padding:l,knockout:s,alpha:a})}get color(){return se(this.uniforms.glowColor)}set color(t){ne(t,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(t){this.uniforms.outerStrength=t}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(t){this.uniforms.innerStrength=t}get knockout(){return this.uniforms.knockout}set knockout(t){this.uniforms.knockout=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};Cd.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};const kd=class extends sr{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform vec2 light;\nuniform bool parallel;\nuniform float aspect;\n\nuniform float gain;\nuniform float lacunarity;\nuniform float time;\nuniform float alpha;\n\n${perlin}\n\nvoid main(void) {\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    float d;\n\n    if (parallel) {\n        float _cos = light.x;\n        float _sin = light.y;\n        d = (_cos * coord.x) + (_sin * coord.y * aspect);\n    } else {\n        float dx = coord.x - light.x / dimensions.x;\n        float dy = (coord.y - light.y / dimensions.y) * aspect;\n        float dis = sqrt(dx * dx + dy * dy) + 0.00001;\n        d = dy / dis;\n    }\n\n    vec3 dir = vec3(d, d, 0.0);\n\n    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);\n    noise = mix(noise, 0.0, 0.3);\n    //fade vertically.\n    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);\n    mist.a = 1.0;\n    // apply user alpha\n    mist *= alpha;\n\n    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;\n\n}\n".replace("${perlin}","vec3 mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\n    return mod289(((x * 34.0) + 1.0) * x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t)\n{\n    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n// Classic Perlin noise, periodic variant\nfloat pnoise(vec3 P, vec3 rep)\n{\n    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n    Pi0 = mod289(Pi0);\n    Pi1 = mod289(Pi1);\n    vec3 Pf0 = fract(P); // Fractional part for interpolation\n    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\n    vec4 iz0 = Pi0.zzzz;\n    vec4 iz1 = Pi1.zzzz;\n    vec4 ixy = permute(permute(ix) + iy);\n    vec4 ixy0 = permute(ixy + iz0);\n    vec4 ixy1 = permute(ixy + iz1);\n    vec4 gx0 = ixy0 * (1.0 / 7.0);\n    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n    gx0 = fract(gx0);\n    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n    vec4 sz0 = step(gz0, vec4(0.0));\n    gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n    gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n    vec4 gx1 = ixy1 * (1.0 / 7.0);\n    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n    gx1 = fract(gx1);\n    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n    vec4 sz1 = step(gz1, vec4(0.0));\n    gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n    gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n    g000 *= norm0.x;\n    g010 *= norm0.y;\n    g100 *= norm0.z;\n    g110 *= norm0.w;\n    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n    g001 *= norm1.x;\n    g011 *= norm1.y;\n    g101 *= norm1.z;\n    g111 *= norm1.w;\n    float n000 = dot(g000, Pf0);\n    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n    float n111 = dot(g111, Pf1);\n    vec3 fade_xyz = fade(Pf0);\n    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n    return 2.2 * n_xyz;\n}\nfloat turb(vec3 P, vec3 rep, float lacunarity, float gain)\n{\n    float sum = 0.0;\n    float sc = 1.0;\n    float totalgain = 1.0;\n    for (float i = 0.0; i < 6.0; i++)\n    {\n        sum += totalgain * pnoise(P * sc, rep);\n        sc *= lacunarity;\n        totalgain *= gain;\n    }\n    return abs(sum);\n}\n")),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);const e=Object.assign(kd.defaults,t);this._angleLight=new mn,this.angle=e.angle,this.gain=e.gain,this.lacunarity=e.lacunarity,this.alpha=e.alpha,this.parallel=e.parallel,this.center=e.center,this.time=e.time}apply(t,e,n,r){const{width:i,height:s}=e.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=i,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/i,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,n,r)}get angle(){return this._angle}set angle(t){this._angle=t;const e=t*fn;this._angleLight.x=Math.cos(e),this._angleLight.y=Math.sin(e)}get gain(){return this.uniforms.gain}set gain(t){this.uniforms.gain=t}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(t){this.uniforms.lacunarity=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};kd.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};const Md=class extends sr{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float uHue;\nuniform float uAlpha;\nuniform bool uColorize;\nuniform float uSaturation;\nuniform float uLightness;\n\n// https://en.wikipedia.org/wiki/Luma_(video)\nconst vec3 weight = vec3(0.299, 0.587, 0.114);\n\nfloat getWeightedAverage(vec3 rgb) {\n    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;\n}\n\n// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243\nconst vec3 k = vec3(0.57735, 0.57735, 0.57735);\n\nvec3 hueShift(vec3 color, float angle) {\n    float cosAngle = cos(angle);\n    return vec3(\n    color * cosAngle +\n    cross(k, color) * sin(angle) +\n    k * dot(k, color) * (1.0 - cosAngle)\n    );\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    vec4 result = color;\n\n    // colorize\n    if (uColorize) {\n        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);\n    }\n\n    // hue\n    result.rgb = hueShift(result.rgb, uHue);\n\n    // saturation\n    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js\n    float average = (result.r + result.g + result.b) / 3.0;\n\n    if (uSaturation > 0.) {\n        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));\n    } else {\n        result.rgb -= (average - result.rgb) * uSaturation;\n    }\n\n    // lightness\n    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));\n\n    // alpha\n    gl_FragColor = mix(color, result, uAlpha);\n}\n"),this._hue=0;const e=Object.assign({},Md.defaults,t);Object.assign(this,e)}get hue(){return this._hue}set hue(t){this._hue=t,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}get colorize(){return this.uniforms.uColorize}set colorize(t){this.uniforms.uColorize=t}get lightness(){return this.uniforms.uLightness}set lightness(t){this.uniforms.uLightness=t}get saturation(){return this.uniforms.uSaturation}set saturation(t){this.uniforms.uSaturation=t}};Md.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};const Pd=class extends sr{constructor(t,e=0){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform float sepia;\nuniform float noise;\nuniform float noiseSize;\nuniform float scratch;\nuniform float scratchDensity;\nuniform float scratchWidth;\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\nuniform float seed;\n\nconst float SQRT_2 = 1.414213;\nconst vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvec3 Overlay(vec3 src, vec3 dst)\n{\n    // if (dst <= 0.5) then: 2 * src * dst\n    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)\n    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),\n                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),\n                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));\n}\n\n\nvoid main()\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 color = gl_FragColor.rgb;\n\n    if (sepia > 0.0)\n    {\n        float gray = (color.x + color.y + color.z) / 3.0;\n        vec3 grayscale = vec3(gray);\n\n        color = Overlay(SEPIA_RGB, grayscale);\n\n        color = grayscale + sepia * (color - grayscale);\n    }\n\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        vec2 dir = vec2(vec2(0.5, 0.5) - coord);\n        dir.y *= dimensions.y / dimensions.x;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    if (scratchDensity > seed && scratch != 0.0)\n    {\n        float phase = seed * 256.0;\n        float s = mod(floor(phase), 2.0);\n        float dist = 1.0 / scratchDensity;\n        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));\n        if (d < seed * 0.6 + 0.4)\n        {\n            highp float period = scratchDensity * 10.0;\n\n            float xx = coord.x * period + phase;\n            float aa = abs(mod(xx, 0.5) * 4.0);\n            float bb = mod(floor(xx / 0.5), 2.0);\n            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);\n\n            float kk = 2.0 * period;\n            float dw = scratchWidth / dimensions.x * (0.75 + seed);\n            float dh = dw * kk;\n\n            float tine = (yy - (2.0 - dh));\n\n            if (tine > 0.0) {\n                float _sign = sign(scratch);\n\n                tine = s * tine / period + scratch + 0.1;\n                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);\n\n                color.rgb *= tine;\n            }\n        }\n    }\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);\n        // float _noise = snoise(d) * 0.5;\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        color += _noise * noise;\n    }\n\n    gl_FragColor.rgb = color;\n}\n"),this.seed=0,this.uniforms.dimensions=new Float32Array(2),"number"==typeof t?(this.seed=t,t=void 0):this.seed=e,Object.assign(this,Pd.defaults,t)}apply(t,e,n,r){var i,s;this.uniforms.dimensions[0]=null==(i=e.filterFrame)?void 0:i.width,this.uniforms.dimensions[1]=null==(s=e.filterFrame)?void 0:s.height,this.uniforms.seed=this.seed,t.applyFilter(this,e,n,r)}set sepia(t){this.uniforms.sepia=t}get sepia(){return this.uniforms.sepia}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set scratch(t){this.uniforms.scratch=t}get scratch(){return this.uniforms.scratch}set scratchDensity(t){this.uniforms.scratchDensity=t}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(t){this.uniforms.scratchWidth=t}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};Pd.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};const Id=class extends sr{constructor(t=1,e=0,n=.1,r=1,i=!1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterClamp;\n\nuniform float uAlpha;\nuniform vec2 uThickness;\nuniform vec4 uColor;\nuniform bool uKnockout;\n\nconst float DOUBLE_PI = 2. * 3.14159265358979323846264;\nconst float ANGLE_STEP = ${angleStep};\n\nfloat outlineMaxAlphaAtPos(vec2 pos) {\n    if (uThickness.x == 0. || uThickness.y == 0.) {\n        return 0.;\n    }\n\n    vec4 displacedColor;\n    vec2 displacedPos;\n    float maxAlpha = 0.;\n\n    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {\n        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);\n        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);\n        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));\n        maxAlpha = max(maxAlpha, displacedColor.a);\n    }\n\n    return maxAlpha;\n}\n\nvoid main(void) {\n    vec4 sourceColor = texture2D(uSampler, vTextureCoord);\n    vec4 contentColor = sourceColor * float(!uKnockout);\n    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);\n    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);\n    gl_FragColor = contentColor + outlineColor;\n}\n".replace(/\$\{angleStep\}/,Id.getAngleStep(n))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=r,this.uniforms.uKnockout=i,Object.assign(this,{thickness:t,color:e,quality:n,alpha:r,knockout:i})}static getAngleStep(t){const e=Math.max(t*Id.MAX_SAMPLES,Id.MIN_SAMPLES);return(2*Math.PI/e).toFixed(7)}apply(t,e,n,r){this.uniforms.uThickness[0]=this._thickness/e._frame.width,this.uniforms.uThickness[1]=this._thickness/e._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,t.applyFilter(this,e,n,r)}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get color(){return se(this.uniforms.uColor)}set color(t){ne(t,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(t){this._knockout=t}get thickness(){return this._thickness}set thickness(t){this._thickness=t,this.padding=t}};let Rd=Id;Rd.MIN_SAMPLES=1,Rd.MAX_SAMPLES=100;const Od=class extends sr{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nuniform bool mirror;\nuniform float boundary;\nuniform vec2 amplitude;\nuniform vec2 waveLength;\nuniform vec2 alpha;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 coord = pixelCoord / dimensions;\n\n    if (coord.y < boundary) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    float k = (coord.y - boundary) / (1. - boundary + 0.0001);\n    float areaY = boundary * dimensions.y / filterArea.y;\n    float v = areaY + areaY - vTextureCoord.y;\n    float y = mirror ? v : vTextureCoord.y;\n\n    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;\n    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;\n    float _alpha = (alpha.y - alpha.x) * k + alpha.x;\n\n    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;\n    x = clamp(x, filterClamp.x, filterClamp.z);\n\n    vec4 color = texture2D(uSampler, vec2(x, y));\n\n    gl_FragColor = color * _alpha;\n}\n"),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Od.defaults,t)}apply(t,e,n,r){var i,s;this.uniforms.dimensions[0]=null==(i=e.filterFrame)?void 0:i.width,this.uniforms.dimensions[1]=null==(s=e.filterFrame)?void 0:s.height,this.uniforms.time=this.time,t.applyFilter(this,e,n,r)}set mirror(t){this.uniforms.mirror=t}get mirror(){return this.uniforms.mirror}set boundary(t){this.uniforms.boundary=t}get boundary(){return this.uniforms.boundary}set amplitude(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]}get waveLength(){return this.uniforms.waveLength}set alpha(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]}get alpha(){return this.uniforms.alpha}};Od.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};const Ld=class extends sr{constructor(t=[0,0],e,n=0){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nuniform vec2 center;\n\nuniform float amplitude;\nuniform float wavelength;\n// uniform float power;\nuniform float brightness;\nuniform float speed;\nuniform float radius;\n\nuniform float time;\n\nconst float PI = 3.14159;\n\nvoid main()\n{\n    float halfWavelength = wavelength * 0.5 / filterArea.x;\n    float maxRadius = radius / filterArea.x;\n    float currentRadius = time * speed / filterArea.x;\n\n    float fade = 1.0;\n\n    if (maxRadius > 0.0) {\n        if (currentRadius > maxRadius) {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\n    }\n\n    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);\n    dir.y *= filterArea.y / filterArea.x;\n    float dist = length(dir);\n\n    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    vec2 diffUV = normalize(dir);\n\n    float diff = (dist - currentRadius) / halfWavelength;\n\n    float p = 1.0 - pow(abs(diff), 2.0);\n\n    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );\n    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );\n\n    vec2 offset = diffUV * powDiff / filterArea.xy;\n\n    // Do clamp :\n    vec2 coord = vTextureCoord + offset;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    // No clamp :\n    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);\n\n    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;\n\n    gl_FragColor = color;\n}\n"),this.center=t,Object.assign(this,Ld.defaults,e),this.time=n}apply(t,e,n,r){this.uniforms.time=this.time,t.applyFilter(this,e,n,r)}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}get amplitude(){return this.uniforms.amplitude}set amplitude(t){this.uniforms.amplitude=t}get wavelength(){return this.uniforms.wavelength}set wavelength(t){this.uniforms.wavelength=t}get brightness(){return this.uniforms.brightness}set brightness(t){this.uniforms.brightness=t}get speed(){return this.uniforms.speed}set speed(t){this.uniforms.speed=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}};Ld.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};class Dd extends sr{constructor(t){var e,n;super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    color /= total;\n    color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n"),this.uniforms.blur=t.blur,this.uniforms.gradientBlur=t.gradientBlur,this.uniforms.start=null!=(e=t.start)?e:new mn(0,window.innerHeight/2),this.uniforms.end=null!=(n=t.end)?n:new mn(600,window.innerHeight/2),this.uniforms.delta=new mn(30,30),this.uniforms.texSize=new mn(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(t){this.uniforms.blur=t}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(t){this.uniforms.gradientBlur=t}get start(){return this.uniforms.start}set start(t){this.uniforms.start=t,this.updateDelta()}get end(){return this.uniforms.end}set end(t){this.uniforms.end=t,this.updateDelta()}}class Fd extends Dd{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=t/n,this.uniforms.delta.y=e/n}}class Nd extends Dd{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,n=Math.sqrt(t*t+e*e);this.uniforms.delta.x=-e/n,this.uniforms.delta.y=t/n}}const Bd=class extends sr{constructor(t,e,n,r){super(),"number"==typeof t&&(gt("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),t={blur:t,gradientBlur:e,start:n,end:r}),t=Object.assign({},Bd.defaults,t),this.tiltShiftXFilter=new Fd(t),this.tiltShiftYFilter=new Nd(t)}apply(t,e,n,r){const i=t.getFilterTexture();this.tiltShiftXFilter.apply(t,e,i,1),this.tiltShiftYFilter.apply(t,i,n,r),t.returnFilterTexture(i)}get blur(){return this.tiltShiftXFilter.blur}set blur(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}get start(){return this.tiltShiftXFilter.start}set start(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}get end(){return this.tiltShiftXFilter.end}set end(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}};Bd.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};const Wd=class extends sr{constructor(t){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 twist(vec2 coord)\n{\n    coord -= offset;\n\n    float dist = length(coord);\n\n    if (dist < radius)\n    {\n        float ratioDist = (radius - dist) / radius;\n        float angleMod = ratioDist * ratioDist * angle;\n        float s = sin(angleMod);\n        float c = cos(angleMod);\n        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n    }\n\n    coord += offset;\n\n    return coord;\n}\n\nvoid main(void)\n{\n\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = twist(coord);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord );\n\n}\n"),Object.assign(this,Wd.defaults,t)}get offset(){return this.uniforms.offset}set offset(t){this.uniforms.offset=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get angle(){return this.uniforms.angle}set angle(t){this.uniforms.angle=t}};Wd.defaults={radius:200,angle:4,padding:20,offset:new mn};var Ud=Object.getOwnPropertySymbols,jd=Object.prototype.hasOwnProperty,Hd=Object.prototype.propertyIsEnumerable;const zd=class extends sr{constructor(t){const e=Object.assign(zd.defaults,t),{maxKernelSize:n}=e,r=((t,e)=>{var n={};for(var r in t)jd.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&Ud)for(var r of Ud(t))e.indexOf(r)<0&&Hd.call(t,r)&&(n[r]=t[r]);return n})(e,["maxKernelSize"]);super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uCenter;\nuniform float uStrength;\nuniform float uInnerRadius;\nuniform float uRadius;\n\nconst float MAX_KERNEL_SIZE = ${maxKernelSize};\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand(vec2 co, float seed) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);\n    return fract(sin(sn) * c + seed);\n}\n\nvoid main() {\n\n    float minGradient = uInnerRadius * 0.3;\n    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;\n\n    float gradient = uRadius * 0.3;\n    float radius = (uRadius - gradient * 0.5) / filterArea.x;\n\n    float countLimit = MAX_KERNEL_SIZE;\n\n    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);\n    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));\n\n    float strength = uStrength;\n\n    float delta = 0.0;\n    float gap;\n    if (dist < innerRadius) {\n        delta = innerRadius - dist;\n        gap = minGradient;\n    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity\n        delta = dist - radius;\n        gap = gradient;\n    }\n\n    if (delta > 0.0) {\n        float normalCount = gap / filterArea.x;\n        delta = (normalCount - delta) / normalCount;\n        countLimit *= delta;\n        strength *= delta;\n        if (countLimit < 1.0)\n        {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n    }\n\n    // randomize the lookup values to hide the fixed number of samples\n    float offset = rand(vTextureCoord, 0.0);\n\n    float total = 0.0;\n    vec4 color = vec4(0.0);\n\n    dir *= strength;\n\n    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {\n        float percent = (t + offset) / MAX_KERNEL_SIZE;\n        float weight = 4.0 * (percent - percent * percent);\n        vec2 p = vTextureCoord + dir * percent;\n        vec4 sample = texture2D(uSampler, p);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample * weight;\n        total += weight;\n\n        if (t > countLimit){\n            break;\n        }\n    }\n\n    color /= total;\n    // switch back from pre-multiplied alpha\n    // color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n".replace("${maxKernelSize}",n.toFixed(1))),Object.assign(this,r)}get center(){return this.uniforms.uCenter}set center(t){this.uniforms.uCenter=t}get strength(){return this.uniforms.uStrength}set strength(t){this.uniforms.uStrength=t}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(t){this.uniforms.uInnerRadius=t}get radius(){return this.uniforms.uRadius}set radius(t){(t<0||t===1/0)&&(t=-1),this.uniforms.uRadius=t}};zd.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};var Gd={fill:"#000000",fontFamily:"NotoSerif",fontWeight:"800"},Vd=function(t){if(!t.stateName)return{};var e=t.uiRect,n={x:t.uiRect.width/2,y:t.uiRect.height/2},r=t.uiRect.width;return t.stateName===sh?{optionsWheel:Gu({x:70,y:60,"(orientation: landscape)":{}}),telegram:Gu({x:70,y:140,"(orientation: landscape)":{}}),userLevel:Gu({x:r-120,y:60,"(orientation: landscape)":{}}),btnContainer:Gu({x:n.x,y:395,"(orientation: landscape)":{}})}:t.stateName===oh?{learningView:Gu({x:n.x,y:n.y,"(orientation: landscape)":{}}),optionsWheel:Gu({x:70,y:60,"(orientation: landscape)":{}}),timerView:Gu({x:e.width-100,y:160,"(orientation: landscape)":{}}),levelCounterView:Gu({x:70,y:206,"(orientation: landscape)":{}}),btnHint:Gu({type:"button",x:e.width-110,y:60,"(orientation: landscape)":{}}),debugText:Gu({x:20,y:360,"(orientation: landscape)":{}}),introSpeechBubble:Gu({x:n.x,y:n.y,texture:"intro-text-bubble",anchor:{x:.5,y:.5},scale:{x:1.2,y:1.2},"(orientation: landscape)":{}})}:void 0},Xd={blur:new Xu(.25),fade:{texture:vr.WHITE,width:Dh.WIDTH+1,height:Dh.HEIGHT,tint:0}},Yd=function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,s=t.w,o=void 0===s?0:s,a=t.h,l=void 0===a?0:a,h=t.r,c=void 0===h?0:h,u=t.color,d=void 0===u?16773939:u,f=t.alpha,p=void 0===f?1:f,m=t.center,g=void 0!==m&&m,v=new Ya;return v.beginFill(d),v.drawRoundedRect(n,i,o,l,c),v.endFill(),v.alpha=p,g&&v.position.set(-v.width/2+n,-v.height/2+i),v},$d=function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,s=t.w,o=void 0===s?0:s,a=t.h,l=void 0===a?0:a,h=t.lineWidth,c=void 0===h?2:h,u=t.color,d=void 0===u?16711680:u,f=t.alpha,p=void 0===f?1:f,m=t.center,g=void 0!==m&&m,v=new Ya;return v.lineStyle(c,d,p),v.drawRect(n,i,o,l),g&&v.position.set(-v.width/2+n,-v.height/2+i),v},qd=function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,s=t.r,o=void 0===s?50:s,a=t.color,l=void 0===a?16773939:a,h=t.alpha,c=void 0===h?1:h,u=new Ya;return u.beginFill(l),u.drawCircle(n,i,o/2),u.endFill(),u.alpha=c,u};function Kd(){var t={},e={x:Dh.HALF_W,y:Dh.HALF_H,anchor:{x:.5,y:.5},style:{fontSize:50,fill:16777215,fontFamily:"NotoSerif",align:"center"}},n=Yd({w:Dh.WIDTH,h:Dh.HEIGHT,color:0});return tu(rs,{width:Dh.WIDTH,height:Dh.HEIGHT,refs:t,resize:function(){return Wu(t)},sortableChildren:!0},n,tu(Ms,{text:zc.t("textLoading")+"...",ref:function(e){return t.textPreload=e},classes:e}))}r(7550);var Zd="player",Qd="soundManager",Jd="gameConfig",tf=function(){function t(){v(this,t)}return _(t,null,[{key:"register",value:function(e,n){var r={name:e,instance:n};Jc(t.services).some((function(t){return t.name===e}))||t.services.add(r)}},{key:"get",value:function(e){var n=Jc(t.services).find((function(t){return t.name===e}));return n?n.instance:void 0}}])}();E(tf,"services",new Set);var ef,nf=r(4196),rf=99603095,sf={GAME_PRELOAD:{initialize:"GAME_PRELOAD:initialize",loadPlayerData:"GAME_PRELOAD:loadPlayerData",showAd:"GAME_PRELOAD:showAd"},LEVEL_PRELOAD:{loading:"LEVEL_PRELOAD:loading",loadBundle:"LEVEL_PRELOAD:loadBundle"},SOUND_PRELOAD:{preload:"SOUND_PRELOAD:preload"}},of=_((function t(){v(this,t)}));ef=of,E(of,"btnStart",(function(){"function"==typeof ym&&ym(rf,"reachGoal","clickBtnStart")})),E(of,"mainScreenBtnStore",(function(){"function"==typeof ym&&ym(rf,"reachGoal","mainScreenBtnStore")})),E(of,"btnLeaders",(function(){"function"==typeof ym&&ym(rf,"reachGoal","clickBtnLeaders")})),E(of,"userReviewClickOk",(function(){"function"==typeof ym&&ym(rf,"reachGoal","userReviewClickOk")})),E(of,"userReviewClickLater",(function(){"function"==typeof ym&&ym(rf,"reachGoal","userReviewClickLater")})),E(of,"finalScreenBtnNext",(function(){"function"==typeof ym&&ym(rf,"reachGoal","finalScreenBtnNext")})),E(of,"finalScreenBtnHome",(function(){"function"==typeof ym&&ym(rf,"reachGoal","finalScreenBtnHome")})),E(of,"finalScreenBtnDisableAd",(function(){"function"==typeof ym&&ym(rf,"reachGoal","finalScreenBtnDisableAd")})),E(of,"finalScreenBtnStore",(function(){"function"==typeof ym&&ym(rf,"reachGoal","finalScreenBtnStore")})),E(of,"noHintsClickBtnStore",(function(){"function"==typeof ym&&ym(rf,"reachGoal","noHintsClickBtnStore")})),E(of,"noHintsClickBtnReward",(function(){"function"==typeof ym&&ym(rf,"reachGoal","noHintsClickBtnReward")})),E(of,"completeGame",(function(){"function"==typeof ym&&ym(rf,"reachGoal","completeGame")})),E(of,"gameTimeTracker",(function(){"function"==typeof ym&&ym(rf,"reachGoal","gameTimeTracker")})),E(of,"rewardedAdWatched",(function(){"function"==typeof ym&&ym(rf,"reachGoal","rewardedAdWatched")})),E(of,"interstitialWatched",(function(){"function"==typeof ym&&ym(rf,"reachGoal","interstitialWatched")})),E(of,"forceReload",(function(){"function"==typeof ym&&ym(rf,"reachGoal","forceReload")})),E(of,"startLevel",(function(t,e){if("function"==typeof ym){var n=t.spineName,r=t.currentSkinName,i=e.userLevel;ym(rf,"params",{startLevel:{spineName:n,currentSkinName:r,userLevel:i}})}})),E(of,"completeLevel",(function(t,e,n){if("function"==typeof ym){var r=t.spineName,i=t.currentSkinName,s=e.userLevel;ym(rf,"params",{completeLevel:{spineName:r,currentSkinName:i,userLevel:E({},s,{levelPlayTime:n})}})}})),E(of,"earlyExit",(function(t,e,n){if("function"==typeof ym){var r=t.spineName,i=t.currentSkinName,s=e.userLevel;ym(rf,"params",{earlyExit:{spineName:r,currentSkinName:i,userLevel:E({},s,{levelPlayTime:n})}})}})),E(of,"useHint",(function(t,e){if("function"==typeof ym){var n=t.spineName,r=t.currentSkinName;ym(rf,"params",{useHint:{spineName:n,currentSkinName:r,spriteName:e.name}})}})),E(of,"hintCounter",(function(t,e){if("function"==typeof ym){var n=t.userLevel+1,r=t.savedLevel,i=r.levelIndex,s=r.skinIndex;ym(rf,"params",{hintCounter:{spineName:i,currentSkinName:s,userLevel:E({},n,{counter:e})}})}})),E(of,"missClickCounter",(function(t,e){if("function"==typeof ym){var n=t.userLevel+1,r=t.savedLevel,i=r.levelIndex,s=r.skinIndex;ym(rf,"params",{missClickCounter:{counter:e,userLevel:n,spineName:i,currentSkinName:s}})}})),E(of,"purchase",(function(t){"function"==typeof ym&&ym(rf,"params",{purchase:{id:t}})})),E(of,"soundLoadErr",(function(t,e){"function"==typeof ym&&ym(rf,"params",{soundLoadErr:{src:t,err:e}})})),E(of,"preloadError",(function(t,e){if("function"==typeof ym)try{var n=(null==e?void 0:e.message)||"Unknown error",r=(null==e?void 0:e.stack)||"No stack available",i=E({},"error_".concat(t),{error:{message:n,stack:r}});ym(rf,"params",i)}catch(t){console.warn("metrika preloadError",t)}})),E(of,"testingErrors",(function(){var t,e,n,r,i,s,o=new Error("Это тестовая ошибка");ef.preloadError(null==sf||null===(t=sf.GAME_PRELOAD)||void 0===t?void 0:t.initialize,o),ef.preloadError(null==sf||null===(e=sf.GAME_PRELOAD)||void 0===e?void 0:e.loadPlayerData,o),ef.preloadError(null==sf||null===(n=sf.GAME_PRELOAD)||void 0===n?void 0:n.showAd,o),ef.preloadError(null==sf||null===(r=sf.LEVEL_PRELOAD)||void 0===r?void 0:r.loading,o),ef.preloadError(null==sf||null===(i=sf.LEVEL_PRELOAD)||void 0===i?void 0:i.loadBundle,o),ef.preloadError(null==sf||null===(s=sf.SOUND_PRELOAD)||void 0===s?void 0:s.preload,o)})),E(of,"loadDuration",(function(t){"function"==typeof ym&&ym(rf,"params",{gameLoadTime:t})}));var af=function(t,e){var n=window.game.locale;return Array.from({length:t},(function(t,r){return{alias:"sfx_".concat(n,"_clickItem").concat(r+1),src:"".concat(e,"assets/audio/sfx/click-item/speech/").concat(n,"/sfx_").concat(n,"_clickItem").concat(r+1,".mp3")}}))},lf=function(){var t=Bh;return{START_MUSIC:[{alias:"m_start-screen",src:"".concat(t,"assets/audio/music/m_start-screen.mp3")}],LEVEL_MUSIC:[{alias:"m_ost",src:"".concat(t,"assets/audio/music/m_ost.mp3")},{alias:"m_victory2",src:"".concat(t,"assets/audio/music/m_victory2.mp3")}],CLICK_ITEMS_SPEECH:Jc(af(60,t)),CLICK_ITEMS:[{alias:"sfx_click0",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click0.mp3")},{alias:"sfx_click1",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click1.mp3")},{alias:"sfx_click2",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click2.mp3")},{alias:"sfx_click3",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click3.mp3")},{alias:"sfx_click4",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click4.mp3")},{alias:"sfx_click5",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click5.mp3")},{alias:"sfx_click6",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click6.mp3")},{alias:"sfx_click7",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click7.mp3")},{alias:"sfx_click8",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click8.mp3")},{alias:"sfx_click9",src:"".concat(t,"assets/audio/sfx/click-item/sfx_click9.mp3")}],SFX:[{alias:"sfx_btnClick",src:"".concat(t,"assets/audio/sfx/sfx_btnClick.mp3")},{alias:"sfx_hintFlash",src:"".concat(t,"assets/audio/sfx/sfx_hintFlash.mp3")},{alias:"sfx_hintModal",src:"".concat(t,"assets/audio/sfx/sfx_hintModal.mp3")},{alias:"sfx_missClick",src:"".concat(t,"assets/audio/sfx/sfx_missClick.mp3")},{alias:"sfx_store",src:"".concat(t,"assets/audio/sfx/sfx_store.mp3")},{alias:"sfx_victory1",src:"".concat(t,"assets/audio/sfx/sfx_victory1.mp3")}]}};function hf(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function cf(t,e){return t.get(df(t,e))}function uf(t,e,n){return t.set(df(t,e),n),n}function df(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ff=new WeakMap,pf=new WeakMap,mf=new WeakMap,gf=new WeakMap,vf=new WeakMap,yf=new WeakMap,xf=_((function t(e,n){var r=this;v(this,t),hf(this,ff,void 0),hf(this,pf,void 0),hf(this,mf,void 0),hf(this,gf,void 0),E(this,"init",(function(){cf(vf,r).call(r),cf(yf,r).call(r)})),E(this,"visibilityStateHandler",(function(){"visible"===document.visibilityState||"visible"===document.webkitVisibilityState?cf(gf,r).call(r):cf(mf,r).call(r)})),hf(this,vf,(function(){document.addEventListener("visibilitychange",r.visibilityStateHandler),window.addEventListener("blur",cf(mf,r)),window.addEventListener("focus",cf(gf,r)),window.addEventListener("ad-event-pause",cf(mf,r)),window.addEventListener("ad-event-resume",cf(gf,r)),window.addEventListener("pagehide",cf(mf,r)),window.addEventListener("pageshow",cf(gf,r)),navigator.userAgent.match(/iPhone|iPad|iPod/i)&&document.addEventListener("webkitvisibilitychange",r.visibilityStateHandler)})),hf(this,yf,(function(){cf(ff,r).on(Sh,cf(pf,r).muteMusic),cf(ff,r).on(Ah,cf(pf,r).unmuteMusic),cf(ff,r).on(bh,cf(pf,r).muteSFX),cf(ff,r).on(Th,cf(pf,r).unmuteSFX)})),uf(ff,this,e),uf(pf,this,n),uf(mf,this,n.mute),uf(gf,this,n.unmute)}));function wf(t,e,n){_f(t,e),e.set(t,n)}function _f(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bf(t,e){return t.get(Sf(t,e))}function Tf(t,e,n){return t.set(Sf(t,e),n),n}function Sf(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Af=new WeakMap,Ef=new WeakMap,Cf=new WeakMap,kf=new WeakMap,Mf=new WeakMap,Pf=new WeakSet,If=new WeakMap,Rf=new WeakMap,Of=_((function t(e){var n=this;v(this,t),function(t,e){_f(t,e),e.add(t)}(this,Pf),wf(this,Af,window.game),wf(this,Ef,void 0),wf(this,Cf,void 0),wf(this,kf,!1),wf(this,Mf,(function(t){var e=t?"on":"off";bf(Af,n)[e]("checkoutState",bf(Rf,n)),bf(Af,n)[e](uh,bf(If,n))})),wf(this,If,(function(){Tf(kf,n,!0),bf(Rf,n).call(n),bf(Af,n).on(Ah,bf(Rf,n))})),wf(this,Rf,(function(){if(bf(kf,n)){var t=bf(Af,n).currentStateName;qc.log(Vc.SOUND_MANAGER,"[MusicManager state]: ".concat(t));var e=E(E({},sh,{play:"m_start-screen",stop:"m_ost"}),oh,{play:"m_ost",stop:"m_start-screen"})[t];if(e&&(bf(Cf,n).stop(e.stop),!bf(Cf,n).isPlaying(e.play))){var r=bf(Cf,n).musicList[e.play];"loaded"===r.state()?bf(Cf,n).play(e.play,{loop:!0}):r.on("load",(function(){return bf(Cf,n).play(e.play,{loop:!0})}))}}})),Tf(Cf,this,e),this.init()}),[{key:"init",value:function(){Tf(Ef,this,tf.get(Zd)),bf(Mf,this).call(this,!0),Sf(Pf,this,Lf).call(this)}}]);function Lf(){return Df.apply(this,arguments)}function Df(){return Df=Jh(nc().mark((function t(){var e,n,r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=lf(),n=e.START_MUSIC,r=e.LEVEL_MUSIC,t.next=3,bf(Cf,this).preload(bf(Cf,this).musicList,n);case 3:return qc.log(Vc.SOUND_MANAGER,"[START_MUSIC] loaded"),t.next=6,bf(Cf,this).preload(bf(Cf,this).musicList,r);case 6:qc.log(Vc.SOUND_MANAGER,"[LEVEL_MUSIC] loaded");case 7:case"end":return t.stop()}}),t,this)}))),Df.apply(this,arguments)}function Ff(t,e,n){Nf(t,e),e.set(t,n)}function Nf(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bf(t,e){return t.get(Uf(t,e))}function Wf(t,e,n){return t.set(Uf(t,e),n),n}function Uf(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jf=new WeakMap,Hf=new WeakMap,zf=new WeakMap,Gf=new WeakSet,Vf=new WeakMap,Xf=_((function t(e){var n=this;return v(this,t),function(t,e){Nf(t,e),e.add(t)}(this,Gf),Ff(this,jf,void 0),Ff(this,Hf,void 0),E(this,"musicList",[]),E(this,"sfxList",[]),E(this,"speechList",[]),E(this,"isInit",!1),E(this,"visibilityStateHandler",void 0),E(this,"isGlobalPaused",!1),E(this,"init",(function(){document.addEventListener("click",(function(){n.isInit||Bf(zf,n).call(n)}),{once:!0})})),E(this,"firstAdInit",(function(){n.isInit||Bf(zf,n).call(n)})),Ff(this,zf,(function(){n.isInit=!0,Bf(Hf,n).init(),Bf(jf,n).emit(uh),qc.log(Vc.SOUND_MANAGER,"catch first click")})),E(this,"clearSoundList",(function(t){t.forEach((function(t){return t.unload()})),t.length=0})),E(this,"preload",(function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,s=e.map((function(e){return new Promise((function(s){try{if(t[e.alias])return void s();var o=Array.isArray(e.src)?e.src:[e.src],a=new nf.Howl({src:o,preload:r});t[e.alias]=a,a.once("load",(function(){try{i&&i(),qc.log(Vc.SOUND_MANAGER,"sound is loaded:  ".concat(e.alias)),s()}catch(e){var t;of.preloadError(null==sf||null===(t=sf.SOUND_PRELOAD)||void 0===t?void 0:t.loading,e),s()}})),a.once("loaderror",(function(o,a){if("m_start-screen"===e.alias){var l="".concat("","assets/audio/music/m_start-screen.mp3"),h=new nf.Howl({src:[l],preload:r});return h.once("load",(function(){t[e.alias]=h,qc.log(Vc.SOUND_MANAGER,"sound is loaded from fallback: ".concat(e.alias)),i&&i(),Bf(jf,n).emit(uh),s()})),void h.once("loaderror",(function(t,n){console.warn("[fallback] Failed to load backup for ".concat(e.alias,":"),n),of.soundLoadErr(e,n),s()}))}of.soundLoadErr(e,a),s()}))}catch(t){var l;console.error("[preload] Error during sound setup",t),of.preloadError(null==sf||null===(l=sf.SOUND_PRELOAD)||void 0===l?void 0:l.loading,t),s()}}))}));return Promise.all(s).catch((function(t){console.error("[preload] Error in Promise.all",t)}))})),E(this,"preloadSFX",Jh(nc().mark((function t(){var e,r,i,s;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=lf(),r=e.CLICK_ITEMS_SPEECH,i=e.CLICK_ITEMS,s=e.SFX,t.next=4,n.preload(n.sfxList,r,!0);case 4:return t.next=6,n.preload(n.sfxList,i,!0);case 6:return t.next=8,n.preload(n.sfxList,s,!0);case 8:qc.log(Vc.SOUND_MANAGER,"soundManager loaded: sfx"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),qc.warn("","[SoundManager firstLoadAndInit error]: ".concat(t.t0));case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))),Ff(this,Vf,(function(t,e){t.forEach((function(t){Object.values(t).forEach((function(t){return t.mute(e)}))}))})),E(this,"muteSFX",(function(){Bf(Vf,n).call(n,[n.sfxList,n.speechList],!0)})),E(this,"unmuteSFX",(function(){Bf(Vf,n).call(n,[n.sfxList,n.speechList],!1)})),E(this,"muteMusic",(function(){Bf(Vf,n).call(n,[n.musicList],!0)})),E(this,"unmuteMusic",(function(){Bf(Vf,n).call(n,[n.musicList],!1)})),E(this,"mute",(function(){nf.Howler.mute(!0)})),E(this,"unmute",Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("suspended"!==(e=nf.Howler.ctx).state&&"interrupted"!==e.state){t.next=11;break}return t.prev=2,t.next=5,e.resume();case 5:n.unmute(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.warn("Failed to resume AudioContext",t.t0);case 11:nf.Howler.mute(!1);case 12:case"end":return t.stop()}}),t,null,[[2,8]])})))),"object"===y(t.instance)||(Wf(jf,this,e),Wf(Hf,this,new xf(Bf(jf,this),this)),this.visibilityStateHandler=Bf(Hf,this).visibilityStateHandler,this.init(),new Of(this),t.instance=this),t.instance}),[{key:"play",value:function(){var t=Jh(nc().mark((function t(e){var n,r,i,s,o,a,l=arguments;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(n=l.length>1&&void 0!==l[1]?l[1]:{}).loop,i=void 0!==r&&r,s=n.volume,o=void 0===s?1:s,t.prev=1,this.isInit&&!this.isGlobalPaused){t.next=4;break}return t.abrupt("return",Promise.resolve(!1));case 4:if(!(a=Uf(Gf,this,Yf).call(this,e))){t.next=10;break}return this.musicList[e]?Uf(Gf,this,$f).call(this,a,{loop:i,volume:o,isMusic:!0}):(this.sfxList[e]||this.speechList[e])&&Uf(Gf,this,$f).call(this,a,{loop:i,volume:o}),t.abrupt("return",new Promise((function(t){a.once("end",t)})));case 10:return console.warn("No found sound",e),t.abrupt("return",Promise.resolve());case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),console.warn("[play]",t.t0);case 17:case"end":return t.stop()}}),t,this,[[1,14]])})));return function(e){return t.apply(this,arguments)}}()},{key:"pauseAll",value:function(){this.isGlobalPaused=!0,[this.musicList,this.sfxList,this.speechList].forEach((function(t){Object.values(t).forEach((function(t){t.playing()&&(t.pause(),t.isPaused=!0)}))}))}},{key:"unPauseAll",value:function(){this.isGlobalPaused=!1,[this.musicList,this.sfxList,this.speechList].forEach((function(t){Object.values(t).forEach((function(t){(function(t){return t.isPaused&&"loaded"===t.state()})(t)&&(t.play(),t.isPaused=!1)}))}))}},{key:"stop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Uf(Gf,this,Yf).call(this,t);n&&n.playing()&&(n.fade(n.volume(),0,e),setTimeout((function(){return n.stop()}),e))}},{key:"stopAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;[this.musicList,this.sfxList,this.speechList].forEach((function(e){Jc(Object.values(e)).forEach((function(e){e.playing()&&(e.fade(e.volume(),0,t),setTimeout((function(){return e.stop()}),t))}))}))}},{key:"isPlaying",value:function(t){var e=Uf(Gf,this,Yf).call(this,t);return!!e&&e.playing()}}]);function Yf(t){return this.musicList[t]||this.sfxList[t]||this.speechList[t]}function $f(t,e){var n=e.loop,r=void 0!==n&&n,i=e.volume,s=void 0===i?1:i,o=e.isMusic,a=void 0!==o&&o;if(!this.isGlobalPaused){if(a){if(!tf.get(Zd).isPlayMusic)return;if(t.playing()||"loaded"!==t.state())return}else{if(!tf.get(Zd).isPlaySfx)return;t.stop()}t.loop(r),t.volume(s),t.play()}}var qf={MAIN_SCREEN_UI:{pngName:"mainScreenSpriteSheet",json:JSON.parse('{"frames":{"frame-header":{"frame":{"x":1,"y":1,"w":400,"h":67},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":1,"y":0,"w":400,"h":67},"sourceSize":{"w":401,"h":67},"pivot":{"x":0.5,"y":0.5}},"btn-bronze":{"frame":{"x":1,"y":70,"w":310,"h":122},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":310,"h":122},"sourceSize":{"w":310,"h":122},"pivot":{"x":0.5,"y":0.5}},"btn-gold":{"frame":{"x":1,"y":194,"w":310,"h":122},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":310,"h":122},"sourceSize":{"w":310,"h":122},"pivot":{"x":0.5,"y":0.5}},"btn-silver":{"frame":{"x":1,"y":318,"w":310,"h":122},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":310,"h":122},"sourceSize":{"w":310,"h":122},"pivot":{"x":0.5,"y":0.5}},"store-card":{"frame":{"x":403,"y":1,"w":118,"h":156},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":118,"h":156},"sourceSize":{"w":118,"h":156},"pivot":{"x":0.5,"y":0.5}},"user-level-frame":{"frame":{"x":313,"y":70,"w":151,"h":47},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":4,"y":9,"w":151,"h":47},"sourceSize":{"w":155,"h":66},"pivot":{"x":0.5,"y":0.5}},"icon-store-hint-counter":{"frame":{"x":362,"y":159,"w":139,"h":44},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":139,"h":44},"sourceSize":{"w":139,"h":44},"pivot":{"x":0.5,"y":0.5}},"icon-loupe-plus":{"frame":{"x":362,"y":205,"w":124,"h":79},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":3,"y":26,"w":124,"h":79},"sourceSize":{"w":127,"h":131},"pivot":{"x":0.5,"y":0.5}},"btn-circle":{"frame":{"x":313,"y":286,"w":119,"h":111},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":1,"y":0,"w":119,"h":111},"sourceSize":{"w":121,"h":112},"pivot":{"x":0.5,"y":0.5}},"btn-oval":{"frame":{"x":426,"y":286,"w":110,"h":82},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":110,"h":82},"sourceSize":{"w":110,"h":82},"pivot":{"x":0.5,"y":0.5}},"icon-loupe":{"frame":{"x":1,"y":442,"w":101,"h":101},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":101,"h":101},"sourceSize":{"w":101,"h":101},"pivot":{"x":0.5,"y":0.5}},"icon-light-on":{"frame":{"x":426,"y":398,"w":69,"h":83},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":69,"h":83},"sourceSize":{"w":69,"h":83},"pivot":{"x":0.5,"y":0.5}},"icon-light-off":{"frame":{"x":104,"y":469,"w":43,"h":68},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":13,"y":15,"w":43,"h":68},"sourceSize":{"w":69,"h":83},"pivot":{"x":0.5,"y":0.5}},"icon-noAd":{"frame":{"x":149,"y":469,"w":63,"h":60},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":11,"y":3,"w":63,"h":60},"sourceSize":{"w":86,"h":65},"pivot":{"x":0.5,"y":0.5}},"icon-music-off":{"frame":{"x":211,"y":469,"w":61,"h":61},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":61,"h":61},"sourceSize":{"w":61,"h":61},"pivot":{"x":0.5,"y":0.5}},"icon-sfx-off":{"frame":{"x":274,"y":469,"w":61,"h":61},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":61,"h":61},"sourceSize":{"w":61,"h":61},"pivot":{"x":0.5,"y":0.5}},"icon-wheel":{"frame":{"x":313,"y":407,"w":60,"h":60},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":60,"h":60},"sourceSize":{"w":60,"h":60},"pivot":{"x":0.5,"y":0.5}},"telegram":{"frame":{"x":337,"y":469,"w":60,"h":60},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":60,"h":60},"sourceSize":{"w":60,"h":60},"pivot":{"x":0.5,"y":0.5}},"icon-star":{"frame":{"x":399,"y":469,"w":57,"h":55},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":2,"y":0,"w":57,"h":55},"sourceSize":{"w":60,"h":56},"pivot":{"x":0.5,"y":0.5}},"icon-close":{"frame":{"x":313,"y":223,"w":47,"h":51},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":47,"h":51},"sourceSize":{"w":47,"h":51},"pivot":{"x":0.5,"y":0.5}},"icon-home":{"frame":{"x":375,"y":407,"w":50,"h":46},"rotated":true,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":50,"h":46},"sourceSize":{"w":50,"h":46},"pivot":{"x":0.5,"y":0.5}},"icon-music-on":{"frame":{"x":456,"y":469,"w":44,"h":50},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":10,"y":7,"w":44,"h":50},"sourceSize":{"w":61,"h":61},"pivot":{"x":0.5,"y":0.5}},"icon-sfx-on":{"frame":{"x":362,"y":70,"w":50,"h":37},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":7,"y":14,"w":50,"h":37},"sourceSize":{"w":61,"h":61},"pivot":{"x":0.5,"y":0.5}},"avatar-user-default":{"frame":{"x":523,"y":1,"w":42,"h":42},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":42,"h":42},"sourceSize":{"w":42,"h":42},"pivot":{"x":0.5,"y":0.5}},"icon-play":{"frame":{"x":523,"y":45,"w":40,"h":36},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":3,"y":3,"w":40,"h":36},"sourceSize":{"w":46,"h":41},"pivot":{"x":0.5,"y":0.5}},"leader-medal1":{"frame":{"x":523,"y":83,"w":36,"h":36},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":36,"h":36},"sourceSize":{"w":36,"h":36},"pivot":{"x":0.5,"y":0.5}},"leader-medal2":{"frame":{"x":362,"y":122,"w":35,"h":36},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":1,"y":0,"w":35,"h":36},"sourceSize":{"w":36,"h":36},"pivot":{"x":0.5,"y":0.5}},"leader-medal3":{"frame":{"x":523,"y":121,"w":35,"h":36},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":1,"y":0,"w":35,"h":36},"sourceSize":{"w":36,"h":36},"pivot":{"x":0.5,"y":0.5}},"icon-cup":{"frame":{"x":104,"y":442,"w":24,"h":24},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":1,"w":24,"h":24},"sourceSize":{"w":24,"h":25},"pivot":{"x":0.5,"y":0.5}},"particle":{"frame":{"x":130,"y":442,"w":18,"h":22},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":2,"y":3,"w":18,"h":22},"sourceSize":{"w":20,"h":26},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://github.com/odrick/free-tex-packer-core","version":"0.3.4","image":"mainScreenSpriteSheet.png","format":"RGBA8888","size":{"w":566,"h":544},"scale":1}}')},LEVEL_UI:{pngName:"levelSpriteSheet",json:JSON.parse('{"frames":{"intro-text-bubble":{"frame":{"x":1,"y":1,"w":400,"h":199},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":25,"y":26,"w":400,"h":199},"sourceSize":{"w":450,"h":250},"pivot":{"x":0.5,"y":0.5}},"speech-bubble":{"frame":{"x":1,"y":202,"w":387,"h":186},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":387,"h":186},"sourceSize":{"w":387,"h":186},"pivot":{"x":0.5,"y":0.5}},"speech-bubble-center":{"frame":{"x":1,"y":390,"w":320,"h":130},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":320,"h":130},"sourceSize":{"w":320,"h":130},"pivot":{"x":0.5,"y":0.5}},"special-card-1":{"frame":{"x":403,"y":1,"w":256,"h":255},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":0,"y":2,"w":256,"h":255},"sourceSize":{"w":256,"h":257},"pivot":{"x":0.5,"y":0.5}},"special-card-2":{"frame":{"x":390,"y":259,"w":254,"h":254},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":1,"y":3,"w":254,"h":254},"sourceSize":{"w":257,"h":257},"pivot":{"x":0.5,"y":0.5}},"special-card-3":{"frame":{"x":1,"y":522,"w":250,"h":234},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":3,"y":10,"w":250,"h":234},"sourceSize":{"w":256,"h":257},"pivot":{"x":0.5,"y":0.5}},"btn-badge":{"frame":{"x":323,"y":515,"w":246,"h":140},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":0,"w":246,"h":140},"sourceSize":{"w":246,"h":141},"pivot":{"x":0.5,"y":0.5}},"hint-stars":{"frame":{"x":660,"y":1,"w":188,"h":178},"rotated":true,"trimmed":true,"spriteSourceSize":{"x":5,"y":7,"w":188,"h":178},"sourceSize":{"w":200,"h":200},"pivot":{"x":0.5,"y":0.5}},"btn-hint":{"frame":{"x":660,"y":191,"w":161,"h":81},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":161,"h":81},"sourceSize":{"w":161,"h":81},"pivot":{"x":0.5,"y":0.5}},"learning-arrow":{"frame":{"x":253,"y":522,"w":63,"h":137},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":8,"y":9,"w":63,"h":137},"sourceSize":{"w":81,"h":150},"pivot":{"x":0.5,"y":0.5}},"error-cross":{"frame":{"x":323,"y":390,"w":65,"h":65},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":2,"y":2,"w":65,"h":65},"sourceSize":{"w":70,"h":70},"pivot":{"x":0.5,"y":0.5}}},"meta":{"app":"http://github.com/odrick/free-tex-packer-core","version":"0.3.4","image":"levelSpriteSheet.png","format":"RGBA8888","size":{"w":839,"h":757},"scale":1}}')}},Kf=function(){var t=Bh,e=qf.MAIN_SCREEN_UI.pngName;return{bundles:[{name:"gameScreen",assets:[{alias:e,src:"".concat(t,"assets/images/game/").concat(e,".png")},{alias:"startScreen",src:"".concat(t,"assets/images/game/startScreen.").concat(Bu.checkWebp())},{alias:"NotoSerif",src:"".concat(t,"assets/fonts/NotoSerif/NotoSerif.woff2")}]},{name:"lazyLoad",assets:[{alias:"Pacifico",src:"".concat(t,"assets/fonts/Pacifico/Pacifico.woff2")}]}]}};function Zf(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Qf(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var Jf=new WeakMap,tp=new WeakMap,ep=new WeakMap,np=_((function t(){var e=this;return v(this,t),Zf(this,Jf,18e4),Zf(this,tp,(function(){qc.log(Vc.Metrika,"GameTimeTrackerCounter start"),setInterval(Qf(ep,e),Qf(Jf,e))})),Zf(this,ep,(function(){of.gameTimeTracker()})),"object"===y(t.instance)?t.instance:(Qf(tp,this).call(this),t.instance=this)}));function rp(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var ip,sp=new WeakMap,op=_((function t(){var e=this;return v(this,t),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,sp,Bh),E(this,"localesHud",void 0),E(this,"storyText",void 0),E(this,"loadLocalesHud",Jh(nc().mark((function t(){var n;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(rp(sp,e),"assets/gameConfig/localesHud.json"),t.next=3,e.loadJson(n);case 3:e.localesHud=t.sent;case 4:case"end":return t.stop()}}),t)})))),E(this,"loadStoryTexts",Jh(nc().mark((function t(){var n;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(rp(sp,e),"assets/gameConfig/storyTexts.json"),t.next=3,e.loadJson(n);case 3:e.storyText=t.sent;case 4:case"end":return t.stop()}}),t)})))),E(this,"loadJson",function(){var t=Jh(nc().mark((function t(e){var n;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:return(n=t.sent).ok||console.error("Ошибка загрузки JSON: ".concat(n.status)),t.next=7,n.json();case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(0),console.error("Ошибка при загрузке JSON:",t.t0),t.abrupt("return",Promise.resolve(!1));case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()),"object"===y(t.instance)?t.instance:t.instance=this}));function ap(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function lp(t,e){return t.get(hp(t,e))}function hp(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}r(5506),r(3921),r(8130);var cp=new WeakMap,up=new WeakMap,dp=new WeakMap,fp=new WeakMap,pp=new WeakMap,mp=_((function t(){var e=this;v(this,t),ap(this,cp,tf.get(Zd)),ap(this,up,5),ap(this,dp,null),E(this,"getConfig",(function(){var n=lp(cp,e).savedLevel,r=n.levelIndex,i=n.skinIndex,s=t.getGameLevelData(r),o=s.spineName,a=s.backgroundName,l=/^.*?_(generator)$/.test(o);return function(t,e,n){t.set(hp(t,e),n)}(dp,e,{spineName:o,bgTexture:a,hogItemsBone:"hogItems",currentSkinName:"mode1/skin_mode1_v".concat(l?1:i)}),lp(pp,e).call(e),lp(dp,e)})),E(this,"updateSavedLevel",(function(){var t=lp(cp,e).savedLevel.levelIndex;lp(cp,e).savedLevel.levelIndex=t+1,lp(fp,e).call(e),lp(cp,e).saveData()})),ap(this,fp,(function(){lp(cp,e).savedLevel.levelIndex>t.maxLevels&&(qc.log(Vc.Config,"круг всех уровней пройден, увеличиваем скин level"),lp(cp,e).savedLevel.skinIndex++,lp(cp,e).config.partIndex++,lp(cp,e).savedLevel.skinIndex>lp(up,e)&&(qc.log(Vc.Config,"круг всех скинов завершен, сброс скинов"),lp(cp,e).savedLevel.skinIndex=1,of.completeGame()),lp(cp,e).savedLevel.levelIndex=0)})),ap(this,pp,(function(){var n;qc.log(Vc.Config,"level in levels: ".concat(lp(cp,e).savedLevel.levelIndex,"\n      spineName: ").concat(null===(n=lp(dp,e))||void 0===n?void 0:n.spineName,"\n      levelIndex ").concat(lp(cp,e).savedLevel.levelIndex," / ").concat(t.maxLevels,"\n      skinIndex: ").concat(lp(cp,e).savedLevel.skinIndex," / ").concat(lp(up,e),"\n      partIndex: ").concat(lp(cp,e).config.partIndex,"\n    ")),of.startLevel(lp(dp,e),lp(cp,e))}))}),null,[{key:"maxLevels",get:function(){var t=wp.getFilteredLevels();return Object.keys(t).length-1}}]);ip=mp,E(mp,"levelJsonNumber",null),E(mp,"getLevelNumber",(function(t){var e=t.match(/level(\d+)/);return e?Number(e[1]):null})),E(mp,"getGameLevelData",(function(t){var e=tf.get(Zd);t>ip.maxLevels&&(e.savedLevel.levelIndex=ip.maxLevels,t=ip.maxLevels);var n=wp.getFilteredLevels(),r=Object.entries(n)[t][1],i=r.spineName,s=ip.getLevelNumber(i);ip.levelJsonNumber=s;var o="back_lv".concat(s),a="hudData-".concat(s),l=r.isRemote,h=_SERVICE.isTestLocalUrl?Nh:"";return l&&(h=Bh),{levelData:r,levelJsonNumber:s,spineName:i,backgroundName:o,hudDataName:a,levelType:Bu.extractSuffix(i),background:{alias:o,src:"".concat(h,"assets/images/backgrounds/").concat(o,".jpg")},levelAtlas:"".concat(h,"assets/gameLevels/").concat(i,".atlas"),levelJson:"".concat(h,"assets/gameLevels/").concat(i,".json"),levelSpriteSheet:{alias:"".concat(i),src:"".concat(h,"assets/gameLevels/").concat(i,".png")},hudJson:"".concat(h,"assets/hud/").concat(a,".json"),hudSpriteSheet:{alias:a,src:"".concat(h,"assets/hud/").concat(a,".png")}}})),E(mp,"getSpeechAndTextData",(function(t,e){var n=e.savedLevel.skinIndex,r=ip.levelJsonNumber,i=t.locale,s=n%2?0:1,o=tf.get(Jd).storyText;return{introText:o[i]["lv".concat(r)].intro.text[s],outroText:o[i]["lv".concat(r)].outro.text[s],introSpeech:o[i]["lv".concat(r)].intro.speech[s],outroSpeech:o[i]["lv".concat(r)].outro.speech[s]}}));var gp=JSON.parse('{"level0":{"spineName":"level0","isRemote":true},"level1":{"spineName":"level1","isRemote":true},"level2":{"spineName":"level74_shadows","isRemote":true},"level3":{"spineName":"level2","isRemote":true},"level4":{"spineName":"level3","isRemote":true},"level5":{"spineName":"level85_words","isRemote":true},"level6":{"spineName":"level4","isRemote":false},"level7":{"spineName":"level5","isRemote":false},"level8":{"spineName":"level6","isRemote":false},"level9":{"spineName":"level95_generator","isRemote":false},"level10":{"spineName":"level7","isRemote":false},"level11":{"spineName":"level8","isRemote":false},"level12":{"spineName":"level75_shadows","isRemote":false},"level13":{"spineName":"level9","isRemote":false},"level14":{"spineName":"level10","isRemote":false},"level15":{"spineName":"level86_words","isRemote":false},"level16":{"spineName":"level11","isRemote":false},"level17":{"spineName":"level12","isRemote":false},"level18":{"spineName":"level13","isRemote":false},"level19":{"spineName":"level96_generator","isRemote":false},"level20":{"spineName":"level14","isRemote":false},"level21":{"spineName":"level15","isRemote":false},"level22":{"spineName":"level76_shadows","isRemote":false},"level23":{"spineName":"level16","isRemote":false},"level24":{"spineName":"level17","isRemote":false},"level25":{"spineName":"level87_words","isRemote":false},"level26":{"spineName":"level18","isRemote":false},"level27":{"spineName":"level19","isRemote":false},"level28":{"spineName":"level20","isRemote":false},"level29":{"spineName":"level97_generator","isRemote":false},"level30":{"spineName":"level21","isRemote":false},"level31":{"spineName":"level22","isRemote":false},"level32":{"spineName":"level77_shadows","isRemote":false},"level33":{"spineName":"level23","isRemote":false},"level34":{"spineName":"level24","isRemote":false},"level35":{"spineName":"level88_words","isRemote":false},"level36":{"spineName":"level25","isRemote":false},"level37":{"spineName":"level26","isRemote":false},"level38":{"spineName":"level27","isRemote":false},"level39":{"spineName":"level98_generator","isRemote":false},"level40":{"spineName":"level28","isRemote":false},"level41":{"spineName":"level29","isRemote":false},"level42":{"spineName":"level78_shadows","isRemote":false},"level43":{"spineName":"level30","isRemote":false},"level44":{"spineName":"level31","isRemote":false},"level45":{"spineName":"level89_words","isRemote":false},"level46":{"spineName":"level32","isRemote":false},"level47":{"spineName":"level33","isRemote":false},"level48":{"spineName":"level34","isRemote":false},"level49":{"spineName":"level99_generator","isRemote":false},"level50":{"spineName":"level35","isRemote":false},"level51":{"spineName":"level36","isRemote":false},"level52":{"spineName":"level79_shadows","isRemote":false},"level53":{"spineName":"level37","isRemote":false},"level54":{"spineName":"level38","isRemote":false},"level55":{"spineName":"level90_words","isRemote":false},"level56":{"spineName":"level39","isRemote":false},"level57":{"spineName":"level40","isRemote":false},"level58":{"spineName":"level41","isRemote":false},"level59":{"spineName":"level100_generator","isRemote":false},"level60":{"spineName":"level42","isRemote":false},"level61":{"spineName":"level43","isRemote":false},"level62":{"spineName":"level80_shadows","isRemote":false},"level63":{"spineName":"level44","isRemote":false},"level64":{"spineName":"level45","isRemote":false},"level65":{"spineName":"level91_words","isRemote":false},"level66":{"spineName":"level46","isRemote":false},"level67":{"spineName":"level47","isRemote":false},"level68":{"spineName":"level48","isRemote":false},"level69":{"spineName":"level101_generator","isRemote":false},"level70":{"spineName":"level49","isRemote":false},"level71":{"spineName":"level50","isRemote":false},"level72":{"spineName":"level81_shadows","isRemote":false},"level73":{"spineName":"level51","isRemote":false},"level74":{"spineName":"level52","isRemote":false},"level75":{"spineName":"level92_words","isRemote":false},"level76":{"spineName":"level53","isRemote":false},"level77":{"spineName":"level54","isRemote":false},"level78":{"spineName":"level55","isRemote":false},"level79":{"spineName":"level102_generator","isRemote":false},"level80":{"spineName":"level56","isRemote":false},"level81":{"spineName":"level57","isRemote":false},"level82":{"spineName":"level82_shadows","isRemote":false},"level83":{"spineName":"level58","isRemote":false},"level84":{"spineName":"level59","isRemote":false},"level85":{"spineName":"level93_words","isRemote":false},"level86":{"spineName":"level60","isRemote":false},"level87":{"spineName":"level61","isRemote":false},"level88":{"spineName":"level62","isRemote":false},"level89":{"spineName":"level103_generator","isRemote":false},"level90":{"spineName":"level70","isRemote":true},"level91":{"spineName":"level64","isRemote":true},"level92":{"spineName":"level83_shadows","isRemote":true},"level93":{"spineName":"level65","isRemote":true},"level94":{"spineName":"level66","isRemote":true},"level95":{"spineName":"level94_words","isRemote":true},"level96":{"spineName":"level67","isRemote":true},"level97":{"spineName":"level68","isRemote":true},"level98":{"spineName":"level69","isRemote":true},"level99":{"spineName":"level104_generator","isRemote":true},"level100":{"spineName":"level63","isRemote":true},"level101":{"spineName":"level71","isRemote":true},"level102":{"spineName":"level84_shadows","isRemote":true},"level103":{"spineName":"level72","isRemote":true},"level104":{"spineName":"level73","isRemote":true}}');function vp(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}var yp=new WeakMap,xp=new WeakMap,wp=_((function t(){return v(this,t),vp(this,yp,window.game),vp(this,xp,tf.get(Zd)),E(this,"skipLevel",(function(t){var e=mp.getGameLevelData(t).levelType;if(console.warn("levelType:",e),!e)return Promise.resolve(!1);var n=E(E(E({},lh,{flagName:_SERVICE.flags.useHudShadow,offMessage:"тени выключены пропуск уровня"}),hh,{flagName:_SERVICE.flags.useHudWords,offMessage:"слова выключены пропуск уровня"}),ch,{flagName:_SERVICE.flags.useLevelTypeGeneration,offMessage:"генераторы выключены пропуск уровня"})[e];if(!n)return Promise.resolve(!1);var r=Bu.isStringTrue(n.flagName);return console.log(e,r),r?Promise.resolve(!0):(console.log("пропуск уровня"),console.log(n.offMessage),Promise.resolve(!1))})),"object"===y(t.instance)?t.instance:t.instance=this}));function _p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_p=function(){return!!t})()}function bp(t,e,n,r){var i=tc(T(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function Tp(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Sp(t,e){return t.get(Ep(t,e))}function Ap(t,e,n){return t.set(Ep(t,e),n),n}function Ep(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}E(wp,"getTimerRewardDuration",(function(){return _SERVICE.flags.useTimerRewardDuration})),E(wp,"getFilteredLevels",(function(){var t=E(E(E({},lh,_SERVICE.flags.useHudShadow),hh,_SERVICE.flags.useHudWords),ch,_SERVICE.flags.useLevelTypeGeneration),e=Object.entries(t).filter((function(t){var e=iu(t,2)[1];return!Bu.isStringTrue(e)})).map((function(t){return iu(t,1)[0].toLowerCase()}));return Object.fromEntries(Object.entries(gp).filter((function(t){var n=iu(t,2)[1].spineName;return!e.some((function(t){return n.toLowerCase().includes(t)}))})))}));var Cp=new WeakMap,kp=new WeakMap,Mp=new WeakMap,Pp=new WeakMap,Ip=new WeakMap,Rp=new WeakMap,Op=new WeakMap,Lp=new WeakMap,Dp=new WeakMap,Fp=new WeakMap,Np=new WeakMap,Bp=new WeakMap,Wp=new WeakMap,Up=new WeakMap,jp=new WeakMap,Hp=new WeakMap,zp=new WeakMap,Gp=new WeakMap,Vp=new WeakMap,Xp=new WeakMap,Yp=function(t){function e(){var t;v(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=function(t,e,n){return e=T(e),b(t,_p()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[].concat(r)),Tp(t,Cp,void 0),Tp(t,kp,void 0),Tp(t,Mp,void 0),Tp(t,Pp,void 0),Tp(t,Ip,0),Tp(t,Rp,void 0),Tp(t,Op,0),Tp(t,Lp,5),Tp(t,Dp,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Fo.init({manifest:Kf()});case 2:return Fo.backgroundLoadBundle(["lazyLoad"]),t.next=5,Fo.loadBundle(["gameScreen"]);case 5:qc.log(Vc.GamePreload,"gameScreen loaded");case 6:case"end":return t.stop()}}),t)})))),Tp(t,Fp,Jh(nc().mark((function e(){var n;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window._SERVICE.getLocale();case 2:return n=e.sent,t.game.locale=n,e.next=6,zc.init({lng:n,resources:{en:{translation:Gc.en},ru:{translation:Gc.ru}}});case 6:qc.log(Vc.GamePreload,"Current locale: ".concat(n));case 7:case"end":return e.stop()}}),e)})))),Tp(t,Np,Jh(nc().mark((function e(){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ap(Cp,t,new Kd(t.game)),t.game.viewport.addChild(Sp(Cp,t)),Ap(Ip,t,.6),Sp(Bp,t).call(t),qc.log(Vc.GamePreload,"initView");case 5:case"end":return e.stop()}}),e)})))),Tp(t,Bp,(function(){if(Sp(Cp,t)){Ap(Ip,t,Sp(Ip,t)+.1);var e=Math.ceil(100*Sp(Ip,t)),n=Sp(Cp,t).refs.textPreload;n.text="".concat(zc.t("textLoading")," ").concat(Math.min(e,100),"%"),n.style.fontFamily="NotoSerif",Ap(kp,t,n)}})),Tp(t,Wp,(function(){tf.register(Zd,new Nu(t.game)),tf.register(Qd,new Xf(t.game)),tf.register(Jd,new op),tf.register("ABTest",new wp(t.game)),Ap(Mp,t,tf.get(Zd)),Ap(Pp,t,tf.get(Qd))})),Tp(t,Up,Jh(nc().mark((function e(){var n,r;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_SERVICE.initMainSdkServices();case 3:return n=tf.get(Zd),e.next=6,n.loadData().then(Sp(Bp,t));case 6:return e.next=8,_SERVICE.checkPayments(n).then(Sp(Bp,t));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),qc.warn(Vc.GamePreload,"[hard reload] startGame error: ".concat(e.t0)),of.preloadError(null==sf||null===(r=sf.GAME_PRELOAD)||void 0===r?void 0:r.loadPlayerData,e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))),Tp(t,jp,Jh(nc().mark((function e(){var n,r;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=qf.MAIN_SCREEN_UI.json,e.next=4,Fo.get(qf.MAIN_SCREEN_UI.pngName);case 4:return r=e.sent,e.next=7,Bu.createSpriteSheet(r,n);case 7:Sp(Bp,t).call(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),qc.warn(Vc.GamePreload,e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))),Tp(t,Hp,Jh(nc().mark((function e(){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Sp(zp,t).call(t),e.next=3,Sp(Up,t).call(t);case 3:return _SERVICE.loadingAPIisReady(),tf.get(Zd).hasAdPass||_SERVICE.showFullscreenAdv({onOpen:function(){Sp(Pp,t).pauseAll()},onClose:function(){var e=Jh(nc().mark((function e(){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Sp(Pp,t).unPauseAll(),Sp(Pp,t).firstAdInit();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),t.terminate(),t.game.emit(t.game.stateAfterPreload),new np,Sp(Pp,t).preloadSFX(),e.next=11,_SERVICE.preloadRewardedAd();case 11:case"end":return e.stop()}}),e)})))),Tp(t,zp,(function(){var e=performance.now(),n=Math.trunc(e-Sp(Rp,t));qc.log(Vc.GamePreload,"sdk + game loaded in ".concat(n," ms")),of.loadDuration(n)})),Tp(t,Gp,(function(){t.terminate(),Ap(Op,t,0),t.game.emit(ih),of.forceReload(),console.error("---------------- forceReload")})),Tp(t,Vp,(function(){if(Sp(Op,t)<Sp(Lp,t)){var e,n;Ap(Op,t,(e=Sp(Op,t),++e));var r=null===(n=Sp(Cp,t))||void 0===n||null===(n=n.refs)||void 0===n?void 0:n.textPreload;r&&(r.text="".concat(zc.t("loadErr")," ").concat(Sp(Op,t)," / ").concat(Sp(Lp,t))),console.log("".concat(zc.t("loadErr")," ").concat(Sp(Op,t)," / ").concat(Sp(Lp,t))),setTimeout((function(){return t.initialize()}),3e3)}else qc.warn(Vc.GamePreload,"Превышено максимальное количество попыток загрузки: ".concat(Sp(Lp,t))),Sp(Gp,t).call(t)})),Tp(t,Xp,(function(){var e=_SERVICE.isTestLocalUrl?Nh:"",n="".concat(e,"assets/images/game/cursor/cursor-normal.png"),r="".concat(e,"assets/images/game/cursor/cursor-hand.png"),i=t.game.app,s="url('".concat(n,"'),auto"),o="url('".concat(r,"'),auto");i.renderer.events.cursorStyles.default=s,i.renderer.events.cursorStyles.pointer=o,i.renderer.events.cursorStyles.none=s})),t}return A(e,t),_(e,[{key:"initEventName",get:function(){return ih}},{key:"initialize",value:(n=Jh(nc().mark((function t(){var n;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return bp(e,"initialize",this,3)([]),t.prev=1,Ap(Rp,this,performance.now()),t.next=5,_SERVICE.initSdk(this.game);case 5:return Sp(Wp,this).call(this),t.next=8,Sp(Dp,this).call(this);case 8:return t.next=10,Sp(Fp,this).call(this);case 10:return t.next=12,Sp(Np,this).call(this);case 12:return this.isInitialized=!0,t.next=15,Fo.loadBundle("gameScreen");case 15:return t.next=17,Sp(jp,this).call(this);case 17:return t.next=19,Sp(Hp,this).call(this);case 19:t.next=25;break;case 21:t.prev=21,t.t0=t.catch(1),console.error("[MODULES.GamePreload] initialize error: ".concat(t.t0)),of.preloadError(null==sf||null===(n=sf.GAME_PRELOAD)||void 0===n?void 0:n.initialize,t.t0);case 25:case"end":return t.stop()}}),t,this,[[1,21]])}))),function(){return n.apply(this,arguments)})},{key:"resize",value:function(){var t=Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=Sp(Cp,this))||void 0===e?void 0:e.resize();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"terminate",value:function(){this.game.emit(yh),Sp(Cp,this).destroy({children:!0}),this.game.uiInner.removeChildren(),Ap(Cp,this,null),this.isInitialized=!1}}]);var n}(Kc);function $p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qp(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$p(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Kp=function(t){var e=t.typeTexture,n=t.texture,r=t.iconScale;return tu(rs,{cursor:"pointer",eventMode:"static"},tu(os,{texture:e,type:"button",anchor:{x:.5,y:.5}}),tu(os,{name:"icon",texture:n,anchor:{x:.5,y:.5},scale:{x:r,y:r}}))},Zp=function(t){var e=t.texture,n=void 0===e?"":e,r=t.iconScale;return tu(Kp,{typeTexture:"btn-circle",texture:n,iconScale:void 0===r?1:r})},Qp=function(t){var e=t.texture,n=void 0===e?"":e,r=t.iconScale;return tu(Kp,{typeTexture:"btn-oval",texture:n,iconScale:void 0===r?1:r})},Jp=function(t){var e,n=t.texture,r=void 0===n?"btn-bronze":n,i=t.text,s=void 0===i?"":i;return t.fontSize,e=t.textStyle||qp(qp({},Gd),{},{fill:16777215}),tu(os,{texture:r,type:"button",anchor:{x:.5,y:.5},cursor:"pointer",eventMode:"static"},tu(Ms,{name:"innerText",text:s,style:e,anchor:{x:.5,y:.5}}))},tm=function(t){var e,n=t.texture,r=void 0===n?"btn-bronze":n,i=t.text,s=void 0===i?"":i,o=(t.fontSize,t.setFilter),a=void 0===o?[]:o;return e=t.textStyle||qp(qp({},Gd),{},{fill:16777215}),tu(rs,{type:"button",cursor:"pointer",eventMode:"static",filters:[a]},tu(os,{texture:r,anchor:{x:.5,y:.5}}),tu(Ms,{name:"innerText",text:s,style:e,anchor:{x:.5,y:.5}}))},em=function(t){var e=t.texture,n=t.scaleValue,r=void 0===n?1:n,i=t.text,s=t.style;return tu(rs,{name:"btnLater",type:"button",eventMode:"static",cursor:"pointer"},tu(os,{texture:e,scale:{x:r,y:r},anchor:{x:.5,y:.5}}),tu(Ms,{text:i,style:s,anchor:{x:.5,y:.5}}))},nm=function(t){var e=t.game,n=t.refs;return tu(os,{ref:function(t){return n.optionsWheel=t},name:"optionsWheel",texture:"icon-wheel",eventMode:"static",cursor:"pointer",type:"button",classes:Vd(e).optionsWheel,anchor:{x:.5,y:.5},visible:!1})};function rm(){var t={},e={fade:{texture:vr.WHITE,width:Dh.WIDTH,height:Dh.HEIGHT,tint:0,alpha:.5},optionPopUp:Gu({x:Dh.HALF_W+20,y:Dh.HALF_H,pivot:function(){return{x:t.optionPopUp.width/2,y:t.optionPopUp.height/2}},"(orientation: landscape)":{}}),iconClose:{x:426,y:2},btnMainSfx:{x:140,y:92},btnMainSound:{x:290,y:92},btnMainScreen:{x:140,y:212},btnMainLight:{x:290,y:212}},n=new Ya;return n.lineStyle(10,9142607,1),n.beginFill(16445894),n.drawRect(0,0,430,300),n.endFill(),tu(rs,{ref:function(e){return t.root=e},eventMode:"static",name:"optionView",zIndex:10,resize:function(){t.optionPopUp.classes=e.optionPopUp}},tu(os,{classes:e.fade,name:"fade",alpha:0}),tu(rs,{classes:e.optionPopUp,name:"optionPopUp",ref:function(e){return t.optionPopUp=e},eventMode:"static"},n,tu(Jp,{texture:"icon-close",name:"btnClose",classes:e.iconClose}),tu(Zp,{type:"button",texture:"icon-home",name:"btnMainScreen",classes:e.btnMainScreen}),tu(Zp,{type:"button",texture:"icon-music-off",name:"soundBtn",classes:e.btnMainSound}),tu(Zp,{type:"button",texture:"icon-sfx-off",name:"sfxBtn",classes:e.btnMainSfx}),tu(Zp,{type:"button",texture:"icon-light-off",name:"btnLight",classes:e.btnMainLight}),tu(Ms,{text:"debug",name:"btnDebug",visible:!1,cursor:"pointer",eventMode:"static",style:{fill:16711854},x:10,y:260})))}function im(){var t={},e={};return tu(rs,{ref:function(t){return e.root=t},style:t,classes:t,resize:function(){e.root.classes=e.root.style},refs:e})}function sm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function om(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sm(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sm(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var am=function(t){var e=t.game,n=t.refs;return tu(rs,{ref:function(t){return n.userLevel=t},name:"userLevel",classes:Vd(e).userLevel},tu(os,{texture:"user-level-frame",anchor:{x:.5,y:.5}}),tu(Ms,{name:"playerLevelText",anchor:{x:.5,y:.5},text:1,x:28,y:2,style:om({},Gd)}))};function lm(t){var e=t.refs,n=t.game,r=[{name:"btnStart",text:zc.t("btnStart"),y:-7,texture:"btn-bronze"},{name:"btnStore",text:zc.t("store"),y:132,icon:""},{name:"btnLeaderboard",text:zc.t("Leaders"),y:264,icon:""}];return tu(rs,{ref:function(t){return e.startScreenView=t}},tu(im,{name:"btnContainer",ref:function(t){return e.btnContainer=t},style:Vd(n).btnContainer},r.map((function(t){return function(t){var e=t.name,n=t.texture,r=void 0===n?"btn-gold":n,i=t.text,s=t.x,o=void 0===s?0:s,a=t.y,l=void 0===a?0:a,h=(t.icon,"btnStart"===e?1.1:1),c="btnStart"===e?48:36;return tu(rs,{name:e,typeName:"button",x:o,y:l,eventMode:"static",cursor:"pointer"},tu(os,{texture:r,anchor:{x:.5,y:.5},scale:{x:h,y:h}}),tu(Ms,{name:"btnText",text:i,style:om(om({},Gd),{},{fontSize:c}),anchor:{x:.5,y:.5}}))}(t)}))))}function hm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function cm(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hm(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hm(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var um=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,s=t.w,o=void 0===s?420:s,a=t.h,l=void 0===a?466:a,h=t.center,c=t.text,u=void 0===c?"":c,d=t.beginFill,f=void 0===d?3019539:d,p=t.borderFill,m=void 0===p?9142607:p,g=new Ya;return g.beginFill(f),g.lineStyle(10,m,1),g.drawRect(n+5,i+5,o,l),g.endFill(),h&&g.position.set(-g.width/2+n+5,-g.height/2+i+5),tu(rs,null,g,tu(os,{texture:"frame-header",anchor:{x:.5,y:0},x:o/2+5,y:22}),tu(Ms,{x:o/2+5,y:54,text:u,anchor:{x:.5,y:.5},style:cm(cm({},Gd),{},{fontSize:36})}),tu(Jp,{x:o+5,y:4,name:"btnClose",texture:"icon-close"}))};function dm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function fm(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dm(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dm(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var pm={view:Gu({x:Dh.HALF_W,y:Dh.HALF_H-60,scale:{x:1.1,y:1.1},"(orientation: landscape)":{scale:{x:1.4,y:1.4}}}),getLocale:function(){return"ru"===window.game.locale?10:"en"===window.game.locale?18:void 0},btnPriceTextStyle:function(t){return{x:t===Fh.free.id?12:0,y:0,anchor:{x:.5,y:.5},style:fm(fm({},Gd),{},{fontSize:t===Fh.free.id?pm.getLocale():18})}},iconCard:function(t){return t===Fh.noAdPack.id?{scale:{x:1,y:1},anchor:{x:.5,y:.5},y:-20}:{scale:{x:.6,y:.6},anchor:{x:.5,y:.5},y:-40}}};function mm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function gm(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mm(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mm(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var vm=Yd({w:80,h:36,color:15722430,r:30,center:!0});function xm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function wm(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xm(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xm(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _m={view:Gu({x:Dh.HALF_W,y:Dh.HALF_H-124,scale:{x:1.1,y:1.1},"(orientation: landscape)":{scale:{x:1.4,y:1.4}}})},bm=function(){var t=14277081;return tu(rs,{name:"gapRow",y:302,x:215,visible:!1,alpha:0},qd({x:-18,r:9,color:t}),qd({r:9,color:t}),qd({x:18,r:9,color:t}))},Tm=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.publicName,i=e.rank,s=e.score,o=void 0===s?0:s,a=e.y,l=void 0===a?0:a,h=n.length>18?"".concat(n.slice(0,20),"..."):n,c=qd({r:42,color:13421772});return c.name="mask",tu(rs,{name:"scoreRow",y:l,rank:i,score:o,isPlayer:!1},tu(Ms,{text:i,name:"rank",x:38,y:34,anchor:{x:.5,y:.5},style:wm(wm({},r.g),{},{fill:16777215,fontSize:16})}),tu(rs,{name:"avatarContainer",x:85,y:34},c),tu(Ms,{text:h,name:"userName",anchor:{x:0,y:.5},x:113,y:34,style:wm(wm({},Gd),{},{fill:16777215,fontSize:16})}),tu(Ms,{name:"score",text:o,x:386,style:wm(wm({},Gd),{},{fill:16577179,fontSize:20}),anchor:{x:1,y:.5},y:34}),tu(os,{texture:"icon-cup",x:390,y:34,anchor:{x:0,y:.5}}),((t=Yd({x:10,y:68,w:410,h:2,color:16777215})).alpha=.4,t.name="borderBottom",t))},Sm=function(t){return tu(im,{ref:function(e){return t.storeView=e},zIndex:10,style:pm.view,pivot:{x:215,y:215},visible:!1},tu(um,{h:496,text:"".concat(zc.t("store"))}),tu((function(){return tu(rs,{x:215,y:123},tu(os,{texture:"icon-store-hint-counter",anchor:{x:.5,y:.5}}),tu(Ms,{name:"textStoreCounter",x:50,anchor:{x:1,y:.5},style:fm(fm({},Gd),{},{fontSize:25,fill:16774605})}))}),null),tu(rs,{name:"cardsContainer",x:14,y:236},function(){for(var t,e,n,r,i,s,o=[],a=Object.keys(Fh),l=0;l<6;l++){var h=(t=a[l],n=(e=Fh[t]).texture,r=e.textInCard,i=t===Fh.free.id,s=t===Fh.free.id?zc.t("free"):"",tu(rs,{name:t,typeName:"card",eventMode:"static"},tu(os,{texture:"store-card",anchor:{x:.5,y:.5}},tu(os,{name:"cardPic",texture:n,classes:pm.iconCard(t)})),tu(Ms,{name:"textTitle",text:r,y:10,anchor:{x:.5,y:.5},style:fm(fm({},Gd),{},{fontSize:28})}),tu(Ms,{name:"isBuy",text:"".concat(zc.t("purchased")),y:38,anchor:{x:.5,y:.5},style:fm(fm({},Gd),{},{fontSize:18}),visible:!1}),tu(rs,{y:50,typeName:"button",name:"btnPrice",cursor:"pointer",eventMode:"static"},tu(os,{texture:"btn-bronze",scale:{x:.35,y:.35},anchor:{x:.5,y:.5}}),tu(Ms,{name:"priceText",text:s,classes:pm.btnPriceTextStyle(t)}),tu(os,{texture:"icon-play",x:-32,name:"iconPlay",anchor:{x:.5,y:.5},visible:i,scale:{x:.5,y:.5}})))),c=l%3*128+14,u=166*Math.floor(l/3);h.position.set(59+c,u),o.push(h)}return o}()),tu(Ms,{name:"textLoading",text:"Загрузка...",visible:!1,x:215,y:250,anchor:{x:.5,y:.5},style:{fill:16777215,fontSize:44,fontWeight:"800",fontFamily:"NotoSerif"}}))},Am=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16773393,e=new gd;return e.color=t,e.name="colorOverlay",e},Em=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.brightness,n=void 0===e?.5:e,r=t.greyscale,i=void 0===r?.5:r,s=t.blackWhite,o=void 0!==s&&s,a=new Ds;return a.brightness(n,!1),a.greyscale(i,o),a.name="colorMatrix",a};function Cm(t){var e=t.bodyColor,n=void 0===e?16445894:e,r=t.borderColor,i=void 0===r?9142607:r,s=t.size,o=void 0===s?{w:430,h:300}:s,a=t.fadeAlpha,l=void 0===a?.65:a,h={},c={modal:Gu({x:Dh.HALF_W,y:Dh.HALF_H,"(orientation: landscape)":{}}),btnClose:{x:o.w/2,y:-o.h/2,anchor:{x:.5,y:.5},cursor:"pointer",eventMode:"static"}},u=new Ya;return u.lineStyle(10,i,1),u.beginFill(n),u.drawRect(0,0,o.w,o.h),u.endFill(),u.pivot.set(o.w/2,o.h/2),tu(rs,{ref:function(t){return h.root=t},eventMode:"static",zIndex:10,visible:!1},tu(os,{texture:vr.WHITE,name:"fade",tint:0,width:Dh.WIDTH,height:Dh.HEIGHT,alpha:l}),tu(rs,{name:"innerModal",classes:c.modal},u,tu(Jp,{texture:"icon-close",name:"btnClose",classes:c.btnClose})))}function km(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Mm(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?km(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):km(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Pm(){var t={};return tu(Cm,{ref:function(e){return t.root=e},zIndex:11,size:{w:430,h:240},fadeAlpha:0},tu((function(){return tu(rs,{name:"innerContainer"},tu(Ms,{name:"innerText",text:"".concat(zc.t("purchaseError")),y:0,anchor:{x:.5,y:.5},style:Mm(Mm({},Gd),{},{fontSize:35,wordWrap:!0,wordWrapWidth:400,align:"center",fontFamily:"NotoSerif"})}))}),null))}function Im(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Rm(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Im(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Im(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Om(){var t={};return tu(Cm,{ref:function(e){return t.root=e},fadeAlpha:0},[tu(rs,{name:"innerView"},tu(Ms,{text:"".concat(zc.t("authorizationHeader")),y:-80,style:Rm(Rm({},Gd),{},{fontSize:36}),anchor:{x:.5,y:.5}}),tu(Ms,{text:"".concat(zc.t("authorizationText1")),x:-190,y:-28,style:Rm(Rm({},Gd),{},{fontSize:22}),anchor:{x:0,y:.5}}),tu(Ms,{text:"".concat(zc.t("authorizationText2")),x:-190,y:7,style:Rm(Rm({},Gd),{},{fontSize:22}),anchor:{x:0,y:.5}}),tu(Jp,{texture:"btn-bronze",text:"".concat(zc.t("authorizationBtn")),textStyle:{fill:0,fontSize:40},y:85,x:0,scale:{x:.6,y:.6},name:"btnEnter"}))])}function Lm(t){var e,n={};return(e=t.uiInner).addChild.apply(e,Jc([tu(am,{game:t,refs:n}),tu(nm,{refs:n,game:t}),tu((function(t){var e=t.game,n=t.refs;return tu(os,{ref:function(t){return n.telegram=t},name:"telegram",texture:"telegram",eventMode:"static",cursor:"pointer",type:"button",classes:Vd(e).telegram,anchor:{x:.5,y:.5},visible:!0})}),{refs:n,game:t}),tu(lm,{ref:function(t){return n.startScreenView=t},refs:n,game:t})])),tu(rs,{refs:n,resize:function(){return Wu(n)},sortableChildren:!0,name:"gameView"},tu(rs,{ref:function(t){return n.wrapper=t},name:"wrapper",sortableChildren:!0},tu(os,{texture:"startScreen"}),tu(os,{ref:function(t){return n.fade=t},name:"fade",visible:!1,classes:Xd.fade}),Sm(n),function(t){return tu(im,{ref:function(e){return t.scoreboardView=e},visible:!1,style:_m.view,pivot:{x:215,y:233}},tu(um,{h:640,text:"".concat(zc.t("Leaders"))}),tu(bm,null),tu(Ms,{text:"".concat(zc.t("textLoading"),"..."),name:"textLoading",anchor:{x:.5,y:.5},x:215,y:360,style:wm(wm({},Gd),{},{fill:16777215,fontSize:35})}),tu(rs,{name:"list",y:87,alpha:0}))}(n)),tu(Pm,{ref:function(t){return n.purchaseErrorView=t}}),tu(rm,{ref:function(t){return n.optionsView=t},visible:!1}),tu(Om,{ref:function(t){return n.authorizationView=t},visible:!1}))}function Dm(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fm(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Nm,Bm,Wm,Um,jm,Hm,zm,Gm,Vm,Xm,Ym,$m={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},qm={duration:.5,overwrite:!1,delay:0},Km=1e8,Zm=1e-8,Qm=2*Math.PI,Jm=Qm/4,tg=0,eg=Math.sqrt,ng=Math.cos,rg=Math.sin,ig=function(t){return"string"==typeof t},sg=function(t){return"function"==typeof t},og=function(t){return"number"==typeof t},ag=function(t){return void 0===t},lg=function(t){return"object"==typeof t},hg=function(t){return!1!==t},cg=function(){return"undefined"!=typeof window},ug=function(t){return sg(t)||ig(t)},dg="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},fg=Array.isArray,pg=/(?:-?\.?\d|\.)+/gi,mg=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,gg=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,vg=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,yg=/[+-]=-?[.\d]+/,xg=/[^,'"\[\]\s]+/gi,wg=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_g={},bg={},Tg=function(t){return(bg=Qg(t,_g))&&Qy},Sg=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Ag=function(t,e){return!e&&console.warn(t)},Eg=function(t,e){return t&&(_g[t]=e)&&bg&&(bg[t]=e)||_g},Cg=function(){return 0},kg={suppressEvents:!0,isStart:!0,kill:!1},Mg={suppressEvents:!0,kill:!1},Pg={suppressEvents:!0},Ig={},Rg=[],Og={},Lg={},Dg={},Fg=30,Ng=[],Bg="",Wg=function(t){var e,n,r=t[0];if(lg(r)||sg(r)||(t=[t]),!(e=(r._gsap||{}).harness)){for(n=Ng.length;n--&&!Ng[n].targetTest(r););e=Ng[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new dy(t[n],e)))||t.splice(n,1);return t},Ug=function(t){return t._gsap||Wg(Mv(t))[0]._gsap},jg=function(t,e,n){return(n=t[e])&&sg(n)?t[e]():ag(n)&&t.getAttribute&&t.getAttribute(e)||n},Hg=function(t,e){return(t=t.split(",")).forEach(e)||t},zg=function(t){return Math.round(1e5*t)/1e5||0},Gg=function(t){return Math.round(1e7*t)/1e7||0},Vg=function(t,e){var n=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),"+"===n?t+r:"-"===n?t-r:"*"===n?t*r:t/r},Xg=function(t,e){for(var n=e.length,r=0;t.indexOf(e[r])<0&&++r<n;);return r<n},Yg=function(){var t,e,n=Rg.length,r=Rg.slice(0);for(Og={},Rg.length=0,t=0;t<n;t++)(e=r[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},$g=function(t,e,n,r){Rg.length&&!Bm&&Yg(),t.render(e,n,r||Bm&&e<0&&(t._initted||t._startAt)),Rg.length&&!Bm&&Yg()},qg=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(xg).length<2?e:ig(t)?t.trim():t},Kg=function(t){return t},Zg=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},Qg=function(t,e){for(var n in e)t[n]=e[n];return t},Jg=function t(e,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(e[r]=lg(n[r])?t(e[r]||(e[r]={}),n[r]):n[r]);return e},tv=function(t,e){var n,r={};for(n in t)n in e||(r[n]=t[n]);return r},ev=function(t){var e,n=t.parent||Um,r=t.keyframes?(e=fg(t.keyframes),function(t,n){for(var r in n)r in t||"duration"===r&&e||"ease"===r||(t[r]=n[r])}):Zg;if(hg(t.inherit))for(;n;)r(t,n.vars.defaults),n=n.parent||n._dp;return t},nv=function(t,e,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var s,o=t[r];if(i)for(s=e[i];o&&o[i]>s;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[r]=e,e._prev=o,e.parent=e._dp=t,e},rv=function(t,e,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=e._prev,s=e._next;i?i._next=s:t[n]===e&&(t[n]=s),s?s._prev=i:t[r]===e&&(t[r]=i),e._next=e._prev=e.parent=null},iv=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},sv=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},ov=function(t,e,n,r){return t._startAt&&(Bm?t._startAt.revert(Mg):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},av=function t(e){return!e||e._ts&&t(e.parent)},lv=function(t){return t._repeat?hv(t._tTime,t=t.duration()+t._rDelay)*t:0},hv=function(t,e){var n=Math.floor(t=Gg(t/e));return t&&n===t?n-1:n},cv=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},uv=function(t){return t._end=Gg(t._start+(t._tDur/Math.abs(t._ts||t._rts||Zm)||0))},dv=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=Gg(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),uv(t),n._dirty||sv(n,t)),t},fv=function(t,e){var n;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(n=cv(t.rawTime(),e),(!e._dur||Av(0,e.totalDuration(),n)-e._tTime>Zm)&&e.render(n,!0)),sv(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},pv=function(t,e,n,r){return e.parent&&iv(e),e._start=Gg((og(n)?n:n||t!==Um?bv(t,n,e):t._time)+e._delay),e._end=Gg(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),nv(t,e,"_first","_last",t._sort?"_start":0),yv(e)||(t._recent=e),r||fv(t,e),t._ts<0&&dv(t,t._tTime),t},mv=function(t,e){return(_g.ScrollTrigger||Sg("scrollTrigger",e))&&_g.ScrollTrigger.create(e,t)},gv=function(t,e,n,r,i){return wy(t,e,i),t._initted?!n&&t._pt&&!Bm&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&Vm!==Jv.frame?(Rg.push(t),t._lazy=[i,r],1):void 0:1},vv=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},yv=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},xv=function(t,e,n,r){var i=t._repeat,s=Gg(e)||0,o=t._tTime/t._tDur;return o&&!r&&(t._time*=s/t._dur),t._dur=s,t._tDur=i?i<0?1e10:Gg(s*(i+1)+t._rDelay*i):s,o>0&&!r&&dv(t,t._tTime=t._tDur*o),t.parent&&uv(t),n||sv(t.parent,t),t},wv=function(t){return t instanceof py?sv(t):xv(t,t._dur)},_v={_start:0,endTime:Cg,totalDuration:Cg},bv=function t(e,n,r){var i,s,o,a=e.labels,l=e._recent||_v,h=e.duration()>=Km?l.endTime(!1):e._dur;return ig(n)&&(isNaN(n)||n in a)?(s=n.charAt(0),o="%"===n.substr(-1),i=n.indexOf("="),"<"===s||">"===s?(i>=0&&(n=n.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(i<0?l:r).totalDuration()/100:1)):i<0?(n in a||(a[n]=h),a[n]):(s=parseFloat(n.charAt(i-1)+n.substr(i+1)),o&&r&&(s=s/100*(fg(r)?r[0]:r).totalDuration()),i>1?t(e,n.substr(0,i-1),r)+s:h+s)):null==n?h:+n},Tv=function(t,e,n){var r,i,s=og(e[1]),o=(s?2:1)+(t<2?0:1),a=e[o];if(s&&(a.duration=e[1]),a.parent=n,t){for(r=a,i=n;i&&!("immediateRender"in r);)r=i.vars.defaults||{},i=hg(i.vars.inherit)&&i.parent;a.immediateRender=hg(r.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return new Ay(e[0],a,e[o+1])},Sv=function(t,e){return t||0===t?e(t):e},Av=function(t,e,n){return n<t?t:n>e?e:n},Ev=function(t,e){return ig(t)&&(e=wg.exec(t))?e[1]:""},Cv=[].slice,kv=function(t,e){return t&&lg(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&lg(t[0]))&&!t.nodeType&&t!==jm},Mv=function(t,e,n){return Wm&&!e&&Wm.selector?Wm.selector(t):!ig(t)||n||!Hm&&ty()?fg(t)?function(t,e,n){return void 0===n&&(n=[]),t.forEach((function(t){var r;return ig(t)&&!e||kv(t,1)?(r=n).push.apply(r,Mv(t)):n.push(t)}))||n}(t,n):kv(t)?Cv.call(t,0):t?[t]:[]:Cv.call((e||zm).querySelectorAll(t),0)},Pv=function(t){return t=Mv(t)[0]||Ag("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return Mv(e,n.querySelectorAll?n:n===t?Ag("Invalid scope")||zm.createElement("div"):t)}},Iv=function(t){return t.sort((function(){return.5-Math.random()}))},Rv=function(t){if(sg(t))return t;var e=lg(t)?t:{each:t},n=ay(e.ease),r=e.from||0,i=parseFloat(e.base)||0,s={},o=r>0&&r<1,a=isNaN(r)||o,l=e.axis,h=r,c=r;return ig(r)?h=c={center:.5,edges:.5,end:1}[r]||0:!o&&a&&(h=r[0],c=r[1]),function(t,o,u){var d,f,p,m,g,v,y,x,w,_=(u||e).length,b=s[_];if(!b){if(!(w="auto"===e.grid?0:(e.grid||[1,Km])[1])){for(y=-Km;y<(y=u[w++].getBoundingClientRect().left)&&w<_;);w<_&&w--}for(b=s[_]=[],d=a?Math.min(w,_)*h-.5:r%w,f=w===Km?0:a?_*c/w-.5:r/w|0,y=0,x=Km,v=0;v<_;v++)p=v%w-d,m=f-(v/w|0),b[v]=g=l?Math.abs("y"===l?m:p):eg(p*p+m*m),g>y&&(y=g),g<x&&(x=g);"random"===r&&Iv(b),b.max=y-x,b.min=x,b.v=_=(parseFloat(e.amount)||parseFloat(e.each)*(w>_?_-1:l?"y"===l?_/w:w:Math.max(w,_/w))||0)*("edges"===r?-1:1),b.b=_<0?i-_:i,b.u=Ev(e.amount||e.each)||0,n=n&&_<0?sy(n):n}return _=(b[t]-b.min)/b.max||0,Gg(b.b+(n?n(_):_)*b.v)+b.u}},Ov=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var r=Gg(Math.round(parseFloat(n)/t)*t*e);return(r-r%1)/e+(og(n)?0:Ev(n))}},Lv=function(t,e){var n,r,i=fg(t);return!i&&lg(t)&&(n=i=t.radius||Km,t.values?(t=Mv(t.values),(r=!og(t[0]))&&(n*=n)):t=Ov(t.increment)),Sv(e,i?sg(t)?function(e){return r=t(e),Math.abs(r-e)<=n?r:e}:function(e){for(var i,s,o=parseFloat(r?e.x:e),a=parseFloat(r?e.y:0),l=Km,h=0,c=t.length;c--;)(i=r?(i=t[c].x-o)*i+(s=t[c].y-a)*s:Math.abs(t[c]-o))<l&&(l=i,h=c);return h=!n||l<=n?t[h]:e,r||h===e||og(e)?h:h+Ev(e)}:Ov(t))},Dv=function(t,e,n,r){return Sv(fg(t)?!e:!0===n?!!(n=0):!r,(function(){return fg(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*r)/r}))},Fv=function(t,e,n){return Sv(n,(function(n){return t[~~e(n)]}))},Nv=function(t){for(var e,n,r,i,s=0,o="";~(e=t.indexOf("random(",s));)r=t.indexOf(")",e),i="["===t.charAt(e+7),n=t.substr(e+7,r-e-7).match(i?xg:pg),o+=t.substr(s,e-s)+Dv(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),s=r+1;return o+t.substr(s,t.length-s)},Bv=function(t,e,n,r,i){var s=e-t,o=r-n;return Sv(i,(function(e){return n+((e-t)/s*o||0)}))},Wv=function(t,e,n){var r,i,s,o=t.labels,a=Km;for(r in o)(i=o[r]-e)<0==!!n&&i&&a>(i=Math.abs(i))&&(s=r,a=i);return s},Uv=function(t,e,n){var r,i,s,o=t.vars,a=o[e],l=Wm,h=t._ctx;if(a)return r=o[e+"Params"],i=o.callbackScope||t,n&&Rg.length&&Yg(),h&&(Wm=h),s=r?a.apply(i,r):a.call(i),Wm=l,s},jv=function(t){return iv(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Bm),t.progress()<1&&Uv(t,"onInterrupt"),t},Hv=[],zv=function(t){if(t)if(t=!t.name&&t.default||t,cg()||t.headless){var e=t.name,n=sg(t),r=e&&!n&&t.init?function(){this._props=[]}:t,i={init:Cg,render:Ly,add:yy,kill:Fy,modifier:Dy,rawVars:0},s={targetTest:0,get:0,getSetter:Py,aliases:{},register:0};if(ty(),t!==r){if(Lg[e])return;Zg(r,Zg(tv(t,i),s)),Qg(r.prototype,Qg(i,tv(t,s))),Lg[r.prop=e]=r,t.targetTest&&(Ng.push(r),Ig[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Eg(e,r),t.register&&t.register(Qy,r,Wy)}else Hv.push(t)},Gv=255,Vv={aqua:[0,Gv,Gv],lime:[0,Gv,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Gv],navy:[0,0,128],white:[Gv,Gv,Gv],olive:[128,128,0],yellow:[Gv,Gv,0],orange:[Gv,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Gv,0,0],pink:[Gv,192,203],cyan:[0,Gv,Gv],transparent:[Gv,Gv,Gv,0]},Xv=function(t,e,n){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*Gv+.5|0},Yv=function(t,e,n){var r,i,s,o,a,l,h,c,u,d,f=t?og(t)?[t>>16,t>>8&Gv,t&Gv]:0:Vv.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),Vv[t])f=Vv[t];else if("#"===t.charAt(0)){if(t.length<6&&(r=t.charAt(1),i=t.charAt(2),s=t.charAt(3),t="#"+r+r+i+i+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(f=parseInt(t.substr(1,6),16))>>16,f>>8&Gv,f&Gv,parseInt(t.substr(7),16)/255];f=[(t=parseInt(t.substr(1),16))>>16,t>>8&Gv,t&Gv]}else if("hsl"===t.substr(0,3))if(f=d=t.match(pg),e){if(~t.indexOf("="))return f=t.match(mg),n&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,a=+f[1]/100,r=2*(l=+f[2]/100)-(i=l<=.5?l*(a+1):l+a-l*a),f.length>3&&(f[3]*=1),f[0]=Xv(o+1/3,r,i),f[1]=Xv(o,r,i),f[2]=Xv(o-1/3,r,i);else f=t.match(pg)||Vv.transparent;f=f.map(Number)}return e&&!d&&(r=f[0]/Gv,i=f[1]/Gv,s=f[2]/Gv,l=((h=Math.max(r,i,s))+(c=Math.min(r,i,s)))/2,h===c?o=a=0:(u=h-c,a=l>.5?u/(2-h-c):u/(h+c),o=h===r?(i-s)/u+(i<s?6:0):h===i?(s-r)/u+2:(r-i)/u+4,o*=60),f[0]=~~(o+.5),f[1]=~~(100*a+.5),f[2]=~~(100*l+.5)),n&&f.length<4&&(f[3]=1),f},$v=function(t){var e=[],n=[],r=-1;return t.split(Kv).forEach((function(t){var i=t.match(gg)||[];e.push.apply(e,i),n.push(r+=i.length+1)})),e.c=n,e},qv=function(t,e,n){var r,i,s,o,a="",l=(t+a).match(Kv),h=e?"hsla(":"rgba(",c=0;if(!l)return t;if(l=l.map((function(t){return(t=Yv(t,e,1))&&h+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),n&&(s=$v(t),(r=n.c).join(a)!==s.c.join(a)))for(o=(i=t.replace(Kv,"1").split(gg)).length-1;c<o;c++)a+=i[c]+(~r.indexOf(c)?l.shift()||h+"0,0,0,0)":(s.length?s:l.length?l:n).shift());if(!i)for(o=(i=t.split(Kv)).length-1;c<o;c++)a+=i[c]+l[c];return a+i[o]},Kv=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in Vv)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),Zv=/hsl[a]?\(/,Qv=function(t){var e,n=t.join(" ");if(Kv.lastIndex=0,Kv.test(n))return e=Zv.test(n),t[1]=qv(t[1],e),t[0]=qv(t[0],e,$v(t[1])),!0},Jv=function(){var t,e,n,r,i,s,o=Date.now,a=500,l=33,h=o(),c=h,u=1e3/240,d=u,f=[],p=function n(p){var m,g,v,y,x=o()-c,w=!0===p;if((x>a||x<0)&&(h+=x-l),((m=(v=(c+=x)-h)-d)>0||w)&&(y=++r.frame,i=v-1e3*r.time,r.time=v/=1e3,d+=m+(m>=u?4:u-m),g=1),w||(t=e(n)),g)for(s=0;s<f.length;s++)f[s](v,i,y,p)};return r={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(t){return i/(1e3/(t||60))},wake:function(){Gm&&(!Hm&&cg()&&(jm=Hm=window,zm=jm.document||{},_g.gsap=Qy,(jm.gsapVersions||(jm.gsapVersions=[])).push(Qy.version),Tg(bg||jm.GreenSockGlobals||!jm.gsap&&jm||{}),Hv.forEach(zv)),n="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,t&&r.sleep(),e=n||function(t){return setTimeout(t,d-1e3*r.time+1|0)},Ym=1,p(2))},sleep:function(){(n?cancelAnimationFrame:clearTimeout)(t),Ym=0,e=Cg},lagSmoothing:function(t,e){a=t||1/0,l=Math.min(e||33,a)},fps:function(t){u=1e3/(t||240),d=1e3*r.time+u},add:function(t,e,n){var i=e?function(e,n,s,o){t(e,n,s,o),r.remove(i)}:t;return r.remove(t),f[n?"unshift":"push"](i),ty(),i},remove:function(t,e){~(e=f.indexOf(t))&&f.splice(e,1)&&s>=e&&s--},_listeners:f},r}(),ty=function(){return!Ym&&Jv.wake()},ey={},ny=/^[\d.\-M][\d.\-,\s]/,ry=/["']/g,iy=function(t){for(var e,n,r,i={},s=t.substr(1,t.length-3).split(":"),o=s[0],a=1,l=s.length;a<l;a++)n=s[a],e=a!==l-1?n.lastIndexOf(","):n.length,r=n.substr(0,e),i[o]=isNaN(r)?r.replace(ry,"").trim():+r,o=n.substr(e+1).trim();return i},sy=function(t){return function(e){return 1-t(1-e)}},oy=function t(e,n){for(var r,i=e._first;i;)i instanceof py?t(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?t(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},ay=function(t,e){return t&&(sg(t)?t:ey[t]||function(t){var e,n,r,i,s=(t+"").split("("),o=ey[s[0]];return o&&s.length>1&&o.config?o.config.apply(null,~t.indexOf("{")?[iy(s[1])]:(e=t,n=e.indexOf("(")+1,r=e.indexOf(")"),i=e.indexOf("(",n),e.substring(n,~i&&i<r?e.indexOf(")",r+1):r)).split(",").map(qg)):ey._CE&&ny.test(t)?ey._CE("",t):o}(t))||e},ly=function(t,e,n,r){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===r&&(r=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var i,s={easeIn:e,easeOut:n,easeInOut:r};return Hg(t,(function(t){for(var e in ey[t]=_g[t]=s,ey[i=t.toLowerCase()]=n,s)ey[i+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=ey[t+"."+e]=s[e]})),s},hy=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},cy=function t(e,n,r){var i=n>=1?n:1,s=(r||(e?.3:.45))/(n<1?n:1),o=s/Qm*(Math.asin(1/i)||0),a=function(t){return 1===t?1:i*Math.pow(2,-10*t)*rg((t-o)*s)+1},l="out"===e?a:"in"===e?function(t){return 1-a(1-t)}:hy(a);return s=Qm/s,l.config=function(n,r){return t(e,n,r)},l},uy=function t(e,n){void 0===n&&(n=1.70158);var r=function(t){return t?--t*t*((n+1)*t+n)+1:0},i="out"===e?r:"in"===e?function(t){return 1-r(1-t)}:hy(r);return i.config=function(n){return t(e,n)},i};Hg("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var n=e<5?e+1:e;ly(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},(function(t){return 1-Math.pow(1-t,n)}),(function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2}))})),ey.Linear.easeNone=ey.none=ey.Linear.easeIn,ly("Elastic",cy("in"),cy("out"),cy()),function(t,e){var n=1/e,r=2*n,i=2.5*n,s=function(s){return s<n?t*s*s:s<r?t*Math.pow(s-1.5/e,2)+.75:s<i?t*(s-=2.25/e)*s+.9375:t*Math.pow(s-2.625/e,2)+.984375};ly("Bounce",(function(t){return 1-s(1-t)}),s)}(7.5625,2.75),ly("Expo",(function(t){return Math.pow(2,10*(t-1))*t+t*t*t*t*t*t*(1-t)})),ly("Circ",(function(t){return-(eg(1-t*t)-1)})),ly("Sine",(function(t){return 1===t?1:1-ng(t*Jm)})),ly("Back",uy("in"),uy("out"),uy()),ey.SteppedEase=ey.steps=_g.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,r=t+(e?0:1),i=e?1:0;return function(t){return((r*Av(0,.99999999,t)|0)+i)*n}}},qm.ease=ey["quad.out"],Hg("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return Bg+=t+","+t+"Params,"}));var dy=function(t,e){this.id=tg++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:jg,this.set=e?e.getSetter:Py},fy=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,xv(this,+t.duration,1,1),this.data=t.data,Wm&&(this._ctx=Wm,Wm.data.push(this)),Ym||Jv.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,xv(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(ty(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(dv(this,t),!n._dp||n.parent||fv(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&pv(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===Zm||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),$g(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+lv(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+lv(this),e):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?hv(this._tTime,n)+1:1},e.timeScale=function(t,e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var n=this.parent&&this._ts?cv(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(Av(-Math.abs(this._delay),this._tDur,n),!1!==e),uv(this),function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t}(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ty(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==Zm&&(this._tTime-=Zm)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&pv(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(hg(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?cv(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=Pg);var e=Bm;return Bm=t,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),Bm=e,this},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(Math.abs(e._ts)||1),e=e._dp;return!this.parent&&this._sat?this._sat.globalTime(t):n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,wv(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,wv(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(bv(this,t),hg(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,hg(e)),this._dur||(this._zTime=-1e-8),this},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-Zm))},e.eventCallback=function(t,e,n){var r=this.vars;return arguments.length>1?(e?(r[t]=e,n&&(r[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete r[t],this):r[t]},e.then=function(t){var e=this;return new Promise((function(n){var r=sg(t)?t:Kg,i=function(){var t=e.then;e.then=null,sg(r)&&(r=r(e))&&(r.then||r===e)&&(e.then=t),n(r),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?i():e._prom=i}))},e.kill=function(){jv(this)},t}();Zg(fy.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var py=function(t){function e(e,n){var r;return void 0===e&&(e={}),(r=t.call(this,e)||this).labels={},r.smoothChildTiming=!!e.smoothChildTiming,r.autoRemoveChildren=!!e.autoRemoveChildren,r._sort=hg(e.sortChildren),Um&&pv(e.parent||Um,Dm(r),n),e.reversed&&r.reverse(),e.paused&&r.paused(!0),e.scrollTrigger&&mv(Dm(r),e.scrollTrigger),r}Fm(e,t);var n=e.prototype;return n.to=function(t,e,n){return Tv(0,arguments,this),this},n.from=function(t,e,n){return Tv(1,arguments,this),this},n.fromTo=function(t,e,n,r){return Tv(2,arguments,this),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,ev(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Ay(t,e,bv(this,n),1),this},n.call=function(t,e,n){return pv(this,Ay.delayedCall(0,t,e),n)},n.staggerTo=function(t,e,n,r,i,s,o){return n.duration=e,n.stagger=n.stagger||r,n.onComplete=s,n.onCompleteParams=o,n.parent=this,new Ay(t,n,bv(this,i)),this},n.staggerFrom=function(t,e,n,r,i,s,o){return n.runBackwards=1,ev(n).immediateRender=hg(n.immediateRender),this.staggerTo(t,e,n,r,i,s,o)},n.staggerFromTo=function(t,e,n,r,i,s,o,a){return r.startAt=n,ev(r).immediateRender=hg(r.immediateRender),this.staggerTo(t,e,r,i,s,o,a)},n.render=function(t,e,n){var r,i,s,o,a,l,h,c,u,d,f,p,m=this._time,g=this._dirty?this.totalDuration():this._tDur,v=this._dur,y=t<=0?0:Gg(t),x=this._zTime<0!=t<0&&(this._initted||!v);if(this!==Um&&y>g&&t>=0&&(y=g),y!==this._tTime||n||x){if(m!==this._time&&v&&(y+=this._time-m,t+=this._time-m),r=y,u=this._start,l=!(c=this._ts),x&&(v||(m=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(f=this._yoyo,a=v+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*a+t,e,n);if(r=Gg(y%a),y===g?(o=this._repeat,r=v):((o=~~(d=Gg(y/a)))&&o===d&&(r=v,o--),r>v&&(r=v)),d=hv(this._tTime,a),!m&&this._tTime&&d!==o&&this._tTime-d*a-this._dur<=0&&(d=o),f&&1&o&&(r=v-r,p=1),o!==d&&!this._lock){var w=f&&1&d,_=w===(f&&1&o);if(o<d&&(w=!w),m=w?0:y%v?v:y,this._lock=1,this.render(m||(p?0:Gg(o*a)),e,!v)._lock=0,this._tTime=y,!e&&this.parent&&Uv(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(v=this._dur,g=this._tDur,_&&(this._lock=2,m=w?v:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;oy(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(h=function(t,e,n){var r;if(n>e)for(r=t._first;r&&r._start<=n;){if("isPause"===r.data&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=n;){if("isPause"===r.data&&r._start<e)return r;r=r._prev}}(this,Gg(m),Gg(r)),h&&(y-=r-(r=h._start))),this._tTime=y,this._time=r,this._act=!c,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,m=0),!m&&r&&!e&&!o&&(Uv(this,"onStart"),this._tTime!==y))return this;if(r>=m&&t>=0)for(i=this._first;i;){if(s=i._next,(i._act||r>=i._start)&&i._ts&&h!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(r-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(r-i._start)*i._ts,e,n),r!==this._time||!this._ts&&!l){h=0,s&&(y+=this._zTime=-1e-8);break}}i=s}else{i=this._last;for(var b=t<0?t:r;i;){if(s=i._prev,(i._act||b<=i._end)&&i._ts&&h!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(b-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(b-i._start)*i._ts,e,n||Bm&&(i._initted||i._startAt)),r!==this._time||!this._ts&&!l){h=0,s&&(y+=this._zTime=b?-1e-8:Zm);break}}i=s}}if(h&&!e&&(this.pause(),h.render(r>=m?0:-1e-8)._zTime=r>=m?1:-1,this._ts))return this._start=u,uv(this),this.render(t,e,n);this._onUpdate&&!e&&Uv(this,"onUpdate",!0),(y===g&&this._tTime>=this.totalDuration()||!y&&m)&&(u!==this._start&&Math.abs(c)===Math.abs(this._ts)||this._lock||((t||!v)&&(y===g&&this._ts>0||!y&&this._ts<0)&&iv(this,1),e||t<0&&!m||!y&&!m&&g||(Uv(this,y===g&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(og(e)||(e=bv(this,e,t)),!(t instanceof fy)){if(fg(t))return t.forEach((function(t){return n.add(t,e)})),this;if(ig(t))return this.addLabel(t,e);if(!sg(t))return this;t=Ay.delayedCall(0,t)}return this!==t?pv(this,t,e):this},n.getChildren=function(t,e,n,r){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===r&&(r=-Km);for(var i=[],s=this._first;s;)s._start>=r&&(s instanceof Ay?e&&i.push(s):(n&&i.push(s),t&&i.push.apply(i,s.getChildren(!0,e,n)))),s=s._next;return i},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return ig(t)?this.removeLabel(t):sg(t)?this.killTweensOf(t):(t.parent===this&&rv(this,t),t===this._recent&&(this._recent=this._last),sv(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Gg(Jv.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=bv(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var r=Ay.delayedCall(0,e||Cg,n);return r.data="isPause",this._hasPause=1,pv(this,r,bv(this,t))},n.removePause=function(t){var e=this._first;for(t=bv(this,t);e;)e._start===t&&"isPause"===e.data&&iv(e),e=e._next},n.killTweensOf=function(t,e,n){for(var r=this.getTweensOf(t,n),i=r.length;i--;)my!==r[i]&&r[i].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,r=[],i=Mv(t),s=this._first,o=og(e);s;)s instanceof Ay?Xg(s._targets,i)&&(o?(!my||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&r.push(s):(n=s.getTweensOf(i,e)).length&&r.push.apply(r,n),s=s._next;return r},n.tweenTo=function(t,e){e=e||{};var n,r=this,i=bv(r,t),s=e,o=s.startAt,a=s.onStart,l=s.onStartParams,h=s.immediateRender,c=Ay.to(r,Zg({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:e.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale())||Zm,onStart:function(){if(r.pause(),!n){var t=e.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale());c._dur!==t&&xv(c,t,0,1).render(c._time,!0,!0),n=1}a&&a.apply(c,l||[])}},e));return h?c.render(0):c},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,Zg({startAt:{time:bv(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),Wv(this,bv(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),Wv(this,bv(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+Zm)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var r,i=this._first,s=this.labels;i;)i._start>=n&&(i._start+=t,i._end+=t),i=i._next;if(e)for(r in s)s[r]>=n&&(s[r]+=t);return sv(this)},n.invalidate=function(e){var n=this._first;for(this._lock=0;n;)n.invalidate(e),n=n._next;return t.prototype.invalidate.call(this,e)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),sv(this)},n.totalDuration=function(t){var e,n,r,i=0,s=this,o=s._last,a=Km;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(r=s.parent;o;)e=o._prev,o._dirty&&o.totalDuration(),(n=o._start)>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,pv(s,o,n-o._delay,1)._lock=0):a=n,n<0&&o._ts&&(i-=n,(!r&&!s._dp||r&&r.smoothChildTiming)&&(s._start+=n/s._ts,s._time-=n,s._tTime-=n),s.shiftChildren(-n,!1,-1/0),a=0),o._end>i&&o._ts&&(i=o._end),o=e;xv(s,s===Um&&s._time>i?s._time:i,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(t){if(Um._ts&&($g(Um,cv(t,Um)),Vm=Jv.frame),Jv.frame>=Fg){Fg+=$m.autoSleep||120;var e=Um._first;if((!e||!e._ts)&&$m.autoSleep&&Jv._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||Jv.sleep()}}},e}(fy);Zg(py.prototype,{_lock:0,_hasPause:0,_forcing:0});var my,gy,vy=function(t,e,n,r,i,s,o){var a,l,h,c,u,d,f,p,m=new Wy(this._pt,t,e,0,1,Oy,null,i),g=0,v=0;for(m.b=n,m.e=r,n+="",(f=~(r+="").indexOf("random("))&&(r=Nv(r)),s&&(s(p=[n,r],t,e),n=p[0],r=p[1]),l=n.match(vg)||[];a=vg.exec(r);)c=a[0],u=r.substring(g,a.index),h?h=(h+1)%5:"rgba("===u.substr(-5)&&(h=1),c!==l[v++]&&(d=parseFloat(l[v-1])||0,m._pt={_next:m._pt,p:u||1===v?u:",",s:d,c:"="===c.charAt(1)?Vg(d,c)-d:parseFloat(c)-d,m:h&&h<4?Math.round:0},g=vg.lastIndex);return m.c=g<r.length?r.substring(g,r.length):"",m.fp=o,(yg.test(r)||f)&&(m.e=0),this._pt=m,m},yy=function(t,e,n,r,i,s,o,a,l,h){sg(r)&&(r=r(i||0,t,s));var c,u=t[e],d="get"!==n?n:sg(u)?l?t[e.indexOf("set")||!sg(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():u,f=sg(u)?l?ky:Cy:Ey;if(ig(r)&&(~r.indexOf("random(")&&(r=Nv(r)),"="===r.charAt(1)&&((c=Vg(d,r)+(Ev(d)||0))||0===c)&&(r=c)),!h||d!==r||gy)return isNaN(d*r)||""===r?(!u&&!(e in t)&&Sg(e,r),vy.call(this,t,e,d,r,f,a||$m.stringFilter,l)):(c=new Wy(this._pt,t,e,+d||0,r-(d||0),"boolean"==typeof u?Ry:Iy,0,f),l&&(c.fp=l),o&&c.modifier(o,this,t),this._pt=c)},xy=function(t,e,n,r,i,s){var o,a,l,h;if(Lg[t]&&!1!==(o=new Lg[t]).init(i,o.rawVars?e[t]:function(t,e,n,r,i){if(sg(t)&&(t=by(t,i,e,n,r)),!lg(t)||t.style&&t.nodeType||fg(t)||dg(t))return ig(t)?by(t,i,e,n,r):t;var s,o={};for(s in t)o[s]=by(t[s],i,e,n,r);return o}(e[t],r,i,s,n),n,r,s)&&(n._pt=a=new Wy(n._pt,i,t,0,1,o.render,o,0,o.priority),n!==Xm))for(l=n._ptLookup[n._targets.indexOf(i)],h=o._props.length;h--;)l[o._props[h]]=a;return o},wy=function t(e,n,r){var i,s,o,a,l,h,c,u,d,f,p,m,g,v=e.vars,y=v.ease,x=v.startAt,w=v.immediateRender,_=v.lazy,b=v.onUpdate,T=v.runBackwards,S=v.yoyoEase,A=v.keyframes,E=v.autoRevert,C=e._dur,k=e._startAt,M=e._targets,P=e.parent,I=P&&"nested"===P.data?P.vars.targets:M,R="auto"===e._overwrite&&!Nm,O=e.timeline;if(O&&(!A||!y)&&(y="none"),e._ease=ay(y,qm.ease),e._yEase=S?sy(ay(!0===S?y:S,qm.ease)):0,S&&e._yoyo&&!e._repeat&&(S=e._yEase,e._yEase=e._ease,e._ease=S),e._from=!O&&!!v.runBackwards,!O||A&&!v.stagger){if(m=(u=M[0]?Ug(M[0]).harness:0)&&v[u.prop],i=tv(v,Ig),k&&(k._zTime<0&&k.progress(1),n<0&&T&&w&&!E?k.render(-1,!0):k.revert(T&&C?Mg:kg),k._lazy=0),x){if(iv(e._startAt=Ay.set(M,Zg({data:"isStart",overwrite:!1,parent:P,immediateRender:!0,lazy:!k&&hg(_),startAt:null,delay:0,onUpdate:b&&function(){return Uv(e,"onUpdate")},stagger:0},x))),e._startAt._dp=0,e._startAt._sat=e,n<0&&(Bm||!w&&!E)&&e._startAt.revert(Mg),w&&C&&n<=0&&r<=0)return void(n&&(e._zTime=n))}else if(T&&C&&!k)if(n&&(w=!1),o=Zg({overwrite:!1,data:"isFromStart",lazy:w&&!k&&hg(_),immediateRender:w,stagger:0,parent:P},i),m&&(o[u.prop]=m),iv(e._startAt=Ay.set(M,o)),e._startAt._dp=0,e._startAt._sat=e,n<0&&(Bm?e._startAt.revert(Mg):e._startAt.render(-1,!0)),e._zTime=n,w){if(!n)return}else t(e._startAt,Zm,Zm);for(e._pt=e._ptCache=0,_=C&&hg(_)||_&&!C,s=0;s<M.length;s++){if(c=(l=M[s])._gsap||Wg(M)[s]._gsap,e._ptLookup[s]=f={},Og[c.id]&&Rg.length&&Yg(),p=I===M?s:I.indexOf(l),u&&!1!==(d=new u).init(l,m||i,e,p,I)&&(e._pt=a=new Wy(e._pt,l,d.name,0,1,d.render,d,0,d.priority),d._props.forEach((function(t){f[t]=a})),d.priority&&(h=1)),!u||m)for(o in i)Lg[o]&&(d=xy(o,i,e,p,l,I))?d.priority&&(h=1):f[o]=a=yy.call(e,l,o,"get",i[o],p,I,0,v.stringFilter);e._op&&e._op[s]&&e.kill(l,e._op[s]),R&&e._pt&&(my=e,Um.killTweensOf(l,f,e.globalTime(n)),g=!e.parent,my=0),e._pt&&_&&(Og[c.id]=1)}h&&By(e),e._onInit&&e._onInit(e)}e._onUpdate=b,e._initted=(!e._op||e._pt)&&!g,A&&n<=0&&O.render(Km,!0,!0)},_y=function(t,e,n,r){var i,s,o=e.ease||r||"power1.inOut";if(fg(e))s=n[t]||(n[t]=[]),e.forEach((function(t,n){return s.push({t:n/(e.length-1)*100,v:t,e:o})}));else for(i in e)s=n[i]||(n[i]=[]),"ease"===i||s.push({t:parseFloat(t),v:e[i],e:o})},by=function(t,e,n,r,i){return sg(t)?t.call(e,n,r,i):ig(t)&&~t.indexOf("random(")?Nv(t):t},Ty=Bg+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Sy={};Hg(Ty+",id,stagger,delay,duration,paused,scrollTrigger",(function(t){return Sy[t]=1}));var Ay=function(t){function e(e,n,r,i){var s;"number"==typeof n&&(r.duration=n,n=r,r=null);var o,a,l,h,c,u,d,f,p=(s=t.call(this,i?n:ev(n))||this).vars,m=p.duration,g=p.delay,v=p.immediateRender,y=p.stagger,x=p.overwrite,w=p.keyframes,_=p.defaults,b=p.scrollTrigger,T=p.yoyoEase,S=n.parent||Um,A=(fg(e)||dg(e)?og(e[0]):"length"in n)?[e]:Mv(e);if(s._targets=A.length?Wg(A):Ag("GSAP target "+e+" not found. https://gsap.com",!$m.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=x,w||y||ug(m)||ug(g)){if(n=s.vars,(o=s.timeline=new py({data:"nested",defaults:_||{},targets:S&&"nested"===S.data?S.vars.targets:A})).kill(),o.parent=o._dp=Dm(s),o._start=0,y||ug(m)||ug(g)){if(h=A.length,d=y&&Rv(y),lg(y))for(c in y)~Ty.indexOf(c)&&(f||(f={}),f[c]=y[c]);for(a=0;a<h;a++)(l=tv(n,Sy)).stagger=0,T&&(l.yoyoEase=T),f&&Qg(l,f),u=A[a],l.duration=+by(m,Dm(s),a,u,A),l.delay=(+by(g,Dm(s),a,u,A)||0)-s._delay,!y&&1===h&&l.delay&&(s._delay=g=l.delay,s._start+=g,l.delay=0),o.to(u,l,d?d(a,u,A):0),o._ease=ey.none;o.duration()?m=g=0:s.timeline=0}else if(w){ev(Zg(o.vars.defaults,{ease:"none"})),o._ease=ay(w.ease||n.ease||"none");var E,C,k,M=0;if(fg(w))w.forEach((function(t){return o.to(A,t,">")})),o.duration();else{for(c in l={},w)"ease"===c||"easeEach"===c||_y(c,w[c],l,w.easeEach);for(c in l)for(E=l[c].sort((function(t,e){return t.t-e.t})),M=0,a=0;a<E.length;a++)(k={ease:(C=E[a]).e,duration:(C.t-(a?E[a-1].t:0))/100*m})[c]=C.v,o.to(A,k,M),M+=k.duration;o.duration()<m&&o.to({},{duration:m-o.duration()})}}m||s.duration(m=o.duration())}else s.timeline=0;return!0!==x||Nm||(my=Dm(s),Um.killTweensOf(A),my=0),pv(S,Dm(s),r),n.reversed&&s.reverse(),n.paused&&s.paused(!0),(v||!m&&!w&&s._start===Gg(S._time)&&hg(v)&&av(Dm(s))&&"nested"!==S.data)&&(s._tTime=-1e-8,s.render(Math.max(0,-g)||0)),b&&mv(Dm(s),b),s}Fm(e,t);var n=e.prototype;return n.render=function(t,e,n){var r,i,s,o,a,l,h,c,u,d=this._time,f=this._tDur,p=this._dur,m=t<0,g=t>f-Zm&&!m?f:t<Zm?0:t;if(p){if(g!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m||this._lazy){if(r=g,c=this.timeline,this._repeat){if(o=p+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*o+t,e,n);if(r=Gg(g%o),g===f?(s=this._repeat,r=p):(s=~~(a=Gg(g/o)))&&s===a?(r=p,s--):r>p&&(r=p),(l=this._yoyo&&1&s)&&(u=this._yEase,r=p-r),a=hv(this._tTime,o),r===d&&!n&&this._initted&&s===a)return this._tTime=g,this;s!==a&&(c&&this._yEase&&oy(c,l),this.vars.repeatRefresh&&!l&&!this._lock&&r!==o&&this._initted&&(this._lock=n=1,this.render(Gg(o*s),!0).invalidate()._lock=0))}if(!this._initted){if(gv(this,m?t:r,n,e,g))return this._tTime=0,this;if(!(d===this._time||n&&this.vars.repeatRefresh&&s!==a))return this;if(p!==this._dur)return this.render(t,e,n)}if(this._tTime=g,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=h=(u||this._ease)(r/p),this._from&&(this.ratio=h=1-h),r&&!d&&!e&&!s&&(Uv(this,"onStart"),this._tTime!==g))return this;for(i=this._pt;i;)i.r(h,i.d),i=i._next;c&&c.render(t<0?t:c._dur*c._ease(r/this._dur),e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(m&&ov(this,t,0,n),Uv(this,"onUpdate")),this._repeat&&s!==a&&this.vars.onRepeat&&!e&&this.parent&&Uv(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(m&&!this._onUpdate&&ov(this,t,0,!0),(t||!p)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&iv(this,1),e||m&&!d||!(g||d||l)||(Uv(this,g===f?"onComplete":"onReverseComplete",!0),this._prom&&!(g<f&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,r){var i,s,o,a=t.ratio,l=e<0||!e&&(!t._start&&vv(t)&&(t._initted||!yv(t))||(t._ts<0||t._dp._ts<0)&&!yv(t))?0:1,h=t._rDelay,c=0;if(h&&t._repeat&&(c=Av(0,t._tDur,e),s=hv(c,h),t._yoyo&&1&s&&(l=1-l),s!==hv(t._tTime,h)&&(a=1-l,t.vars.repeatRefresh&&t._initted&&t.invalidate())),l!==a||Bm||r||t._zTime===Zm||!e&&t._zTime){if(!t._initted&&gv(t,e,r,n,c))return;for(o=t._zTime,t._zTime=e||(n?Zm:0),n||(n=e&&!o),t.ratio=l,t._from&&(l=1-l),t._time=0,t._tTime=c,i=t._pt;i;)i.r(l,i.d),i=i._next;e<0&&ov(t,e,0,!0),t._onUpdate&&!n&&Uv(t,"onUpdate"),c&&t._repeat&&!n&&t.parent&&Uv(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===l&&(l&&iv(t,1),n||Bm||(Uv(t,l?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},n.resetTo=function(t,e,n,r,i){Ym||Jv.wake(),this._ts||this.play();var s=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||wy(this,s),function(t,e,n,r,i,s,o,a){var l,h,c,u,d=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!d)for(d=t._ptCache[e]=[],c=t._ptLookup,u=t._targets.length;u--;){if((l=c[u][e])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return gy=1,t.vars[e]="+=0",wy(t,o),gy=0,a?Ag(e+" not eligible for reset"):1;d.push(l)}for(u=d.length;u--;)(l=(h=d[u])._pt||h).s=!r&&0!==r||i?l.s+(r||0)+s*l.c:r,l.c=n-l.s,h.e&&(h.e=zg(n)+Ev(h.e)),h.b&&(h.b=l.s+Ev(h.b))}(this,t,e,n,r,this._ease(s/this._dur),s,i)?this.resetTo(t,e,n,r,1):(dv(this,0),this.parent||nv(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?jv(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Bm),this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,my&&!0!==my.vars.overwrite)._first||jv(this),this.parent&&n!==this.timeline.totalDuration()&&xv(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,s,o,a,l,h,c=this._targets,u=t?Mv(t):c,d=this._ptLookup,f=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,r=n===e.length;r&&n--&&t[n]===e[n];);return n<0}(c,u))return"all"===e&&(this._pt=0),jv(this);for(r=this._op=this._op||[],"all"!==e&&(ig(e)&&(a={},Hg(e,(function(t){return a[t]=1})),e=a),e=function(t,e){var n,r,i,s,o=t[0]?Ug(t[0]).harness:0,a=o&&o.aliases;if(!a)return e;for(r in n=Qg({},e),a)if(r in n)for(i=(s=a[r].split(",")).length;i--;)n[s[i]]=n[r];return n}(c,e)),h=c.length;h--;)if(~u.indexOf(c[h]))for(a in i=d[h],"all"===e?(r[h]=e,o=i,s={}):(s=r[h]=r[h]||{},o=e),o)(l=i&&i[a])&&("kill"in l.d&&!0!==l.d.kill(a)||rv(this,l,"_pt"),delete i[a]),"all"!==s&&(s[a]=1);return this._initted&&!this._pt&&f&&jv(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,e){return Tv(1,arguments)},e.delayedCall=function(t,n,r,i){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},e.fromTo=function(t,e,n){return Tv(2,arguments)},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return Um.killTweensOf(t,e,n)},e}(fy);Zg(Ay.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Hg("staggerTo,staggerFrom,staggerFromTo",(function(t){Ay[t]=function(){var e=new py,n=Cv.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}}));var Ey=function(t,e,n){return t[e]=n},Cy=function(t,e,n){return t[e](n)},ky=function(t,e,n,r){return t[e](r.fp,n)},My=function(t,e,n){return t.setAttribute(e,n)},Py=function(t,e){return sg(t[e])?Cy:ag(t[e])&&t.setAttribute?My:Ey},Iy=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},Ry=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Oy=function(t,e){var n=e._pt,r="";if(!t&&e.b)r=e.b;else if(1===t&&e.e)r=e.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+r,n=n._next;r+=e.c}e.set(e.t,e.p,r,e)},Ly=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},Dy=function(t,e,n,r){for(var i,s=this._pt;s;)i=s._next,s.p===r&&s.modifier(t,e,n),s=i},Fy=function(t){for(var e,n,r=this._pt;r;)n=r._next,r.p===t&&!r.op||r.op===t?rv(this,r,"_pt"):r.dep||(e=1),r=n;return!e},Ny=function(t,e,n,r){r.mSet(t,e,r.m.call(r.tween,n,r.mt),r)},By=function(t){for(var e,n,r,i,s=t._pt;s;){for(e=s._next,n=r;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:i)?s._prev._next=s:r=s,(s._next=n)?n._prev=s:i=s,s=e}t._pt=r},Wy=function(){function t(t,e,n,r,i,s,o,a,l){this.t=e,this.s=r,this.c=i,this.p=n,this.r=s||Iy,this.d=o||this,this.set=a||Ey,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=Ny,this.m=t,this.mt=n,this.tween=e},t}();Hg(Bg+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return Ig[t]=1})),_g.TweenMax=_g.TweenLite=Ay,_g.TimelineLite=_g.TimelineMax=py,Um=new py({sortChildren:!1,defaults:qm,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),$m.stringFilter=Qv;var Uy=[],jy={},Hy=[],zy=0,Gy=0,Vy=function(t){return(jy[t]||Hy).map((function(t){return t()}))},Xy=function(){var t=Date.now(),e=[];t-zy>2&&(Vy("matchMediaInit"),Uy.forEach((function(t){var n,r,i,s,o=t.queries,a=t.conditions;for(r in o)(n=jm.matchMedia(o[r]).matches)&&(i=1),n!==a[r]&&(a[r]=n,s=1);s&&(t.revert(),i&&e.push(t))})),Vy("matchMediaRevert"),e.forEach((function(t){return t.onMatch(t,(function(e){return t.add(null,e)}))})),zy=t,Vy("matchMedia"))},Yy=function(){function t(t,e){this.selector=e&&Pv(e),this.data=[],this._r=[],this.isReverted=!1,this.id=Gy++,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,n){sg(t)&&(n=e,e=t,t=sg);var r=this,i=function(){var t,i=Wm,s=r.selector;return i&&i!==r&&i.data.push(r),n&&(r.selector=Pv(n)),Wm=r,t=e.apply(r,arguments),sg(t)&&r._r.push(t),Wm=i,r.selector=s,r.isReverted=!1,t};return r.last=i,t===sg?i(r,(function(t){return r.add(null,t)})):t?r[t]=i:i},e.ignore=function(t){var e=Wm;Wm=null,t(this),Wm=e},e.getTweens=function(){var e=[];return this.data.forEach((function(n){return n instanceof t?e.push.apply(e,n.getTweens()):n instanceof Ay&&!(n.parent&&"nested"===n.parent.data)&&e.push(n)})),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var n=this;if(t?function(){for(var e,r=n.getTweens(),i=n.data.length;i--;)"isFlip"===(e=n.data[i]).data&&(e.revert(),e.getChildren(!0,!0,!1).forEach((function(t){return r.splice(r.indexOf(t),1)})));for(r.map((function(t){return{g:t._dur||t._delay||t._sat&&!t._sat.vars.immediateRender?t.globalTime(0):-1/0,t:t}})).sort((function(t,e){return e.g-t.g||-1/0})).forEach((function(e){return e.t.revert(t)})),i=n.data.length;i--;)(e=n.data[i])instanceof py?"nested"!==e.data&&(e.scrollTrigger&&e.scrollTrigger.revert(),e.kill()):!(e instanceof Ay)&&e.revert&&e.revert(t);n._r.forEach((function(e){return e(t,n)})),n.isReverted=!0}():this.data.forEach((function(t){return t.kill&&t.kill()})),this.clear(),e)for(var r=Uy.length;r--;)Uy[r].id===this.id&&Uy.splice(r,1)},e.revert=function(t){this.kill(t||{})},t}(),$y=function(){function t(t){this.contexts=[],this.scope=t,Wm&&Wm.data.push(this)}var e=t.prototype;return e.add=function(t,e,n){lg(t)||(t={matches:t});var r,i,s,o=new Yy(0,n||this.scope),a=o.conditions={};for(i in Wm&&!o.selector&&(o.selector=Wm.selector),this.contexts.push(o),e=o.add("onMatch",e),o.queries=t,t)"all"===i?s=1:(r=jm.matchMedia(t[i]))&&(Uy.indexOf(o)<0&&Uy.push(o),(a[i]=r.matches)&&(s=1),r.addListener?r.addListener(Xy):r.addEventListener("change",Xy));return s&&e(o,(function(t){return o.add(null,t)})),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach((function(e){return e.kill(t,!0)}))},t}(),qy={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((function(t){return zv(t)}))},timeline:function(t){return new py(t)},getTweensOf:function(t,e){return Um.getTweensOf(t,e)},getProperty:function(t,e,n,r){ig(t)&&(t=Mv(t)[0]);var i=Ug(t||{}).get,s=n?Kg:qg;return"native"===n&&(n=""),t?e?s((Lg[e]&&Lg[e].get||i)(t,e,n,r)):function(e,n,r){return s((Lg[e]&&Lg[e].get||i)(t,e,n,r))}:t},quickSetter:function(t,e,n){if((t=Mv(t)).length>1){var r=t.map((function(t){return Qy.quickSetter(t,e,n)})),i=r.length;return function(t){for(var e=i;e--;)r[e](t)}}t=t[0]||{};var s=Lg[e],o=Ug(t),a=o.harness&&(o.harness.aliases||{})[e]||e,l=s?function(e){var r=new s;Xm._pt=0,r.init(t,n?e+n:e,Xm,0,[t]),r.render(1,r),Xm._pt&&Ly(1,Xm)}:o.set(t,a);return s?l:function(e){return l(t,a,n?e+n:e,o,1)}},quickTo:function(t,e,n){var r,i=Qy.to(t,Zg(((r={})[e]="+=0.1",r.paused=!0,r.stagger=0,r),n||{})),s=function(t,n,r){return i.resetTo(e,t,n,r)};return s.tween=i,s},isTweening:function(t){return Um.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=ay(t.ease,qm.ease)),Jg(qm,t||{})},config:function(t){return Jg($m,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,r=t.plugins,i=t.defaults,s=t.extendTimeline;(r||"").split(",").forEach((function(t){return t&&!Lg[t]&&!_g[t]&&Ag(e+" effect requires "+t+" plugin.")})),Dg[e]=function(t,e,r){return n(Mv(t),Zg(e||{},i),r)},s&&(py.prototype[e]=function(t,n,r){return this.add(Dg[e](t,lg(n)?n:(r=n)&&{},this),r)})},registerEase:function(t,e){ey[t]=ay(e)},parseEase:function(t,e){return arguments.length?ay(t,e):ey},getById:function(t){return Um.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,r,i=new py(t);for(i.smoothChildTiming=hg(t.smoothChildTiming),Um.remove(i),i._dp=0,i._time=i._tTime=Um._time,n=Um._first;n;)r=n._next,!e&&!n._dur&&n instanceof Ay&&n.vars.onComplete===n._targets[0]||pv(i,n,n._start-n._delay),n=r;return pv(Um,i,0),i},context:function(t,e){return t?new Yy(t,e):Wm},matchMedia:function(t){return new $y(t)},matchMediaRefresh:function(){return Uy.forEach((function(t){var e,n,r=t.conditions;for(n in r)r[n]&&(r[n]=!1,e=1);e&&t.revert()}))||Xy()},addEventListener:function(t,e){var n=jy[t]||(jy[t]=[]);~n.indexOf(e)||n.push(e)},removeEventListener:function(t,e){var n=jy[t],r=n&&n.indexOf(e);r>=0&&n.splice(r,1)},utils:{wrap:function t(e,n,r){var i=n-e;return fg(e)?Fv(e,t(0,e.length),n):Sv(r,(function(t){return(i+(t-e)%i)%i+e}))},wrapYoyo:function t(e,n,r){var i=n-e,s=2*i;return fg(e)?Fv(e,t(0,e.length-1),n):Sv(r,(function(t){return e+((t=(s+(t-e)%s)%s||0)>i?s-t:t)}))},distribute:Rv,random:Dv,snap:Lv,normalize:function(t,e,n){return Bv(t,e,0,1,n)},getUnit:Ev,clamp:function(t,e,n){return Sv(n,(function(n){return Av(t,e,n)}))},splitColor:Yv,toArray:Mv,selector:Pv,mapRange:Bv,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||Ev(n))}},interpolate:function t(e,n,r,i){var s=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!s){var o,a,l,h,c,u=ig(e),d={};if(!0===r&&(i=1)&&(r=null),u)e={p:e},n={p:n};else if(fg(e)&&!fg(n)){for(l=[],h=e.length,c=h-2,a=1;a<h;a++)l.push(t(e[a-1],e[a]));h--,s=function(t){t*=h;var e=Math.min(c,~~t);return l[e](t-e)},r=n}else i||(e=Qg(fg(e)?[]:{},e));if(!l){for(o in n)yy.call(d,e,o,"get",n[o]);s=function(t){return Ly(t,d)||(u?e.p:e)}}}return Sv(r,s)},shuffle:Iv},install:Tg,effects:Dg,ticker:Jv,updateRoot:py.updateRoot,plugins:Lg,globalTimeline:Um,core:{PropTween:Wy,globals:Eg,Tween:Ay,Timeline:py,Animation:fy,getCache:Ug,_removeLinkedListItem:rv,reverting:function(){return Bm},context:function(t){return t&&Wm&&(Wm.data.push(t),t._ctx=Wm),Wm},suppressOverwrites:function(t){return Nm=t}}};Hg("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return qy[t]=Ay[t]})),Jv.add(py.updateRoot),Xm=qy.to({},{duration:0});var Ky=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},Zy=function(t,e){return{name:t,rawVars:1,init:function(t,n,r){r._onInit=function(t){var r,i;if(ig(n)&&(r={},Hg(n,(function(t){return r[t]=1})),n=r),e){for(i in r={},n)r[i]=e(n[i]);n=r}!function(t,e){var n,r,i,s=t._targets;for(n in e)for(r=s.length;r--;)(i=t._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=Ky(i,n)),i&&i.modifier&&i.modifier(e[n],t,s[r],n))}(t,n)}}}},Qy=qy.registerPlugin({name:"attr",init:function(t,e,n,r,i){var s,o,a;for(s in this.tween=n,e)a=t.getAttribute(s)||"",(o=this.add(t,"setAttribute",(a||0)+"",e[s],r,i,0,0,s)).op=s,o.b=a,this._props.push(s)},render:function(t,e){for(var n=e._pt;n;)Bm?n.set(n.t,n.p,n.b,n):n.r(t,n.d),n=n._next}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n],0,0,0,0,0,1)}},Zy("roundProps",Ov),Zy("modifiers"),Zy("snap",Lv))||qy;Ay.version=py.version=Qy.version="3.12.7",Gm=1,cg()&&ty(),ey.Power0,ey.Power1,ey.Power2,ey.Power3,ey.Power4,ey.Linear,ey.Quad,ey.Cubic,ey.Quart,ey.Quint,ey.Strong,ey.Elastic,ey.Back,ey.SteppedEase,ey.Bounce,ey.Sine,ey.Expo,ey.Circ;var Jy,tx,ex,nx,rx,ix,sx,ox,ax={},lx=180/Math.PI,hx=Math.PI/180,cx=Math.atan2,ux=/([A-Z])/g,dx=/(left|right|width|margin|padding|x)/i,fx=/[\s,\(]\S/,px={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},mx=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},gx=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},vx=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},yx=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},xx=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},wx=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},_x=function(t,e,n){return t.style[e]=n},bx=function(t,e,n){return t.style.setProperty(e,n)},Tx=function(t,e,n){return t._gsap[e]=n},Sx=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},Ax=function(t,e,n,r,i){var s=t._gsap;s.scaleX=s.scaleY=n,s.renderTransform(i,s)},Ex=function(t,e,n,r,i){var s=t._gsap;s[e]=n,s.renderTransform(i,s)},Cx="transform",kx=Cx+"Origin",Mx=function t(e,n){var r=this,i=this.target,s=i.style,o=i._gsap;if(e in ax&&s){if(this.tfm=this.tfm||{},"transform"===e)return px.transform.split(",").forEach((function(e){return t.call(r,e,n)}));if(~(e=px[e]||e).indexOf(",")?e.split(",").forEach((function(t){return r.tfm[t]=Yx(i,t)})):this.tfm[e]=o.x?o[e]:Yx(i,e),e===kx&&(this.tfm.zOrigin=o.zOrigin),this.props.indexOf(Cx)>=0)return;o.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(kx,n,"")),e=Cx}(s||n)&&this.props.push(e,n,s[e])},Px=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},Ix=function(){var t,e,n=this.props,r=this.target,i=r.style,s=r._gsap;for(t=0;t<n.length;t+=3)n[t+1]?2===n[t+1]?r[n[t]](n[t+2]):r[n[t]]=n[t+2]:n[t+2]?i[n[t]]=n[t+2]:i.removeProperty("--"===n[t].substr(0,2)?n[t]:n[t].replace(ux,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)s[e]=this.tfm[e];s.svg&&(s.renderTransform(),r.setAttribute("data-svg-origin",this.svgo||"")),(t=sx())&&t.isStart||i[Cx]||(Px(i),s.zOrigin&&i[kx]&&(i[kx]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},Rx=function(t,e){var n={target:t,props:[],revert:Ix,save:Mx};return t._gsap||Qy.core.getCache(t),e&&t.style&&t.nodeType&&e.split(",").forEach((function(t){return n.save(t)})),n},Ox=function(t,e){var n=tx.createElementNS?tx.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):tx.createElement(t);return n&&n.style?n:tx.createElement(t)},Lx=function t(e,n,r){var i=getComputedStyle(e);return i[n]||i.getPropertyValue(n.replace(ux,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&t(e,Fx(n)||n,1)||""},Dx="O,Moz,ms,Ms,Webkit".split(","),Fx=function(t,e,n){var r=(e||rx).style,i=5;if(t in r&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);i--&&!(Dx[i]+t in r););return i<0?null:(3===i?"ms":i>=0?Dx[i]:"")+t},Nx=function(){"undefined"!=typeof window&&window.document&&(Jy=window,tx=Jy.document,ex=tx.documentElement,rx=Ox("div")||{style:{}},Ox("div"),Cx=Fx(Cx),kx=Cx+"Origin",rx.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",ox=!!Fx("perspective"),sx=Qy.core.reverting,nx=1)},Bx=function(t){var e,n=t.ownerSVGElement,r=Ox("svg",n&&n.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=t.cloneNode(!0);i.style.display="block",r.appendChild(i),ex.appendChild(r);try{e=i.getBBox()}catch(t){}return r.removeChild(i),ex.removeChild(r),e},Wx=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},Ux=function(t){var e,n;try{e=t.getBBox()}catch(r){e=Bx(t),n=1}return e&&(e.width||e.height)||n||(e=Bx(t)),!e||e.width||e.x||e.y?e:{x:+Wx(t,["x","cx","x1"])||0,y:+Wx(t,["y","cy","y1"])||0,width:0,height:0}},jx=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!Ux(t))},Hx=function(t,e){if(e){var n,r=t.style;e in ax&&e!==kx&&(e=Cx),r.removeProperty?("ms"!==(n=e.substr(0,2))&&"webkit"!==e.substr(0,6)||(e="-"+e),r.removeProperty("--"===n?e:e.replace(ux,"-$1").toLowerCase())):r.removeAttribute(e)}},zx=function(t,e,n,r,i,s){var o=new Wy(t._pt,e,n,0,1,s?wx:xx);return t._pt=o,o.b=r,o.e=i,t._props.push(n),o},Gx={deg:1,rad:1,turn:1},Vx={grid:1,flex:1},Xx=function t(e,n,r,i){var s,o,a,l,h=parseFloat(r)||0,c=(r+"").trim().substr((h+"").length)||"px",u=rx.style,d=dx.test(n),f="svg"===e.tagName.toLowerCase(),p=(f?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===i,v="%"===i;if(i===c||!h||Gx[i]||Gx[c])return h;if("px"!==c&&!g&&(h=t(e,n,r,"px")),l=e.getCTM&&jx(e),(v||"%"===c)&&(ax[n]||~n.indexOf("adius")))return s=l?e.getBBox()[d?"width":"height"]:e[p],zg(v?h/s*m:h/100*s);if(u[d?"width":"height"]=m+(g?c:i),o="rem"!==i&&~n.indexOf("adius")||"em"===i&&e.appendChild&&!f?e:e.parentNode,l&&(o=(e.ownerSVGElement||{}).parentNode),o&&o!==tx&&o.appendChild||(o=tx.body),(a=o._gsap)&&v&&a.width&&d&&a.time===Jv.time&&!a.uncache)return zg(h/a.width*m);if(!v||"height"!==n&&"width"!==n)(v||"%"===c)&&!Vx[Lx(o,"display")]&&(u.position=Lx(e,"position")),o===e&&(u.position="static"),o.appendChild(rx),s=rx[p],o.removeChild(rx),u.position="absolute";else{var y=e.style[n];e.style[n]=m+i,s=e[p],y?e.style[n]=y:Hx(e,n)}return d&&v&&((a=Ug(o)).time=Jv.time,a.width=o[p]),zg(g?s*h/m:s&&h?m/s*h:0)},Yx=function(t,e,n,r){var i;return nx||Nx(),e in px&&"transform"!==e&&~(e=px[e]).indexOf(",")&&(e=e.split(",")[0]),ax[e]&&"transform"!==e?(i=sw(t,r),i="transformOrigin"!==e?i[e]:i.svg?i.origin:ow(Lx(t,kx))+" "+i.zOrigin+"px"):(!(i=t.style[e])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=Qx[e]&&Qx[e](t,e,n)||Lx(t,e)||jg(t,e)||("opacity"===e?1:0)),n&&!~(i+"").trim().indexOf(" ")?Xx(t,e,i,n)+n:i},$x=function(t,e,n,r){if(!n||"none"===n){var i=Fx(e,t,1),s=i&&Lx(t,i,1);s&&s!==n?(e=i,n=s):"borderColor"===e&&(n=Lx(t,"borderTopColor"))}var o,a,l,h,c,u,d,f,p,m,g,v=new Wy(this._pt,t.style,e,0,1,Oy),y=0,x=0;if(v.b=n,v.e=r,n+="","auto"==(r+="")&&(u=t.style[e],t.style[e]=r,r=Lx(t,e)||r,u?t.style[e]=u:Hx(t,e)),Qv(o=[n,r]),r=o[1],l=(n=o[0]).match(gg)||[],(r.match(gg)||[]).length){for(;a=gg.exec(r);)d=a[0],p=r.substring(y,a.index),c?c=(c+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(c=1),d!==(u=l[x++]||"")&&(h=parseFloat(u)||0,g=u.substr((h+"").length),"="===d.charAt(1)&&(d=Vg(h,d)+g),f=parseFloat(d),m=d.substr((f+"").length),y=gg.lastIndex-m.length,m||(m=m||$m.units[e]||g,y===r.length&&(r+=m,v.e+=m)),g!==m&&(h=Xx(t,e,u,m)||0),v._pt={_next:v._pt,p:p||1===x?p:",",s:h,c:f-h,m:c&&c<4||"zIndex"===e?Math.round:0});v.c=y<r.length?r.substring(y,r.length):""}else v.r="display"===e&&"none"===r?wx:xx;return yg.test(r)&&(v.e=0),this._pt=v,v},qx={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Kx=function(t){var e=t.split(" "),n=e[0],r=e[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==r&&"right"!==r||(t=n,n=r,r=t),e[0]=qx[n]||n,e[1]=qx[r]||r,e.join(" ")},Zx=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,r,i,s=e.t,o=s.style,a=e.u,l=s._gsap;if("all"===a||!0===a)o.cssText="",r=1;else for(i=(a=a.split(",")).length;--i>-1;)n=a[i],ax[n]&&(r=1,n="transformOrigin"===n?kx:Cx),Hx(s,n);r&&(Hx(s,Cx),l&&(l.svg&&s.removeAttribute("transform"),o.scale=o.rotate=o.translate="none",sw(s,1),l.uncache=1,Px(o)))}},Qx={clearProps:function(t,e,n,r,i){if("isFromStart"!==i.data){var s=t._pt=new Wy(t._pt,e,n,0,0,Zx);return s.u=r,s.pr=-10,s.tween=i,t._props.push(n),1}}},Jx=[1,0,0,1,0,0],tw={},ew=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},nw=function(t){var e=Lx(t,Cx);return ew(e)?Jx:e.substr(7).match(mg).map(zg)},rw=function(t,e){var n,r,i,s,o=t._gsap||Ug(t),a=t.style,l=nw(t);return o.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(i=t.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?Jx:l:(l!==Jx||t.offsetParent||t===ex||o.svg||(i=a.display,a.display="block",(n=t.parentNode)&&(t.offsetParent||t.getBoundingClientRect().width)||(s=1,r=t.nextElementSibling,ex.appendChild(t)),l=nw(t),i?a.display=i:Hx(t,"display"),s&&(r?n.insertBefore(t,r):n?n.appendChild(t):ex.removeChild(t))),e&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},iw=function(t,e,n,r,i,s){var o,a,l,h=t._gsap,c=i||rw(t,!0),u=h.xOrigin||0,d=h.yOrigin||0,f=h.xOffset||0,p=h.yOffset||0,m=c[0],g=c[1],v=c[2],y=c[3],x=c[4],w=c[5],_=e.split(" "),b=parseFloat(_[0])||0,T=parseFloat(_[1])||0;n?c!==Jx&&(a=m*y-g*v)&&(l=b*(-g/a)+T*(m/a)-(m*w-g*x)/a,b=b*(y/a)+T*(-v/a)+(v*w-y*x)/a,T=l):(b=(o=Ux(t)).x+(~_[0].indexOf("%")?b/100*o.width:b),T=o.y+(~(_[1]||_[0]).indexOf("%")?T/100*o.height:T)),r||!1!==r&&h.smooth?(x=b-u,w=T-d,h.xOffset=f+(x*m+w*v)-x,h.yOffset=p+(x*g+w*y)-w):h.xOffset=h.yOffset=0,h.xOrigin=b,h.yOrigin=T,h.smooth=!!r,h.origin=e,h.originIsAbsolute=!!n,t.style[kx]="0px 0px",s&&(zx(s,h,"xOrigin",u,b),zx(s,h,"yOrigin",d,T),zx(s,h,"xOffset",f,h.xOffset),zx(s,h,"yOffset",p,h.yOffset)),t.setAttribute("data-svg-origin",b+" "+T)},sw=function(t,e){var n=t._gsap||new dy(t);if("x"in n&&!e&&!n.uncache)return n;var r,i,s,o,a,l,h,c,u,d,f,p,m,g,v,y,x,w,_,b,T,S,A,E,C,k,M,P,I,R,O,L,D=t.style,F=n.scaleX<0,N="px",B="deg",W=getComputedStyle(t),U=Lx(t,kx)||"0";return r=i=s=l=h=c=u=d=f=0,o=a=1,n.svg=!(!t.getCTM||!jx(t)),W.translate&&("none"===W.translate&&"none"===W.scale&&"none"===W.rotate||(D[Cx]=("none"!==W.translate?"translate3d("+(W.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==W.rotate?"rotate("+W.rotate+") ":"")+("none"!==W.scale?"scale("+W.scale.split(" ").join(",")+") ":"")+("none"!==W[Cx]?W[Cx]:"")),D.scale=D.rotate=D.translate="none"),g=rw(t,n.svg),n.svg&&(n.uncache?(C=t.getBBox(),U=n.xOrigin-C.x+"px "+(n.yOrigin-C.y)+"px",E=""):E=!e&&t.getAttribute("data-svg-origin"),iw(t,E||U,!!E||n.originIsAbsolute,!1!==n.smooth,g)),p=n.xOrigin||0,m=n.yOrigin||0,g!==Jx&&(w=g[0],_=g[1],b=g[2],T=g[3],r=S=g[4],i=A=g[5],6===g.length?(o=Math.sqrt(w*w+_*_),a=Math.sqrt(T*T+b*b),l=w||_?cx(_,w)*lx:0,(u=b||T?cx(b,T)*lx+l:0)&&(a*=Math.abs(Math.cos(u*hx))),n.svg&&(r-=p-(p*w+m*b),i-=m-(p*_+m*T))):(L=g[6],R=g[7],M=g[8],P=g[9],I=g[10],O=g[11],r=g[12],i=g[13],s=g[14],h=(v=cx(L,I))*lx,v&&(E=S*(y=Math.cos(-v))+M*(x=Math.sin(-v)),C=A*y+P*x,k=L*y+I*x,M=S*-x+M*y,P=A*-x+P*y,I=L*-x+I*y,O=R*-x+O*y,S=E,A=C,L=k),c=(v=cx(-b,I))*lx,v&&(y=Math.cos(-v),O=T*(x=Math.sin(-v))+O*y,w=E=w*y-M*x,_=C=_*y-P*x,b=k=b*y-I*x),l=(v=cx(_,w))*lx,v&&(E=w*(y=Math.cos(v))+_*(x=Math.sin(v)),C=S*y+A*x,_=_*y-w*x,A=A*y-S*x,w=E,S=C),h&&Math.abs(h)+Math.abs(l)>359.9&&(h=l=0,c=180-c),o=zg(Math.sqrt(w*w+_*_+b*b)),a=zg(Math.sqrt(A*A+L*L)),v=cx(S,A),u=Math.abs(v)>2e-4?v*lx:0,f=O?1/(O<0?-O:O):0),n.svg&&(E=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!ew(Lx(t,Cx)),E&&t.setAttribute("transform",E))),Math.abs(u)>90&&Math.abs(u)<270&&(F?(o*=-1,u+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,u+=u<=0?180:-180)),e=e||n.uncache,n.x=r-((n.xPercent=r&&(!e&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-r)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+N,n.y=i-((n.yPercent=i&&(!e&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-i)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+N,n.z=s+N,n.scaleX=zg(o),n.scaleY=zg(a),n.rotation=zg(l)+B,n.rotationX=zg(h)+B,n.rotationY=zg(c)+B,n.skewX=u+B,n.skewY=d+B,n.transformPerspective=f+N,(n.zOrigin=parseFloat(U.split(" ")[2])||!e&&n.zOrigin||0)&&(D[kx]=ow(U)),n.xOffset=n.yOffset=0,n.force3D=$m.force3D,n.renderTransform=n.svg?fw:ox?dw:lw,n.uncache=0,n},ow=function(t){return(t=t.split(" "))[0]+" "+t[1]},aw=function(t,e,n){var r=Ev(e);return zg(parseFloat(e)+parseFloat(Xx(t,"x",n+"px",r)))+r},lw=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,dw(t,e)},hw="0deg",cw="0px",uw=") ",dw=function(t,e){var n=e||this,r=n.xPercent,i=n.yPercent,s=n.x,o=n.y,a=n.z,l=n.rotation,h=n.rotationY,c=n.rotationX,u=n.skewX,d=n.skewY,f=n.scaleX,p=n.scaleY,m=n.transformPerspective,g=n.force3D,v=n.target,y=n.zOrigin,x="",w="auto"===g&&t&&1!==t||!0===g;if(y&&(c!==hw||h!==hw)){var _,b=parseFloat(h)*hx,T=Math.sin(b),S=Math.cos(b);b=parseFloat(c)*hx,_=Math.cos(b),s=aw(v,s,T*_*-y),o=aw(v,o,-Math.sin(b)*-y),a=aw(v,a,S*_*-y+y)}m!==cw&&(x+="perspective("+m+uw),(r||i)&&(x+="translate("+r+"%, "+i+"%) "),(w||s!==cw||o!==cw||a!==cw)&&(x+=a!==cw||w?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+uw),l!==hw&&(x+="rotate("+l+uw),h!==hw&&(x+="rotateY("+h+uw),c!==hw&&(x+="rotateX("+c+uw),u===hw&&d===hw||(x+="skew("+u+", "+d+uw),1===f&&1===p||(x+="scale("+f+", "+p+uw),v.style[Cx]=x||"translate(0, 0)"},fw=function(t,e){var n,r,i,s,o,a=e||this,l=a.xPercent,h=a.yPercent,c=a.x,u=a.y,d=a.rotation,f=a.skewX,p=a.skewY,m=a.scaleX,g=a.scaleY,v=a.target,y=a.xOrigin,x=a.yOrigin,w=a.xOffset,_=a.yOffset,b=a.forceCSS,T=parseFloat(c),S=parseFloat(u);d=parseFloat(d),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),d+=p),d||f?(d*=hx,f*=hx,n=Math.cos(d)*m,r=Math.sin(d)*m,i=Math.sin(d-f)*-g,s=Math.cos(d-f)*g,f&&(p*=hx,o=Math.tan(f-p),i*=o=Math.sqrt(1+o*o),s*=o,p&&(o=Math.tan(p),n*=o=Math.sqrt(1+o*o),r*=o)),n=zg(n),r=zg(r),i=zg(i),s=zg(s)):(n=m,s=g,r=i=0),(T&&!~(c+"").indexOf("px")||S&&!~(u+"").indexOf("px"))&&(T=Xx(v,"x",c,"px"),S=Xx(v,"y",u,"px")),(y||x||w||_)&&(T=zg(T+y-(y*n+x*i)+w),S=zg(S+x-(y*r+x*s)+_)),(l||h)&&(o=v.getBBox(),T=zg(T+l/100*o.width),S=zg(S+h/100*o.height)),o="matrix("+n+","+r+","+i+","+s+","+T+","+S+")",v.setAttribute("transform",o),b&&(v.style[Cx]=o)},pw=function(t,e,n,r,i){var s,o,a=360,l=ig(i),h=parseFloat(i)*(l&&~i.indexOf("rad")?lx:1)-r,c=r+h+"deg";return l&&("short"===(s=i.split("_")[1])&&(h%=a)!=h%180&&(h+=h<0?a:-360),"cw"===s&&h<0?h=(h+36e9)%a-~~(h/a)*a:"ccw"===s&&h>0&&(h=(h-36e9)%a-~~(h/a)*a)),t._pt=o=new Wy(t._pt,e,n,r,h,gx),o.e=c,o.u="deg",t._props.push(n),o},mw=function(t,e){for(var n in e)t[n]=e[n];return t},gw=function(t,e,n){var r,i,s,o,a,l,h,c=mw({},n._gsap),u=n.style;for(i in c.svg?(s=n.getAttribute("transform"),n.setAttribute("transform",""),u[Cx]=e,r=sw(n,1),Hx(n,Cx),n.setAttribute("transform",s)):(s=getComputedStyle(n)[Cx],u[Cx]=e,r=sw(n,1),u[Cx]=s),ax)(s=c[i])!==(o=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(a=Ev(s)!==(h=Ev(o))?Xx(n,i,s,h):parseFloat(s),l=parseFloat(o),t._pt=new Wy(t._pt,r,i,a,l-a,mx),t._pt.u=h||0,t._props.push(i));mw(r,c)};Hg("padding,margin,Width,Radius",(function(t,e){var n="Top",r="Right",i="Bottom",s="Left",o=(e<3?[n,r,i,s]:[n+s,n+r,i+r,i+s]).map((function(n){return e<2?t+n:"border"+n+t}));Qx[e>1?"border"+t:t]=function(t,e,n,r,i){var s,a;if(arguments.length<4)return s=o.map((function(e){return Yx(t,e,n)})),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(r+"").split(" "),a={},o.forEach((function(t,e){return a[t]=s[e]=s[e]||s[(e-1)/2|0]})),t.init(e,a,i)}}));var vw,yw,xw={name:"css",register:Nx,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,r,i){var s,o,a,l,h,c,u,d,f,p,m,g,v,y,x,w,_=this._props,b=t.style,T=n.vars.startAt;for(u in nx||Nx(),this.styles=this.styles||Rx(t),w=this.styles.props,this.tween=n,e)if("autoRound"!==u&&(o=e[u],!Lg[u]||!xy(u,e,n,r,t,i)))if(h=typeof o,c=Qx[u],"function"===h&&(h=typeof(o=o.call(n,r,t,i))),"string"===h&&~o.indexOf("random(")&&(o=Nv(o)),c)c(this,t,u,o,n)&&(x=1);else if("--"===u.substr(0,2))s=(getComputedStyle(t).getPropertyValue(u)+"").trim(),o+="",Kv.lastIndex=0,Kv.test(s)||(d=Ev(s),f=Ev(o)),f?d!==f&&(s=Xx(t,u,s,f)+f):d&&(o+=d),this.add(b,"setProperty",s,o,r,i,0,0,u),_.push(u),w.push(u,0,b[u]);else if("undefined"!==h){if(T&&u in T?(s="function"==typeof T[u]?T[u].call(n,r,t,i):T[u],ig(s)&&~s.indexOf("random(")&&(s=Nv(s)),Ev(s+"")||"auto"===s||(s+=$m.units[u]||Ev(Yx(t,u))||""),"="===(s+"").charAt(1)&&(s=Yx(t,u))):s=Yx(t,u),l=parseFloat(s),(p="string"===h&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),a=parseFloat(o),u in px&&("autoAlpha"===u&&(1===l&&"hidden"===Yx(t,"visibility")&&a&&(l=0),w.push("visibility",0,b.visibility),zx(this,b,"visibility",l?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==u&&"transform"!==u&&~(u=px[u]).indexOf(",")&&(u=u.split(",")[0])),m=u in ax)if(this.styles.save(u),g||((v=t._gsap).renderTransform&&!e.parseTransform||sw(t,e.parseTransform),y=!1!==e.smoothOrigin&&v.smooth,(g=this._pt=new Wy(this._pt,b,Cx,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===u)this._pt=new Wy(this._pt,v,"scaleY",v.scaleY,(p?Vg(v.scaleY,p+a):a)-v.scaleY||0,mx),this._pt.u=0,_.push("scaleY",u),u+="X";else{if("transformOrigin"===u){w.push(kx,0,b[kx]),o=Kx(o),v.svg?iw(t,o,0,y,0,this):((f=parseFloat(o.split(" ")[2])||0)!==v.zOrigin&&zx(this,v,"zOrigin",v.zOrigin,f),zx(this,b,u,ow(s),ow(o)));continue}if("svgOrigin"===u){iw(t,o,1,y,0,this);continue}if(u in tw){pw(this,v,u,l,p?Vg(l,p+o):o);continue}if("smoothOrigin"===u){zx(this,v,"smooth",v.smooth,o);continue}if("force3D"===u){v[u]=o;continue}if("transform"===u){gw(this,o,t);continue}}else u in b||(u=Fx(u)||u);if(m||(a||0===a)&&(l||0===l)&&!fx.test(o)&&u in b)a||(a=0),(d=(s+"").substr((l+"").length))!==(f=Ev(o)||(u in $m.units?$m.units[u]:d))&&(l=Xx(t,u,s,f)),this._pt=new Wy(this._pt,m?v:b,u,l,(p?Vg(l,p+a):a)-l,m||"px"!==f&&"zIndex"!==u||!1===e.autoRound?mx:yx),this._pt.u=f||0,d!==f&&"%"!==f&&(this._pt.b=s,this._pt.r=vx);else if(u in b)$x.call(this,t,u,s,p?p+o:o);else if(u in t)this.add(t,u,s||t[u],p?p+o:o,r,i);else if("parseTransform"!==u){Sg(u,o);continue}m||(u in b?w.push(u,0,b[u]):"function"==typeof t[u]?w.push(u,2,t[u]()):w.push(u,1,s||t[u])),_.push(u)}x&&By(this)},render:function(t,e){if(e.tween._time||!sx())for(var n=e._pt;n;)n.r(t,n.d),n=n._next;else e.styles.revert()},get:Yx,aliases:px,getSetter:function(t,e,n){var r=px[e];return r&&r.indexOf(",")<0&&(e=r),e in ax&&e!==kx&&(t._gsap.x||Yx(t,"x"))?n&&ix===n?"scale"===e?Sx:Tx:(ix=n||{})&&("scale"===e?Ax:Ex):t.style&&!ag(t.style[e])?_x:~e.indexOf("-")?bx:Py(t,e)},core:{_removeProperty:Hx,_getMatrix:rw}};Qy.utils.checkPrefix=Fx,Qy.core.getStyleSaver=Rx,yw=Hg("x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+(vw="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){ax[t]=1})),Hg(vw,(function(t){$m.units[t]="deg",tw[t]=1})),px[yw[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+vw,Hg("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");px[e[1]]=yw[e[0]]})),Hg("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){$m.units[t]="px"})),Qy.registerPlugin(xw);var ww=Qy.registerPlugin(xw)||Qy,_w=(ww.core.Tween,r(3771),_((function t(){v(this,t)}),null,[{key:"getRandomID",value:function(){return(+new Date).toString(16)+(1e8*Math.random()|0).toString(16)}},{key:"calculateDistance",value:function(t,e,n,r){return Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2))}},{key:"getRandomNumber",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return+(Math.random()*(e-t)+t).toFixed(n)}},{key:"clamp",value:function(t,e,n){return Math.max(e,Math.min(n,t))}},{key:"testForAABB",value:function(t,e){var n=t.getBounds(),r=e.getBounds();return n.x<r.x+r.width&&n.x+n.width>r.x&&n.y<r.y+r.height&&n.y+n.height>r.y}}]));E(_w,"getScale",(function(t,e){var n=t.width;return e.width/n}));var bw=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t&&(t.progress(n),t.kill(),t.clear(),e&&(t=null))},Tw=function(t,e){var n=e.hide,r=e.fadeToHalf,i=e.fadeInFromZeroToHalf,s=e.fadeInFromFullToHalf,o=e.fadeToDark,a=e.duration,l=void 0===a?.3:a;return t.visible=!0,n?ww.to(t,{alpha:0,visible:!1,duration:l}):r?ww.to(t,{alpha:.65,duration:l}):i?ww.fromTo(t,{alpha:0},{alpha:.5,duration:l}):s?ww.fromTo(t,{alpha:1},{alpha:.5,duration:l}):o?ww.to(t,{alpha:1,duration:l}):void 0},Sw=_((function t(){v(this,t)}),null,[{key:"click",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;return this.clickTimeLine=ww.timeline().fromTo(t.scale,{x:t.scale.x,y:t.scale.y},{x:t.scale.x-n,y:t.scale.y-r,yoyo:!0,repeat:1,duration:.1}),new Promise((function(t){e.clickTimeLine.eventCallback("onComplete",(function(){bw(e.clickTimeLine),t()}))}))}},{key:"initOverHandler",value:function(t,e,n){(Array.isArray(t)?t:[t]).forEach((function(t){var r=t.scale.x-.05*Math.sign(t.scale.x),i=t.scale.y-.05*Math.sign(t.scale.y),s={x:void 0!==e?e:r,y:void 0!==e?e:i},o={x:void 0!==n?n:t.scale.x,y:void 0!==n?n:t.scale.y};t.on("pointerover",(function(){return ww.to(t.scale,{x:s.x,y:s.y,duration:.2})})),t.on("pointerout",(function(){return ww.to(t.scale,{x:o.x,y:o.y,duration:.2})}))}))}}]);function Aw(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Ew(t,e,n){return t.set(kw(t,e),n),n}function Cw(t,e){return t.get(kw(t,e))}function kw(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}E(Sw,"clickTimeLine",null);var Mw=new WeakMap,Pw=new WeakMap,Iw=new WeakMap,Rw=new WeakMap,Ow=new WeakMap,Lw=new WeakMap,Dw=new WeakMap,Fw=new WeakMap,Nw=new WeakMap,Bw=new WeakMap,Ww=new WeakMap,Uw=new WeakMap,jw=new WeakMap,Hw=new WeakMap,zw=new WeakMap,Gw=new WeakMap,Vw=new WeakMap,Xw=new WeakMap,Yw=new WeakMap,$w=new WeakMap,qw=new WeakMap,Kw=new WeakMap,Zw=new WeakMap,Qw=new WeakMap,Jw=new WeakMap,t_=new WeakMap,e_=new WeakMap,n_=_((function t(e){var n=this;v(this,t),Aw(this,Mw,window.game),Aw(this,Pw,Cw(Mw,this).refs),Aw(this,Iw,tf.get(Zd)),Aw(this,Rw,Cw(Pw,this).optionsView),Aw(this,Ow,Cw(Rw,this).getChildByName("optionPopUp")),Aw(this,Lw,Cw(Pw,this).optionsWheel),Aw(this,Dw,void 0),Aw(this,Fw,void 0),Aw(this,Nw,void 0),Aw(this,Bw,void 0),Aw(this,Ww,void 0),Aw(this,Uw,void 0),Aw(this,jw,void 0),Aw(this,Hw,null),E(this,"viewIsShow",!1),E(this,"show",Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Cw(Qw,n).call(n,!0,"+=90");case 2:return e={w:430,h:300},t.next=5,ww.from(Cw(jw,n),{x:e.w/2,y:e.h/2,alpha:0,ease:"back.inOut"});case 5:case"end":return t.stop()}}),t)})))),E(this,"hide",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Cw(Qw,n).call(n,!1,"-=90");case 2:case"end":return t.stop()}}),t)})))),Aw(this,zw,(function(){n.hide(),Cw(Zw,n).call(n,!1)})),Aw(this,Gw,(function(){Ew(Dw,n,Cw(Ow,n).getChildByName("btnClose")),Ew(Fw,n,Cw(Ow,n).getChildByName("btnMainScreen")),Ew(Nw,n,Cw(Ow,n).getChildByName("soundBtn")),Ew(Bw,n,Cw(Ow,n).getChildByName("sfxBtn")),Ew(Uw,n,Cw(Ow,n).getChildByName("btnDebug")),Ew(Ww,n,Cw(Ow,n).getChildByName("btnLight")),Ew(jw,n,[Cw(Fw,n),Cw(Nw,n),Cw(Bw,n),Cw(Ww,n),Cw(Uw,n)]),Sw.initOverHandler([Cw(Lw,n),Cw(Dw,n)].concat(Jc(Cw(jw,n))))})),Aw(this,Vw,(function(){Cw(Yw,n).call(n),Cw($w,n).call(n),Cw(qw,n).call(n),Cw(Kw,n).call(n)})),Aw(this,Xw,(function(t){return t.getChildByName("icon")})),Aw(this,Yw,(function(){Cw(Iw,n).isPlayMusic||(Cw(Xw,n).call(n,Cw(Nw,n)).texture=vr.from("icon-music-off"),Cw(Mw,n).emit(Sh)),Cw(Iw,n).isPlayMusic&&(Cw(Xw,n).call(n,Cw(Nw,n)).texture=vr.from("icon-music-on"),Cw(Mw,n).emit(Ah))})),Aw(this,$w,(function(){Cw(Iw,n).isPlaySfx||(Cw(Xw,n).call(n,Cw(Bw,n)).texture=vr.from("icon-sfx-off"),Cw(Mw,n).emit(bh)),Cw(Iw,n).isPlaySfx&&(Cw(Xw,n).call(n,Cw(Bw,n)).texture=vr.from("icon-sfx-on"),Cw(Mw,n).emit(Th))})),Aw(this,qw,(function(){Cw(Ww,n).text=Cw(Iw,n).isLight?"свет: on":"свет: off",document.getElementById("canvas-wrapper").classList.toggle("icon-light-on",Cw(Iw,n).isLight),Cw(Iw,n).isLight||(Cw(Xw,n).call(n,Cw(Ww,n)).texture=vr.from("icon-light-off")),Cw(Iw,n).isLight&&(Cw(Xw,n).call(n,Cw(Ww,n)).texture=vr.from("icon-light-on"))})),Aw(this,Kw,(function(){Cw(Iw,n).isDebug||Cw(Mw,n).emit("isDebug",!1),Cw(Iw,n).isDebug&&Cw(Mw,n).emit("isDebug",!0)})),Aw(this,Zw,(function(t){var e=t?"on":"off",r=t?"addEventListener":"removeEventListener";Cw(Lw,n)[e]("pointerdown",n.onWheelHandler),Cw(Mw,n)[e](vh,Cw(zw,n)),document[r]("keydown",Cw(t_,n))})),Aw(this,Qw,function(){var t=Jh(nc().mark((function t(e,r){var i,s;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(i=Cw(Hw,n))||void 0===i||!i.isActive()){t.next=2;break}return t.abrupt("return");case 2:return s=Cw(Rw,n).getChildByName("fade",2),t.abrupt("return",Ew(Hw,n,ww.timeline().set([Cw(Rw,n)],{visible:e}).set(Cw(Ow,n),{visible:!1}).to(Cw(Lw,n),{angle:r,duration:.2,ease:"linear"}).to(s,{alpha:e?.5:0,duration:.2},"<").set(Cw(Pw,n).wrapper,{filters:e?[Xd.blur]:[],duration:.2},"<").eventCallback("onComplete",(function(){var t;n.viewIsShow=e,(t=Cw(Hw,n))&&(t.kill(),t.clear(),t=null),e&&ww.timeline().set(Cw(Ow,n),{visible:!0}).fromTo(Cw(Ow,n),{alpha:0},{alpha:1,duration:.2,ease:"back.out(1.5)"});var r=e?"on":"off";Cw(Rw,n)[r]("pointerdown",Cw(Jw,n))}))));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),E(this,"onWheelHandler",(function(){n.viewIsShow=!n.viewIsShow,tf.get(Qd).play("sfx_btnClick"),n.viewIsShow?n.show():n.hide()})),Aw(this,Jw,(function(t){var e=t.target;if(e.name===Cw(Rw,n).name&&n.viewIsShow&&n.hide(),e.name===Cw(Fw,n).name){if(n.hide(),Cw(Mw,n).stateName===sh)return;Cw(Mw,n).stateName===oh&&n.state.checkoutState(sh)}e.name===Cw(Nw,n).name&&(Cw(Iw,n).isPlayMusic=!Cw(Iw,n).isPlayMusic,Cw(Iw,n).saveData(),Cw(Yw,n).call(n)),e.name===Cw(Bw,n).name&&(Cw(Iw,n).isPlaySfx=!Cw(Iw,n).isPlaySfx,Cw(Iw,n).saveData(),Cw($w,n).call(n)),e.name===Cw(Uw,n).name&&Cw(e_,n).call(n),e.name===Cw(Ww,n).name&&(Cw(Iw,n).isLight=!Cw(Iw,n).isLight,Cw(Iw,n).saveData(),Cw(qw,n).call(n)),e.name===Cw(Dw,n).name&&n.hide(),e.name!==Cw(Ow,n).name&&tf.get(Qd).play("sfx_btnClick")})),Aw(this,t_,(function(t){var e=t.key.toLowerCase();"escape"===e&&n.viewIsShow&&n.hide(),Cw(Mw,n).stateName===oh&&t.ctrlKey&&t.altKey&&t.shiftKey&&("h"===e||"р"===e)&&Cw(e_,n).call(n)})),Aw(this,e_,(function(){Cw(Iw,n).isDebug=!Cw(Iw,n).isDebug,Cw(Uw,n).text=Cw(Iw,n).isDebug?"debug: on":"debug: off",Cw(Mw,n).emit(fh,Cw(Iw,n).isDebug),Cw(Iw,n).saveData()})),this.state=e,Cw(Gw,this).call(this),Cw(Vw,this).call(this),Cw(Zw,this).call(this,!0)})),r_=(r(6033),_((function t(e){v(this,t),this.id=e,this.components=new Map}),[{key:"addComponent",value:function(t){this.components.set(t.constructor.name,t)}},{key:"getComponent",value:function(t){return this.components.get(t.name)}},{key:"hasComponent",value:function(t){return this.components.has(t.name)}}]));function i_(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(i_=function(){return!!t})()}var s_=new WeakMap,o_=function(t){function e(t,n){var r;return v(this,e),r=function(t,e,n){return e=T(e),b(t,i_()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[vr.from(n)]),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(r,s_,r),r.view.name="background",r}return A(e,t),_(e,[{key:"view",get:function(){return function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(s_,this)}}])}(os),a_=(r(5440),r(2762),(t=>(t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping",t))(a_||{}));class l_{constructor(t,e=new Array,n=0,r=new DataView(t.buffer)){this.strings=e,this.index=n,this.buffer=r}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){const t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){const t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),n=127&e;return 128&e&&(e=this.readByte(),n|=(127&e)<<7,128&e&&(e=this.readByte(),n|=(127&e)<<14,128&e&&(e=this.readByte(),n|=(127&e)<<21,128&e&&(e=this.readByte(),n|=(127&e)<<28)))),t?n:n>>>1^-(1&n)}readStringRef(){const t=this.readInt(!0);return 0==t?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let n=0;n<t;){const t=this.readUnsignedByte();switch(t>>4){case 12:case 13:e+=String.fromCharCode((31&t)<<6|63&this.readByte()),n+=2;break;case 14:e+=String.fromCharCode((15&t)<<12|(63&this.readByte())<<6|63&this.readByte()),n+=3;break;default:e+=String.fromCharCode(t),n++}}return e}readFloat(){const t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return 0!=this.readByte()}}var h_=(t=>(t[t.setup=0]="setup",t[t.first=1]="first",t[t.replace=2]="replace",t[t.add=3]="add",t))(h_||{}),c_=(t=>(t[t.mixIn=0]="mixIn",t[t.mixOut=1]="mixOut",t))(c_||{}),u_=(t=>(t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent",t))(u_||{}),d_=(t=>(t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale",t))(d_||{}),f_=(t=>(t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection",t))(f_||{});function p_(t){switch(t.toLowerCase()){case"nearest":return m_.Nearest;case"linear":return m_.Linear;case"mipmap":return m_.MipMap;case"mipmapnearestnearest":return m_.MipMapNearestNearest;case"mipmaplinearnearest":return m_.MipMapLinearNearest;case"mipmapnearestlinear":return m_.MipMapNearestLinear;case"mipmaplinearlinear":return m_.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${t}`)}}var m_=(t=>(t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear",t))(m_||{}),g_=(t=>(t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat",t))(g_||{});class v_{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){const t=this.texture;return t.trim?t.trim.width:t.orig.width}get height(){const t=this.texture;return t.trim?t.trim.height:t.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){const t=this.texture;return t.trim?t.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){const t=this.texture;return t.trim?t.trim.y:0}get spineOffsetY(){const t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return 0!==this.texture.rotate}get degrees(){return(360-45*this.texture.rotate)%360}}class y_{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}}class x_{constructor(t,e,n){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,n)}addTexture(t,e){const n=this.pages;let r=null;for(let t=0;t<n.length;t++)if(n[t].baseTexture===e.baseTexture){r=n[t];break}if(null===r){r=new __,r.name="texturePage";const t=e.baseTexture;r.width=t.realWidth,r.height=t.realHeight,r.baseTexture=t,r.minFilter=r.magFilter=m_.Nearest,r.uWrap=g_.ClampToEdge,r.vWrap=g_.ClampToEdge,n.push(r)}const i=new b_;return i.name=t,i.page=r,i.texture=e,i.index=-1,this.regions.push(i),i}addTextureHash(t,e){for(const n in t)t.hasOwnProperty(n)&&this.addTexture(e&&-1!==n.indexOf(".")?n.substr(0,n.lastIndexOf(".")):n,t[n])}addSpineAtlas(t,e,n){return this.load(t,e,n)}load(t,e,n){if(null==e)throw new Error("textureLoader cannot be null.");const r=new w_(t),i=new Array(4);let s=null;const o={};let a=null;o.size=()=>{s.width=parseInt(i[1]),s.height=parseInt(i[2])},o.format=()=>{},o.filter=()=>{s.minFilter=p_(i[1]),s.magFilter=p_(i[2])},o.repeat=()=>{-1!=i[1].indexOf("x")&&(s.uWrap=g_.Repeat),-1!=i[1].indexOf("y")&&(s.vWrap=g_.Repeat)},o.pma=()=>{s.pma="true"==i[1]};const l={xy:()=>{a.x=parseInt(i[1]),a.y=parseInt(i[2])},size:()=>{a.width=parseInt(i[1]),a.height=parseInt(i[2])},bounds:()=>{a.x=parseInt(i[1]),a.y=parseInt(i[2]),a.width=parseInt(i[3]),a.height=parseInt(i[4])},offset:()=>{a.offsetX=parseInt(i[1]),a.offsetY=parseInt(i[2])},orig:()=>{a.originalWidth=parseInt(i[1]),a.originalHeight=parseInt(i[2])},offsets:()=>{a.offsetX=parseInt(i[1]),a.offsetY=parseInt(i[2]),a.originalWidth=parseInt(i[3]),a.originalHeight=parseInt(i[4])},rotate:()=>{const t=i[1];let e=0;e="true"==t.toLocaleLowerCase()?6:"false"==t.toLocaleLowerCase()?0:(720-parseFloat(t))%360/45,a.rotate=e},index:()=>{a.index=parseInt(i[1])}};let h=r.readLine();for(;null!=h&&0==h.trim().length;)h=r.readLine();for(;null!=h&&0!=h.trim().length&&0!=r.readEntry(i,h);)h=r.readLine();const c=()=>{for(;;){if(null==h)return n&&n(this);if(0==h.trim().length)s=null,h=r.readLine();else{if(null===s){for(s=new __,s.name=h.trim();0!=r.readEntry(i,h=r.readLine());){const t=o[i[0]];t&&t()}this.pages.push(s),e(s.name,(t=>{if(null===t)return this.pages.splice(this.pages.indexOf(s),1),n&&n(null);s.baseTexture=t,s.pma&&(t.alphaMode=W.PMA),t.valid||t.setSize(s.width,s.height),s.setFilters(),s.width&&s.height||(s.width=t.realWidth,s.height=t.realHeight,s.width&&s.height||console.log(`ERROR spine atlas page ${s.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),c()}));break}{a=new y_;const t=new b_;t.name=h,t.page=s;let e=null,n=null;for(;;){const t=r.readEntry(i,h=r.readLine());if(0==t)break;const s=l[i[0]];if(s)s();else{null==e&&(e=[],n=[]),e.push(i[0]);const r=[];for(let e=0;e<t;e++)r.push(parseInt(i[e+1]));n.push(r)}}0==a.originalWidth&&0==a.originalHeight&&(a.originalWidth=a.width,a.originalHeight=a.height);const o=s.baseTexture.resolution;a.x/=o,a.y/=o,a.width/=o,a.height/=o,a.originalWidth/=o,a.originalHeight/=o,a.offsetX/=o,a.offsetY/=o;const c=a.rotate%4!=0,u=new vn(a.x,a.y,c?a.height:a.width,c?a.width:a.height),d=new vn(0,0,a.originalWidth,a.originalHeight),f=new vn(a.offsetX,a.originalHeight-a.height-a.offsetY,a.width,a.height);t.texture=new vr(t.page.baseTexture,u,d,f,a.rotate),t.index=a.index,t.texture.updateUvs(),this.regions.push(t)}}}};c()}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}dispose(){for(let t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()}}class w_{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(null==e)return 0;if(0==(e=e.trim()).length)return 0;const n=e.indexOf(":");if(-1==n)return 0;t[0]=e.substr(0,n).trim();for(let r=1,i=n+1;;r++){const n=e.indexOf(",",i);if(-1==n)return t[r]=e.substr(i).trim(),r;if(t[r]=e.substr(i,n-i).trim(),i=n+1,4==r)return 4}}}class __{constructor(){this.minFilter=m_.Nearest,this.magFilter=m_.Nearest,this.uWrap=g_.ClampToEdge,this.vWrap=g_.ClampToEdge}setFilters(){const t=this.baseTexture,e=this.minFilter;e==m_.Linear?t.scaleMode=F.LINEAR:this.minFilter==m_.Nearest?t.scaleMode=F.NEAREST:(t.mipmap=B.POW2,e==m_.MipMapNearestNearest?t.scaleMode=F.NEAREST:t.scaleMode=F.LINEAR)}}class b_ extends v_{}class T_{constructor(){this.entries={},this.size=0}add(t){const e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}addAll(t){const e=this.size;for(let e=0,n=t.length;e<n;e++)this.add(t[e]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const S_=class{constructor(t=0,e=0,n=0,r=0){this.r=t,this.g=e,this.b=n,this.a=r}set(t,e,n,r){return this.r=t,this.g=e,this.b=n,this.a=r,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=8!=t.length?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,n,r){return this.r+=t,this.g+=e,this.b+=n,this.a+=r,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}static rgb888ToColor(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}static fromString(t){return(new S_).setFromString(t)}};let A_=S_;A_.WHITE=new S_(1,1,1,1),A_.RED=new S_(1,0,0,1),A_.GREEN=new S_(0,1,0,1),A_.BLUE=new S_(0,0,1,1),A_.MAGENTA=new S_(1,0,1,1);const E_=class{static clamp(t,e,n){return t<e?e:t>n?n:t}static cosDeg(t){return Math.cos(t*E_.degRad)}static sinDeg(t){return Math.sin(t*E_.degRad)}static signum(t){return Math.sign(t)}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){const e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}static randomTriangular(t,e){return E_.randomTriangularWith(t,e,.5*(t+e))}static randomTriangularWith(t,e,n){const r=Math.random(),i=e-t;return r<=(n-t)/i?t+Math.sqrt(r*i*(n-t)):e-Math.sqrt((1-r)*i*(e-n))}static isPowerOfTwo(t){return t&&!(t&t-1)}};let C_=E_;C_.PI=3.1415927,C_.PI2=2*E_.PI,C_.radiansToDegrees=180/E_.PI,C_.radDeg=E_.radiansToDegrees,C_.degreesToRadians=E_.PI/180,C_.degRad=E_.degreesToRadians;const k_=class{static arrayCopy(t,e,n,r,i){for(let s=e,o=r;s<e+i;s++,o++)n[o]=t[s]}static arrayFill(t,e,n,r){for(let i=e;i<n;i++)t[i]=r}static setArraySize(t,e,n=0){const r=t.length;if(r==e)return t;if(t.length=e,r<e)for(let i=r;i<e;i++)t[i]=n;return t}static ensureArrayCapacity(t,e,n=0){return t.length>=e?t:k_.setArraySize(t,e,n)}static newArray(t,e){const n=new Array(t);for(let r=0;r<t;r++)n[r]=e;return n}static newFloatArray(t){if(k_.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);const e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}static newShortArray(t){if(k_.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);const e=new Array(t);for(let t=0;t<e.length;t++)e[t]=0;return e}static toFloatArray(t){return k_.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return k_.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e,n=!0){for(let n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}};let M_=k_;M_.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array;class P_{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class I_{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){const t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}}const R_=[0,0,0];class O_ extends os{constructor(){super(...arguments),this.region=null,this.attachment=null}}class L_ extends sl{constructor(t,e,n,r,i){super(t,e,n,r,i),this.region=null,this.attachment=null}}const D_=class extends rs{constructor(t){if(super(),!t)throw new Error("The spineData param is required.");if("string"==typeof t)throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=t,this.createSkeleton(t),this.slotContainers=[],this.tempClipContainers=[];for(let t=0,e=this.skeleton.slots.length;t<e;t++){const e=this.skeleton.slots[t],n=e.getAttachment(),r=this.newContainer();if(this.slotContainers.push(r),this.addChild(r),this.tempClipContainers.push(null),n)if(n.type===a_.Region){const t=n.name,i=this.createSprite(e,n,t);e.currentSprite=i,e.currentSpriteName=t,r.addChild(i)}else if(n.type===a_.Mesh){const t=this.createMesh(e,n);e.currentMesh=t,e.currentMeshId=n.id,e.currentMeshName=n.name,r.addChild(t)}else n.type===a_.Clipping&&(this.createGraphics(e,n),r.addChild(e.clippingContainer),r.addChild(e.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(t){t!=this._debug&&(this._debug?.unregisterSpine(this),t?.registerSpine(this),this._debug=t)}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this.updateTransform=t?D_.prototype.autoUpdateTransform:rs.prototype.updateTransform)}get tint(){return se(this.tintRgb)}set tint(t){this.tintRgb=ne(t,this.tintRgb)}get delayLimit(){return(void 0!==this.localDelayLimit?this.localDelayLimit:0)||Number.MAX_VALUE}update(t){const e=this.delayLimit;if(t>e&&(t=e),this.state.update(t),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();const n=this.skeleton.slots,r=this.color;let i=null,s=null;r?(i=r.light,s=r.dark):i=this.tintRgb;for(let t=0,e=n.length;t<e;t++){const e=n[t],r=e.getAttachment(),o=this.slotContainers[t];if(!r){o.visible=!1;continue}let a=null;r.sequence&&r.sequence.apply(e,r);let l=r.region;const h=r.color;switch(null!=r&&r.type){case a_.Region:if(o.transform.setFromMatrix(e.bone.matrix),l=r.region,e.currentMesh&&(e.currentMesh.visible=!1,e.currentMesh=null,e.currentMeshId=void 0,e.currentMeshName=void 0),!l){e.currentSprite&&(e.currentSprite.renderable=!1);break}if(!e.currentSpriteName||e.currentSpriteName!==r.name){const t=r.name;if(e.currentSprite&&(e.currentSprite.visible=!1),e.sprites=e.sprites||{},void 0!==e.sprites[t])e.sprites[t].visible=!0;else{const n=this.createSprite(e,r,t);o.addChild(n)}e.currentSprite=e.sprites[t],e.currentSpriteName=t}e.currentSprite.renderable=!0,e.hackRegion||this.setSpriteRegion(r,e.currentSprite,l),e.currentSprite.color?a=e.currentSprite.color:(R_[0]=i[0]*e.color.r*h.r,R_[1]=i[1]*e.color.g*h.g,R_[2]=i[2]*e.color.b*h.b,e.currentSprite.tint=se(R_)),e.currentSprite.blendMode=e.blendMode;break;case a_.Mesh:if(e.currentSprite){e.currentSprite.visible=!1,e.currentSprite=null,e.currentSpriteName=void 0;const t=new On;t._parentID=-1,t._worldID=o.transform._worldID,o.transform=t}if(!l){e.currentMesh&&(e.currentMesh.renderable=!1);break}const t=r.id;if(void 0===e.currentMeshId||e.currentMeshId!==t){const n=t;if(e.currentMesh&&(e.currentMesh.visible=!1),e.meshes=e.meshes||{},void 0!==e.meshes[n])e.meshes[n].visible=!0;else{const t=this.createMesh(e,r);o.addChild(t)}e.currentMesh=e.meshes[n],e.currentMeshName=r.name,e.currentMeshId=n}e.currentMesh.renderable=!0,r.computeWorldVerticesOld(e,e.currentMesh.vertices),e.currentMesh.color?a=e.currentMesh.color:(R_[0]=i[0]*e.color.r*h.r,R_[1]=i[1]*e.color.g*h.g,R_[2]=i[2]*e.color.b*h.b,e.currentMesh.tint=se(R_)),e.currentMesh.blendMode=e.blendMode,e.hackRegion||this.setMeshRegion(r,e.currentMesh,l);break;case a_.Clipping:e.currentGraphics||(this.createGraphics(e,r),o.addChild(e.clippingContainer),o.addChild(e.currentGraphics)),this.updateGraphics(e,r),o.alpha=1,o.visible=!0;continue;default:o.visible=!1;continue}if(o.visible=!0,a){let t=e.color.r*h.r,n=e.color.g*h.g,r=e.color.b*h.b;a.setLight(i[0]*t+s[0]*(1-t),i[1]*n+s[1]*(1-n),i[2]*r+s[2]*(1-r)),e.darkColor?(t=e.darkColor.r,n=e.darkColor.g,r=e.darkColor.b):(t=0,n=0,r=0),a.setDark(i[0]*t+s[0]*(1-t),i[1]*n+s[1]*(1-n),i[2]*r+s[2]*(1-r))}o.alpha=e.color.a}const o=this.skeleton.drawOrder;let a=null,l=null;for(let t=0,e=o.length;t<e;t++){const e=n[o[t].data.index],r=this.slotContainers[o[t].data.index];if(l||null!==r.parent&&r.parent!==this&&(r.parent.removeChild(r),r.parent=this),e.currentGraphics&&e.getAttachment())l=e.clippingContainer,a=e.getAttachment(),l.children.length=0,this.children[t]=r,a.endSlot===e.data&&(a.endSlot=null);else if(l){let n=this.tempClipContainers[t];n||(n=this.tempClipContainers[t]=this.newContainer(),n.visible=!1),this.children[t]=n,r.parent=null,l.addChild(r),a.endSlot==e.data&&(l.renderable=!0,l=null,a=null)}else this.children[t]=r}this._debug?.renderDebug(this)}setSpriteRegion(t,e,n){e.attachment===t&&e.region===n||(e.region=n,e.attachment=t,e.texture=n.texture,e.rotation=t.rotation*C_.degRad,e.position.x=t.x,e.position.y=t.y,e.alpha=t.color.a,n.size?(e.scale.x=n.size.width/n.originalWidth,e.scale.y=-n.size.height/n.originalHeight):(e.scale.x=t.scaleX*t.width/n.originalWidth,e.scale.y=-t.scaleY*t.height/n.originalHeight))}setMeshRegion(t,e,n){e.attachment===t&&e.region===n||(e.region=n,e.attachment=t,e.texture=n.texture,n.texture.updateUvs(),e.uvBuffer.update(t.regionUVs))}autoUpdateTransform(){{this.lastTime=this.lastTime||Date.now();const t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(t)}rs.prototype.updateTransform.call(this)}createSprite(t,e,n){let r=e.region;t.hackAttachment===e&&(r=t.hackRegion);const i=r?r.texture:null,s=this.newSprite(i);return s.anchor.set(.5),r&&this.setSpriteRegion(e,s,e.region),t.sprites=t.sprites||{},t.sprites[n]=s,s}createMesh(t,e){let n=e.region;t.hackAttachment===e&&(n=t.hackRegion,t.hackAttachment=null,t.hackRegion=null);const r=this.newMesh(n?n.texture:null,new Float32Array(e.regionUVs.length),e.regionUVs,new Uint16Array(e.triangles),I.TRIANGLES);return void 0!==r._canvasPadding&&(r._canvasPadding=1.5),r.alpha=e.color.a,r.region=e.region,n&&this.setMeshRegion(e,r,n),t.meshes=t.meshes||{},t.meshes[e.id]=r,r}createGraphics(t,e){const n=this.newGraphics(),r=new wn([]);return n.clear(),n.beginFill(16777215,1),n.drawPolygon(r),n.renderable=!1,t.currentGraphics=n,t.clippingContainer=this.newContainer(),t.clippingContainer.mask=t.currentGraphics,n}updateGraphics(t,e){const n=t.currentGraphics.geometry,r=n.graphicsData[0].shape.points,i=e.worldVerticesLength;r.length=i,e.computeWorldVertices(t,0,i,r,0,2),n.invalidate()}hackTextureBySlotIndex(t,e=null,n=null){const r=this.skeleton.slots[t];if(!r)return!1;const i=r.getAttachment();let s=i.region;return e?(s=new v_,s.texture=e,s.size=n,r.hackRegion=s,r.hackAttachment=i):(r.hackRegion=null,r.hackAttachment=null),r.currentSprite?this.setSpriteRegion(i,r.currentSprite,s):r.currentMesh&&this.setMeshRegion(i,r.currentMesh,s),!0}hackTextureBySlotName(t,e=null,n=null){const r=this.skeleton.findSlotIndex(t);return-1!=r&&this.hackTextureBySlotIndex(r,e,n)}hackTextureAttachment(t,e,n,r=null){const i=this.skeleton.findSlotIndex(t),s=this.skeleton.getAttachmentByName(t,e);s.region.texture=n;const o=this.skeleton.slots[i];if(!o)return!1;const a=o.getAttachment();if(e===a.name){let t=s.region;return n?(t=new v_,t.texture=n,t.size=r,o.hackRegion=t,o.hackAttachment=a):(o.hackRegion=null,o.hackAttachment=null),o.currentSprite&&o.currentSprite.region!=t?(this.setSpriteRegion(a,o.currentSprite,t),o.currentSprite.region=t):o.currentMesh&&o.currentMesh.region!=t&&this.setMeshRegion(a,o.currentMesh,t),!0}return!1}newContainer(){return new rs}newSprite(t){return new O_(t)}newGraphics(){return new Ya}newMesh(t,e,n,r,i){return new L_(t,e,n,r,i)}transformHack(){return 1}hackAttachmentGroups(t,e,n){if(!t)return;const r=[],i=[];for(let s=0,o=this.skeleton.slots.length;s<o;s++){const o=this.skeleton.slots[s],a=o.currentSpriteName||o.currentMeshName||"",l=o.currentSprite||o.currentMesh;a.endsWith(t)?(l.parentGroup=e,i.push(l)):n&&l&&(l.parentGroup=n,r.push(l))}return[r,i]}destroy(t){this.debug=null;for(let e=0,n=this.skeleton.slots.length;e<n;e++){const n=this.skeleton.slots[e];for(const e in n.meshes)n.meshes[e].destroy(t);n.meshes=null;for(const e in n.sprites)n.sprites[e].destroy(t);n.sprites=null}for(let e=0,n=this.slotContainers.length;e<n;e++)this.slotContainers[e].destroy(t);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(t)}};let F_=D_;F_.clippingPolygon=[],Object.defineProperty(F_.prototype,"visible",{get(){return this._visible},set(t){t!==this._visible&&(this._visible=t,t&&(this.lastTime=0))}});const N_={extension:Be.Asset,loader:{extension:{type:Be.LoadParser,priority:ao.Normal},test(t){return no(t,".atlas")},async load(t){const e=await Y.ADAPTER.fetch(t);return await e.text()},testParse(t,e){const n=no(e.src,".atlas"),r="string"==typeof t;return Promise.resolve(n&&r)},async parse(t,e,n){const r=e.data;let i=wt.dirname(e.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let s=null,o=null;const a=new Promise(((t,e)=>{s=t,o=e}));let l;const h=t=>{t||o("Something went terribly wrong loading a spine .atlas file\nMost likely your texture failed to load."),s(l)};if(r.image||r.images){const e=Object.assign(r.image?{default:r.image}:{},r.images);l=new x_(t,((t,n)=>{const r=e[t]||e.default;r&&r.baseTexture?n(r.baseTexture):n(r)}),h)}else l=new x_(t,B_(n,i,r.imageMetadata),h);return await a},unload(t){t.dispose()}}},B_=(t,e,n)=>async(r,i)=>{const s=wt.normalize([...e.split(wt.sep),r].join(wt.sep));i((await t.load({src:s,data:n})).baseTexture)};function W_(t){return t.hasOwnProperty("bones")}je.add(N_);class U_{constructor(){}installLoader(){const t=this,e={extension:Be.Asset,loader:{extension:{type:Be.LoadParser,priority:ao.Normal},test(t){return no(t,".skel")},async load(t){const e=await Y.ADAPTER.fetch(t);return await e.arrayBuffer()},testParse(t,e){const n=no(e.src,".json")&&W_(t),r=no(e.src,".skel")&&t instanceof ArrayBuffer,i=!1===e.data?.spineAtlas;return Promise.resolve(n&&!i||r)},async parse(e,n,r){const i=wt.extname(n.src).toLowerCase(),s=wt.basename(n.src,i);let o=wt.dirname(n.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a=null,l=e;no(n.src,".json")&&W_(e)?a=t.createJsonParser():(a=t.createBinaryParser(),l=new Uint8Array(e));const h=n.data||{},c=h?.spineSkeletonScale??null;c&&(a.scale=c);const u=h.spineAtlas;if(u&&u.pages)return t.parseData(a,u,l);const d=h.atlasRawData;if(d){let e=null,n=null;const i=new Promise(((t,r)=>{e=t,n=r})),s=new x_(d,B_(r,o,h.imageMetadata),(t=>{t||n("Something went terribly wrong loading a spine .atlas file\nMost likely your texture failed to load."),e(s)})),c=await i;return t.parseData(a,c,l)}let f=h.spineAtlasFile;f||(f=`${o+s}.atlas`);const p=await r.load({src:f,data:h,alias:h.spineAtlasAlias});return t.parseData(a,p,l)}}};return je.add(e),e}}class j_{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}}const H_=class extends j_{constructor(t){super(t),this.id=H_.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,n,r,i,s){n=i+(n>>1)*s;const o=t.bone.skeleton,a=t.deform;let l=this.vertices;const h=this.bones;if(!h){a.length>0&&(l=a);const o=t.bone.matrix,h=o.tx,c=o.ty,u=o.a,d=o.c,f=o.b,p=o.d;for(let t=e,o=i;o<n;t+=2,o+=s){const e=l[t],n=l[t+1];r[o]=e*u+n*d+h,r[o+1]=e*f+n*p+c}return}let c=0,u=0;for(let t=0;t<e;t+=2){const t=h[c];c+=t+1,u+=t}const d=o.bones;if(0==a.length)for(let t=i,e=3*u;t<n;t+=s){let n=0,i=0,s=h[c++];for(s+=c;c<s;c++,e+=3){const t=d[h[c]].matrix,r=l[e],s=l[e+1],o=l[e+2];n+=(r*t.a+s*t.c+t.tx)*o,i+=(r*t.b+s*t.d+t.ty)*o}r[t]=n,r[t+1]=i}else{const t=a;for(let e=i,o=3*u,a=u<<1;e<n;e+=s){let n=0,i=0,s=h[c++];for(s+=c;c<s;c++,o+=3,a+=2){const e=d[h[c]].matrix,r=l[o]+t[a],s=l[o+1]+t[a+1],u=l[o+2];n+=(r*e.a+s*e.c+e.tx)*u,i+=(r*e.b+s*e.d+e.ty)*u}r[e]=n,r[e+1]=i}}}copyTo(t){this.bones?(t.bones=new Array(this.bones.length),M_.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=M_.newFloatArray(this.vertices.length),M_.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttachment=this.timelineAttachment}};let z_=H_;z_.nextID=0;class G_ extends z_{constructor(t){super(t),this.type=a_.BoundingBox,this.color=new A_(1,1,1,1)}copy(){const t=new G_(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class V_ extends z_{constructor(t){super(t),this.type=a_.Clipping,this.endSlot=null,this.color=new A_(.2275,.2275,.8078,1)}copy(){const t=new V_(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class X_ extends z_{constructor(t,e){super(t),this.type=a_.Mesh,this.region=null,this.triangles=[],this.color=new A_(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new A_(0,0,0,0),this.path=e}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();const t=new X_(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),M_.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),M_.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),M_.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,n,r,i,s){null!=this.sequence&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,n,r,i,s)}newLinkedMesh(){const t=new X_(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t}}class Y_ extends z_{constructor(t){super(t),this.type=a_.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new A_(1,1,1,1)}copy(){const t=new Y_(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),M_.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class $_ extends z_{constructor(t){super(t),this.type=a_.Point,this.x=0,this.y=0,this.rotation=0,this.color=new A_(.38,.94,0,1)}computeWorldPosition(t,e){const n=t.matrix;return e.x=this.x*n.a+this.y*n.c+t.worldX,e.y=this.x*n.b+this.y*n.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,n=C_.cosDeg(this.rotation),r=C_.sinDeg(this.rotation),i=n*e.a+r*e.c,s=n*e.b+r*e.d;return Math.atan2(s,i)*C_.radDeg}copy(){const t=new $_(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const q_=class extends j_{constructor(t,e){super(t),this.type=a_.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new A_(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=M_.newFloatArray(8),this.uvs=M_.newFloatArray(8),this.tempColor=new A_(1,1,1,1),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");const t=this.region,e=this.width/this.region.originalWidth*this.scaleX,n=this.height/this.region.originalHeight*this.scaleY,r=-this.width/2*this.scaleX+this.region.offsetX*e,i=-this.height/2*this.scaleY+this.region.offsetY*n,s=r+this.region.width*e,o=i+this.region.height*n,a=this.rotation*Math.PI/180,l=Math.cos(a),h=Math.sin(a),c=this.x,u=this.y,d=r*l+c,f=r*h,p=i*l+u,m=i*h,g=s*l+c,v=s*h,y=o*l+u,x=o*h,w=this.offset;w[0]=d-m,w[1]=p+f,w[2]=d-x,w[3]=y+f,w[4]=g-x,w[5]=y+v,w[6]=g-m,w[7]=p+v;const _=this.uvs;90==t.degrees?(_[2]=t.u,_[3]=t.v2,_[4]=t.u,_[5]=t.v,_[6]=t.u2,_[7]=t.v,_[0]=t.u2,_[1]=t.v2):(_[0]=t.u,_[1]=t.v2,_[2]=t.u,_[3]=t.v,_[4]=t.u2,_[5]=t.v,_[6]=t.u2,_[7]=t.v2)}computeWorldVertices(t,e,n,r){null!=this.sequence&&this.sequence.apply(t,this);const i=t.bone,s=this.offset,o=i.matrix,a=o.tx,l=o.ty,h=o.a,c=o.c,u=o.b,d=o.d;let f=0,p=0;f=s[0],p=s[1],e[n]=f*h+p*c+a,e[n+1]=f*u+p*d+l,n+=r,f=s[2],p=s[3],e[n]=f*h+p*c+a,e[n+1]=f*u+p*d+l,n+=r,f=s[4],p=s[5],e[n]=f*h+p*c+a,e[n+1]=f*u+p*d+l,n+=r,f=s[6],p=s[7],e[n]=f*h+p*c+a,e[n+1]=f*u+p*d+l}copy(){const t=new q_(this.name,this.path);return t.region=this.region,t.rendererObject=this.rendererObject,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,M_.arrayCopy(this.uvs,0,t.uvs,0,8),M_.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t.sequence=null!=this.sequence?this.sequence.copy():null,t}};let K_=q_;K_.X1=0,K_.Y1=1,K_.C1R=2,K_.C1G=3,K_.C1B=4,K_.C1A=5,K_.U1=6,K_.V1=7,K_.X2=8,K_.Y2=9,K_.C2R=10,K_.C2G=11,K_.C2B=12,K_.C2A=13,K_.U2=14,K_.V2=15,K_.X3=16,K_.Y3=17,K_.C3R=18,K_.C3G=19,K_.C3B=20,K_.C3A=21,K_.U3=22,K_.V3=23,K_.X4=24,K_.Y4=25,K_.C4R=26,K_.C4G=27,K_.C4B=28,K_.C4A=29,K_.U4=30,K_.V4=31;const Z_=class{constructor(t){this.id=Z_.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(t)}copy(){const t=new Z_(this.regions.length);return M_.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t}apply(t,e){let n=t.sequenceIndex;-1==n&&(n=this.setupIndex),n>=this.regions.length&&(n=this.regions.length-1);const r=this.regions[n];e.region!=r&&(e.region=r)}getPath(t,e){let n=t;const r=(this.start+e).toString();for(let t=this.digits-r.length;t>0;t--)n+="0";return n+=r,n}static nextID(){return Z_._nextID++}};let Q_=Z_;Q_._nextID=0;var J_=(t=>(t[t.hold=0]="hold",t[t.once=1]="once",t[t.loop=2]="loop",t[t.pingpong=3]="pingpong",t[t.onceReverse=4]="onceReverse",t[t.loopReverse=5]="loopReverse",t[t.pingpongReverse=6]="pingpongReverse",t))(J_||{});const tb=[0,1,2,3,4,5,6];class eb{constructor(t,e,n){if(this.timelines=[],this.timelineIds=new T_,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=n}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(let e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,n,r,i,s,o,a){if(!t)throw new Error("skeleton cannot be null.");r&&0!=this.duration&&(n%=this.duration,e>0&&(e%=this.duration));const l=this.timelines;for(let r=0,h=l.length;r<h;r++)l[r].apply(t,e,n,i,s,o,a)}}class nb{constructor(t,e){this.propertyIds=e,this.frames=M_.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){const n=t.length;for(let r=1;r<n;r++)if(t[r]>e)return r-1;return n-1}static search(t,e,n){const r=t.length;for(let i=n;i<r;i+=n)if(t[i]>e)return i-n;return r-n}}class rb extends nb{constructor(t,e,n){super(t,n),this.curves=M_.newFloatArray(t+18*e),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){const e=this.getFrameCount()+18*t;if(this.curves.length>e){const t=M_.newFloatArray(e);M_.arrayCopy(this.curves,0,t,0,e),this.curves=t}}setBezier(t,e,n,r,i,s,o,a,l,h,c){const u=this.curves;let d=this.getFrameCount()+18*t;0==n&&(u[e]=2+d);const f=.03*(r-2*s+a),p=.03*(i-2*o+l),m=.006*(3*(s-a)-r+h),g=.006*(3*(o-l)-i+c);let v=2*f+m,y=2*p+g,x=.3*(s-r)+f+.16666667*m,w=.3*(o-i)+p+.16666667*g,_=r+x,b=i+w;for(let t=d+18;d<t;d+=2)u[d]=_,u[d+1]=b,x+=v,w+=y,v+=m,y+=g,_+=x,b+=w}getBezierValue(t,e,n,r){const i=this.curves;if(i[r]>t){const s=this.frames[e],o=this.frames[e+n];return o+(t-s)/(i[r]-s)*(i[r+1]-o)}const s=r+18;for(r+=2;r<s;r+=2)if(i[r]>=t){const e=i[r-2],n=i[r-1];return n+(t-e)/(i[r]-e)*(i[r+1]-n)}e+=this.getFrameEntries();const o=i[s-2],a=i[s-1];return a+(t-o)/(this.frames[e]-o)*(this.frames[e+n]-a)}}class ib extends rb{constructor(t,e,n){super(t,e,[n])}getFrameEntries(){return 2}setFrame(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+1]=n}getCurveValue(t){const e=this.frames;let n=e.length-2;for(let r=2;r<=n;r+=2)if(e[r]>t){n=r-2;break}const r=this.curves[n>>1];switch(r){case 0:const r=e[n],i=e[n+1];return i+(t-r)/(e[n+2]-r)*(e[n+2+1]-i);case 1:return e[n+1]}return this.getBezierValue(t,n,1,r-2)}}class sb extends rb{constructor(t,e,n,r){super(t,e,[n,r])}getFrameEntries(){return 3}setFrame(t,e,n,r){t*=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r}}class ob extends ib{constructor(t,e,n){super(t,e,`0|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case h_.setup:return void(a.rotation=a.data.rotation);case h_.first:a.rotation+=(a.data.rotation-a.rotation)*i}return}let l=this.getCurveValue(n);switch(s){case h_.setup:a.rotation=a.data.rotation+l*i;break;case h_.first:case h_.replace:l+=a.data.rotation-a.rotation;case h_.add:a.rotation+=l*i}}}class ab extends sb{constructor(t,e,n){super(t,e,`1|${n}`,`2|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case h_.setup:return a.x=a.data.x,void(a.y=a.data.y);case h_.first:a.x+=(a.data.x-a.x)*i,a.y+=(a.data.y-a.y)*i}return}let h=0,c=0;const u=nb.search(l,n,3),d=this.curves[u/3];switch(d){case 0:const t=l[u];h=l[u+1],c=l[u+2];const e=(n-t)/(l[u+3]-t);h+=(l[u+3+1]-h)*e,c+=(l[u+3+2]-c)*e;break;case 1:h=l[u+1],c=l[u+2];break;default:h=this.getBezierValue(n,u,1,d-2),c=this.getBezierValue(n,u,2,d+18-2)}switch(s){case h_.setup:a.x=a.data.x+h*i,a.y=a.data.y+c*i;break;case h_.first:case h_.replace:a.x+=(a.data.x+h-a.x)*i,a.y+=(a.data.y+c-a.y)*i;break;case h_.add:a.x+=h*i,a.y+=c*i}}}class lb extends ib{constructor(t,e,n){super(t,e,`1|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case h_.setup:return void(a.x=a.data.x);case h_.first:a.x+=(a.data.x-a.x)*i}return}const l=this.getCurveValue(n);switch(s){case h_.setup:a.x=a.data.x+l*i;break;case h_.first:case h_.replace:a.x+=(a.data.x+l-a.x)*i;break;case h_.add:a.x+=l*i}}}class hb extends ib{constructor(t,e,n){super(t,e,`2|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case h_.setup:return void(a.y=a.data.y);case h_.first:a.y+=(a.data.y-a.y)*i}return}const l=this.getCurveValue(n);switch(s){case h_.setup:a.y=a.data.y+l*i;break;case h_.first:case h_.replace:a.y+=(a.data.y+l-a.y)*i;break;case h_.add:a.y+=l*i}}}class cb extends sb{constructor(t,e,n){super(t,e,`3|${n}`,`4|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case h_.setup:return a.scaleX=a.data.scaleX,void(a.scaleY=a.data.scaleY);case h_.first:a.scaleX+=(a.data.scaleX-a.scaleX)*i,a.scaleY+=(a.data.scaleY-a.scaleY)*i}return}let h,c;const u=nb.search(l,n,3),d=this.curves[u/3];switch(d){case 0:const t=l[u];h=l[u+1],c=l[u+2];const e=(n-t)/(l[u+3]-t);h+=(l[u+3+1]-h)*e,c+=(l[u+3+2]-c)*e;break;case 1:h=l[u+1],c=l[u+2];break;default:h=this.getBezierValue(n,u,1,d-2),c=this.getBezierValue(n,u,2,d+18-2)}if(h*=a.data.scaleX,c*=a.data.scaleY,1==i)s==h_.add?(a.scaleX+=h-a.data.scaleX,a.scaleY+=c-a.data.scaleY):(a.scaleX=h,a.scaleY=c);else{let t=0,e=0;if(o==c_.mixOut)switch(s){case h_.setup:t=a.data.scaleX,e=a.data.scaleY,a.scaleX=t+(Math.abs(h)*C_.signum(t)-t)*i,a.scaleY=e+(Math.abs(c)*C_.signum(e)-e)*i;break;case h_.first:case h_.replace:t=a.scaleX,e=a.scaleY,a.scaleX=t+(Math.abs(h)*C_.signum(t)-t)*i,a.scaleY=e+(Math.abs(c)*C_.signum(e)-e)*i;break;case h_.add:a.scaleX+=(h-a.data.scaleX)*i,a.scaleY+=(c-a.data.scaleY)*i}else switch(s){case h_.setup:t=Math.abs(a.data.scaleX)*C_.signum(h),e=Math.abs(a.data.scaleY)*C_.signum(c),a.scaleX=t+(h-t)*i,a.scaleY=e+(c-e)*i;break;case h_.first:case h_.replace:t=Math.abs(a.scaleX)*C_.signum(h),e=Math.abs(a.scaleY)*C_.signum(c),a.scaleX=t+(h-t)*i,a.scaleY=e+(c-e)*i;break;case h_.add:a.scaleX+=(h-a.data.scaleX)*i,a.scaleY+=(c-a.data.scaleY)*i}}}}class ub extends ib{constructor(t,e,n){super(t,e,`3|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case h_.setup:return void(a.scaleX=a.data.scaleX);case h_.first:a.scaleX+=(a.data.scaleX-a.scaleX)*i}return}const l=this.getCurveValue(n)*a.data.scaleX;if(1==i)s==h_.add?a.scaleX+=l-a.data.scaleX:a.scaleX=l;else{let t=0;if(o==c_.mixOut)switch(s){case h_.setup:t=a.data.scaleX,a.scaleX=t+(Math.abs(l)*C_.signum(t)-t)*i;break;case h_.first:case h_.replace:t=a.scaleX,a.scaleX=t+(Math.abs(l)*C_.signum(t)-t)*i;break;case h_.add:a.scaleX+=(l-a.data.scaleX)*i}else switch(s){case h_.setup:t=Math.abs(a.data.scaleX)*C_.signum(l),a.scaleX=t+(l-t)*i;break;case h_.first:case h_.replace:t=Math.abs(a.scaleX)*C_.signum(l),a.scaleX=t+(l-t)*i;break;case h_.add:a.scaleX+=(l-a.data.scaleX)*i}}}}class db extends ib{constructor(t,e,n){super(t,e,`4|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case h_.setup:return void(a.scaleY=a.data.scaleY);case h_.first:a.scaleY+=(a.data.scaleY-a.scaleY)*i}return}const l=this.getCurveValue(n)*a.data.scaleY;if(1==i)s==h_.add?a.scaleY+=l-a.data.scaleY:a.scaleY=l;else{let t=0;if(o==c_.mixOut)switch(s){case h_.setup:t=a.data.scaleY,a.scaleY=t+(Math.abs(l)*C_.signum(t)-t)*i;break;case h_.first:case h_.replace:t=a.scaleY,a.scaleY=t+(Math.abs(l)*C_.signum(t)-t)*i;break;case h_.add:a.scaleY+=(l-a.data.scaleY)*i}else switch(s){case h_.setup:t=Math.abs(a.data.scaleY)*C_.signum(l),a.scaleY=t+(l-t)*i;break;case h_.first:case h_.replace:t=Math.abs(a.scaleY)*C_.signum(l),a.scaleY=t+(l-t)*i;break;case h_.add:a.scaleY+=(l-a.data.scaleY)*i}}}}class fb extends sb{constructor(t,e,n){super(t,e,`5|${n}`,`6|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case h_.setup:return a.shearX=a.data.shearX,void(a.shearY=a.data.shearY);case h_.first:a.shearX+=(a.data.shearX-a.shearX)*i,a.shearY+=(a.data.shearY-a.shearY)*i}return}let h=0,c=0;const u=nb.search(l,n,3),d=this.curves[u/3];switch(d){case 0:const t=l[u];h=l[u+1],c=l[u+2];const e=(n-t)/(l[u+3]-t);h+=(l[u+3+1]-h)*e,c+=(l[u+3+2]-c)*e;break;case 1:h=l[u+1],c=l[u+2];break;default:h=this.getBezierValue(n,u,1,d-2),c=this.getBezierValue(n,u,2,d+18-2)}switch(s){case h_.setup:a.shearX=a.data.shearX+h*i,a.shearY=a.data.shearY+c*i;break;case h_.first:case h_.replace:a.shearX+=(a.data.shearX+h-a.shearX)*i,a.shearY+=(a.data.shearY+c-a.shearY)*i;break;case h_.add:a.shearX+=h*i,a.shearY+=c*i}}}class pb extends ib{constructor(t,e,n){super(t,e,`5|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case h_.setup:return void(a.shearX=a.data.shearX);case h_.first:a.shearX+=(a.data.shearX-a.shearX)*i}return}const l=this.getCurveValue(n);switch(s){case h_.setup:a.shearX=a.data.shearX+l*i;break;case h_.first:case h_.replace:a.shearX+=(a.data.shearX+l-a.shearX)*i;break;case h_.add:a.shearX+=l*i}}}class mb extends ib{constructor(t,e,n){super(t,e,`6|${n}`),this.boneIndex=0,this.boneIndex=n}apply(t,e,n,r,i,s,o){const a=t.bones[this.boneIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case h_.setup:return void(a.shearY=a.data.shearY);case h_.first:a.shearY+=(a.data.shearY-a.shearY)*i}return}const l=this.getCurveValue(n);switch(s){case h_.setup:a.shearY=a.data.shearY+l*i;break;case h_.first:case h_.replace:a.shearY+=(a.data.shearY+l-a.shearY)*i;break;case h_.add:a.shearY+=l*i}}}class gb extends rb{constructor(t,e,n){super(t,e,[`7|${n}`,`8|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 5}setFrame(t,e,n,r,i,s){t*=5,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=s}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=this.frames,h=a.color;if(n<l[0]){const t=a.data.color;switch(s){case h_.setup:return void h.setFromColor(t);case h_.first:h.add((t.r-h.r)*i,(t.g-h.g)*i,(t.b-h.b)*i,(t.a-h.a)*i)}return}let c=0,u=0,d=0,f=0;const p=nb.search(l,n,5),m=this.curves[p/5];switch(m){case 0:const t=l[p];c=l[p+1],u=l[p+2],d=l[p+3],f=l[p+4];const e=(n-t)/(l[p+5]-t);c+=(l[p+5+1]-c)*e,u+=(l[p+5+2]-u)*e,d+=(l[p+5+3]-d)*e,f+=(l[p+5+4]-f)*e;break;case 1:c=l[p+1],u=l[p+2],d=l[p+3],f=l[p+4];break;default:c=this.getBezierValue(n,p,1,m-2),u=this.getBezierValue(n,p,2,m+18-2),d=this.getBezierValue(n,p,3,m+36-2),f=this.getBezierValue(n,p,4,m+54-2)}1==i?h.set(c,u,d,f):(s==h_.setup&&h.setFromColor(a.data.color),h.add((c-h.r)*i,(u-h.g)*i,(d-h.b)*i,(f-h.a)*i))}}class vb extends rb{constructor(t,e,n){super(t,e,[`7|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 4}setFrame(t,e,n,r,i){t<<=2,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=this.frames,h=a.color;if(n<l[0]){const t=a.data.color;switch(s){case h_.setup:return h.r=t.r,h.g=t.g,void(h.b=t.b);case h_.first:h.r+=(t.r-h.r)*i,h.g+=(t.g-h.g)*i,h.b+=(t.b-h.b)*i}return}let c=0,u=0,d=0;const f=nb.search(l,n,4),p=this.curves[f>>2];switch(p){case 0:const t=l[f];c=l[f+1],u=l[f+2],d=l[f+3];const e=(n-t)/(l[f+4]-t);c+=(l[f+4+1]-c)*e,u+=(l[f+4+2]-u)*e,d+=(l[f+4+3]-d)*e;break;case 1:c=l[f+1],u=l[f+2],d=l[f+3];break;default:c=this.getBezierValue(n,f,1,p-2),u=this.getBezierValue(n,f,2,p+18-2),d=this.getBezierValue(n,f,3,p+36-2)}if(1==i)h.r=c,h.g=u,h.b=d;else{if(s==h_.setup){const t=a.data.color;h.r=t.r,h.g=t.g,h.b=t.b}h.r+=(c-h.r)*i,h.g+=(u-h.g)*i,h.b+=(d-h.b)*i}}}class yb extends ib{constructor(t,e,n){super(t,e,`8|${n}`),this.slotIndex=0,this.slotIndex=n}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=a.color;if(n<this.frames[0]){const t=a.data.color;switch(s){case h_.setup:return void(l.a=t.a);case h_.first:l.a+=(t.a-l.a)*i}return}const h=this.getCurveValue(n);1==i?l.a=h:(s==h_.setup&&(l.a=a.data.color.a),l.a+=(h-l.a)*i)}}class xb extends rb{constructor(t,e,n){super(t,e,[`7|${n}`,`8|${n}`,`9|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 8}setFrame(t,e,n,r,i,s,o,a,l){t<<=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=s,this.frames[t+5]=o,this.frames[t+6]=a,this.frames[t+7]=l}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=this.frames,h=a.color,c=a.darkColor;if(n<l[0]){const t=a.data.color,e=a.data.darkColor;switch(s){case h_.setup:return h.setFromColor(t),c.r=e.r,c.g=e.g,void(c.b=e.b);case h_.first:h.add((t.r-h.r)*i,(t.g-h.g)*i,(t.b-h.b)*i,(t.a-h.a)*i),c.r+=(e.r-c.r)*i,c.g+=(e.g-c.g)*i,c.b+=(e.b-c.b)*i}return}let u=0,d=0,f=0,p=0,m=0,g=0,v=0;const y=nb.search(l,n,8),x=this.curves[y>>3];switch(x){case 0:const t=l[y];u=l[y+1],d=l[y+2],f=l[y+3],p=l[y+4],m=l[y+5],g=l[y+6],v=l[y+7];const e=(n-t)/(l[y+8]-t);u+=(l[y+8+1]-u)*e,d+=(l[y+8+2]-d)*e,f+=(l[y+8+3]-f)*e,p+=(l[y+8+4]-p)*e,m+=(l[y+8+5]-m)*e,g+=(l[y+8+6]-g)*e,v+=(l[y+8+7]-v)*e;break;case 1:u=l[y+1],d=l[y+2],f=l[y+3],p=l[y+4],m=l[y+5],g=l[y+6],v=l[y+7];break;default:u=this.getBezierValue(n,y,1,x-2),d=this.getBezierValue(n,y,2,x+18-2),f=this.getBezierValue(n,y,3,x+36-2),p=this.getBezierValue(n,y,4,x+54-2),m=this.getBezierValue(n,y,5,x+72-2),g=this.getBezierValue(n,y,6,x+90-2),v=this.getBezierValue(n,y,7,x+108-2)}if(1==i)h.set(u,d,f,p),c.r=m,c.g=g,c.b=v;else{if(s==h_.setup){h.setFromColor(a.data.color);const t=a.data.darkColor;c.r=t.r,c.g=t.g,c.b=t.b}h.add((u-h.r)*i,(d-h.g)*i,(f-h.b)*i,(p-h.a)*i),c.r+=(m-c.r)*i,c.g+=(g-c.g)*i,c.b+=(v-c.b)*i}}}class wb extends rb{constructor(t,e,n){super(t,e,[`7|${n}`,`9|${n}`]),this.slotIndex=0,this.slotIndex=n}getFrameEntries(){return 7}setFrame(t,e,n,r,i,s,o,a){t*=7,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=s,this.frames[t+5]=o,this.frames[t+6]=a}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=this.frames,h=a.color,c=a.darkColor;if(n<l[0]){const t=a.data.color,e=a.data.darkColor;switch(s){case h_.setup:return h.r=t.r,h.g=t.g,h.b=t.b,c.r=e.r,c.g=e.g,void(c.b=e.b);case h_.first:h.r+=(t.r-h.r)*i,h.g+=(t.g-h.g)*i,h.b+=(t.b-h.b)*i,c.r+=(e.r-c.r)*i,c.g+=(e.g-c.g)*i,c.b+=(e.b-c.b)*i}return}let u=0,d=0,f=0,p=0,m=0,g=0;const v=nb.search(l,n,7),y=this.curves[v/7];switch(y){case 0:const t=l[v];u=l[v+1],d=l[v+2],f=l[v+3],p=l[v+4],m=l[v+5],g=l[v+6];const e=(n-t)/(l[v+7]-t);u+=(l[v+7+1]-u)*e,d+=(l[v+7+2]-d)*e,f+=(l[v+7+3]-f)*e,p+=(l[v+7+4]-p)*e,m+=(l[v+7+5]-m)*e,g+=(l[v+7+6]-g)*e;break;case 1:u=l[v+1],d=l[v+2],f=l[v+3],p=l[v+4],m=l[v+5],g=l[v+6];break;default:u=this.getBezierValue(n,v,1,y-2),d=this.getBezierValue(n,v,2,y+18-2),f=this.getBezierValue(n,v,3,y+36-2),p=this.getBezierValue(n,v,4,y+54-2),m=this.getBezierValue(n,v,5,y+72-2),g=this.getBezierValue(n,v,6,y+90-2)}if(1==i)h.r=u,h.g=d,h.b=f,c.r=p,c.g=m,c.b=g;else{if(s==h_.setup){const t=a.data.color,e=a.data.darkColor;h.r=t.r,h.g=t.g,h.b=t.b,c.r=e.r,c.g=e.g,c.b=e.b}h.r+=(u-h.r)*i,h.g+=(d-h.g)*i,h.b+=(f-h.b)*i,c.r+=(p-c.r)*i,c.g+=(m-c.g)*i,c.b+=(g-c.b)*i}}}class _b extends nb{constructor(t,e){super(t,[`10|${e}`]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];a.bone.active&&(o!=c_.mixOut?n<this.frames[0]?s!=h_.setup&&s!=h_.first||this.setAttachment(t,a,a.data.attachmentName):this.setAttachment(t,a,this.attachmentNames[nb.search1(this.frames,n)]):s==h_.setup&&this.setAttachment(t,a,a.data.attachmentName))}setAttachment(t,e,n){e.setAttachment(n?t.getAttachment(this.slotIndex,n):null)}}class bb extends rb{constructor(t,e,n,r){super(t,e,[`11|${n}|${r.id}`]),this.slotIndex=0,this.slotIndex=n,this.attachment=r,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.vertices[t]=n}setBezier(t,e,n,r,i,s,o,a,l,h,c){const u=this.curves;let d=this.getFrameCount()+18*t;0==n&&(u[e]=2+d);const f=.03*(r-2*s+a),p=.03*l-.06*o,m=.006*(3*(s-a)-r+h),g=.018*(o-l+.33333333);let v=2*f+m,y=2*p+g,x=.3*(s-r)+f+.16666667*m,w=.3*o+p+.16666667*g,_=r+x,b=w;for(let t=d+18;d<t;d+=2)u[d]=_,u[d+1]=b,x+=v,w+=y,v+=m,y+=g,_+=x,b+=w}getCurvePercent(t,e){const n=this.curves;let r=n[e];switch(r){case 0:const n=this.frames[e];return(t-n)/(this.frames[e+this.getFrameEntries()]-n);case 1:return 0}if(r-=2,n[r]>t){const i=this.frames[e];return n[r+1]*(t-i)/(n[r]-i)}const i=r+18;for(r+=2;r<i;r+=2)if(n[r]>=t){const e=n[r-2],i=n[r-1];return i+(t-e)/(n[r]-e)*(n[r+1]-i)}const s=n[i-2],o=n[i-1];return o+(1-o)*(t-s)/(this.frames[e+this.getFrameEntries()]-s)}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=a.getAttachment();if(!l)return;if(!(l instanceof z_)||l.timelineAttachment!=this.attachment)return;const h=a.deform;0==h.length&&(s=h_.setup);const c=this.vertices,u=c[0].length,d=this.frames;if(n<d[0]){switch(s){case h_.setup:return void(h.length=0);case h_.first:if(1==i)return void(h.length=0);h.length=u;const t=l;if(t.bones){i=1-i;for(let t=0;t<u;t++)h[t]*=i}else{const e=t.vertices;for(let t=0;t<u;t++)h[t]+=(e[t]-h[t])*i}}return}if(h.length=u,n>=d[d.length-1]){const t=c[d.length-1];if(1==i)if(s==h_.add){const e=l;if(e.bones)for(let e=0;e<u;e++)h[e]+=t[e];else{const n=e.vertices;for(let e=0;e<u;e++)h[e]+=t[e]-n[e]}}else M_.arrayCopy(t,0,h,0,u);else switch(s){case h_.setup:{const e=l;if(e.bones)for(let e=0;e<u;e++)h[e]=t[e]*i;else{const n=e.vertices;for(let e=0;e<u;e++){const r=n[e];h[e]=r+(t[e]-r)*i}}break}case h_.first:case h_.replace:for(let e=0;e<u;e++)h[e]+=(t[e]-h[e])*i;break;case h_.add:const e=l;if(e.bones)for(let e=0;e<u;e++)h[e]+=t[e]*i;else{const n=e.vertices;for(let e=0;e<u;e++)h[e]+=(t[e]-n[e])*i}}return}const f=nb.search1(d,n),p=this.getCurvePercent(n,f),m=c[f],g=c[f+1];if(1==i)if(s==h_.add){const t=l;if(t.bones)for(let t=0;t<u;t++){const e=m[t];h[t]+=e+(g[t]-e)*p}else{const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];h[t]+=n+(g[t]-n)*p-e[t]}}}else for(let t=0;t<u;t++){const e=m[t];h[t]=e+(g[t]-e)*p}else switch(s){case h_.setup:{const t=l;if(t.bones)for(let t=0;t<u;t++){const e=m[t];h[t]=(e+(g[t]-e)*p)*i}else{const e=t.vertices;for(let t=0;t<u;t++){const n=m[t],r=e[t];h[t]=r+(n+(g[t]-n)*p-r)*i}}break}case h_.first:case h_.replace:for(let t=0;t<u;t++){const e=m[t];h[t]+=(e+(g[t]-e)*p-h[t])*i}break;case h_.add:const t=l;if(t.bones)for(let t=0;t<u;t++){const e=m[t];h[t]+=(e+(g[t]-e)*p)*i}else{const e=t.vertices;for(let t=0;t<u;t++){const n=m[t];h[t]+=(n+(g[t]-n)*p-e[t])*i}}}}}const Tb=class extends nb{constructor(t){super(t,Tb.propertyIds),this.events=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,n,r,i,s,o){if(!r)return;const a=this.frames,l=this.frames.length;if(e>n)this.apply(t,e,Number.MAX_VALUE,r,i,s,o),e=-1;else if(e>=a[l-1])return;if(n<a[0])return;let h=0;if(e<a[0])h=0;else{h=nb.search1(a,e)+1;const t=a[h];for(;h>0&&a[h-1]==t;)h--}for(;h<l&&n>=a[h];h++)r.push(this.events[h])}};let Sb=Tb;Sb.propertyIds=["12"];const Ab=class extends nb{constructor(t){super(t,Ab.propertyIds),this.drawOrders=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,n){this.frames[t]=e,this.drawOrders[t]=n}apply(t,e,n,r,i,s,o){if(o==c_.mixOut)return void(s==h_.setup&&M_.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));if(n<this.frames[0])return void(s!=h_.setup&&s!=h_.first||M_.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));const a=nb.search1(this.frames,n),l=this.drawOrders[a];if(l){const e=t.drawOrder,n=t.slots;for(let t=0,r=l.length;t<r;t++)e[t]=n[l[t]]}else M_.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length)}};let Eb=Ab;Eb.propertyIds=["13"];class Cb extends rb{constructor(t,e,n){super(t,e,[`14|${n}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=n}getFrameEntries(){return 6}setFrame(t,e,n,r,i,s,o){t*=6,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=s?1:0,this.frames[t+5]=o?1:0}apply(t,e,n,r,i,s,o){const a=t.ikConstraints[this.ikConstraintIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case h_.setup:return a.mix=a.data.mix,a.softness=a.data.softness,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,void(a.stretch=a.data.stretch);case h_.first:a.mix+=(a.data.mix-a.mix)*i,a.softness+=(a.data.softness-a.softness)*i,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}return}let h=0,c=0;const u=nb.search(l,n,6),d=this.curves[u/6];switch(d){case 0:const t=l[u];h=l[u+1],c=l[u+2];const e=(n-t)/(l[u+6]-t);h+=(l[u+6+1]-h)*e,c+=(l[u+6+2]-c)*e;break;case 1:h=l[u+1],c=l[u+2];break;default:h=this.getBezierValue(n,u,1,d-2),c=this.getBezierValue(n,u,2,d+18-2)}s==h_.setup?(a.mix=a.data.mix+(h-a.data.mix)*i,a.softness=a.data.softness+(c-a.data.softness)*i,o==c_.mixOut?(a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch):(a.bendDirection=l[u+3],a.compress=0!=l[u+4],a.stretch=0!=l[u+5])):(a.mix+=(h-a.mix)*i,a.softness+=(c-a.softness)*i,o==c_.mixIn&&(a.bendDirection=l[u+3],a.compress=0!=l[u+4],a.stretch=0!=l[u+5]))}}class kb extends rb{constructor(t,e,n){super(t,e,[`15|${n}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=n}getFrameEntries(){return 7}setFrame(t,e,n,r,i,s,o,a){const l=this.frames;l[t*=7]=e,l[t+1]=n,l[t+2]=r,l[t+3]=i,l[t+4]=s,l[t+5]=o,l[t+6]=a}apply(t,e,n,r,i,s,o){const a=t.transformConstraints[this.transformConstraintIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){const t=a.data;switch(s){case h_.setup:return a.mixRotate=t.mixRotate,a.mixX=t.mixX,a.mixY=t.mixY,a.mixScaleX=t.mixScaleX,a.mixScaleY=t.mixScaleY,void(a.mixShearY=t.mixShearY);case h_.first:a.mixRotate+=(t.mixRotate-a.mixRotate)*i,a.mixX+=(t.mixX-a.mixX)*i,a.mixY+=(t.mixY-a.mixY)*i,a.mixScaleX+=(t.mixScaleX-a.mixScaleX)*i,a.mixScaleY+=(t.mixScaleY-a.mixScaleY)*i,a.mixShearY+=(t.mixShearY-a.mixShearY)*i}return}let h,c,u,d,f,p;const m=nb.search(l,n,7),g=this.curves[m/7];switch(g){case 0:const t=l[m];h=l[m+1],c=l[m+2],u=l[m+3],d=l[m+4],f=l[m+5],p=l[m+6];const e=(n-t)/(l[m+7]-t);h+=(l[m+7+1]-h)*e,c+=(l[m+7+2]-c)*e,u+=(l[m+7+3]-u)*e,d+=(l[m+7+4]-d)*e,f+=(l[m+7+5]-f)*e,p+=(l[m+7+6]-p)*e;break;case 1:h=l[m+1],c=l[m+2],u=l[m+3],d=l[m+4],f=l[m+5],p=l[m+6];break;default:h=this.getBezierValue(n,m,1,g-2),c=this.getBezierValue(n,m,2,g+18-2),u=this.getBezierValue(n,m,3,g+36-2),d=this.getBezierValue(n,m,4,g+54-2),f=this.getBezierValue(n,m,5,g+72-2),p=this.getBezierValue(n,m,6,g+90-2)}if(s==h_.setup){const t=a.data;a.mixRotate=t.mixRotate+(h-t.mixRotate)*i,a.mixX=t.mixX+(c-t.mixX)*i,a.mixY=t.mixY+(u-t.mixY)*i,a.mixScaleX=t.mixScaleX+(d-t.mixScaleX)*i,a.mixScaleY=t.mixScaleY+(f-t.mixScaleY)*i,a.mixShearY=t.mixShearY+(p-t.mixShearY)*i}else a.mixRotate+=(h-a.mixRotate)*i,a.mixX+=(c-a.mixX)*i,a.mixY+=(u-a.mixY)*i,a.mixScaleX+=(d-a.mixScaleX)*i,a.mixScaleY+=(f-a.mixScaleY)*i,a.mixShearY+=(p-a.mixShearY)*i}}class Mb extends ib{constructor(t,e,n){super(t,e,`16|${n}`),this.pathConstraintIndex=0,this.pathConstraintIndex=n}apply(t,e,n,r,i,s,o){const a=t.pathConstraints[this.pathConstraintIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case h_.setup:return void(a.position=a.data.position);case h_.first:a.position+=(a.data.position-a.position)*i}return}const l=this.getCurveValue(n);s==h_.setup?a.position=a.data.position+(l-a.data.position)*i:a.position+=(l-a.position)*i}}class Pb extends ib{constructor(t,e,n){super(t,e,`17|${n}`),this.pathConstraintIndex=0,this.pathConstraintIndex=n}apply(t,e,n,r,i,s,o){const a=t.pathConstraints[this.pathConstraintIndex];if(!a.active)return;if(n<this.frames[0]){switch(s){case h_.setup:return void(a.spacing=a.data.spacing);case h_.first:a.spacing+=(a.data.spacing-a.spacing)*i}return}const l=this.getCurveValue(n);s==h_.setup?a.spacing=a.data.spacing+(l-a.data.spacing)*i:a.spacing+=(l-a.spacing)*i}}class Ib extends rb{constructor(t,e,n){super(t,e,[`18|${n}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=n}getFrameEntries(){return 4}setFrame(t,e,n,r,i){const s=this.frames;s[t<<=2]=e,s[t+1]=n,s[t+2]=r,s[t+3]=i}apply(t,e,n,r,i,s,o){const a=t.pathConstraints[this.pathConstraintIndex];if(!a.active)return;const l=this.frames;if(n<l[0]){switch(s){case h_.setup:return a.mixRotate=a.data.mixRotate,a.mixX=a.data.mixX,void(a.mixY=a.data.mixY);case h_.first:a.mixRotate+=(a.data.mixRotate-a.mixRotate)*i,a.mixX+=(a.data.mixX-a.mixX)*i,a.mixY+=(a.data.mixY-a.mixY)*i}return}let h,c,u;const d=nb.search(l,n,4),f=this.curves[d>>2];switch(f){case 0:const t=l[d];h=l[d+1],c=l[d+2],u=l[d+3];const e=(n-t)/(l[d+4]-t);h+=(l[d+4+1]-h)*e,c+=(l[d+4+2]-c)*e,u+=(l[d+4+3]-u)*e;break;case 1:h=l[d+1],c=l[d+2],u=l[d+3];break;default:h=this.getBezierValue(n,d,1,f-2),c=this.getBezierValue(n,d,2,f+18-2),u=this.getBezierValue(n,d,3,f+36-2)}if(s==h_.setup){const t=a.data;a.mixRotate=t.mixRotate+(h-t.mixRotate)*i,a.mixX=t.mixX+(c-t.mixX)*i,a.mixY=t.mixY+(u-t.mixY)*i}else a.mixRotate+=(h-a.mixRotate)*i,a.mixX+=(c-a.mixX)*i,a.mixY+=(u-a.mixY)*i}}const Rb=class extends nb{constructor(t,e,n){super(t,[`19|${e}|${n.sequence.id}`]),this.slotIndex=e,this.attachment=n}getFrameEntries(){return Rb.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(t,e,n,r,i){const s=this.frames;s[t*=Rb.ENTRIES]=e,s[t+Rb.MODE]=n|r<<4,s[t+Rb.DELAY]=i}apply(t,e,n,r,i,s,o){const a=t.slots[this.slotIndex];if(!a.bone.active)return;const l=a.attachment,h=this.attachment;if(!(l==h||l instanceof z_&&l.timelineAttachment==h))return;const c=this.frames;if(n<c[0])return void(s!=h_.setup&&s!=h_.first||(a.sequenceIndex=-1));const u=nb.search(c,n,Rb.ENTRIES),d=c[u],f=c[u+Rb.MODE],p=c[u+Rb.DELAY];if(!this.attachment.sequence)return;let m=f>>4;const g=this.attachment.sequence.regions.length,v=tb[15&f];if(v!=J_.hold)switch(m+=(n-d)/p+1e-5|0,v){case J_.once:m=Math.min(g-1,m);break;case J_.loop:m%=g;break;case J_.pingpong:{const t=(g<<1)-2;m=0==t?0:m%t,m>=g&&(m=t-m);break}case J_.onceReverse:m=Math.max(g-1-m,0);break;case J_.loopReverse:m=g-1-m%g;break;case J_.pingpongReverse:{const t=(g<<1)-2;m=0==t?0:(m+g-1)%t,m>=g&&(m=t-m)}}a.sequenceIndex=m}};let Ob=Rb;Ob.ENTRIES=3,Ob.MODE=1,Ob.DELAY=2;const Lb=class{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Bb(this),this.propertyIDs=new T_,this.animationsChanged=!1,this.trackEntryPool=new P_((()=>new Nb)),this.data=t}static emptyAnimation(){return Lb._emptyAnimation}update(t){t*=this.timeScale;const e=this.tracks;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(!r)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let i=t*r.timeScale;if(r.delay>0){if(r.delay-=i,r.delay>0)continue;i=-r.delay,r.delay=0}let s=r.next;if(s){const e=r.trackLast-s.delay;if(e>=0){for(s.delay=0,s.trackTime+=0==r.timeScale?0:(e/r.timeScale+t)*s.timeScale,r.trackTime+=i,this.setCurrent(n,s,!0);s.mixingFrom;)s.mixTime+=t,s=s.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&!r.mixingFrom){e[n]=null,this.queue.end(r),this.clearNext(r);continue}if(r.mixingFrom&&this.updateMixingFrom(r,t)){let t=r.mixingFrom;for(r.mixingFrom=null,t&&(t.mixingTo=null);t;)this.queue.end(t),t=t.mixingFrom}r.trackTime+=i}this.queue.drain()}updateMixingFrom(t,e){const n=t.mixingFrom;if(!n)return!0;const r=this.updateMixingFrom(n,e);return n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,n.mixingFrom&&(n.mixingFrom.mixingTo=t),t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),r):(n.trackTime+=e*n.timeScale,t.mixTime+=e,!1)}apply(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,n=this.tracks;let r=!1;for(let i=0,s=n.length;i<s;i++){const s=n[i];if(!s||s.delay>0)continue;r=!0;const o=0==i?h_.first:s.mixBlend;let a=s.alpha;s.mixingFrom?a*=this.applyMixingFrom(s,t,o):s.trackTime>=s.trackEnd&&!s.next&&(a=0);const l=s.animationLast,h=s.getAnimationTime();let c=h,u=e;s.reverse&&(c=s.animation.duration-c,u=null);const d=s.animation.timelines,f=d.length;if(0==i&&1==a||o==h_.add)for(let e=0;e<f;e++){M_.webkit602BugfixHelper(a,o);const n=d[e];n instanceof _b?this.applyAttachmentTimeline(n,t,c,o,!0):n.apply(t,l,c,u,a,o,c_.mixIn)}else{const e=s.timelineMode,n=s.shortestRotation,r=!n&&s.timelinesRotation.length!=f<<1;r&&(s.timelinesRotation.length=f<<1);for(let i=0;i<f;i++){const h=d[i],f=e[i]==Ub?o:h_.setup;!n&&h instanceof ob?this.applyRotateTimeline(h,t,c,a,f,s.timelinesRotation,i<<1,r):h instanceof _b?this.applyAttachmentTimeline(h,t,c,o,!0):(M_.webkit602BugfixHelper(a,o),h.apply(t,l,c,u,a,f,c_.mixIn))}}this.queueEvents(s,h),e.length=0,s.nextAnimationLast=h,s.nextTrackLast=s.trackTime}const i=this.unkeyedState+Vb,s=t.slots;for(let e=0,n=t.slots.length;e<n;e++){const n=s[e];if(n.attachmentState==i){const e=n.data.attachmentName;n.setAttachment(e?t.getAttachment(n.data.index,e):null)}}return this.unkeyedState+=2,this.queue.drain(),r}applyMixingFrom(t,e,n){const r=t.mixingFrom;r.mixingFrom&&this.applyMixingFrom(r,e,n);let i=0;0==t.mixDuration?(i=1,n==h_.first&&(n=h_.setup)):(i=t.mixTime/t.mixDuration,i>1&&(i=1),n!=h_.first&&(n=r.mixBlend));const s=i<r.attachmentThreshold,o=i<r.drawOrderThreshold,a=r.animation.timelines,l=a.length,h=r.alpha*t.interruptAlpha,c=h*(1-i),u=r.animationLast,d=r.getAnimationTime();let f=d,p=null;if(r.reverse?f=r.animation.duration-f:i<r.eventThreshold&&(p=this.events),n==h_.add)for(let t=0;t<l;t++)a[t].apply(e,u,f,p,c,n,c_.mixOut);else{const t=r.timelineMode,i=r.timelineHoldMix,d=r.shortestRotation,m=!d&&r.timelinesRotation.length!=l<<1;m&&(r.timelinesRotation.length=l<<1),r.totalAlpha=0;for(let g=0;g<l;g++){const l=a[g];let v,y=c_.mixOut,x=0;switch(t[g]){case Ub:if(!o&&l instanceof Eb)continue;v=n,x=c;break;case jb:v=h_.setup,x=c;break;case Hb:v=n,x=h;break;case zb:v=h_.setup,x=h;break;default:v=h_.setup;const t=i[g];x=h*Math.max(0,1-t.mixTime/t.mixDuration)}r.totalAlpha+=x,!d&&l instanceof ob?this.applyRotateTimeline(l,e,f,x,v,r.timelinesRotation,g<<1,m):l instanceof _b?this.applyAttachmentTimeline(l,e,f,v,s):(M_.webkit602BugfixHelper(x,n),o&&l instanceof Eb&&v==h_.setup&&(y=c_.mixIn),l.apply(e,u,f,p,x,v,y))}}return t.mixDuration>0&&this.queueEvents(r,d),this.events.length=0,r.nextAnimationLast=d,r.nextTrackLast=r.trackTime,i}applyAttachmentTimeline(t,e,n,r,i){const s=e.slots[t.slotIndex];s.bone.active&&(n<t.frames[0]?r!=h_.setup&&r!=h_.first||this.setAttachment(e,s,s.data.attachmentName,i):this.setAttachment(e,s,t.attachmentNames[nb.search1(t.frames,n)],i),s.attachmentState<=this.unkeyedState&&(s.attachmentState=this.unkeyedState+Vb))}setAttachment(t,e,n,r){e.setAttachment(n?t.getAttachment(e.data.index,n):null),r&&(e.attachmentState=this.unkeyedState+Xb)}applyRotateTimeline(t,e,n,r,i,s,o,a){if(a&&(s[o]=0),1==r)return void t.apply(e,0,n,null,1,i,c_.mixIn);const l=e.bones[t.boneIndex];if(!l.active)return;let h=0,c=0;if(n<t.frames[0])switch(i){case h_.setup:l.rotation=l.data.rotation;default:return;case h_.first:h=l.rotation,c=l.data.rotation}else h=i==h_.setup?l.data.rotation:l.rotation,c=l.data.rotation+t.getCurveValue(n);let u=0,d=c-h;if(d-=360*(16384-(16384.499999999996-d/360|0)),0==d)u=s[o];else{let t=0,e=0;a?(t=0,e=d):(t=s[o],e=s[o+1]);const n=d>0;let r=t>=0;C_.signum(e)!=C_.signum(d)&&Math.abs(e)<=90&&(Math.abs(t)>180&&(t+=360*C_.signum(t)),r=n),u=d+t-t%360,r!=n&&(u+=360*C_.signum(t)),s[o]=u}s[o+1]=d,l.rotation=h+u*r}queueEvents(t,e){const n=t.animationStart,r=t.animationEnd,i=r-n,s=t.trackLast%i,o=this.events;let a=0;const l=o.length;for(;a<l;a++){const e=o[a];if(e.time<s)break;e.time>r||this.queue.event(t,e)}let h=!1;for(h=t.loop?0==i||s>t.trackTime%i:e>=r&&t.animationLast<r,h&&this.queue.complete(t);a<l;a++){const e=o[a];e.time<n||this.queue.event(t,e)}}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(!e)return;this.queue.end(e),this.clearNext(e);let n=e;for(;;){const t=n.mixingFrom;if(!t)break;this.queue.end(t),n.mixingFrom=null,n.mixingTo=null,n=t}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,n){const r=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,r&&(n&&this.queue.interrupt(r),e.mixingFrom=r,r.mixingTo=e,e.mixTime=0,r.mixingFrom&&r.mixDuration>0&&(e.interruptAlpha*=Math.min(1,r.mixTime/r.mixDuration)),r.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,n=!1){const r=this.data.skeletonData.findAnimation(e);if(!r)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,r,n)}setAnimationWith(t,e,n=!1){if(!e)throw new Error("animation cannot be null.");let r=!0,i=this.expandToIndex(t);i&&(-1==i.nextTrackLast?(this.tracks[t]=i.mixingFrom,this.queue.interrupt(i),this.queue.end(i),this.clearNext(i),i=i.mixingFrom,r=!1):this.clearNext(i));const s=this.trackEntry(t,e,n,i);return this.setCurrent(t,s,r),this.queue.drain(),s}addAnimation(t,e,n=!1,r=0){const i=this.data.skeletonData.findAnimation(e);if(!i)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,i,n,r)}addAnimationWith(t,e,n=!1,r=0){if(!e)throw new Error("animation cannot be null.");let i=this.expandToIndex(t);if(i)for(;i.next;)i=i.next;const s=this.trackEntry(t,e,n,i);return i?(i.next=s,s.previous=i,r<=0&&(r+=i.getTrackComplete()-s.mixDuration)):(this.setCurrent(t,s,!0),this.queue.drain()),s.delay=r,s}setEmptyAnimation(t,e=0){const n=this.setAnimationWith(t,Lb.emptyAnimation(),!1);return n.mixDuration=e,n.trackEnd=e,n}addEmptyAnimation(t,e=0,n=0){const r=this.addAnimationWith(t,Lb.emptyAnimation(),!1,n);return n<=0&&(r.delay+=r.mixDuration-e),r.mixDuration=e,r.trackEnd=e,r}setEmptyAnimations(t=0){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,n=this.tracks.length;e<n;e++){const n=this.tracks[e];n&&this.setEmptyAnimation(n.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(M_.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,n,r){const i=this.trackEntryPool.obtain();return i.reset(),i.trackIndex=t,i.animation=e,i.loop=n,i.holdPrevious=!1,i.reverse=!1,i.shortestRotation=!1,i.eventThreshold=0,i.attachmentThreshold=0,i.drawOrderThreshold=0,i.animationStart=0,i.animationEnd=e.duration,i.animationLast=-1,i.nextAnimationLast=-1,i.delay=0,i.trackTime=0,i.trackLast=-1,i.nextTrackLast=-1,i.trackEnd=Number.MAX_VALUE,i.timeScale=1,i.alpha=1,i.mixTime=0,i.mixDuration=r?this.data.getMix(r.animation,e):0,i.interruptAlpha=1,i.totalAlpha=0,i.mixBlend=h_.replace,i}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();const t=this.tracks;for(let e=0,n=t.length;e<n;e++){let n=t[e];if(n){for(;n.mixingFrom;)n=n.mixingFrom;do{n.mixingTo&&n.mixBlend==h_.add||this.computeHold(n),n=n.mixingTo}while(n)}}}computeHold(t){const e=t.mixingTo,n=t.animation.timelines,r=t.animation.timelines.length,i=t.timelineMode;i.length=r;const s=t.timelineHoldMix;s.length=0;const o=this.propertyIDs;if(e&&e.holdPrevious)for(let t=0;t<r;t++)i[t]=o.addAll(n[t].getPropertyIds())?zb:Hb;else t:for(let a=0;a<r;a++){const r=n[a],l=r.getPropertyIds();if(o.addAll(l))if(!e||r instanceof _b||r instanceof Eb||r instanceof Sb||!e.animation.hasTimeline(l))i[a]=jb;else{for(let n=e.mixingTo;n;n=n.mixingTo)if(!n.animation.hasTimeline(l)){if(t.mixDuration>0){i[a]=Gb,s[a]=n;continue t}break}i[a]=zb}else i[a]=Ub}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,n){Lb.deprecatedWarning1||(Lb.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,n)}addAnimationByName(t,e,n,r){Lb.deprecatedWarning2||(Lb.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,n,r)}hasAnimation(t){return null!==this.data.skeletonData.findAnimation(t)}hasAnimationByName(t){return Lb.deprecatedWarning3||(Lb.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let Db=Lb;Db._emptyAnimation=new eb("<empty>",[],0),Db.deprecatedWarning1=!1,Db.deprecatedWarning2=!1,Db.deprecatedWarning3=!1;const Fb=class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=h_.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){const t=this.animationEnd-this.animationStart;if(0!=t){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}get time(){return Fb.deprecatedWarning1||(Fb.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){Fb.deprecatedWarning1||(Fb.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return Fb.deprecatedWarning2||(Fb.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){Fb.deprecatedWarning2||(Fb.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let Nb=Fb;Nb.deprecatedWarning1=!1,Nb.deprecatedWarning2=!1;class Bb{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(Wb.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(Wb.interrupt),this.objects.push(t)}end(t){this.objects.push(Wb.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(Wb.dispose),this.objects.push(t)}complete(t){this.objects.push(Wb.complete),this.objects.push(t)}event(t,e){this.objects.push(Wb.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let n=0;n<t.length;n+=2){const r=t[n],i=t[n+1];switch(r){case Wb.start:i.listener&&i.listener.start&&i.listener.start(i);for(let t=0;t<e.length;t++){const n=e[t];n.start&&n.start(i)}break;case Wb.interrupt:i.listener&&i.listener.interrupt&&i.listener.interrupt(i);for(let t=0;t<e.length;t++){const n=e[t];n.interrupt&&n.interrupt(i)}break;case Wb.end:i.listener&&i.listener.end&&i.listener.end(i);for(let t=0;t<e.length;t++){const n=e[t];n.end&&n.end(i)}case Wb.dispose:i.listener&&i.listener.dispose&&i.listener.dispose(i);for(let t=0;t<e.length;t++){const n=e[t];n.dispose&&n.dispose(i)}this.animState.trackEntryPool.free(i);break;case Wb.complete:i.listener&&i.listener.complete&&i.listener.complete(i);for(let t=0;t<e.length;t++){const n=e[t];n.complete&&n.complete(i)}break;case Wb.event:const r=t[2+n++];i.listener&&i.listener.event&&i.listener.event(i,r);for(let t=0;t<e.length;t++){const n=e[t];n.event&&n.event(i,r)}}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var Wb=(t=>(t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event",t))(Wb||{});const Ub=0,jb=1,Hb=2,zb=3,Gb=4,Vb=1,Xb=2;class Yb{constructor(t){this.atlas=t}loadSequence(t,e,n){const r=n.regions;for(let i=0,s=r.length;i<s;i++){const s=n.getPath(e,i),o=this.atlas.findRegion(s);if(null==o)throw new Error(`Region not found in atlas: ${s} (sequence: ${t})`);r[i]=o,r[i].renderObject=r[i]}}newRegionAttachment(t,e,n,r){const i=new K_(e,n);if(null!=r)this.loadSequence(e,n,r);else{const t=this.atlas.findRegion(n);if(!t)throw new Error(`Region not found in atlas: ${n} (region attachment: ${e})`);t.renderObject=t,i.region=t}return i}newMeshAttachment(t,e,n,r){const i=new X_(e,n);if(null!=r)this.loadSequence(e,n,r);else{const t=this.atlas.findRegion(n);if(!t)throw new Error(`Region not found in atlas: ${n} (mesh attachment: ${e})`);t.renderObject=t,i.region=t}return i}newBoundingBoxAttachment(t,e){return new G_(e)}newPathAttachment(t,e){return new Y_(e)}newPointAttachment(t,e){return new $_(e)}newClippingAttachment(t,e){return new V_(e)}}class $b{constructor(t,e,n){if(this.matrix=new bn,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,n,r,i,s,o){this.ax=t,this.ay=e,this.arotation=n,this.ascaleX=r,this.ascaleY=i,this.ashearX=s,this.ashearY=o;const a=this.parent,l=this.matrix,h=this.skeleton.scaleX,c=-this.skeleton.scaleY;if(!a){const a=this.skeleton,u=n+90+o;return l.a=C_.cosDeg(n+s)*r*h,l.c=C_.cosDeg(u)*i*h,l.b=C_.sinDeg(n+s)*r*c,l.d=C_.sinDeg(u)*i*c,l.tx=t*h+a.x,void(l.ty=e*c+a.y)}let u=a.matrix.a,d=a.matrix.c,f=a.matrix.b,p=a.matrix.d;switch(l.tx=u*t+d*e+a.matrix.tx,l.ty=f*t+p*e+a.matrix.ty,this.data.transformMode){case f_.Normal:{const t=n+90+o,e=C_.cosDeg(n+s)*r,a=C_.cosDeg(t)*i,h=C_.sinDeg(n+s)*r,c=C_.sinDeg(t)*i;return l.a=u*e+d*h,l.c=u*a+d*c,l.b=f*e+p*h,void(l.d=f*a+p*c)}case f_.OnlyTranslation:{const t=n+90+o;l.a=C_.cosDeg(n+s)*r,l.c=C_.cosDeg(t)*i,l.b=C_.sinDeg(n+s)*r,l.d=C_.sinDeg(t)*i;break}case f_.NoRotationOrReflection:{let t=u*u+f*f,e=0;t>1e-4?(t=Math.abs(u*p-d*f)/t,u/=h,f/=c,d=f*t,p=u*t,e=Math.atan2(f,u)*C_.radDeg):(u=0,f=0,e=90-Math.atan2(p,d)*C_.radDeg);const a=n+s-e,m=n+o-e+90,g=C_.cosDeg(a)*r,v=C_.cosDeg(m)*i,y=C_.sinDeg(a)*r,x=C_.sinDeg(m)*i;l.a=u*g-d*y,l.c=u*v-d*x,l.b=f*g+p*y,l.d=f*v+p*x;break}case f_.NoScale:case f_.NoScaleOrReflection:{const t=C_.cosDeg(n),e=C_.sinDeg(n);let a=(u*t+d*e)/h,m=(f*t+p*e)/c,g=Math.sqrt(a*a+m*m);g>1e-5&&(g=1/g),a*=g,m*=g,g=Math.sqrt(a*a+m*m),this.data.transformMode==f_.NoScale&&u*p-d*f<0!=(h<0!=c<0)&&(g=-g);const v=Math.PI/2+Math.atan2(m,a),y=Math.cos(v)*g,x=Math.sin(v)*g,w=C_.cosDeg(s)*r,_=C_.cosDeg(90+o)*i,b=C_.sinDeg(s)*r,T=C_.sinDeg(90+o)*i;l.a=a*w+y*b,l.c=a*_+y*T,l.b=m*w+x*b,l.d=m*_+x*T;break}}l.a*=h,l.c*=h,l.b*=c,l.d*=c}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*C_.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*C_.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)}updateAppliedTransform(){const t=this.parent,e=this.matrix;if(!t)return this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*C_.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,void(this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*C_.radDeg);const n=t.matrix,r=1/(n.a*n.d-n.b*n.c),i=e.tx-n.tx,s=e.ty-n.ty;this.ax=i*n.d*r-s*n.c*r,this.ay=s*n.a*r-i*n.b*r;const o=r*n.d,a=r*n.a,l=r*n.c,h=r*n.b,c=o*e.a-l*e.b,u=o*e.c-l*e.d,d=a*e.b-h*e.a,f=a*e.d-h*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(c*c+d*d),this.ascaleX>1e-4){const t=c*f-u*d;this.ascaleY=t/this.ascaleX,this.ashearY=Math.atan2(c*u+d*f,t)*C_.radDeg,this.arotation=Math.atan2(d,c)*C_.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(u*u+f*f),this.ashearY=0,this.arotation=90-Math.atan2(f,u)*C_.radDeg}worldToLocal(t){const e=this.matrix,n=e.a,r=e.c,i=e.b,s=e.d,o=1/(n*s-r*i),a=t.x-e.tx,l=t.y-e.ty;return t.x=a*s*o-l*r*o,t.y=l*n*o-a*i*o,t}localToWorld(t){const e=this.matrix,n=t.x,r=t.y;return t.x=n*e.a+r*e.c+e.tx,t.y=n*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){const e=C_.sinDeg(t),n=C_.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*n,r.d*n-r.c*e)*C_.radDeg}localToWorldRotation(t){t-=this.rotation-this.shearX;const e=C_.sinDeg(t),n=C_.cosDeg(t),r=this.matrix;return Math.atan2(n*r.b+e*r.d,n*r.a+e*r.c)*C_.radDeg}rotateWorld(t){const e=this.matrix,n=e.a,r=e.c,i=e.b,s=e.d,o=C_.cosDeg(t),a=C_.sinDeg(t);e.a=o*n-a*i,e.c=o*r-a*s,e.b=a*n+o*i,e.d=a*r+o*s}}class qb{constructor(t,e,n){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=f_.Normal,this.skinRequired=!1,this.color=new A_,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=n}}class Kb{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let n=0;n<t.bones.length;n++){const r=e.findBone(t.bones[n].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[n].name}`);this.bones.push(r)}const n=e.findBone(t.target.name);if(!n)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=n}isActive(){return this.active}update(){if(0==this.mix)return;const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(t,e,n,r,i,s,o){const a=t.parent.matrix;if(!a)throw new Error("IK bone must have parent.");const l=a.a;let h=a.c;const c=a.b;let u=a.d,d=-t.ashearX-t.arotation,f=0,p=0;const m=t.skeleton.scaleX,g=-t.skeleton.scaleY;switch(t.data.transformMode){case f_.OnlyTranslation:f=e-t.worldX,p=n-t.worldY,p=-p;break;case f_.NoRotationOrReflection:const r=Math.abs(l*u-h*c)/(l*l+c*c),i=l/m,s=c/g;h=-s*r*m,u=i*r*g,d+=Math.atan2(s,i)*C_.radDeg;default:const o=e-a.tx,v=n-a.ty,y=l*u-h*c;f=(o*u-v*h)/y-t.ax,p=(v*l-o*c)/y-t.ay}d+=Math.atan2(p,f)*C_.radDeg,t.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);let v=t.ascaleX,y=t.ascaleY;if(r||i){switch(t.data.transformMode){case f_.NoScale:case f_.NoScaleOrReflection:f=e-t.worldX,p=n-t.worldY}const a=t.data.length*v,l=Math.sqrt(f*f+p*p);if(r&&l<a||i&&l>a&&a>1e-4){const t=(l/a-1)*o+1;v*=t,s&&(y*=t)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*o,v,y,t.ashearX,t.ashearY)}apply2(t,e,n,r,i,s,o,a,l){const h=t.ax,c=t.ay;let u=t.ascaleX,d=t.ascaleY,f=u,p=d,m=e.ascaleX;const g=t.matrix;let v=0,y=0,x=0;u<0?(u=-u,v=180,x=-1):(v=0,x=1),d<0&&(d=-d,x=-x),m<0?(m=-m,y=180):y=0;const w=e.ax;let _=0,b=0,T=0,S=g.a,A=g.c,E=g.b,C=g.d;const k=Math.abs(u-d)<=1e-4;!k||s?(_=0,b=S*w+g.tx,T=E*w+g.ty):(_=e.ay,b=S*w+A*_+g.tx,T=E*w+C*_+g.ty);const M=t.parent.matrix;if(!M)throw new Error("IK parent must itself have a parent.");S=M.a,A=M.c,E=M.b,C=M.d;const P=1/(S*C-A*E);let I=b-M.tx,R=T-M.ty;const O=(I*C-R*A)*P-h,L=(R*S-I*E)*P-c,D=Math.sqrt(O*O+L*L);let F,N,B=e.data.length*m;if(D<1e-4)return this.apply1(t,n,r,!1,s,!1,l),void e.updateWorldTransformWith(w,_,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);I=n-M.tx,R=r-M.ty;let W=(I*C-R*A)*P-h,U=(R*S-I*E)*P-c,j=W*W+U*U;if(0!=a){a*=u*(m+1)*.5;const t=Math.sqrt(j),e=t-D-B*u+a;if(e>0){let n=Math.min(1,e/(2*a))-1;n=(e-a*(1-n*n))/t,W-=n*W,U-=n*U,j=W*W+U*U}}t:if(k){B*=u;let t=(j-D*D-B*B)/(2*D*B);t<-1?(t=-1,N=Math.PI*i):t>1?(t=1,N=0,s&&(S=(Math.sqrt(j)/(D+B)-1)*l+1,f*=S,o&&(p*=S))):N=Math.acos(t)*i,S=D+B*t,A=B*Math.sin(N),F=Math.atan2(U*S-W*A,W*S+U*A)}else{S=u*B,A=d*B;const t=S*S,e=A*A,n=Math.atan2(U,W);E=e*D*D+t*j-t*e;const r=-2*e*D,s=e-t;if(C=r*r-4*s*E,C>=0){let t=Math.sqrt(C);r<0&&(t=-t),t=.5*-(r+t);const e=t/s,o=E/t,a=Math.abs(e)<Math.abs(o)?e:o;if(a*a<=j){R=Math.sqrt(j-a*a)*i,F=n-Math.atan2(R,a),N=Math.atan2(R/d,(a-D)/u);break t}}let o=C_.PI,a=D-S,l=a*a,h=0,c=0,f=D+S,p=f*f,m=0;E=-S*D/(t-e),E>=-1&&E<=1&&(E=Math.acos(E),I=S*Math.cos(E)+D,R=A*Math.sin(E),C=I*I+R*R,C<l&&(o=E,l=C,a=I,h=R),C>p&&(c=E,p=C,f=I,m=R)),j<=.5*(l+p)?(F=n-Math.atan2(h*i,a),N=o*i):(F=n-Math.atan2(m*i,f),N=c*i)}const H=Math.atan2(_,w)*x;let z=t.arotation;F=(F-H)*C_.radDeg+v-z,F>180?F-=360:F<-180&&(F+=360),t.updateWorldTransformWith(h,c,z+F*l,f,p,0,0),z=e.arotation,N=((N+H)*C_.radDeg-e.ashearX)*x+y-z,N>180?N-=360:N<-180&&(N+=360),e.updateWorldTransformWith(w,_,z+N*l,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class Zb{constructor(t,e,n){this.name=t,this.order=e,this.skinRequired=n}}class Qb extends Zb{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class Jb extends Zb{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=u_.Fixed,this.spacingMode=tT.Fixed,this.rotateMode=d_.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var tT=(t=>(t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent",t[t.Proportional=3]="Proportional",t))(tT||{});const eT=class{constructor(t,e){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let n=0,r=t.bones.length;n<r;n++){const r=e.findBone(t.bones[n].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[n].name}.`);this.bones.push(r)}const n=e.findSlot(t.target.name);if(!n)throw new Error(`Couldn't find target bone ${t.target.name}`);this.target=n,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}isActive(){return this.active}update(){const t=this.target.getAttachment();if(!(t instanceof Y_))return;const e=this.mixRotate,n=this.mixX,r=this.mixY;if(0==e&&0==n&&0==r)return;const i=this.data,s=i.rotateMode==d_.Tangent,o=i.rotateMode==d_.ChainScale,a=this.bones,l=a.length,h=s?l:l+1,c=M_.setArraySize(this.spaces,h),u=o?this.lengths=M_.setArraySize(this.lengths,l):[],d=this.spacing;switch(i.spacingMode){case tT.Percent:if(o)for(let t=0,e=h-1;t<e;t++){const e=a[t],n=e.data.length;if(n<eT.epsilon)u[t]=0;else{const r=n*e.matrix.a,i=n*e.matrix.b;u[t]=Math.sqrt(r*r+i*i)}}M_.arrayFill(c,1,h,d);break;case tT.Proportional:let t=0;for(let e=0,n=h-1;e<n;){const n=a[e],r=n.data.length;if(r<eT.epsilon)o&&(u[e]=0),c[++e]=d;else{const i=r*n.matrix.a,s=r*n.matrix.b,a=Math.sqrt(i*i+s*s);o&&(u[e]=a),c[++e]=a,t+=a}}if(t>0){t=h/t*d;for(let e=1;e<h;e++)c[e]*=t}break;default:const e=i.spacingMode==tT.Length;for(let t=0,n=h-1;t<n;){const n=a[t],r=n.data.length;if(r<eT.epsilon)o&&(u[t]=0),c[++t]=d;else{const i=r*n.matrix.a,s=r*n.matrix.b,a=Math.sqrt(i*i+s*s);o&&(u[t]=a),c[++t]=(e?r+d:d)*a/r}}}const f=this.computeWorldPositions(t,h,s);let p=f[0],m=f[1],g=i.offsetRotation,v=!1;if(0==g)v=i.rotateMode==d_.Chain;else{v=!1;const t=this.target.bone.matrix;g*=t.a*t.d-t.b*t.c>0?C_.degRad:-C_.degRad}for(let t=0,i=3;t<l;t++,i+=3){const l=a[t],h=l.matrix;h.tx+=(p-h.tx)*n,h.ty+=(m-h.ty)*r;const d=f[i],y=f[i+1],x=d-p,w=y-m;if(o){const n=u[t];if(0!=n){const t=(Math.sqrt(x*x+w*w)/n-1)*e+1;h.a*=t,h.b*=t}}if(p=d,m=y,e>0){const n=h.a,r=h.c,o=h.b,a=h.d;let u=0,d=0,y=0;if(u=s?f[i-1]:0==c[t+1]?f[i+2]:Math.atan2(w,x),u-=Math.atan2(o,n),v){d=Math.cos(u),y=Math.sin(u);const t=l.data.length;p+=(t*(d*n-y*o)-x)*e,m+=(t*(y*n+d*o)-w)*e}else u+=g;u>C_.PI?u-=C_.PI2:u<-C_.PI&&(u+=C_.PI2),u*=e,d=Math.cos(u),y=Math.sin(u),h.a=d*n-y*o,h.c=d*r-y*a,h.b=y*n+d*o,h.d=y*r+d*a}l.updateAppliedTransform()}}computeWorldPositions(t,e,n){const r=this.target;let i=this.position;const s=this.spaces,o=M_.setArraySize(this.positions,3*e+2);let a=this.world;const l=t.closed;let h=t.worldVerticesLength,c=h/6,u=eT.NONE;if(!t.constantSpeed){const d=t.lengths;c-=l?1:2;const f=d[c];let p;switch(this.data.positionMode==u_.Percent&&(i*=f),this.data.spacingMode){case tT.Percent:p=f;break;case tT.Proportional:p=f/e;break;default:p=1}a=M_.setArraySize(this.world,8);for(let m=0,g=0,v=0;m<e;m++,g+=3){const e=s[m]*p;i+=e;let y=i;if(l)y%=f,y<0&&(y+=f),v=0;else{if(y<0){u!=eT.BEFORE&&(u=eT.BEFORE,t.computeWorldVertices(r,2,4,a,0,2)),this.addBeforePosition(y,a,0,o,g);continue}if(y>f){u!=eT.AFTER&&(u=eT.AFTER,t.computeWorldVertices(r,h-6,4,a,0,2)),this.addAfterPosition(y-f,a,0,o,g);continue}}for(;;v++){const t=d[v];if(!(y>t)){if(0==v)y/=t;else{const e=d[v-1];y=(y-e)/(t-e)}break}}v!=u&&(u=v,l&&v==c?(t.computeWorldVertices(r,h-4,4,a,0,2),t.computeWorldVertices(r,0,4,a,4,2)):t.computeWorldVertices(r,6*v+2,8,a,0,2)),this.addCurvePosition(y,a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],o,g,n||m>0&&0==e)}return o}l?(h+=2,a=M_.setArraySize(this.world,h),t.computeWorldVertices(r,2,h-4,a,0,2),t.computeWorldVertices(r,0,2,a,h-4,2),a[h-2]=a[0],a[h-1]=a[1]):(c--,h-=4,a=M_.setArraySize(this.world,h),t.computeWorldVertices(r,2,h,a,0,2));const d=M_.setArraySize(this.curves,c);let f,p=0,m=a[0],g=a[1],v=0,y=0,x=0,w=0,_=0,b=0,T=0,S=0,A=0,E=0,C=0,k=0,M=0,P=0;for(let t=0,e=2;t<c;t++,e+=6)v=a[e],y=a[e+1],x=a[e+2],w=a[e+3],_=a[e+4],b=a[e+5],T=.1875*(m-2*v+x),S=.1875*(g-2*y+w),A=.09375*(3*(v-x)-m+_),E=.09375*(3*(y-w)-g+b),C=2*T+A,k=2*S+E,M=.75*(v-m)+T+.16666667*A,P=.75*(y-g)+S+.16666667*E,p+=Math.sqrt(M*M+P*P),M+=C,P+=k,C+=A,k+=E,p+=Math.sqrt(M*M+P*P),M+=C,P+=k,p+=Math.sqrt(M*M+P*P),M+=C+A,P+=k+E,p+=Math.sqrt(M*M+P*P),d[t]=p,m=_,g=b;switch(this.data.positionMode==u_.Percent&&(i*=p),this.data.spacingMode){case tT.Percent:f=p;break;case tT.Proportional:f=p/e;break;default:f=1}const I=this.segments;let R=0;for(let t=0,r=0,c=0,O=0;t<e;t++,r+=3){const e=s[t]*f;i+=e;let L=i;if(l)L%=p,L<0&&(L+=p),c=0;else{if(L<0){this.addBeforePosition(L,a,0,o,r);continue}if(L>p){this.addAfterPosition(L-p,a,h-4,o,r);continue}}for(;;c++){const t=d[c];if(!(L>t)){if(0==c)L/=t;else{const e=d[c-1];L=(L-e)/(t-e)}break}}if(c!=u){u=c;let t=6*c;for(m=a[t],g=a[t+1],v=a[t+2],y=a[t+3],x=a[t+4],w=a[t+5],_=a[t+6],b=a[t+7],T=.03*(m-2*v+x),S=.03*(g-2*y+w),A=.006*(3*(v-x)-m+_),E=.006*(3*(y-w)-g+b),C=2*T+A,k=2*S+E,M=.3*(v-m)+T+.16666667*A,P=.3*(y-g)+S+.16666667*E,R=Math.sqrt(M*M+P*P),I[0]=R,t=1;t<8;t++)M+=C,P+=k,C+=A,k+=E,R+=Math.sqrt(M*M+P*P),I[t]=R;M+=C,P+=k,R+=Math.sqrt(M*M+P*P),I[8]=R,M+=C+A,P+=k+E,R+=Math.sqrt(M*M+P*P),I[9]=R,O=0}for(L*=R;;O++){const t=I[O];if(!(L>t)){if(0==O)L/=t;else{const e=I[O-1];L=O+(L-e)/(t-e)}break}}this.addCurvePosition(.1*L,m,g,v,y,x,w,_,b,o,r,n||t>0&&0==e)}return o}addBeforePosition(t,e,n,r,i){const s=e[n],o=e[n+1],a=e[n+2]-s,l=e[n+3]-o,h=Math.atan2(l,a);r[i]=s+t*Math.cos(h),r[i+1]=o+t*Math.sin(h),r[i+2]=h}addAfterPosition(t,e,n,r,i){const s=e[n+2],o=e[n+3],a=s-e[n],l=o-e[n+1],h=Math.atan2(l,a);r[i]=s+t*Math.cos(h),r[i+1]=o+t*Math.sin(h),r[i+2]=h}addCurvePosition(t,e,n,r,i,s,o,a,l,h,c,u){if(0==t||isNaN(t))return h[c]=e,h[c+1]=n,void(h[c+2]=Math.atan2(i-n,r-e));const d=t*t,f=d*t,p=1-t,m=p*p,g=m*p,v=p*t,y=3*v,x=p*y,w=y*t,_=e*g+r*x+s*w+a*f,b=n*g+i*x+o*w+l*f;h[c]=_,h[c+1]=b,u&&(h[c+2]=t<.001?Math.atan2(i-n,r-e):Math.atan2(b-(n*m+i*v*2+o*d),_-(e*m+r*v*2+s*d)))}};let nT=eT;nT.NONE=-1,nT.BEFORE=-2,nT.AFTER=-3,nT.epsilon=1e-5;class rT{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new A_,this.darkColor=t.darkColor?new A_:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(t instanceof z_&&this.attachment instanceof z_&&t.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class iT{constructor(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new I_,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let n=0;n<t.bones.length;n++){const r=e.findBone(t.bones[n].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[n].name}.`);this.bones.push(r)}const n=e.findBone(t.target.name);if(!n)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=n}isActive(){return this.active}update(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleX&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){const t=this.mixRotate,e=this.mixX,n=this.mixY,r=this.mixScaleX,i=this.mixScaleY,s=this.mixShearY,o=0!=e||0!=n,a=this.target,l=a.matrix,h=l.a,c=l.c,u=l.b,d=l.d,f=h*d-c*u>0?C_.degRad:-C_.degRad,p=this.data.offsetRotation*f,m=this.data.offsetShearY*f,g=this.bones;for(let l=0,f=g.length;l<f;l++){const f=g[l],v=f.matrix;if(0!=t){const e=v.a,n=v.c,r=v.b,i=v.d;let s=Math.atan2(u,h)-Math.atan2(r,e)+p;s>C_.PI?s-=C_.PI2:s<-C_.PI&&(s+=C_.PI2),s*=t;const o=Math.cos(s),a=Math.sin(s);v.a=o*e-a*r,v.c=o*n-a*i,v.b=a*e+o*r,v.d=a*n+o*i}if(o){const t=this.temp;a.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),v.tx+=(t.x-v.tx)*e,v.ty+=(t.y-v.ty)*n}if(0!=r){let t=Math.sqrt(v.a*v.a+v.b*v.b);0!=t&&(t=(t+(Math.sqrt(h*h+u*u)-t+this.data.offsetScaleX)*r)/t),v.a*=t,v.b*=t}if(0!=i){let t=Math.sqrt(v.c*v.c+v.d*v.d);0!=t&&(t=(t+(Math.sqrt(c*c+d*d)-t+this.data.offsetScaleY)*i)/t),v.c*=t,v.d*=t}if(s>0){const t=v.c,e=v.d,n=Math.atan2(e,t);let r=Math.atan2(d,c)-Math.atan2(u,h)-(n-Math.atan2(v.b,v.a));r>C_.PI?r-=C_.PI2:r<-C_.PI&&(r+=C_.PI2),r=n+(r+m)*s;const i=Math.sqrt(t*t+e*e);v.c=Math.cos(r)*i,v.d=Math.sin(r)*i}f.updateAppliedTransform()}}applyRelativeWorld(){const t=this.mixRotate,e=this.mixX,n=this.mixY,r=this.mixScaleX,i=this.mixScaleY,s=this.mixShearY,o=0!=e||0!=n,a=this.target,l=a.matrix,h=l.a,c=l.c,u=l.b,d=l.d,f=h*d-c*u>0?C_.degRad:-C_.degRad,p=this.data.offsetRotation*f,m=this.data.offsetShearY*f,g=this.bones;for(let l=0,f=g.length;l<f;l++){const f=g[l],v=f.matrix;if(0!=t){const e=v.a,n=v.c,r=v.b,i=v.d;let s=Math.atan2(u,h)+p;s>C_.PI?s-=C_.PI2:s<-C_.PI&&(s+=C_.PI2),s*=t;const o=Math.cos(s),a=Math.sin(s);v.a=o*e-a*r,v.c=o*n-a*i,v.b=a*e+o*r,v.d=a*n+o*i}if(o){const t=this.temp;a.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),v.tx+=t.x*e,v.ty+=t.y*n}if(0!=r){const t=(Math.sqrt(h*h+u*u)-1+this.data.offsetScaleX)*r+1;v.a*=t,v.b*=t}if(0!=i){const t=(Math.sqrt(c*c+d*d)-1+this.data.offsetScaleY)*i+1;v.c*=t,v.d*=t}if(s>0){let t=Math.atan2(d,c)-Math.atan2(u,h);t>C_.PI?t-=C_.PI2:t<-C_.PI&&(t+=C_.PI2);const e=v.c,n=v.d;t=Math.atan2(n,e)+(t-C_.PI/2+m)*s;const r=Math.sqrt(e*e+n*n);v.c=Math.cos(t)*r,v.d=Math.sin(t)*r}f.updateAppliedTransform()}}applyAbsoluteLocal(){const t=this.mixRotate,e=this.mixX,n=this.mixY,r=this.mixScaleX,i=this.mixScaleY,s=this.mixShearY,o=this.target,a=this.bones;for(let l=0,h=a.length;l<h;l++){const h=a[l];let c=h.arotation;if(0!=t){let e=o.arotation-c+this.data.offsetRotation;e-=360*(16384-(16384.499999999996-e/360|0)),c+=e*t}let u=h.ax,d=h.ay;u+=(o.ax-u+this.data.offsetX)*e,d+=(o.ay-d+this.data.offsetY)*n;let f=h.ascaleX,p=h.ascaleY;0!=r&&0!=f&&(f=(f+(o.ascaleX-f+this.data.offsetScaleX)*r)/f),0!=i&&0!=p&&(p=(p+(o.ascaleY-p+this.data.offsetScaleY)*i)/p);let m=h.ashearY;if(0!=s){let t=o.ashearY-m+this.data.offsetShearY;t-=360*(16384-(16384.499999999996-t/360|0)),m+=t*s}h.updateWorldTransformWith(u,d,c,f,p,h.ashearX,m)}}applyRelativeLocal(){const t=this.mixRotate,e=this.mixX,n=this.mixY,r=this.mixScaleX,i=this.mixScaleY,s=this.mixShearY,o=this.target,a=this.bones;for(let l=0,h=a.length;l<h;l++){const h=a[l],c=h.arotation+(o.arotation+this.data.offsetRotation)*t,u=h.ax+(o.ax+this.data.offsetX)*e,d=h.ay+(o.ay+this.data.offsetY)*n,f=h.ascaleX*((o.ascaleX-1+this.data.offsetScaleX)*r+1),p=h.ascaleY*((o.ascaleY-1+this.data.offsetScaleY)*i+1),m=h.ashearY+(o.ashearY+this.data.offsetShearY)*s;h.updateWorldTransformWith(u,d,c,f,p,h.ashearX,m)}}}const sT=class{constructor(t){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let r;if(n.parent){const t=this.bones[n.parent.index];r=new $b(n,this,t),t.children.push(r)}else r=new $b(n,this,null);this.bones.push(r)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const n=t.slots[e],r=this.bones[n.boneData.index],i=new rT(n,r);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const n=t.ikConstraints[e];this.ikConstraints.push(new Kb(n,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const n=t.transformConstraints[e];this.transformConstraints.push(new iT(n,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const n=t.pathConstraints[e];this.pathConstraints.push(new nT(n,this))}this.color=new A_(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;const t=this.bones;for(let e=0,n=t.length;e<n;e++){const n=t[e];n.sorted=n.data.skinRequired,n.active=!n.sorted}if(this.skin){const t=this.skin.bones;for(let e=0,n=this.skin.bones.length;e<n;e++){let n=this.bones[t[e].index];do{n.sorted=!1,n.active=!0,n=n.parent}while(n)}}const e=this.ikConstraints,n=this.transformConstraints,r=this.pathConstraints,i=e.length,s=n.length,o=r.length,a=i+s+o;t:for(let t=0;t<a;t++){for(let n=0;n<i;n++){const r=e[n];if(r.data.order==t){this.sortIkConstraint(r);continue t}}for(let e=0;e<s;e++){const r=n[e];if(r.data.order==t){this.sortTransformConstraint(r);continue t}}for(let e=0;e<o;e++){const n=r[e];if(n.data.order==t){this.sortPathConstraint(n);continue t}}}for(let e=0,n=t.length;e<n;e++)this.sortBone(t[e])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&M_.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target;this.sortBone(e);const n=t.bones,r=n[0];if(this.sortBone(r),1==n.length)this._updateCache.push(t),this.sortReset(r.children);else{const e=n[n.length-1];this.sortBone(e),this._updateCache.push(t),this.sortReset(r.children),e.sorted=!0}}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&M_.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target,n=e.data.index,r=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,n,r),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,r);for(let t=0,e=this.data.skins.length;t<e;t++)this.sortPathConstraintAttachment(this.data.skins[t],n,r);const i=e.getAttachment();i instanceof Y_&&this.sortPathConstraintAttachmentWith(i,r);const s=t.bones,o=s.length;for(let t=0;t<o;t++)this.sortBone(s[t]);this._updateCache.push(t);for(let t=0;t<o;t++)this.sortReset(s[t].children);for(let t=0;t<o;t++)s[t].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&M_.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);const e=t.bones,n=e.length;if(t.data.local)for(let t=0;t<n;t++){const n=e[t];this.sortBone(n.parent),this.sortBone(n)}else for(let t=0;t<n;t++)this.sortBone(e[t]);this._updateCache.push(t);for(let t=0;t<n;t++)this.sortReset(e[t].children);for(let t=0;t<n;t++)e[t].sorted=!0}sortPathConstraintAttachment(t,e,n){const r=t.attachments[e];if(r)for(const t in r)this.sortPathConstraintAttachmentWith(r[t],n)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof Y_))return;const n=t.bones;if(n){const t=this.bones;for(let e=0,r=n.length;e<r;){let r=n[e++];for(r+=e;e<r;)this.sortBone(t[n[e++]])}}else this.sortBone(e)}sortBone(t){if(!t)return;if(t.sorted)return;const e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,n=t.length;e<n;e++){const n=t[e];n.active&&(n.sorted&&this.sortReset(n.children),n.sorted=!1)}}updateWorldTransform(){const t=this.bones;for(let e=0,n=t.length;e<n;e++){const n=t[e];n.ax=n.x,n.ay=n.y,n.arotation=n.rotation,n.ascaleX=n.scaleX,n.ascaleY=n.scaleY,n.ashearX=n.shearX,n.ashearY=n.shearY}const e=this._updateCache;for(let t=0,n=e.length;t<n;t++)e[t].update()}updateWorldTransformWith(t){const e=this.getRootBone(),n=t.matrix.a,r=t.matrix.c,i=t.matrix.b,s=t.matrix.d;e.matrix.tx=n*this.x+r*this.y+t.worldX,e.matrix.ty=i*this.x+s*this.y+t.worldY;const o=e.rotation+90+e.shearY,a=C_.cosDeg(e.rotation+e.shearX)*e.scaleX,l=C_.cosDeg(o)*e.scaleY,h=C_.sinDeg(e.rotation+e.shearX)*e.scaleX,c=C_.sinDeg(o)*e.scaleY,u=this.scaleX,d=-this.scaleY;e.matrix.a=(n*a+r*h)*u,e.matrix.c=(n*l+r*c)*u,e.matrix.b=(i*a+s*h)*d,e.matrix.d=(i*l+s*c)*d;const f=this._updateCache;for(let t=0,n=f.length;t<n;t++){const n=f[t];n!=e&&n.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let e=0,n=t.length;e<n;e++)t[e].setToSetupPose();const e=this.ikConstraints;for(let t=0,n=e.length;t<n;t++){const n=e[t];n.mix=n.data.mix,n.softness=n.data.softness,n.bendDirection=n.data.bendDirection,n.compress=n.data.compress,n.stretch=n.data.stretch}const n=this.transformConstraints;for(let t=0,e=n.length;t<e;t++){const e=n[t],r=e.data;e.mixRotate=r.mixRotate,e.mixX=r.mixX,e.mixY=r.mixY,e.mixScaleX=r.mixScaleX,e.mixScaleY=r.mixScaleY,e.mixShearY=r.mixShearY}const r=this.pathConstraints;for(let t=0,e=r.length;t<e;t++){const e=r[t],n=e.data;e.position=n.position,e.spacing=n.spacing,e.mixRotate=n.mixRotate,e.mixX=n.mixX,e.mixY=n.mixY}}setSlotsToSetupPose(){const t=this.slots;M_.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,n=t.length;e<n;e++)t[e].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,r=e.length;n<r;n++)if(e[n].data.name==t)return n;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,r=e.length;n<r;n++)if(e[n].data.name==t)return n;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(!e)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else{const e=this.slots;for(let n=0,r=e.length;n<r;n++){const r=e[n],i=r.data.attachmentName;if(i){const e=t.getAttachment(n,i);e&&r.setAttachment(e)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){const n=this.data.findSlot(t);if(!n)throw new Error(`Can't find slot with name ${t}`);return this.getAttachment(n.index,e)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){const n=this.skin.getAttachment(t,e);if(n)return n}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(!t)throw new Error("slotName cannot be null.");const n=this.slots;for(let r=0,i=n.length;r<i;r++){const i=n[r];if(i.data.name==t){let n=null;if(e&&(n=this.getAttachment(r,e),!n))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);return void i.setAttachment(n)}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.data.name==t)return r}return null}getBoundsRect(){const t=new I_,e=new I_;return this.getBounds(t,e),{x:t.x,y:t.y,width:e.x,height:e.y}}getBounds(t,e,n=new Array(2)){if(!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");const r=this.drawOrder;let i=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let t=0,e=r.length;t<e;t++){const e=r[t];if(!e.bone.active)continue;let l=0,h=null;const c=e.getAttachment();if(c instanceof K_)l=8,h=M_.setArraySize(n,l,0),c.computeWorldVertices(e,h,0,2);else if(c instanceof X_){const t=c;l=t.worldVerticesLength,h=M_.setArraySize(n,l,0),t.computeWorldVertices(e,0,l,h,0,2)}if(h)for(let t=0,e=h.length;t<e;t+=2){const e=h[t],n=h[t+1];i=Math.min(i,e),s=Math.min(s,n),o=Math.max(o,e),a=Math.max(a,n)}}t.set(i,s),e.set(o-i,a-s)}get flipX(){return-1==this.scaleX}set flipX(t){sT.deprecatedWarning1||(sT.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return-1==this.scaleY}set flipY(t){sT.deprecatedWarning1||(sT.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let oT=sT;oT.deprecatedWarning1=!1;class aT{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}}class lT{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let n=0,r=e.length;n<r;n++)if(e[n].name==t)return n;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let n=0,r=e.length;n<r;n++)if(e[n].name==t)return n;return-1}findSkin(t){if(!t)throw new Error("skinName cannot be null.");const e=this.skins;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");const e=this.events;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");const e=this.animations;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.name==t)return r}return null}findPathConstraintIndex(t){if(null==t)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let n=0,r=e.length;n<r;n++)if(e[n].name==t)return n;return-1}}class hT{constructor(t,e,n){if(this.index=0,this.color=new A_(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=P.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!n)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=n}}class cT extends Zb{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class uT{constructor(t,e,n){this.slotIndex=t,this.name=e,this.attachment=n}}class dT{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,n){if(!n)throw new Error("attachment cannot be null.");const r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=n}addSkin(t){for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let r=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==n){r=!0;break}r||this.bones.push(n)}for(let e=0;e<t.constraints.length;e++){const n=t.constraints[e];let r=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==n){r=!0;break}r||this.constraints.push(n)}const e=t.getAttachments();for(let t=0;t<e.length;t++){const n=e[t];this.setAttachment(n.slotIndex,n.name,n.attachment)}}copySkin(t){for(let e=0;e<t.bones.length;e++){const n=t.bones[e];let r=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==n){r=!0;break}r||this.bones.push(n)}for(let e=0;e<t.constraints.length;e++){const n=t.constraints[e];let r=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==n){r=!0;break}r||this.constraints.push(n)}const e=t.getAttachments();for(let t=0;t<e.length;t++){const n=e[t];n.attachment&&(n.attachment instanceof X_?(n.attachment=n.attachment.newLinkedMesh(),this.setAttachment(n.slotIndex,n.name,n.attachment)):(n.attachment=n.attachment.copy(),this.setAttachment(n.slotIndex,n.name,n.attachment)))}}getAttachment(t,e){const n=this.attachments[t];return n?n[e]:null}removeAttachment(t,e){const n=this.attachments[t];n&&delete n[e]}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const n=this.attachments[e];if(n)for(const r in n){const i=n[r];i&&t.push(new uT(e,r,i))}}return t}getAttachmentsForSlot(t,e){const n=this.attachments[t];if(n)for(const r in n){const i=n[r];i&&e.push(new uT(t,r,i))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let n=0;for(let r=0;r<t.slots.length;r++){const i=t.slots[r],s=i.getAttachment();if(s&&n<e.attachments.length){const t=e.attachments[n];for(const e in t)if(s==t[e]){const t=this.getAttachment(n,e);t&&i.setAttachment(t);break}}n++}}}class fT{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}}class pT{constructor(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new lT;n.name="";const r=new l_(t),i=r.readInt32(),s=r.readInt32();n.hash=0==s&&0==i?null:s.toString(16)+i.toString(16),n.version=r.readString();const o=n.version.substr(0,3);if("4.0"!==o&&"4.1"!==o){const t=`Spine 4.1 loader cant load version ${n.version}. Please configure your pixi-spine bundle`;console.error(t)}this.ver40="4.0"===o,n.x=r.readFloat(),n.y=r.readFloat(),n.width=r.readFloat(),n.height=r.readFloat();const a=r.readBoolean();a&&(n.fps=r.readFloat(),n.imagesPath=r.readString(),n.audioPath=r.readString());let l=0;l=r.readInt(!0);for(let t=0;t<l;t++){const t=r.readString();if(!t)throw new Error("String in string table must not be null.");r.strings.push(t)}l=r.readInt(!0);for(let t=0;t<l;t++){const i=r.readString();if(!i)throw new Error("Bone name must not be null.");const s=0==t?null:n.bones[r.readInt(!0)],o=new qb(t,i,s);o.rotation=r.readFloat(),o.x=r.readFloat()*e,o.y=r.readFloat()*e,o.scaleX=r.readFloat(),o.scaleY=r.readFloat(),o.shearX=r.readFloat(),o.shearY=r.readFloat(),o.length=r.readFloat()*e,o.transformMode=r.readInt(!0),o.skinRequired=r.readBoolean(),a&&A_.rgba8888ToColor(o.color,r.readInt32()),n.bones.push(o)}l=r.readInt(!0);for(let t=0;t<l;t++){const e=r.readString();if(!e)throw new Error("Slot name must not be null.");const i=n.bones[r.readInt(!0)],s=new hT(t,e,i);A_.rgba8888ToColor(s.color,r.readInt32());const o=r.readInt32();-1!=o&&A_.rgb888ToColor(s.darkColor=new A_,o),s.attachmentName=r.readStringRef(),s.blendMode=r.readInt(!0),n.slots.push(s)}l=r.readInt(!0);for(let t,i=0;i<l;i++){const i=r.readString();if(!i)throw new Error("IK constraint data name must not be null.");const s=new Qb(i);s.order=r.readInt(!0),s.skinRequired=r.readBoolean(),t=r.readInt(!0);for(let e=0;e<t;e++)s.bones.push(n.bones[r.readInt(!0)]);s.target=n.bones[r.readInt(!0)],s.mix=r.readFloat(),s.softness=r.readFloat()*e,s.bendDirection=r.readByte(),s.compress=r.readBoolean(),s.stretch=r.readBoolean(),s.uniform=r.readBoolean(),n.ikConstraints.push(s)}l=r.readInt(!0);for(let t,i=0;i<l;i++){const i=r.readString();if(!i)throw new Error("Transform constraint data name must not be null.");const s=new cT(i);s.order=r.readInt(!0),s.skinRequired=r.readBoolean(),t=r.readInt(!0);for(let e=0;e<t;e++)s.bones.push(n.bones[r.readInt(!0)]);s.target=n.bones[r.readInt(!0)],s.local=r.readBoolean(),s.relative=r.readBoolean(),s.offsetRotation=r.readFloat(),s.offsetX=r.readFloat()*e,s.offsetY=r.readFloat()*e,s.offsetScaleX=r.readFloat(),s.offsetScaleY=r.readFloat(),s.offsetShearY=r.readFloat(),s.mixRotate=r.readFloat(),s.mixX=r.readFloat(),s.mixY=r.readFloat(),s.mixScaleX=r.readFloat(),s.mixScaleY=r.readFloat(),s.mixShearY=r.readFloat(),n.transformConstraints.push(s)}l=r.readInt(!0);for(let t,i=0;i<l;i++){const i=r.readString();if(!i)throw new Error("Path constraint data name must not be null.");const s=new Jb(i);s.order=r.readInt(!0),s.skinRequired=r.readBoolean(),t=r.readInt(!0);for(let e=0;e<t;e++)s.bones.push(n.bones[r.readInt(!0)]);s.target=n.slots[r.readInt(!0)],s.positionMode=r.readInt(!0),s.spacingMode=r.readInt(!0),s.rotateMode=r.readInt(!0),s.offsetRotation=r.readFloat(),s.position=r.readFloat(),s.positionMode==u_.Fixed&&(s.position*=e),s.spacing=r.readFloat(),s.spacingMode!=tT.Length&&s.spacingMode!=tT.Fixed||(s.spacing*=e),s.mixRotate=r.readFloat(),s.mixX=r.readFloat(),s.mixY=r.readFloat(),n.pathConstraints.push(s)}const h=this.readSkin(r,n,!0,a);h&&(n.defaultSkin=h,n.skins.push(h));{let t=n.skins.length;for(M_.setArraySize(n.skins,l=t+r.readInt(!0));t<l;t++){const e=this.readSkin(r,n,!1,a);if(!e)throw new Error("readSkin() should not have returned null.");n.skins[t]=e}}l=this.linkedMeshes.length;for(let t=0;t<l;t++){const e=this.linkedMeshes[t],r=e.skin?n.findSkin(e.skin):n.defaultSkin;if(!r)throw new Error("Not skin found for linked mesh.");if(!e.parent)throw new Error("Linked mesh parent must not be null");const i=r.getAttachment(e.slotIndex,e.parent);if(!i)throw new Error(`Parent mesh not found: ${e.parent}`);e.mesh.timelineAttachment=e.inheritTimeline?i:e.mesh,e.mesh.setParentMesh(i)}this.linkedMeshes.length=0,l=r.readInt(!0);for(let t=0;t<l;t++){const t=r.readStringRef();if(!t)throw new Error;const e=new fT(t);e.intValue=r.readInt(!1),e.floatValue=r.readFloat(),e.stringValue=r.readString(),e.audioPath=r.readString(),e.audioPath&&(e.volume=r.readFloat(),e.balance=r.readFloat()),n.events.push(e)}l=r.readInt(!0);for(let t=0;t<l;t++){const t=r.readString();if(!t)throw new Error("Animatio name must not be null.");n.animations.push(this.readAnimation(r,t,n))}return n}readSkin(t,e,n,r){let i=null,s=0;if(n){if(s=t.readInt(!0),0==s)return null;i=new dT("default")}else{const n=t.readStringRef();if(!n)throw new Error("Skin name must not be null.");i=new dT(n),i.bones.length=t.readInt(!0);for(let n=0,r=i.bones.length;n<r;n++)i.bones[n]=e.bones[t.readInt(!0)];for(let n=0,r=t.readInt(!0);n<r;n++)i.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let n=0,r=t.readInt(!0);n<r;n++)i.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let n=0,r=t.readInt(!0);n<r;n++)i.constraints.push(e.pathConstraints[t.readInt(!0)]);s=t.readInt(!0)}for(let n=0;n<s;n++){const n=t.readInt(!0);for(let s=0,o=t.readInt(!0);s<o;s++){const s=t.readStringRef();if(!s)throw new Error("Attachment name must not be null");const o=this.readAttachment(t,e,i,n,s,r);o&&i.setAttachment(n,s,o)}}return i}readAttachment(t,e,n,r,i,s){const o=this.scale;let a=t.readStringRef();switch(a||(a=i),t.readByte()){case a_.Region:{let e=t.readStringRef();const r=t.readFloat(),i=t.readFloat(),s=t.readFloat(),l=t.readFloat(),h=t.readFloat(),c=t.readFloat(),u=t.readFloat(),d=t.readInt32(),f=this.readSequence(t);e||(e=a);const p=this.attachmentLoader.newRegionAttachment(n,a,e,f);return p?(p.path=e,p.x=i*o,p.y=s*o,p.scaleX=l,p.scaleY=h,p.rotation=r,p.width=c*o,p.height=u*o,A_.rgba8888ToColor(p.color,d),p.sequence=f,null==f&&p.updateRegion(),p):null}case a_.BoundingBox:{const e=t.readInt(!0),r=this.readVertices(t,e),i=s?t.readInt32():0,o=this.attachmentLoader.newBoundingBoxAttachment(n,a);return o?(o.worldVerticesLength=e<<1,o.vertices=r.vertices,o.bones=r.bones,s&&A_.rgba8888ToColor(o.color,i),o):null}case a_.Mesh:{let e=t.readStringRef();const r=t.readInt32(),i=t.readInt(!0),l=this.readFloatArray(t,i<<1,1),h=this.readShortArray(t),c=this.readVertices(t,i),u=t.readInt(!0),d=this.readSequence(t);let f=[],p=0,m=0;s&&(f=this.readShortArray(t),p=t.readFloat(),m=t.readFloat()),e||(e=a);const g=this.attachmentLoader.newMeshAttachment(n,a,e,d);return g?(g.path=e,A_.rgba8888ToColor(g.color,r),g.bones=c.bones,g.vertices=c.vertices,g.worldVerticesLength=i<<1,g.triangles=h,g.regionUVs=new Float32Array(l),g.hullLength=u<<1,g.sequence=d,s&&(g.edges=f,g.width=p*o,g.height=m*o),g):null}case a_.LinkedMesh:{let e=t.readStringRef();const i=t.readInt32(),l=t.readStringRef(),h=t.readStringRef(),c=t.readBoolean(),u=this.readSequence(t);let d=0,f=0;s&&(d=t.readFloat(),f=t.readFloat()),e||(e=a);const p=this.attachmentLoader.newMeshAttachment(n,a,e,u);return p?(p.path=e,A_.rgba8888ToColor(p.color,i),p.sequence=u,s&&(p.width=d*o,p.height=f*o),this.linkedMeshes.push(new mT(p,l,r,h,c)),p):null}case a_.Path:{const e=t.readBoolean(),r=t.readBoolean(),i=t.readInt(!0),l=this.readVertices(t,i),h=M_.newArray(i/3,0);for(let e=0,n=h.length;e<n;e++)h[e]=t.readFloat()*o;const c=s?t.readInt32():0,u=this.attachmentLoader.newPathAttachment(n,a);return u?(u.closed=e,u.constantSpeed=r,u.worldVerticesLength=i<<1,u.vertices=l.vertices,u.bones=l.bones,u.lengths=h,s&&A_.rgba8888ToColor(u.color,c),u):null}case a_.Point:{const e=t.readFloat(),r=t.readFloat(),i=t.readFloat(),l=s?t.readInt32():0,h=this.attachmentLoader.newPointAttachment(n,a);return h?(h.x=r*o,h.y=i*o,h.rotation=e,s&&A_.rgba8888ToColor(h.color,l),h):null}case a_.Clipping:{const r=t.readInt(!0),i=t.readInt(!0),o=this.readVertices(t,i),l=s?t.readInt32():0,h=this.attachmentLoader.newClippingAttachment(n,a);return h?(h.endSlot=e.slots[r],h.worldVerticesLength=i<<1,h.vertices=o.vertices,h.bones=o.bones,s&&A_.rgba8888ToColor(h.color,l),h):null}}return null}readSequence(t){if(this.ver40||!t.readBoolean())return null;const e=new Q_(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readDeformTimelineType(t){return this.ver40?FT:t.readByte()}readVertices(t,e){const n=this.scale,r=e<<1,i=new gT;if(!t.readBoolean())return i.vertices=this.readFloatArray(t,r,n),i;const s=new Array,o=new Array;for(let r=0;r<e;r++){const e=t.readInt(!0);o.push(e);for(let r=0;r<e;r++)o.push(t.readInt(!0)),s.push(t.readFloat()*n),s.push(t.readFloat()*n),s.push(t.readFloat())}return i.vertices=M_.toFloatArray(s),i.bones=o,i}readFloatArray(t,e,n){const r=new Array(e);if(1==n)for(let n=0;n<e;n++)r[n]=t.readFloat();else for(let i=0;i<e;i++)r[i]=t.readFloat()*n;return r}readShortArray(t){const e=t.readInt(!0),n=new Array(e);for(let r=0;r<e;r++)n[r]=t.readShort();return n}readAnimation(t,e,n){t.readInt(!0);const r=new Array,i=this.scale;for(let e=0,n=t.readInt(!0);e<n;e++){const e=t.readInt(!0);for(let n=0,i=t.readInt(!0);n<i;n++){const n=t.readByte(),i=t.readInt(!0),s=i-1;switch(n){case PT:{const n=new _b(i,e);for(let e=0;e<i;e++)n.setFrame(e,t.readFloat(),t.readStringRef());r.push(n);break}case IT:{const n=t.readInt(!0),o=new gb(i,n,e);let a=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255;for(let e=0,n=0;o.setFrame(e,a,l,h,c,u),e!=s;e++){const r=t.readFloat(),i=t.readUnsignedByte()/255,s=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255;switch(t.readByte()){case jT:o.setStepped(e);break;case HT:xT(t,o,n++,e,0,a,r,l,i,1),xT(t,o,n++,e,1,a,r,h,s,1),xT(t,o,n++,e,2,a,r,c,d,1),xT(t,o,n++,e,3,a,r,u,f,1)}a=r,l=i,h=s,c=d,u=f}r.push(o);break}case RT:{const n=t.readInt(!0),o=new vb(i,n,e);let a=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255;for(let e=0,n=0;o.setFrame(e,a,l,h,c),e!=s;e++){const r=t.readFloat(),i=t.readUnsignedByte()/255,s=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255;switch(t.readByte()){case jT:o.setStepped(e);break;case HT:xT(t,o,n++,e,0,a,r,l,i,1),xT(t,o,n++,e,1,a,r,h,s,1),xT(t,o,n++,e,2,a,r,c,u,1)}a=r,l=i,h=s,c=u}r.push(o);break}case OT:{const n=t.readInt(!0),o=new xb(i,n,e);let a=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255;for(let e=0,n=0;o.setFrame(e,a,l,h,c,u,d,f,p),e!=s;e++){const r=t.readFloat(),i=t.readUnsignedByte()/255,s=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,y=t.readUnsignedByte()/255,x=t.readUnsignedByte()/255;switch(t.readByte()){case jT:o.setStepped(e);break;case HT:xT(t,o,n++,e,0,a,r,l,i,1),xT(t,o,n++,e,1,a,r,h,s,1),xT(t,o,n++,e,2,a,r,c,m,1),xT(t,o,n++,e,3,a,r,u,g,1),xT(t,o,n++,e,4,a,r,d,v,1),xT(t,o,n++,e,5,a,r,f,y,1),xT(t,o,n++,e,6,a,r,p,x,1)}a=r,l=i,h=s,c=m,u=g,d=v,f=y,p=x}r.push(o);break}case LT:{const n=t.readInt(!0),o=new wb(i,n,e);let a=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255;for(let e=0,n=0;o.setFrame(e,a,l,h,c,u,d,f),e!=s;e++){const r=t.readFloat(),i=t.readUnsignedByte()/255,s=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255;switch(t.readByte()){case jT:o.setStepped(e);break;case HT:xT(t,o,n++,e,0,a,r,l,i,1),xT(t,o,n++,e,1,a,r,h,s,1),xT(t,o,n++,e,2,a,r,c,p,1),xT(t,o,n++,e,3,a,r,u,m,1),xT(t,o,n++,e,4,a,r,d,g,1),xT(t,o,n++,e,5,a,r,f,v,1)}a=r,l=i,h=s,c=p,u=m,d=g,f=v}r.push(o);break}case DT:{const n=new yb(i,t.readInt(!0),e);let o=t.readFloat(),a=t.readUnsignedByte()/255;for(let e=0,r=0;n.setFrame(e,o,a),e!=s;e++){const i=t.readFloat(),s=t.readUnsignedByte()/255;switch(t.readByte()){case jT:n.setStepped(e);break;case HT:xT(t,n,r++,e,0,o,i,a,s,1)}o=i,a=s}r.push(n)}}}}for(let e=0,n=t.readInt(!0);e<n;e++){const e=t.readInt(!0);for(let n=0,s=t.readInt(!0);n<s;n++){const n=t.readByte(),s=t.readInt(!0),o=t.readInt(!0);switch(n){case wT:r.push(vT(t,new ob(s,o,e),1));break;case _T:r.push(yT(t,new ab(s,o,e),i));break;case bT:r.push(vT(t,new lb(s,o,e),i));break;case TT:r.push(vT(t,new hb(s,o,e),i));break;case ST:r.push(yT(t,new cb(s,o,e),1));break;case AT:r.push(vT(t,new ub(s,o,e),1));break;case ET:r.push(vT(t,new db(s,o,e),1));break;case CT:r.push(yT(t,new fb(s,o,e),1));break;case kT:r.push(vT(t,new pb(s,o,e),1));break;case MT:r.push(vT(t,new mb(s,o,e),1))}}}for(let e=0,n=t.readInt(!0);e<n;e++){const e=t.readInt(!0),n=t.readInt(!0),s=n-1,o=new Cb(n,t.readInt(!0),e);let a=t.readFloat(),l=t.readFloat(),h=t.readFloat()*i;for(let e=0,n=0;o.setFrame(e,a,l,h,t.readByte(),t.readBoolean(),t.readBoolean()),e!=s;e++){const r=t.readFloat(),s=t.readFloat(),c=t.readFloat()*i;switch(t.readByte()){case jT:o.setStepped(e);break;case HT:xT(t,o,n++,e,0,a,r,l,s,1),xT(t,o,n++,e,1,a,r,h,c,i)}a=r,l=s,h=c}r.push(o)}for(let e=0,n=t.readInt(!0);e<n;e++){const e=t.readInt(!0),n=t.readInt(!0),i=n-1,s=new kb(n,t.readInt(!0),e);let o=t.readFloat(),a=t.readFloat(),l=t.readFloat(),h=t.readFloat(),c=t.readFloat(),u=t.readFloat(),d=t.readFloat();for(let e=0,n=0;s.setFrame(e,o,a,l,h,c,u,d),e!=i;e++){const r=t.readFloat(),i=t.readFloat(),f=t.readFloat(),p=t.readFloat(),m=t.readFloat(),g=t.readFloat(),v=t.readFloat();switch(t.readByte()){case jT:s.setStepped(e);break;case HT:xT(t,s,n++,e,0,o,r,a,i,1),xT(t,s,n++,e,1,o,r,l,f,1),xT(t,s,n++,e,2,o,r,h,p,1),xT(t,s,n++,e,3,o,r,c,m,1),xT(t,s,n++,e,4,o,r,u,g,1),xT(t,s,n++,e,5,o,r,d,v,1)}o=r,a=i,l=f,h=p,c=m,u=g,d=v}r.push(s)}for(let e=0,s=t.readInt(!0);e<s;e++){const e=t.readInt(!0),s=n.pathConstraints[e];for(let n=0,o=t.readInt(!0);n<o;n++)switch(t.readByte()){case BT:r.push(vT(t,new Mb(t.readInt(!0),t.readInt(!0),e),s.positionMode==u_.Fixed?i:1));break;case WT:r.push(vT(t,new Pb(t.readInt(!0),t.readInt(!0),e),s.spacingMode==tT.Length||s.spacingMode==tT.Fixed?i:1));break;case UT:const n=new Ib(t.readInt(!0),t.readInt(!0),e);let o=t.readFloat(),a=t.readFloat(),l=t.readFloat(),h=t.readFloat();for(let e=0,r=0,i=n.getFrameCount()-1;n.setFrame(e,o,a,l,h),e!=i;e++){const i=t.readFloat(),s=t.readFloat(),c=t.readFloat(),u=t.readFloat();switch(t.readByte()){case jT:n.setStepped(e);break;case HT:xT(t,n,r++,e,0,o,i,a,s,1),xT(t,n,r++,e,1,o,i,l,c,1),xT(t,n,r++,e,2,o,i,h,u,1)}o=i,a=s,l=c,h=u}r.push(n)}}for(let e=0,s=t.readInt(!0);e<s;e++){const e=n.skins[t.readInt(!0)];for(let n=0,s=t.readInt(!0);n<s;n++){const n=t.readInt(!0);for(let s=0,o=t.readInt(!0);s<o;s++){const s=t.readStringRef();if(!s)throw new Error("attachmentName must not be null.");const o=e.getAttachment(n,s),a=this.readDeformTimelineType(t),l=t.readInt(!0),h=l-1;switch(a){case FT:{const e=o,s=e.bones,a=e.vertices,c=s?a.length/3*2:a.length,u=t.readInt(!0),d=new bb(l,u,n,e);let f=t.readFloat();for(let e=0,n=0;;e++){let r,o=t.readInt(!0);if(0==o)r=s?M_.newFloatArray(c):a;else{r=M_.newFloatArray(c);const e=t.readInt(!0);if(o+=e,1==i)for(let n=e;n<o;n++)r[n]=t.readFloat();else for(let n=e;n<o;n++)r[n]=t.readFloat()*i;if(!s)for(let t=0,e=r.length;t<e;t++)r[t]+=a[t]}if(d.setFrame(e,f,r),e==h)break;const l=t.readFloat();switch(t.readByte()){case jT:d.setStepped(e);break;case HT:xT(t,d,n++,e,0,f,l,0,1,1)}f=l}r.push(d);break}case NT:{const e=new Ob(l,n,o);for(let n=0;n<l;n++){const r=t.readFloat(),i=t.readInt32();e.setFrame(n,r,tb[15&i],i>>4,t.readFloat())}r.push(e);break}}}}}const s=t.readInt(!0);if(s>0){const e=new Eb(s),i=n.slots.length;for(let n=0;n<s;n++){const r=t.readFloat(),s=t.readInt(!0),o=M_.newArray(i,0);for(let t=i-1;t>=0;t--)o[t]=-1;const a=M_.newArray(i-s,0);let l=0,h=0;for(let e=0;e<s;e++){const e=t.readInt(!0);for(;l!=e;)a[h++]=l++;o[l+t.readInt(!0)]=l++}for(;l<i;)a[h++]=l++;for(let t=i-1;t>=0;t--)-1==o[t]&&(o[t]=a[--h]);e.setFrame(n,r,o)}r.push(e)}const o=t.readInt(!0);if(o>0){const e=new Sb(o);for(let r=0;r<o;r++){const i=t.readFloat(),s=n.events[t.readInt(!0)],o=new aT(i,s);o.intValue=t.readInt(!1),o.floatValue=t.readFloat(),o.stringValue=t.readBoolean()?t.readString():s.stringValue,o.data.audioPath&&(o.volume=t.readFloat(),o.balance=t.readFloat()),e.setFrame(r,o)}r.push(e)}let a=0;for(let t=0,e=r.length;t<e;t++)a=Math.max(a,r[t].getDuration());return new eb(e,r,a)}}pT.BlendModeValues=[P.NORMAL,P.ADD,P.MULTIPLY,P.SCREEN];class mT{constructor(t,e,n,r,i){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=r,this.inheritTimeline=i}}class gT{constructor(t=null,e=null){this.bones=t,this.vertices=e}}function vT(t,e,n){let r=t.readFloat(),i=t.readFloat()*n;for(let s=0,o=0,a=e.getFrameCount()-1;e.setFrame(s,r,i),s!=a;s++){const a=t.readFloat(),l=t.readFloat()*n;switch(t.readByte()){case jT:e.setStepped(s);break;case HT:xT(t,e,o++,s,0,r,a,i,l,n)}r=a,i=l}return e}function yT(t,e,n){let r=t.readFloat(),i=t.readFloat()*n,s=t.readFloat()*n;for(let o=0,a=0,l=e.getFrameCount()-1;e.setFrame(o,r,i,s),o!=l;o++){const l=t.readFloat(),h=t.readFloat()*n,c=t.readFloat()*n;switch(t.readByte()){case jT:e.setStepped(o);break;case HT:xT(t,e,a++,o,0,r,l,i,h,n),xT(t,e,a++,o,1,r,l,s,c,n)}r=l,i=h,s=c}return e}function xT(t,e,n,r,i,s,o,a,l,h){e.setBezier(n,r,i,s,a,t.readFloat(),t.readFloat()*h,t.readFloat(),t.readFloat()*h,o,l)}const wT=0,_T=1,bT=2,TT=3,ST=4,AT=5,ET=6,CT=7,kT=8,MT=9,PT=0,IT=1,RT=2,OT=3,LT=4,DT=5,FT=0,NT=1,BT=0,WT=1,UT=2,jT=1,HT=2;class zT{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,n=new lT,r="string"==typeof t?JSON.parse(t):t,i=r.skeleton;if(i){n.hash=i.hash,n.version=i.spine;const t=n.version.substr(0,3);if("4.0"!==t&&"4.1"!==t){const t=`Spine 4.1 loader cant load version ${i.spine}. Please configure your pixi-spine bundle`;console.error(t)}n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height,n.fps=i.fps,n.imagesPath=i.images}if(r.bones)for(let t=0;t<r.bones.length;t++){const i=r.bones[t];let s=null;const o=$T(i,"parent",null);if(null!=o&&(s=n.findBone(o),null==s))throw new Error(`Parent bone not found: ${o}`);const a=new qb(n.bones.length,i.name,s);a.length=$T(i,"length",0)*e,a.x=$T(i,"x",0)*e,a.y=$T(i,"y",0)*e,a.rotation=$T(i,"rotation",0),a.scaleX=$T(i,"scaleX",1),a.scaleY=$T(i,"scaleY",1),a.shearX=$T(i,"shearX",0),a.shearY=$T(i,"shearY",0),a.transformMode=M_.enumValue(f_,$T(i,"transform","Normal")),a.skinRequired=$T(i,"skin",!1);const l=$T(i,"color",null);l&&a.color.setFromString(l),n.bones.push(a)}if(r.slots)for(let t=0;t<r.slots.length;t++){const e=r.slots[t],i=n.findBone(e.bone);if(!i)throw new Error(`Couldn't find bone ${e.bone} for slot ${e.name}`);const s=new hT(n.slots.length,e.name,i),o=$T(e,"color",null);o&&s.color.setFromString(o);const a=$T(e,"dark",null);a&&(s.darkColor=A_.fromString(a)),s.attachmentName=$T(e,"attachment",null),s.blendMode=zT.blendModeFromString($T(e,"blend","normal")),n.slots.push(s)}if(r.ik)for(let t=0;t<r.ik.length;t++){const i=r.ik[t],s=new Qb(i.name);s.order=$T(i,"order",0),s.skinRequired=$T(i,"skin",!1);for(let t=0;t<i.bones.length;t++){const e=i.bones[t],r=n.findBone(e);if(null==r)throw new Error(`IK bone not found: ${e}`);s.bones.push(r)}s.target=n.findBone(i.target),s.mix=$T(i,"mix",1),s.softness=$T(i,"softness",0)*e,s.bendDirection=$T(i,"bendPositive",!0)?1:-1,s.compress=$T(i,"compress",!1),s.stretch=$T(i,"stretch",!1),s.uniform=$T(i,"uniform",!1),n.ikConstraints.push(s)}if(r.transform)for(let t=0;t<r.transform.length;t++){const i=r.transform[t],s=new cT(i.name);s.order=$T(i,"order",0),s.skinRequired=$T(i,"skin",!1);for(let t=0;t<i.bones.length;t++){const e=i.bones[t],r=n.findBone(e);if(!r)throw new Error(`Couldn't find bone ${e} for transform constraint ${i.name}.`);s.bones.push(r)}const o=i.target,a=n.findBone(o);if(!a)throw new Error(`Couldn't find target bone ${o} for transform constraint ${i.name}.`);s.target=a,s.local=$T(i,"local",!1),s.relative=$T(i,"relative",!1),s.offsetRotation=$T(i,"rotation",0),s.offsetX=$T(i,"x",0)*e,s.offsetY=$T(i,"y",0)*e,s.offsetScaleX=$T(i,"scaleX",0),s.offsetScaleY=$T(i,"scaleY",0),s.offsetShearY=$T(i,"shearY",0),s.mixRotate=$T(i,"mixRotate",1),s.mixX=$T(i,"mixX",1),s.mixY=$T(i,"mixY",s.mixX),s.mixScaleX=$T(i,"mixScaleX",1),s.mixScaleY=$T(i,"mixScaleY",s.mixScaleX),s.mixShearY=$T(i,"mixShearY",1),n.transformConstraints.push(s)}if(r.path)for(let t=0;t<r.path.length;t++){const i=r.path[t],s=new Jb(i.name);s.order=$T(i,"order",0),s.skinRequired=$T(i,"skin",!1);for(let t=0;t<i.bones.length;t++){const e=i.bones[t],r=n.findBone(e);if(!r)throw new Error(`Couldn't find bone ${e} for path constraint ${i.name}.`);s.bones.push(r)}const o=i.target,a=n.findSlot(o);if(!a)throw new Error(`Couldn't find target slot ${o} for path constraint ${i.name}.`);s.target=a,s.positionMode=M_.enumValue(u_,$T(i,"positionMode","Percent")),s.spacingMode=M_.enumValue(tT,$T(i,"spacingMode","Length")),s.rotateMode=M_.enumValue(d_,$T(i,"rotateMode","Tangent")),s.offsetRotation=$T(i,"rotation",0),s.position=$T(i,"position",0),s.positionMode==u_.Fixed&&(s.position*=e),s.spacing=$T(i,"spacing",0),s.spacingMode!=tT.Length&&s.spacingMode!=tT.Fixed||(s.spacing*=e),s.mixRotate=$T(i,"mixRotate",1),s.mixX=$T(i,"mixX",1),s.mixY=$T(i,"mixY",s.mixX),n.pathConstraints.push(s)}if(r.skins)for(let t=0;t<r.skins.length;t++){const e=r.skins[t],i=new dT(e.name);if(e.bones)for(let t=0;t<e.bones.length;t++){const r=e.bones[t],s=n.findBone(r);if(!s)throw new Error(`Couldn't find bone ${r} for skin ${e.name}.`);i.bones.push(s)}if(e.ik)for(let t=0;t<e.ik.length;t++){const r=e.ik[t],s=n.findIkConstraint(r);if(!s)throw new Error(`Couldn't find IK constraint ${r} for skin ${e.name}.`);i.constraints.push(s)}if(e.transform)for(let t=0;t<e.transform.length;t++){const r=e.transform[t],s=n.findTransformConstraint(r);if(!s)throw new Error(`Couldn't find transform constraint ${r} for skin ${e.name}.`);i.constraints.push(s)}if(e.path)for(let t=0;t<e.path.length;t++){const r=e.path[t],s=n.findPathConstraint(r);if(!s)throw new Error(`Couldn't find path constraint ${r} for skin ${e.name}.`);i.constraints.push(s)}for(const t in e.attachments){const r=n.findSlot(t);if(!r)throw new Error(`Couldn't find slot ${t} for skin ${e.name}.`);const s=e.attachments[t];for(const t in s){const e=this.readAttachment(s[t],i,r.index,t,n);e&&i.setAttachment(r.index,t,e)}}n.skins.push(i),"default"==i.name&&(n.defaultSkin=i)}for(let t=0,e=this.linkedMeshes.length;t<e;t++){const e=this.linkedMeshes[t],r=e.skin?n.findSkin(e.skin):n.defaultSkin;if(!r)throw new Error(`Skin not found: ${e.skin}`);const i=r.getAttachment(e.slotIndex,e.parent);if(!i)throw new Error(`Parent mesh not found: ${e.parent}`);e.mesh.timelineAttachment=e.inheritTimeline?i:e.mesh,e.mesh.setParentMesh(i)}if(this.linkedMeshes.length=0,r.events)for(const t in r.events){const e=r.events[t],i=new fT(t);i.intValue=$T(e,"int",0),i.floatValue=$T(e,"float",0),i.stringValue=$T(e,"string",""),i.audioPath=$T(e,"audio",null),i.audioPath&&(i.volume=$T(e,"volume",1),i.balance=$T(e,"balance",0)),n.events.push(i)}if(r.animations)for(const t in r.animations){const e=r.animations[t];this.readAnimation(e,t,n)}return n}readAttachment(t,e,n,r,i){const s=this.scale;switch(r=$T(t,"name",r),$T(t,"type","region")){case"region":{const n=$T(t,"path",r),i=this.readSequence($T(t,"sequence",null)),o=this.attachmentLoader.newRegionAttachment(e,r,n,i);if(!o)return null;o.path=n,o.x=$T(t,"x",0)*s,o.y=$T(t,"y",0)*s,o.scaleX=$T(t,"scaleX",1),o.scaleY=$T(t,"scaleY",1),o.rotation=$T(t,"rotation",0),o.width=t.width*s,o.height=t.height*s,o.sequence=i;const a=$T(t,"color",null);return a&&o.color.setFromString(a),o}case"boundingbox":{const n=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(!n)return null;this.readVertices(t,n,t.vertexCount<<1);const i=$T(t,"color",null);return i&&n.color.setFromString(i),n}case"mesh":case"linkedmesh":{const i=$T(t,"path",r),o=this.readSequence($T(t,"sequence",null)),a=this.attachmentLoader.newMeshAttachment(e,r,i,o);if(!a)return null;a.path=i;const l=$T(t,"color",null);l&&a.color.setFromString(l),a.width=$T(t,"width",0)*s,a.height=$T(t,"height",0)*s,a.sequence=o;const h=$T(t,"parent",null);if(h)return this.linkedMeshes.push(new GT(a,$T(t,"skin",null),n,h,$T(t,"timelines",!0))),a;const c=t.uvs;return this.readVertices(t,a,c.length),a.triangles=t.triangles,a.regionUVs=new Float32Array(c),a.edges=$T(t,"edges",null),a.hullLength=2*$T(t,"hull",0),a}case"path":{const n=this.attachmentLoader.newPathAttachment(e,r);if(!n)return null;n.closed=$T(t,"closed",!1),n.constantSpeed=$T(t,"constantSpeed",!0);const i=t.vertexCount;this.readVertices(t,n,i<<1);const o=M_.newArray(i/3,0);for(let e=0;e<t.lengths.length;e++)o[e]=t.lengths[e]*s;n.lengths=o;const a=$T(t,"color",null);return a&&n.color.setFromString(a),n}case"point":{const n=this.attachmentLoader.newPointAttachment(e,r);if(!n)return null;n.x=$T(t,"x",0)*s,n.y=$T(t,"y",0)*s,n.rotation=$T(t,"rotation",0);const i=$T(t,"color",null);return i&&n.color.setFromString(i),n}case"clipping":{const n=this.attachmentLoader.newClippingAttachment(e,r);if(!n)return null;const s=$T(t,"end",null);if(null!=s){const t=i.findSlot(s);if(null==t)throw new Error(`Clipping end slot not found: ${s}`);n.endSlot=t}const o=t.vertexCount;this.readVertices(t,n,o<<1);const a=$T(t,"color",null);return a&&n.color.setFromString(a),n}}return null}readSequence(t){if(null==t)return null;const e=new Q_($T(t,"count",0));return e.start=$T(t,"start",1),e.digits=$T(t,"digits",0),e.setupIndex=$T(t,"setup",0),e}readVertices(t,e,n){const r=this.scale;e.worldVerticesLength=n;const i=t.vertices;if(n==i.length){const t=M_.toFloatArray(i);if(1!=r)for(let e=0,n=i.length;e<n;e++)t[e]*=r;return void(e.vertices=t)}const s=new Array,o=new Array;for(let t=0,e=i.length;t<e;){const e=i[t++];o.push(e);for(let n=t+4*e;t<n;t+=4)o.push(i[t]),s.push(i[t+1]*r),s.push(i[t+2]*r),s.push(i[t+3])}e.bones=o,e.vertices=M_.toFloatArray(s)}readAnimation(t,e,n){const r=this.scale,i=new Array;if(t.slots)for(const e in t.slots){const r=t.slots[e],s=n.findSlot(e);if(!s)throw new Error(`Slot not found: ${e}`);const o=s.index;for(const t in r){const e=r[t];if(!e)continue;const n=e.length;if("attachment"==t){const t=new _b(n,o);for(let r=0;r<n;r++){const n=e[r];t.setFrame(r,$T(n,"time",0),$T(n,"name",null))}i.push(t)}else if("rgba"==t){const t=new gb(n,n<<2,o);let r=e[0],s=$T(r,"time",0),a=A_.fromString(r.color);for(let n=0,i=0;;n++){t.setFrame(n,s,a.r,a.g,a.b,a.a);const o=e[n+1];if(!o){t.shrink(i);break}const l=$T(o,"time",0),h=A_.fromString(o.color),c=r.curve;c&&(i=YT(c,t,i,n,0,s,l,a.r,h.r,1),i=YT(c,t,i,n,1,s,l,a.g,h.g,1),i=YT(c,t,i,n,2,s,l,a.b,h.b,1),i=YT(c,t,i,n,3,s,l,a.a,h.a,1)),s=l,a=h,r=o}i.push(t)}else if("rgb"==t){const t=new vb(n,3*n,o);let r=e[0],s=$T(r,"time",0),a=A_.fromString(r.color);for(let n=0,i=0;;n++){t.setFrame(n,s,a.r,a.g,a.b);const o=e[n+1];if(!o){t.shrink(i);break}const l=$T(o,"time",0),h=A_.fromString(o.color),c=r.curve;c&&(i=YT(c,t,i,n,0,s,l,a.r,h.r,1),i=YT(c,t,i,n,1,s,l,a.g,h.g,1),i=YT(c,t,i,n,2,s,l,a.b,h.b,1)),s=l,a=h,r=o}i.push(t)}else if("alpha"==t)i.push(VT(e,new yb(n,n,o),0,1));else if("rgba2"==t){const t=new xb(n,7*n,o);let r=e[0],s=$T(r,"time",0),a=A_.fromString(r.light),l=A_.fromString(r.dark);for(let n=0,i=0;;n++){t.setFrame(n,s,a.r,a.g,a.b,a.a,l.r,l.g,l.b);const o=e[n+1];if(!o){t.shrink(i);break}const h=$T(o,"time",0),c=A_.fromString(o.light),u=A_.fromString(o.dark),d=r.curve;d&&(i=YT(d,t,i,n,0,s,h,a.r,c.r,1),i=YT(d,t,i,n,1,s,h,a.g,c.g,1),i=YT(d,t,i,n,2,s,h,a.b,c.b,1),i=YT(d,t,i,n,3,s,h,a.a,c.a,1),i=YT(d,t,i,n,4,s,h,l.r,u.r,1),i=YT(d,t,i,n,5,s,h,l.g,u.g,1),i=YT(d,t,i,n,6,s,h,l.b,u.b,1)),s=h,a=c,l=u,r=o}i.push(t)}else if("rgb2"==t){const t=new wb(n,6*n,o);let r=e[0],s=$T(r,"time",0),a=A_.fromString(r.light),l=A_.fromString(r.dark);for(let n=0,i=0;;n++){t.setFrame(n,s,a.r,a.g,a.b,l.r,l.g,l.b);const o=e[n+1];if(!o){t.shrink(i);break}const h=$T(o,"time",0),c=A_.fromString(o.light),u=A_.fromString(o.dark),d=r.curve;d&&(i=YT(d,t,i,n,0,s,h,a.r,c.r,1),i=YT(d,t,i,n,1,s,h,a.g,c.g,1),i=YT(d,t,i,n,2,s,h,a.b,c.b,1),i=YT(d,t,i,n,3,s,h,l.r,u.r,1),i=YT(d,t,i,n,4,s,h,l.g,u.g,1),i=YT(d,t,i,n,5,s,h,l.b,u.b,1)),s=h,a=c,l=u,r=o}i.push(t)}}}if(t.bones)for(const e in t.bones){const s=t.bones[e],o=n.findBone(e);if(!o)throw new Error(`Bone not found: ${e}`);const a=o.index;for(const t in s){const e=s[t],n=e.length;if(0!=n)if("rotate"===t)i.push(VT(e,new ob(n,n,a),0,1));else if("translate"===t){const t=new ab(n,n<<1,a);i.push(XT(e,t,"x","y",0,r))}else if("translatex"===t){const t=new lb(n,n,a);i.push(VT(e,t,0,r))}else if("translatey"===t){const t=new hb(n,n,a);i.push(VT(e,t,0,r))}else if("scale"===t){const t=new cb(n,n<<1,a);i.push(XT(e,t,"x","y",1,1))}else if("scalex"===t){const t=new ub(n,n,a);i.push(VT(e,t,1,1))}else if("scaley"===t){const t=new db(n,n,a);i.push(VT(e,t,1,1))}else if("shear"===t){const t=new fb(n,n<<1,a);i.push(XT(e,t,"x","y",0,1))}else if("shearx"===t){const t=new pb(n,n,a);i.push(VT(e,t,0,1))}else if("sheary"===t){const t=new mb(n,n,a);i.push(VT(e,t,0,1))}}}if(t.ik)for(const e in t.ik){const s=t.ik[e];let o=s[0];if(!o)continue;const a=n.findIkConstraint(e);if(!a)throw new Error(`IK Constraint not found: ${e}`);const l=n.ikConstraints.indexOf(a),h=new Cb(s.length,s.length<<1,l);let c=$T(o,"time",0),u=$T(o,"mix",1),d=$T(o,"softness",0)*r;for(let t=0,e=0;;t++){h.setFrame(t,c,u,d,$T(o,"bendPositive",!0)?1:-1,$T(o,"compress",!1),$T(o,"stretch",!1));const n=s[t+1];if(!n){h.shrink(e);break}const i=$T(n,"time",0),a=$T(n,"mix",1),l=$T(n,"softness",0)*r,f=o.curve;f&&(e=YT(f,h,e,t,0,c,i,u,a,1),e=YT(f,h,e,t,1,c,i,d,l,r)),c=i,u=a,d=l,o=n}i.push(h)}if(t.transform)for(const e in t.transform){const r=t.transform[e];let s=r[0];if(!s)continue;const o=n.findTransformConstraint(e);if(!o)throw new Error(`Transform constraint not found: ${e}`);const a=n.transformConstraints.indexOf(o),l=new kb(r.length,6*r.length,a);let h=$T(s,"time",0),c=$T(s,"mixRotate",1),u=$T(s,"mixX",1),d=$T(s,"mixY",u),f=$T(s,"mixScaleX",1),p=$T(s,"mixScaleY",f);const m=$T(s,"mixShearY",1);for(let t=0,e=0;;t++){l.setFrame(t,h,c,u,d,f,p,m);const n=r[t+1];if(!n){l.shrink(e);break}const i=$T(n,"time",0),o=$T(n,"mixRotate",1),a=$T(n,"mixX",1),g=$T(n,"mixY",a),v=$T(n,"mixScaleX",1),y=$T(n,"mixScaleY",v),x=$T(n,"mixShearY",1),w=s.curve;w&&(e=YT(w,l,e,t,0,h,i,c,o,1),e=YT(w,l,e,t,1,h,i,u,a,1),e=YT(w,l,e,t,2,h,i,d,g,1),e=YT(w,l,e,t,3,h,i,f,v,1),e=YT(w,l,e,t,4,h,i,p,y,1),e=YT(w,l,e,t,5,h,i,m,x,1)),h=i,c=o,u=a,d=g,f=v,p=y,f=v,s=n}i.push(l)}if(t.path)for(const e in t.path){const s=t.path[e],o=n.findPathConstraint(e);if(!o)throw new Error(`Path constraint not found: ${e}`);const a=n.pathConstraints.indexOf(o);for(const t in s){const e=s[t];let n=e[0];if(!n)continue;const l=e.length;if("position"===t){const t=new Mb(l,l,a);i.push(VT(e,t,0,o.positionMode==u_.Fixed?r:1))}else if("spacing"===t){const t=new Pb(l,l,a);i.push(VT(e,t,0,o.spacingMode==tT.Length||o.spacingMode==tT.Fixed?r:1))}else if("mix"===t){const t=new Ib(l,3*l,a);let r=$T(n,"time",0),s=$T(n,"mixRotate",1),o=$T(n,"mixX",1),h=$T(n,"mixY",o);for(let i=0,a=0;;i++){t.setFrame(i,r,s,o,h);const l=e[i+1];if(!l){t.shrink(a);break}const c=$T(l,"time",0),u=$T(l,"mixRotate",1),d=$T(l,"mixX",1),f=$T(l,"mixY",d),p=n.curve;p&&(a=YT(p,t,a,i,0,r,c,s,u,1),a=YT(p,t,a,i,1,r,c,o,d,1),a=YT(p,t,a,i,2,r,c,h,f,1)),r=c,s=u,o=d,h=f,n=l}i.push(t)}}}if(t.deform){t.attachments={};for(const e in t.deform){const n=t.deform[e],r=t.attachments[e]={};for(const t in n){const e=n[t],i=r[t]={};for(const t in e)i[t]={deform:e[t]}}}}if(t.attachments)for(const e in t.attachments){const s=t.attachments[e],o=n.findSkin(e);if(null!=o)for(const t in s){const e=s[t],a=n.findSlot(t);if(!a)throw new Error(`Slot not found: ${t}`);const l=a.index;for(const t in e){const n=e[t],s=o.getAttachment(l,t);for(const t in n){const e=n[t];let o=e[0];if(o)if("deform"==t){const t=s.bones,n=s.vertices,a=t?n.length/3*2:n.length,h=new bb(e.length,e.length,l,s);let c=$T(o,"time",0);for(let i=0,s=0;;i++){let l;const u=$T(o,"vertices",null);if(u){l=M_.newFloatArray(a);const e=$T(o,"offset",0);if(M_.arrayCopy(u,0,l,e,u.length),1!=r)for(let t=e,n=t+u.length;t<n;t++)l[t]*=r;if(!t)for(let t=0;t<a;t++)l[t]+=n[t]}else l=t?M_.newFloatArray(a):n;h.setFrame(i,c,l);const d=e[i+1];if(!d){h.shrink(s);break}const f=$T(d,"time",0),p=o.curve;p&&(s=YT(p,h,s,i,0,c,f,0,1,1)),c=f,o=d}i.push(h)}else if("sequence"==t){const t=new Ob(e.length,l,s);let n=0;for(let r=0;r<e.length;r++){const i=$T(o,"delay",n),s=$T(o,"time",0),a=J_[$T(o,"mode","hold")],l=$T(o,"index",0);t.setFrame(r,s,a,l,i),n=i,o=e[r+1]}i.push(t)}}}}}if(t.drawOrder){const e=new Eb(t.drawOrder.length),r=n.slots.length;let s=0;for(let i=0;i<t.drawOrder.length;i++,s++){const o=t.drawOrder[i];let a=null;const l=$T(o,"offsets",null);if(l){a=M_.newArray(r,-1);const t=M_.newArray(r-l.length,0);let e=0,i=0;for(let r=0;r<l.length;r++){const s=l[r],o=n.findSlot(s.slot);if(!o)throw new Error(`Slot not found: ${o}`);const h=o.index;for(;e!=h;)t[i++]=e++;a[e+s.offset]=e++}for(;e<r;)t[i++]=e++;for(let e=r-1;e>=0;e--)-1==a[e]&&(a[e]=t[--i])}e.setFrame(s,$T(o,"time",0),a)}i.push(e)}if(t.events){const e=new Sb(t.events.length);let r=0;for(let i=0;i<t.events.length;i++,r++){const s=t.events[i],o=n.findEvent(s.name);if(!o)throw new Error(`Event not found: ${s.name}`);const a=new aT(M_.toSinglePrecision($T(s,"time",0)),o);a.intValue=$T(s,"int",o.intValue),a.floatValue=$T(s,"float",o.floatValue),a.stringValue=$T(s,"string",o.stringValue),a.data.audioPath&&(a.volume=$T(s,"volume",1),a.balance=$T(s,"balance",0)),e.setFrame(r,a)}i.push(e)}let s=0;for(let t=0,e=i.length;t<e;t++)s=Math.max(s,i[t].getDuration());if(isNaN(s))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new eb(e,i,s))}static blendModeFromString(t){if("normal"==(t=t.toLowerCase()))return P.NORMAL;if("additive"==t)return P.ADD;if("multiply"==t)return P.MULTIPLY;if("screen"==t)return P.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}}class GT{constructor(t,e,n,r,i){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=r,this.inheritTimeline=i}}function VT(t,e,n,r){let i=t[0],s=$T(i,"time",0),o=$T(i,"value",n)*r,a=0;for(let l=0;;l++){e.setFrame(l,s,o);const h=t[l+1];if(!h)return e.shrink(a),e;const c=$T(h,"time",0),u=$T(h,"value",n)*r;i.curve&&(a=YT(i.curve,e,a,l,0,s,c,o,u,r)),s=c,o=u,i=h}}function XT(t,e,n,r,i,s){let o=t[0],a=$T(o,"time",0),l=$T(o,n,i)*s,h=$T(o,r,i)*s,c=0;for(let u=0;;u++){e.setFrame(u,a,l,h);const d=t[u+1];if(!d)return e.shrink(c),e;const f=$T(d,"time",0),p=$T(d,n,i)*s,m=$T(d,r,i)*s,g=o.curve;g&&(c=YT(g,e,c,u,0,a,f,l,p,s),c=YT(g,e,c,u,1,a,f,h,m,s)),a=f,l=p,h=m,o=d}}function YT(t,e,n,r,i,s,o,a,l,h){if("stepped"==t)return e.setStepped(r),n;const c=i<<2,u=t[c],d=t[c+1]*h,f=t[c+2],p=t[c+3]*h;return e.setBezier(n,r,i,s,a,u,d,f,p,o,l),n+1}function $T(t,e,n){return void 0!==t[e]?t[e]:n}class qT{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,n){const r=this.skeletonData.findAnimation(t);if(!r)throw new Error(`Animation not found: ${t}`);const i=this.skeletonData.findAnimation(e);if(!i)throw new Error(`Animation not found: ${e}`);this.setMixWith(r,i,n)}setMixWith(t,e,n){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");const r=`${t.name}.${e.name}`;this.animationToMixTime[r]=n}getMix(t,e){const n=`${t.name}.${e.name}`,r=this.animationToMixTime[n];return void 0===r?this.defaultMix:r}}class KT extends F_{createSkeleton(t){this.skeleton=new oT(t),this.skeleton.updateWorldTransform(),this.stateData=new qT(t),this.state=new Db(this.stateData)}}(new class extends U_{createBinaryParser(){return new pT(null)}createJsonParser(){return new zT(null)}parseData(t,e,n){const r=t;return r.attachmentLoader=new Yb(e),{spineData:r.readSkeletonData(n),spineAtlas:e}}}).installLoader();var ZT=_((function t(){v(this,t)}));function QT(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function JT(t,e){return t.get(tS(t,e))}function tS(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}E(ZT,"getSlotsRecursively",(function(t,e){if(null==t||!t.skeleton)return console.error("[EntityManager findAllSlots] Скелет отсутствует в spineLevelComponent"),[];var n=t.skeleton.findBone(e);if(!n)return"idle"===e||console.warn("[EntityManager findAllSlots] Кость с именем ".concat(e," не найдена")),[];var r=function(t){var e;if(!t)return console.warn("[EntityManager collectSlots] Пустая кость передана в рекурсию"),[];var n,i=(null===(e=t.skeleton)||void 0===e?void 0:e.slots.filter((function(e){return e.bone===t})))||[],s=t.children||[];return Array.isArray(s)||console.warn("[EntityManager collectSlots] У кости ".concat(null===(n=t.data)||void 0===n?void 0:n.name," нет массива дочерних костей")),s.forEach((function(t){i.push.apply(i,Jc(r(t)))})),i};return r(n).filter((function(t){var e;return!(null===(e=t.attachment)||void 0===e||!e.name)||(console.warn("[EntityManager findAllSlots] Не обнаружен валидный спрайт в слоте","\n        bone name: ".concat(t.data.boneData.name,",\n        slot.data.name: ").concat(t.data.name,",\n        slot: ").concat(t,"\n        ")),!1)}))})),E(ZT,"findSlots",(function(t,e){var n=e.hogItemsBone,r=e.spineName,i=e.currentSkinName,s=t.skeleton.findBone(n);return s.skeleton.slots.filter((function(t){return t.bone===s})).filter((function(t){var e,n;if(null!==(e=t.attachment)&&void 0!==e&&e.name){if(null!==(n=t.attachment)&&void 0!==n&&n.name)return t}else{var s;if("level0"===r&&"mode1/skin_mode1_v1"===i)return;console.error("[EntityManager findSlots] не обнаружен спрайт в слоте ".concat(null==t||null===(s=t.data)||void 0===s?void 0:s.name),t)}}))})),E(ZT,"createSpine",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.spineName,n=t.scale,r=void 0===n?1:n,i=t.speed,s=void 0===i?1:i,o=t.duration,a=void 0===o?1:o,l=t.loop,h=void 0!==l&&l,c=t.skinName,u=void 0===c?"default":c,d=t.animationName,f=void 0===d?"animation":d,p=t.autorun,m=void 0!==p&&p,g=Fo.get("".concat(e,".spineData"));if(g){var v=new KT(g);if(v.scale.set(r),v.state.timeScale=s,v.skeleton.setSkinByName(u),m){var y=v.state.setAnimation(0,f,h);y.animationEnd=y.animationEnd*a}return v}console.error("Spine data for ".concat(e," not found"))})),E(ZT,"spineParserLogs",(function(t,e){console.groupCollapsed("added spine: %c%s","color: #3AE2CE;",t.name,"pngName:",e,"animName",t.json.animations),console.log("skins:",t.json.skins),console.groupEnd()})),E(ZT,"spineParser",(function(t){Jc(t).forEach((function(t){try{var e=t.name,n=t.atlas,r=t.json,i=n.split("\n").find((function(t){return t.includes(".png")})),s=i?i.replace(".png","").trim():"",o=new x_(n,(function(t,e){var n;e(null===(n=Fo.get(s))||void 0===n?void 0:n.baseTexture)})),a=new Yb(o),l=new zT(a);Fo.cache._cache.set("".concat(e,".spineData"),l.readSkeletonData(r))}catch(t){console.warn("[spineParser]",t)}}))})),E(ZT,"getSlotSpritePosition",(function(t){var e=t.sprite;if(t.isMesh){var n=e.getLocalBounds(),r=n.x,i=n.y;return{x:r+n.width/2,y:i+n.height/2}}return{x:e.x,y:Math.abs(e.y)}}));var eS=new WeakMap,nS=new WeakMap,rS=_((function t(e){var n=this,r=e.spineName,i=e.currentSkinName;v(this,t),QT(this,eS,null),QT(this,nS,(function(){if(function(t,e,n){t.set(tS(t,e),n)}(eS,n,ZT.createSpine({spineName:n.spineName,skinName:n.currentSkinName,autorun:!1,loop:!1})),JT(eS,n).spineData.animations.some((function(t){return"idle"===t.name}))){if("level6"===n.spineName)return;JT(eS,n).state.setAnimation(0,"idle",!0)}n.spine.eventMode="static"})),this.spineName=r,this.currentSkinName=i,JT(nS,this).call(this)}),[{key:"spine",get:function(){return JT(eS,this)}}]);function iS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(iS=function(){return!!t})()}function sS(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function oS(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var aS=new WeakMap,lS=new WeakMap,hS=new WeakMap,cS=new WeakMap,uS=new WeakMap,dS=new WeakMap,fS=new WeakMap,pS=new WeakMap,mS=new WeakMap,gS=new WeakMap,vS=function(t){function e(){var t;return v(this,e),t=function(t,e){return e=T(e),b(t,iS()?Reflect.construct(e,[],T(t).constructor):e.apply(t,void 0))}(this,e),sS(t,aS,window.game),sS(t,lS,oS(aS,t).refs),E(t,"slotContainer",null),E(t,"sprite",null),E(t,"isMesh",!1),E(t,"isAlive",!0),E(t,"debugRect",null),E(t,"eventMode","static"),E(t,"onHandlerUp",(function(){t.view.eventMode="auto",bw(t.hintTimeline,!0,1),oS(aS,t).emit(ph,t),ww.timeline().to(t.sprite,{alpha:1}).to(t.view,{alpha:0,duration:.5},"<").eventCallback("onComplete",oS(pS,t))})),E(t,"init",function(){var e=Jh(nc().mark((function e(n,r){var i;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.skeleton.findSlotIndex(n.data.name),t.slotContainer=r.slotContainers[i],e.next=4,oS(cS,t).call(t);case 4:oS(uS,t).call(t),oS(dS,t).call(t),oS(fS,t).call(t),oS(gS,t).call(t);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),sS(t,hS,(function(){})),sS(t,cS,(function(){return new Promise((function(e){var n=function(){t.slotContainer&&t.slotContainer.children.length>0?e():ww.delayedCall(.1,n)};ww.delayedCall(.1,n)}))})),sS(t,uS,(function(){t.sprite=t.slotContainer.children.find((function(e){return e instanceof L_&&(t.isMesh=!0),e instanceof O_||e instanceof L_})),t.sprite.initAlpha=t.sprite.alpha,t.view.addChild(t.sprite)})),sS(t,dS,(function(){var e=t.sprite.attachment.name.split("/")[1];t.name=e})),sS(t,fS,(function(){t.view.pivot.set(t.sprite.x,t.sprite.y),t.view.position.set(t.sprite.x,t.sprite.y),t.slotContainer.addChild(t.view)})),sS(t,pS,(function(){t.slotContainer.removeChild(t.view),t.isAlive=!1,t.sprite.filters=[],t.view.eventMode="none",oS(aS,t).off(fh,oS(mS,t)),oS(aS,t).off(ph,t)})),sS(t,mS,(function(e){t.debugRect.visible=e})),sS(t,gS,(function(){var e=t.sprite.getLocalBounds(),n=new Ya;n.lineStyle(8,582144),n.drawRect(e.x,e.y,e.width,e.height),n.visible=t.player.isDebug,t.debugRect=n,t.sprite.addChild(n)})),t.view=t,t.typeName="hogItemContainer",t.player=tf.get(Zd),oS(aS,t).on(fh,oS(mS,t)),t}return A(e,t),_(e)}(rs);function yS(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function xS(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var wS=new WeakMap,_S=new WeakMap,bS=_((function t(){var e=this;v(this,t),E(this,"slotContainer",null),E(this,"init",function(){var t=Jh(nc().mark((function t(n,r){var i;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.skeleton.findSlotIndex(n.data.name),e.slotContainer=r.slotContainers[i],t.next=4,xS(wS,e).call(e);case 4:xS(_S,e).call(e);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),yS(this,wS,(function(){return new Promise((function(t){var n=function(){e.slotContainer&&e.slotContainer.children.length>0?t():ww.delayedCall(.1,n)};ww.delayedCall(.1,n)}))})),yS(this,_S,(function(){e.slotContainer.children.find((function(t){return t.eventMode="none"}))})),this.view=this}));function TS(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function SS(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var AS=new WeakMap,ES=new WeakMap,CS=new WeakMap,kS=new WeakMap,MS=new WeakMap,PS=_((function t(e){var n=this;v(this,t),TS(this,AS,[]),E(this,"createEntities",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,SS(ES,n).call(n);case 2:return t.next=4,SS(CS,n).call(n);case 4:return SS(MS,n).call(n,"decorItems"),SS(MS,n).call(n,"idle"),t.abrupt("return",Promise.resolve());case 7:case"end":return t.stop()}}),t)})))),TS(this,ES,Jh(nc().mark((function t(){var e,r,i;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.config.bgTexture,r=new r_(e),(i=new o_(r,e)).view.alpha=1,r.addComponent(i),n.entities.set(r.id,r),t.abrupt("return",Promise.resolve());case 7:case"end":return t.stop()}}),t)})))),TS(this,CS,Jh(nc().mark((function t(){var e,r,i;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=n.config.spineName,r=new r_(e),i=new rS(n.config),r.addComponent(i),n.entities.set(r.id,r);case 5:case"end":return t.stop()}}),t)})))),TS(this,kS,(function(t){return n.entities.get(t)})),E(this,"initHogItems",(function(t){t.forEach((function(t){var e=new vS;SS(AS,n).push(e),e.init(t,n.spineLevelComponent).then((function(){return window.game.emit(xh,e)}))}))})),TS(this,MS,(function(t){ZT.getSlotsRecursively(n.spineLevelComponent,t).forEach((function(t){(new bS).init(t,n.spineLevelComponent)}))})),this.config=e,this.entities=new Map}),[{key:"initialHogItems",get:function(){return SS(AS,this)}},{key:"spineLevelComponent",get:function(){var t=SS(kS,this).call(this,this.config.spineName);return t?t.getComponent(rS).spine:(console.warn("spineEntityLevel is not created"),!1)}}]),IS=_((function t(){v(this,t),this.entities=new Set}),[{key:"addEntity",value:function(t){this.entities.add(t)}},{key:"removeEntity",value:function(t){this.entities.delete(t)}},{key:"init",value:function(){throw new Error("System update method not implemented")}}]);function RS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(RS=function(){return!!t})()}function OS(t,e,n){LS(t,e),e.set(t,n)}function LS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DS(t,e){return t.get(FS(t,e))}function FS(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var NS=new WeakMap,BS=new WeakMap,WS=new WeakMap,US=new WeakSet,jS=function(t){function e(){var t;return v(this,e),t=function(t,e){return e=T(e),b(t,RS()?Reflect.construct(e,[],T(t).constructor):e.apply(t,void 0))}(this,e),function(t,e){LS(t,e),e.add(t)}(t,US),OS(t,NS,window.game),OS(t,BS,DS(NS,t).refs),OS(t,WS,DS(BS,t).levelContainer),t}return A(e,t),_(e,[{key:"init",value:function(){var t=this;this.entities.forEach((function(e){FS(US,t,HS).call(t,e),FS(US,t,zS).call(t,e)}))}}])}(IS);function HS(t){var e=t.getComponent(o_);if(e){var n=e.view;DS(WS,this).children.includes(n)||DS(WS,this).addChild(n)}}function zS(t){var e=t.getComponent(rS);if(e){var n=e.spine;DS(WS,this).children.includes(n)||DS(WS,this).addChild(n)}}function GS(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function VS(t,e,n){return t.set(YS(t,e),n),n}function XS(t,e){return t.get(YS(t,e))}function YS(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $S=new WeakMap,qS=new WeakMap,KS=new WeakMap,ZS=new WeakMap,QS=_((function t(e){var n=this;v(this,t),GS(this,$S,null),GS(this,qS,null),GS(this,KS,(function(t){var e=t.data;VS($S,n,Object.assign({},e.global))})),GS(this,ZS,(function(t){var e,r,i,s,o=t.target;if("hogItemContainer"===o.typeName&&XS($S,n)){VS(qS,n,t.data.global);var a=(null===(e=XS($S,n))||void 0===e?void 0:e.x)-(null===(r=XS(qS,n))||void 0===r?void 0:r.x),l=(null===(i=XS($S,n))||void 0===i?void 0:i.y)-(null===(s=XS(qS,n))||void 0===s?void 0:s.y);Math.sqrt(a*a+l*l)>20||(o.isAlive=!1,o.onHandlerUp())}})),this.spineContainer=e.spineLevelComponent}),[{key:"init",value:function(){this.spineContainer.eventMode="static",this.spineContainer.on("pointerdown",XS(KS,this)),this.spineContainer.on("pointerup",XS(ZS,this))}},{key:"destroy",value:function(){this.spineContainer.off("pointerdown",XS(KS,this)),this.spineContainer.off("pointerup",XS(ZS,this)),this.spineContainer.eventMode="none",qc.log(Vc.DestroyMessage,"[ClickSystem] destroy")}}]),JS=new WeakSet,tA=_((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.game,r=e.duration,i=e.log,s=void 0!==i&&i,o=e.label,a=void 0===o?"defaultTimer":o;v(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,JS),this.game=n,this.duration=Math.floor(r),this.log=s,this.label=a,this.remainingTime=this.duration,this.timerTween=null,this.game.on(vh,this.kill.bind(this)),this.game.on(yh,this.kill.bind(this))}),[{key:"start",value:function(){var t=this,e=Math.ceil(this.remainingTime);this.timerTween=ww.to(this,{remainingTime:0,duration:this.duration,ease:"none",onUpdate:function(){var n=Math.ceil(t.remainingTime);n!==e&&(e=n,function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(JS,t,eA).call(t,n))},onComplete:function(){t.kill()}})}},{key:"kill",value:function(){this.timerTween&&(qc.log(Vc.DestroyMessage,"[Timer] ".concat(this.label," kill")),this.timerTween.kill(),this.timerTween=null,this.game.emit(Ch,{label:this.label}))}}]);function eA(t){this.log&&console.log("[Timer] ".concat(this.label," tick"),t),this.game.emit(Eh,{label:this.label,currentTime:t,currentTimeWithZero:t>9?t:"0".concat(t)})}function nA(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function rA(t,e,n){return t.set(sA(t,e),n),n}function iA(t,e){return t.get(sA(t,e))}function sA(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oA=new WeakMap,aA=new WeakMap,lA=new WeakMap,hA=new WeakMap,cA=new WeakMap,uA=new WeakMap,dA=new WeakMap,fA=new WeakMap,pA=new WeakMap,mA=new WeakMap,gA=new WeakMap,vA=new WeakMap,yA=new WeakMap,xA=new WeakMap,wA=new WeakMap,_A=new WeakMap,bA=_((function t(e){var n=this;v(this,t),nA(this,oA,window.game),nA(this,aA,iA(oA,this).refs),nA(this,lA,""),nA(this,hA,void 0),nA(this,cA,void 0),nA(this,uA,null),nA(this,dA,40),nA(this,fA,!1),nA(this,pA,void 0),nA(this,mA,(function(t){var e=t?"on":"off";iA(oA,n)[e](ph,iA(yA,n)),iA(oA,n)[e](_h,iA(gA,n))})),nA(this,gA,(function(t){var e=t.maxItems;t.itemsFound+1>=e&&rA(fA,n,!0)})),nA(this,vA,(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=iA(pA,n),i=r.introSpeech,s=r.outroSpeech;ww.delayedCall(e,(function(){var e=t?i:s;iA(cA,n).play(e),rA(lA,n,e)}))})),nA(this,yA,(function(){var t;if(!iA(cA,n).isPlaying(iA(lA,n))&&!iA(fA,n)){var e=Math.ceil(null===(t=iA(uA,n))||void 0===t?void 0:t.remainingTime);iA(uA,n)&&e>0?iA(_A,n).call(n):(e<=0&&(iA(uA,n).kill(),rA(uA,n,null)),iA(wA,n).call(n),iA(xA,n).call(n))}})),nA(this,xA,(function(){rA(uA,n,new tA({game:iA(oA,n),duration:iA(dA,n),label:iA(lA,n)})),iA(uA,n).start()})),nA(this,wA,(function(){var t=_w.getRandomNumber(1,60,0),e=window.game.locale,r="sfx_".concat(e,"_clickItem").concat(t);rA(lA,n,r),iA(cA,n).play(r)})),nA(this,_A,(function(){var t=_w.getRandomNumber(0,9,0),e="sfx_click".concat(t);rA(lA,n,e),iA(cA,n).play(e)})),this.level=e}),[{key:"init",value:function(){rA(hA,this,tf.get(Zd)),rA(cA,this,tf.get(Qd)),rA(pA,this,mp.getSpeechAndTextData(iA(oA,this),iA(hA,this))),iA(mA,this).call(this,!0),iA(vA,this).call(this,!0,.1)}},{key:"destroy",value:function(){iA(mA,this).call(this,!1),qc.log(Vc.DestroyMessage,"[ClickSoundSystem] destroy")}}]);function TA(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function SA(t,e){return t.get(EA(t,e))}function AA(t,e,n){return t.set(EA(t,e),n),n}function EA(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var CA=new WeakMap,kA=new WeakMap,MA=new WeakMap,PA=new WeakMap,IA=new WeakMap,RA=new WeakMap,OA=new WeakMap,LA=new WeakMap,DA=new WeakMap,FA=new WeakMap,NA=new WeakMap,BA=_((function t(e){var n=this;v(this,t),TA(this,CA,window.game),TA(this,kA,void 0),TA(this,MA,void 0),TA(this,PA,null),TA(this,IA,120),TA(this,RA,!1),TA(this,OA,(function(){AA(PA,n,new tA({game:SA(CA,n),duration:SA(IA,n),label:"AdLvlTimer",log:!1})),SA(PA,n).start()})),TA(this,LA,(function(t){var e=t?"on":"off";SA(CA,n)[e](ph,SA(FA,n)),SA(CA,n)[e](_h,SA(DA,n))})),TA(this,DA,(function(t){var e=t.maxItems;t.itemsFound+1>=e&&AA(RA,n,!0)})),TA(this,FA,Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!SA(RA,n)){t.next=2;break}return t.abrupt("return");case 2:if(!(Math.ceil(null===(e=SA(PA,n))||void 0===e?void 0:e.remainingTime)<=0)){t.next=6;break}return t.next=6,SA(NA,n).call(n);case 6:case"end":return t.stop()}}),t)})))),TA(this,NA,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_SERVICE.showFullscreenAdv({onOpen:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:SA(MA,n).pauseAll();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),onClose:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:SA(OA,n).call(n),tf.get(Qd).unPauseAll();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()});case 2:case"end":return t.stop()}}),t)})))),this.level=e}),[{key:"init",value:function(){AA(kA,this,tf.get(Zd)),SA(kA,this).hasAdPass||(AA(MA,this,tf.get(Qd)),SA(LA,this).call(this,!0),SA(OA,this).call(this))}},{key:"destroy",value:function(){SA(LA,this).call(this,!1),qc.log(Vc.DestroyMessage,"[AdLvlTimer] destroy")}}]);function WA(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function UA(t,e,n){return t.set(HA(t,e),n),n}function jA(t,e){return t.get(HA(t,e))}function HA(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zA=new WeakMap,GA=new WeakMap,VA=new WeakMap,XA=new WeakMap,YA=new WeakMap,$A=new WeakMap,qA=new WeakMap,KA=_((function t(){var e=this;v(this,t),WA(this,zA,window.game),WA(this,GA,0),WA(this,VA,0),E(this,"init",(function(){jA(XA,e).call(e,!0)})),E(this,"destroy",(function(){jA(XA,e).call(e,!1),UA(GA,e,0),UA(VA,e,0)})),WA(this,XA,(function(t){var n=t?"on":"off";jA(zA,e)[n](vh,jA(YA,e)),jA(zA,e)[n](gh,jA($A,e)),jA(zA,e)[n](mh,jA(qA,e))})),WA(this,YA,(function(){of.hintCounter(tf.get(Zd),jA(GA,e)),of.missClickCounter(tf.get(Zd),jA(VA,e))})),WA(this,$A,(function(){var t;UA(GA,e,(t=jA(GA,e),++t))})),WA(this,qA,(function(){var t;UA(VA,e,(t=jA(VA,e),++t))}))}));function ZA(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function QA(t,e){return t.get(JA(t,e))}function JA(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tE=new WeakMap,eE=new WeakMap,nE=_((function t(e){var n=this;v(this,t),ZA(this,tE,{}),ZA(this,eE,(function(){QA(tE,n).hintCounter=new KA,Object.values(QA(tE,n)).forEach((function(t){return t.init()}))})),this.level=e}),[{key:"init",value:function(){QA(eE,this).call(this)}},{key:"destroy",value:function(){Object.values(QA(tE,this)).forEach((function(t){return t.destroy()})),function(t,e){t.set(JA(t,e),{})}(tE,this),qc.log(Vc.DestroyMessage,"[MetrikaSystem] destroy")}}]),rE=_((function t(e){v(this,t),this.systems=new Map,this.entityManager=e}),[{key:"initSystems",value:function(t){this.entityManager.spineLevelComponent&&(this.systems.set("clickSystem",new QS(this.entityManager)),this.systems.set("clickSoundSystem",new bA(t)),this.systems.set("adLvlTimer",new BA(t)),this.systems.set("metrikaSystem",new nE(t)));var e=new jS;this.systems.set("renderSystem",e),this.entityManager.entities.forEach((function(t){e.addEntity(t)})),this.systems.forEach((function(t){return t.init()}))}},{key:"removeSystem",value:function(t){var e=this.systems.get(t);e&&e.destroy&&(e.destroy(),this.systems.delete(t))}},{key:"removeAllSystems",value:function(){var t=this;this.systems.forEach((function(e,n){return t.removeSystem(n)})),this.systems.clear()}}]),iE=new WeakMap,sE=_((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,t),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,iE,window.game),this.eventHandlers=e}),[{key:"setEvents",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?"off":"on";Object.keys(this.eventHandlers).forEach((function(n){(function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))})(iE,t)[e](n,t.eventHandlers[n])}))}}]);r(9391);var oE="store",aE="scoreboard",lE="authorization",hE="rateUs",cE=new WeakMap,uE=_((function t(e){var n=this;v(this,t),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,cE,window.game),E(this,"view",void 0),E(this,"uiManager",void 0),this.uiManager=e;var r=this.constructor.viewName;this.view=function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(cE,this).refs[r],this.btnClose=this.view.getChildByName("btnClose",3),this.btnClose.on("pointerdown",(function(){return n.uiManager.closeModule(n.constructor.moduleName)})),Sw.initOverHandler(this.btnClose)}),[{key:"show",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.view.visible=!0,this.btnClose.eventMode="none",t.next=4,ww.timeline().fromTo(this.view,{alpha:0},{alpha:1,ease:"back.out(2.5)"},"<");case 4:this.view,this.btnClose.eventMode="static";case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"hide",value:function(){var t=Jh(nc().mark((function t(){var e,n=arguments;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:this.btnClose,tf.get(Qd).play("sfx_btnClick"),this.view.interactiveChildren=!1,t.next=5,Sw.click(e);case 5:return t.abrupt("return",ww.timeline().to(this.view,{alpha:0,duration:.2,ease:"none"},"<").set(this.view,{visible:!1,interactiveChildren:!0}));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]);function dE(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function fE(t,e,n){return t.set(mE(t,e),n),n}function pE(t,e){return t.get(mE(t,e))}function mE(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gE=new WeakMap,vE=new WeakMap,yE=new WeakMap,xE=new WeakMap,wE=new WeakMap,_E=new WeakMap,bE=new WeakMap,TE=new WeakMap,SE=new WeakMap,AE=new WeakMap,EE=new WeakMap,CE=new WeakMap,kE=new WeakMap,ME=new WeakMap,PE=new WeakMap,IE=new WeakMap,RE=new WeakMap,OE=new WeakMap,LE=new WeakMap,DE=new WeakMap,FE=new WeakMap,NE=_((function t(){var e=this;v(this,t),dE(this,gE,window.game),dE(this,vE,tf.get(Zd)),dE(this,yE,!1),dE(this,xE,void 0),dE(this,wE,void 0),dE(this,_E,!1),dE(this,bE,void 0),E(this,"btn",void 0),E(this,"timer",void 0),E(this,"duration",wp.getTimerRewardDuration()),E(this,"destroy",(function(){var t;qc.log(Vc.DestroyMessage,"[BtnTimer] destroy"),null===(t=e.timer)||void 0===t||t.kill(),e.btn.off("pointerup",pE(TE,e)),pE(EE,e).call(e,!1)})),dE(this,TE,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!pE(yE,e)){t.next=2;break}return t.abrupt("return");case 2:if(pE(yE,e)){t.next=7;break}if(!pE(_E,e)){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,pE(RE,e).call(e);case 7:case"end":return t.stop()}}),t)})))),dE(this,SE,(function(t){e.timer=new tA({game:pE(gE,e),duration:t,label:pE(xE,e)}),e.timer.start()})),dE(this,AE,(function(t){t?(fE(yE,e,!0),e.btn.filters=[Em()],e.btn.eventMode="none"):(fE(yE,e,!1),e.btn.filters=[],e.btn.eventMode="static")})),dE(this,EE,(function(t){var n=t?"on":"off";pE(gE,e)[n](Eh,pE(CE,e)),pE(gE,e)[n](Ch,pE(kE,e))})),dE(this,CE,(function(t){var n=t.label,r=t.currentTimeWithZero;n===pE(xE,e)&&e.onTimerTick(r)})),dE(this,kE,(function(t){t.label===pE(xE,e)&&(pE(AE,e).call(e,!1),e.onTimerEnd(),_SERVICE.preloadRewardedAd())})),dE(this,ME,Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_SERVICE.serverTime();case 2:return e=t.sent,t.abrupt("return",Math.floor(e/1e3));case 4:case"end":return t.stop()}}),t)})))),dE(this,PE,Jh(nc().mark((function t(){var n,r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pE(ME,e).call(e);case 2:n=t.sent,(r=pE(vE,e).timers)[pE(wE,e)]=n,pE(vE,e).timers=r;case 6:case"end":return t.stop()}}),t)})))),dE(this,IE,Jh(nc().mark((function t(){var n,r,i,s;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pE(ME,e).call(e);case 2:if(n=t.sent,r=pE(vE,e).timers){t.next=7;break}return console.error("timers not found"),t.abrupt("return");case 7:if(!(i=r[pE(wE,e)])){t.next=14;break}if(!((s=n-i)<e.duration)){t.next=14;break}return pE(SE,e).call(e,e.duration-s),pE(AE,e).call(e,!0),t.abrupt("return",!0);case 14:return t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t)})))),dE(this,RE,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=Jh(nc().mark((function t(n){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{_SERVICE.showRewardedVideo({onOpen:function(){return pE(OE,e).call(e)},onRewarded:function(){return pE(LE,e).call(e)},onClose:function(){return pE(DE,e).call(e)},onError:function(){return pE(FE,e).call(e)}})}catch(t){console.log("[SDK BtnTimer] showAd",t),e.onError()}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})))),dE(this,OE,(function(){tf.get(Qd).play("sfx_btnClick"),tf.get(Qd).mute(),fE(bE,e,!1),fE(_E,e,!0)})),dE(this,LE,(function(){fE(bE,e,!0)})),dE(this,DE,(function(){pE(bE,e)?(tf.get(Qd).unmute(),tf.get(Qd).play("sfx_store"),pE(vE,e).addHints(Fh.free.amount),fE(_E,e,!1),pE(SE,e).call(e,e.duration),pE(AE,e).call(e,!0),pE(PE,e).call(e),e.onTap()):(fE(_E,e,!1),tf.get(Qd).unmute(),e.onError())})),dE(this,FE,(function(){console.log("onErrorAction"),e.onError()}))}),[{key:"init",value:function(t,e,n){this.btn=t,this.btn.on("pointerup",pE(TE,this)),fE(xE,this,e),fE(wE,this,n),pE(EE,this).call(this,!0),pE(IE,this).call(this)}},{key:"onTap",value:function(){}},{key:"onTimerTick",value:function(t){}},{key:"onTimerEnd",value:function(){}},{key:"onError",value:function(){}}]);function BE(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(BE=function(){return!!t})()}function WE(t,e,n,r){var i=tc(T(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function UE(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function jE(t,e,n){return t.set(zE(t,e),n),n}function HE(t,e){return t.get(zE(t,e))}function zE(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var GE=new WeakMap,VE=new WeakMap,XE=new WeakMap,YE=new WeakMap,$E=new WeakMap,qE=new WeakMap,KE=new WeakMap,ZE=function(t){function e(){var t;return v(this,e),t=function(t,e){return e=T(e),b(t,BE()?Reflect.construct(e,[],T(t).constructor):e.apply(t,void 0))}(this,e),UE(t,GE,window.game),UE(t,VE,HE(GE,t).refs),UE(t,XE,void 0),UE(t,YE,void 0),UE(t,$E,void 0),E(t,"btn",void 0),UE(t,qE,(function(){jE($E,t,t.btn.getChildByName("iconPlay")),jE(XE,t,t.btn.getChildByName("priceText")),HE(XE,t).initText=HE(XE,t).text,HE(XE,t).initFontSize=HE(XE,t).style.fontSize,HE(XE,t).initPosX=HE(XE,t).x})),UE(t,KE,(function(e){var n=Math.floor(e/60),r=e%60,i=String(n).padStart(2,"0"),s=String(r).padStart(2,"0");HE(XE,t).text="".concat(i," : ").concat(s),HE(XE,t).style.fontSize=18,HE(XE,t).x=10})),"object"===y(e.instance)||(e.instance=t),b(t,e.instance)}return A(e,t),_(e,[{key:"init",value:function(t,n){WE(e,"init",this,3)([t,"btnFreeTimer",pu]),jE(YE,this,n),HE(qE,this).call(this)}},{key:"onTimerTick",value:function(t){HE(KE,this).call(this,t)}},{key:"onTimerEnd",value:function(){WE(e,"onTimerEnd",this,3)([]),HE(XE,this).text=HE(XE,this).initText,HE(XE,this).style.fontSize=HE(XE,this).initFontSize,HE(XE,this).x=HE(XE,this).initPosX,HE($E,this).visible=!0}},{key:"onError",value:function(){HE(YE,this).purchaseError.show()}}])}(NE);function QE(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function JE(t,e){return t.get(tC(t,e))}function tC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eC=new WeakMap,nC=new WeakMap,rC=_((function t(e){var n=this;v(this,t),QE(this,eC,void 0),E(this,"view",void 0),E(this,"innerModal",void 0),E(this,"fade",void 0),QE(this,nC,(function(){var t=n.view.getChildByName("innerModal"),e=n.view.getChildByName("innerContainer",1);t.addChild(e)})),E(this,"show",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Sw.initOverHandler(JE(eC,n)),n.view.visible=!0,JE(eC,n).eventMode="none",t.next=5,ww.timeline().set(n.innerModal,{visible:!0}).fromTo(n.view,{alpha:0},{alpha:1,ease:"linear"}).fromTo(n.innerModal.scale,{x:0,y:0},{x:1,y:1,ease:"back.out(2.5)"},"<");case 5:JE(eC,n).eventMode="static",tf.get(Qd).unmute();case 7:case"end":return t.stop()}}),t)})))),E(this,"hide",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return tf.get(Qd).play("sfx_btnClick"),n.view.interactiveChildren=!1,t.next=4,Sw.click(JE(eC,n));case 4:return t.abrupt("return",ww.timeline().to(n.view,{alpha:0,duration:.1,ease:"linear"},"<").set(n.view,{visible:!1,interactiveChildren:!0}));case 5:case"end":return t.stop()}}),t)})))),this.view=e,this.innerModal=this.view.getChildByName("innerModal",1),this.fade=this.view.getChildByName("fade"),function(t,e,n){t.set(tC(t,e),n)}(eC,this,this.view.getChildByName("btnClose",1)),JE(eC,this).on("pointerup",this.hide),JE(nC,this).call(this)}));function iC(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(iC=function(){return!!t})()}function sC(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function oC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var aC=new WeakMap,lC=new WeakMap,hC=new WeakMap,cC=function(t){function e(t,n){var r;return v(this,e),r=function(t,e,n){return e=T(e),b(t,iC()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),sC(r,aC,window.game),sC(r,lC,function(t,e){return t.get(oC(t,e))}(aC,r).refs),sC(r,hC,void 0),function(t,e,n){t.set(oC(t,e),n)}(hC,r,t),r.fade.alpha=null!=n?n:r.fade.alpha,r}return A(e,t),_(e)}(rC);function uC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function dC(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?uC(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uC(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function fC(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(fC=function(){return!!t})()}function pC(t,e,n,r){var i=tc(T(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function mC(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function gC(t,e,n){return t.set(yC(t,e),n),n}function vC(t,e){return t.get(yC(t,e))}function yC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xC=new WeakMap,wC=new WeakMap,_C=new WeakMap,bC=new WeakMap,TC=new WeakMap,SC=new WeakMap,AC=new WeakMap,EC=new WeakMap,CC=new WeakMap,kC=new WeakMap,MC=new WeakMap,PC=new WeakMap,IC=new WeakMap,RC=new WeakMap,OC=new WeakMap,LC=new WeakMap,DC=new WeakMap,FC=new WeakMap,NC=new WeakMap,BC=new WeakMap,WC=function(t){function e(t){var n;v(this,e),n=function(t,e,n){return e=T(e),b(t,fC()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),mC(n,xC,window.game),mC(n,wC,vC(xC,n).refs),mC(n,_C,vC(wC,n).storeView),mC(n,bC,vC(_C,n).getChildByName("textStoreCounter",2)),mC(n,TC,vC(_C,n).getChildByName("cardsContainer",2)),mC(n,SC,tf.get(Zd)),mC(n,AC,null),mC(n,EC,void 0),mC(n,CC,void 0),E(n,"btnFree",void 0),mC(n,kC,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return vC(PC,n).call(n),t.next=3,vC(CC,n).init(n.btnFree,n);case 3:return vC(RC,n).call(n),t.next=6,vC(IC,n).call(n);case 6:vC(OC,n).call(n,!0),vC(MC,n).call(n,!0);case 8:case"end":return t.stop()}}),t)})))),mC(n,MC,(function(t){var e=t?"on":"off";vC(xC,n)[e](Mh,vC(RC,n)),vC(xC,n)[e]("showPayment",vC(FC,n))})),mC(n,PC,(function(){if(vC(SC,n).hasAdPass){var t=vC(EC,n).parent,e=t.getChildByName("isBuy");vC(EC,n).visible=!1,e.visible=!0,t.interactiveChildren=!1;var r=new Ds;r.brightness(.6,!0),r.greyscale(.6,!0),t.filters=[r]}})),mC(n,IC,(function(){return bw(vC(AC,n),!0),gC(AC,n,ww.timeline().fromTo(vC(TC,n).children.map((function(t){return t.scale})),{x:0,y:0},{x:1,y:1,stagger:.13}))})),mC(n,RC,(function(){vC(bC,n).text=vC(SC,n).hints})),mC(n,OC,(function(t){var e=t?"on":"off",r=t?"static":"none";vC(TC,n).eventMode=r,vC(TC,n)[e]("pointerup",vC(LC,n))})),mC(n,LC,function(){var t=Jh(nc().mark((function t(e){var r,i,s;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.target,i=r.parent,s=i.name,"button"===r.typeName&&"free"!==s){t.next=5;break}return t.abrupt("return");case 5:if(tf.get(Qd).mute(),"noAdPack"!==s){t.next=9;break}return vC(NC,n).call(n,s),t.abrupt("return");case 9:return t.next=11,vC(DC,n).call(n,s);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),mC(n,DC,function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:_SERVICE.id===nh&&n.onPurchaseYANDEX(e),_SERVICE.id===rh&&n.onPurchaseOK(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),E(n,"onPurchaseOK",function(){var t=Jh(nc().mark((function t(e){var n,r,i;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("itemId:",e),t.next=3,_SERVICE.getStoreCatalog();case 3:return r=t.sent,console.log("catalog",r),i=r[e],console.log("data:",i),console.log("--------------- test 1"),t.next=10,null===(n=_SERVICE.sdk)||void 0===n?void 0:n.UI.showPayment(e||"",i.descr||"купить подсказки",e,i.price||1,null,JSON.stringify({app_id:_SERVICE.appId}),"ok","true");case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),mC(n,FC,function(){var t=Jh(nc().mark((function t(e){var n;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.result,console.log("--------------- test 2"),"ok"!==n){t.next=7;break}return t.next=5,_SERVICE.checkPayments();case 5:t.next=8;break;case 7:console.log("отмена операции");case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),E(n,"onPurchaseYANDEX",(function(t){_SERVICE.payments&&_SERVICE.payments.purchase({id:t}).then(function(){var e=Jh(nc().mark((function e(n){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("purchase",n),e.next=3,_SERVICE.payments.consumePurchase(n.purchaseData.purchaseToken);case 3:of.purchase(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){console.log("Покупка успешно консумирована!"),vC(SC,n).addHints(Fh[t].amount),tf.get(Qd).unmute(),tf.get(Qd).visibilityStateHandler(),tf.get(Qd).play("sfx_store")})).catch((function(t){console.log("[sdkAction] buyGold Покупка не удалась",t),n.purchaseError.show()})).finally((function(){tf.get(Qd).unmute(),tf.get(Qd).visibilityStateHandler()}))})),mC(n,NC,(function(t){_SERVICE.payments.purchase({id:t}).then(function(){var e=Jh(nc().mark((function e(n){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("purchase",n),e.next=3,_SERVICE.payments.consumePurchase(n.purchaseData.purchaseToken);case 3:of.purchase(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){console.log("Покупка успешно консумирована!"),vC(SC,n).hasAdPass=!0,vC(SC,n).saveData(),vC(PC,n).call(n),tf.get(Qd).unmute(),tf.get(Qd).visibilityStateHandler(),tf.get(Qd).play("sfx_store")})).catch((function(t){console.log("[sdkAction] buyGold Покупка не удалась",t),n.purchaseError.show()})).finally((function(){tf.get(Qd).unmute(),tf.get(Qd).visibilityStateHandler()}))})),mC(n,BC,Jh(nc().mark((function t(){var e,r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(_SERVICE.payments){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,_SERVICE.getStoreCatalog();case 4:if(e=t.sent){t.next=7;break}return t.abrupt("return");case 7:r=e,_SERVICE.id===rh&&(r=Object.entries(e).map((function(t){var e=iu(t,2);return dC({id:e[0]},e[1])}))),r.forEach((function(t){var e=t.id,r=t.price,i=vC(TC,n).children.find((function(t){return t.name===e})),s=null==i?void 0:i.getChildByName("priceText",2);i&&(_SERVICE.id===nh&&(s.text=r),_SERVICE.id===rh&&(s.text=r+" OK"))}));case 10:case"end":return t.stop()}}),t)}))));var r=vC(TC,n).children.map((function(t){return t.getChildByName("btnPrice")}));return Sw.initOverHandler(r),n.btnFree=r.find((function(t){return"free"===t.parent.name})),gC(EC,n,r.find((function(t){return"noAdPack"===t.parent.name}))),gC(CC,n,new ZE(n)),vC(BC,n).call(n),n.purchaseError=new cC(vC(wC,n).purchaseErrorView),n}return A(e,t),_(e,[{key:"show",value:function(){pC(e,"show",this,3)([]),vC(kC,this).call(this)}},{key:"hide",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pC(e,"hide",this,3)([]);case 2:vC(CC,this).destroy(),vC(OC,this).call(this,!1),vC(MC,this).call(this,!1),bw(vC(AC,this),!0),vC(xC,this).emit(Rh);case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}])}(uE);function UC(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(UC=function(){return!!t})()}function jC(t,e,n,r){var i=tc(T(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function HC(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function zC(t,e,n){return t.set(VC(t,e),n),n}function GC(t,e){return t.get(VC(t,e))}function VC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}E(WC,"viewName","storeView"),E(WC,"moduleName",oE);var XC=new WeakMap,YC=new WeakMap,$C=new WeakMap,qC=new WeakMap,KC=new WeakMap,ZC=new WeakMap,QC=new WeakMap,JC=new WeakMap,tk=new WeakMap,ek=new WeakMap,nk=new WeakMap,rk=new WeakMap,ik=new WeakMap,sk=function(t){function e(t){var n;return v(this,e),n=function(t,e,n){return e=T(e),b(t,UC()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),HC(n,XC,window.game),HC(n,YC,GC(XC,n).refs),HC(n,$C,GC(YC,n).scoreboardView),HC(n,qC,GC($C,n).getChildByName("gapRow")),HC(n,KC,!1),HC(n,ZC,GC($C,n).getChildByName("list")),HC(n,QC,GC($C,n).getChildByName("textLoading")),HC(n,JC,Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_SERVICE.leaderboardData();case 2:if(e=t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!GC(KC,n)){t.next=8;break}return GC(ek,n).call(n),t.abrupt("return");case 8:GC(tk,n).call(n,e);case 9:case"end":return t.stop()}}),t)})))),HC(n,tk,function(){var t=Jh(nc().mark((function t(e){var r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_SERVICE.player.getUniqueID();case 2:return r=t.sent,t.next=5,new Promise((function(t){e.entries.forEach((function(i,s){var o,a=i.player,l=a.publicName,h=a.uniqueID,c=i.rank,u=i.score,d=null;(null==i||null===(o=i.player)||void 0===o?void 0:o.getAvatarSrc)instanceof Function&&(d=i.player.getAvatarSrc());var f=Tm({rank:c,publicName:l,score:u,y:68*s}),p=f.getChildByName("borderBottom");if(GC(ZC,n).addChild(f),GC(rk,n).call(n,f,d),0===s&&GC(ik,n).call(n,f,"leader-medal1"),1===s&&GC(ik,n).call(n,f,"leader-medal2"),2===s&&GC(ik,n).call(n,f,"leader-medal3"),7===s&&(p.visible=!1),h===r){var m=f.getChildByName("userName");f.isPlayer=!0,m.tint=65449}e.entries.length>2&&(GC(qC,n).visible=!0),GC(ZC,n).children.length>=9&&!f.isPlayer&&(f.visible=!1),s===e.entries.length-1&&t()}))}));case 5:zC(KC,n,!0),GC(nk,n).call(n),GC(ek,n).call(n,.5);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),HC(n,ek,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;ww.timeline().fromTo([GC(ZC,n),GC(qC,n)],{alpha:0},{alpha:1,delay:t,duration:.1,ease:"none"}).set(GC(QC,n),{visible:!1},"<")})),HC(n,nk,Jh(nc().mark((function t(){var e,r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:GC(ZC,n).children.length>7&&(e=GC(ZC,n).children[7],(r=GC(ZC,n).children.find((function(t){return t.isPlayer}))).rank>8&&(e.visible=!1,r.position.set(e.x,e.y)));case 1:case"end":return t.stop()}}),t)})))),HC(n,rk,function(){var t=Jh(nc().mark((function t(e,n){var r,i,s,o,a,l;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getChildByName("avatarContainer",1),i=r.getChildByName("mask",1),t.prev=2,t.next=5,vr.fromURL(n);case 5:s=t.sent,(o=new os(s)).anchor.set(.5),r.addChild(o),o.mask=i,t.next=20;break;case 12:t.prev=12,t.t0=t.catch(2),console.warn("[SDK createAvatar] URL: ".concat(n),t.t0),a=vr.from("avatar-user-default"),(l=new os(a)).anchor.set(.5),r.addChild(l),l.mask=i;case 20:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e,n){return t.apply(this,arguments)}}()),HC(n,ik,(function(t,e){var n=t.getChildByName("rank");n.visible=!1;var r=new os(vr.from(e));r.anchor.set(.5),r.position.set(n.x,n.y),t.addChild(r)})),n.uiManager=t,n}return A(e,t),_(e,[{key:"show",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:GC(ZC,this).alpha=0,GC(qC,this).alpha=0,GC(QC,this).visible=!GC(KC,this),jC(e,"show",this,3)([]),GC(JC,this).call(this);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"hide",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,jC(e,"hide",this,3)([]);case 2:GC(KC,this)||(GC(ZC,this).removeChildren(),GC(qC,this).visible=!1);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}])}(uE);function ok(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ok=function(){return!!t})()}function ak(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function lk(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}E(sk,"viewName","scoreboardView"),E(sk,"moduleName",aE);var hk=new WeakMap,ck=new WeakMap,uk=new WeakMap,dk=new WeakMap,fk=new WeakMap,pk=new WeakMap,mk=new WeakMap,gk=function(t){function e(t){var n;return v(this,e),n=function(t,e,n){return e=T(e),b(t,ok()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),ak(n,hk,window.game),ak(n,ck,lk(hk,n).refs),ak(n,uk,lk(ck,n).authorizationView),ak(n,dk,lk(uk,n).getChildByName("innerModal",1)),ak(n,fk,lk(uk,n).getChildByName("innerView")),ak(n,pk,lk(fk,n).getChildByName("btnEnter")),ak(n,mk,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.uiManager.closeModule(e.moduleName),_SERVICE.sdk.auth.openAuthDialog().then((function(){console.log("Игрок успешно авторизован."),location.reload(),_SERVICE.initPlayer().catch((function(t){console.log("Ошибка при инициализации объекта Player.",t)}))})).catch((function(){console.log("Игрок не авторизован.")}));case 2:case"end":return t.stop()}}),t)})))),E(n,"checkAuth",(function(){if(_SERVICE.sdk)return new Promise((function(t){_SERVICE.getPlayer().then(function(){var e=Jh(nc().mark((function e(n){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("lite"!==n.getMode()){e.next=5;break}return console.log("Игрок не авторизован."),e.abrupt("return",t(!1));case 5:return e.abrupt("return",t(!0));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log("Ошибка при инициализации объекта Player.",e),t(!0)}))}))})),lk(dk,n).addChild(lk(fk,n)),n}return A(e,t),_(e,[{key:"show",value:function(){!function(t,e,n){var r=tc(T(t.prototype),"show",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]),Sw.initOverHandler(lk(pk,this)),lk(pk,this).once("pointerup",lk(mk,this))}}])}(uE);function vk(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function yk(t,e,n){return t.set(wk(t,e),n),n}function xk(t,e){return t.get(wk(t,e))}function wk(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}E(gk,"viewName","authorizationView"),E(gk,"moduleName",lE);var _k=new WeakMap,bk=new WeakMap,Tk=new WeakMap,Sk=new WeakMap,Ak=new WeakMap,Ek=new WeakMap,Ck=new WeakMap,kk=new WeakMap,Mk=new WeakMap,Pk=_((function t(e){var n=this;v(this,t),vk(this,_k,window.game),vk(this,bk,xk(_k,this).refs),vk(this,Tk,void 0),vk(this,Sk,void 0),vk(this,Ak,void 0),E(this,"getModule",(function(t){return xk(Ak,n)[t]})),E(this,"showModule",(function(t){_SERVICE.payments?(xk(Ek,n).call(n),xk(kk,n).call(n),xk(Ak,n)[t].show(),document.addEventListener("keydown",xk(Mk,n))):console.error("_SERVICE.payments not found")})),E(this,"closeModule",function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("closemodule",e),document.removeEventListener("keydown",xk(Mk,n)),t.next=4,xk(Ak,n)[e].hide();case 4:xk(Ck,n).call(n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vk(this,Ek,(function(){xk(Tk,n).setInteractive(!1);var t=xk(_k,n).uiInner,e=xk(bk,n).fade;ww.timeline().to(e,{alpha:.65,visible:!0}).to([xk(Sk,n),t],{alpha:0,duration:.2,visible:!1},"<")})),vk(this,Ck,(function(){var t=xk(_k,n).uiInner,e=xk(bk,n).fade;ww.timeline().call((function(){return xk(Tk,n).setInteractive(!0)})).to([xk(Sk,n),t],{alpha:1,duration:.1,visible:!0}).to(e,{alpha:0,visible:!1},"<")})),vk(this,kk,(function(){Object.keys(xk(Ak,n)).forEach((function(t){xk(Ak,n)[t].visible=!1}))})),vk(this,Mk,(function(t){if("Escape"===t.key)return Object.entries(xk(Ak,n)).find((function(t){var e=iu(t,2),r=e[0];e[1].view.visible&&n.closeModule(r)}))})),yk(Tk,this,e),yk(Sk,this,xk(bk,this).startScreenView),yk(Ak,this,E(E(E({},oE,new WC(this)),aE,new sk(this)),lE,new gk(this)))}));function Ik(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Rk(t,e){return t.get(Ok(t,e))}function Ok(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lk=new WeakMap,Dk=new WeakMap,Fk=new WeakMap,Nk=new WeakMap,Bk=new WeakMap,Wk=new WeakMap,Uk=new WeakMap,jk=new WeakMap,Hk=new WeakMap,zk=new WeakMap,Gk=new WeakMap,Vk=new WeakMap,Xk=new WeakMap,Yk=new WeakMap,$k=new WeakMap,qk=new WeakMap,Kk=new WeakMap,Zk=new WeakMap,Qk=_((function t(e){var n=this;v(this,t),Ik(this,Lk,window.game),Ik(this,Dk,Rk(Lk,this).app.stage),Ik(this,Fk,Rk(Lk,this).refs),Ik(this,Nk,Rk(Fk,this).startScreenView),Ik(this,Bk,ww.timeline()),Ik(this,Wk,tf.get(Zd)),Ik(this,Uk,new Pk(this)),Ik(this,jk,Rk(Nk,this).getChildByName("btnContainer")),Ik(this,Hk,Rk(Fk,this).telegram),Ik(this,zk,null),E(this,"init",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Tw(Rk(Fk,n).fade,{hide:!0}),Rk(Dk,n).interactiveChildren=!0,n.setInteractive(!0),Rk(Kk,n).call(n,{show:!0,delay:.5});case 4:case"end":return t.stop()}}),t)})))),Ik(this,Gk,(function(){setTimeout((function(){Rk(jk,n).children.forEach((function(t){var e=t.getChildByName("btnText");e.style.fontFamily="NotoSerif",e.style.fill=0}))}),1e3)})),E(this,"setInteractive",(function(t){var e=t?"on":"off",r=t?"static":"none";Rk(jk,n).eventMode=r,Rk(jk,n)[e]("pointerup",Rk(Xk,n)),Rk(Hk,n)[e]("pointerup",Rk(Yk,n)),Rk(Fk,n).optionsWheel.eventMode=r})),Ik(this,Vk,(function(){Rk(Fk,n).userLevel.getChildByName("playerLevelText",1).text=Rk(Wk,n).userLevel})),Ik(this,Xk,function(){var t=Jh(nc().mark((function t(e){var r,i,s;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.target,!(null!==(r=n.clickTimeLine)&&void 0!==r&&r.isActive||"btnContainer"===i.name)){t.next=3;break}return t.abrupt("return");case 3:if(!Rk(zk,n).viewIsShow){t.next=5;break}return t.abrupt("return");case 5:t.t0=i.name,t.next="btnStart"===t.t0?8:"btnStore"===t.t0?13:"btnLeaderboard"===t.t0?18:27;break;case 8:return of.btnStart(),Rk(jk,n).interactiveChildren=!1,Rk(qk,n).call(n,i),Rk($k,n).call(n),t.abrupt("break",28);case 13:return of.mainScreenBtnStore(),t.next=16,Rk(qk,n).call(n,i);case 16:return Rk(Uk,n).showModule(oE),t.abrupt("break",28);case 18:return of.btnLeaders(),t.next=21,Rk(qk,n).call(n,i);case 21:return s=Rk(Uk,n).getModule(lE),t.next=24,s.checkAuth();case 24:return t.sent?(qc.log("","Игрок авторизован."),Rk(Uk,n).showModule(aE)):(qc.warn("","Игрок не авторизован."),Rk(Uk,n).showModule(lE)),t.abrupt("break",28);case 27:return t.abrupt("break",28);case 28:"button"===i.typeName&&tf.get(Qd).play("sfx_btnClick");case 29:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Ik(this,Yk,(function(){window.open("https://t.me/+WpIblpkA3y03ZDAy","_blank"),tf.get(Qd).play("sfx_btnClick")})),Ik(this,$k,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Rk(Wk,n).hasAdPass){t.next=5;break}return t.next=3,_SERVICE.showFullscreenAdv({onOpen:function(){tf.get(Qd).pauseAll()},onClose:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:tf.get(Qd).unPauseAll(),Rk(Lk,n).emit(yh),n.state.checkoutState(ah);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()});case 3:t.next=7;break;case 5:Rk(Lk,n).emit(yh),n.state.checkoutState(ah);case 7:case"end":return t.stop()}}),t)})))),Ik(this,qk,function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.clickTimeLine=ww.timeline().fromTo(e.scale,{x:e.scale.x,y:e.scale.y},{x:1.1,y:1.1,yoyo:!0,repeat:1,duration:.1}),t.abrupt("return",new Promise((function(t){n.clickTimeLine.eventCallback("onComplete",(function(){bw(n.clickTimeLine),n.clickTimeLine=null,t()}))})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Ik(this,Kk,(function(t){var e=t.show,r=t.hide,i=t.delay,s=void 0===i?0:i,o=Rk(Fk,n).optionsWheel,a=Rk(Lk,n).uiInner;return e?ww.timeline().fromTo([a,o],{alpha:0},{alpha:1,delay:s,visible:!0}).fromTo(Rk(Hk,n),{angle:-50},{angle:0,duration:1,ease:"elastic.out(1.5, 0.2)"},"<"):r?ww.timeline().to([a,o],{alpha:0,delay:s,visible:!1}):void 0})),Ik(this,Zk,(function(){Rk(Lk,n).off(yh,Rk(Zk,n)),bw(Rk(Bk,n),!0)})),this.state=e,function(t,e,n){t.set(Ok(t,e),n)}(zk,this,new n_(this.state)),Rk(Lk,this).uiInner.visible=!1,Rk(Vk,this).call(this),Sw.initOverHandler([].concat(Jc(Rk(jk,this).children),[Rk(Hk,this)])),Rk(Lk,this).on(yh,Rk(Zk,this))}));class Jk{constructor(t,e,n){this.value=t,this.time=e,this.next=null,this.isStepped=!1,this.ease=n?"function"==typeof n?n:aM(n):null}static createList(t){if("list"in t){const e=t.list;let n;const{value:r,time:i}=e[0],s=n=new Jk("string"==typeof r?oM(r):r,i,t.ease);if(e.length>2||2===e.length&&e[1].value!==r)for(let t=1;t<e.length;++t){const{value:r,time:i}=e[t];n.next=new Jk("string"==typeof r?oM(r):r,i),n=n.next}return s.isStepped=!!t.isStepped,s}const e=new Jk("string"==typeof t.start?oM(t.start):t.start,0);return t.end!==t.start&&(e.next=new Jk("string"==typeof t.end?oM(t.end):t.end,1)),e}}let tM=vr.from;const eM=Math.PI/180;function nM(t,e){if(!t)return;const n=Math.sin(t),r=Math.cos(t),i=e.x*r-e.y*n,s=e.x*n+e.y*r;e.x=i,e.y=s}function rM(t,e,n){return t<<16|e<<8|n}function iM(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function sM(t,e){t.x*=e,t.y*=e}function oM(t,e){let n;return e||(e={}),"#"===t.charAt(0)?t=t.substr(1):0===t.indexOf("0x")&&(t=t.substr(2)),8===t.length&&(n=t.substr(0,2),t=t.substr(2)),e.r=parseInt(t.substr(0,2),16),e.g=parseInt(t.substr(2,2),16),e.b=parseInt(t.substr(4,2),16),n&&(e.a=parseInt(n,16)),e}function aM(t){const e=t.length,n=1/e;return function(r){const i=e*r|0,s=(r-i*n)*e,o=t[i]||t[e-1];return o.s+s*(2*(1-s)*(o.cp-o.s)+s*(o.e-o.s))}}var lM;class hM extends os{constructor(t){super(),this.prevChild=this.nextChild=null,this.emitter=t,this.config={},this.anchor.x=this.anchor.y=.5,this.maxLife=0,this.age=0,this.agePercent=0,this.oneOverLife=0,this.next=null,this.prev=null,this.init=this.init,this.kill=this.kill}init(t){this.maxLife=t,this.age=this.agePercent=0,this.rotation=0,this.position.x=this.position.y=0,this.scale.x=this.scale.y=1,this.tint=16777215,this.alpha=1,this.oneOverLife=1/this.maxLife,this.visible=!0}kill(){this.emitter.recycle(this)}destroy(){this.parent&&this.parent.removeChild(this),this.emitter=this.next=this.prev=null,super.destroy()}}!function(t){t[t.Spawn=0]="Spawn",t[t.Normal=2]="Normal",t[t.Late=5]="Late"}(lM||(lM={}));const cM=_i.shared,uM=Symbol("Position particle per emitter position");class dM{constructor(t,e){this.initBehaviors=[],this.updateBehaviors=[],this.recycleBehaviors=[],this.minLifetime=0,this.maxLifetime=0,this.customEase=null,this._frequency=1,this.spawnChance=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=new mn,this.particlesPerWave=1,this.rotation=0,this.ownerPos=new mn,this._prevEmitterPos=new mn,this._prevPosIsValid=!1,this._posChanged=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this._completeCallback=null,this.parent=t,e&&this.init(e),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos}static registerBehavior(t){dM.knownBehaviors[t.type]=t}get frequency(){return this._frequency}set frequency(t){this._frequency="number"==typeof t&&t>0?t:1}get parent(){return this._parent}set parent(t){this.cleanup(),this._parent=t}init(t){if(!t)return;this.cleanup(),this._origConfig=t,this.minLifetime=t.lifetime.min,this.maxLifetime=t.lifetime.max,t.ease?this.customEase="function"==typeof t.ease?t.ease:aM(t.ease):this.customEase=null,this.particlesPerWave=1,t.particlesPerWave&&t.particlesPerWave>1&&(this.particlesPerWave=t.particlesPerWave),this.frequency=t.frequency,this.spawnChance="number"==typeof t.spawnChance&&t.spawnChance>0?t.spawnChance:1,this.emitterLifetime=t.emitterLifetime||-1,this.maxParticles=t.maxParticles>0?t.maxParticles:1e3,this.addAtBack=!!t.addAtBack,this.rotation=0,this.ownerPos.set(0),t.pos?this.spawnPos.copyFrom(t.pos):this.spawnPos.set(0),this._prevEmitterPos.copyFrom(this.spawnPos),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=void 0===t.emit||!!t.emit,this.autoUpdate=!!t.autoUpdate;const e=t.behaviors.map((t=>{const e=dM.knownBehaviors[t.type];return e?new e(t.config):(console.error(`Unknown behavior: ${t.type}`),null)})).filter((t=>!!t));e.push(uM),e.sort(((t,e)=>t===uM?e.order===lM.Spawn?1:-1:e===uM?t.order===lM.Spawn?-1:1:t.order-e.order)),this.initBehaviors=e.slice(),this.updateBehaviors=e.filter((t=>t!==uM&&t.updateParticle)),this.recycleBehaviors=e.filter((t=>t!==uM&&t.recycleParticle))}getBehavior(t){return dM.knownBehaviors[t]&&this.initBehaviors.find((e=>e instanceof dM.knownBehaviors[t]))||null}fillPool(t){for(;t>0;--t){const t=new hM(this);t.next=this._poolFirst,this._poolFirst=t}}recycle(t,e=!1){for(let n=0;n<this.recycleBehaviors.length;++n)this.recycleBehaviors[n].recycleParticle(t,!e);t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t===this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t===this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),t.prev=null,t.next=this._poolFirst,this._poolFirst=t,t.parent&&t.parent.removeChild(t),--this.particleCount}rotate(t){if(this.rotation===t)return;const e=t-this.rotation;this.rotation=t,nM(e,this.spawnPos),this._posChanged=!0}updateSpawnPos(t,e){this._posChanged=!0,this.spawnPos.x=t,this.spawnPos.y=e}updateOwnerPos(t,e){this._posChanged=!0,this.ownerPos.x=t,this.ownerPos.y=e}resetPositionTracking(){this._prevPosIsValid=!1}get emit(){return this._emit}set emit(t){this._emit=!!t,this._emitterLife=this.emitterLifetime}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){this._autoUpdate&&!t?cM.remove(this.update,this):!this._autoUpdate&&t&&cM.add(this.update,this),this._autoUpdate=!!t}playOnceAndDestroy(t){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0,this._completeCallback=t}playOnce(t){this.emit=!0,this._completeCallback=t}update(t){if(this._autoUpdate&&(t=.001*cM.elapsedMS),!this._parent)return;for(let e,n=this._activeParticlesFirst;n;n=e)if(e=n.next,n.age+=t,n.age>n.maxLife||n.age<0)this.recycle(n);else{let e=n.age*n.oneOverLife;this.customEase&&(e=4===this.customEase.length?this.customEase(e,0,1,1):this.customEase(e)),n.agePercent=e;for(let e=0;e<this.updateBehaviors.length;++e)if(this.updateBehaviors[e].updateParticle(n,t)){this.recycle(n);break}}let e,n;this._prevPosIsValid&&(e=this._prevEmitterPos.x,n=this._prevEmitterPos.y);const r=this.ownerPos.x+this.spawnPos.x,i=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=t<0?0:t;this._spawnTimer<=0;){if(this._emitterLife>=0&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles){this._spawnTimer+=this._frequency;continue}let s,o;if(this._prevPosIsValid&&this._posChanged){const a=1+this._spawnTimer/t;s=(r-e)*a+e,o=(i-n)*a+n}else s=r,o=i;let a=null,l=null;for(let t=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),e=0;e<t;++e){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let t,e;t=this.minLifetime===this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer>=t||(this._poolFirst?(e=this._poolFirst,this._poolFirst=this._poolFirst.next,e.next=null):e=new hM(this),e.init(t),this.addAtBack?this._parent.addChildAt(e,0):this._parent.addChild(e),a?(l.next=e,e.prev=l,l=e):l=a=e,++this.particleCount)}if(a){this._activeParticlesLast?(this._activeParticlesLast.next=a,a.prev=this._activeParticlesLast,this._activeParticlesLast=l):(this._activeParticlesFirst=a,this._activeParticlesLast=l);for(let t=0;t<this.initBehaviors.length;++t){const e=this.initBehaviors[t];if(e===uM)for(let t,e=a;e;e=t){t=e.next,0!==this.rotation&&(nM(this.rotation,e.position),e.rotation+=this.rotation),e.position.x+=s,e.position.y+=o,e.age+=-this._spawnTimer;let n=e.age*e.oneOverLife;this.customEase&&(n=4===this.customEase.length?this.customEase(n,0,1,1):this.customEase(n)),e.agePercent=n}else e.initParticles(a)}for(let t,e=a;e;e=t){t=e.next;for(let t=0;t<this.updateBehaviors.length;++t)if(this.updateBehaviors[t].updateParticle(e,-this._spawnTimer)){this.recycle(e);break}}}this._spawnTimer+=this._frequency}if(this._posChanged&&(this._prevEmitterPos.x=r,this._prevEmitterPos.y=i,this._prevPosIsValid=!0,this._posChanged=!1),!this._emit&&!this._activeParticlesFirst){if(this._completeCallback){const t=this._completeCallback;this._completeCallback=null,t()}this._destroyWhenComplete&&this.destroy()}}emitNow(){const t=this.ownerPos.x+this.spawnPos.x,e=this.ownerPos.y+this.spawnPos.y;let n=null,r=null;for(let t=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),e=0;e<t;++e){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let t,e;this._poolFirst?(t=this._poolFirst,this._poolFirst=this._poolFirst.next,t.next=null):t=new hM(this),e=this.minLifetime===this.maxLifetime?this.minLifetime:Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,t.init(e),this.addAtBack?this._parent.addChildAt(t,0):this._parent.addChild(t),n?(r.next=t,t.prev=r,r=t):r=n=t,++this.particleCount}if(n){this._activeParticlesLast?(this._activeParticlesLast.next=n,n.prev=this._activeParticlesLast,this._activeParticlesLast=r):(this._activeParticlesFirst=n,this._activeParticlesLast=r);for(let r=0;r<this.initBehaviors.length;++r){const i=this.initBehaviors[r];if(i===uM)for(let r,i=n;i;i=r)r=i.next,0!==this.rotation&&(nM(this.rotation,i.position),i.rotation+=this.rotation),i.position.x+=t,i.position.y+=e;else i.initParticles(n)}}}cleanup(){let t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t,!0);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0}get destroyed(){return!(this._parent&&this.initBehaviors.length)}destroy(){let t;this.autoUpdate=!1,this.cleanup();for(let e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=this._parent=this.spawnPos=this.ownerPos=this.customEase=this._completeCallback=null,this.initBehaviors.length=this.updateBehaviors.length=this.recycleBehaviors.length=0}}dM.knownBehaviors={};class fM{constructor(t){this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h}getRandPos(t){t.x=Math.random()*this.w+this.x,t.y=Math.random()*this.h+this.y}}fM.type="rect",fM.editorConfig=null;class pM{constructor(t){this.x=t.x||0,this.y=t.y||0,this.radius=t.radius,this.innerRadius=t.innerRadius||0,this.rotation=!!t.affectRotation}getRandPos(t){this.innerRadius!==this.radius?t.x=Math.random()*(this.radius-this.innerRadius)+this.innerRadius:t.x=this.radius,t.y=0;const e=Math.random()*Math.PI*2;this.rotation&&(t.rotation+=e),nM(e,t.position),t.position.x+=this.x,t.position.y+=this.y}}pM.type="torus",pM.editorConfig=null;class mM{constructor(t){this.segments=[],this.countingLengths=[],this.totalLength=0,this.init(t)}init(t){if(t&&t.length)if(Array.isArray(t[0]))for(let e=0;e<t.length;++e){const n=t[e];let r=n[0];for(let t=1;t<n.length;++t){const e=n[t];this.segments.push({p1:r,p2:e,l:0}),r=e}}else{let e=t[0];for(let n=1;n<t.length;++n){const r=t[n];this.segments.push({p1:e,p2:r,l:0}),e=r}}else this.segments.push({p1:{x:0,y:0},p2:{x:0,y:0},l:0});for(let t=0;t<this.segments.length;++t){const{p1:e,p2:n}=this.segments[t],r=Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y));this.segments[t].l=r,this.totalLength+=r,this.countingLengths.push(this.totalLength)}}getRandPos(t){const e=Math.random()*this.totalLength;let n,r;if(1===this.segments.length)n=this.segments[0],r=e;else for(let t=0;t<this.countingLengths.length;++t)if(e<this.countingLengths[t]){n=this.segments[t],r=0===t?e:e-this.countingLengths[t-1];break}r/=n.l||1;const{p1:i,p2:s}=n;t.x=i.x+r*(s.x-i.x),t.y=i.y+r*(s.y-i.y)}}mM.type="polygonalChain",mM.editorConfig=null;class gM{constructor(t){var e;this.order=lM.Late,this.minStart=t.minStart,this.maxStart=t.maxStart,this.accel=t.accel,this.rotate=!!t.rotate,this.maxSpeed=null!==(e=t.maxSpeed)&&void 0!==e?e:0}initParticles(t){let e=t;for(;e;){const t=Math.random()*(this.maxStart-this.minStart)+this.minStart;e.config.velocity?e.config.velocity.set(t,0):e.config.velocity=new mn(t,0),nM(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const n=t.config.velocity,r=n.x,i=n.y;if(n.x+=this.accel.x*e,n.y+=this.accel.y*e,this.maxSpeed){const t=iM(n);t>this.maxSpeed&&sM(n,this.maxSpeed/t)}t.x+=(r+n.x)/2*e,t.y+=(i+n.y)/2*e,this.rotate&&(t.rotation=Math.atan2(n.y,n.x))}}function vM(t){return this.ease&&(t=this.ease(t)),(this.first.next.value-this.first.value)*t+this.first.value}function yM(t){this.ease&&(t=this.ease(t));const e=this.first.value,n=this.first.next.value;return rM((n.r-e.r)*t+e.r,(n.g-e.g)*t+e.g,(n.b-e.b)*t+e.b)}function xM(t){this.ease&&(t=this.ease(t));let e=this.first,n=e.next;for(;t>n.time;)e=n,n=n.next;return t=(t-e.time)/(n.time-e.time),(n.value-e.value)*t+e.value}function wM(t){this.ease&&(t=this.ease(t));let e=this.first,n=e.next;for(;t>n.time;)e=n,n=n.next;t=(t-e.time)/(n.time-e.time);const r=e.value,i=n.value;return rM((i.r-r.r)*t+r.r,(i.g-r.g)*t+r.g,(i.b-r.b)*t+r.b)}function _M(t){this.ease&&(t=this.ease(t));let e=this.first;for(;e.next&&t>e.next.time;)e=e.next;return e.value}function bM(t){this.ease&&(t=this.ease(t));let e=this.first;for(;e.next&&t>e.next.time;)e=e.next;const n=e.value;return rM(n.r,n.g,n.b)}gM.type="moveAcceleration",gM.editorConfig=null;class TM{constructor(t=!1){this.first=null,this.isColor=!!t,this.interpolate=null,this.ease=null}reset(t){this.first=t,t.next&&t.next.time>=1?this.interpolate=this.isColor?yM:vM:t.isStepped?this.interpolate=this.isColor?bM:_M:this.interpolate=this.isColor?wM:xM,this.ease=this.first.ease}}class SM{constructor(t){this.order=lM.Normal,this.list=new TM(!1),this.list.reset(Jk.createList(t.alpha))}initParticles(t){let e=t;for(;e;)e.alpha=this.list.first.value,e=e.next}updateParticle(t){t.alpha=this.list.interpolate(t.agePercent)}}SM.type="alpha",SM.editorConfig=null;class AM{constructor(t){this.order=lM.Normal,this.value=t.alpha}initParticles(t){let e=t;for(;e;)e.alpha=this.value,e=e.next}}function EM(t){const e=[];for(let n=0;n<t.length;++n){let r=t[n];if("string"==typeof r)e.push(tM(r));else if(r instanceof vr)e.push(r);else{let t=r.count||1;for(r="string"==typeof r.texture?tM(r.texture):r.texture;t>0;--t)e.push(r)}}return e}AM.type="alphaStatic",AM.editorConfig=null;class CM{constructor(t){this.order=lM.Normal,this.anims=[];for(let e=0;e<t.anims.length;++e){const n=t.anims[e],r=EM(n.textures),i=n.framerate<0?-1:n.framerate>0?n.framerate:60,s={textures:r,duration:i>0?r.length/i:0,framerate:i,loop:i>0&&!!n.loop};this.anims.push(s)}}initParticles(t){let e=t;for(;e;){const t=Math.floor(Math.random()*this.anims.length),n=e.config.anim=this.anims[t];e.texture=n.textures[0],e.config.animElapsed=0,-1===n.framerate?(e.config.animDuration=e.maxLife,e.config.animFramerate=n.textures.length/e.maxLife):(e.config.animDuration=n.duration,e.config.animFramerate=n.framerate),e=e.next}}updateParticle(t,e){const n=t.config,r=n.anim;n.animElapsed+=e,n.animElapsed>=n.animDuration&&(n.anim.loop?n.animElapsed=n.animElapsed%n.animDuration:n.animElapsed=n.animDuration-1e-6);const i=n.animElapsed*n.animFramerate+1e-7|0;t.texture=r.textures[i]||r.textures[r.textures.length-1]||vr.EMPTY}}CM.type="animatedRandom",CM.editorConfig=null;class kM{constructor(t){this.order=lM.Normal;const e=t.anim,n=EM(e.textures),r=e.framerate<0?-1:e.framerate>0?e.framerate:60;this.anim={textures:n,duration:r>0?n.length/r:0,framerate:r,loop:r>0&&!!e.loop}}initParticles(t){let e=t;const n=this.anim;for(;e;)e.texture=n.textures[0],e.config.animElapsed=0,-1===n.framerate?(e.config.animDuration=e.maxLife,e.config.animFramerate=n.textures.length/e.maxLife):(e.config.animDuration=n.duration,e.config.animFramerate=n.framerate),e=e.next}updateParticle(t,e){const n=this.anim,r=t.config;r.animElapsed+=e,r.animElapsed>=r.animDuration&&(n.loop?r.animElapsed=r.animElapsed%r.animDuration:r.animElapsed=r.animDuration-1e-6);const i=r.animElapsed*r.animFramerate+1e-7|0;t.texture=n.textures[i]||n.textures[n.textures.length-1]||vr.EMPTY}}kM.type="animatedSingle",kM.editorConfig=null;class MM{constructor(t){this.order=lM.Normal,this.value=t.blendMode}initParticles(t){let e=t;for(;e;)e.blendMode=(n=this.value)?(n=n.toUpperCase().replace(/ /g,"_"),P[n]||P.NORMAL):P.NORMAL,e=e.next;var n}}MM.type="blendMode",MM.editorConfig=null;class PM{constructor(t){this.order=lM.Spawn,this.spacing=t.spacing*eM,this.start=t.start*eM,this.distance=t.distance}initParticles(t){let e=0,n=t;for(;n;){let t;t=this.spacing?this.start+this.spacing*e:Math.random()*Math.PI*2,n.rotation=t,this.distance&&(n.position.x=this.distance,nM(t,n.position)),n=n.next,++e}}}PM.type="spawnBurst",PM.editorConfig=null;class IM{constructor(t){this.order=lM.Normal,this.list=new TM(!0),this.list.reset(Jk.createList(t.color))}initParticles(t){let e=t;const n=this.list.first.value,r=rM(n.r,n.g,n.b);for(;e;)e.tint=r,e=e.next}updateParticle(t){t.tint=this.list.interpolate(t.agePercent)}}IM.type="color",IM.editorConfig=null;class RM{constructor(t){this.order=lM.Normal;let e=t.color;"#"===e.charAt(0)?e=e.substr(1):0===e.indexOf("0x")&&(e=e.substr(2)),this.value=parseInt(e,16)}initParticles(t){let e=t;for(;e;)e.tint=this.value,e=e.next}}RM.type="colorStatic",RM.editorConfig=null;class OM{constructor(t){this.order=lM.Normal,this.index=0,this.textures=t.textures.map((t=>"string"==typeof t?tM(t):t))}initParticles(t){let e=t;for(;e;)e.texture=this.textures[this.index],++this.index>=this.textures.length&&(this.index=0),e=e.next}}OM.type="textureOrdered",OM.editorConfig=null;const LM=new mn,DM=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atanh","atan2","cbrt","ceil","cos","cosh","exp","expm1","floor","fround","hypot","log","log1p","log10","log2","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh"],FM=new RegExp(["[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]"].concat(DM).join("|"),"g");class NM{constructor(t){var e;if(this.order=lM.Late,t.path)if("function"==typeof t.path)this.path=t.path;else try{this.path=function(t){const e=t.match(FM);for(let t=e.length-1;t>=0;--t)DM.indexOf(e[t])>=0&&(e[t]=`Math.${e[t]}`);return t=e.join(""),new Function("x",`return ${t};`)}(t.path)}catch(t){this.path=null}else this.path=t=>t;this.list=new TM(!1),this.list.reset(Jk.createList(t.speed)),this.minMult=null!==(e=t.minMult)&&void 0!==e?e:1}initParticles(t){let e=t;for(;e;){e.config.initRotation=e.rotation,e.config.initPosition?e.config.initPosition.copyFrom(e.position):e.config.initPosition=new mn(e.x,e.y),e.config.movement=0;const t=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=t,e=e.next}}updateParticle(t,e){const n=this.list.interpolate(t.agePercent)*t.config.speedMult;t.config.movement+=n*e,LM.x=t.config.movement,LM.y=this.path(LM.x),nM(t.config.initRotation,LM),t.position.x=t.config.initPosition.x+LM.x,t.position.y=t.config.initPosition.y+LM.y}}NM.type="movePath",NM.editorConfig=null;class BM{constructor(){this.order=lM.Spawn}initParticles(t){}}BM.type="spawnPoint",BM.editorConfig=null;class WM{constructor(t){this.order=lM.Normal,this.textures=t.textures.map((t=>"string"==typeof t?tM(t):t))}initParticles(t){let e=t;for(;e;){const t=Math.floor(Math.random()*this.textures.length);e.texture=this.textures[t],e=e.next}}}WM.type="textureRandom",WM.editorConfig=null;class UM{constructor(t){this.order=lM.Normal,this.minStart=t.minStart*eM,this.maxStart=t.maxStart*eM,this.minSpeed=t.minSpeed*eM,this.maxSpeed=t.maxSpeed*eM,this.accel=t.accel*eM}initParticles(t){let e=t;for(;e;)this.minStart===this.maxStart?e.rotation+=this.maxStart:e.rotation+=Math.random()*(this.maxStart-this.minStart)+this.minStart,e.config.rotSpeed=Math.random()*(this.maxSpeed-this.minSpeed)+this.minSpeed,e=e.next}updateParticle(t,e){if(this.accel){const n=t.config.rotSpeed;t.config.rotSpeed+=this.accel*e,t.rotation+=(t.config.rotSpeed+n)/2*e}else t.rotation+=t.config.rotSpeed*e}}UM.type="rotation",UM.editorConfig=null;class jM{constructor(t){this.order=lM.Normal,this.min=t.min*eM,this.max=t.max*eM}initParticles(t){let e=t;for(;e;)this.min===this.max?e.rotation+=this.max:e.rotation+=Math.random()*(this.max-this.min)+this.min,e=e.next}}jM.type="rotationStatic",jM.editorConfig=null;class HM{constructor(t){this.order=lM.Late+1,this.rotation=(t.rotation||0)*eM}initParticles(t){let e=t;for(;e;)e.rotation=this.rotation,e=e.next}}HM.type="noRotation",HM.editorConfig=null;class zM{constructor(t){var e;this.order=lM.Normal,this.list=new TM(!1),this.list.reset(Jk.createList(t.scale)),this.minMult=null!==(e=t.minMult)&&void 0!==e?e:1}initParticles(t){let e=t;for(;e;){const t=Math.random()*(1-this.minMult)+this.minMult;e.config.scaleMult=t,e.scale.x=e.scale.y=this.list.first.value*t,e=e.next}}updateParticle(t){t.scale.x=t.scale.y=this.list.interpolate(t.agePercent)*t.config.scaleMult}}zM.type="scale",zM.editorConfig=null;class GM{constructor(t){this.order=lM.Normal,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const t=Math.random()*(this.max-this.min)+this.min;e.scale.x=e.scale.y=t,e=e.next}}}GM.type="scaleStatic",GM.editorConfig=null;class VM{constructor(t){this.order=lM.Spawn;const e=VM.shapes[t.type];if(!e)throw new Error(`No shape found with type '${t.type}'`);this.shape=new e(t.data)}static registerShape(t,e){VM.shapes[e||t.type]=t}initParticles(t){let e=t;for(;e;)this.shape.getRandPos(e),e=e.next}}VM.type="spawnShape",VM.editorConfig=null,VM.shapes={},VM.registerShape(mM),VM.registerShape(fM),VM.registerShape(pM),VM.registerShape(pM,"circle");class XM{constructor(t){this.order=lM.Normal,this.texture="string"==typeof t.texture?tM(t.texture):t.texture}initParticles(t){let e=t;for(;e;)e.texture=this.texture,e=e.next}}XM.type="textureSingle",XM.editorConfig=null;class YM{constructor(t){var e;this.order=lM.Late,this.list=new TM(!1),this.list.reset(Jk.createList(t.speed)),this.minMult=null!==(e=t.minMult)&&void 0!==e?e:1}initParticles(t){let e=t;for(;e;){const t=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=t,e.config.velocity?e.config.velocity.set(this.list.first.value*t,0):e.config.velocity=new mn(this.list.first.value*t,0),nM(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const n=this.list.interpolate(t.agePercent)*t.config.speedMult,r=t.config.velocity;(function(t){const e=1/iM(t);t.x*=e,t.y*=e})(r),sM(r,n),t.x+=r.x*e,t.y+=r.y*e}}YM.type="moveSpeed",YM.editorConfig=null;class $M{constructor(t){this.order=lM.Late,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const t=Math.random()*(this.max-this.min)+this.min;e.config.velocity?e.config.velocity.set(t,0):e.config.velocity=new mn(t,0),nM(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const n=t.config.velocity;t.x+=n.x*e,t.y+=n.y*e}}$M.type="moveSpeedStatic",$M.editorConfig=null,dM.registerBehavior(gM),dM.registerBehavior(SM),dM.registerBehavior(AM),dM.registerBehavior(CM),dM.registerBehavior(kM),dM.registerBehavior(MM),dM.registerBehavior(PM),dM.registerBehavior(IM),dM.registerBehavior(RM),dM.registerBehavior(OM),dM.registerBehavior(NM),dM.registerBehavior(BM),dM.registerBehavior(WM),dM.registerBehavior(UM),dM.registerBehavior(jM),dM.registerBehavior(HM),dM.registerBehavior(zM),dM.registerBehavior(GM),dM.registerBehavior(VM),dM.registerBehavior(XM),dM.registerBehavior(YM),dM.registerBehavior($M);var qM=JSON.parse('{"alpha":{"start":0.8,"end":0},"scale":{"start":0.2,"end":3.2,"minimumScaleMultiplier":0.2},"color":{"start":"#ffdd00","end":"#ffdd00"},"speed":{"start":0.1,"end":1,"minimumSpeedMultiplier":1},"acceleration":{"x":20,"y":-30},"maxSpeed":30,"noRotation":true,"rotationSpeed":{"min":0,"max":0},"startRotation":{"min":0,"max":0},"lifetime":{"min":1,"max":10},"blendMode":"normal","frequency":0.01,"emitterLifetime":-1,"maxParticles":500,"pos":{"x":0,"y":0},"addAtBack":false,"spawnType":"rect"}');function KM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ZM(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?KM(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KM(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function QM(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function JM(t,e){return t.get(eP(t,e))}function tP(t,e,n){return t.set(eP(t,e),n),n}function eP(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nP=new WeakMap,rP=new WeakMap,iP=new WeakMap,sP=new WeakMap,oP=new WeakMap,aP=_((function t(e,n){var r=this;v(this,t),QM(this,nP,void 0),QM(this,rP,void 0),QM(this,iP,void 0),QM(this,sP,void 0),E(this,"init",(function(){try{if(tP(rP,r,new ms(250)),!JM(sP,r))return void console.warn("[MagicDust] Родительский контейнер не определён");JM(sP,r).addChildAt(JM(rP,r),1),JM(iP,r).on(yh,r.destroy),JM(oP,r).call(r)}catch(t){console.error("[MagicDust] Ошибка при инициализации MagicDust:",t)}})),QM(this,oP,(function(){try{var t=vr.from("particle")||vr.WHITE;t||console.warn("[MagicDust] Текстура для эмиттера не найдена");var e=function(t,e){var n,r,i,s,o,a,l,h,c,u,d,f,p,m,g,v,y,x,w,_,b;if("behaviors"in t)return t;const T={lifetime:t.lifetime,ease:t.ease,particlesPerWave:t.particlesPerWave,frequency:t.frequency,spawnChance:t.spawnChance,emitterLifetime:t.emitterLifetime,maxParticles:t.maxParticles,addAtBack:t.addAtBack,pos:t.pos,emit:t.emit,autoUpdate:t.autoUpdate,behaviors:[]};if(t.alpha)if("start"in t.alpha)if(t.alpha.start===t.alpha.end)1!==t.alpha.start&&T.behaviors.push({type:"alphaStatic",config:{alpha:t.alpha.start}});else{const e={list:[{time:0,value:t.alpha.start},{time:1,value:t.alpha.end}]};T.behaviors.push({type:"alpha",config:{alpha:e}})}else 1===t.alpha.list.length?1!==t.alpha.list[0].value&&T.behaviors.push({type:"alphaStatic",config:{alpha:t.alpha.list[0].value}}):T.behaviors.push({type:"alpha",config:{alpha:t.alpha}});if(t.acceleration&&(t.acceleration.x||t.acceleration.y)){let e,i;"start"in t.speed?(e=t.speed.start*(null!==(n=t.speed.minimumSpeedMultiplier)&&void 0!==n?n:1),i=t.speed.start):(e=t.speed.list[0].value*(null!==(r=t.minimumSpeedMultiplier)&&void 0!==r?r:1),i=t.speed.list[0].value),T.behaviors.push({type:"moveAcceleration",config:{accel:t.acceleration,minStart:e,maxStart:i,rotate:!t.noRotation,maxSpeed:t.maxSpeed}})}else if(null===(i=t.extraData)||void 0===i?void 0:i.path){let e,n;"start"in t.speed?(n=null!==(s=t.speed.minimumSpeedMultiplier)&&void 0!==s?s:1,e=t.speed.start===t.speed.end?{list:[{time:0,value:t.speed.start}]}:{list:[{time:0,value:t.speed.start},{time:1,value:t.speed.end}]}):(e=t.speed,n=null!==(o=t.minimumSpeedMultiplier)&&void 0!==o?o:1),T.behaviors.push({type:"movePath",config:{path:t.extraData.path,speed:e,minMult:n}})}else if(t.speed)if("start"in t.speed)if(t.speed.start===t.speed.end)T.behaviors.push({type:"moveSpeedStatic",config:{min:t.speed.start*(null!==(a=t.speed.minimumSpeedMultiplier)&&void 0!==a?a:1),max:t.speed.start}});else{const e={list:[{time:0,value:t.speed.start},{time:1,value:t.speed.end}]};T.behaviors.push({type:"moveSpeed",config:{speed:e,minMult:t.speed.minimumSpeedMultiplier}})}else 1===t.speed.list.length?T.behaviors.push({type:"moveSpeedStatic",config:{min:t.speed.list[0].value*(null!==(l=t.minimumSpeedMultiplier)&&void 0!==l?l:1),max:t.speed.list[0].value}}):T.behaviors.push({type:"moveSpeed",config:{speed:t.speed,minMult:null!==(h=t.minimumSpeedMultiplier)&&void 0!==h?h:1}});if(t.scale)if("start"in t.scale){const e=null!==(c=t.scale.minimumScaleMultiplier)&&void 0!==c?c:1;if(t.scale.start===t.scale.end)T.behaviors.push({type:"scaleStatic",config:{min:t.scale.start*e,max:t.scale.start}});else{const n={list:[{time:0,value:t.scale.start},{time:1,value:t.scale.end}]};T.behaviors.push({type:"scale",config:{scale:n,minMult:e}})}}else if(1===t.scale.list.length){const e=null!==(u=t.minimumScaleMultiplier)&&void 0!==u?u:1,n=t.scale.list[0].value;T.behaviors.push({type:"scaleStatic",config:{min:n*e,max:n}})}else T.behaviors.push({type:"scale",config:{scale:t.scale,minMult:null!==(d=t.minimumScaleMultiplier)&&void 0!==d?d:1}});if(t.color)if("start"in t.color)if(t.color.start===t.color.end)"ffffff"!==t.color.start&&T.behaviors.push({type:"colorStatic",config:{color:t.color.start}});else{const e={list:[{time:0,value:t.color.start},{time:1,value:t.color.end}]};T.behaviors.push({type:"color",config:{color:e}})}else 1===t.color.list.length?"ffffff"!==t.color.list[0].value&&T.behaviors.push({type:"colorStatic",config:{color:t.color.list[0].value}}):T.behaviors.push({type:"color",config:{color:t.color}});if(t.rotationAcceleration||(null===(f=t.rotationSpeed)||void 0===f?void 0:f.min)||(null===(p=t.rotationSpeed)||void 0===p?void 0:p.max)?T.behaviors.push({type:"rotation",config:{accel:t.rotationAcceleration||0,minSpeed:(null===(m=t.rotationSpeed)||void 0===m?void 0:m.min)||0,maxSpeed:(null===(g=t.rotationSpeed)||void 0===g?void 0:g.max)||0,minStart:(null===(v=t.startRotation)||void 0===v?void 0:v.min)||0,maxStart:(null===(y=t.startRotation)||void 0===y?void 0:y.max)||0}}):((null===(x=t.startRotation)||void 0===x?void 0:x.min)||(null===(w=t.startRotation)||void 0===w?void 0:w.max))&&T.behaviors.push({type:"rotationStatic",config:{min:(null===(_=t.startRotation)||void 0===_?void 0:_.min)||0,max:(null===(b=t.startRotation)||void 0===b?void 0:b.max)||0}}),t.noRotation&&T.behaviors.push({type:"noRotation",config:{}}),t.blendMode&&"normal"!==t.blendMode&&T.behaviors.push({type:"blendMode",config:{blendMode:t.blendMode}}),Array.isArray(e)&&"string"!=typeof e[0]&&"framerate"in e[0]){for(let t=0;t<e.length;++t)"matchLife"===e[t].framerate&&(e[t].framerate=-1);T.behaviors.push({type:"animatedRandom",config:{anims:e}})}else"string"!=typeof e&&"framerate"in e?("matchLife"===e.framerate&&(e.framerate=-1),T.behaviors.push({type:"animatedSingle",config:{anim:e}})):t.orderedArt&&Array.isArray(e)?T.behaviors.push({type:"textureOrdered",config:{textures:e}}):Array.isArray(e)?T.behaviors.push({type:"textureRandom",config:{textures:e}}):T.behaviors.push({type:"textureSingle",config:{texture:e}});if("burst"===t.spawnType)T.behaviors.push({type:"spawnBurst",config:{start:t.angleStart||0,spacing:t.particleSpacing,distance:0}});else if("point"===t.spawnType)T.behaviors.push({type:"spawnPoint",config:{}});else{let e;"ring"===t.spawnType?e={type:"torus",data:{x:t.spawnCircle.x,y:t.spawnCircle.y,radius:t.spawnCircle.r,innerRadius:t.spawnCircle.minR,affectRotation:!0}}:"circle"===t.spawnType?e={type:"torus",data:{x:t.spawnCircle.x,y:t.spawnCircle.y,radius:t.spawnCircle.r,innerRadius:0,affectRotation:!1}}:"rect"===t.spawnType?e={type:"rect",data:t.spawnRect}:"polygonalChain"===t.spawnType&&(e={type:"polygonalChain",data:t.spawnPolygon}),e&&T.behaviors.push({type:"spawnShape",config:e})}return T}(ZM(ZM({},qM),{},{spawnRect:{x:JM(sP,r).x,y:0,w:JM(sP,r).width,h:JM(sP,r).height}}),[t]);tP(nP,r,new dM(JM(rP,r),e)),JM(nP,r).autoUpdate=!0,JM(nP,r).emit=!0}catch(t){console.error("[MagicDust] Ошибка при инициализации эмиттера:",t)}})),E(this,"destroy",(function(){try{JM(nP,r)&&(JM(nP,r).emit=!1,JM(nP,r).autoUpdate=!1,JM(nP,r).cleanup(),JM(nP,r).destroy(),tP(nP,r,null)),JM(rP,r)&&(JM(rP,r).destroy({children:!0}),tP(rP,r,null)),JM(iP,r).off(yh,r.destroy),qc.log(Vc.DestroyMessage,"[MagicDust] destroy")}catch(t){qc.warn("","[MagicDust]",t)}})),tP(iP,this,e),tP(sP,this,n)}),[{key:"container",get:function(){return JM(rP,this)}}]);function lP(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(lP=function(){return!!t})()}function hP(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function cP(t,e){return t.get(dP(t,e))}function uP(t,e,n){return t.set(dP(t,e),n),n}function dP(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fP=new WeakMap,pP=new WeakMap,mP=new WeakMap,gP=new WeakMap,vP=new WeakMap,yP=new WeakMap,xP=function(t){function e(t){var n;return v(this,e),n=function(t,e,n){return e=T(e),b(t,lP()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),hP(n,fP,null),hP(n,pP,null),hP(n,mP,null),hP(n,gP,null),hP(n,vP,null),hP(n,yP,null),E(n,"restart",(function(){console.log("[StateGame restart]"),n.terminate(),cP(fP,n).emit(sh)})),E(n,"checkoutState",function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.terminate(),cP(fP,n).emit(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),uP(fP,n,t),uP(vP,n,cP(fP,n).ui),n}return A(e,t),_(e,[{key:"initEventName",get:function(){return sh}},{key:"initialize",value:function(){!function(t,e,n){var r=tc(T(t.prototype),"initialize",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]),uP(pP,this,new Lm(cP(fP,this))),cP(pP,this).addChild(cP(vP,this)),cP(fP,this).viewport.addChild(cP(pP,this)),cP(fP,this).view=cP(pP,this),cP(fP,this).refs=cP(pP,this).refs,uP(mP,this,cP(pP,this).refs),this.game.stateName=this.initEventName,this.isInitialized=!0,this.start()}},{key:"start",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.stateStartScreen=new Qk(this),this.stateStartScreen.init(),t.next=4,this.resize();case 4:qc.log(Vc.StateGame,"The game is running!"),new aP(this.game,cP(fP,this).refs.wrapper).init(),uP(yP,this,tf.get(Qd)),_SERVICE.preloadRewardedAd();case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"resize",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Vu(this.game,Vd),t.next=3,cP(pP,this).resize();case 3:cP(fP,this).emit(dh,!0);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"terminate",value:function(){cP(fP,this).emit(vh),cP(fP,this).off(dh,!0),ww.killTweensOf("*"),ww.globalTimeline.clear(),this.game.viewport.addChild(cP(vP,this)),this.game.uiInner.removeChildren(),cP(pP,this).destroy({children:!0}),uP(pP,this,null),uP(gP,this,null),this.stateStartScreen=null,this.isInitialized=!1,tf.get(Qd).stopAll()}}])}(Kc),wP=Bh,_P={CHARACTER:{name:"character",json:{skeleton:{hash:"iajN5kzmU/s",spine:"4.1.24",x:-518.46,y:-1584.37,width:1788.28,height:1579.71},bones:[{name:"root"},{name:"bone_body",parent:"root",length:774.73,rotation:-97.28,x:320.16,y:-479.8},{name:"head",parent:"bone_body",length:176.78,rotation:-165.2,x:-58.82,y:19.66},{name:"bodyleft",parent:"bone_body",length:212.93,rotation:-37.44,x:-5.37,y:-2.12},{name:"left hand",parent:"bodyleft",length:239.94,rotation:39.2,x:211.32,y:-.13},{name:"bone4",parent:"left hand",length:203.72,rotation:-9.82,x:291.45,y:-12.43},{name:"bone5",parent:"bone4",length:55.15,rotation:3.26,x:245.64,y:-14.46},{name:"bodyright",parent:"bone_body",length:313.49,rotation:72.24,x:-1.3,y:-.16},{name:"right hand",parent:"bodyright",length:330.3,rotation:-61.1,x:312.49,y:.03},{name:"bone7",parent:"right hand",length:202.6,rotation:-65.35,x:380.93,y:-26.35},{name:"bone8",parent:"bone7",length:111.81,rotation:-18.08,x:270.71,y:-20.14},{name:"coat",parent:"bone_body",length:291.99,rotation:-1.06,x:199.23,y:173.03},{name:"coat2",parent:"coat",length:236.83,rotation:1.53,x:336.74,y:-7.29},{name:"coat3",parent:"coat2",length:196.81,rotation:6.82,x:315.2,y:11.94},{name:"bone_body2",parent:"bone_body",length:90.11,rotation:-5.85,x:663.4,y:-86.53},{name:"bone_body3",parent:"bone_body2",length:93.65,rotation:4.21,x:156.77,y:-2.47},{name:"bone_body4",parent:"bone_body3",length:111.77,rotation:-4.22,x:158.61,y:-18.46},{name:"head2",parent:"head",length:203.97,rotation:-5.5,x:81.69,y:320.63},{name:"rightl",parent:"head",length:61.86,rotation:-97.51,x:51.25,y:362.61},{name:"eyes",parent:"head",length:29.02,rotation:-97.51,x:150.02,y:-286.9},{name:"leftl",parent:"head",length:61.86,rotation:-97.51,x:7.21,y:362.61},{name:"bone_body5",parent:"bone_body",length:190.24,rotation:-174.22,x:328.09,y:-383.97},{name:"head3zr",parent:"head",length:38.51,rotation:-98.94,x:101.33,y:-293.26},{name:"bone9",parent:"bone8",length:67.61,rotation:-96.46,x:139.6,y:31.23},{name:"bone10",parent:"bone9",length:42.32,rotation:1.11,x:103.12,y:-2.47},{name:"bone11",parent:"bone10",length:37.12,rotation:41.97,x:81.49,y:6.86}],slots:[{name:"svet",bone:"root",attachment:"svet"},{name:"left hand",bone:"left hand",attachment:"left hand"},{name:"body",bone:"bone_body",attachment:"body"},{name:"coat",bone:"coat",attachment:"coat"},{name:"head",bone:"head",attachment:"head"},{name:"left eye",bone:"eyes",attachment:"left eye"},{name:"thumb",bone:"bone8",attachment:"thumb"},{name:"paper",bone:"bone8",attachment:"paper"},{name:"right hand",bone:"right hand",attachment:"right hand"},{name:"right eye",bone:"eyes",attachment:"right eye"}],skins:[{name:"default",attachments:{body:{body:{type:"mesh",uvs:[.66726,.21715,.6683,.31395,.6679,.31578,.45691,.57645,.43493,.72803,.4894,.79749,.49304,.81317,.51443,.9924,.50336,1,.50219,.99938,.00281,.99941,.01792,.94842,.04876,.87533,.06742,.83112,.09233,.77211,.13535,.67016,.15444,.62493,.20789,.40169,.2678,.31488,.2877,.29184,.43266,.22967,.46459,.22227,.3382,.64325,.35909,.53719,.35909,.45269,.41338,.35921,.45096,.30348,.33452,.67455,.33128,.73831,.33407,.79124,.3173,.85259,.32848,.93078,.3173,.9813],triangles:[17,18,25,26,18,19,8,9,7,10,32,9,10,11,32,9,32,7,32,31,7,32,11,31,11,12,31,12,30,31,12,13,30,13,14,29,14,15,28,31,6,7,5,6,29,29,6,30,30,6,31,30,13,29,29,4,5,14,28,29,29,28,4,28,27,4,28,15,27,27,22,4,4,22,3,27,15,22,15,16,22,22,23,3,22,16,23,16,17,23,23,24,3,3,24,2,2,24,25,23,17,24,25,26,2,24,17,25,25,18,26,2,26,1,26,21,1,21,0,1,19,20,26,26,20,21],vertices:[1,1,-153.08,114.84,1,1,1,-1.28,134.96,1,2,1,1.64,135.06,.77714,7,129.67,38.45,.22286,1,1,428.91,44.82,1,1,1,668.67,60.37,1,3,1,772.97,111.1,.95379,15,-52.29,214.66,.03188,16,-227.48,216.97,.01433,3,1,797.26,116.71,.90787,15,-28.17,220.96,.06447,16,-203.88,225.03,.02766,3,1,1076.66,167.11,.32445,15,249.68,279.33,.21247,16,68.92,303.68,.46309,3,1,1089.54,161.15,.32311,15,262.73,273.75,.21196,16,82.34,299.07,.46493,3,1,1088.67,160.23,.32314,15,261.88,272.81,.21197,16,81.56,298.07,.46489,1,16,158.93,-33.09,1,1,16,78.04,-41.41,1,2,15,115.91,-62.68,.48734,16,-39.33,-47.25,.51266,3,14,205.96,-59.99,.00655,15,44.84,-60.98,.97156,16,-110.34,-50.78,.02189,2,14,111.2,-64.68,.64046,15,-50.01,-58.7,.35954,2,1,603.73,-153.6,.20252,14,-52.52,-72.8,.79748,2,1,531.1,-149.78,.6137,14,-125.16,-76.4,.3863,1,3,239.18,-13.74,1,1,3,112.9,-81.41,1,1,3,77.46,-97.43,1,1,1,-113.17,-41.12,1,1,1,-127.55,-21.04,1,2,1,543.98,-21.97,.95264,14,-125.37,52.06,.04736,3,1,375.74,-29.14,.81763,14,-292.01,27.78,.00237,21,-83.12,-348.23,.18,2,1,243.15,-46.09,.82,21,50.5,-344.71,.18,2,1,91.77,-28.16,.82,21,199.31,-377.78,.18,1,1,1.07,-13.95,1,2,1,593.42,-18.18,.92903,14,-76.58,60.86,.07097,2,1,693.75,-7.58,.95999,14,22.15,81.63,.04001,3,1,776.56,4.92,.99802,15,-45.66,108.63,.00134,16,-213.06,111.71,64e-5,3,1,874.28,5.9,.50438,15,52,112.4,.42826,16,-115.95,122.66,.06737,3,1,996.02,29.14,.27483,15,173.02,139.11,.27548,16,2.78,158.2,.44969,3,1,1076.27,31.72,.20589,15,253.16,143.99,.169,16,82.34,168.96,.62511],hull:22}},coat:{coat:{type:"mesh",uvs:[.43016,0,.46268,.02972,.60879,.10423,.6462,.10938,.88495,.1656,.92006,.20347,.80064,.27595,.76216,.28296,.76369,.42328,.79801,.52111,.85032,.64512,.8897,.7385,.90696,.77942,.92585,.8242,.96052,.9064,.98718,.96962,1,.99989,.57193,.99985,.31719,.99983,49e-5,.9998,.0019,.94854,.0031,.90491,.00445,.85594,.00565,.81232,.00681,.77032,.0076,.74131,.00905,.68873,.01045,.63796,.0143,.49801,.01645,.41987,.36706,.10307,.39284,.05843,.38878,2e-5,.35426,.43086,.3311,.49443,.34036,.53075,.34036,.60157,.3172,.66331,.3172,.74322,.31721,.82857,.31721,.90303,.31721,.9448,.55805,.43631,.55805,.50895,.55805,.56162,.55805,.59794,.55342,.62699,.55342,.68329,.55342,.7414,.55342,.77046,.55805,.82857,.56731,.88305,.56731,.95024],triangles:[4,7,3,6,4,5,6,7,4,49,11,12,39,38,49,24,38,39,23,24,39,50,49,12,50,12,13,39,49,50,22,23,39,51,50,13,51,40,39,51,39,50,22,39,40,21,22,40,51,13,14,52,41,40,21,40,41,20,21,41,52,51,14,52,40,51,52,14,15,18,20,41,18,41,52,19,20,18,17,52,15,18,52,17,17,15,16,45,44,9,36,35,44,36,44,45,46,36,45,45,9,10,46,45,10,27,28,36,36,28,35,37,36,46,37,27,36,47,46,10,37,46,47,26,27,37,47,10,11,48,47,11,38,37,47,26,37,38,38,47,48,25,26,38,24,25,38,49,48,11,38,48,49,1,31,32,1,32,0,31,1,2,30,31,2,29,30,33,2,7,30,3,7,2,7,33,30,7,42,33,8,42,7,34,29,33,28,29,34,43,42,8,43,8,9,34,43,35,42,34,33,43,34,42,44,43,9,35,43,44,35,28,34],vertices:[1,11,-326.12,-66.81,1,2,11,-292.67,-46.26,.89143,7,97.69,128.89,.10857,2,11,-213.26,35.68,.85714,7,199,76.39,.14286,2,11,-209.66,54.2,.86571,7,217.77,78.26,.13429,1,7,349.62,64.55,1,1,7,384.23,29.97,1,1,7,369.99,-73.82,1,1,7,357,-89.28,1,2,11,159.27,164.84,.97659,12,-172.82,176.8,.02341,3,11,274.4,198.24,.68572,12,-56.84,207.12,.30597,13,-346.23,237.96,.00831,3,11,419.75,244.72,.16991,12,89.69,249.71,.67845,13,-195.68,262.86,.15164,3,11,529.19,279.72,.0308,12,200.03,281.78,.51848,13,-82.32,281.6,.45072,3,11,577.15,295.05,.01086,12,248.38,295.84,.38518,13,-32.64,289.82,.60395,3,11,629.63,311.84,.00207,12,301.29,311.22,.24524,13,21.72,298.81,.75269,2,12,398.42,339.45,.0719,13,121.51,315.31,.9281,2,12,473.11,361.16,.01856,13,198.26,328,.98144,2,12,508.88,371.59,.01323,13,235,334.11,.98677,2,12,533.02,169.26,49e-5,13,234.95,130.34,.99951,1,13,234.93,9.09,1,1,13,234.89,-141.66,1,1,13,172.67,-140.99,1,2,12,450.71,-113.27,.00626,13,119.69,-140.42,.99374,2,12,391.61,-119.69,.06886,13,60.24,-139.78,.93114,2,12,338.97,-125.41,.24893,13,7.29,-139.21,.75107,2,12,288.27,-130.92,.53585,13,-43.69,-138.66,.46415,2,12,253.26,-134.72,.73541,13,-78.92,-138.28,.26459,2,12,189.79,-141.62,.95037,13,-142.75,-137.59,.04963,3,11,469.16,-152.09,.00456,12,128.52,-148.27,.99358,13,-204.38,-136.92,.00186,2,11,300.79,-174.93,.50232,12,-40.4,-166.62,.49768,2,11,206.79,-187.68,.84632,12,-134.7,-176.87,.15368,1,11,-197.96,-78.37,1,1,11,-253.35,-74.09,1,1,11,-323.25,-86.3,1,2,11,196.66,-26.65,.9925,12,-140.55,-15.62,.0075,2,11,274.6,-26.36,.90536,12,-62.62,-17.41,.09464,2,11,317.59,-15.6,.4019,12,-19.36,-7.8,.5981,3,11,402.66,-3.12,55e-5,12,66.01,2.41,.99941,13,-248.56,20.12,4e-5,1,12,141.75,.37,1,2,12,238.06,11.88,.95066,13,-76.6,9.09,.04934,1,13,27.02,9.09,1,1,13,117.41,9.09,1,1,13,168.12,9.09,1,2,11,189.12,70.28,.99365,12,-145.5,81.48,.00635,3,11,276.38,83.08,.82481,12,-57.93,91.95,.17465,13,-361,123.74,54e-5,3,11,339.63,92.36,.43189,12,5.55,99.54,.56069,13,-297.06,123.74,.00742,3,11,383.26,98.76,.22512,12,49.33,104.77,.75375,13,-252.97,123.74,.02113,3,11,418.48,101.69,.12677,12,84.62,106.77,.83275,13,-217.69,121.53,.04048,3,11,486.1,111.61,.04153,12,152.48,114.89,.83175,13,-149.35,121.53,.12673,3,11,555.9,121.85,.01012,12,222.53,123.26,.63984,13,-78.8,121.53,.35004,3,11,590.8,126.97,.00395,12,257.55,127.45,.47848,13,-43.53,121.53,.51757,3,11,660.28,139.39,14e-5,12,327.34,138.01,.18455,13,27.02,123.74,.81532,2,12,392.49,150.24,.05756,13,93.16,128.15,.94244,2,12,473.48,159.93,.00696,13,174.73,128.15,.99304],hull:33}},head:{head:{type:"mesh",uvs:[.5716,0,.65521,.02381,.69236,.04725,.72292,.07533,.7514,.12633,.78314,.28674,.80841,.30033,.9298,.2994,.98927,.32184,.99813,.33853,.99725,.3635,.96395,.404,.86416,.46523,.85585,.55927,.79245,.64675,.78104,.70155,.78574,.78131,.75821,.83295,.51195,1,.48564,1,.43518,.97852,.39394,.89605,.37419,.86302,.31497,.786,.285,.73228,.26198,.6613,.23027,.56354,.22528,.51009,.1687,.5027,.05023,.46679,.00266,.4378,.00274,.40864,.0297,.4008,.19612,.3524,.21732,.29534,.22832,.12259,.246,.0635,.29167,.02625,.46466,.00537,.53026,0,.47005,.89363,.56652,.87631,.68174,.80577,.75275,.73275,.75275,.66345,.19431,.38323,.35833,.37019,.51883,.35064,.68286,.33598,.75517,.32295,.39537,.46631,.39184,.54777,.38479,.59338,.36715,.62759,.4183,.67158,.43947,.75467,.37771,.05038,.37168,.13209,.36967,.20452,.36967,.27694,.37168,.32894,.45765,.45182,.57934,.42566,.62119,.43935,.36761,.74688,.53404,.73611,.60642,.48616],triangles:[17,41,42,17,18,41,41,18,40,20,40,19,18,19,40,20,21,40,21,22,40,22,55,40,40,65,41,40,55,65,41,65,42,23,64,22,22,64,55,17,42,16,42,43,16,42,65,43,23,24,64,43,15,16,64,54,55,55,54,65,54,64,53,65,54,66,65,44,43,65,66,44,66,61,62,51,61,66,43,44,15,64,24,53,24,25,53,15,44,14,53,52,54,52,51,54,66,54,51,61,51,50,44,66,14,25,26,53,14,66,12,12,66,63,49,12,63,49,63,48,13,14,12,49,6,12,53,26,52,52,26,51,26,27,51,5,6,49,51,27,50,28,45,27,27,46,50,27,45,46,28,29,45,66,62,63,29,30,32,30,31,32,29,32,45,50,46,61,12,7,11,12,6,7,61,46,47,61,47,62,47,46,60,63,62,48,62,47,48,10,7,8,10,11,7,45,32,33,45,33,46,33,34,46,46,34,60,10,8,9,4,48,47,1,47,0,0,57,39,57,0,58,57,56,38,39,57,38,49,48,5,4,2,3,2,4,47,2,47,1,34,59,60,58,47,60,58,0,47,5,48,4,34,58,59,34,35,58,60,59,58,58,35,57,35,36,57,36,37,57,57,37,56,56,37,38],vertices:[2,2,309.85,-36.33,.93143,17,261.17,-331.58,.06857,2,2,297.05,-64.24,.93143,17,251.09,-360.59,.06857,2,2,286.51,-76,.93143,17,241.74,-373.31,.06857,2,2,274.53,-85.24,.93143,17,230.7,-383.66,.06857,2,2,254.01,-92.62,.93143,17,210.98,-392.97,.06857,2,2,192.12,-95.7,.93143,17,149.67,-401.97,.06857,2,2,185.84,-103.82,.93143,17,144.2,-410.65,.06857,2,2,180.62,-146.1,.93143,17,143.05,-453.24,.06857,2,2,169.44,-165.68,.93143,17,133.8,-473.8,.06857,2,2,162.75,-167.94,.93143,17,127.36,-476.69,.06857,2,2,153.38,-166.39,.93143,17,117.88,-476.05,.06857,2,2,139.65,-152.79,.93143,17,102.91,-463.83,.06857,2,2,121.16,-115.03,.76,17,80.89,-428.01,.24,2,2,86.11,-107.46,.76,17,45.27,-423.84,.24,2,2,56.06,-81.05,.82857,17,12.83,-400.43,.17143,1,2,35.94,-74.36,1,1,2,5.68,-72.03,1,1,2,-12.51,-59.89,1,1,2,-64.15,34.11,1,1,2,-62.94,43.26,1,1,2,-52.53,59.76,1,1,2,-19.57,70.01,1,2,2,-6.22,75.24,.72286,17,-64.15,-250.83,.27714,2,2,25.51,92.02,.82857,17,-34.17,-231.09,.17143,2,2,47.13,99.78,.82857,17,-13.4,-221.29,.17143,2,2,74.93,104.27,.82857,17,13.84,-214.16,.17143,2,2,113.21,110.45,.82857,17,51.35,-204.34,.17143,2,2,133.57,109.53,.82857,17,71.71,-203.3,.17143,2,2,138.96,128.85,.82286,17,75.22,-183.55,.17714,2,2,157.92,168.29,.82286,17,90.31,-142.47,.17714,2,2,171.02,183.4,.82286,17,101.91,-126.17,.17714,2,2,182.01,181.93,.82286,17,112.98,-126.59,.17714,2,2,183.73,172.16,.82286,17,115.63,-136.15,.17714,2,2,194.32,111.84,.82286,17,131.96,-195.17,.17714,2,2,214.84,101.63,.82286,17,153.37,-203.37,.17714,2,2,279.42,89.22,.82286,17,218.83,-209.53,.17714,2,2,300.87,80.13,.82286,17,241.06,-216.52,.17714,2,2,312.81,62.39,.93143,17,254.64,-233.04,.06857,2,2,312.74,1.15,.93143,17,260.44,-294,.06857,2,2,311.75,-21.94,.93143,17,261.68,-317.08,.06857,2,2,-22.15,43.4,.40286,17,-76.95,-284.05,.59714,2,2,-20.05,8.97,.82571,17,-71.56,-318.12,.17429,2,2,1.24,-34.63,.82571,17,-46.19,-359.48,.17429,2,2,25.49,-62.96,.82571,17,-19.34,-385.36,.17429,2,2,51.6,-66.41,.82571,17,6.98,-386.28,.17429,2,2,182.79,114,.82286,17,120.27,-194.13,.17714,2,2,180.17,56.28,.60857,17,123.2,-251.84,.39143,2,2,180.17,-.55,.93143,17,128.65,-308.4,.06857,2,2,178.17,-58.35,.93143,17,132.2,-366.13,.06857,2,2,179.76,-84.17,.93143,17,136.26,-391.67,.06857,2,2,142.26,48.16,.60286,17,86.25,-263.55,.39714,2,2,111.74,53.44,.60286,17,55.35,-261.23,.39714,2,2,94.88,58.16,.60286,17,38.12,-258.14,.39714,2,2,82.8,65.99,.60286,17,25.34,-251.5,.39714,2,2,63.88,50.38,.60286,17,8.01,-268.86,.39714,2,2,31.61,47.14,.60286,17,-23.8,-275.17,.39714,2,2,299.77,33.65,.60857,17,244.42,-262.9,.39143,2,2,269.26,39.8,.60857,17,213.46,-259.69,.39143,2,2,242.07,44.1,.60857,17,185.98,-258.02,.39143,2,2,214.79,47.7,.60857,17,158.48,-257.06,.39143,2,2,195.1,49.58,.60857,17,138.71,-257.07,.39143,2,2,144.87,26.14,.80034,17,91.13,-287.07,.19966,2,2,149.13,-17.66,.66168,17,99.58,-330.26,.33832,2,2,142.06,-31.58,.68273,17,93.87,-344.79,.31727,3,2,37.84,72.3,.65945,17,-19.83,-251.39,.26912,20,283.81,68.32,.07143,3,2,34.25,13.92,.56412,17,-17.8,-309.84,.27302,18,347.92,28.74,.16286,3,2,125.1,-24.04,.72081,17,76.27,-338.91,.26331,18,373.67,123.77,.01588],hull:40}},"left eye":{"left eye":{type:"mesh",uvs:[.72294,0,1,.54814,1,.59373,.86434,.85635,.35549,1,.20728,1,.00293,.59779,.07869,.18484,.46347,0,.54043,.48077],triangles:[9,8,0,3,9,0,1,3,0,2,3,1,9,5,7,9,7,8,6,7,5,4,5,9,4,9,3],vertices:[3,2,140.94,67.19,.47926,19,-349.86,-55.3,.33502,17,83.28,-246.59,.18572,3,2,127.42,56.95,.38193,19,-337.95,-67.36,.04379,17,70.81,-258.07,.57429,2,2,126.43,57.08,.81429,17,69.81,-258.04,.18571,2,2,121.46,63.62,.63714,17,64.24,-252,.36286,2,2,121.19,85.73,.86286,17,61.85,-230.03,.13714,2,2,122.02,92.05,.70857,17,62.07,-223.66,.29143,3,2,131.95,99.6,.52034,19,-380.82,-68.45,.05966,17,71.22,-215.19,.42,3,2,140.53,95.18,.54318,19,-377.57,-59.37,.20825,17,80.19,-218.76,.24857,3,2,142.4,78.25,.49662,19,-361.02,-55.3,.26909,17,83.67,-235.44,.23429,4,2,131.48,76.35,.51632,19,-357.71,-65.88,.10666,17,72.98,-238.37,.19987,22,-369.8,-27.68,.17714],hull:9}},"left hand":{"left hand":{type:"mesh",uvs:[.87012,.00539,.91585,.01493,.97359,.0645,.99009,.1108,.97568,.1876,.94488,.2089,.92573,.2174,.9259,.28367,.89299,.37595,.86215,.44602,.71991,.61988,.70733,.65796,.5637,.81737,.4609,.83106,.43814,.83751,.39996,.89612,.37231,.93855,.31247,.98561,.28082,.99568,.25835,1,.25263,1,.13778,.98744,.10526,.97524,.00448,.90559,.00395,.86776,.11196,.8173,.11068,.77356,.25467,.6226,.33946,.56843,.36533,.56139,.38998,.50525,.43821,.48383,.44918,.46986,.47564,.39832,.56842,.31155,.64332,.2804,.62922,.26785,.65186,.21592,.73744,.15688,.799,.02736,.81282,.00617,.27335,.96649,.22566,.93476,.22566,.90495,.22566,.87033,.2346,.84341,.19884,.9713,.15711,.9463,.13327,.90014,.12433,.85879,.18096,.82898,.24951,.76263,.34488,.76937,.40746,.77802,.47005,.79918,.43609,.7025,.47346,.63468,.48748,.60153,.5809,.53521,.63228,.47794,.72103,.37847,.7584,.33778,.81913,.27749,.87985,.11472,.84248,.22474,.87518,.17049],triangles:[51,26,27,50,25,26,51,50,26,54,14,53,13,54,12,13,14,54,52,45,50,52,50,51,45,52,53,49,25,50,49,50,45,24,25,49,44,49,45,45,53,14,14,44,45,15,44,14,48,49,44,24,49,48,43,44,15,48,44,43,23,24,48,16,42,43,15,16,43,42,47,48,42,48,43,41,42,16,46,47,42,41,46,42,47,22,23,47,23,48,22,47,46,17,41,16,21,22,46,18,41,17,46,41,18,20,46,18,21,46,20,19,20,18,35,36,62,61,35,62,34,35,61,61,62,7,8,61,7,60,34,61,60,61,8,33,34,60,9,60,8,59,33,60,59,60,9,32,33,59,59,31,32,58,31,59,30,31,58,29,30,58,57,29,58,9,58,59,10,58,9,57,58,10,57,28,29,56,57,10,57,27,28,56,27,57,11,56,10,55,27,56,55,56,11,51,27,55,52,51,55,53,52,55,12,54,55,53,55,54,11,12,55,40,1,2,1,40,0,63,2,3,2,39,40,63,39,2,38,39,63,65,38,63,3,65,63,4,65,3,5,65,4,6,65,5,64,38,65,64,65,6,37,38,64,36,37,64,62,36,64,64,6,7,62,64,7],vertices:[1,4,127.44,-14.63,1,1,4,131.47,-6.85,1,1,4,155.2,4.79,1,1,4,177.94,9.66,1,1,4,216.3,11.04,1,1,4,227.36,7.13,1,1,4,231.88,4.47,1,2,4,264.79,7.68,.52075,5,-29.7,15.27,.47925,1,5,16.11,22.35,1,1,5,51.14,26.82,1,1,5,140.86,27.7,1,1,5,159.72,30.78,1,2,5,242.55,29.53,.44656,6,-.58,44.09,.55344,2,5,253.52,15.38,.20143,6,9.57,29.34,.79857,2,5,257.6,12.7,.11242,6,13.49,26.43,.88758,1,6,43.37,26.55,1,1,6,65,26.64,1,1,6,89.98,22.13,1,1,6,95.96,18.21,1,1,6,98.83,15.12,1,1,6,99.02,14.22,1,1,6,96.77,-5.17,1,1,6,91.92,-11.57,1,1,6,61.33,-34.72,1,1,6,42.89,-38.76,1,2,5,261.78,-40.61,.00235,6,14.63,-27.03,.99765,2,5,240.78,-46.59,.11944,6,-6.67,-31.8,.88056,2,5,162,-44.17,.99145,6,-85.19,-24.92,.00855,1,5,132.32,-38.16,1,1,5,127.83,-35.08,1,1,5,99.77,-38.67,1,1,5,87.41,-34.01,1,1,5,80.22,-34.15,1,1,5,44.66,-39.49,1,2,4,284.19,-48.26,.07754,5,-1.05,-36.55,.92246,2,4,267.55,-37.76,.38092,5,-19.23,-29.03,.61908,2,4,261.54,-40.62,.52225,5,-24.67,-32.88,.47775,2,4,235.39,-39.49,.88361,5,-50.62,-36.23,.11639,2,4,204.74,-28.61,.99978,5,-82.68,-30.74,22e-5,1,4,139.46,-24.97,1,1,4,128.72,-23.78,1,1,6,81.98,13.98,1,1,6,68.1,3.15,1,1,6,53.56,.04,1,1,6,36.67,-3.58,1,1,6,23.23,-4.99,1,1,6,86.84,2.75,1,1,6,76.04,-6.43,1,1,6,54.33,-15.01,1,1,6,34.45,-20.74,1,1,6,18,-14.94,1,2,5,229.61,-26.48,.27834,6,-16.69,-11.09,.72166,2,5,228.78,-10.78,.37364,6,-16.62,4.63,.62636,2,5,230.28,.08,.43458,6,-14.51,15.39,.56542,2,5,237.79,12.59,.39617,6,-6.3,27.45,.60383,2,5,192.72,-5.45,.99006,6,-52.32,12,.00994,1,5,158.49,-8.61,1,1,5,141.94,-10.81,1,1,5,106.05,-5.07,1,1,5,76.3,-4.65,1,1,5,24.65,-4.02,1,2,4,294.27,-16.56,.00247,5,3.48,-3.59,.99753,2,4,263.38,-9.73,.53264,5,-28.12,-2.12,.46736,1,4,181.6,-7.82,1,2,4,236.82,-8.52,.978,5,-54.5,-5.47,.022,1,4,209.37,-5.89,1],hull:41}},paper:{paper:{type:"mesh",uvs:[.18606,0,.30822,0,.39818,.0245,.45421,.09757,.93007,.36801,.95636,.48717,.97452,.5482,.99017,.60083,1,.63387,1,.69185,1,.78281,1,.8328,1,.88637,1,.95236,.9942,1,.97602,1,.91533,.97541,.8146,.93784,.755,.91561,.66957,.89164,.59076,.87751,.50259,.8617,.4538,.86051,.45376,.82892,.45369,.75526,.45365,.71672,.45361,.67984,.45357,.64191,.4466,.58935,.44044,.53555,.43511,.48912,.43024,.44662,.42694,.41784,.42728,.41102,.42237,.39647,.41352,.37021,.40796,.35372,.39877,.32644,.39349,.31079,.38754,.29313,.37794,.27457,.3705,.2602,.3487,.21807,.30812,.17735,.28328,.15244,.24822,.11727,.2145,.10115,.17286,.08123,.12058,.05623,.03977,.0384,0,.02963,0,.02085,.11095,0,.489,.09126,.53425,.12825,.5749,.21234,.59358,.25535,.59392,.33812,.73865,.34926,.83419,.38555,.86873,.41233,.90082,.44148,.78862,.36657,.65773,.34127,.59904,.30755],triangles:[56,40,41,39,40,56,3,4,55,42,3,55,44,45,3,47,48,0,1,47,0,46,47,1,45,46,1,45,1,2,45,2,3,63,56,55,56,41,55,49,50,51,52,49,51,48,52,0,49,52,48,43,44,3,42,55,41,43,3,42,63,62,27,58,62,63,38,39,64,37,38,64,36,37,57,35,36,57,34,35,57,33,34,57,57,32,33,31,32,57,58,63,55,63,64,56,39,56,64,57,37,64,57,64,63,57,63,31,55,4,58,58,4,62,59,62,4,62,60,27,62,59,60,60,59,4,61,60,4,61,4,5,63,30,31,63,29,30,63,28,29,61,26,60,5,6,61,27,60,26,8,26,7,25,26,8,9,25,8,24,25,9,24,9,10,21,23,24,10,21,24,21,22,23,21,10,20,10,19,20,11,19,10,11,18,19,12,18,11,17,18,12,16,17,12,13,16,12,15,16,13,14,15,13,63,27,28,61,6,26,7,26,6],vertices:[1,25,74.33,-4.49,1,1,25,60.43,-16.83,1,1,25,45.84,-21.18,1,1,25,28.26,-22.74,1,3,23,131.2,-49.22,.0213,24,27.16,-47.29,.97868,25,-76.61,-3.93,2e-5,2,23,101.19,-52.04,.23657,24,-2.9,-49.53,.76343,2,23,83.6,-52.58,.49729,24,-20.49,-49.73,.50271,2,23,68.71,-53.26,.71926,24,-35.39,-50.12,.28074,2,23,59.48,-53.77,.8212,24,-44.63,-50.45,.1788,2,23,43.65,-52.15,.93502,24,-60.42,-48.53,.06498,2,23,18.99,-49.74,.99663,24,-85.03,-45.64,.00337,2,23,5.49,-48.46,.99999,24,-98.5,-44.1,1e-5,1,23,-8.96,-47.09,1,1,23,-26.76,-45.41,1,1,23,-39.53,-43.31,1,1,23,-39.27,-40.56,1,1,23,-31.77,-32.01,1,1,23,-20.19,-17.72,1,1,23,-13.34,-9.27,1,1,23,-5.65,3.05,1,1,23,-.71,14.61,1,1,23,4.82,27.55,1,1,23,5.84,34.9,1,1,23,14.36,34.1,1,1,23,34.23,32.23,1,2,23,44.63,31.25,.99959,24,-57.83,34.84,41e-5,2,23,54.58,30.32,.98619,24,-47.9,33.72,.01381,2,23,64.82,29.36,.92081,24,-37.68,32.56,.07919,2,23,79.1,29.07,.68247,24,-23.41,31.99,.31753,2,23,93.7,28.63,.33864,24,-8.82,31.27,.66136,2,23,106.3,28.25,.11547,24,3.77,30.65,.88453,3,23,117.84,27.9,.02386,24,15.3,30.08,.97418,25,-33.69,61.52,.00195,3,23,125.65,27.67,.00456,24,23.11,29.69,.98103,25,-28.15,56.02,.01441,3,23,127.49,27.44,.00248,24,24.94,29.43,.97727,25,-26.96,54.6,.02025,3,23,131.48,27.81,32e-5,24,28.94,29.73,.9604,25,-23.79,52.14,.03928,2,24,36.16,30.26,.90218,25,-18.06,47.71,.09782,2,24,40.7,30.59,.84548,25,-14.47,44.92,.15452,2,24,48.2,31.14,.71471,25,-8.52,40.31,.28529,2,24,52.51,31.45,.62125,25,-5.11,37.67,.37875,2,24,57.36,31.81,.50316,25,-1.26,34.68,.49684,2,24,62.53,32.69,.3751,25,3.17,31.89,.6249,2,24,66.52,33.37,.28464,25,6.59,29.72,.71536,2,24,78.24,35.37,.08532,25,16.64,23.37,.91468,2,24,89.9,40.25,.00993,25,28.58,19.2,.99007,2,24,97.04,43.23,7e-4,25,35.88,16.64,.9993,1,25,46.19,13.04,1,1,25,52.92,13.17,1,1,25,61.24,13.32,1,1,25,71.68,13.52,1,1,25,84.08,18.04,1,1,25,90.18,20.27,1,1,25,91.76,18.49,1,1,25,82.88,3.08,1,1,25,25.01,-25.18,1,1,25,13.22,-22.24,1,2,24,82.85,-4.39,.07612,25,-6.51,-9.27,.92388,2,24,70.95,-5.89,.32563,25,-16.37,-2.43,.67437,2,24,48.65,-3.39,.89612,25,-31.28,14.33,.10388,2,24,41.72,-23.79,.96051,25,-50.07,3.8,.03949,3,23,133.07,-38.17,.01017,24,29.25,-36.28,.98807,25,-67.7,2.86,.00177,2,23,124.52,-42.1,.03465,24,20.63,-40.04,.96535,2,23,115.37,-45.59,.08781,24,11.41,-43.36,.91219,3,23,139.44,-32.21,.00152,24,35.73,-30.44,.98616,25,-58.97,2.86,.01232,2,24,46.71,-12.93,.91873,25,-39.1,8.54,.08127,2,24,56.8,-5.11,.70435,25,-26.37,7.61,.29565],hull:53}},"right eye":{"right eye":{type:"mesh",uvs:[.98503,.29143,.9785,.55445,.55845,.92018,0,.86688,.04488,.58503,.09621,.26271,.2925,.03989,.55149,.03945,.82037,.039,.54502,.45237],triangles:[3,4,2,2,4,9,9,4,5,5,6,9,1,2,9,1,9,8,8,9,7,1,8,0,9,6,7],vertices:[3,2,131.79,-30.58,.58702,19,-251.74,-51.59,.14155,17,83.55,-344.78,.27143,2,2,125.32,-29.37,.67714,17,76.99,-344.2,.32286,2,2,119.16,-6.11,.69429,17,68.63,-321.63,.30571,2,2,124.35,23.06,.67714,17,71,-292.1,.32286,3,2,131.03,19.78,.61149,19,-301.57,-58.93,.13423,17,77.96,-294.72,.25429,3,2,138.66,16.03,.56461,19,-298.85,-50.87,.1811,17,85.92,-297.73,.25429,3,2,142.82,4.99,.497,19,-288.45,-45.3,.29729,17,91.12,-308.32,.20571,3,2,141.04,-8.62,.5055,19,-274.72,-45.29,.27736,17,90.65,-322.04,.21714,3,2,139.19,-22.75,.54947,19,-260.47,-45.28,.17624,17,90.16,-336.28,.27429,4,2,130.85,-6.93,.48513,19,-275.06,-55.61,.121,17,80.35,-321.33,.21102,22,-287.44,-15.35,.18286],hull:9}},"right hand":{"right hand":{type:"mesh",uvs:[.76061,0,.85449,.03317,.91499,.07697,.97204,.29328,1,.63877,1,.67799,.98999,.70955,.97883,.74474,.96335,.75286,.94375,.76315,.68239,.90023,.47003,.9683,.41587,1,.3613,.99013,.33777,.93215,.32405,.92603,.29694,.92627,.16098,.97699,.07243,.95907,0,.87222,0,.86706,.01331,.8093,.22075,.77884,.23708,.7805,.26671,.78074,.28323,.78087,.30095,.78101,.30262,.75506,.41144,.71282,.48568,.71491,.50954,.69883,.61363,.66889,.67742,.63016,.69244,.62104,.70854,.61127,.7008,.58368,.65192,.40958,.65183,.17728,.66925,.09971,.74549,0,.07381,.89179,.14462,.87895,.20285,.86377,.2422,.84509,.27525,.81708,.4342,.87195,.59315,.81708,.66869,.78906,.79297,.72388,.83615,.66744,.85465,.62168],triangles:[44,24,25,44,25,26,44,43,23,44,23,24,22,41,21,43,42,22,43,22,23,41,20,21,20,40,19,41,22,42,41,40,20,43,44,15,16,43,15,42,43,16,18,19,40,17,41,42,17,42,16,18,40,41,17,18,41,48,33,49,32,33,48,6,8,49,49,9,48,6,7,8,8,9,49,48,47,31,48,31,32,30,31,47,46,30,47,29,30,46,45,28,29,45,29,46,26,27,28,45,26,28,44,26,45,10,47,48,46,47,10,10,48,9,15,44,45,14,15,45,11,45,46,11,46,10,14,45,11,12,13,14,11,12,14,3,36,37,38,39,0,1,38,0,38,1,2,37,38,2,2,3,37,50,35,36,50,34,35,36,3,50,50,3,4,49,34,50,50,4,5,49,50,5,6,49,5,49,33,34],vertices:[1,8,-77.92,.93,1,1,8,-52.07,46.05,1,1,8,-20.34,73.97,1,1,8,127.2,91.36,1,2,8,360.45,87.65,.76703,9,-120.73,18.83,.23297,2,8,386.8,85.64,.60525,9,-107.91,41.95,.39475,2,8,407.64,79.04,.46954,9,-93.22,58.13,.53046,2,8,430.87,71.68,.34801,9,-76.84,76.17,.65199,2,8,435.74,63.55,.31473,9,-67.42,77.2,.68527,2,8,441.9,53.25,.25567,9,-55.49,78.51,.74433,1,9,103.6,95.96,1,2,9,218.71,84.61,.92862,10,-81.94,83.45,.07138,2,9,252.75,90.17,.85589,10,-51.3,99.29,.14411,2,9,273.39,71.12,.81264,10,-25.77,87.59,.18736,2,9,264.74,31.24,.54997,10,-21.62,46.99,.45003,2,9,268.74,24.31,.39294,10,-15.66,41.64,.60706,2,9,280.67,17.87,.15335,10,-2.33,39.23,.84665,1,10,70.9,59.92,1,1,10,112.08,39.66,1,1,10,136.55,-24.67,1,1,10,135.89,-28.09,1,1,10,121.98,-65.05,1,2,9,265.81,-87.5,.05172,10,16.25,-65.56,.94828,2,9,259.21,-82.57,.08459,10,8.44,-62.91,.91541,2,9,246.33,-75.24,.19568,10,-6.07,-59.95,.80432,2,9,239.15,-71.16,.29833,10,-14.16,-58.29,.70167,2,9,231.45,-66.78,.45617,10,-22.85,-56.52,.54383,2,9,222.24,-81.67,.62486,10,-26.98,-73.54,.37514,2,9,160.85,-80.2,.93525,10,-85.8,-91.18,.06475,2,9,129.07,-60.97,.99316,10,-121.98,-82.77,.00684,2,9,113.38,-64.66,.99935,10,-135.75,-91.14,65e-5,2,8,366.05,-106.52,.04095,9,58.08,-57.08,.95905,2,8,342.43,-72.74,.30842,9,17.52,-64.44,.69158,2,8,336.88,-64.78,.4315,9,7.98,-66.18,.5685,2,8,330.92,-56.26,.62396,9,-2.26,-68.04,.37604,2,8,312.09,-58.71,.86621,9,-7.89,-86.17,.13379,1,8,193.22,-74.18,1,1,8,37.1,-62.36,1,1,8,-14.37,-49.71,1,1,8,-78.49,-6.6,1,1,10,102.82,-4.73,1,1,10,66.41,-6.52,1,1,10,35.88,-11.04,1,2,9,278.08,-43.25,.01605,10,14.18,-19.68,.98395,2,9,254.47,-51.75,.16687,10,-5.62,-35.09,.83313,2,9,202.9,19.13,.9751,10,-76.65,16.28,.0249,1,9,115.46,25.31,1,1,9,73.27,27.11,1,2,8,409.8,-19.92,.02101,9,-2.38,18.81,.97899,2,8,373.51,4.49,.4677,9,-39.71,-3.99,.5323,2,8,343.45,16.06,.88011,9,-62.75,-26.48,.11989],hull:40}},svet:{svet:{type:"mesh",uvs:[.98968,.72589,.19837,.81907,0,.18744,.99652,.08295],triangles:[0,2,3,1,2,0],vertices:[-329.34,-12.14,1128.94,-4.67,1269.81,-1580.91,-518.46,-1584.37],hull:4}},thumb:{thumb:{x:71.45,y:-51.97,rotation:168.14,width:97,height:40}}}}],animations:{animation:{slots:{svet:{rgba:[{color:"ffffff00"},{time:1.6,color:"ffffff52"},{time:4.1667,color:"ffffffd9"},{time:6.4333,color:"ffffff73"},{time:8.2667,color:"ffffff00"}]}},bones:{eyes:{translate:[{time:1.4333},{time:1.5,x:-68.31},{time:1.6}]},bodyleft:{rotate:[{},{time:1.1667,value:3.91},{time:2.7667,value:-1.87},{time:4},{time:5.5667,value:3.91},{time:7.1667,value:-1.87},{time:8.4}]},bodyright:{rotate:[{},{time:1.1667,value:-2.24},{time:2.7667,value:.57},{time:4},{time:5.5667,value:-2.24},{time:7.1667,value:.57},{time:8.4}]},bone_body5:{translate:[{},{time:1.1667,y:20.41},{time:2.7667,y:-41.98},{time:4},{time:5.5667,y:20.41},{time:7.1667,y:-41.98},{time:8.4}]},"left hand":{rotate:[{},{time:1.1667,value:1.79},{time:2.7667,value:-1.07},{time:4},{time:5.5667,value:1.79},{time:7.1667,value:-1.07},{time:8.4}]},bone4:{rotate:[{},{time:1.1667,value:-4.37},{time:2.7667,value:3.76},{time:4},{time:5.5667,value:-4.37},{time:7.1667,value:3.76},{time:8.4}]},head:{rotate:[{},{time:1.3333,value:4.97,curve:"stepped"},{time:2.6667,value:4.97},{time:3.9667}]},leftl:{translate:[{},{time:1.3,x:90.04,y:46.88,curve:"stepped"},{time:2.5333,x:90.04,y:46.88},{time:4}]},rightl:{translate:[{},{time:1.3,x:41.73,y:-69.56,curve:"stepped"},{time:2.4333,x:41.73,y:-69.56},{time:4}]},bone7:{rotate:[{},{time:1.1667,value:-5.92},{time:2.7,value:8.48},{time:3.9667},{time:5.5667,value:-5.92},{time:7.1,value:8.48},{time:8.3667}]},coat:{rotate:[{},{time:1.1667,value:-1.35},{time:2.7667,value:1.69},{time:4},{time:5.5667,value:-1.35},{time:7.1667,value:1.69},{time:8.4}]},coat2:{rotate:[{time:.9},{time:1.6667,value:-3.67},{time:2.9667,value:3.76},{time:4,curve:"stepped"},{time:5.3},{time:6.0667,value:-3.67},{time:7.3667,value:3.76},{time:8.4}]},coat3:{rotate:[{time:1.1},{time:1.8667,value:-3.13},{time:3.0667,value:2.67},{time:4,curve:"stepped"},{time:5.5},{time:6.2667,value:-3.13},{time:7.4667,value:2.67},{time:8.4}]},bone_body2:{rotate:[{time:.6},{time:1.3333,value:6.89},{time:2.8667,value:-2.08},{time:4,curve:"stepped"},{time:5},{time:5.7333,value:6.89},{time:7.2667,value:-2.08},{time:8.4}],translate:[{time:.6},{time:1.3333,y:7.27},{time:2.8667,x:4.75,y:-20.96},{time:4,curve:"stepped"},{time:5},{time:5.7333,y:7.27},{time:7.2667,x:4.75,y:-20.96},{time:8.4}]},bone_body3:{rotate:[{time:.9},{time:1.5667,value:3.27},{time:3.1,value:-4.05},{time:4,curve:"stepped"},{time:5.3},{time:5.9667,value:3.27},{time:7.5,value:-4.05},{time:8.4}]},bone_body4:{rotate:[{time:1.0333},{time:1.7,value:9.37},{time:3.2333,value:-2.07},{time:4,curve:"stepped"},{time:5.4333},{time:6.1,value:9.37},{time:7.6333,value:-2.07},{time:8.4}]},head2:{translate:[{},{time:.9667,y:22.33,curve:"stepped"},{time:3.1667,y:22.33},{time:3.9667},{time:5.1,x:-12,y:9.89},{time:6.5,x:-8.12,y:39.31},{time:8.1}]},head3zr:{translate:[{time:5.6667},{time:6.5667,y:8.44},{time:7.7}]},bone8:{rotate:[{},{time:1.7333,value:-8.96},{time:2.9667,value:21.75},{time:3.9667},{time:6.1,value:-8.96},{time:7.3333,value:21.75},{time:8.3333}]},bone9:{scale:[{},{time:1.1667,x:.935},{time:2.2,x:1.042,y:1.073},{time:3.3667},{time:4.7333,x:.935},{time:5.7667,x:1.042,y:1.073},{time:6.9333}]},bone10:{rotate:[{},{time:1.1667,value:5.6},{time:2.2,value:-3.19},{time:3.3667},{time:4.7333,value:5.6},{time:5.7667,value:-3.19},{time:6.9333}],scale:[{},{time:1.1667,x:.935},{time:2.2,x:1.042,y:1.073},{time:3.3667},{time:4.7333,x:.935},{time:5.7667,x:1.042,y:1.073},{time:6.9333}]},bone11:{rotate:[{},{time:1.1667,value:3.29},{time:2.2,value:-10.88},{time:3.3667},{time:4.7333,value:3.29},{time:5.7667,value:-10.88},{time:6.9333}],scale:[{},{time:1.1667,x:.935},{time:2.2,x:1.042,y:1.073},{time:3.3667},{time:4.7333,x:.935},{time:5.7667,x:1.042,y:1.073},{time:6.9333}]}},attachments:{default:{svet:{svet:{deform:[{vertices:[-6,41.99976,0,0,0,0,24,-12]}]}}}}}}},atlas:"character.png\nsize:514,1693\nfilter:Linear,Linear\npma:true\nscale:0.7\nbody\nbounds:2,2,318,867\noffsets:1,0,477,1107\nrotate:180\ncoat\nbounds:2,841,333,850\nhead\nbounds:263,170,246,266\nrotate:180\nleft eye\nbounds:2,497,30,15\nleft hand\nbounds:325,1294,113,349\npaper\nbounds:340,4,106,190\nright eye\nbounds:2,513,37,16\noffsets:0,1,37,18\nright hand\nbounds:154,438,347,470\nsvet\nbounds:258,1051,254,258\noffsets:0,63,255,350\nthumb\nbounds:2,531,68,27\noffsets:0,1,68,28\n"},SMOKE:{name:"smoke",json:{skeleton:{hash:"lNgxVuPHNBs",spine:"4.1.24",x:-.04,y:-1080.55,width:2560.28,height:1080.68},bones:[{name:"root"},{name:"backgrounds",parent:"root"},{name:"smoke",parent:"root",scaleY:1.0347},{name:"bone",parent:"smoke"},{name:"bone2",parent:"smoke"},{name:"bone3",parent:"smoke"},{name:"bone4",parent:"smoke"},{name:"bone5",parent:"smoke"},{name:"bone6",parent:"smoke"},{name:"bone7",parent:"smoke"}],slots:[{name:"background_lv0",bone:"backgrounds"},{name:"smoke",bone:"smoke",attachment:"smoke"},{name:"images/smoke3",bone:"bone",attachment:"images/smoke1"},{name:"images/smoke4",bone:"bone2",attachment:"images/smoke1"},{name:"images/smoke5",bone:"bone3",attachment:"images/smoke1"},{name:"images/smoke6",bone:"bone4",attachment:"images/smoke1"},{name:"images/smoke2",bone:"bone5",color:"ffffff5b",attachment:"images/smoke2"},{name:"images/smoke7",bone:"bone6",color:"ffffff5d",attachment:"images/smoke2"},{name:"images/smoke8",bone:"bone7",color:"ffffff53",attachment:"images/smoke2"},{name:"images/bc",bone:"root",color:"ffffff00"},{name:"images/_Тут так спокойно, что кажется, ничего не могло случиться. Но детали могут рассказать иное._",bone:"root",color:"ffffff00"}],skins:[{name:"default",attachments:{"images/smoke2":{"images/smoke2":{x:781.64,y:-547.25,scaleX:-5.2517,scaleY:4.6937,width:200,height:139}},"images/smoke3":{"images/smoke1":{x:1281.13,y:-536.44,scaleX:-10.6205,scaleY:-7.6947,width:260,height:150}},"images/smoke4":{"images/smoke1":{x:1281.13,y:-536.44,scaleX:-10.0593,scaleY:7.2881,width:260,height:150}},"images/smoke5":{"images/smoke1":{x:1281.13,y:-536.44,scaleX:10.0696,scaleY:7.2956,width:260,height:150}},"images/smoke6":{"images/smoke1":{x:1281.13,y:-536.44,scaleX:10.6584,scaleY:-7.7222,width:260,height:150}},"images/smoke7":{"images/smoke2":{x:1629.18,y:-553.86,scaleX:8.1333,scaleY:8.1333,width:200,height:139}},"images/smoke8":{"images/smoke2":{x:1225.91,y:-818.09,scaleX:4.0027,scaleY:4.0027,rotation:30.67,width:200,height:139}},smoke:{smoke:{type:"clipping",end:"smoke",vertexCount:4,vertices:[-.04,.12,2560.01,.02,2560.24,-1044.31,-.02,-1043.7]}}}}],animations:{idle:{slots:{"images/bc":{rgba:[{color:"ffffff00"},{time:1.4333,color:"ffffffff",curve:"stepped"},{time:6.1,color:"ffffffff",curve:[10.028,1,3.339,1,10.028,1,3.339,1,10.028,1,3.339,1,10.028,1,3.339,0]},{time:7.2667,color:"ffffff00"}]},"images/smoke2":{rgba:[{time:2.6333,color:"ffffff5b"},{time:3.2667,color:"ffffff00"}]},"images/smoke3":{rgba:[{color:"ffffffff"},{time:6.4,color:"ffffff00"}]},"images/smoke4":{rgba:[{color:"ffffffff"},{time:3.9333,color:"ffffff00"}]},"images/smoke5":{rgba:[{color:"ffffffff"},{time:5.2,color:"ffffff00"}]},"images/smoke6":{rgba:[{color:"ffffffff"},{time:7.3,color:"ffffff00"}]},"images/smoke7":{rgba:[{time:2.6333,color:"ffffff5d"},{time:3.4,color:"ffffff00"}]},"images/smoke8":{rgba:[{time:2.4,color:"ffffff53"},{time:3.1667,color:"ffffff00"}]},"images/_Тут так спокойно, что кажется, ничего не могло случиться. Но детали могут рассказать иное._":{rgba:[{time:.5,color:"ffffff00"},{time:2.8333,color:"ffffffff",curve:"stepped"},{time:6.1,color:"ffffffff"},{time:7.2667,color:"ffffff00"}]}},bones:{bone:{translate:[{},{time:6,x:461.6,y:134.17}]},bone2:{translate:[{},{time:3.5333,x:273.4,y:-251.02}]},bone3:{translate:[{},{time:5.4,x:-235.81,y:-290.66}]},bone4:{translate:[{},{time:7.1667,x:-181.13,y:128.81}]},bone5:{translate:[{},{time:3.2667,x:-304.16,y:99.09}]},bone6:{translate:[{},{time:3.2667,x:324.67,y:56.15}]},bone7:{translate:[{},{time:3.2667,y:-214.69}]}}}}},atlas:"smoke.png\nsize:316,109\nfilter:Linear,Linear\npma:true\nscale:0.7\nimages/smoke1\nbounds:2,2,182,105\nimages/smoke2\nbounds:186,13,128,94\noffsets:0,0,140,97\n"},PINCH:{name:"pinch",json:{skeleton:{hash:"getADWlxF7s",spine:"4.1.24",x:38.75,y:-274.07,width:210.02,height:243.52},bones:[{name:"root",x:-373.04,y:58.04,scaleX:.4564,scaleY:.4564},{name:"bone",parent:"root",length:255.79,rotation:152.31,x:1349.92,y:-617.27,scaleX:.9048,scaleY:.9048},{name:"bone2",parent:"bone",length:76.83,rotation:-1.57,x:327.68,y:73.06,scaleX:.9048,scaleY:.9048},{name:"bone3",parent:"bone2",length:73.92,rotation:-25.72,x:144.41,y:-21.36,scaleX:.9048,scaleY:.9048},{name:"bone4",parent:"bone3",length:62.77,rotation:-14.76,x:91.25,y:-5.63,scaleX:.9048,scaleY:.9048},{name:"bone5",parent:"bone",length:155.96,rotation:-28.45,x:287.78,y:-36.93,scaleX:.9048,scaleY:.9048},{name:"bone6",parent:"bone5",length:59.97,rotation:-10.67,x:225.47,y:29.73,scaleX:1.0015,scaleY:1.0015},{name:"bone7",parent:"bone6",length:37.33,rotation:21.77,x:88.22,y:-4.02,scaleX:.9269,scaleY:.9269},{name:"bone8",parent:"bone7",length:35.06,rotation:2.09,x:65.39,y:-5.33,scaleX:.8925,scaleY:.8925}],slots:[{name:"images/hand",bone:"root",attachment:"images/hand"}],skins:[{name:"default",attachments:{"images/hand":{"images/hand":{type:"mesh",uvs:[.28529,.10155,.29588,.10158,.31899,.12523,.34135,.15957,.34606,.17459,.35259,.18266,.353,.18545,.37124,.2059,.37764,.21593,.38189,.22699,.38934,.24407,.40534,.23711,.41967,.23562,.42686,.23797,.43698,.24389,.46369,.27382,.46667,.2707,.49828,.27051,.50959,.27892,.52242,.28991,.53685,.30605,.55659,.31778,.5776,.32653,.58068,.32524,.60613,.32519,.62026,.33321,.62704,.33938,.6418,.36199,.65288,.39591,.65507,.40596,.66267,.4378,.66498,.4424,.67666,.47952,.67885,.49793,.68343,.50932,.6966,.53193,.71448,.55058,.75332,.58193,.76709,.59024,.83641,.63902,.84417,.64416,.84225,.65573,.84233,.92072,.82136,.9006,.78458,.87294,.75158,.84941,.73762,.84007,.6788,.8032,.61211,.7653,.58452,.75146,.54373,.72349,.51546,.70712,.48844,.69784,.47673,.69792,.46074,.6925,.44371,.68293,.41902,.65878,.37561,.62327,.33534,.58789,.32823,.57742,.32182,.56196,.30831,.53603,.29095,.50708,.26921,.47878,.26707,.47384,.26317,.44892,.26066,.44008,.25315,.42323,.25227,.42115,.23803,.39724,.23492,.39158,.23493,.37342,.23834,.3679,.25004,.36109,.25456,.35945,.2675,.35928,.27735,.36242,.28715,.36962,.31925,.39754,.34122,.4373,.35541,.4635,.36888,.48837,.34616,.36176,.33497,.32722,.32833,.31177,.31746,.2658,.31736,.26222,.29806,.21499,.29305,.20092,.28035,.18001,.27039,.1497,.26873,.13942,.26896,.12062,.27217,.11309,.40487,.27459,.41367,.29877,.37487,.5035,.38562,.53238,.40231,.54751,.425,.56871,.32484,.49174,.34779,.53269,.35579,.54277,.38644,.56856,.41479,.59281],triangles:[3,89,2,2,90,1,1,90,0,90,2,89,92,93,0,0,90,91,92,0,91,86,8,9,86,7,8,86,6,7,5,6,4,4,6,87,87,6,86,87,88,4,88,3,4,3,88,89,95,81,82,82,83,95,95,83,94,83,84,94,84,10,94,84,85,10,94,14,95,95,14,15,14,94,13,13,94,12,12,94,11,94,10,11,10,86,9,10,85,86,34,51,33,33,51,32,31,32,30,30,32,51,30,51,29,29,51,28,26,27,28,26,28,99,25,26,22,22,26,99,25,22,24,22,23,24,99,28,51,22,99,21,21,96,20,95,20,81,20,15,19,19,15,18,15,20,95,18,15,17,15,16,17,79,65,78,66,67,78,65,66,78,78,67,77,77,67,76,76,67,75,69,74,75,75,67,68,69,75,68,73,70,72,74,69,73,73,69,70,72,70,71,99,103,98,58,102,103,58,59,102,59,60,102,102,97,103,103,97,98,60,101,102,60,61,101,99,98,21,21,98,96,97,102,96,61,100,101,61,62,100,102,101,96,101,81,96,101,100,81,97,96,98,62,63,100,20,96,81,100,80,81,100,79,80,65,79,100,100,63,64,100,64,65,53,54,52,99,51,52,99,52,54,54,55,104,99,54,104,57,104,56,55,56,104,57,103,104,57,58,103,104,103,99,43,41,42,43,44,41,44,45,41,45,46,41,46,47,41,41,38,39,41,47,38,47,37,38,47,48,37,48,36,37,48,49,36,36,49,35,49,50,35,50,34,35,34,50,51,41,39,40],vertices:[2,7,107.78,-20.19,2e-5,8,43.47,-11.32,.99998,2,7,101.82,-27.37,4e-5,8,38.12,-18.96,.99996,2,7,74.5,-31.21,.0179,8,11.22,-25.05,.9821,2,7,41.12,-29.19,.624,8,-22.22,-25.78,.376,2,7,29.36,-24.86,.8798,8,-34.29,-22.44,.1202,2,7,20.8,-25.25,.9605,8,-42.79,-23.53,.0395,2,7,18.88,-24.13,.97392,8,-44.8,-22.58,.02608,3,5,306.62,-23.05,.00102,6,91.94,-30.29,.08353,7,-3.76,-26.27,.91545,3,5,296.93,-22.6,.00435,6,82.46,-32.34,.22508,7,-13.44,-25.59,.77056,3,5,287.77,-20.17,.01353,6,72.98,-32.33,.42769,7,-22.53,-22.93,.55877,3,5,273.14,-17.03,.05307,6,58.04,-33.03,.76812,7,-37.08,-19.43,.17881,3,5,268.74,-31.5,.12922,6,57.48,-48.14,.8268,7,-41.83,-33.79,.04398,3,5,261.87,-42.15,.17821,6,53.56,-60.19,.8063,7,-48.97,-44.27,.01549,3,5,256.5,-45.98,.20434,6,49.34,-65.27,.78731,7,-54.43,-47.97,.00835,3,5,247.33,-50.12,.24935,6,41.53,-71.61,.74825,7,-63.7,-51.88,.00239,2,5,214.27,-54.07,.56791,6,10.58,-83.88,.43209,2,5,214.58,-57.65,.59882,6,11.79,-87.26,.40118,2,5,197.48,-79.64,.79578,6,.89,-112.89,.20422,2,5,186.13,-83.38,.84039,6,-9.14,-119.41,.15961,2,5,172.34,-86.92,.89522,6,-21.56,-126.35,.10478,2,5,154.5,-89.08,.9527,6,-38.26,-133,.0473,2,5,136.5,-97.05,.98726,6,-53.63,-145.3,.01274,2,5,119.65,-107.35,.99867,6,-67.29,-159.57,.00133,2,5,118.77,-110.11,.99922,6,-67.43,-162.46,78e-5,1,5,104.95,-127.76,1,1,5,92.29,-133.65,1,1,5,84.78,-135.35,1,2,1,293.26,-204.87,3e-5,5,62.76,-134.58,.99997,2,1,272.21,-185.77,.00541,5,35.74,-125.76,.99459,2,1,266.82,-179.67,.0104,5,28.33,-122.39,.9896,2,1,249.25,-160.59,.04987,5,4.49,-112.17,.95013,2,1,245.77,-158.34,.06093,5,.39,-111.54,.93907,2,1,223.07,-137.25,.18452,5,-28.95,-101.58,.81548,2,1,214.64,-125.32,.28219,5,-41.53,-94.15,.71781,2,1,206.89,-119.26,.3721,5,-51.07,-91.79,.6279,2,1,188.35,-108.89,.5674,5,-72.23,-89.91,.4326,2,1,167.58,-103.22,.73658,5,-93.51,-93.23,.26342,2,1,125.82,-97.27,.91897,5,-134.05,-104.89,.08103,2,1,112.04,-97.12,.94861,5,-146.69,-110.39,.05139,2,1,40.12,-91.51,.99915,5,-214.6,-134.7,85e-5,2,1,32.18,-91.1,.99956,5,-222.01,-137.58,44e-5,2,1,29.46,-82.26,.99976,5,-228.12,-130.62,24e-5,1,1,-67.53,102.37,1,1,1,-43.81,96.94,1,1,1,-5.01,92.72,1,1,1,29.34,89.84,1,1,1,43.65,89.04,1,2,1,103.02,87.43,.99992,2,-225.08,4.04,8e-5,2,1,168.9,88.33,.97434,2,-159.31,7.96,.02566,2,1,195.49,89.98,.93248,2,-132.83,10.83,.06752,2,1,237.54,87.19,.76993,2,-90.69,9.98,.23007,2,1,265.58,87.35,.53924,2,-62.69,11.42,.46076,2,1,290.05,91.95,.25547,2,-38.46,17.14,.74453,2,1,299.16,96.8,.15366,2,-29.58,22.41,.84634,2,1,313.61,99.57,.05863,2,-15.27,25.84,.94137,2,1,330.39,99.87,.00601,2,1.48,26.91,.99399,1,2,29.85,21.48,1,2,2,76.98,16.67,.99153,3,-77.26,5,.00847,2,2,121.65,10.55,.41426,3,-34.35,18.87,.58574,2,2,131.22,6.6,.27826,3,-24.01,19.47,.72174,2,2,142.25,-1.05,.10936,3,-10.76,17.36,.89064,1,3,12.81,15.83,1,1,3,40.25,15.78,1,2,3,69.42,19.23,.98457,4,-25.98,20.49,.01543,2,3,73.7,18.62,.94327,4,-21.66,20.67,.05673,2,3,91.89,10.52,.36528,4,-2.31,16,.63472,2,3,98.89,8.46,.13371,4,4.95,15.25,.86629,2,3,113.58,6.54,.0081,4,19.75,16.03,.9919,2,3,115.38,6.27,.00373,4,21.57,16.09,.99627,1,4,43.82,20.1,1,1,4,49,20.83,1,1,4,62.1,15.12,1,1,4,64.88,10.64,1,1,4,65.69,-.96,1,1,4,65.29,-5.12,1,1,4,60.87,-15.63,1,1,4,55.14,-22.6,1,1,4,46.5,-28.26,1,1,4,15.07,-45.43,1,1,3,61.06,-51.63,1,3,3,36.5,-50.45,.94063,4,-41.52,-57.29,.01165,6,-80.41,65.52,.04772,3,3,14.12,-49.38,.88431,4,-67.91,-57.03,.0227,6,-111.32,59.75,.093,4,2,203.28,-147.88,.00127,3,107.94,-88.45,.02548,5,223.82,70.1,.07133,6,-11.91,38.61,.90193,2,3,135.99,-95.46,.00255,6,16.95,36.89,.99745,3,3,149.35,-97.39,37e-5,6,30.44,37.44,.99748,7,-43.92,55.94,.00215,2,6,67.44,31.89,.69592,7,-9.93,40.29,.30408,2,6,70.07,30.86,.63757,7,-7.7,38.56,.36243,3,6,110.94,31.73,.03297,7,31.79,27.99,.94188,8,-36.24,30.43,.02515,3,6,122.85,31.39,.00478,7,43.13,24.34,.83204,8,-24.64,27.73,.16318,2,7,62.95,22.49,.34636,8,-4.74,27.52,.65364,2,7,86.93,14.06,.01459,8,19.86,21.1,.98541,2,7,94.09,10.04,69e-5,8,27.34,17.68,.99931,1,8,39.36,9.06,1,2,7,108.14,-5.5,0,8,42.61,3.36,1,3,5,245.81,-12.94,.13561,6,30.57,-36.06,.85308,7,-64.3,-14.68,.01131,2,5,226.05,-7.28,.22879,6,10.02,-35.63,.77121,5,1,449.01,3.45,.00681,2,124.39,-63.97,.07587,3,.45,-47.07,.8112,4,-77.24,-63.21,.02082,6,-116.46,62.1,.08531,5,1,430.18,19.11,.01029,2,104.86,-49.19,.22731,3,-23.55,-42.24,.6742,4,-101.69,-64.65,.0173,6,-140.95,62.36,.0709,6,1,411.44,23.21,.03678,2,85.96,-45.96,.27871,3,-41.99,-47.53,.58712,4,-118.17,-74.46,.01507,5,80.07,111.79,.02058,6,-158.07,53.72,.06174,6,1,385.84,29.01,.11307,2,60.12,-41.34,.30062,3,-67.27,-54.58,.48461,4,-140.82,-87.72,.01244,5,54.8,104.69,.03829,6,-181.59,42.07,.05096,3,3,33.26,-15.7,.959,4,-53.51,-24.51,.00804,6,-90.09,99.05,.03296,5,1,459.82,34.67,.00336,2,133.76,-32.29,.09108,3,-4.85,-14.47,.85318,4,-90.68,-33.03,.01028,6,-127.77,93.14,.0421,5,1,449.9,38.41,.00463,2,123.68,-29,.1876,3,-15.37,-15.88,.75529,4,-100.49,-37.08,.0103,6,-137.83,89.78,.04219,6,1,416.42,44.06,.02052,2,89.97,-24.9,.46863,3,-47.51,-26.81,.44945,4,-128.79,-55.84,.00988,5,74.51,132.49,.01103,6,-167.37,73.04,.04048,6,1,385.31,49.62,.07442,2,58.64,-20.77,.53808,3,-77.53,-36.69,.32057,4,-155.3,-73.04,.00819,5,44.51,122.56,.0252,6,-195.01,57.72,.03354],hull:94}}}}],animations:{idle:{bones:{bone:{rotate:[{},{time:.1,value:1.32,curve:"stepped"},{time:.8333,value:1.32},{time:.9667}]},bone5:{rotate:[{},{time:.5333,value:3.94,curve:"stepped"},{time:.8667,value:3.94},{time:1.3667}]},bone6:{rotate:[{},{time:.6333,value:23.82},{time:1.5}],translate:[{},{time:.6333,x:5.9,y:17.02},{time:1.5}]},bone7:{rotate:[{},{time:.3333,value:10.32},{time:.5333,value:15.6},{time:.9333}]},bone8:{rotate:[{},{time:.4,value:11.87},{time:1.0333}]},root:{translate:[{x:-96.11,y:36.82}],scale:[{x:1.317,y:1.317}]},bone3:{rotate:[{value:31.35},{time:.5,value:1.74},{time:1.3,value:18.84}],scale:[{time:1.5667}]},bone4:{rotate:[{value:23.99},{time:.6667,value:-15.57},{time:1.4667,value:15.92}]}}}}},atlas:"pinch.png\nsize:555,660\nfilter:Linear,Linear\npma:true\nimages/hand\nbounds:2,2,551,656\noffsets:199,57,881,787"}};function bP(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(bP=function(){return!!t})()}function TP(t,e,n,r){var i=tc(T(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function SP(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function AP(t,e,n){return t.set(CP(t,e),n),n}function EP(t,e){return t.get(CP(t,e))}function CP(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}E(_((function t(){v(this,t)})),"loading",function(){var t=Jh(nc().mark((function t(e,n){var r,i,s,o,a,l,h,c,u,d,f,p,m,g,v;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=performance.now(),t.prev=1,i=0;case 3:if(!(i<Object.keys(n).length)){t.next=20;break}return s=performance.now(),o=Object.keys(n)[i],a=Object.values(n)[i],l=a.spineName,h=a.isRemote,console.log(i),c=h?"gold":"blue",console.log("level: ".concat(o," | spineName ").concat(l," | isRemote %c").concat(h),"color: ".concat(c,"; font-weight: bold")),t.next=12,e(i);case 12:u=performance.now(),d=Math.trunc(u-s),console.log("Loading time:",d),console.log(""),i===Object.keys(n).length-1&&console.warn("все уровни загружены");case 17:i++,t.next=3;break;case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(1),console.log("[LazyLoading]",t.t0);case 25:f=performance.now(),p=Math.trunc(f-r),m=zu(p),g=m.minutes,v=m.seconds,console.log("Все уровни загружены за ".concat(g," : ").concat(v));case 29:case"end":return t.stop()}}),t,null,[[1,22]])})));return function(e,n){return t.apply(this,arguments)}}());var kP=new WeakMap,MP=new WeakMap,PP=new WeakMap,IP=new WeakMap,RP=new WeakMap,OP=new WeakMap,LP=new WeakMap,DP=new WeakMap,FP=new WeakMap,NP=new WeakMap,BP=new WeakMap,WP=new WeakMap,UP=new WeakMap,jP=new WeakMap,HP=new WeakMap,zP=new WeakMap,GP=new WeakMap,VP=new WeakMap,XP=new WeakMap,YP=new WeakMap,$P=new WeakMap,qP=new WeakMap,KP=new WeakMap,ZP=new WeakMap,QP=new WeakMap,JP=new WeakMap,tI=new WeakMap,eI=new WeakMap,nI=new WeakMap,rI=new WeakMap,iI=new WeakMap,sI=function(t){function e(){var t;v(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=function(t,e,n){return e=T(e),b(t,bP()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[].concat(r)),SP(t,kP,void 0),SP(t,MP,!1),SP(t,PP,!1),SP(t,IP,void 0),SP(t,RP,void 0),SP(t,OP,void 0),SP(t,LP,void 0),SP(t,DP,void 0),SP(t,FP,{}),SP(t,NP,(function(){AP(kP,t,new Kd(t.game)),t.game.viewport.addChild(EP(kP,t)),AP(OP,t,EP(kP,t).refs.textPreload),t.isInitialized=!0,new aP(t.game,EP(kP,t)).init()})),SP(t,BP,Jh(nc().mark((function e(){var n;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return AP(IP,t,tf.get(Zd)),n=EP(IP,t).savedLevel.levelIndex,e.next=4,EP(UP,t).call(t);case 4:return AP(RP,t,EP(zP,t).call(t,n)),EP(JP,t).call(t),EP(HP,t).call(t),e.next=9,EP(jP,t).call(t,n);case 9:case"end":return e.stop()}}),e)})))),SP(t,WP,(function(){var t=wp.getFilteredLevels();console.log("levels:",t)})),SP(t,UP,Jh(nc().mark((function e(){var n;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!EP(MP,t)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Uu(EP(OP,t));case 4:return n=tf.get(Jd),e.next=7,n.loadLocalesHud();case 7:return EP(OP,t).text=zc.t("textLoading")+" 50%",qc.log(Vc.LevelPreload,"loadLocalesHud is loaded"),e.next=11,n.loadStoryTexts();case 11:EP(OP,t).text=zc.t("textLoading")+" 100%",qc.log(Vc.LevelPreload,"loadStoryTexts is loaded"),AP(MP,t,!0);case 14:case"end":return e.stop()}}),e)})))),SP(t,jP,function(){var e=Jh(nc().mark((function e(n){var r;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,EP(GP,t).call(t);case 3:return e.next=5,EP(qP,t).call(t);case 5:return e.next=7,EP(KP,t).call(t);case 7:return e.next=9,EP(ZP,t).call(t);case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(Vc.LevelPreload,"LevelPreload loading error / reload #loading: ",e.t0),of.preloadError(null==sf||null===(r=sf.LEVEL_PRELOAD)||void 0===r?void 0:r.loading,e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()),SP(t,HP,(function(){var e=EP(RP,t),n=e.levelList,r=e.onceLoadList,i=e.speechList,s=3+e.learningList.length+n.length+r.length+i.length;AP(LP,t,s),AP(DP,t,1)})),SP(t,zP,(function(e){return function(t,e,n){var r=mp.getGameLevelData(n),i=mp.getSpeechAndTextData(t,e),s=i.introSpeech,o=i.outroSpeech,a=r.levelSpriteSheet,l=r.hudSpriteSheet,h=r.background,c=window.game.locale,u=qf.LEVEL_UI.pngName;return{spineLevelData:r,levelList:[l,a,h],onceLoadList:[{alias:u,src:"".concat(wP,"assets/images/game/").concat(u,".png")},{alias:"character",src:"".concat(wP,"assets/images/spines/character.png")},{alias:"smoke",src:"".concat(wP,"assets/images/spines/smoke.png")}],speechList:[{alias:s,src:"".concat(wP,"assets/audio/speech/intro/").concat(c,"/").concat(s,".mp3")},{alias:o,src:"".concat(wP,"assets/audio/speech/outro/").concat(c,"/").concat(o,".mp3")}],learningList:[{alias:"pinch",src:"".concat(wP,"assets/images/spines/pinch.png")}]}}(t.game,EP(IP,t),e)})),SP(t,GP,Jh(nc().mark((function e(){var n;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Uu(EP(OP,t));case 2:return e.prev=2,e.next=5,EP(VP,t).call(t);case 5:return e.next=7,EP(YP,t).call(t);case 7:return e.next=9,EP($P,t).call(t);case 9:qc.log(Vc.LevelPreload,"images loadBundle is loaded"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),console.error("[LevelPreload] loadBundle err:",e.t0),of.preloadError(null==sf||null===(n=sf.LEVEL_PRELOAD)||void 0===n?void 0:n.loadBundle,e.t0);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))),SP(t,VP,Jh(nc().mark((function e(){var n,r;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=EP(RP,t),r=n.onceLoadList,!EP(PP,t)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Fo.load(r);case 5:return EP(QP,t).call(t),e.next=8,EP(XP,t).call(t);case 8:AP(PP,t,!0);case 9:case"end":return e.stop()}}),e)})))),SP(t,XP,Jh(nc().mark((function e(){var n,r;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=qf.LEVEL_UI.json,e.next=4,Fo.get(qf.LEVEL_UI.pngName);case 4:return r=e.sent,e.next=7,Bu.createSpriteSheet(r,n);case 7:EP(QP,t).call(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),qc.warn(Vc.GamePreload,e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))),SP(t,YP,Jh(nc().mark((function e(){var n,r;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=EP(RP,t),r=n.learningList,0!==EP(IP,t).savedLevel.levelIndex){e.next=6;break}return e.next=4,Fo.load(r);case 4:EP(QP,t).call(t),qc.log(Vc.LevelPreload,"----- learningList is loaded");case 6:case"end":return e.stop()}}),e)})))),SP(t,$P,Jh(nc().mark((function e(){var n,r,i;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=EP(RP,t),r=n.levelList,i="levelBundle",e.next=4,Fo.addBundle(i,r);case 4:return e.next=6,Fo.loadBundle(i,(function(){return EP(QP,t).call(t)}));case 6:case"end":return e.stop()}}),e)})))),SP(t,qP,Jh(nc().mark((function e(){var n,r,i,s,o,a,l,h;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Uu(EP(OP,t));case 2:return n=EP(RP,t),r=n.spineLevelData,i=r.spineName,s=r.levelAtlas,o=r.levelJson,e.next=6,Hu(s);case 6:return a=e.sent,EP(QP,t).call(t),e.next=10,ju(o);case 10:l=e.sent,EP(QP,t).call(t),h={name:i,json:l,atlas:a},ZT.spineParser([h,_P.CHARACTER,_P.SMOKE]),0===EP(IP,t).savedLevel.levelIndex&&ZT.spineParser([_P.PINCH]),qc.log(Vc.LevelPreload,"spineParse is loaded");case 16:case"end":return e.stop()}}),e)})))),SP(t,KP,Jh(nc().mark((function e(){var n,r,i,s,o,a;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Uu(EP(OP,t));case 2:return e.prev=2,n=EP(RP,t),r=n.spineLevelData,i=r.hudJson,s=r.hudDataName,o=Fo.get(s),e.next=8,ju(i);case 8:return a=e.sent,EP(QP,t).call(t),e.next=12,Bu.createSpriteSheet(o,a);case 12:qc.log(Vc.LevelPreload,"createHudSpriteSheet is loaded"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,15]])})))),SP(t,ZP,Jh(nc().mark((function e(){var n,r,i;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Uu(EP(OP,t));case 2:return qc.log(Vc.LevelPreload,"loadSpeech start"),(n=tf.get(Qd)).clearSoundList(n.speechList),r=EP(RP,t),i=r.speechList,e.next=8,n.preload(n.speechList,i,!0,(function(){return EP(QP,t).call(t)}));case 8:EP(QP,t).call(t),qc.log(Vc.LevelPreload,"speech is loaded");case 10:case"end":return e.stop()}}),e)})))),SP(t,QP,(function(e){try{var n,r,i=EP(FP,t),s=i.textLevel,o=i.userLevel,a=i.textPart,l=i.partIndex,h=i.textLoading;AP(DP,t,(n=EP(DP,t),++n)),r=e||(EP(DP,t)/EP(LP,t)*100).toFixed(0),EP(kP,t).refs.textPreload.text="".concat(s," ").concat(o,"\n").concat(a," ").concat(l,"\n").concat(h," ").concat(r,"%")}catch(t){console.error("[updateProgress]:",t)}})),SP(t,JP,(function(){var e=zc.t("level"),n=EP(IP,t).userLevel,r=zc.t("textLoadingSkinPart"),i=EP(tI,t).call(t),s=zc.t("textLoading");AP(FP,t,{textLevel:e,userLevel:n,textPart:r,partIndex:i,textLoading:s})})),SP(t,tI,(function(){var e=EP(IP,t).savedLevel.skinIndex;return EP(IP,t).config.partIndex<5&&(EP(IP,t).config.partIndex=e),EP(IP,t).config.partIndex})),SP(t,eI,Jh(nc().mark((function e(){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return EP(QP,t).call(t,100),e.next=3,EP(nI,t).call(t);case 3:return e.next=5,t.terminate();case 5:t.game.emit(oh);case 6:case"end":return e.stop()}}),e)})))),SP(t,nI,Jh(nc().mark((function e(){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,ww.timeline().to(EP(kP,t),{alpha:0,duration:.3,delay:0});case 3:case"end":return e.stop()}}),e)})))),SP(t,rI,(function(){var e=EP(RP,t).spineLevelData,n=e.spineName,r=e.backgroundName,i=new os(Fo.get(r));EP(kP,t).addChild(i);var s=ZT.createSpine({spineName:n,animationName:"idle",skinName:"mode1/skin_mode1_v1"}),o=Fo.get("".concat(n,".spineData"));qc.log(Vc.LevelPreload,o),EP(kP,t).addChild(s)})),SP(t,iI,function(){var t=Jh(nc().mark((function t(e,n){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Fo.unloadBundle(n);case 4:qc.log(Vc.LevelPreload,"clear cash");case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),t}return A(e,t),_(e,[{key:"initEventName",get:function(){return ah}},{key:"initialize",value:(n=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return TP(e,"initialize",this,3)([]),EP(NP,this).call(this),t.next=4,EP(BP,this).call(this);case 4:return t.next=6,EP(eI,this).call(this);case 6:_SERVICE.preloadRewardedAd();case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"resize",value:function(){EP(kP,this).resize()}},{key:"terminate",value:function(){this.game.emit(yh),this.isInitialized=!1,EP(kP,this).destroy({children:!0}),this.game.uiInner.removeChildren(),AP(kP,this,null)}}]);var n}(Kc);function oI(){return oI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oI.apply(null,arguments)}function aI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lI(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?aI(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aI(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function hI(){var t={},e=(Em(),{cursor:"pointer",eventMode:"static"}),n=function(){return tu(rs,oI({name:"btnPlayReward",x:104,y:80,texture:"btn-bronze",anchor:{x:.5,y:.5}},e),tu(os,{texture:"btn-gold",anchor:{x:.5,y:.5},scale:{x:.66,y:.66}}),tu(rs,{name:"btnTopContainer"},tu(os,{texture:"icon-play",x:-54,anchor:{x:.5,y:.5}}),tu(Ms,{text:"+".concat(3),name:"textPlay1",x:-6,style:lI(lI({},Gd),{},{fontSize:32}),anchor:{x:.5,y:.5}}),tu(os,{texture:"icon-loupe",x:45,anchor:{x:.5,y:.5},scale:{x:.4,y:.4}})),tu(rs,{name:"btnTimerContainer",visible:!1},tu(Ms,{text:"00:60",name:"timerText",y:-2,style:lI(lI({},Gd),{},{fontSize:32}),anchor:{x:.5,y:.5}})))};return tu(Cm,{ref:function(e){return t.root=e},eventMode:"static",visible:!1,zIndex:9,size:{w:430,h:260}},tu((function(){return tu(rs,{name:"innerContainer"},tu(Ms,{text:"".concat(zc.t("notEnoughHints")),y:-88,anchor:{x:.5,y:.5},style:lI(lI({},Gd),{},{fontSize:30})}),tu(os,{texture:"icon-loupe-plus",y:-20,anchor:{x:.5,y:.5}}),tu(em,{name:"btnStore",x:-104,y:80,texture:"btn-bronze",text:"".concat(zc.t("store")),scaleValue:.66,style:lI(lI({},Gd),{},{fontSize:28})}),tu(n,null))}),null))}function cI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function uI(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cI(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cI(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function dI(){var t={},e={fade:{texture:vr.WHITE,width:Dh.WIDTH,height:Dh.HEIGHT,tint:0,alpha:.65},popUp:Gu({x:Dh.HALF_W,y:Dh.HALF_H,"(orientation: landscape)":{}}),btnClose:{x:210,y:-70,anchor:{x:.5,y:.5},scale:{x:.8,y:.8},cursor:"pointer",eventMode:"static"},btnRhomb:uI(uI({},Gd),{},{fontSize:21})};return tu(Cm,{ref:function(e){return t.root=e}},tu((function(){return tu(rs,{name:"innerContainer"},function(){for(var t=[],e=0,n=0;n<5;n++){var r=new os(vr.from("icon-star"));r.anchor.set(.5),e||(e=r.width);var i=(n-2)*e;r.position.set(i,-110),t.push(r)}return t}(),tu(Ms,{text:"".concat(zc.t("rateUs")),y:-40,anchor:{x:.5,y:.5},style:uI(uI({},Gd),{},{fontSize:26,align:"center"})}),tu(rs,{y:30},tu(Ms,{x:-30,text:"+5",anchor:{x:.5,y:.5},style:uI(uI({},Gd),{},{fontSize:40})}),tu(os,{x:24,y:-6,texture:"icon-loupe",scale:{x:.42,y:.42},anchor:{x:.5,y:.5}})),tu(em,{x:-104,y:100,name:"btnLater",texture:"btn-silver",scaleValue:.65,text:"".concat(zc.t("rateUsBtnLater")),style:e.btnRhomb}),tu(em,{x:104,y:100,name:"btnEnter",texture:"btn-gold",scaleValue:.65,text:"".concat(zc.t("rateUsBtnGive")),style:e.btnRhomb}))}),null))}var fI=function(t){var e,n=t.refs;return Yd({w:640,h:120}).alpha=.2,tu(rs,{name:"hudView",y:Dh.HEIGHT-140},((e=new Ya).beginFill(0),e.drawRect(0,0,Dh.WIDTH,140),e.endFill(),e.alpha=.75,e),tu(rs,{name:"hudInner",ref:function(t){return n.hudInner=t},x:Dh.HALF_W,y:70,pivot:{x:320,y:60}}))};function pI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function mI(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pI(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pI(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var gI=mI(mI({},Gd),{},{fill:16046212,fontSize:24}),vI=function(){return tu(Ms,{style:gI,anchor:{x:1,y:.5},x:-10,y:0})};function yI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function xI(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yI(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yI(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var wI=function(t){var e=t.refs;return tu(os,{texture:"speech-bubble",ref:function(t){return e.speechBubble=t},angle:10,anchor:{x:.5,y:.5},y:500},tu(os,{texture:"speech-bubble-center",anchor:{x:.5,y:.5},x:-12,y:22},tu(Ms,{style:xI(xI({},Gd),{fontFamily:"Pacifico",wordWrap:!0,wordWrapWidth:320,align:"center",fontSize:26,lineHeight:24,fontWeight:"normal"}),ref:function(t){return e.speechBubbleText=t},anchor:{x:.5,y:.5}})))},_I=function(t){var e=t.refs,n=ZT.createSpine({spineName:"character",autorun:!1});return e.character=n,n.scale.set(.7),n.position.set(-250,0),tu(rs,{x:Dh.HALF_W,y:0},n,tu(wI,{refs:e}))};function bI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function TI(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bI(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bI(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var SI={view:Gu({x:Dh.HALF_W,y:Dh.HALF_H+40,zIndex:1,"(orientation: landscape)":{}}),btnNextStyle:TI(TI({},Gd),{},{fontSize:36})},AI=Dh.HALF_W,EI=function(t){var e=t.refs;return tu(rs,{ref:function(t){return e.completeLevelView=t},style:SI.view},tu(_I,{refs:e}),tu(rs,{name:"btnsContainer",x:AI,y:800},tu(tm,{name:"btnNext",texture:"btn-gold",text:"".concat(zc.t("level")),textStyle:SI.btnNextStyle}),tu(Qp,{name:"btnBuyLoupe",texture:"icon-loupe-plus",x:-155,y:195,iconScale:.6}),tu(Zp,{name:"btnHome",texture:"icon-home",y:199,scale:{x:.83,y:.83}}),tu(Qp,{name:"btnByeAd",texture:"icon-noAd",x:155,y:195,iconScale:1.22})))};function CI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function kI(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?CI(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CI(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function MI(t){var e,n={};return(e=t.uiInner).addChild.apply(e,Jc([tu(nm,{refs:n,game:t}),function(t,e){return tu(rs,{ref:function(t){return e.btnHint=t},name:"btnHint",classes:Vd(t).btnHint,visible:!1},tu(Jp,{texture:"btn-hint"}),tu(vI,{ref:function(t){return e.textHintsAmount=t}}))}(t,n)].concat(Jc(function(t,e){return[tu(rs,{visible:!1,ref:function(t){return e.timerView=t},name:"timerView",classes:Vd(t).timerView},vm,tu(Ms,{name:"timerText",anchor:{x:.5,y:.5},x:0,style:gm(gm({},Gd),{},{fontSize:20,fill:6034195,fontFamily:"NotoSerif"})}))]}(t,n)),[tu((function(t){var e=t.game,n=t.refs;return tu(rs,{visible:!0,ref:function(t){return n.learningView=t},name:"learningView",classes:Vd(e).learningView})}),{refs:n,game:t}),tu((function(t){var e=t.refs,n=t.game;return tu(os,{ref:function(t){return e.introSpeechBubble=t},name:"introSpeechBubble",classes:Vd(n).introSpeechBubble},tu(Ms,{name:"speechBubbleText",style:kI(kI({},Gd),{fontFamily:"Pacifico",wordWrap:!0,wordWrapWidth:330,align:"center",fontSize:26,fill:16046212,fontWeight:"normal"}),anchor:{x:.5,y:.5},y:10,text:'"Тут так спокойно, что кажется, ничего не могло случиться. Но детали могут рассказать иное."'}))}),{refs:n,game:t})]))),tu(rs,{refs:n,resize:function(){return Wu(n)},sortableChildren:!0,name:"levelView"},tu(os,{ref:function(t){return n.fade=t},name:"fade",visible:!0,alpha:0,classes:Xd.fade}),tu(rs,{ref:function(t){return n.wrapper=t},name:"wrapper",sortableChildren:!0},tu((function(){return tu(rs,{ref:function(t){return n.levelContainer=t},name:"levelContainer",sortableChildren:!0},function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.color,n=void 0===e?4095:e,r=t.alpha,i=void 0===r?.5:r,s=new Ya;return s.beginFill(n),s.drawRect(0,0,Dh.WIDTH,Dh.HEIGHT),s.endFill(),s.alpha=i,s}(),function(t){return[tu(os,{ref:function(e){return t.errorCross=e},name:"errorCross",texture:"error-cross",zIndex:1,anchor:{x:.5,y:.5},visible:!1})]}(n),tu(os,{ref:function(t){return n.hintStars=t},anchor:{x:.5,y:.5},texture:"hint-stars",name:"hintStars",zIndex:1,visible:!1,eventMode:"none"}))}),null),tu(rs,{ref:function(t){return n.confettiContainer=t}}),tu(fI,{ref:function(t){return n.hudView=t},refs:n,visible:!1}),tu(EI,{game:t,refs:n,visible:!1}),Sm(n),tu(Pm,{ref:function(t){return n.purchaseErrorView=t},visible:!1}),tu(hI,{ref:function(t){return n.adRewardHintView=t}}),tu(dI,{ref:function(t){return n.rateUsView=t},visible:!1})),tu(os,{ref:function(t){return n.mainFade=t},visible:!1,alpha:0,classes:Xd.fade}),tu(rm,{ref:function(t){return n.optionsView=t},visible:!1}))}function PI(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(PI=function(){return!!t})()}function II(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function RI(t,e){return t.get(OI(t,e))}function OI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var LI=new WeakMap,DI=new WeakMap,FI=new WeakMap,NI=new WeakMap,BI=new WeakMap,WI=new WeakMap,UI=new WeakMap,jI=new WeakMap,HI=new WeakMap,zI=new WeakMap,GI=function(t){function e(t){var n;return v(this,e),n=function(t,e,n){return e=T(e),b(t,PI()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),II(n,LI,window.game),II(n,DI,RI(LI,n).refs),II(n,FI,RI(DI,n).rateUsView),II(n,NI,RI(FI,n).getChildByName("innerModal",1)),II(n,BI,RI(FI,n).getChildByName("innerContainer")),II(n,WI,RI(BI,n).getChildByName("btnLater",1)),II(n,UI,RI(BI,n).getChildByName("btnEnter")),II(n,jI,null),E(n,"waitForCompletion",(function(){return n.completePromise})),II(n,HI,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:of.userReviewClickOk(),RI(UI,n).off("pointerup",RI(zI,n)),n.uiManager.closeModule(e.moduleName),RI(jI,n).call(n);case 4:case"end":return t.stop()}}),t)})))),II(n,zI,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return of.userReviewClickLater(),RI(WI,n).off("pointerup",RI(HI,n)),t.next=4,n.canReview();case 4:n.uiManager.closeModule(e.moduleName);case 5:case"end":return t.stop()}}),t)})))),E(n,"canReview",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(_SERVICE.sdk){t.next=3;break}return console.error("[_SERVICE.sdk] rateGame: Ошибка при инициализации Yandex SDK"),t.abrupt("return");case 3:return t.next=5,_SERVICE.sdk.feedback.canReview().then((function(t){var e=t.value,r=t.reason;e?_SERVICE.sdk.feedback.requestReview().then((function(t){var e=t.feedbackSent;console.log("canReview:",e),e?(tf.get(Zd).addHints(5),tf.get(Qd).play("sfx_rating"),RI(jI,n).call(n)):RI(jI,n).call(n)})):(console.log("[RateUs] reason",r),RI(jI,n).call(n),"NO_AUTH "===r&&console.log("user не авторизован"),"REVIEW_ALREADY_REQUESTED"===r&&console.log("запрос отправлен, ожидаются действия пользователя"),"REVIEW_WAS_REQUESTED"===r&&console.log("------- запрос отправлен, user совершил действие: поставил оценку или закрыл всплывающее окно."),"UNKNOWN"===r&&console.log("запрос не был отправлен, ошибка на стороне Яндекса."))}));case 5:case"end":return t.stop()}}),t)})))),n.btnClose.visible=!1,Sw.initOverHandler([RI(WI,n),RI(UI,n)]),RI(NI,n).addChild(RI(BI,n)),n.completePromise=new Promise((function(t){!function(t,e,n){t.set(OI(t,e),n)}(jI,n,t)})),n}return A(e,t),_(e,[{key:"show",value:function(){!function(t,e,n){var r=tc(T(t.prototype),"show",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]),RI(WI,this).once("pointerup",RI(HI,this)),RI(UI,this).once("pointerup",RI(zI,this))}}])}(uE);function VI(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function XI(t,e,n){return t.set($I(t,e),n),n}function YI(t,e){return t.get($I(t,e))}function $I(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}E(GI,"viewName","rateUsView"),E(GI,"moduleName",hE);var qI=new WeakMap,KI=new WeakMap,ZI=new WeakMap,QI=new WeakMap,JI=new WeakMap,tR=new WeakMap,eR=new WeakMap,nR=new WeakMap,rR=new WeakMap,iR=_((function t(e){var n=this;v(this,t),VI(this,qI,window.game),VI(this,KI,YI(qI,this).refs),VI(this,ZI,void 0),VI(this,QI,void 0),VI(this,JI,void 0),E(this,"getModule",(function(t){return YI(JI,n)[t]})),E(this,"showModule",function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return YI(eR,n).call(n),YI(rR,n).call(n),t.next=4,YI(JI,n)[e].show();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),E(this,"closeModule",function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return YI(tR,n).call(n),t.next=3,YI(JI,n)[e].hide();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),VI(this,tR,(function(){var t=YI(qI,n).refs.adRewardHintView;return ww.timeline().to(t,{alpha:0,duration:.2,visible:!1})})),VI(this,eR,(function(){})),VI(this,nR,(function(){})),VI(this,rR,(function(){Object.keys(YI(JI,n)).forEach((function(t){YI(JI,n)[t].visible=!1}))})),XI(ZI,this,e),XI(QI,this,YI(KI,this).startScreenView),XI(JI,this,E(E({},oE,new WC(this)),hE,new GI(this)))}));function sR(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function oR(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var aR=new WeakMap,lR=new WeakMap,hR=new WeakMap,cR=new WeakMap,uR=new WeakMap,dR=new WeakMap,fR=_((function t(e){var n=this;v(this,t),sR(this,aR,window.game),sR(this,lR,oR(aR,this).refs),sR(this,hR,oR(lR,this).levelContainer),E(this,"clear",(function(t,e){oR(aR,n).emit(yh),oR(cR,n).call(n,t),oR(uR,n).call(n,t,e),oR(dR,n).call(n)})),sR(this,cR,(function(t){t.forEach((function(t){var e=t.getComponent(o_),r=t.getComponent(rS);e&&oR(hR,n).removeChild(e.view),r&&oR(hR,n).removeChild(r.spine)}))})),sR(this,uR,(function(t,e){t.clear(),e.clear()})),sR(this,dR,(function(){var t=n.level;t.entityManager=null,t.levelContainer=null,t.clearLevel=null})),this.level=e})),pR=Object.defineProperty,mR=(t,e,n)=>(((t,e,n)=>{e in t?pR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class gR{constructor(t){mR(this,"parent"),mR(this,"paused"),this.parent=t,this.paused=!1}destroy(){}down(t){return!1}move(t){return!1}up(t){return!1}wheel(t){return!1}update(t){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}var vR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof t.g<"u"?t.g:typeof self<"u"?self:{},yR={exports:{}};!function(t){(function(){var e,n;n=function(e){return t.exports=e},e={linear:function(t,e,n,r){return n*t/r+e},easeInQuad:function(t,e,n,r){return n*(t/=r)*t+e},easeOutQuad:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){return n*(t/=r)*t*t+e},easeOutCubic:function(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,r){return n*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,r){return n*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,n,r){return 0===t?e:n*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,n,r){return t===r?e+n:n*(1-Math.pow(2,-10*t/r))+e},easeInOutExpo:function(t,e,n,r){return(t/=r/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,n,r){return(t/=r/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,r){var i,s,o;return o=1.70158,0===t||(t/=r),(s=0)||(s=.3*r),(i=n)<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),-i*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/s)+e},easeOutElastic:function(t,e,n,r){var i,s,o;return o=1.70158,0===t||(t/=r),(s=0)||(s=.3*r),(i=n)<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),i*Math.pow(2,-10*t)*Math.sin((t*r-o)*(2*Math.PI)/s)+n+e},easeInOutElastic:function(t,e,n,r){var i,s,o;return o=1.70158,0===t||(t/=r/2),(s=0)||(s=r*(.3*1.5)),(i=n)<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),t<1?i*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/s)*-.5+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/s)*.5+n+e},easeInBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),n*(t/=r)*t*((i+1)*t-i)+e},easeOutBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e},easeInOutBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),(t/=r/2)<1?n/2*(t*t*((1+(i*=1.525))*t-i))+e:n/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e},easeInBounce:function(t,n,r,i){return r-e.easeOutBounce(i-t,0,r,i)+n},easeOutBounce:function(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,n,r,i){return t<i/2?.5*e.easeInBounce(2*t,0,r,i)+n:.5*e.easeOutBounce(2*t-i,0,r,i)+.5*r+n}},n(e)}).call(vR)}(yR);const xR=yR.exports;function wR(t,e){return t?"function"==typeof t?t:"string"==typeof t?xR[t]:void 0:xR[e]}const _R={removeOnInterrupt:!1,ease:"linear",time:1e3};class bR extends gR{constructor(t,e={}){super(t),mR(this,"options"),mR(this,"startX"),mR(this,"startY"),mR(this,"deltaX"),mR(this,"deltaY"),mR(this,"keepCenter"),mR(this,"startWidth",null),mR(this,"startHeight",null),mR(this,"deltaWidth",null),mR(this,"deltaHeight",null),mR(this,"width",null),mR(this,"height",null),mR(this,"time",0),this.options=Object.assign({},_R,e),this.options.ease=wR(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),null!==this.width&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),null!==this.height&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),null!==this.width&&this.parent.fitWidth(this.width,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.height,this.keepCenter,null===this.width),!this.keepCenter&&this.options.position&&this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(this.paused)return;this.time+=t;const e=new mn(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){const t=this.parent.width,n=this.parent.height;this.complete(),(t!==this.parent.width||n!==this.parent.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}else{const t=this.options.ease(this.time,0,1,this.options.time);if(null!==this.width){const e=this.startWidth,n=this.deltaWidth;this.parent.fitWidth(e+n*t,this.keepCenter,null===this.height)}if(null!==this.height){const e=this.startHeight,n=this.deltaHeight;this.parent.fitHeight(e+n*t,this.keepCenter,null===this.width)}if(null===this.width?this.parent.scale.x=this.parent.scale.y:null===this.height&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const e=this.startX,n=this.startY,r=this.deltaX,i=this.deltaY,s=new mn(this.parent.x,this.parent.y);this.parent.moveCenter(e+r*t,n+i*t),this.parent.emit("moved",{viewport:this.parent,original:s,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}}}const TR={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class SR extends gR{constructor(t,e={}){super(t),mR(this,"options"),mR(this,"left"),mR(this,"top"),mR(this,"right"),mR(this,"bottom"),mR(this,"underflowX"),mR(this,"underflowY"),mR(this,"ease"),mR(this,"toX"),mR(this,"toY"),this.options=Object.assign({},TR,e),this.ease=wR(this.options.ease,"easeInOutSine"),this.options.sides?"all"===this.options.sides?this.top=this.bottom=this.left=this.right=!0:"horizontal"===this.options.sides?(this.right=this.left=!0,this.top=this.bottom=!1):"vertical"===this.options.sides?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=-1!==this.options.sides.indexOf("top"),this.bottom=-1!==this.options.sides.indexOf("bottom"),this.left=-1!==this.options.sides.indexOf("left"),this.right=-1!==this.options.sides.indexOf("right")):this.left=this.top=this.right=this.bottom=!1;const n=this.options.underflow.toLowerCase();"center"===n?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==n.indexOf("left")?-1:-1!==n.indexOf("right")?1:0,this.underflowY=-1!==n.indexOf("top")?-1:-1!==n.indexOf("bottom")?1:0),this.reset()}isActive(){return null!==this.toX||null!==this.toY}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(t){if(!this.paused){if(this.bounce(),this.toX){const e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){const e=this.toY;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),e.time>=this.options.time?(this.parent.y=e.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(e.time,e.start,e.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}oob(){const t=this.options.bounceBox;if(t){const e=typeof t.x>"u"?0:t.x,n=typeof t.y>"u"?0:t.y,r=typeof t.width>"u"?this.parent.worldWidth:t.width,i=typeof t.height>"u"?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>r,top:this.parent.top<n,bottom:this.parent.bottom>i,topLeft:new mn(e*this.parent.scale.x,n*this.parent.scale.y),bottomRight:new mn(r*this.parent.scale.x-this.parent.screenWidth,i*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new mn(0,0),bottomRight:new mn(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){var t,e;if(this.paused)return;let n,r=this.parent.plugins.get("decelerate",!0);r&&(r.x||r.y)&&(r.x&&r.percentChangeX===(null==(t=r.options)?void 0:t.friction)||r.y&&r.percentChangeY===(null==(e=r.options)?void 0:e.friction))&&(n=this.oob(),(n.left&&this.left||n.right&&this.right)&&(r.percentChangeX=this.options.friction),(n.top&&this.top||n.bottom&&this.bottom)&&(r.percentChangeY=this.options.friction));const i=this.parent.plugins.get("drag",!0)||{},s=this.parent.plugins.get("pinch",!0)||{};if(r=r||{},!(null!=i&&i.active||null!=s&&s.active||this.toX&&this.toY||r.x&&r.y)){n=n||this.oob();const t=n.topLeft,e=n.bottomRight;if(!this.toX&&!r.x){let r=null;n.left&&this.left?r=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-t.x:n.right&&this.right&&(r=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-e.x),null!==r&&this.parent.x!==r&&(this.toX={time:0,start:this.parent.x,delta:r-this.parent.x,end:r},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!r.y){let r=null;n.top&&this.top?r=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-t.y:n.bottom&&this.bottom&&(r=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-e.y),null!==r&&this.parent.y!==r&&(this.toY={time:0,start:this.parent.y,delta:r-this.parent.y,end:r},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const AR={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class ER extends gR{constructor(t,e={}){super(t),mR(this,"options"),mR(this,"last"),mR(this,"noUnderflow"),mR(this,"underflowX"),mR(this,"underflowY"),this.options=Object.assign({},AR,e),this.options.direction&&(this.options.left="x"===this.options.direction||"all"===this.options.direction||null,this.options.right="x"===this.options.direction||"all"===this.options.direction||null,this.options.top="y"===this.options.direction||"all"===this.options.direction||null,this.options.bottom="y"===this.options.direction||"all"===this.options.direction||null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();"none"===t?this.noUnderflow=!0:"center"===t?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t=new mn(this.parent.x,this.parent.y),e=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==this.options.right){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:0!==this.parent.x&&(this.parent.x=0,n=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,n=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,n=!0)}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,e.x=0,n=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:0!==this.parent.y&&(this.parent.y=0,n=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,n=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,n=!0)}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,e.y=0,n=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const CR={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class kR extends gR{constructor(t,e={}){super(t),mR(this,"options"),this.options=Object.assign({},CR,e),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused)if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(null!==this.options.minWidth&&t<this.options.minWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxWidth&&t>this.options.maxWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.minHeight&&e<this.options.minHeight){const n=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxHeight&&e>this.options.maxHeight){const t=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/t,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const t={x:null,y:null},e={x:null,y:null};if("number"==typeof this.options.minScale)t.x=this.options.minScale,t.y=this.options.minScale;else if(null!==this.options.minScale){const e=this.options.minScale;t.x=typeof e.x>"u"?null:e.x,t.y=typeof e.y>"u"?null:e.y}if("number"==typeof this.options.maxScale)e.x=this.options.maxScale,e.y=this.options.maxScale;else if(null!==this.options.maxScale){const t=this.options.maxScale;e.x=typeof t.x>"u"?null:t.x,e.y=typeof t.y>"u"?null:t.y}let n=this.parent.scale.x,r=this.parent.scale.y;null!==t.x&&n<t.x&&(n=t.x),null!==e.x&&n>e.x&&(n=e.x),null!==t.y&&r<t.y&&(r=t.y),null!==e.y&&r>e.y&&(r=e.y),(n!==this.parent.scale.x||r!==this.parent.scale.y)&&(this.parent.scale.set(n,r),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}reset(){this.clamp()}}const MR={friction:.98,bounce:.8,minSpeed:.01},PR=16;class IR extends gR{constructor(t,e={}){super(t),mR(this,"options"),mR(this,"x"),mR(this,"y"),mR(this,"percentChangeX"),mR(this,"percentChangeY"),mR(this,"saved"),mR(this,"timeSinceRelease"),this.options=Object.assign({},MR,e),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",(t=>this.handleMoved(t)))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!(!this.x&&!this.y)}move(){if(this.paused)return!1;const t=this.parent.input.count();return(1===t||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}handleMoved(t){if(this.saved.length){const e=this.saved[this.saved.length-1];"clamp-x"===t.type&&t.original?e.x===t.original.x&&(e.x=this.parent.x):"clamp-y"===t.type&&t.original&&e.y===t.original.y&&(e.y=this.parent.y)}}up(){if(0===this.parent.input.count()&&this.saved.length){const t=performance.now();for(const e of this.saved)if(e.time>=t-100){const n=t-e.time;this.x=(this.parent.x-e.x)/n,this.y=(this.parent.y-e.y)/n,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(t){typeof(t=t||{}).x<"u"&&(this.x=t.x,this.percentChangeX=this.options.friction),typeof t.y<"u"&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const e=this.x||this.y,n=this.timeSinceRelease,r=this.timeSinceRelease+t;if(this.x){const e=this.percentChangeX,i=Math.log(e);this.parent.x+=this.x*PR/i*(Math.pow(e,r/PR)-Math.pow(e,n/PR)),this.x*=Math.pow(this.percentChangeX,t/PR)}if(this.y){const e=this.percentChangeY,i=Math.log(e);this.parent.y+=this.y*PR/i*(Math.pow(e,r/PR)-Math.pow(e,n/PR)),this.y*=Math.pow(this.percentChangeY,t/PR)}this.timeSinceRelease+=t,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const RR={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1};class OR extends gR{constructor(t,e={}){super(t),mR(this,"options"),mR(this,"moved"),mR(this,"reverse"),mR(this,"xDirection"),mR(this,"yDirection"),mR(this,"keyIsPressed"),mR(this,"mouse"),mR(this,"underflowX"),mR(this,"underflowY"),mR(this,"last"),mR(this,"current"),mR(this,"windowEventHandlers",[]),this.options=Object.assign({},RR,e),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||"all"===this.options.direction||"x"===this.options.direction,this.yDirection=!this.options.direction||"all"===this.options.direction||"y"===this.options.direction,this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){this.addWindowEventHandler("keyup",(e=>{t.includes(e.code)&&(this.keyIsPressed=!1)})),this.addWindowEventHandler("keydown",(e=>{t.includes(e.code)&&(this.keyIsPressed=!0)}))}addWindowEventHandler(t,e){window.addEventListener(t,e),this.windowEventHandlers.push({event:t,handler:e})}destroy(){this.windowEventHandlers.forEach((({event:t,handler:e})=>{window.removeEventListener(t,e)}))}mouseButtons(t){this.mouse=t&&"all"!==t?[-1!==t.indexOf("left"),-1!==t.indexOf("middle"),-1!==t.indexOf("right")]:[!0,!0,!0]}parseUnderflow(){const t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(t.includes("left")?this.underflowX=-1:t.includes("right")?this.underflowX=1:this.underflowX=0,t.includes("top")?this.underflowY=-1:t.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(t){const e="mouse"===t.pointerType,n=this.parent.input.count();return!(!(1===n||n>1&&!this.parent.plugins.get("pinch",!0))||e&&!this.mouse[t.button])}checkKeyPress(t){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===t.data.pointerType}down(t){return!(this.paused||!this.options.pressDrag||(this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.global.x,y:t.global.y},this.current=t.pointerId,0):(this.last=null,1)))}get active(){return this.moved}move(t){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===t.data.pointerId){const e=t.global.x,n=t.global.y,r=this.parent.input.count();if(1===r||r>1&&!this.parent.plugins.get("pinch",!0)){const r=e-this.last.x,i=n-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(r)||this.yDirection&&this.parent.input.checkThreshold(i)){const r={x:e,y:n};return this.xDirection&&(this.parent.x+=(r.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(r.y-this.last.y)*this.options.factor),this.last=r,this.moved||this.parent.emit("drag-start",{event:t,screen:new mn(this.last.x,this.last.y),world:this.parent.toWorld(new mn(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up(t){if(this.paused)return!1;const e=this.parent.input.touches;if(1===e.length){const t=e[0];return t.last&&(this.last={x:t.last.x,y:t.last.y},this.current=t.id),this.moved=!1,!0}if(this.last&&this.moved){const e=new mn(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:e,world:this.parent.toWorld(e),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(t){if(this.paused)return!1;if(this.options.wheel){const e=this.parent.plugins.get("wheel",!0);if(!e||!e.options.wheelZoom&&!t.ctrlKey){const e=t.deltaMode?this.options.lineHeight:1,n=[t.deltaX,t.deltaY],[r,i]=this.options.wheelSwapAxes?n.reverse():n;return this.xDirection&&(this.parent.x+=r*e*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=i*e*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),this.parent.options.stopPropagation&&t.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const LR={speed:0,acceleration:null,radius:null};class DR extends gR{constructor(t,e,n={}){super(t),mR(this,"options"),mR(this,"target"),mR(this,"velocity"),this.target=e,this.options=Object.assign({},LR,n),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const e=this.parent.center;let n=this.target.x,r=this.target.y;if(this.options.radius){if(!(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius))return;{const t=Math.atan2(this.target.y-e.y,this.target.x-e.x);n=this.target.x-Math.cos(t)*this.options.radius,r=this.target.y-Math.sin(t)*this.options.radius}}const i=n-e.x,s=r-e.y;if(i||s)if(this.options.speed)if(this.options.acceleration){const t=Math.atan2(r-e.y,n-e.x),o=Math.sqrt(Math.pow(i,2)+Math.pow(s,2));if(o){const a=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);this.velocity=o>a?{x:Math.min(this.velocity.x+(this.options.acceleration,this.options.speed)),y:Math.min(this.velocity.y+(this.options.acceleration,this.options.speed))}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const l=Math.cos(t)*this.velocity.x,h=Math.sin(t)*this.velocity.y,c=Math.abs(l)>Math.abs(i)?n:e.x+l,u=Math.abs(h)>Math.abs(s)?r:e.y+h;this.parent.moveCenter(c,u),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const t=Math.atan2(r-e.y,n-e.x),o=Math.cos(t)*this.options.speed,a=Math.sin(t)*this.options.speed,l=Math.abs(o)>Math.abs(i)?n:e.x+o,h=Math.abs(a)>Math.abs(s)?r:e.y+a;this.parent.moveCenter(l,h),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(n,r),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const FR={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class NR extends gR{constructor(t,e={}){super(t),mR(this,"options"),mR(this,"reverse"),mR(this,"radiusSquared"),mR(this,"left"),mR(this,"top"),mR(this,"right"),mR(this,"bottom"),mR(this,"horizontal"),mR(this,"vertical"),this.options=Object.assign({},FR,e),this.reverse=this.options.reverse?1:-1,this.radiusSquared="number"==typeof this.options.radius?Math.pow(this.options.radius,2):null,this.resize()}resize(){const t=this.options.distance;null!==t?(this.left=t,this.top=t,this.right=this.parent.screenWidth-t,this.bottom=this.parent.screenHeight-t):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.screenWidth-this.options.right,this.bottom=null===this.options.bottom?null:this.parent.screenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(t){if(this.paused||"mouse"!==t.pointerType&&1!==t.pointerId||!this.options.allowButtons&&0!==t.buttons)return!1;const e=t.global.x,n=t.global.y;if(this.radiusSquared){const t=this.parent.toScreen(this.parent.center);if(Math.pow(t.x-e,2)+Math.pow(t.y-n,2)>=this.radiusSquared){const r=Math.atan2(t.y-n,t.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(r))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(r))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(r)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(r)*this.options.speed*this.reverse*.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else null!==this.left&&e<this.left?this.horizontal=Number(this.reverse)*this.options.speed*.06:null!==this.right&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&n<this.top?this.vertical=Number(this.reverse)*this.options.speed*.06:null!==this.bottom&&n>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const BR={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class WR extends gR{constructor(t,e={}){super(t),mR(this,"options"),mR(this,"active",!1),mR(this,"pinching",!1),mR(this,"moved",!1),mR(this,"lastCenter"),this.options=Object.assign({},BR,e)}down(){return this.parent.input.count()>=2&&(this.active=!0,!0)}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(t){if(this.paused||!this.active)return!1;const e=t.global.x,n=t.global.y,r=this.parent.input.touches;if(r.length>=2){const i=r[0],s=r[1],o=i.last&&s.last?Math.sqrt(Math.pow(s.last.x-i.last.x,2)+Math.pow(s.last.y-i.last.y,2)):null;if(i.id===t.pointerId?i.last={x:e,y:n,data:t}:s.id===t.pointerId&&(s.last={x:e,y:n,data:t}),o){let t;const e=new mn(i.last.x+(s.last.x-i.last.x)/2,i.last.y+(s.last.y-i.last.y)/2);this.options.center||(t=this.parent.toLocal(e));let n=Math.sqrt(Math.pow(s.last.x-i.last.x,2)+Math.pow(s.last.y-i.last.y,2));n=0===n?n=1e-10:n;const r=(1-o/n)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=r),this.isAxisY()&&(this.parent.scale.y+=r),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:e});const a=this.parent.plugins.get("clamp-zoom",!0);if(a&&a.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const n=this.parent.toGlobal(t);this.parent.x+=(e.x-n.x)*this.options.factor,this.parent.y+=(e.y-n.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(e.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(e.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=e,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return!!(this.pinching&&this.parent.input.touches.length<=1)&&(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0)}}const UR={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class jR extends gR{constructor(t,e,n,r={}){super(t),mR(this,"options"),mR(this,"ease"),mR(this,"x"),mR(this,"y"),mR(this,"percent"),mR(this,"snapping"),mR(this,"deltaX"),mR(this,"deltaY"),mR(this,"startX"),mR(this,"startY"),this.options=Object.assign({},UR,r),this.ease=wR(r.ease,"easeInOutSine"),this.x=e,this.y=n,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(0===this.parent.input.count()){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}return!1}update(t){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){const e=this.snapping;let n,r,i;e.time+=t;const s=this.startX,o=this.startY,a=this.deltaX,l=this.deltaY;if(e.time>this.options.time)n=!0,r=s+a,i=o+l;else{const t=this.ease(e.time,0,1,this.options.time);r=s+a*t,i=o+l*t}this.options.topLeft?this.parent.moveCorner(r,i):this.parent.moveCenter(r,i),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),n&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const t=this.options.topLeft?this.parent.corner:this.parent.center;(t.x!==this.x||t.y!==this.y)&&this.snapStart()}}}const HR={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class zR extends gR{constructor(t,e={}){super(t),mR(this,"options"),mR(this,"ease"),mR(this,"xScale"),mR(this,"yScale"),mR(this,"xIndependent"),mR(this,"yIndependent"),mR(this,"snapping"),this.options=Object.assign({},HR,e),this.ease=wR(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=t.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,0===this.options.time?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):e.forceStart&&this.createSnapping()}createSnapping(){const t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,n=this.parent.screenWidth/this.xScale,r=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:n-t,deltaY:r-e},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(t){if(this.paused||this.options.interrupt&&0!==this.parent.input.count())return;let e;if(!this.options.center&&!this.options.noMove&&(e=this.parent.center),this.snapping){if(this.snapping){const n=this.snapping;if(n.time+=t,n.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const t=this.snapping,e=this.ease(t.time,t.startX,t.deltaX,this.options.time),n=this.ease(t.time,t.startY,t.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/e,this.parent.scale.y=this.parent.screenHeight/n}const r=this.parent.plugins.get("clamp-zoom",!0);r&&r.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}else(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping()}resume(){this.snapping=null,super.resume()}}const GR={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class VR extends gR{constructor(t,e={}){super(t),mR(this,"options"),mR(this,"smoothing"),mR(this,"smoothingCenter"),mR(this,"smoothingCount"),mR(this,"keyIsPressed"),this.options=Object.assign({},GR,e),this.keyIsPressed=!1,this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){window.addEventListener("keydown",(e=>{t.includes(e.code)&&(this.keyIsPressed=!0)})),window.addEventListener("keyup",(e=>{t.includes(e.code)&&(this.keyIsPressed=!1)}))}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const t=this.smoothingCenter,e=this.smoothing;let n;this.options.center||(n=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x+=e.x),this.isAxisY()&&(this.parent.scale.y+=e.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const r=this.parent.plugins.get("clamp-zoom",!0);if(r&&r.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const e=this.parent.toGlobal(n);this.parent.x+=t.x-e.x,this.parent.y+=t.y-e.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch(t){if(this.paused)return;const e=this.parent.input.getPointerPosition(t),n=-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/200,r=Math.pow(2,(1+this.options.percent)*n);let i;this.options.center||(i=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=r),this.isAxisY()&&(this.parent.scale.y*=r),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const s=this.parent.plugins.get("clamp-zoom",!0);if(s&&s.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const t=this.parent.toGlobal(i);this.parent.x+=e.x-t.x,this.parent.y+=e.y-t.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}wheel(t){if(this.paused||!this.checkKeyPress())return!1;if(t.ctrlKey&&this.options.trackpadPinch)this.pinch(t);else if(this.options.wheelZoom){const e=this.parent.input.getPointerPosition(t),n=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,r=Math.pow(2,(1+this.options.percent)*n);if(this.options.smooth){const t={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+t.x)*r-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+t.y)*r-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{let t;this.options.center||(t=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=r),this.isAxisY()&&(this.parent.scale.y*=r),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const n=this.parent.plugins.get("clamp-zoom",!0);if(n&&n.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const n=this.parent.toGlobal(t);this.parent.x+=e.x-n.x,this.parent.y+=e.y-n.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}return!this.parent.options.passiveWheel}}class XR{constructor(t){mR(this,"viewport"),mR(this,"clickedAvailable"),mR(this,"isMouseDown"),mR(this,"last"),mR(this,"wheelFunction"),mR(this,"touches"),this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.eventMode="static",this.viewport.forceHitArea||(this.viewport.hitArea=new vn(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.options.allowPreserveDragOutside?this.viewport.on("globalpointermove",this.move,this):this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.options.allowPreserveDragOutside||this.viewport.on("pointerleave",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.events.domElement.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.events.domElement.removeEventListener("wheel",this.wheelFunction)}down(t){if(!this.viewport.pause&&this.viewport.worldVisible){if("mouse"===t.pointerType?this.isMouseDown=!0:this.get(t.pointerId)||this.touches.push({id:t.pointerId,last:null}),1===this.count()){this.last=t.global.clone();const e=this.viewport.plugins.get("decelerate",!0),n=this.viewport.plugins.get("bounce",!0);e&&e.isActive()||n&&n.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.plugins.move(t);if(this.clickedAvailable&&this.last){const e=t.global.x-this.last.x,n=t.global.y-this.last.y;(this.checkThreshold(e)||this.checkThreshold(n))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.worldVisible)return;"mouse"===t.pointerType&&(this.isMouseDown=!1),"mouse"!==t.pointerType&&this.remove(t.pointerId);const e=this.viewport.plugins.up(t);this.clickedAvailable&&0===this.count()&&this.last&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this.viewport}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){const e=new mn;return this.viewport.options.events.mapPositionToPoint(e,t.clientX,t.clientY),e}handleWheel(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.toLocal(this.getPointerPosition(t));this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom&&this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(const e of this.touches)if(e.id===t)return e;return null}remove(t){for(let e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return void this.touches.splice(e,1)}count(){return(this.isMouseDown?1:0)+this.touches.length}}const YR=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class $R{constructor(t){mR(this,"plugins"),mR(this,"list"),mR(this,"viewport"),this.viewport=t,this.list=[],this.plugins={}}add(t,e,n=YR.length){const r=this.plugins[t];r&&r.destroy(),this.plugins[t]=e;const i=YR.indexOf(t);-1!==i&&YR.splice(i,1),YR.splice(n,0,t),this.sort()}get(t,e){var n;return e&&null!=(n=this.plugins[t])&&n.paused?null:this.plugins[t]}update(t){for(const e of this.list)e.update(t)}resize(){for(const t of this.list)t.resize()}reset(){for(const t of this.list)t.reset()}removeAll(){this.list.forEach((t=>{t.destroy()})),this.plugins={},this.sort()}remove(t){var e;this.plugins[t]&&(null==(e=this.plugins[t])||e.destroy(),delete this.plugins[t],this.viewport.emit("plugin-remove",t),this.sort())}pause(t){var e;null==(e=this.plugins[t])||e.pause()}resume(t){var e;null==(e=this.plugins[t])||e.resume()}sort(){this.list=[];for(const t of YR)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let e=!1;for(const n of this.list)n.down(t)&&(e=!0);return e}move(t){let e=!1;for(const n of this.viewport.plugins.list)n.move(t)&&(e=!0);return e}up(t){let e=!1;for(const n of this.list)n.up(t)&&(e=!0);return e}wheel(t){let e=!1;for(const n of this.list)n.wheel(t)&&(e=!0);return e}}const qR={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,disableOnContextMenu:!1,ticker:_i.shared,allowPreserveDragOutside:!1};function KR(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(KR=function(){return!!t})()}function ZR(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function QR(t,e){return t.get(JR(t,e))}function JR(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tO=new WeakMap,eO=new WeakMap,nO=new WeakMap,rO=new WeakMap,iO=new WeakMap,sO=new WeakMap,oO=new WeakMap,aO=new WeakMap,lO=function(t){function e(t,n){var r;return v(this,e),r=function(t,e,n){return e=T(e),b(t,KR()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[{screenWidth:Dh.WIDTH,screenHeight:Dh.HEIGHT,worldWidth:Dh.WIDTH,worldHeight:Dh.HEIGHT,passiveWheel:!1,stopPropagation:!0,events:t.app.renderer.events}]),E(r,"camera",r),ZR(r,tO,.9),ZR(r,eO,4),E(r,"init",(function(){QR(sO,r).call(r,!0),QR(rO,r).call(r),QR(oO,r).call(r),QR(nO,r).call(r)})),E(r,"setPause",(function(t){r.camera.pause=t})),E(r,"getTargetCenter",(function(t){var e=t.sprite,n=t.isMesh,i=t.x,s=t.y,o=r.camera.center,a=o.x,l=o.y,h=e.getLocalBounds(),c=h.x,u=h.y;return{x:a+(e.width/2+(n?c:i)-a),y:l+(e.height/2+(n?u:s)-l)}})),ZR(r,nO,(function(){var t=r.game.resizeData.scaleFactor,e={value:3*t};r.plugins.remove("clamp-zoom"),r.setZoom(e.value,!0),ww.to(e,{value:t,duration:3.9,ease:"linear",onUpdate:function(){r.setZoom(e.value,!0)},onComplete:function(){QR(oO,r).call(r)}})})),ZR(r,rO,(function(){r.camera.drag({wheel:!1}).decelerate({friction:.97}).pinch({noDrag:!0}).wheel({percent:1.5,smooth:100}).clamp({left:!1,right:!1,top:!1,bottom:!1,direction:"all",underflow:"center"}).mouseEdges({radius:null,top:50,bottom:120,left:50,right:50,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1})})),ZR(r,iO,(function(){QR(sO,r).call(r,!1),QR(aO,r).call(r),function(t,e){t.set(JR(t,e),.5)}(tO,r),r.game.app.stage.removeChild(r.camera),r.camera.destroy({children:!0})})),ZR(r,sO,(function(t){var e=t?"on":"off";r.game[e](vh,r.setPause.bind(r,!0)),r.game[e](yh,QR(iO,r)),r.game[e](dh,QR(oO,r))})),ZR(r,oO,(function(){var t=r.game.resizeData.scaleFactor,e=r.camera.scale;r.camera.resize(window.innerWidth,window.innerHeight,Dh.WIDTH,Dh.HEIGHT),r.camera.scale.set(t),r.camera.scale.set(Math.max(t,e.x),Math.max(t,e.y)),r.camera.clampZoom({minScale:t,maxScale:t+QR(tO,r),damping:1}),r.camera.moveCenter(Dh.HALF_W,Dh.HALF_H),r.camera.mouseEdges({radius:null,top:50*t,bottom:120*t,left:50*t,right:50*t,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1})})),E(r,"disabledUserMove",(function(){r.setPause(!1),r.plugins.pause("drag"),r.plugins.pause("wheel"),r.plugins.pause("pinch"),r.plugins.remove("mouse-edges")})),E(r,"unDisabledUserMove",(function(){r.setPause(!1),r.plugins.resume("drag"),r.plugins.resume("wheel"),r.plugins.resume("pinch"),r.camera.mouseEdges({radius:null,top:50,bottom:120,left:50,right:50,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1})})),ZR(r,aO,(function(){r.camera.plugins.remove("clamp"),r.camera.plugins.remove("decelerate"),r.camera.plugins.remove("drag"),r.camera.plugins.remove("pinch"),r.camera.plugins.remove("wheel"),r.camera.plugins.remove("clamp-zoom"),r.camera.plugins.remove("mouseEdges")})),r.game=t,r.refs=r.game.refs,r.refs.camera=r,r.debugText=r.refs.debugText,r.levelContainer=n,r.levelContainer.visible=!0,r.camera.addChild(n),r.game.app.stage.addChildAt(r.camera,0),r.camera.interactiveChildren=!0,r.setPause(!0),QR(oO,r).call(r),r.setZoom(QR(eO,r),!0),r}return A(e,t),_(e)}(class extends rs{constructor(t){super(),mR(this,"moving"),mR(this,"screenWidth"),mR(this,"screenHeight"),mR(this,"threshold"),mR(this,"input"),mR(this,"plugins"),mR(this,"zooming"),mR(this,"lastViewport"),mR(this,"options"),mR(this,"_dirty"),mR(this,"_forceHitArea"),mR(this,"_hitAreaDefault"),mR(this,"_pause"),mR(this,"tickerFunction"),mR(this,"_worldWidth"),mR(this,"_worldHeight"),mR(this,"_disableOnContextMenu",(t=>t.preventDefault())),this.options={...qR,...t},this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.disableOnContextMenu&&this.options.events.domElement.addEventListener("contextmenu",this._disableOnContextMenu),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new XR(this),this.plugins=new $R(this)}destroy(t){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&this.options.events.domElement.removeEventListener("contextmenu",this._disableOnContextMenu),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new vn(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=window.innerWidth,e=window.innerHeight,n,r){this.screenWidth=t,this.screenHeight=e,typeof n<"u"&&(this._worldWidth=n),typeof r<"u"&&(this._worldHeight=r),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new vn(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,e){return 2===arguments.length?this.toLocal(new mn(t,e)):this.toLocal(t)}toScreen(t,e){return 2===arguments.length?this.toGlobal(new mn(t,e)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new mn(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(...t){let e,n;"number"==typeof t[0]?(e=t[0],n=t[1]):(e=t[0].x,n=t[0].y);const r=(this.worldScreenWidth/2-e)*this.scale.x,i=(this.worldScreenHeight/2-n)*this.scale.y;return(this.x!==r||this.y!==i)&&(this.position.set(r,i),this.plugins.reset(),this.dirty=!0),this}get corner(){return new mn(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(...t){let e,n;return 1===t.length?(e=-t[0].x*this.scale.x,n=-t[0].y*this.scale.y):(e=-t[0]*this.scale.x,n=-t[1]*this.scale.y),(e!==this.x||n!==this.y)&&(this.position.set(e,n),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,e){const n=this.screenWidth/t,r=this.screenHeight/e;return Math.min(n,r)}findCover(t,e){const n=this.screenWidth/t,r=this.screenHeight/e;return Math.max(n,r)}fitWidth(t=this.worldWidth,e,n=!0,r){let i;e&&(i=this.center),this.scale.x=this.screenWidth/t,n&&(this.scale.y=this.scale.x);const s=this.plugins.get("clamp-zoom",!0);return!r&&s&&s.clamp(),e&&i&&this.moveCenter(i),this}fitHeight(t=this.worldHeight,e,n=!0,r){let i;e&&(i=this.center),this.scale.y=this.screenHeight/t,n&&(this.scale.x=this.scale.y);const s=this.plugins.get("clamp-zoom",!0);return!r&&s&&s.clamp(),e&&i&&this.moveCenter(i),this}fitWorld(t){let e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),t&&e&&this.moveCenter(e),this}fit(t,e=this.worldWidth,n=this.worldHeight){let r;t&&(r=this.center),this.scale.x=this.screenWidth/e,this.scale.y=this.screenHeight/n,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),t&&r&&this.moveCenter(r),this}setZoom(t,e){let n;e&&(n=this.center),this.scale.set(t);const r=this.plugins.get("clamp-zoom",!0);return r&&r.clamp(),e&&n&&this.moveCenter(n),this}zoomPercent(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}zoom(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}get scaled(){return this.scale.x}set scaled(t){this.setZoom(t,!0)}snapZoom(t){return this.plugins.add("snap-zoom",new zR(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new mn(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new vn(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new OR(this,t)),this}clamp(t){return this.plugins.add("clamp",new ER(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new IR(this,t)),this}bounce(t){return this.plugins.add("bounce",new SR(this,t)),this}pinch(t){return this.plugins.add("pinch",new WR(this,t)),this}snap(t,e,n){return this.plugins.add("snap",new jR(this,t,e,n)),this}follow(t,e){return this.plugins.add("follow",new DR(this,t,e)),this}wheel(t){return this.plugins.add("wheel",new VR(this,t)),this}animate(t){return this.plugins.add("animate",new bR(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new kR(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new NR(this,t)),this}get pause(){return!!this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,e,n,r,i){i&&(n>this.worldScreenWidth||r>this.worldScreenHeight)&&(this.fit(!0,n,r),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let s=!1;t<this.left?(this.left=t,s=!0):t+n>this.right&&(this.right=t+n,s=!0),e<this.top?(this.top=e,s=!0):e+r>this.bottom&&(this.bottom=e+r,s=!0),s&&this.emit("moved",{viewport:this,type:"ensureVisible"})}});function hO(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(hO=function(){return!!t})()}function cO(t,e,n,r){var i=tc(T(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function uO(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function dO(t,e){return t.get(pO(t,e))}function fO(t,e,n){return t.set(pO(t,e),n),n}function pO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mO=new WeakMap,gO=new WeakMap,vO=new WeakMap,yO=new WeakMap,xO=new WeakMap,wO=new WeakMap,_O=new WeakMap,bO=new WeakMap,TO=function(t){function e(){var t;return v(this,e),t=function(t,e){return e=T(e),b(t,hO()?Reflect.construct(e,[],T(t).constructor):e.apply(t,void 0))}(this,e),uO(t,mO,window.game),uO(t,gO,void 0),uO(t,vO,void 0),uO(t,yO,void 0),uO(t,xO,void 0),E(t,"btn",void 0),uO(t,wO,(function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(dO(gO,t).visible=!0,dO(vO,t).visible=!1):(dO(gO,t).visible=!1,dO(vO,t).visible=!0)})),uO(t,_O,(function(){fO(gO,t,t.btn.getChildByName("btnTopContainer")),fO(vO,t,t.btn.getChildByName("btnTimerContainer")),fO(yO,t,t.btn.getChildByName("timerText",1)),dO(yO,t).initText=dO(yO,t).text})),uO(t,bO,(function(e){dO(wO,t).call(t,!1);var n=Math.floor(e/60),r=e%60,i=String(n).padStart(2,"0"),s=String(r).padStart(2,"0");dO(yO,t).text="".concat(i," : ").concat(s)})),"object"===y(e.instance)||(e.instance=t),b(t,e.instance)}return A(e,t),_(e,[{key:"init",value:function(t,n){cO(e,"init",this,3)([t,"btnHintRewardTimer",mu]),fO(xO,this,n),dO(_O,this).call(this)}},{key:"onTimerTick",value:function(t){dO(bO,this).call(this,t)}},{key:"onTimerEnd",value:function(){cO(e,"onTimerEnd",this,3)([]),dO(wO,this).call(this,!0)}},{key:"onError",value:function(){dO(xO,this).purchaseError.show()}}])}(NE);function SO(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(SO=function(){return!!t})()}function AO(t,e,n,r){var i=tc(T(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function EO(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function CO(t,e,n){return t.set(MO(t,e),n),n}function kO(t,e){return t.get(MO(t,e))}function MO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var PO=new WeakMap,IO=new WeakMap,RO=new WeakMap,OO=new WeakMap,LO=new WeakMap,DO=new WeakMap,FO=new WeakMap,NO=new WeakMap,BO=new WeakMap,WO=function(t){function e(t){var n;return v(this,e),n=function(t,e,n){return e=T(e),b(t,SO()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),EO(n,PO,window.game),EO(n,IO,kO(PO,n).refs),EO(n,RO,void 0),EO(n,OO,void 0),EO(n,LO,void 0),EO(n,DO,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return CO(OO,n,n.view.getChildByName("btnStore",1)),CO(LO,n,n.view.getChildByName("btnPlayReward",1)),CO(RO,n,new TO),t.next=5,kO(RO,n).init(kO(LO,n),n);case 5:n.purchaseError=new cC(kO(IO,n).purchaseErrorView),Sw.initOverHandler([kO(OO,n),kO(LO,n)]),kO(FO,n).call(n,!0);case 8:case"end":return t.stop()}}),t)})))),EO(n,FO,(function(t){var e=t?"on":"off";kO(OO,n)[e]("pointerdown",kO(NO,n)),kO(LO,n)[e]("pointerdown",kO(BO,n))})),EO(n,NO,(function(){tf.get(Qd).play("sfx_btnClick"),n.innerModal.visible=!1,kO(PO,n).LEVEL.uiManager.showModule(oE),of.noHintsClickBtnStore()})),EO(n,BO,(function(){of.noHintsClickBtnReward()})),kO(DO,n).call(n),n}return A(e,t),_(e,[{key:"show",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return _SERVICE.preloadRewardedAd(),t.next=3,AO(e,"show",this,3)([]);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"hide",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:kO(RO,this).destroy(),console.log("this.#btnRewardTimer.destroy");case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}])}(rC);function UO(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function jO(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var HO="level",zO=new WeakMap,GO=new WeakMap,VO=_((function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.game,i=n.label,s=void 0===i?"defaultStopwatch":i;v(this,t),E(this,"start",(function(){jO(zO,e).call(e,!0);var t=Math.ceil(e.remainingTime);e.timerTween=ww.to(e,{elapsedTime:e.duration,duration:e.duration,ease:"none",onUpdate:function(){var n=Math.floor(e.elapsedTime);n!==t&&(t=n,jO(GO,e).call(e,n))},onComplete:function(){e.clear()}})})),UO(this,zO,(function(t){var n=t?"on":"off";e.game[n](vh,e.clear),e.game[n](yh,e.clear)})),UO(this,GO,(function(t){e.game.emit(kh,{label:e.label,currentTime:t,currentTimeWithZero:t>9?t:"0".concat(t)})})),E(this,"clear",(function(t){t&&qc.log(Vc.DestroyMessage,"[Stopwatch] module clear"),e.timerTween&&(e.timerTween.kill(),e.timerTween=null,e.game.emit("stopwatch:kill",{label:e.label})),jO(zO,e).call(e,!1)})),this.game=r,this.duration=Math.floor(9999),this.label=s,this.remainingTime=this.duration,this.timerTween=null,this.elapsedTime=0}),[{key:"fullDataTime",get:function(){var t=Math.floor(this.elapsedTime);return{h:Math.floor(t/3600),m:Math.floor(t%3600/60),s:t%60}}},{key:"seconds",get:function(){return Math.floor(this.elapsedTime)}}]);function XO(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function YO(t,e,n){return t.set(qO(t,e),n),n}function $O(t,e){return t.get(qO(t,e))}function qO(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var KO=new WeakMap,ZO=new WeakMap,QO=new WeakMap,JO=new WeakMap,tL=new WeakMap,eL=new WeakMap,nL=new WeakMap,rL=new WeakMap,iL=_((function t(){var e=this;v(this,t),XO(this,KO,window.game),XO(this,ZO,$O(KO,this).refs),XO(this,QO,void 0),XO(this,JO,void 0),E(this,"init",(function(){$O(tL,e).call(e),$O(eL,e).call(e),$O(nL,e).call(e,!0)})),XO(this,tL,(function(){YO(QO,e,tf.get(Zd)),YO(JO,e,$O(ZO,e).textHintsAmount)})),XO(this,eL,(function(){$O(JO,e).text=$O(QO,e).hints})),XO(this,nL,(function(t){var n=t?"on":"off";$O(KO,e)[n](Mh,$O(eL,e)),$O(KO,e)[n](yh,$O(rL,e))})),XO(this,rL,(function(){$O(nL,e).call(e,!1)})),this.init()}));function sL(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function oL(t,e,n){return t.set(lL(t,e),n),n}function aL(t,e){return t.get(lL(t,e))}function lL(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hL=new WeakMap,cL=new WeakMap,uL=new WeakMap,dL=new WeakMap,fL=new WeakMap,pL=new WeakMap,mL=new WeakMap,gL=new WeakMap,vL=new WeakMap,yL=new WeakMap,xL=new WeakMap,wL=new WeakMap,_L=new WeakMap,bL=new WeakMap,TL=new WeakMap,SL=new WeakMap,AL=new WeakMap,EL=new WeakMap,CL=new WeakMap,kL=new WeakMap,ML=new WeakMap,PL=new WeakMap,IL=new WeakMap,RL=new WeakMap,OL=_((function t(e){var n=this;v(this,t),sL(this,hL,window.game),sL(this,cL,aL(hL,this).refs),sL(this,uL,aL(cL,this).btnHint),sL(this,dL,tf.get(Zd)),sL(this,fL,0),sL(this,pL,10),sL(this,mL,void 0),sL(this,gL,null),E(this,"btnTimeLine",void 0),E(this,"btnTmeLineTick",void 0),sL(this,vL,void 0),sL(this,yL,15519854),E(this,"init",(function(){oL(vL,n,new iL),oL(mL,n,new WO(aL(cL,n).adRewardHintView)),n.colorMatrix=new Ds,n.colorMatrix.brightness(.5,!1),aL(_L,n).call(n,!0),aL(bL,n).call(n,!0)})),sL(this,xL,(function(t){n.activeTargets.push(t)})),sL(this,wL,(function(){aL(bL,n).call(n,!1),n.activeTargets=[],n.camera.eventMode="static",aL(uL,n).eventMode="static",aL(uL,n).visible=!1,bw(n.btnTimeLine),aL(_L,n).call(n,!1)})),sL(this,_L,(function(t){var e=t?"on":"off";aL(hL,n)[e](vh,aL(wL,n)),aL(hL,n)[e](ph,aL(PL,n)),aL(hL,n)[e](xh,aL(xL,n)),aL(hL,n)[e](kh,aL(TL,n)),aL(uL,n)[e]("pointerup",aL(SL,n))})),sL(this,bL,(function(t){var e=t?"static":"none";aL(uL,n).eventMode=e})),sL(this,TL,(function(t){var e,r=t.label;t.currentTime,r===HO&&aL(uL,n).interactive&&(oL(fL,n,(e=aL(fL,n),++e)),aL(fL,n)===aL(pL,n)&&(oL(fL,n,0),function(t){var e=t.target,n=t.thickness,r=void 0===n?1:n,i=t.color,s=new Rd(2,void 0===i?16711680:i);e.filters=[s],s.name="OutlineFilter",ww.timeline().fromTo(s,{thickness:0},{thickness:r,duration:.5,yoyo:!0,repeat:3}).eventCallback("onComplete",(function(){e.filters=[]}))}({target:aL(uL,n),color:aL(yL,n)}),n.btnTmeLineTick=ww.timeline().to(aL(uL,n).scale,{x:"+=0.1",y:"+=0.1",yoyo:!0,repeat:1})))})),sL(this,SL,(function(){tf.get(Qd).play("sfx_btnClick"),aL(dL,n).hints<=0?aL(mL,n).show():aL(AL,n).call(n)})),sL(this,AL,(function(){aL(hL,n).emit(gh,!0);var t=n.activeTargets.filter((function(t){return t.isAlive}))[0];oL(gL,n,t),aL(bL,n).call(n,!1),aL(EL,n).call(n),aL(CL,n).call(n,t),of.useHint(n.level.config,t)})),sL(this,EL,(function(){aL(uL,n).filters=[n.colorMatrix],bw(n.btnTimeLine,!0),bw(n.btnTmeLineTick,!0),n.btnTimeLine=ww.timeline().fromTo(aL(uL,n).scale,{x:aL(uL,n).scale.x,y:aL(uL,n).scale.y},{x:aL(uL,n).scale.x+.2,y:aL(uL,n).scale.y+.2,yoyo:!0,repeat:1,ease:"back.in(2.5)"})})),sL(this,CL,(function(t){if(t&&null!=t&&t.sprite){n.camera.eventMode="none",n.camera.plugins.pause("drag"),n.camera.plugins.pause("wheel"),n.camera.plugins.pause("pinch");var e=n.camera.getTargetCenter(t),r=e.x,i=e.y;n.camera.animate({scale:aL(hL,n).scaleFactor,position:new mn(r,i),time:1e3,ease:"easeInOutSine",callbackOnComplete:function(){oL(fL,n,0),aL(kL,n).call(n,t)}})}})),sL(this,kL,(function(t){var e=t.sprite,r=aL(cL,n).hintStars;aL(ML,n).call(n,t),n.camera.eventMode="static";var i=new Rd(2,aL(yL,n));e.filters=[i],e.filterName="OutlineFilter",t.hintTimeline=ww.timeline().set(r,{visible:!0}).fromTo(r.scale,{x:0,y:0},{x:2,y:2,repeat:2}).fromTo(r,{alpha:1},{alpha:0,repeat:2,delay:.2},"<").add((function(){return tf.get(Qd).play("sfx_hintFlash")}),"<").to(e,{alpha:1},"<").fromTo(i,{thickness:0},{thickness:3,repeat:5,duration:.22,yoyo:!0,ease:"linear"},"<").to(e,{alpha:e.initAlpha},"<").eventCallback("onComplete",(function(){n.camera.plugins.resume("drag"),n.camera.plugins.resume("wheel"),n.camera.plugins.resume("pinch"),e.filters=[],aL(uL,n).filters=[],oL(fL,n,0),t.hintTimeline=null,r.visible=!1,aL(IL,n).call(n,t)}))})),sL(this,ML,(function(t){var e=t.sprite,r=aL(cL,n).hintStars;if(t.isMesh){var i=e.getLocalBounds(),s=i.x,o=i.y,a=i.width,l=i.height;r.position.set(s+a/2,o+l/2)}else r.position.set(e.x,Math.abs(e.y))})),sL(this,PL,(function(t){aL(uL,n).interactive&&"hogItemContainer"===t.typeName&&oL(fL,n,0)})),sL(this,IL,(function(t){aL(gL,n)&&aL(gL,n).name===t.name&&(oL(gL,n,null),aL(uL,n).filters=[],aL(bL,n).call(n,!0))})),sL(this,RL,(function(t){var e=t.sprite,n=e.getLocalBounds();console.log("isMesh",t.isMesh),console.warn("target",t.width,"/",t.height,"pos",t.position.x,"*",t.position.y),console.warn("sprite",e.width,"/",e.height,"pos",e.position.x,"*",e.position.y),console.warn("bounds",n.width,"/",n.width,"pos",n.x,"*",n.y)})),this.level=e,this.camera=e.camera,this.activeTargets=[]}));function LL(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function DL(t,e,n){return t.set(NL(t,e),n),n}function FL(t,e){return t.get(NL(t,e))}function NL(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var BL=new WeakMap,WL=new WeakMap,UL=new WeakMap,jL=new WeakMap,HL=new WeakMap,zL=new WeakMap,GL=new WeakMap,VL=new WeakMap,XL=new WeakMap,YL=new WeakMap,$L=new WeakMap,qL=new WeakMap,KL=new WeakMap,ZL=new WeakMap,QL=new WeakMap,JL=_((function t(e){var n=this;v(this,t),LL(this,BL,window.game),LL(this,WL,FL(BL,this).refs),LL(this,UL,null),LL(this,jL,null),LL(this,HL,{x:0,y:0}),LL(this,zL,0),LL(this,GL,FL(WL,this).errorCross),LL(this,VL,null),LL(this,XL,(function(t){var e=t?"on":"off";FL(BL,n)[e](ph,FL(YL,n)),FL(BL,n)[e](vh,FL(XL,n).bind(n,!1)),FL(UL,n)[e]("pointerdown",FL($L,n)),FL(UL,n)[e]("pointerup",FL(qL,n))})),E(this,"clear",(function(t){t&&qc.log(Vc.DestroyMessage,"[ErrorCross] module clear"),FL(YL,n).call(n),FL(BL,n).off(ph,FL(YL,n)),FL(UL,n).off("pointerdown",FL($L,n)),FL(UL,n).off("pointerup",FL(qL,n)),FL(GL,n).visible=!1,FL(GL,n).eventMode="auto"})),LL(this,YL,(function(){FL(VL,n)&&(FL(VL,n).kill(),FL(VL,n).clear(),FL(GL,n).visible=!1)})),LL(this,$L,(function(t){var e=t.data;DL(HL,n,FL(UL,n).toLocal(e.global)),DL(jL,n,{x:n.camera.left,y:n.camera.top}),n.disabledClick=!1})),LL(this,qL,(function(t){var e=t.target;if(!n.disabledClick&&"errorCross"!==e.name&&FL(jL,n)){var r=FL(UL,n).toLocal(t.data.global),i=n.camera.left-FL(jL,n).x,s=n.camera.top-FL(jL,n).y,o=FL(HL,n).x-r.x+i,a=FL(HL,n).y-r.y+s;Math.sqrt(o*o+a*a)>2||null!=e&&e.isAlive||!1===(null==e?void 0:e.isAlive)&&e.visible||(FL(YL,n).call(n),tf.get(Qd).play("sfx_missClick"),FL(KL,n).call(n,r),FL(BL,n).emit(mh,!0))}})),LL(this,KL,(function(t){var e=1/n.camera.scale.x;DL(VL,n,ww.timeline({duration:.1,yoyo:!0,repeat:0}).set([FL(GL,n)],{x:t.x,y:t.y},"<").set([FL(GL,n)],{visible:!0},"<").set([FL(GL,n)],{alpha:1,duration:.3},"<").fromTo([FL(GL,n).scale],{x:0,y:0},{x:.6*e,y:.6*e},"<").to([FL(GL,n)],{alpha:0,delay:.5,duration:.2},"<").eventCallback("onComplete",(function(){FL(GL,n).visible=!1})))})),LL(this,ZL,(function(t){var e;"hogItemContainer"!==t.typeName?DL(zL,n,(e=FL(zL,n),++e)):DL(zL,n,0),console.log(FL(zL,n))})),LL(this,QL,(function(t){var e=new Gs(FL(BL,n).uiInner).hitTest(t.data.global.x,t.data.global.y);return(null==e?void 0:e.name)===FL(WL,n).btnHint.name&&(console.warn("Клик заблокирован, так как попал по UI объекту:",e.name),!0)})),DL(UL,this,e),this.camera=FL(UL,this).parent,FL(UL,this).eventMode="static",FL(GL,this).eventMode="static",FL(GL,this).setEvents=FL(XL,this),FL(XL,this).call(this,!0)}));function tD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function eD(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tD(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tD(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function nD(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function rD(t,e,n){return t.set(sD(t,e),n),n}function iD(t,e){return t.get(sD(t,e))}function sD(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oD=new WeakMap,aD=new WeakMap,lD=new WeakMap,hD=new WeakMap,cD=new WeakMap,uD=new WeakMap,dD=new WeakMap,fD=new WeakMap,pD=new WeakMap,mD=new WeakMap,gD=new WeakMap,vD=new WeakMap,yD=new WeakMap,xD=new WeakMap,wD=new WeakMap,_D=new WeakMap,bD=_((function t(e){var n=this,r=e.config,i=e.spineLevel;v(this,t),nD(this,oD,window.game),nD(this,aD,iD(oD,this).refs),nD(this,lD,0),nD(this,hD,null),nD(this,cD,void 0),nD(this,uD,void 0),nD(this,dD,void 0),nD(this,fD,(function(){iD(vD,n).call(n,!0),iD(pD,n).call(n)})),nD(this,pD,(function(){if(_SERVICE.sdk&&_SERVICE.flags){var t,e=iD(aD,n).hudInner;rD(uD,n,((i=new Ya).beginFill(0),i.drawRoundedRect(-62,0,124,80,30),i.endFill(),i.alpha=.75,tu(rs,{name:"levelCounterView",x:30,y:-100,visible:!1},i,tu(Ms,{text:"0/10",name:"counterText",x:0,y:-0,anchor:{x:.5,y:0},style:eD(eD({},Gd),{},{fill:16046212,fontSize:50,fontFamily:"Pacifico"})})))),e.addChild(iD(uD,n)),rD(dD,n,iD(uD,n).getChildByName("counterText",1));var r=null===(t=_SERVICE.flags)||void 0===t?void 0:t.useCounterFlag;iD(uD,n).visible="true"===r||!0===r,iD(dD,n).text=iD(gD,n).call(n,0)}var i})),E(this,"clear",(function(t){t&&qc.log(Vc.DestroyMessage,"[LevelCounter] module clear"),iD(vD,n).call(n,!1),iD(oD,n).off(_h,iD(wD,n)),rD(cD,n,0),rD(hD,n,0),rD(lD,n,0),iD(mD,n).call(n)})),nD(this,mD,(function(){iD(uD,n)&&(iD(uD,n).visible=!1,iD(dD,n).text="")})),E(this,"getMaxItems",(function(){var t=n.spineLevel.skeleton.findBone(n.config.hogItemsBone);return t.skeleton.slots.filter((function(e){return e.bone===t})).filter((function(t){var e;return null===(e=t.attachment)||void 0===e?void 0:e.name})).length})),nD(this,gD,(function(t){return t+"/".concat(iD(cD,n))})),nD(this,vD,(function(){var t=arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?"off":"on";iD(oD,n)[t](ph,iD(yD,n))})),nD(this,yD,(function(){var t,e;rD(hD,n,(t=iD(hD,n),--t)),rD(lD,n,(e=iD(lD,n),++e)),iD(xD,n).call(n),iD(_D,n).call(n),iD(oD,n).emit(_h,iD(wD,n).call(n))})),nD(this,xD,(function(){iD(uD,n)&&(iD(dD,n).text=iD(gD,n).call(n,iD(lD,n)))})),nD(this,wD,(function(){return{maxItems:n.getMaxItems(),itemsFound:iD(lD,n)}})),nD(this,_D,(function(){iD(lD,n)>=iD(cD,n)&&iD(oD,n).emit(wh)})),this.config=r,this.spineLevel=i,rD(cD,this,this.getMaxItems()),rD(hD,this,this.getMaxItems()),iD(fD,this).call(this)})),TD=new WeakMap,SD=_((function t(e){var n=this;v(this,t),E(this,"hud",null),E(this,"hudIcon",void 0),E(this,"iconSize",{w:120,h:120,offsetX:10}),E(this,"showItems",(function(){var t=n.hud,e=t.view,r=t.hudChildren;ww.fromTo(e,{alpha:0},{alpha:1,visible:!0}),r.forEach((function(t,e){ww.to(t.scale,{x:.8,y:.8,yoyo:!0,repeat:1,delay:.1*e})}))})),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,TD,(function(t){var e=Ee["hud-icon-".concat(t)]?vr.from("hud-icon-".concat(t)):vr.WHITE,r=new os(e);return r.anchor.set(.5),r.width=n.iconSize.w,r.height=n.iconSize.h,r.name="innerSprite",r})),E(this,"showNewIcon",function(){var t=Jh(nc().mark((function t(e){var r,i,s,o;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=n.hud.hudChildren.find((function(t){return t.name===e.name})),i=null==r?void 0:r.getChildByName("innerSprite"),t.next=5,n.animationDead(i);case 5:n.hud.itemsQueue.length>0&&(s=n.hud.itemsQueue.shift(),o=s.attachment.name.split("/")[1],i.texture=Ee["hud-icon-".concat(o)]?vr.from("hud-icon-".concat(o)):vr.WHITE,r.name=o,ww.to(i,{alpha:1}),n.hud.entityManager.initHogItems([s])),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("[HudStrategy] showNewIcon",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()),E(this,"animationDead",(function(){})),this.hud=e}),[{key:"createHudIcon",value:function(t,e,n){try{var r=$d({w:this.iconSize.w,h:this.iconSize.h,center:!0,color:16777215});r.alpha=1,r.visible=n;var i=function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(TD,this).call(this,t),s=new rs;return s.name=t,s.addChild(i,r),s.position.set(e*(i.width+this.iconSize.offsetX)+i.width/2,i.height/2),this.hudIcon=s,s}catch(t){console.error("[HUD] createItem",t)}}}]);function AD(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(AD=function(){return!!t})()}var ED=new WeakMap,CD=function(t){function e(t){var n;return v(this,e),n=function(t,e,n){return e=T(e),b(t,AD()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),E(n,"maxItems",5),E(n,"name",lh),E(n,"animationDead",function(){var t=Jh(nc().mark((function t(e){var n;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.filters.find((function(t){return"colorOverlay"===t.name})),t.next=3,ww.timeline().to(n,{alpha:0,duration:.3}).to(e,{alpha:0,delay:.3}).set(n,{alpha:1});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),E(n,"createHudIcon",(function(t,r,i){var s=function(t,e,n){var r=tc(T(t.prototype),"createHudIcon",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,n)([t,r,i]);return s.getChildByName("innerSprite").filters=function(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}(ED,n).call(n),s})),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,(function(){return[Am(16777215)]}))}(n,ED),n}return A(e,t),_(e)}(SD);function kD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function MD(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kD(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kD(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function PD(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(PD=function(){return!!t})()}function ID(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function RD(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var OD=new WeakMap,LD=new WeakMap,DD=new WeakMap,FD=function(t){function e(t){var n;return v(this,e),n=function(t,e,n){return e=T(e),b(t,PD()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),ID(n,OD,window.game),E(n,"maxItems",4),E(n,"name",hh),E(n,"showItems",(function(){var t=n.hud,e=t.view,r=t.hudChildren;ww.fromTo(e,{alpha:0},{alpha:1,visible:!0}),r.forEach((function(t,e){ww.from(t,{alpha:0,delay:.3*e})}))})),E(n,"animationDead",function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ww.to(e,{alpha:0});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),E(n,"createHudIcon",(function(t,e){try{var r=$d({w:320,h:60,center:!0,color:16046212});r.alpha=1,r.visible=!0;var i=RD(LD,n).call(n,t),s=new rs;s.name=t,s.addChild(r,i);var o={x:0,y:10};return 0===e&&s.position.set(r.width/2,r.height/2),1===e&&s.position.set(r.width/2+r.width+o.x,r.height/2),2===e&&s.position.set(r.width/2,r.height/2+r.height),3===e&&s.position.set(r.width/2+r.width+o.x,r.height/2+r.height),s}catch(t){console.error("[HUD] createHudIcon",t)}})),ID(n,LD,(function(t){try{var e=RD(DD,n).call(n,t),r=new Ms(e,MD(MD({},Gd),{},{fill:16046212}));return r.anchor.set(.5),r.name="innerSprite",r}catch(t){console.error("[HUD] createWord",t)}})),ID(n,DD,(function(t){try{qc.log(Vc.Hud,"↓---------------↓"),qc.log(Vc.Hud,"name",t);var e=t.includes("_")?t.split("_")[0]:t;qc.log(Vc.Hud,"hogItemName",e);var r=RD(OD,n).locale,i=tf.get(Jd).localesHud,s=Object.keys(i).find((function(t){return t.toLowerCase()===e.toLowerCase()})),o=s?i[s][r]:e;return qc.log(Vc.Hud,"создано слово:",t),qc.log(Vc.Hud,"перевод:",o),qc.log(Vc.Hud,"------------- ↑  ↑ -------------"),o.charAt(0).toLocaleUpperCase(r)+o.slice(1)}catch(t){qc.log(Vc.Hud,"getTranslateWord",t)}})),E(n,"showNewIcon",function(){var t=Jh(nc().mark((function t(e){var r,i,s,o,a,l,h,c,u;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.name.match(/\d+_(\w+)/),i=(null==r?void 0:r[1])||e.name,s=n.hud.hudChildren.find((function(t){return i===t.name})),o=null==s?void 0:s.getChildByName("innerSprite"),n.hud.itemsQueue.length>0?(a=n.hud.itemsQueue.shift(),l=a.attachment.name,h=l.match(/\/lvl_\d+_(\w+)$/),c=null==h?void 0:h[1].split("_")[0],s.name=c,u=RD(DD,n).call(n,c),ww.timeline().to(o,{alpha:0}).set(o,{text:u}).to(o,{alpha:1}),n.hud.entityManager.initHogItems([a])):ww.to(o,{alpha:0});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n}return A(e,t),_(e)}(SD);function ND(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ND=function(){return!!t})()}var BD=function(t){function e(t){var n;return v(this,e),n=function(t,e,n){return e=T(e),b(t,ND()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),E(n,"maxItems",5),E(n,"name","default"),E(n,"animationDead",function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ww.timeline().to(e,{alpha:0});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n}return A(e,t),_(e)}(SD);function WD(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function UD(t,e,n){return t.set(HD(t,e),n),n}function jD(t,e){return t.get(HD(t,e))}function HD(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zD=new WeakMap,GD=new WeakMap,VD=new WeakMap,XD=new WeakMap,YD=new WeakMap,$D=new WeakMap,qD=new WeakMap,KD=new WeakMap,ZD=new WeakMap,QD=new WeakMap,JD=new WeakMap,tF=new WeakMap,eF=new WeakMap,nF=new WeakMap,rF=_((function t(){var e=this;v(this,t),WD(this,zD,window.game),WD(this,GD,jD(zD,this).refs),WD(this,VD,void 0),WD(this,XD,[]),WD(this,YD,void 0),WD(this,$D,[]),WD(this,qD,[]),WD(this,KD,void 0),WD(this,ZD,void 0),E(this,"view",jD(GD,this).hudView),E(this,"itemsQueue",[]),E(this,"hudChildren",void 0),E(this,"entityManager",null),E(this,"isDebug",!1),E(this,"init",(function(t){var n=t.config,r=t.entityManager;jD(QD,e).call(e,n),UD(YD,e,jD(ZD,e).maxItems),e.entityManager=r,UD(KD,e,n.spineName),UD(qD,e,ZT.findSlots(r.spineLevelComponent,n)),jD(JD,e).call(e),jD(tF,e).call(e),e.entityManager.initHogItems(jD($D,e)),jD(eF,e).call(e,!0)})),WD(this,QD,(function(t){var n=t.spineName,r=Bu.extractSuffix(n),i=E(E({},lh,Bu.isStringTrue(_SERVICE.flags.useHudShadow)?new CD(e):new BD(e)),hh,Bu.isStringTrue(_SERVICE.flags.useHudWords)?new FD(e):new BD(e));UD(ZD,e,i[r]||new BD(e))})),E(this,"showItems",(function(){jD(ZD,e).showItems()})),E(this,"clear",(function(t){t&&qc.log(Vc.DestroyMessage,"[Hud] module clear"),jD(eF,e).call(e,!1),e.view.destroy({children:!0}),UD(XD,e,[]),e.itemsQueue=[],UD($D,e,[]),UD(qD,e,[]),e.entityManager=null,UD(ZD,e,null)})),WD(this,JD,(function(){qc.log(Vc.Hud,"========== всего создано имён на уровне =========="),jD(qD,e).forEach((function(t,n){var r=t.attachment.name.split("/")[1];if(qc.log(Vc.Hud,n+1,r),"words"===jD(ZD,e).name){var i=r.match(/\d+_(\w+)/),s=(null==i?void 0:i[1])||r;jD(XD,e).push(s)}else jD(XD,e).push(r)})),qc.log(Vc.Hud,"========== nameAfterSlash end ==========")})),WD(this,tF,(function(){var t=jD(YD,e);jD(qD,e).slice(0,t).forEach((function(t,n){if("words"!==jD(ZD,e).name){var r="hud-icon-".concat(jD(XD,e)[n]);Ee[r]||console.error("[HUD createItems]: текстура ".concat(r," не найдена. Проверь имя спайна"))}var i=jD(ZD,e).createHudIcon(jD(XD,e)[n],n,e.isDebug);jD(VD,e).addChild(i),jD($D,e).push(t)})),e.itemsQueue=jD(qD,e).slice(t),jD(nF,e).call(e)})),WD(this,eF,(function(t){var n=t?"on":"off";jD(zD,e)[n](ph,jD(ZD,e).showNewIcon),jD(zD,e)[n](dh,jD(nF,e))})),WD(this,nF,(function(){var t=game.uiRect,n=jD(VD,e);n.scale.set(1),Dh.isPortrait&&n.width>t.width?n.scale.set(t.width/n.width-.05):n.scale.set(1)})),UD(VD,this,this.view.getChildByName("hudInner")),this.hudChildren=jD(VD,this).children}));function iF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function sF(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var oF=new WeakMap,aF=new WeakMap,lF=_((function t(){var e=this;v(this,t),iF(this,oF,window.game),E(this,"modules",{}),iF(this,aF,(function(){Object.values(e.modules).forEach((function(t){null!=t&&t.clear&&t.clear(!0)})),sF(oF,e).off(yh,sF(aF,e)),e.modules={}})),this.modules={},sF(oF,this).on(yh,sF(aF,this))}),[{key:"getMod",value:function(t){return this.modules[t]}},{key:"init",value:function(t){if(t.errorCross&&(this.modules.errorCross=new JL(t.errorCross)),t.stopwatch&&(this.modules.stopwatch=new VO(t.stopwatch),this.modules.stopwatch.start()),t.levelCounter&&(this.modules.levelCounter=new bD(t.levelCounter)),t.hud)return this.modules.hud=new rF,this.modules.hud.init(t.hud)}}]);function hF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(hF=function(){return!!t})()}function cF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function uF(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var dF=new WeakMap,fF=new WeakMap,pF=new WeakMap,mF=new WeakMap,gF=new WeakMap,vF=new WeakMap,yF=new WeakMap,xF=new WeakMap,wF=new WeakMap,_F=new WeakMap,bF=function(t){function e(){var t;return v(this,e),t=function(t,e){return e=T(e),b(t,hF()?Reflect.construct(e,[],T(t).constructor):e.apply(t,void 0))}(this,e),cF(t,dF,window.game),cF(t,fF,uF(dF,t).refs),E(t,"view",t),E(t,"popUp",void 0),E(t,"fade",void 0),E(t,"btnClose",void 0),E(t,"name","baseModal"),E(t,"eventMode","static"),E(t,"x",0),E(t,"y",0),E(t,"w",430),E(t,"h",500),E(t,"pivotCenter",!0),E(t,"text",""),E(t,"beginFill",16445894),E(t,"borderFill",9142607),E(t,"lineWidth",10),cF(t,pF,Jh(nc().mark((function e(){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return uF(yF,t).call(t),e.next=3,t.show();case 3:Sw.initOverHandler([t.btnClose]);case 4:case"end":return e.stop()}}),e)})))),E(t,"show",Jh(nc().mark((function e(){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.view.visible=!0,e.next=3,ww.fromTo(t,{alpha:0},{alpha:1});case 3:uF(mF,t).call(t,!0);case 4:case"end":return e.stop()}}),e)})))),E(t,"destroy",(function(){t.removeChildren(),uF(fF,t).wrapper.removeChild(t),t.view=null})),cF(t,mF,(function(e){var n=e?"on":"off",r=e?"addEventListener":"removeEventListener";t.view[n]("pointerup",uF(gF,t)),document[r]("keydown",uF(vF,t))})),cF(t,gF,(function(e){if(e.target.name===t.btnClose.name)return t.hide()})),cF(t,vF,(function(e){if("escape"===e.key.toLowerCase()&&t.visible)return t.hide()})),cF(t,yF,(function(){uF(xF,t).call(t),uF(wF,t).call(t),t.position.copyFrom(Dh.CENTER)})),cF(t,xF,(function(){var e=t,n=e.x,r=e.y,i=e.lineWidth,s=e.beginFill,o=e.borderFill,a=new Ya;a.name="viewPopUp",t.popUp=a,a.beginFill(s),a.lineStyle(i,o,1),a.drawRect(n+i/2,r+i/2,t.w,t.h),a.endFill(),a.eventMode="static",t.pivotCenter&&a.position.set(-a.width/2+n+i/2,-a.height/2+r+i/2),t.addChild(a)})),cF(t,wF,(function(){var e=t,n=e.w,r=e.h,i=e.lineWidth,s=new os(vr.from("icon-close"));s.name="btnClose",s.anchor.set(.5),s.position.set(n/2+i/2,-r/2+i/2),s.type="button",s.cursor="pointer",s.eventMode="static",t.btnClose=s,t.addChild(s)})),cF(t,_F,(function(){var e=new Ya;e.name="fade",e.beginFill(0),e.drawRect(-Dh.HALF_W,-Dh.HALF_H,Dh.WIDTH,Dh.HEIGHT),e.endFill(),e.alpha=.5,e.eventMode="static",t.fade=e,t.addChild(e)})),uF(pF,t).call(t),t}return A(e,t),_(e,[{key:"hide",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return tf.get(Qd).play("sfx_btnClick"),uF(mF,this).call(this,!1),t.next=4,ww.to(this,{alpha:0,visible:!1});case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}])}(rs);function TF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function SF(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?TF(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):TF(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function AF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(AF=function(){return!!t})()}function EF(t,e,n,r){var i=tc(T(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof i?function(t){return i.apply(n,t)}:i}function CF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function kF(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var MF=new WeakMap,PF=new WeakMap,IF=new WeakMap,RF=new WeakMap,OF=new WeakMap,LF=new WeakMap,DF=new WeakMap,FF=new WeakMap,NF=new WeakMap,BF=new WeakMap,WF=function(t){function e(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).promoData;return v(this,e),t=function(t,e){return e=T(e),b(t,AF()?Reflect.construct(e,[],T(t).constructor):e.apply(t,void 0))}(this,e),CF(t,MF,window.game),CF(t,PF,kF(MF,t).refs),E(t,"promoData",void 0),E(t,"btnBye",void 0),E(t,"id",void 0),E(t,"textStyle",SF(SF({},Gd),{},{fontWeight:"bold"})),CF(t,IF,(function(){kF(RF,t).call(t),kF(OF,t).call(t),kF(LF,t).call(t),kF(DF,t).call(t),kF(BF,t).call(t),Sw.initOverHandler([t.btnBye])})),CF(t,RF,(function(){var e=new Ms(t.promoData.header,SF(SF({},Gd),{},{fontSize:28,fontWeight:"bold"}));e.anchor.set(.5),e.position.set(t.view.lineWidth/2,-t.view.h/2+50),t.view.addChild(e)})),CF(t,OF,(function(){var e=new os(vr.from(t.promoData.texture));e.anchor.set(.5),e.position.set(0,-50),t.view.addChild(e)})),CF(t,LF,(function(){var e=new Ms(t.promoData.description,SF(SF({},Gd),{},{fontSize:28,align:"center"}));e.anchor.set(.5),e.position.set(t.view.lineWidth/2,110),t.view.addChild(e)})),CF(t,DF,(function(){var e=new os(vr.from("btn-gold"));e.name="btnBye",e.anchor.set(.5),e.scale.set(.7),e.y=t.view.h/2-55,e.type="button",e.cursor="pointer",e.eventMode="static",t.btnBye=e,t.btnBye.once("pointerdown",kF(NF,t)),t.addChild(e)})),CF(t,FF,Jh(nc().mark((function e(){var n,r;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_SERVICE.payments){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,_SERVICE.getStoreCatalog();case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return");case 7:return r=n,_SERVICE.id===rh&&(r=Object.entries(n).map((function(t){var e=iu(t,2);return SF({id:e[0]},e[1])}))),e.abrupt("return",r.find((function(e){return e.id===t.promoData.id})));case 10:case"end":return e.stop()}}),e)})))),CF(t,NF,(function(){kF(MF,t).emit(Oh,t.promoData.id)})),CF(t,BF,Jh(nc().mark((function e(){var n,r,i;return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kF(FF,t).call(t);case 2:n=e.sent,r=n.price,(i=new Ms(r,SF(SF({},Gd),{},{fontSize:48,fontWeight:"bold",align:"center"}))).anchor.set(.5),t.btnBye.addChild(i);case 7:case"end":return e.stop()}}),e)})))),t.promoData=n,t.id=n.id,kF(IF,t).call(t),t}return A(e,t),_(e,[{key:"hide",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,EF(e,"hide",this,3)([]);case 2:console.log("PromoCard скрыт после анимации"),kF(MF,this).emit(Lh);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}])}(bF);function UF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function jF(t,e){return t.get(zF(t,e))}function HF(t,e,n){return t.set(zF(t,e),n),n}function zF(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var GF={STARTED_PACK:{id:"promoStartedPack",reward:{hints:!0,noAd:!0},get header(){return"".concat(zc.t("promoStartedPack.header"))},texture:"special-card-2",get description(){return"".concat(zc.t("promoStartedPack.description"))}},REMOVE_AD_PACK:{id:"promoRemoveAdPack",reward:{hints:!1,noAd:!0},get header(){return"".concat(zc.t("promoRemoveAdPack.header"))},texture:"special-card-3",get description(){return"".concat(zc.t("promoRemoveAdPack.description"))}},MEGA_HINTS_PACK:{id:"promoMegaHintsPack",reward:{hints:!0,noAd:!1},get header(){return"".concat(zc.t("promoMegaHintsPack.header"))},texture:"special-card-1",get description(){return"".concat(zc.t("promoMegaHintsPack.description"))}}},VF=new WeakMap,XF=new WeakMap,YF=new WeakMap,$F=new WeakMap,qF=new WeakMap,KF=new WeakMap,ZF=new WeakMap,QF=new WeakMap,JF=new WeakMap,tN=new WeakMap,eN=_((function t(e,n){var r=this;v(this,t),UF(this,VF,void 0),UF(this,XF,void 0),UF(this,YF,void 0),UF(this,$F,null),UF(this,qF,void 0),UF(this,KF,void 0),E(this,"currentLevel",void 0),E(this,"firstKitIsBuy",!1),E(this,"secondKitIsBuy",!1),E(this,"thirdKitIsBuy",!1),E(this,"checkPromo",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(t.game,t.player),n=t.currentLevel;return new Promise((function(t){if(HF(KF,r,t),e.hasAdPass||(2===n&&(HF($F,r,new WF({promoData:GF.STARTED_PACK})),jF(YF,r).addChild(jF($F,r).view)),5===n&&(HF($F,r,new WF({promoData:GF.MEGA_HINTS_PACK})),jF(YF,r).addChild(jF($F,r).view)),10===n&&(HF($F,r,new WF({promoData:GF.REMOVE_AD_PACK})),jF(YF,r).addChild(jF($F,r).view))),e.hasAdPass&&20===n&&(HF($F,r,new WF({promoData:GF.MEGA_HINTS_PACK})),jF(YF,r).addChild(jF($F,r).view)),!jF($F,r))return t()}))})),UF(this,ZF,(function(t){var e=t?"on":"off";jF(VF,r)[e](Oh,jF(JF,r)),jF(VF,r)[e](vh,jF(QF,r)),jF(VF,r)[e](Lh,(function(){return jF(KF,r).call(r)}))})),UF(this,QF,(function(){jF(ZF,r).call(r,!1),jF(YF,r).removeChild(jF($F,r))})),UF(this,JF,function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return tf.get(Qd).mute(),e===GF.STARTED_PACK.id&&jF(tN,r).call(r,e),e===GF.REMOVE_AD_PACK.id&&jF(tN,r).call(r,e),e===GF.MEGA_HINTS_PACK.id&&jF(tN,r).call(r,e),jF(ZF,r).call(r,!1),t.next=7,jF($F,r).hide(parent);case 7:jF(YF,r).removeChild(jF($F,r));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),UF(this,tN,(function(t){_SERVICE.payments&&_SERVICE.payments.purchase({id:t}).then(function(){var e=Jh(nc().mark((function e(n){return nc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("purchase",n),e.next=3,_SERVICE.payments.consumePurchase(n.purchaseData.purchaseToken);case 3:of.purchase(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){console.log("Покупка успешно консумирована!"),t===GF.STARTED_PACK.id&&(jF(XF,r).hasAdPass=!0,jF(XF,r).addHints(30),console.warn("Отключил рекламу и получил 30 подсказок")),t===GF.REMOVE_AD_PACK.id&&(jF(XF,r).hasAdPass=!0,jF(XF,r).saveData(),console.warn("Отключил рекламу со скидкой")),t===GF.MEGA_HINTS_PACK.id&&(jF(XF,r).addHints(50),console.warn("50 подсказок со скидкой")),tf.get(Qd).unmute(),tf.get(Qd).visibilityStateHandler(),tf.get(Qd).play("sfx_store")})).catch((function(t){console.log("[sdkAction] buyGold Покупка не удалась",t),jF(qF,r).show()})).finally((function(){tf.get(Qd).unmute(),tf.get(Qd).visibilityStateHandler()}))})),HF(VF,this,e),HF(XF,this,n),HF(YF,this,window.game.view),HF(qF,this,new cC(jF(VF,this).refs.purchaseErrorView)),jF(ZF,this).call(this,!0)}));function nN(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function rN(t,e,n){return t.set(sN(t,e),n),n}function iN(t,e){return t.get(sN(t,e))}function sN(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oN=new WeakMap,aN=new WeakMap,lN=new WeakMap,hN=new WeakMap,cN=new WeakMap,uN=new WeakMap,dN=new WeakMap,fN=new WeakMap,pN=new WeakMap,mN=new WeakMap,gN=new WeakMap,vN=new WeakMap,yN=new WeakMap,xN=new WeakMap,wN=new WeakMap,_N=new WeakMap,bN=new WeakMap,TN=new WeakMap,SN=new WeakMap,AN=new WeakMap,EN=new WeakMap,CN=new WeakMap,kN=new WeakMap,MN=_((function t(e){var n=this;v(this,t),nN(this,oN,window.game),nN(this,aN,iN(oN,this).refs),nN(this,lN,void 0),nN(this,hN,void 0),nN(this,cN,void 0),nN(this,uN,void 0),E(this,"init",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return rN(hN,n,tf.get(Zd)),rN(cN,n,tf.get(Qd)),iN(fN,n).call(n),iN(bN,n).call(n,!0),iN(oN,n).emit(Ih),iN(kN,n).call(n),t.next=8,iN(dN,n).call(n);case 8:iN(mN,n).call(n);case 9:case"end":return t.stop()}}),t)})))),nN(this,dN,Jh(nc().mark((function t(){var e,r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=iN(hN,n).savedLevel.levelIndex,r=new eN(iN(oN,n),iN(hN,n)),t.next=4,r.checkPromo({player:iN(hN,n),currentLevel:e});case 4:case"end":return t.stop()}}),t)})))),nN(this,fN,(function(){rN(lN,n,iN(aN,n).completeLevelView),rN(uN,n,iN(lN,n).getChildByName("btnNext",1)),n.btnNextInnerText=iN(uN,n).getChildByName("innerText",2),n.btnBuyLoupe=iN(lN,n).getChildByName("btnBuyLoupe",1),n.btnHome=iN(lN,n).getChildByName("btnHome",1),n.btnByeAd=iN(lN,n).getChildByName("btnByeAd",1),n.btns=[iN(uN,n),n.btnBuyLoupe,n.btnHome,n.btnByeAd],Sw.initOverHandler(n.btns),n.purchaseError=new cC(iN(aN,n).purchaseErrorView,.65)})),nN(this,pN,Jh(nc().mark((function t(){var e,r,i,s;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(_SERVICE.sdk){t.next=2;break}return t.abrupt("return");case 2:if(e=n.levelEntity,r=e.config,i=e.uiManager,"level5"!==r.spineName){t.next=13;break}return t.next=6,_SERVICE.canReview();case 6:if(!t.sent.value){t.next=13;break}return t.next=10,i.showModule(hE);case 10:return s=i.getModule(hE),t.next=13,s.waitForCompletion();case 13:case"end":return t.stop()}}),t)})))),nN(this,mN,Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return iN(gN,n).call(n),e=iN(hN,n).userLevel,n.btnNextInnerText.text="".concat(zc.t("level")," ").concat(e),iN(CN,n).call(n),t.next=6,iN(pN,n).call(n);case 6:return iN(vN,n).call(n),iN(yN,n).call(n),t.next=10,ww.timeline().call(Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,iN(cN,n).stopAll();case 2:return t.next=4,iN(cN,n).play("sfx_victory1");case 4:return t.next=6,iN(cN,n).play("m_victory2");case 6:case"end":return t.stop()}}),t)})))).to(iN(aN,n).fade,{alpha:.65,visible:!0},"<").set([iN(lN,n)],{visible:!0}).fromTo(iN(lN,n),{alpha:0},{alpha:1},"<").fromTo(iN(aN,n).speechBubble.scale,{x:0,y:0},{x:1,y:1,ease:"back.out(2.5)"},"<").add(iN(xN,n),"".concat(iN(hN,n).isPlayMusic?"+=1.8":"0.6"));case 10:case"end":return t.stop()}}),t)})))),nN(this,gN,(function(){var t=mp.getGameLevelData(iN(hN,n).savedLevel.levelIndex),e=Bu.extractSuffix(t.spineName);if(e){var r=Bu.isStringTrue(_SERVICE.flags.useHudWords),i=Bu.isStringTrue(_SERVICE.flags.useHudShadow),s=Bu.isStringTrue(_SERVICE.flags.useLevelTypeGeneration),o=function(){var t=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type,e=TI(TI({},Gd),{},{fontSize:23,fill:16777215}),n=16777215,r="";return t===lh&&(n=16753920,r="".concat(zc.t("difficultyLevels.".concat("hard")))),t===hh&&(n=16722750,r="".concat(zc.t("difficultyLevels.".concat("veryHard")))),t===ch&&(n=3092271,r="".concat(zc.t("difficultyLevels.".concat("extreme")))),tu(rs,{x:90,y:46},tu(os,{texture:"btn-badge",anchor:{x:.5,y:.5},tint:n}),tu(Ms,{text:r,anchor:{x:.5,y:.5},angle:-10,style:TI({},e)}))}({type:e});iN(uN,n).addChild(t)};e===lh&&i&&o(),e===hh&&r&&o(),e===ch&&s&&o()}})),nN(this,vN,(function(){iN(aN,n).character.state.setAnimation(0,"animation",!0)})),nN(this,yN,(function(){try{var t=n.levelEntity.storyTextData.outroText;iN(aN,n).speechBubbleText.text=t}catch(t){console.warn("speechBubbleText error",t)}})),nN(this,xN,(function(){try{var t=n.levelEntity.storyTextData.outroSpeech;iN(cN,n).play(t)}catch(t){console.warn("playSpeech error",t)}})),nN(this,wN,(function(){return iN(lN,n).interactiveChildren=!1,ww.timeline().to(iN(lN,n),{alpha:0,visible:!1})})),nN(this,_N,(function(){return iN(lN,n).interactiveChildren=!0,ww.timeline().to(iN(lN,n),{alpha:1,visible:!0})})),nN(this,bN,(function(t){var e=t?"on":"off",r=t?"once":"off";iN(uN,n)[r]("pointerdown",iN(TN,n)),n.btnHome[r]("pointerdown",iN(SN,n)),n.btnBuyLoupe[e]("pointerdown",iN(AN,n)),n.btnByeAd[e]("pointerdown",iN(EN,n)),iN(oN,n)[e](yh,iN(bN,n).bind(n,!1)),iN(oN,n)[e](Rh,iN(_N,n))})),nN(this,TN,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(of.finalScreenBtnNext(),iN(bN,n).call(n,!1),_SERVICE.sdk){t.next=5;break}return n.state.runNextLevel(),t.abrupt("return");case 5:iN(hN,n).hasAdPass?n.state.runNextLevel():_SERVICE.showFullscreenAdv({onOpen:function(){return iN(cN,n).pauseAll()},onClose:function(){iN(cN,n).unPauseAll(),n.state.runNextLevel()}});case 6:case"end":return t.stop()}}),t)})))),nN(this,SN,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return of.finalScreenBtnHome(),iN(bN,n).call(n,!1),iN(cN,n).play("sfx_btnClick"),t.next=5,Sw.click(n.btnHome);case 5:n.state.checkoutState(sh);case 6:case"end":return t.stop()}}),t)})))),nN(this,AN,(function(){of.finalScreenBtnStore(),iN(cN,n).play("sfx_btnClick"),iN(wN,n).call(n),iN(oN,n).LEVEL.uiManager.showModule(oE)})),nN(this,EN,(function(){of.finalScreenBtnDisableAd(),_SERVICE.payments.purchase({id:Fh.noAdPack.id}).then(function(){var t=Jh(nc().mark((function t(e){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Покупка успешно совершена!",e),iN(hN,n).hasAdPass=!0,t.next=4,iN(hN,n).saveData();case 4:return iN(CN,n).call(n),t.next=7,_SERVICE.payments.consumePurchase(e.purchaseData.purchaseToken);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).then((function(){console.log("Покупка успешно консумирована!"),iN(cN,n).unmute(),iN(cN,n).visibilityStateHandler(),iN(cN,n).play("sfx_store")})).catch((function(t){console.log("[sdkAction] buyGold Покупка не удалась",t),n.purchaseError.show()})).finally((function(){tf.get(Qd).unmute(),tf.get(Qd).visibilityStateHandler()}))})),nN(this,CN,(function(){if(iN(hN,n).hasAdPass){var t=n.btnByeAd;t.eventMode="none";var e=new Ds;e.brightness(.6,!0),e.greyscale(.6,!0),t.filters=[e]}})),nN(this,kN,(function(){var t=n.levelEntity.modulesInitializer.getMod("stopwatch").seconds;of.completeLevel(n.levelEntity.config,iN(hN,n),t)})),this.levelEntity=e,this.state=e.state}));function PN(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function IN(t,e,n){return t.set(ON(t,e),n),n}function RN(t,e){return t.get(ON(t,e))}function ON(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var LN=new WeakMap,DN=new WeakMap,FN=new WeakMap,NN=new WeakMap,BN=new WeakMap,WN=new WeakMap,UN=new WeakMap,jN=new WeakMap,HN=new WeakMap,zN=new WeakMap,GN=new WeakMap,VN=new WeakMap,XN=new WeakMap,YN=new WeakMap,$N=new WeakMap,qN=new WeakMap,KN=new WeakMap,ZN=new WeakMap,QN=new WeakMap,JN=new WeakMap,tB=new WeakMap,eB=new WeakMap,nB=new WeakMap,rB=new WeakMap,iB=new WeakMap,sB=new WeakMap,oB=new WeakMap,aB=new WeakMap,lB=new WeakMap,hB=new WeakMap,cB=new WeakMap,uB=_((function t(e){var n=this;v(this,t),PN(this,LN,window.game),PN(this,DN,RN(LN,this).refs),PN(this,FN,null),PN(this,NN,null),PN(this,BN,null),PN(this,WN,.65),PN(this,UN,new Ya),PN(this,jN,null),PN(this,HN,null),PN(this,zN,null),PN(this,GN,!1),PN(this,VN,0),PN(this,XN,void 0),E(this,"init",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!RN(GN,n)){t.next=2;break}return t.abrupt("return");case 2:return RN(YN,n).call(n,!0),RN(qN,n).call(n,!0),RN($N,n).call(n),t.next=7,RN(ZN,n).call(n);case 7:return t.next=9,RN(eB,n).call(n);case 9:RN(LN,n).app.stage.interactiveChildren=!0,RN(iB,n).call(n);case 11:case"end":return t.stop()}}),t)})))),E(this,"waitForCompletion",(function(){return RN(FN,n)})),PN(this,YN,(function(t){var e=t?"on":"off";RN(LN,n)[e](vh,RN(rB,n)),RN(LN,n)[e](ph,RN(sB,n))})),PN(this,$N,(function(){var t=new gd;t.color=0,t.name="colorOverlayFilter",t.alpha=RN(WN,n),RN(LN,n).uiInner.children.forEach((function(e){"learningView"!==e.name&&(e.filters=[t])}))})),PN(this,qN,(function(t){var e=t?"pause":"resume",r=t?"none":"static",i=RN(DN,n),s=i.btnHint,o=i.optionsWheel;s.eventMode=r,o.eventMode=r;var a=n.level.camera;a.setPause(r),a.plugins[e]("drag"),a.plugins[e]("wheel"),a.plugins[e]("pinch")})),PN(this,KN,(function(){RN(UN,n).clear(),RN(UN,n).beginFill(16777215),RN(UN,n).drawRect(0,0,Dh.WIDTH,Dh.HEIGHT),RN(UN,n).endFill()})),PN(this,ZN,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return RN(QN,n).call(n),RN(JN,n).call(n),t.next=4,ww.timeline().fromTo(RN(BN,n),{alpha:0},{alpha:RN(WN,n),delay:RN(VN,n),duration:1});case 4:case"end":return t.stop()}}),t)})))),PN(this,QN,Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=Yd({w:Dh.WIDTH,h:Dh.HEIGHT,color:0,alpha:0})).zIndex=1,RN(DN,n).levelContainer.addChild(e),IN(BN,n,e);case 4:case"end":return t.stop()}}),t)})))),PN(this,JN,(function(){RN(BN,n).mask=RN(UN,n),RN(tB,n).call(n,Dh.HALF_W,Dh.HALF_H,1),RN(UN,n).zIndex=3,RN(DN,n).levelContainer.addChild(RN(UN,n))})),PN(this,tB,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;RN(UN,n).clear(),RN(UN,n).beginFill(16777215),RN(UN,n).drawRect(0,0,Dh.WIDTH,Dh.HEIGHT),RN(UN,n).endFill(),RN(UN,n).beginHole(),RN(UN,n).drawCircle(t,e,r),RN(UN,n).endHole()})),PN(this,eB,(function(){var t={circleX:Dh.HALF_W,circleY:Dh.HALF_H,radius:1};return ww.fromTo(t,{circleX:Dh.HALF_W+200,circleY:Dh.HALF_H,radius:1},{circleX:Dh.HALF_W-40,circleY:Dh.HALF_H-30,radius:100,duration:1.5,ease:"back.out(2.5)",onUpdate:function(){RN(tB,n).call(n,t.circleX,t.circleY,t.radius)}})})),PN(this,nB,(function(){var t=new os(vr.from("learning-arrow"));return t.zIndex=1,t.anchor.set(.5),t.position.set(Dh.HALF_W-40,Dh.HALF_H-30-t.height),RN(DN,n).levelContainer.addChild(t),t})),PN(this,rB,(function(){RN(GN,n)||(IN(GN,n,!0),console.warn("destroy learning"),RN(YN,n).call(n,!1),ww.timeline().set([RN(jN,n)],{alpha:0,visible:!1}).call((function(){return bw(RN(HN,n),!0)})).call((function(){return RN(KN,n).call(n)})).set([RN(BN,n)],{alpha:0,visible:!1}))})),PN(this,iB,(function(){IN(jN,n,RN(nB,n).call(n)),IN(HN,n,ww.timeline().from(RN(jN,n),{y:0,yoyo:!0}).to(RN(jN,n),{y:"-=70",repeat:-1,yoyo:!0}))})),PN(this,sB,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return RN(aB,n).call(n),t.next=3,RN(oB,n).call(n);case 3:return t.next=5,RN(lB,n).call(n);case 5:return t.next=7,RN(hB,n).call(n);case 7:return t.next=9,RN(cB,n).call(n);case 9:case"end":return t.stop()}}),t)})))),PN(this,oB,(function(){var t=RN(DN,n).learningView,e=ZT.createSpine({spineName:"pinch",animationName:"idle",speed:1,autorun:!1,loop:!0});e.zIndex=10,e.position.set(-100,-230),t.addChild(e),IN(XN,n,e)})),PN(this,aB,(function(){var t=RN(DN,n).learningView;return IN(zN,n,ww.timeline().set(RN(jN,n),{alpha:0,visible:!1}).call((function(){return bw(RN(HN,n),!0)})).call((function(){return RN(KN,n).call(n)})).set(t,{visible:!0}).from(t,{alpha:0}))})),PN(this,lB,Jh(nc().mark((function t(){var e,r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.level.camera,r=RN(LN,n).scaleFactor+.25,RN(XN,n).state.setAnimation(0,"idle",!1),t.next=5,ww.timeline({repeat:1,yoyo:!0}).to(e.scale,{x:r,y:r,duration:.8,ease:"sine.inOut",onUpdate:function(){return e.moveCenter(Dh.HALF_W,Dh.HALF_H)}});case 5:case"end":return t.stop()}}),t)})))),PN(this,hB,Jh(nc().mark((function t(){var e,r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.level.camera,n.level.camera.setPause(!1),r=function(t){return new Promise((function(r){e.animate({scale:RN(LN,n).scaleFactor,position:new mn(t,Dh.HALF_H),time:500,ease:"easeInOutQuad",callbackOnComplete:function(){return r(!0)}})}))},t.next=5,r(Dh.HALF_W-300);case 5:return t.next=7,r(Dh.HALF_W);case 7:return t.next=9,r(Dh.HALF_W+300);case 9:return t.next=11,r(Dh.HALF_W);case 11:case"end":return t.stop()}}),t)})))),PN(this,cB,(function(){RN(YN,n).call(n,!1),bw(RN(zN,n),!0);var t=RN(DN,n).learningView;return ww.timeline().to([RN(XN,n),t],{alpha:0,duration:.3}).to(RN(BN,n),{alpha:0},"<").call((function(){RN(XN,n).state.clearTracks(),RN(LN,n).uiInner.children.forEach((function(t){return t.filters=[]})),RN(qN,n).call(n,!1),t.destroy({children:!0}),RN(LN,n).uiInner.removeChild(t),RN(DN,n).levelContainer.removeChild(RN(BN,n))})).call(RN(NN,n))})),this.level=e,IN(FN,this,new Promise((function(t){IN(NN,n,t)})))}));function dB(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function fB(t,e,n){return t.set(mB(t,e),n),n}function pB(t,e){return t.get(mB(t,e))}function mB(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gB=new WeakMap,vB=new WeakMap,yB=new WeakMap,xB=new WeakMap,wB=new WeakMap,_B=new WeakMap,bB=new WeakMap,TB=new WeakMap,SB=new WeakMap,AB=_((function t(e){var n=this;v(this,t),dB(this,gB,window.game),dB(this,vB,pB(gB,this).refs),dB(this,yB,new Ya),dB(this,xB,void 0),dB(this,wB,void 0),dB(this,_B,void 0),E(this,"initHole",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pB(bB,n).call(n);case 2:pB(TB,n).call(n);case 3:case"end":return t.stop()}}),t)})))),dB(this,bB,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return fB(xB,n,Yd({w:Dh.WIDTH,h:Dh.HEIGHT,color:0,alpha:0})),pB(vB,n).levelContainer.addChild(pB(xB,n)),t.next=4,ww.timeline().fromTo(pB(xB,n),{alpha:0},{alpha:pB(_B,n).maxFadeAlpha,delay:pB(wB,n),duration:1});case 4:case"end":return t.stop()}}),t)})))),dB(this,TB,(function(){pB(xB,n).mask=pB(yB,n),pB(SB,n).call(n,Dh.HALF_W,Dh.HALF_H,1),pB(vB,n).levelContainer.addChild(pB(yB,n))})),E(this,"animateHole",(function(){var t=pB(_B,n).getTarget(),e=t.target,r=t.position;pB(_B,n).animateCamera(e),pB(_B,n).animationStars(e);var i={circleX:Dh.HALF_W,circleY:Dh.HALF_H,radius:1};return ww.fromTo(i,{circleX:r.x,circleY:r.y,radius:1},{circleX:r.x,circleY:r.y,radius:100,duration:1.5,ease:"back.out(2.5)",onUpdate:function(){pB(SB,n).call(n,i.circleX,i.circleY,i.radius)}})})),dB(this,SB,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;pB(yB,n).clear(),pB(yB,n).beginFill(16777215),pB(yB,n).drawRect(0,0,Dh.WIDTH,Dh.HEIGHT),pB(yB,n).endFill(),pB(yB,n).beginHole(),pB(yB,n).drawCircle(t,e,r),pB(yB,n).endHole()})),E(this,"hideHole",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return pB(yB,n).clear(),pB(yB,n).beginFill(16777215),pB(yB,n).drawRect(0,0,Dh.WIDTH,Dh.HEIGHT),pB(yB,n).endFill(),t.next=6,ww.to(pB(xB,n),{alpha:0,visible:!1});case 6:pB(vB,n).levelContainer.removeChild(pB(xB,n)),pB(vB,n).levelContainer.removeChild(pB(yB,n));case 8:case"end":return t.stop()}}),t)})))),fB(_B,this,e)}));function EB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function CB(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?EB(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):EB(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function kB(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function MB(t,e,n){return t.set(IB(t,e),n),n}function PB(t,e){return t.get(IB(t,e))}function IB(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var RB=new WeakMap,OB=new WeakMap,LB=new WeakMap,DB=new WeakMap,FB=new WeakMap,NB=new WeakMap,BB=new WeakMap,WB=new WeakMap,UB=new WeakMap,jB=new WeakMap,HB=new WeakMap,zB=new WeakMap,GB=new WeakMap,VB=_((function t(e,n){var r=this;v(this,t),kB(this,RB,window.game),kB(this,OB,PB(RB,this).refs),kB(this,LB,void 0),kB(this,DB,null),kB(this,FB,null),kB(this,NB,void 0),kB(this,BB,void 0),E(this,"maxFadeAlpha",.65),kB(this,WB,void 0),E(this,"level",void 0),E(this,"learningConfig",void 0),E(this,"init",Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,PB(LB,r).initHole();case 2:return PB(UB,r).call(r,!0),PB(RB,r).app.stage.interactiveChildren=!0,t.next=6,PB(jB,r).call(r);case 6:PB(LB,r).animateHole(),PB(WB,r).disabledUserMove();case 8:case"end":return t.stop()}}),t)})))),kB(this,UB,(function(t){var e=t?"on":"off";PB(RB,r)[e](vh,PB(HB,r)),PB(RB,r)[e](ph,PB(GB,r))})),kB(this,jB,(function(){return new Promise((function(t){var e=function(){var t={},e={fade:{texture:vr.WHITE,width:Dh.WIDTH,height:Dh.HEIGHT,tint:0,alpha:.5},view:Gu({x:Dh.HALF_W,y:Dh.HALF_H,pivot:function(){return{x:t.view.width/2,y:t.view.height/2}},"(orientation: landscape)":{}})},n=new Ya;return n.lineStyle(10,9142607,1),n.beginFill(16445894),n.drawRect(0,0,430,300),n.endFill(),tu(rs,{ref:function(e){return t.root=e},eventMode:"static",name:"optionView",zIndex:10,resize:function(){t.view.classes=e.view}},tu(rs,{classes:e.view,name:"view",ref:function(e){return t.view=e},eventMode:"static"},n,tu(Ms,{text:"testing text",name:"innerText",x:215,y:100,anchor:{x:.5,y:.5},style:CB(CB({},Gd),{},{wordWrap:!0,wordWrapWidth:410,align:"center",fontSize:26,fill:0,fontWeight:"normal"})}),tu(em,{texture:"btn-silver",name:"btnInner",text:"OK",x:215,y:250,scaleValue:.5})))}();e.refs=e,PB(OB,r).wrapper.addChild(e),e.getChildByName("innerText",1).text=r.learningConfig.message,ww.from(e,{alpha:0}),e.getChildByName("btnInner",1).once("pointerdown",Jh(nc().mark((function n(){return nc().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return tf.get(Qd).play("sfx_btnClick"),n.next=3,ww.to(e,{alpha:0});case 3:tf.get(Qd).play("sfx_hintFlash"),PB(OB,r).wrapper.removeChild(e),t();case 6:case"end":return n.stop()}}),n)}))))}))})),E(this,"getTarget",(function(){var t,e=(t=r.level.entityManager.initialHogItems,Array.isArray(t)&&0!==t.length?t[Math.floor(Math.random()*t.length)]:null);return{target:e,position:ZT.getSlotSpritePosition(e)}})),E(this,"animationStars",(function(t){var e=PB(OB,r).hintStars,n=ZT.getSlotSpritePosition(t),i=n.x,s=n.y;MB(NB,r,ww.timeline().set(e,{x:i,y:s,visible:!0,zIndex:2}).fromTo(e.scale,{x:1.5,y:1.5},{x:2.2,y:2.2,yoyo:!0,duration:1,repeat:-1}).to(e,{angle:360,duration:2,ease:"power1.inOut",repeat:-1},"<"))})),E(this,"animateCamera",(function(t){var e=PB(WB,r).getTargetCenter(t);PB(WB,r).follow(e,{speed:8,acceleration:.5})})),E(this,"waitForCompletion",(function(){return PB(DB,r)})),kB(this,HB,(function(){console.warn("------------- destroy learning")})),kB(this,zB,(function(){PB(WB,r).animate({scale:PB(RB,r).scaleFactor,position:new mn(Dh.HALF_W,Dh.HALF_H),time:1e3,ease:"easeInOutSine",callbackOnComplete:function(){}})})),kB(this,GB,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return PB(UB,r).call(r,!1),PB(WB,r).plugins.remove("follow"),bw(PB(NB,r),!0),bw(PB(BB,r),!0),ww.timeline().to(PB(OB,r).hintStars,{alpha:0,visible:!1}),PB(LB,r).hideHole(),PB(WB,r).unDisabledUserMove(),PB(zB,r).call(r),t.abrupt("return",ww.timeline().call(PB(FB,r)));case 9:case"end":return t.stop()}}),t)})))),this.level=e,this.learningConfig=n,MB(WB,this,e.camera),MB(LB,this,new AB(this)),MB(DB,this,new Promise((function(t){MB(FB,r,t)})))}));function XB(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function YB(t,e){return t.get(qB(t,e))}function $B(t,e,n){return t.set(qB(t,e),n),n}function qB(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var KB=new WeakMap,ZB=new WeakMap,QB=new WeakMap,JB=new WeakMap,tW=new WeakMap,eW=new WeakMap,nW=_((function t(e){var n=this;v(this,t),XB(this,KB,void 0),XB(this,ZB,void 0),XB(this,QB,null),XB(this,JB,void 0),E(this,"checkIsLearning",function(){var t=Jh(nc().mark((function t(e){var r,i,s;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=tf.get(Zd).savedLevel,i=r.levelIndex,s=r.skinIndex,0!==i||1!==s){t.next=5;break}return t.next=4,YB(tW,n).call(n);case 4:return t.abrupt("return");case 5:return t.next=7,YB(eW,n).call(n,e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),XB(this,tW,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return tf.get(Zd),$B(QB,n,new uB(YB(JB,n))),t.next=4,YB(QB,n).init();case 4:return t.next=6,YB(QB,n).waitForCompletion();case 6:case"end":return t.stop()}}),t)})))),XB(this,eW,function(){var t=Jh(nc().mark((function t(e){var r,i,s,o,a;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=YB(JB,n).config.spineName,i=E(E(E({},lh,{message:zc.t("learning.shadows"),flagName:lh}),hh,{message:zc.t("learning.words"),flagName:hh}),ch,{message:zc.t("learning.generator"),flagName:ch}),s=Bu.detectLevelType(r),(o=i[s.leveTypelName])&&!1!==o.statusFlag){t.next=6;break}return t.abrupt("return");case 6:if(console.log("Обнаружен тип уровня ".concat(s.leveTypelName,", состояние его флага: ").concat(s.statusFlag)),!(a=tf.get(Zd)).config.isTutorialCompleted[o.flagName]){t.next=10;break}return t.abrupt("return");case 10:return $B(QB,n,new VB(e,o)),t.next=13,YB(QB,n).init();case 13:return t.next=15,YB(QB,n).waitForCompletion();case 15:a.config.isTutorialCompleted[o.flagName]=!0,a.saveData();case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),$B(JB,this,e)}));function rW(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function iW(t,e,n){return t.set(oW(t,e),n),n}function sW(t,e){return t.get(oW(t,e))}function oW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var aW=new WeakMap,lW=new WeakMap,hW=new WeakMap,cW=new WeakMap,uW=new WeakMap,dW=new WeakMap,fW=new WeakMap,pW=new WeakMap,mW=new WeakMap,gW=new WeakMap,vW=new WeakMap,yW=new WeakMap,xW=new WeakMap,wW=new WeakMap,_W=new WeakMap,bW=new WeakMap,TW=new WeakMap,SW=new WeakMap,AW=new WeakMap,EW=new WeakMap,CW=new WeakMap,kW=new WeakMap,MW=new WeakMap,PW=new WeakMap,IW=_((function t(e){var n=this;v(this,t),rW(this,aW,window.game),rW(this,lW,sW(aW,this).refs),rW(this,hW,sW(aW,this).app.stage),E(this,"entityManager",null),rW(this,cW,null),rW(this,uW,null),rW(this,dW,null),E(this,"camera",null),rW(this,fW,null),E(this,"modulesInitializer",null),rW(this,pW,null),rW(this,mW,null),rW(this,gW,null),E(this,"levelConfig",null),E(this,"uiManager",null),rW(this,vW,void 0),rW(this,yW,!1),rW(this,xW,!1),rW(this,wW,!1),E(this,"storyTextData",void 0),E(this,"config",null),E(this,"initializeComponents",(function(){iW(dW,n,tf.get(Zd)),n.camera=new lO(sW(aW,n),sW(lW,n).levelContainer),iW(fW,n,new OL(n)),n.modulesInitializer=new lF,iW(mW,n,new fR(n)),n.uiManager=new iR(n),iW(vW,n,new n_(n.state)),iW(pW,n,new nW(n)),iW(gW,n,new MN(n)),n.levelConfig=new mp,iW(cW,n,new sE(E({},wh,sW(MW,n)))),n.storyTextData=mp.getSpeechAndTextData(sW(aW,n),sW(dW,n))})),rW(this,_W,(function(){var t=sW(lW,n).levelContainer,e=ZT.createSpine({spineName:"smoke",autorun:!0,animationName:"idle",speed:1});e.zIndex=1,t.addChild(e),ww.timeline().to(e,{alpha:0,duration:1,delay:3}).eventCallback("onComplete",(function(){!function(){try{e.visible=!1,t.removeChild(e),e.destroy()}catch(t){console.log(t)}}()}))})),rW(this,bW,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return sW(TW,n).call(n),t.next=3,ww.timeline().set(sW(lW,n).introSpeechBubble,{alpha:1}).to({},{delay:3}).to(sW(lW,n).introSpeechBubble,{alpha:0});case 3:case"end":return t.stop()}}),t)})))),E(this,"unlockScene",(function(){sW(hW,n).interactiveChildren=!0,n.camera.eventMode="static",n.camera.interactiveChildren=!0,n.camera.setPause(!1);var t=sW(lW,n),e=t.optionsWheel,r=t.btnHint;ww.fromTo([e,r],{alpha:0},{alpha:1,visible:!0})})),rW(this,TW,(function(){var t=sW(lW,n).introSpeechBubble.getChildByName("speechBubbleText"),e=n.storyTextData.introText;try{t.text=e}catch(t){console.log("setStoryText",t)}})),rW(this,SW,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return sW(cW,n).setEvents(!1),t.next=3,Tw(sW(lW,n).fade,{fadeToDark:!0});case 3:return t.abrupt("return",ww.timeline().call((function(){sW(mW,n).clear(n.entityManager.entities,sW(uW,n).systems)})));case 4:case"end":return t.stop()}}),t)})))),rW(this,AW,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.entityManager=new PS(n.config),t.next=3,n.entityManager.createEntities();case 3:case"end":return t.stop()}}),t)})))),rW(this,EW,(function(){iW(uW,n,new rE(n.entityManager)),sW(uW,n).initSystems(n)})),rW(this,CW,(function(){n.camera.init(),sW(fW,n).init()})),rW(this,kW,(function(){n.modulesInitializer.init({errorCross:sW(lW,n).levelContainer,levelCounter:{config:n.config,spineLevel:n.entityManager.spineLevelComponent},hud:n})})),rW(this,MW,Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!sW(wW,n)){t.next=2;break}return t.abrupt("return");case 2:iW(xW,n,!0),iW(yW,n,!0),sW(aW,n).emit(vh),sW(uW,n).removeAllSystems(),sW(PW,n).call(n,{hide:!0,delay:.3}),sW(gW,n).init(),n.levelConfig.updateSavedLevel();case 9:case"end":return t.stop()}}),t)})))),rW(this,PW,(function(t){var e=t.show,r=t.hide,i=t.duration,s=void 0===i?.3:i,o=t.delay,a=void 0===o?0:o,l=sW(lW,n),h=l.optionsWheel,c=l.hudView,u=l.btnHint,d=sW(aW,n).uiInner;return e?ww.timeline().fromTo([d],{alpha:0},{alpha:1,duration:s,delay:a,visible:!0}):r?ww.timeline().to([d,h,c,u],{alpha:0,duration:s,delay:a,visible:!1}):void 0})),E(this,"exit",Jh(nc().mark((function t(){var e,r,i,s=arguments;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:{},sW(hW,n).interactiveChildren=!1,sW(aW,n).emit(vh,e),sW(yW,n)||(r=n.modulesInitializer.getMod("stopwatch"),i=r.seconds,of.earlyExit(n.config,sW(dW,n),i)),n.camera=null,sW(PW,n).call(n,{hide:!0,duration:.2}),t.next=8,ww.to(sW(lW,n).mainFade,{alpha:1,visible:!0});case 8:return sW(uW,n).removeAllSystems(),t.abrupt("return",sW(SW,n).call(n));case 10:case"end":return t.stop()}}),t)})))),this.state=e,sW(hW,this).interactiveChildren=!1,sW(aW,this).uiInner.visible=!1,sW(aW,this).LEVEL=this}),[{key:"init",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.initializeComponents(),sW(_W,this).call(this),this.config=this.levelConfig.getConfig(),t.next=5,sW(AW,this).call(this);case 5:return sW(EW,this).call(this),sW(kW,this).call(this),sW(CW,this).call(this),sW(PW,this).call(this,{show:!0,duration:.1}),t.next=11,sW(bW,this).call(this);case 11:return this.modulesInitializer.getMod("hud").showItems(),t.next=14,sW(pW,this).checkIsLearning(this);case 14:this.unlockScene(),this.modulesInitializer.init({stopwatch:{game:sW(aW,this),label:HO}}),sW(cW,this).setEvents(!0);case 17:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"maxItems",get:function(){var t=this.modulesInitializer.getMod("levelCounter");return null==t?void 0:t.getMaxItems()}}]);function RW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(RW=function(){return!!t})()}function OW(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function LW(t,e){return t.get(FW(t,e))}function DW(t,e,n){return t.set(FW(t,e),n),n}function FW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var NW=new WeakMap,BW=new WeakMap,WW=new WeakMap,UW=new WeakMap,jW=new WeakMap,HW=function(t){function e(t){var n;return v(this,e),n=function(t,e,n){return e=T(e),b(t,RW()?Reflect.construct(e,n||[],T(t).constructor):e.apply(t,n))}(this,e,[t]),OW(n,NW,null),OW(n,BW,null),OW(n,WW,null),OW(n,UW,null),OW(n,jW,null),E(n,"restart",Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=n.level)||void 0===e?void 0:e.exit();case 2:n.terminate(),LW(NW,n).emit(oh);case 4:case"end":return t.stop()}}),t)})))),E(n,"runNextLevel",Jh(nc().mark((function t(){var e;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=n.level)||void 0===e?void 0:e.exit();case 2:n.terminate(),LW(NW,n).emit(ah);case 4:case"end":return t.stop()}}),t)})))),E(n,"checkoutState",function(){var t=Jh(nc().mark((function t(e){var r;return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(r=n.level)||void 0===r?void 0:r.exit();case 2:n.terminate(),LW(NW,n).emit(e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),DW(NW,n,t),DW(jW,n,LW(NW,n).ui),n}return A(e,t),_(e,[{key:"initEventName",get:function(){return oh}},{key:"initialize",value:function(){!function(t,e,n){var r=tc(T(t.prototype),"initialize",n);return"function"==typeof r?function(t){return r.apply(n,t)}:r}(e,0,this)([]),DW(BW,this,new MI(LW(NW,this))),LW(BW,this).addChild(LW(jW,this)),LW(NW,this).viewport.addChild(LW(BW,this)),LW(NW,this).view=LW(BW,this),LW(NW,this).refs=LW(BW,this).refs,DW(WW,this,LW(BW,this).refs),this.game.stateName=this.initEventName,this.game.stateEntity=this,this.isInitialized=!0,this.game.resize=this.resize.bind(this),this.start()}},{key:"start",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.level=new IW(this),this.level.init(),t.next=4,this.resize();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"resize",value:function(){var t=Jh(nc().mark((function t(){return nc().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Vu(this.game,Vd),t.next=3,LW(BW,this).resize();case 3:LW(NW,this).emit(dh,!0);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"terminate",value:function(){LW(NW,this).off(dh,!0),ww.killTweensOf("*"),ww.globalTimeline.clear(),this.isInitialized=!1,LW(WW,this).camera&&LW(WW,this).camera.destroy({children:!0}),this.game.viewport.addChild(LW(jW,this)),this.game.uiInner.removeChildren(),LW(BW,this).destroy({children:!0}),DW(BW,this,null),DW(UW,this,null),tf.get(Qd).stopAll()}}])}(Kc);function zW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(zW=function(){return!!t})()}function GW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var XW=new WeakSet,YW=new WeakMap,$W=function(t){function e(){var t;return v(this,e),t=function(t,e){return e=T(e),b(t,zW()?Reflect.construct(e,[],T(t).constructor):e.apply(t,void 0))}(this,e),function(t,e){GW(t,e),e.add(t)}(t,XW),E(t,"app",void 0),E(t,"states",[]),E(t,"stateAfterPreload",sh),E(t,"viewport",void 0),E(t,"isResizing",void 0),E(t,"locale",void 0),E(t,"currentStateName",void 0),function(e,n){GW(e,n),n.set(e,(function(){t.app=new Qs({resizeTo:window,resolution:2,autoDensity:!0,antialias:!1,premultipliedAlpha:!1,backgroundAlpha:1,backgroundColor:0}),t.app.view.className="pixi-view",document.body.querySelector("#canvas-wrapper").appendChild(t.app.view),t.viewport=new Zh(t),t.app.stage.addChild(t.viewport)}))}(t,YW),E(t,"handleResize",(function(){t.isResizing||(t.isResizing=!0,setTimeout((function(){t.viewport.resize(),t.states.forEach((function(t){t.isInitialized&&t.resize()})),t.isResizing=!1}),50))})),VW(XW,t,qW).call(t),t}return A(e,t),_(e,[{key:"start",value:function(){this.emit(ih)}}])}(dt);function qW(){(function(t,e){return t.get(VW(t,e))})(YW,this).call(this),this.states=[new Yp(this),new xP(this),new sI(this),new HW(this)],window.addEventListener("resize",this.handleResize),this.handleResize()}document.addEventListener("pointerdown",(function(t){return t.preventDefault()})),document.addEventListener("pointerup",(function(t){return t.preventDefault()})),document.addEventListener("pointermove",(function(t){return t.preventDefault()})),document.addEventListener("click",(function(t){return t.preventDefault()})),document.addEventListener("wheel",(function(t){return t.preventDefault()})),window.addEventListener("gesturestart",(function(t){return t.preventDefault()})),window.addEventListener("gesturechange",(function(t){return t.preventDefault()})),window.addEventListener("gestureend",(function(t){return t.preventDefault()})),document.addEventListener("dblclick",(function(t){return t.preventDefault()})),document.addEventListener("contextmenu",(function(t){return t.preventDefault()})),window.createGame=function(){var t=new $W;window.game=t,t.start()}}()}()}();
